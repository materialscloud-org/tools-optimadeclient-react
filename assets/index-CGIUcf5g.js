(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const p of document.querySelectorAll('link[rel="modulepreload"]'))c(p);new MutationObserver(p=>{for(const D of p)if(D.type==="childList")for(const u of D.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&c(u)}).observe(document,{childList:!0,subtree:!0});function a(p){const D={};return p.integrity&&(D.integrity=p.integrity),p.referrerPolicy&&(D.referrerPolicy=p.referrerPolicy),p.crossOrigin==="use-credentials"?D.credentials="include":p.crossOrigin==="anonymous"?D.credentials="omit":D.credentials="same-origin",D}function c(p){if(p.ep)return;p.ep=!0;const D=a(p);fetch(p.href,D)}})();var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function getAugmentedNamespace(r){if(Object.prototype.hasOwnProperty.call(r,"__esModule"))return r;var n=r.default;if(typeof n=="function"){var a=function c(){var p=!1;try{p=this instanceof c}catch{}return p?Reflect.construct(n,arguments,this.constructor):n.apply(this,arguments)};a.prototype=n.prototype}else a={};return Object.defineProperty(a,"__esModule",{value:!0}),Object.keys(r).forEach(function(c){var p=Object.getOwnPropertyDescriptor(r,c);Object.defineProperty(a,c,p.get?p:{enumerable:!0,get:function(){return r[c]}})}),a}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReact_production_min;function requireReact_production_min(){if(hasRequiredReact_production_min)return react_production_min;hasRequiredReact_production_min=1;var r=Symbol.for("react.element"),n=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),c=Symbol.for("react.strict_mode"),p=Symbol.for("react.profiler"),D=Symbol.for("react.provider"),u=Symbol.for("react.context"),v=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),_=Symbol.for("react.memo"),C=Symbol.for("react.lazy"),w=Symbol.iterator;function k(fe){return fe===null||typeof fe!="object"?null:(fe=w&&fe[w]||fe["@@iterator"],typeof fe=="function"?fe:null)}var F={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},T=Object.assign,z={};function Q(fe,De,We){this.props=fe,this.context=De,this.refs=z,this.updater=We||F}Q.prototype.isReactComponent={},Q.prototype.setState=function(fe,De){if(typeof fe!="object"&&typeof fe!="function"&&fe!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,fe,De,"setState")},Q.prototype.forceUpdate=function(fe){this.updater.enqueueForceUpdate(this,fe,"forceUpdate")};function J(){}J.prototype=Q.prototype;function K(fe,De,We){this.props=fe,this.context=De,this.refs=z,this.updater=We||F}var b=K.prototype=new J;b.constructor=K,T(b,Q.prototype),b.isPureReactComponent=!0;var N=Array.isArray,V=Object.prototype.hasOwnProperty,U={current:null},Z={key:!0,ref:!0,__self:!0,__source:!0};function L(fe,De,We){var oe,Ae={},He=null,Ue=null;if(De!=null)for(oe in De.ref!==void 0&&(Ue=De.ref),De.key!==void 0&&(He=""+De.key),De)V.call(De,oe)&&!Z.hasOwnProperty(oe)&&(Ae[oe]=De[oe]);var Ie=arguments.length-2;if(Ie===1)Ae.children=We;else if(1<Ie){for(var rt=Array(Ie),st=0;st<Ie;st++)rt[st]=arguments[st+2];Ae.children=rt}if(fe&&fe.defaultProps)for(oe in Ie=fe.defaultProps,Ie)Ae[oe]===void 0&&(Ae[oe]=Ie[oe]);return{$$typeof:r,type:fe,key:He,ref:Ue,props:Ae,_owner:U.current}}function ee(fe,De){return{$$typeof:r,type:fe.type,key:De,ref:fe.ref,props:fe.props,_owner:fe._owner}}function Ee(fe){return typeof fe=="object"&&fe!==null&&fe.$$typeof===r}function he(fe){var De={"=":"=0",":":"=2"};return"$"+fe.replace(/[=:]/g,function(We){return De[We]})}var ge=/\/+/g;function me(fe,De){return typeof fe=="object"&&fe!==null&&fe.key!=null?he(""+fe.key):De.toString(36)}function Me(fe,De,We,oe,Ae){var He=typeof fe;(He==="undefined"||He==="boolean")&&(fe=null);var Ue=!1;if(fe===null)Ue=!0;else switch(He){case"string":case"number":Ue=!0;break;case"object":switch(fe.$$typeof){case r:case n:Ue=!0}}if(Ue)return Ue=fe,Ae=Ae(Ue),fe=oe===""?"."+me(Ue,0):oe,N(Ae)?(We="",fe!=null&&(We=fe.replace(ge,"$&/")+"/"),Me(Ae,De,We,"",function(st){return st})):Ae!=null&&(Ee(Ae)&&(Ae=ee(Ae,We+(!Ae.key||Ue&&Ue.key===Ae.key?"":(""+Ae.key).replace(ge,"$&/")+"/")+fe)),De.push(Ae)),1;if(Ue=0,oe=oe===""?".":oe+":",N(fe))for(var Ie=0;Ie<fe.length;Ie++){He=fe[Ie];var rt=oe+me(He,Ie);Ue+=Me(He,De,We,rt,Ae)}else if(rt=k(fe),typeof rt=="function")for(fe=rt.call(fe),Ie=0;!(He=fe.next()).done;)He=He.value,rt=oe+me(He,Ie++),Ue+=Me(He,De,We,rt,Ae);else if(He==="object")throw De=String(fe),Error("Objects are not valid as a React child (found: "+(De==="[object Object]"?"object with keys {"+Object.keys(fe).join(", ")+"}":De)+"). If you meant to render a collection of children, use an array instead.");return Ue}function ue(fe,De,We){if(fe==null)return fe;var oe=[],Ae=0;return Me(fe,oe,"","",function(He){return De.call(We,He,Ae++)}),oe}function I(fe){if(fe._status===-1){var De=fe._result;De=De(),De.then(function(We){(fe._status===0||fe._status===-1)&&(fe._status=1,fe._result=We)},function(We){(fe._status===0||fe._status===-1)&&(fe._status=2,fe._result=We)}),fe._status===-1&&(fe._status=0,fe._result=De)}if(fe._status===1)return fe._result.default;throw fe._result}var ce={current:null},se={transition:null},X={ReactCurrentDispatcher:ce,ReactCurrentBatchConfig:se,ReactCurrentOwner:U};function Re(){throw Error("act(...) is not supported in production builds of React.")}return react_production_min.Children={map:ue,forEach:function(fe,De,We){ue(fe,function(){De.apply(this,arguments)},We)},count:function(fe){var De=0;return ue(fe,function(){De++}),De},toArray:function(fe){return ue(fe,function(De){return De})||[]},only:function(fe){if(!Ee(fe))throw Error("React.Children.only expected to receive a single React element child.");return fe}},react_production_min.Component=Q,react_production_min.Fragment=a,react_production_min.Profiler=p,react_production_min.PureComponent=K,react_production_min.StrictMode=c,react_production_min.Suspense=m,react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=X,react_production_min.act=Re,react_production_min.cloneElement=function(fe,De,We){if(fe==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+fe+".");var oe=T({},fe.props),Ae=fe.key,He=fe.ref,Ue=fe._owner;if(De!=null){if(De.ref!==void 0&&(He=De.ref,Ue=U.current),De.key!==void 0&&(Ae=""+De.key),fe.type&&fe.type.defaultProps)var Ie=fe.type.defaultProps;for(rt in De)V.call(De,rt)&&!Z.hasOwnProperty(rt)&&(oe[rt]=De[rt]===void 0&&Ie!==void 0?Ie[rt]:De[rt])}var rt=arguments.length-2;if(rt===1)oe.children=We;else if(1<rt){Ie=Array(rt);for(var st=0;st<rt;st++)Ie[st]=arguments[st+2];oe.children=Ie}return{$$typeof:r,type:fe.type,key:Ae,ref:He,props:oe,_owner:Ue}},react_production_min.createContext=function(fe){return fe={$$typeof:u,_currentValue:fe,_currentValue2:fe,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},fe.Provider={$$typeof:D,_context:fe},fe.Consumer=fe},react_production_min.createElement=L,react_production_min.createFactory=function(fe){var De=L.bind(null,fe);return De.type=fe,De},react_production_min.createRef=function(){return{current:null}},react_production_min.forwardRef=function(fe){return{$$typeof:v,render:fe}},react_production_min.isValidElement=Ee,react_production_min.lazy=function(fe){return{$$typeof:C,_payload:{_status:-1,_result:fe},_init:I}},react_production_min.memo=function(fe,De){return{$$typeof:_,type:fe,compare:De===void 0?null:De}},react_production_min.startTransition=function(fe){var De=se.transition;se.transition={};try{fe()}finally{se.transition=De}},react_production_min.unstable_act=Re,react_production_min.useCallback=function(fe,De){return ce.current.useCallback(fe,De)},react_production_min.useContext=function(fe){return ce.current.useContext(fe)},react_production_min.useDebugValue=function(){},react_production_min.useDeferredValue=function(fe){return ce.current.useDeferredValue(fe)},react_production_min.useEffect=function(fe,De){return ce.current.useEffect(fe,De)},react_production_min.useId=function(){return ce.current.useId()},react_production_min.useImperativeHandle=function(fe,De,We){return ce.current.useImperativeHandle(fe,De,We)},react_production_min.useInsertionEffect=function(fe,De){return ce.current.useInsertionEffect(fe,De)},react_production_min.useLayoutEffect=function(fe,De){return ce.current.useLayoutEffect(fe,De)},react_production_min.useMemo=function(fe,De){return ce.current.useMemo(fe,De)},react_production_min.useReducer=function(fe,De,We){return ce.current.useReducer(fe,De,We)},react_production_min.useRef=function(fe){return ce.current.useRef(fe)},react_production_min.useState=function(fe){return ce.current.useState(fe)},react_production_min.useSyncExternalStore=function(fe,De,We){return ce.current.useSyncExternalStore(fe,De,We)},react_production_min.useTransition=function(){return ce.current.useTransition()},react_production_min.version="18.3.1",react_production_min}var hasRequiredReact;function requireReact(){return hasRequiredReact||(hasRequiredReact=1,react.exports=requireReact_production_min()),react.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactJsxRuntime_production_min;function requireReactJsxRuntime_production_min(){if(hasRequiredReactJsxRuntime_production_min)return reactJsxRuntime_production_min;hasRequiredReactJsxRuntime_production_min=1;var r=requireReact(),n=Symbol.for("react.element"),a=Symbol.for("react.fragment"),c=Object.prototype.hasOwnProperty,p=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,D={key:!0,ref:!0,__self:!0,__source:!0};function u(v,m,_){var C,w={},k=null,F=null;_!==void 0&&(k=""+_),m.key!==void 0&&(k=""+m.key),m.ref!==void 0&&(F=m.ref);for(C in m)c.call(m,C)&&!D.hasOwnProperty(C)&&(w[C]=m[C]);if(v&&v.defaultProps)for(C in m=v.defaultProps,m)w[C]===void 0&&(w[C]=m[C]);return{$$typeof:n,type:v,key:k,ref:F,props:w,_owner:p.current}}return reactJsxRuntime_production_min.Fragment=a,reactJsxRuntime_production_min.jsx=u,reactJsxRuntime_production_min.jsxs=u,reactJsxRuntime_production_min}var hasRequiredJsxRuntime;function requireJsxRuntime(){return hasRequiredJsxRuntime||(hasRequiredJsxRuntime=1,jsxRuntime.exports=requireReactJsxRuntime_production_min()),jsxRuntime.exports}var jsxRuntimeExports=requireJsxRuntime(),reactExports=requireReact(),client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredScheduler_production_min;function requireScheduler_production_min(){return hasRequiredScheduler_production_min||(hasRequiredScheduler_production_min=1,(function(r){function n(se,X){var Re=se.length;se.push(X);e:for(;0<Re;){var fe=Re-1>>>1,De=se[fe];if(0<p(De,X))se[fe]=X,se[Re]=De,Re=fe;else break e}}function a(se){return se.length===0?null:se[0]}function c(se){if(se.length===0)return null;var X=se[0],Re=se.pop();if(Re!==X){se[0]=Re;e:for(var fe=0,De=se.length,We=De>>>1;fe<We;){var oe=2*(fe+1)-1,Ae=se[oe],He=oe+1,Ue=se[He];if(0>p(Ae,Re))He<De&&0>p(Ue,Ae)?(se[fe]=Ue,se[He]=Re,fe=He):(se[fe]=Ae,se[oe]=Re,fe=oe);else if(He<De&&0>p(Ue,Re))se[fe]=Ue,se[He]=Re,fe=He;else break e}}return X}function p(se,X){var Re=se.sortIndex-X.sortIndex;return Re!==0?Re:se.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var D=performance;r.unstable_now=function(){return D.now()}}else{var u=Date,v=u.now();r.unstable_now=function(){return u.now()-v}}var m=[],_=[],C=1,w=null,k=3,F=!1,T=!1,z=!1,Q=typeof setTimeout=="function"?setTimeout:null,J=typeof clearTimeout=="function"?clearTimeout:null,K=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(se){for(var X=a(_);X!==null;){if(X.callback===null)c(_);else if(X.startTime<=se)c(_),X.sortIndex=X.expirationTime,n(m,X);else break;X=a(_)}}function N(se){if(z=!1,b(se),!T)if(a(m)!==null)T=!0,I(V);else{var X=a(_);X!==null&&ce(N,X.startTime-se)}}function V(se,X){T=!1,z&&(z=!1,J(L),L=-1),F=!0;var Re=k;try{for(b(X),w=a(m);w!==null&&(!(w.expirationTime>X)||se&&!he());){var fe=w.callback;if(typeof fe=="function"){w.callback=null,k=w.priorityLevel;var De=fe(w.expirationTime<=X);X=r.unstable_now(),typeof De=="function"?w.callback=De:w===a(m)&&c(m),b(X)}else c(m);w=a(m)}if(w!==null)var We=!0;else{var oe=a(_);oe!==null&&ce(N,oe.startTime-X),We=!1}return We}finally{w=null,k=Re,F=!1}}var U=!1,Z=null,L=-1,ee=5,Ee=-1;function he(){return!(r.unstable_now()-Ee<ee)}function ge(){if(Z!==null){var se=r.unstable_now();Ee=se;var X=!0;try{X=Z(!0,se)}finally{X?me():(U=!1,Z=null)}}else U=!1}var me;if(typeof K=="function")me=function(){K(ge)};else if(typeof MessageChannel<"u"){var Me=new MessageChannel,ue=Me.port2;Me.port1.onmessage=ge,me=function(){ue.postMessage(null)}}else me=function(){Q(ge,0)};function I(se){Z=se,U||(U=!0,me())}function ce(se,X){L=Q(function(){se(r.unstable_now())},X)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(se){se.callback=null},r.unstable_continueExecution=function(){T||F||(T=!0,I(V))},r.unstable_forceFrameRate=function(se){0>se||125<se?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ee=0<se?Math.floor(1e3/se):5},r.unstable_getCurrentPriorityLevel=function(){return k},r.unstable_getFirstCallbackNode=function(){return a(m)},r.unstable_next=function(se){switch(k){case 1:case 2:case 3:var X=3;break;default:X=k}var Re=k;k=X;try{return se()}finally{k=Re}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(se,X){switch(se){case 1:case 2:case 3:case 4:case 5:break;default:se=3}var Re=k;k=se;try{return X()}finally{k=Re}},r.unstable_scheduleCallback=function(se,X,Re){var fe=r.unstable_now();switch(typeof Re=="object"&&Re!==null?(Re=Re.delay,Re=typeof Re=="number"&&0<Re?fe+Re:fe):Re=fe,se){case 1:var De=-1;break;case 2:De=250;break;case 5:De=1073741823;break;case 4:De=1e4;break;default:De=5e3}return De=Re+De,se={id:C++,callback:X,priorityLevel:se,startTime:Re,expirationTime:De,sortIndex:-1},Re>fe?(se.sortIndex=Re,n(_,se),a(m)===null&&se===a(_)&&(z?(J(L),L=-1):z=!0,ce(N,Re-fe))):(se.sortIndex=De,n(m,se),T||F||(T=!0,I(V))),se},r.unstable_shouldYield=he,r.unstable_wrapCallback=function(se){var X=k;return function(){var Re=k;k=X;try{return se.apply(this,arguments)}finally{k=Re}}}})(scheduler_production_min)),scheduler_production_min}var hasRequiredScheduler;function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler.exports=requireScheduler_production_min()),scheduler.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactDom_production_min;function requireReactDom_production_min(){if(hasRequiredReactDom_production_min)return reactDom_production_min;hasRequiredReactDom_production_min=1;var r=requireReact(),n=requireScheduler();function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,o=1;o<arguments.length;o++)t+="&args[]="+encodeURIComponent(arguments[o]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var c=new Set,p={};function D(e,t){u(e,t),u(e+"Capture",t)}function u(e,t){for(p[e]=t,e=0;e<t.length;e++)c.add(t[e])}var v=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),m=Object.prototype.hasOwnProperty,_=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,C={},w={};function k(e){return m.call(w,e)?!0:m.call(C,e)?!1:_.test(e)?w[e]=!0:(C[e]=!0,!1)}function F(e,t,o,d){if(o!==null&&o.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return d?!1:o!==null?!o.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function T(e,t,o,d){if(t===null||typeof t>"u"||F(e,t,o,d))return!0;if(d)return!1;if(o!==null)switch(o.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function z(e,t,o,d,P,B,ie){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=d,this.attributeNamespace=P,this.mustUseProperty=o,this.propertyName=e,this.type=t,this.sanitizeURL=B,this.removeEmptyString=ie}var Q={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Q[e]=new z(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Q[t]=new z(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){Q[e]=new z(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Q[e]=new z(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Q[e]=new z(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){Q[e]=new z(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){Q[e]=new z(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){Q[e]=new z(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){Q[e]=new z(e,5,!1,e.toLowerCase(),null,!1,!1)});var J=/[\-:]([a-z])/g;function K(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(J,K);Q[t]=new z(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(J,K);Q[t]=new z(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(J,K);Q[t]=new z(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){Q[e]=new z(e,1,!1,e.toLowerCase(),null,!1,!1)}),Q.xlinkHref=new z("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){Q[e]=new z(e,1,!1,e.toLowerCase(),null,!0,!0)});function b(e,t,o,d){var P=Q.hasOwnProperty(t)?Q[t]:null;(P!==null?P.type!==0:d||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(T(t,o,P,d)&&(o=null),d||P===null?k(t)&&(o===null?e.removeAttribute(t):e.setAttribute(t,""+o)):P.mustUseProperty?e[P.propertyName]=o===null?P.type===3?!1:"":o:(t=P.attributeName,d=P.attributeNamespace,o===null?e.removeAttribute(t):(P=P.type,o=P===3||P===4&&o===!0?"":""+o,d?e.setAttributeNS(d,t,o):e.setAttribute(t,o))))}var N=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,V=Symbol.for("react.element"),U=Symbol.for("react.portal"),Z=Symbol.for("react.fragment"),L=Symbol.for("react.strict_mode"),ee=Symbol.for("react.profiler"),Ee=Symbol.for("react.provider"),he=Symbol.for("react.context"),ge=Symbol.for("react.forward_ref"),me=Symbol.for("react.suspense"),Me=Symbol.for("react.suspense_list"),ue=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),ce=Symbol.for("react.offscreen"),se=Symbol.iterator;function X(e){return e===null||typeof e!="object"?null:(e=se&&e[se]||e["@@iterator"],typeof e=="function"?e:null)}var Re=Object.assign,fe;function De(e){if(fe===void 0)try{throw Error()}catch(o){var t=o.stack.trim().match(/\n( *(at )?)/);fe=t&&t[1]||""}return`
`+fe+e}var We=!1;function oe(e,t){if(!e||We)return"";We=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(Ze){var d=Ze}Reflect.construct(e,[],t)}else{try{t.call()}catch(Ze){d=Ze}e.call(t.prototype)}else{try{throw Error()}catch(Ze){d=Ze}e()}}catch(Ze){if(Ze&&d&&typeof Ze.stack=="string"){for(var P=Ze.stack.split(`
`),B=d.stack.split(`
`),ie=P.length-1,Ce=B.length-1;1<=ie&&0<=Ce&&P[ie]!==B[Ce];)Ce--;for(;1<=ie&&0<=Ce;ie--,Ce--)if(P[ie]!==B[Ce]){if(ie!==1||Ce!==1)do if(ie--,Ce--,0>Ce||P[ie]!==B[Ce]){var Fe=`
`+P[ie].replace(" at new "," at ");return e.displayName&&Fe.includes("<anonymous>")&&(Fe=Fe.replace("<anonymous>",e.displayName)),Fe}while(1<=ie&&0<=Ce);break}}}finally{We=!1,Error.prepareStackTrace=o}return(e=e?e.displayName||e.name:"")?De(e):""}function Ae(e){switch(e.tag){case 5:return De(e.type);case 16:return De("Lazy");case 13:return De("Suspense");case 19:return De("SuspenseList");case 0:case 2:case 15:return e=oe(e.type,!1),e;case 11:return e=oe(e.type.render,!1),e;case 1:return e=oe(e.type,!0),e;default:return""}}function He(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Z:return"Fragment";case U:return"Portal";case ee:return"Profiler";case L:return"StrictMode";case me:return"Suspense";case Me:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case he:return(e.displayName||"Context")+".Consumer";case Ee:return(e._context.displayName||"Context")+".Provider";case ge:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case ue:return t=e.displayName||null,t!==null?t:He(e.type)||"Memo";case I:t=e._payload,e=e._init;try{return He(e(t))}catch{}}return null}function Ue(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return He(t);case 8:return t===L?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Ie(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function rt(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function st(e){var t=rt(e)?"checked":"value",o=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),d=""+e[t];if(!e.hasOwnProperty(t)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var P=o.get,B=o.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return P.call(this)},set:function(ie){d=""+ie,B.call(this,ie)}}),Object.defineProperty(e,t,{enumerable:o.enumerable}),{getValue:function(){return d},setValue:function(ie){d=""+ie},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function at(e){e._valueTracker||(e._valueTracker=st(e))}function Ft(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var o=t.getValue(),d="";return e&&(d=rt(e)?e.checked?"true":"false":e.value),e=d,e!==o?(t.setValue(e),!0):!1}function Et(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function or(e,t){var o=t.checked;return Re({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:o??e._wrapperState.initialChecked})}function ar(e,t){var o=t.defaultValue==null?"":t.defaultValue,d=t.checked!=null?t.checked:t.defaultChecked;o=Ie(t.value!=null?t.value:o),e._wrapperState={initialChecked:d,initialValue:o,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function kr(e,t){t=t.checked,t!=null&&b(e,"checked",t,!1)}function Ar(e,t){kr(e,t);var o=Ie(t.value),d=t.type;if(o!=null)d==="number"?(o===0&&e.value===""||e.value!=o)&&(e.value=""+o):e.value!==""+o&&(e.value=""+o);else if(d==="submit"||d==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?vr(e,t.type,o):t.hasOwnProperty("defaultValue")&&vr(e,t.type,Ie(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function pr(e,t,o){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var d=t.type;if(!(d!=="submit"&&d!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,o||t===e.value||(e.value=t),e.defaultValue=t}o=e.name,o!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,o!==""&&(e.name=o)}function vr(e,t,o){(t!=="number"||Et(e.ownerDocument)!==e)&&(o==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+o&&(e.defaultValue=""+o))}var xr=Array.isArray;function fi(e,t,o,d){if(e=e.options,t){t={};for(var P=0;P<o.length;P++)t["$"+o[P]]=!0;for(o=0;o<e.length;o++)P=t.hasOwnProperty("$"+e[o].value),e[o].selected!==P&&(e[o].selected=P),P&&d&&(e[o].defaultSelected=!0)}else{for(o=""+Ie(o),t=null,P=0;P<e.length;P++){if(e[P].value===o){e[P].selected=!0,d&&(e[P].defaultSelected=!0);return}t!==null||e[P].disabled||(t=e[P])}t!==null&&(t.selected=!0)}}function Rr(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(a(91));return Re({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Ir(e,t){var o=t.value;if(o==null){if(o=t.children,t=t.defaultValue,o!=null){if(t!=null)throw Error(a(92));if(xr(o)){if(1<o.length)throw Error(a(93));o=o[0]}t=o}t==null&&(t=""),o=t}e._wrapperState={initialValue:Ie(o)}}function Di(e,t){var o=Ie(t.value),d=Ie(t.defaultValue);o!=null&&(o=""+o,o!==e.value&&(e.value=o),t.defaultValue==null&&e.defaultValue!==o&&(e.defaultValue=o)),d!=null&&(e.defaultValue=""+d)}function wi(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Hi(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function pe(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Hi(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Se,Oe=(function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,o,d,P){MSApp.execUnsafeLocalFunction(function(){return e(t,o,d,P)})}:e})(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Se=Se||document.createElement("div"),Se.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Se.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function dt(e,t){if(t){var o=e.firstChild;if(o&&o===e.lastChild&&o.nodeType===3){o.nodeValue=t;return}}e.textContent=t}var nt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},zt=["Webkit","ms","Moz","O"];Object.keys(nt).forEach(function(e){zt.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),nt[t]=nt[e]})});function ht(e,t,o){return t==null||typeof t=="boolean"||t===""?"":o||typeof t!="number"||t===0||nt.hasOwnProperty(e)&&nt[e]?(""+t).trim():t+"px"}function Ot(e,t){e=e.style;for(var o in t)if(t.hasOwnProperty(o)){var d=o.indexOf("--")===0,P=ht(o,t[o],d);o==="float"&&(o="cssFloat"),d?e.setProperty(o,P):e[o]=P}}var Ut=Re({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function It(e,t){if(t){if(Ut[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(a(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(a(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(t.style!=null&&typeof t.style!="object")throw Error(a(62))}}function mr(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var li=null;function Ei(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var ui=null,gi=null,jr=null;function Or(e){if(e=Is(e)){if(typeof ui!="function")throw Error(a(280));var t=e.stateNode;t&&(t=ro(t),ui(e.stateNode,e.type,t))}}function Dr(e){gi?jr?jr.push(e):jr=[e]:gi=e}function rr(){if(gi){var e=gi,t=jr;if(jr=gi=null,Or(e),t)for(e=0;e<t.length;e++)Or(t[e])}}function vi(e,t){return e(t)}function bi(){}var Ki=!1;function Ci(e,t,o){if(Ki)return e(t,o);Ki=!0;try{return vi(e,t,o)}finally{Ki=!1,(gi!==null||jr!==null)&&(bi(),rr())}}function Ni(e,t){var o=e.stateNode;if(o===null)return null;var d=ro(o);if(d===null)return null;o=d[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(e=e.type,d=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!d;break e;default:e=!1}if(e)return null;if(o&&typeof o!="function")throw Error(a(231,t,typeof o));return o}var Ti=!1;if(v)try{var pi={};Object.defineProperty(pi,"passive",{get:function(){Ti=!0}}),window.addEventListener("test",pi,pi),window.removeEventListener("test",pi,pi)}catch{Ti=!1}function Br(e,t,o,d,P,B,ie,Ce,Fe){var Ze=Array.prototype.slice.call(arguments,3);try{t.apply(o,Ze)}catch(xt){this.onError(xt)}}var Yr=!1,Vi=null,yi=!1,Wi=null,tn={onError:function(e){Yr=!0,Vi=e}};function on(e,t,o,d,P,B,ie,Ce,Fe){Yr=!1,Vi=null,Br.apply(tn,arguments)}function ur(e,t,o,d,P,B,ie,Ce,Fe){if(on.apply(this,arguments),Yr){if(Yr){var Ze=Vi;Yr=!1,Vi=null}else throw Error(a(198));yi||(yi=!0,Wi=Ze)}}function Gr(e){var t=e,o=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(o=t.return),e=t.return;while(e)}return t.tag===3?o:null}function Kr(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function qi(e){if(Gr(e)!==e)throw Error(a(188))}function Bt(e){var t=e.alternate;if(!t){if(t=Gr(e),t===null)throw Error(a(188));return t!==e?null:e}for(var o=e,d=t;;){var P=o.return;if(P===null)break;var B=P.alternate;if(B===null){if(d=P.return,d!==null){o=d;continue}break}if(P.child===B.child){for(B=P.child;B;){if(B===o)return qi(P),e;if(B===d)return qi(P),t;B=B.sibling}throw Error(a(188))}if(o.return!==d.return)o=P,d=B;else{for(var ie=!1,Ce=P.child;Ce;){if(Ce===o){ie=!0,o=P,d=B;break}if(Ce===d){ie=!0,d=P,o=B;break}Ce=Ce.sibling}if(!ie){for(Ce=B.child;Ce;){if(Ce===o){ie=!0,o=B,d=P;break}if(Ce===d){ie=!0,d=B,o=P;break}Ce=Ce.sibling}if(!ie)throw Error(a(189))}}if(o.alternate!==d)throw Error(a(190))}if(o.tag!==3)throw Error(a(188));return o.stateNode.current===o?e:t}function x(e){return e=Bt(e),e!==null?ne(e):null}function ne(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=ne(e);if(t!==null)return t;e=e.sibling}return null}var xe=n.unstable_scheduleCallback,Ve=n.unstable_cancelCallback,Le=n.unstable_shouldYield,yt=n.unstable_requestPaint,lt=n.unstable_now,mt=n.unstable_getCurrentPriorityLevel,Mt=n.unstable_ImmediatePriority,Pt=n.unstable_UserBlockingPriority,Lt=n.unstable_NormalPriority,gr=n.unstable_LowPriority,Yt=n.unstable_IdlePriority,Er=null,Cr=null;function Ur(e){if(Cr&&typeof Cr.onCommitFiberRoot=="function")try{Cr.onCommitFiberRoot(Er,e,void 0,(e.current.flags&128)===128)}catch{}}var _r=Math.clz32?Math.clz32:Mi,Lr=Math.log,wr=Math.LN2;function Mi(e){return e>>>=0,e===0?32:31-(Lr(e)/wr|0)|0}var Qt=64,ri=4194304;function ae(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function i(e,t){var o=e.pendingLanes;if(o===0)return 0;var d=0,P=e.suspendedLanes,B=e.pingedLanes,ie=o&268435455;if(ie!==0){var Ce=ie&~P;Ce!==0?d=ae(Ce):(B&=ie,B!==0&&(d=ae(B)))}else ie=o&~P,ie!==0?d=ae(ie):B!==0&&(d=ae(B));if(d===0)return 0;if(t!==0&&t!==d&&(t&P)===0&&(P=d&-d,B=t&-t,P>=B||P===16&&(B&4194240)!==0))return t;if((d&4)!==0&&(d|=o&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=d;0<t;)o=31-_r(t),P=1<<o,d|=e[o],t&=~P;return d}function s(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function l(e,t){for(var o=e.suspendedLanes,d=e.pingedLanes,P=e.expirationTimes,B=e.pendingLanes;0<B;){var ie=31-_r(B),Ce=1<<ie,Fe=P[ie];Fe===-1?((Ce&o)===0||(Ce&d)!==0)&&(P[ie]=s(Ce,t)):Fe<=t&&(e.expiredLanes|=Ce),B&=~Ce}}function h(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function A(){var e=Qt;return Qt<<=1,(Qt&4194240)===0&&(Qt=64),e}function g(e){for(var t=[],o=0;31>o;o++)t.push(e);return t}function E(e,t,o){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-_r(t),e[t]=o}function M(e,t){var o=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var d=e.eventTimes;for(e=e.expirationTimes;0<o;){var P=31-_r(o),B=1<<P;t[P]=0,d[P]=-1,e[P]=-1,o&=~B}}function S(e,t){var o=e.entangledLanes|=t;for(e=e.entanglements;o;){var d=31-_r(o),P=1<<d;P&t|e[d]&t&&(e[d]|=t),o&=~P}}var R=0;function O(e){return e&=-e,1<e?4<e?(e&268435455)!==0?16:536870912:4:1}var $,G,j,W,H,Y=!1,te=[],re=null,de=null,le=null,ye=new Map,Pe=new Map,Te=[],ke="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function we(e,t){switch(e){case"focusin":case"focusout":re=null;break;case"dragenter":case"dragleave":de=null;break;case"mouseover":case"mouseout":le=null;break;case"pointerover":case"pointerout":ye.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pe.delete(t.pointerId)}}function Ge(e,t,o,d,P,B){return e===null||e.nativeEvent!==B?(e={blockedOn:t,domEventName:o,eventSystemFlags:d,nativeEvent:B,targetContainers:[P]},t!==null&&(t=Is(t),t!==null&&G(t)),e):(e.eventSystemFlags|=d,t=e.targetContainers,P!==null&&t.indexOf(P)===-1&&t.push(P),e)}function Je(e,t,o,d,P){switch(t){case"focusin":return re=Ge(re,e,t,o,d,P),!0;case"dragenter":return de=Ge(de,e,t,o,d,P),!0;case"mouseover":return le=Ge(le,e,t,o,d,P),!0;case"pointerover":var B=P.pointerId;return ye.set(B,Ge(ye.get(B)||null,e,t,o,d,P)),!0;case"gotpointercapture":return B=P.pointerId,Pe.set(B,Ge(Pe.get(B)||null,e,t,o,d,P)),!0}return!1}function tt(e){var t=Kn(e.target);if(t!==null){var o=Gr(t);if(o!==null){if(t=o.tag,t===13){if(t=Kr(o),t!==null){e.blockedOn=t,H(e.priority,function(){j(o)});return}}else if(t===3&&o.stateNode.current.memoizedState.isDehydrated){e.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ye(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var o=it(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(o===null){o=e.nativeEvent;var d=new o.constructor(o.type,o);li=d,o.target.dispatchEvent(d),li=null}else return t=Is(o),t!==null&&G(t),e.blockedOn=o,!1;t.shift()}return!0}function ut(e,t,o){Ye(e)&&o.delete(t)}function ft(){Y=!1,re!==null&&Ye(re)&&(re=null),de!==null&&Ye(de)&&(de=null),le!==null&&Ye(le)&&(le=null),ye.forEach(ut),Pe.forEach(ut)}function Qe(e,t){e.blockedOn===t&&(e.blockedOn=null,Y||(Y=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,ft)))}function pt(e){function t(P){return Qe(P,e)}if(0<te.length){Qe(te[0],e);for(var o=1;o<te.length;o++){var d=te[o];d.blockedOn===e&&(d.blockedOn=null)}}for(re!==null&&Qe(re,e),de!==null&&Qe(de,e),le!==null&&Qe(le,e),ye.forEach(t),Pe.forEach(t),o=0;o<Te.length;o++)d=Te[o],d.blockedOn===e&&(d.blockedOn=null);for(;0<Te.length&&(o=Te[0],o.blockedOn===null);)tt(o),o.blockedOn===null&&Te.shift()}var Be=N.ReactCurrentBatchConfig,et=!0;function St(e,t,o,d){var P=R,B=Be.transition;Be.transition=null;try{R=1,wt(e,t,o,d)}finally{R=P,Be.transition=B}}function ot(e,t,o,d){var P=R,B=Be.transition;Be.transition=null;try{R=4,wt(e,t,o,d)}finally{R=P,Be.transition=B}}function wt(e,t,o,d){if(et){var P=it(e,t,o,d);if(P===null)Yo(e,t,d,At,o),we(e,d);else if(Je(P,e,t,o,d))d.stopPropagation();else if(we(e,d),t&4&&-1<ke.indexOf(e)){for(;P!==null;){var B=Is(P);if(B!==null&&$(B),B=it(e,t,o,d),B===null&&Yo(e,t,d,At,o),B===P)break;P=B}P!==null&&d.stopPropagation()}else Yo(e,t,d,null,o)}}var At=null;function it(e,t,o,d){if(At=null,e=Ei(d),e=Kn(e),e!==null)if(t=Gr(e),t===null)e=null;else if(o=t.tag,o===13){if(e=Kr(t),e!==null)return e;e=null}else if(o===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return At=e,null}function Rt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(mt()){case Mt:return 1;case Pt:return 4;case Lt:case gr:return 16;case Yt:return 536870912;default:return 16}default:return 16}}var Ht=null,kt=null,ct=null;function Jt(){if(ct)return ct;var e,t=kt,o=t.length,d,P="value"in Ht?Ht.value:Ht.textContent,B=P.length;for(e=0;e<o&&t[e]===P[e];e++);var ie=o-e;for(d=1;d<=ie&&t[o-d]===P[B-d];d++);return ct=P.slice(e,1<d?1-d:void 0)}function Nt(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function qt(){return!0}function Vt(){return!1}function Xt(e){function t(o,d,P,B,ie){this._reactName=o,this._targetInst=P,this.type=d,this.nativeEvent=B,this.target=ie,this.currentTarget=null;for(var Ce in e)e.hasOwnProperty(Ce)&&(o=e[Ce],this[Ce]=o?o(B):B[Ce]);return this.isDefaultPrevented=(B.defaultPrevented!=null?B.defaultPrevented:B.returnValue===!1)?qt:Vt,this.isPropagationStopped=Vt,this}return Re(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=qt)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=qt)},persist:function(){},isPersistent:qt}),t}var yr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Fr=Xt(yr),Tr=Re({},yr,{view:0,detail:0}),ii=Xt(Tr),Wr,br,$r,ci=Re({},Tr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Xe,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==$r&&($r&&e.type==="mousemove"?(Wr=e.screenX-$r.screenX,br=e.screenY-$r.screenY):br=Wr=0,$r=e),Wr)},movementY:function(e){return"movementY"in e?e.movementY:br}}),ni=Xt(ci),hi=Re({},ci,{dataTransfer:0}),zi=Xt(hi),xi=Re({},Tr,{relatedTarget:0}),Ii=Xt(xi),Hr=Re({},yr,{animationName:0,elapsedTime:0,pseudoElement:0}),Xr=Xt(Hr),qr=Re({},yr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),ei=Xt(qr),f=Re({},yr,{data:0}),q=Xt(f),y={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},be={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_e={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ve(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=_e[e])?!!t[e]:!1}function Xe(){return ve}var ze=Re({},Tr,{key:function(e){if(e.key){var t=y[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Nt(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?be[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Xe,charCode:function(e){return e.type==="keypress"?Nt(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Nt(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),gt=Xt(ze),Ne=Re({},ci,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ke=Xt(Ne),dr=Re({},Tr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Xe}),Wt=Xt(dr),_t=Re({},yr,{propertyName:0,elapsedTime:0,pseudoElement:0}),si=Xt(_t),Mr=Re({},ci,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),er=Xt(Mr),zr=[9,13,27,32],lr=v&&"CompositionEvent"in window,Ct=null;v&&"documentMode"in document&&(Ct=document.documentMode);var sr=v&&"TextEvent"in window&&!Ct,Pr=v&&(!lr||Ct&&8<Ct&&11>=Ct),Dt=" ",Sr=!1;function cr(e,t){switch(e){case"keyup":return zr.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function tr(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var fr=!1;function Oi(e,t){switch(e){case"compositionend":return tr(t);case"keypress":return t.which!==32?null:(Sr=!0,Dt);case"textInput":return e=t.data,e===Dt&&Sr?null:e;default:return null}}function Wn(e,t){if(fr)return e==="compositionend"||!lr&&cr(e,t)?(e=Jt(),ct=kt=Ht=null,fr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Pr&&t.locale!=="ko"?null:t.data;default:return null}}var os={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $n(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!os[e.type]:t==="textarea"}function Xn(e,t,o,d){Dr(d),t=Js(t,"onChange"),0<t.length&&(o=new Fr("onChange","change",null,o,d),e.push({event:o,listeners:t}))}var Cs=null,Ts=null;function lc(e){Al(e,0)}function qs(e){var t=hs(e);if(Ft(t))return e}function uc(e,t){if(e==="change")return t}var al=!1;if(v){var Uo;if(v){var Go="oninput"in document;if(!Go){var ll=document.createElement("div");ll.setAttribute("oninput","return;"),Go=typeof ll.oninput=="function"}Uo=Go}else Uo=!1;al=Uo&&(!document.documentMode||9<document.documentMode)}function ul(){Cs&&(Cs.detachEvent("onpropertychange",cl),Ts=Cs=null)}function cl(e){if(e.propertyName==="value"&&qs(Ts)){var t=[];Xn(t,Ts,e,Ei(e)),Ci(lc,t)}}function cc(e,t,o){e==="focusin"?(ul(),Cs=t,Ts=o,Cs.attachEvent("onpropertychange",cl)):e==="focusout"&&ul()}function hc(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return qs(Ts)}function dc(e,t){if(e==="click")return qs(t)}function fc(e,t){if(e==="input"||e==="change")return qs(t)}function pc(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var fn=typeof Object.is=="function"?Object.is:pc;function Ms(e,t){if(fn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var o=Object.keys(e),d=Object.keys(t);if(o.length!==d.length)return!1;for(d=0;d<o.length;d++){var P=o[d];if(!m.call(t,P)||!fn(e[P],t[P]))return!1}return!0}function hl(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function dl(e,t){var o=hl(e);e=0;for(var d;o;){if(o.nodeType===3){if(d=e+o.textContent.length,e<=t&&d>=t)return{node:o,offset:t-e};e=d}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=hl(o)}}function fl(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?fl(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function pl(){for(var e=window,t=Et();t instanceof e.HTMLIFrameElement;){try{var o=typeof t.contentWindow.location.href=="string"}catch{o=!1}if(o)e=t.contentWindow;else break;t=Et(e.document)}return t}function Ho(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function mc(e){var t=pl(),o=e.focusedElem,d=e.selectionRange;if(t!==o&&o&&o.ownerDocument&&fl(o.ownerDocument.documentElement,o)){if(d!==null&&Ho(o)){if(t=d.start,e=d.end,e===void 0&&(e=t),"selectionStart"in o)o.selectionStart=t,o.selectionEnd=Math.min(e,o.value.length);else if(e=(t=o.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var P=o.textContent.length,B=Math.min(d.start,P);d=d.end===void 0?B:Math.min(d.end,P),!e.extend&&B>d&&(P=d,d=B,B=P),P=dl(o,B);var ie=dl(o,d);P&&ie&&(e.rangeCount!==1||e.anchorNode!==P.node||e.anchorOffset!==P.offset||e.focusNode!==ie.node||e.focusOffset!==ie.offset)&&(t=t.createRange(),t.setStart(P.node,P.offset),e.removeAllRanges(),B>d?(e.addRange(t),e.extend(ie.node,ie.offset)):(t.setEnd(ie.node,ie.offset),e.addRange(t)))}}for(t=[],e=o;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<t.length;o++)e=t[o],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var gc=v&&"documentMode"in document&&11>=document.documentMode,as=null,Wo=null,ks=null,$o=!1;function ml(e,t,o){var d=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;$o||as==null||as!==Et(d)||(d=as,"selectionStart"in d&&Ho(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),ks&&Ms(ks,d)||(ks=d,d=Js(Wo,"onSelect"),0<d.length&&(t=new Fr("onSelect","select",null,t,o),e.push({event:t,listeners:d}),t.target=as)))}function Zs(e,t){var o={};return o[e.toLowerCase()]=t.toLowerCase(),o["Webkit"+e]="webkit"+t,o["Moz"+e]="moz"+t,o}var ls={animationend:Zs("Animation","AnimationEnd"),animationiteration:Zs("Animation","AnimationIteration"),animationstart:Zs("Animation","AnimationStart"),transitionend:Zs("Transition","TransitionEnd")},Xo={},gl={};v&&(gl=document.createElement("div").style,"AnimationEvent"in window||(delete ls.animationend.animation,delete ls.animationiteration.animation,delete ls.animationstart.animation),"TransitionEvent"in window||delete ls.transitionend.transition);function Ys(e){if(Xo[e])return Xo[e];if(!ls[e])return e;var t=ls[e],o;for(o in t)if(t.hasOwnProperty(o)&&o in gl)return Xo[e]=t[o];return e}var vl=Ys("animationend"),yl=Ys("animationiteration"),xl=Ys("animationstart"),_l=Ys("transitionend"),wl=new Map,bl="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pn(e,t){wl.set(e,t),D(t,[e])}for(var Ko=0;Ko<bl.length;Ko++){var qo=bl[Ko],vc=qo.toLowerCase(),yc=qo[0].toUpperCase()+qo.slice(1);Pn(vc,"on"+yc)}Pn(vl,"onAnimationEnd"),Pn(yl,"onAnimationIteration"),Pn(xl,"onAnimationStart"),Pn("dblclick","onDoubleClick"),Pn("focusin","onFocus"),Pn("focusout","onBlur"),Pn(_l,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),D("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),D("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),D("onBeforeInput",["compositionend","keypress","textInput","paste"]),D("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),D("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),D("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),xc=new Set("cancel close invalid load scroll toggle".split(" ").concat(Rs));function Sl(e,t,o){var d=e.type||"unknown-event";e.currentTarget=o,ur(d,t,void 0,e),e.currentTarget=null}function Al(e,t){t=(t&4)!==0;for(var o=0;o<e.length;o++){var d=e[o],P=d.event;d=d.listeners;e:{var B=void 0;if(t)for(var ie=d.length-1;0<=ie;ie--){var Ce=d[ie],Fe=Ce.instance,Ze=Ce.currentTarget;if(Ce=Ce.listener,Fe!==B&&P.isPropagationStopped())break e;Sl(P,Ce,Ze),B=Fe}else for(ie=0;ie<d.length;ie++){if(Ce=d[ie],Fe=Ce.instance,Ze=Ce.currentTarget,Ce=Ce.listener,Fe!==B&&P.isPropagationStopped())break e;Sl(P,Ce,Ze),B=Fe}}}if(yi)throw e=Wi,yi=!1,Wi=null,e}function Qr(e,t){var o=t[ia];o===void 0&&(o=t[ia]=new Set);var d=e+"__bubble";o.has(d)||(El(t,e,2,!1),o.add(d))}function Zo(e,t,o){var d=0;t&&(d|=4),El(o,e,d,t)}var Qs="_reactListening"+Math.random().toString(36).slice(2);function Ps(e){if(!e[Qs]){e[Qs]=!0,c.forEach(function(o){o!=="selectionchange"&&(xc.has(o)||Zo(o,!1,e),Zo(o,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Qs]||(t[Qs]=!0,Zo("selectionchange",!1,t))}}function El(e,t,o,d){switch(Rt(t)){case 1:var P=St;break;case 4:P=ot;break;default:P=wt}o=P.bind(null,t,o,e),P=void 0,!Ti||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(P=!0),d?P!==void 0?e.addEventListener(t,o,{capture:!0,passive:P}):e.addEventListener(t,o,!0):P!==void 0?e.addEventListener(t,o,{passive:P}):e.addEventListener(t,o,!1)}function Yo(e,t,o,d,P){var B=d;if((t&1)===0&&(t&2)===0&&d!==null)e:for(;;){if(d===null)return;var ie=d.tag;if(ie===3||ie===4){var Ce=d.stateNode.containerInfo;if(Ce===P||Ce.nodeType===8&&Ce.parentNode===P)break;if(ie===4)for(ie=d.return;ie!==null;){var Fe=ie.tag;if((Fe===3||Fe===4)&&(Fe=ie.stateNode.containerInfo,Fe===P||Fe.nodeType===8&&Fe.parentNode===P))return;ie=ie.return}for(;Ce!==null;){if(ie=Kn(Ce),ie===null)return;if(Fe=ie.tag,Fe===5||Fe===6){d=B=ie;continue e}Ce=Ce.parentNode}}d=d.return}Ci(function(){var Ze=B,xt=Ei(o),bt=[];e:{var vt=wl.get(e);if(vt!==void 0){var jt=Fr,$t=e;switch(e){case"keypress":if(Nt(o)===0)break e;case"keydown":case"keyup":jt=gt;break;case"focusin":$t="focus",jt=Ii;break;case"focusout":$t="blur",jt=Ii;break;case"beforeblur":case"afterblur":jt=Ii;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":jt=ni;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":jt=zi;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":jt=Wt;break;case vl:case yl:case xl:jt=Xr;break;case _l:jt=si;break;case"scroll":jt=ii;break;case"wheel":jt=er;break;case"copy":case"cut":case"paste":jt=ei;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":jt=Ke}var Kt=(t&4)!==0,mi=!Kt&&e==="scroll",$e=Kt?vt!==null?vt+"Capture":null:vt;Kt=[];for(var je=Ze,qe;je!==null;){qe=je;var Tt=qe.stateNode;if(qe.tag===5&&Tt!==null&&(qe=Tt,$e!==null&&(Tt=Ni(je,$e),Tt!=null&&Kt.push(Ds(je,Tt,qe)))),mi)break;je=je.return}0<Kt.length&&(vt=new jt(vt,$t,null,o,xt),bt.push({event:vt,listeners:Kt}))}}if((t&7)===0){e:{if(vt=e==="mouseover"||e==="pointerover",jt=e==="mouseout"||e==="pointerout",vt&&o!==li&&($t=o.relatedTarget||o.fromElement)&&(Kn($t)||$t[Sn]))break e;if((jt||vt)&&(vt=xt.window===xt?xt:(vt=xt.ownerDocument)?vt.defaultView||vt.parentWindow:window,jt?($t=o.relatedTarget||o.toElement,jt=Ze,$t=$t?Kn($t):null,$t!==null&&(mi=Gr($t),$t!==mi||$t.tag!==5&&$t.tag!==6)&&($t=null)):(jt=null,$t=Ze),jt!==$t)){if(Kt=ni,Tt="onMouseLeave",$e="onMouseEnter",je="mouse",(e==="pointerout"||e==="pointerover")&&(Kt=Ke,Tt="onPointerLeave",$e="onPointerEnter",je="pointer"),mi=jt==null?vt:hs(jt),qe=$t==null?vt:hs($t),vt=new Kt(Tt,je+"leave",jt,o,xt),vt.target=mi,vt.relatedTarget=qe,Tt=null,Kn(xt)===Ze&&(Kt=new Kt($e,je+"enter",$t,o,xt),Kt.target=qe,Kt.relatedTarget=mi,Tt=Kt),mi=Tt,jt&&$t)t:{for(Kt=jt,$e=$t,je=0,qe=Kt;qe;qe=us(qe))je++;for(qe=0,Tt=$e;Tt;Tt=us(Tt))qe++;for(;0<je-qe;)Kt=us(Kt),je--;for(;0<qe-je;)$e=us($e),qe--;for(;je--;){if(Kt===$e||$e!==null&&Kt===$e.alternate)break t;Kt=us(Kt),$e=us($e)}Kt=null}else Kt=null;jt!==null&&Cl(bt,vt,jt,Kt,!1),$t!==null&&mi!==null&&Cl(bt,mi,$t,Kt,!0)}}e:{if(vt=Ze?hs(Ze):window,jt=vt.nodeName&&vt.nodeName.toLowerCase(),jt==="select"||jt==="input"&&vt.type==="file")var Zt=uc;else if($n(vt))if(al)Zt=fc;else{Zt=hc;var ir=cc}else(jt=vt.nodeName)&&jt.toLowerCase()==="input"&&(vt.type==="checkbox"||vt.type==="radio")&&(Zt=dc);if(Zt&&(Zt=Zt(e,Ze))){Xn(bt,Zt,o,xt);break e}ir&&ir(e,vt,Ze),e==="focusout"&&(ir=vt._wrapperState)&&ir.controlled&&vt.type==="number"&&vr(vt,"number",vt.value)}switch(ir=Ze?hs(Ze):window,e){case"focusin":($n(ir)||ir.contentEditable==="true")&&(as=ir,Wo=Ze,ks=null);break;case"focusout":ks=Wo=as=null;break;case"mousedown":$o=!0;break;case"contextmenu":case"mouseup":case"dragend":$o=!1,ml(bt,o,xt);break;case"selectionchange":if(gc)break;case"keydown":case"keyup":ml(bt,o,xt)}var nr;if(lr)e:{switch(e){case"compositionstart":var hr="onCompositionStart";break e;case"compositionend":hr="onCompositionEnd";break e;case"compositionupdate":hr="onCompositionUpdate";break e}hr=void 0}else fr?cr(e,o)&&(hr="onCompositionEnd"):e==="keydown"&&o.keyCode===229&&(hr="onCompositionStart");hr&&(Pr&&o.locale!=="ko"&&(fr||hr!=="onCompositionStart"?hr==="onCompositionEnd"&&fr&&(nr=Jt()):(Ht=xt,kt="value"in Ht?Ht.value:Ht.textContent,fr=!0)),ir=Js(Ze,hr),0<ir.length&&(hr=new q(hr,e,null,o,xt),bt.push({event:hr,listeners:ir}),nr?hr.data=nr:(nr=tr(o),nr!==null&&(hr.data=nr)))),(nr=sr?Oi(e,o):Wn(e,o))&&(Ze=Js(Ze,"onBeforeInput"),0<Ze.length&&(xt=new q("onBeforeInput","beforeinput",null,o,xt),bt.push({event:xt,listeners:Ze}),xt.data=nr))}Al(bt,t)})}function Ds(e,t,o){return{instance:e,listener:t,currentTarget:o}}function Js(e,t){for(var o=t+"Capture",d=[];e!==null;){var P=e,B=P.stateNode;P.tag===5&&B!==null&&(P=B,B=Ni(e,o),B!=null&&d.unshift(Ds(e,B,P)),B=Ni(e,t),B!=null&&d.push(Ds(e,B,P))),e=e.return}return d}function us(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Cl(e,t,o,d,P){for(var B=t._reactName,ie=[];o!==null&&o!==d;){var Ce=o,Fe=Ce.alternate,Ze=Ce.stateNode;if(Fe!==null&&Fe===d)break;Ce.tag===5&&Ze!==null&&(Ce=Ze,P?(Fe=Ni(o,B),Fe!=null&&ie.unshift(Ds(o,Fe,Ce))):P||(Fe=Ni(o,B),Fe!=null&&ie.push(Ds(o,Fe,Ce)))),o=o.return}ie.length!==0&&e.push({event:t,listeners:ie})}var _c=/\r\n?/g,wc=/\u0000|\uFFFD/g;function Tl(e){return(typeof e=="string"?e:""+e).replace(_c,`
`).replace(wc,"")}function eo(e,t,o){if(t=Tl(t),Tl(e)!==t&&o)throw Error(a(425))}function to(){}var Qo=null,Jo=null;function ea(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var ta=typeof setTimeout=="function"?setTimeout:void 0,bc=typeof clearTimeout=="function"?clearTimeout:void 0,Ml=typeof Promise=="function"?Promise:void 0,Sc=typeof queueMicrotask=="function"?queueMicrotask:typeof Ml<"u"?function(e){return Ml.resolve(null).then(e).catch(Ac)}:ta;function Ac(e){setTimeout(function(){throw e})}function ra(e,t){var o=t,d=0;do{var P=o.nextSibling;if(e.removeChild(o),P&&P.nodeType===8)if(o=P.data,o==="/$"){if(d===0){e.removeChild(P),pt(t);return}d--}else o!=="$"&&o!=="$?"&&o!=="$!"||d++;o=P}while(o);pt(t)}function Dn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function kl(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var o=e.data;if(o==="$"||o==="$!"||o==="$?"){if(t===0)return e;t--}else o==="/$"&&t++}e=e.previousSibling}return null}var cs=Math.random().toString(36).slice(2),xn="__reactFiber$"+cs,zs="__reactProps$"+cs,Sn="__reactContainer$"+cs,ia="__reactEvents$"+cs,Ec="__reactListeners$"+cs,Cc="__reactHandles$"+cs;function Kn(e){var t=e[xn];if(t)return t;for(var o=e.parentNode;o;){if(t=o[Sn]||o[xn]){if(o=t.alternate,t.child!==null||o!==null&&o.child!==null)for(e=kl(e);e!==null;){if(o=e[xn])return o;e=kl(e)}return t}e=o,o=e.parentNode}return null}function Is(e){return e=e[xn]||e[Sn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function hs(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(a(33))}function ro(e){return e[zs]||null}var na=[],ds=-1;function zn(e){return{current:e}}function Jr(e){0>ds||(e.current=na[ds],na[ds]=null,ds--)}function Zr(e,t){ds++,na[ds]=e.current,e.current=t}var In={},ji=zn(In),Zi=zn(!1),qn=In;function fs(e,t){var o=e.type.contextTypes;if(!o)return In;var d=e.stateNode;if(d&&d.__reactInternalMemoizedUnmaskedChildContext===t)return d.__reactInternalMemoizedMaskedChildContext;var P={},B;for(B in o)P[B]=t[B];return d&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=P),P}function Yi(e){return e=e.childContextTypes,e!=null}function io(){Jr(Zi),Jr(ji)}function Rl(e,t,o){if(ji.current!==In)throw Error(a(168));Zr(ji,t),Zr(Zi,o)}function Pl(e,t,o){var d=e.stateNode;if(t=t.childContextTypes,typeof d.getChildContext!="function")return o;d=d.getChildContext();for(var P in d)if(!(P in t))throw Error(a(108,Ue(e)||"Unknown",P));return Re({},o,d)}function no(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||In,qn=ji.current,Zr(ji,e),Zr(Zi,Zi.current),!0}function Dl(e,t,o){var d=e.stateNode;if(!d)throw Error(a(169));o?(e=Pl(e,t,qn),d.__reactInternalMemoizedMergedChildContext=e,Jr(Zi),Jr(ji),Zr(ji,e)):Jr(Zi),Zr(Zi,o)}var An=null,so=!1,sa=!1;function zl(e){An===null?An=[e]:An.push(e)}function Tc(e){so=!0,zl(e)}function On(){if(!sa&&An!==null){sa=!0;var e=0,t=R;try{var o=An;for(R=1;e<o.length;e++){var d=o[e];do d=d(!0);while(d!==null)}An=null,so=!1}catch(P){throw An!==null&&(An=An.slice(e+1)),xe(Mt,On),P}finally{R=t,sa=!1}}return null}var ps=[],ms=0,oo=null,ao=0,an=[],ln=0,Zn=null,En=1,Cn="";function Yn(e,t){ps[ms++]=ao,ps[ms++]=oo,oo=e,ao=t}function Il(e,t,o){an[ln++]=En,an[ln++]=Cn,an[ln++]=Zn,Zn=e;var d=En;e=Cn;var P=32-_r(d)-1;d&=~(1<<P),o+=1;var B=32-_r(t)+P;if(30<B){var ie=P-P%5;B=(d&(1<<ie)-1).toString(32),d>>=ie,P-=ie,En=1<<32-_r(t)+P|o<<P|d,Cn=B+e}else En=1<<B|o<<P|d,Cn=e}function oa(e){e.return!==null&&(Yn(e,1),Il(e,1,0))}function aa(e){for(;e===oo;)oo=ps[--ms],ps[ms]=null,ao=ps[--ms],ps[ms]=null;for(;e===Zn;)Zn=an[--ln],an[ln]=null,Cn=an[--ln],an[ln]=null,En=an[--ln],an[ln]=null}var rn=null,nn=null,ti=!1,pn=null;function Ol(e,t){var o=dn(5,null,null,0);o.elementType="DELETED",o.stateNode=t,o.return=e,t=e.deletions,t===null?(e.deletions=[o],e.flags|=16):t.push(o)}function Ll(e,t){switch(e.tag){case 5:var o=e.type;return t=t.nodeType!==1||o.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,rn=e,nn=Dn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,rn=e,nn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(o=Zn!==null?{id:En,overflow:Cn}:null,e.memoizedState={dehydrated:t,treeContext:o,retryLane:1073741824},o=dn(18,null,null,0),o.stateNode=t,o.return=e,e.child=o,rn=e,nn=null,!0):!1;default:return!1}}function la(e){return(e.mode&1)!==0&&(e.flags&128)===0}function ua(e){if(ti){var t=nn;if(t){var o=t;if(!Ll(e,t)){if(la(e))throw Error(a(418));t=Dn(o.nextSibling);var d=rn;t&&Ll(e,t)?Ol(d,o):(e.flags=e.flags&-4097|2,ti=!1,rn=e)}}else{if(la(e))throw Error(a(418));e.flags=e.flags&-4097|2,ti=!1,rn=e}}}function Fl(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;rn=e}function lo(e){if(e!==rn)return!1;if(!ti)return Fl(e),ti=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!ea(e.type,e.memoizedProps)),t&&(t=nn)){if(la(e))throw Nl(),Error(a(418));for(;t;)Ol(e,t),t=Dn(t.nextSibling)}if(Fl(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var o=e.data;if(o==="/$"){if(t===0){nn=Dn(e.nextSibling);break e}t--}else o!=="$"&&o!=="$!"&&o!=="$?"||t++}e=e.nextSibling}nn=null}}else nn=rn?Dn(e.stateNode.nextSibling):null;return!0}function Nl(){for(var e=nn;e;)e=Dn(e.nextSibling)}function gs(){nn=rn=null,ti=!1}function ca(e){pn===null?pn=[e]:pn.push(e)}var Mc=N.ReactCurrentBatchConfig;function Os(e,t,o){if(e=o.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(o._owner){if(o=o._owner,o){if(o.tag!==1)throw Error(a(309));var d=o.stateNode}if(!d)throw Error(a(147,e));var P=d,B=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===B?t.ref:(t=function(ie){var Ce=P.refs;ie===null?delete Ce[B]:Ce[B]=ie},t._stringRef=B,t)}if(typeof e!="string")throw Error(a(284));if(!o._owner)throw Error(a(290,e))}return e}function uo(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Vl(e){var t=e._init;return t(e._payload)}function jl(e){function t($e,je){if(e){var qe=$e.deletions;qe===null?($e.deletions=[je],$e.flags|=16):qe.push(je)}}function o($e,je){if(!e)return null;for(;je!==null;)t($e,je),je=je.sibling;return null}function d($e,je){for($e=new Map;je!==null;)je.key!==null?$e.set(je.key,je):$e.set(je.index,je),je=je.sibling;return $e}function P($e,je){return $e=Gn($e,je),$e.index=0,$e.sibling=null,$e}function B($e,je,qe){return $e.index=qe,e?(qe=$e.alternate,qe!==null?(qe=qe.index,qe<je?($e.flags|=2,je):qe):($e.flags|=2,je)):($e.flags|=1048576,je)}function ie($e){return e&&$e.alternate===null&&($e.flags|=2),$e}function Ce($e,je,qe,Tt){return je===null||je.tag!==6?(je=tl(qe,$e.mode,Tt),je.return=$e,je):(je=P(je,qe),je.return=$e,je)}function Fe($e,je,qe,Tt){var Zt=qe.type;return Zt===Z?xt($e,je,qe.props.children,Tt,qe.key):je!==null&&(je.elementType===Zt||typeof Zt=="object"&&Zt!==null&&Zt.$$typeof===I&&Vl(Zt)===je.type)?(Tt=P(je,qe.props),Tt.ref=Os($e,je,qe),Tt.return=$e,Tt):(Tt=Io(qe.type,qe.key,qe.props,null,$e.mode,Tt),Tt.ref=Os($e,je,qe),Tt.return=$e,Tt)}function Ze($e,je,qe,Tt){return je===null||je.tag!==4||je.stateNode.containerInfo!==qe.containerInfo||je.stateNode.implementation!==qe.implementation?(je=rl(qe,$e.mode,Tt),je.return=$e,je):(je=P(je,qe.children||[]),je.return=$e,je)}function xt($e,je,qe,Tt,Zt){return je===null||je.tag!==7?(je=ss(qe,$e.mode,Tt,Zt),je.return=$e,je):(je=P(je,qe),je.return=$e,je)}function bt($e,je,qe){if(typeof je=="string"&&je!==""||typeof je=="number")return je=tl(""+je,$e.mode,qe),je.return=$e,je;if(typeof je=="object"&&je!==null){switch(je.$$typeof){case V:return qe=Io(je.type,je.key,je.props,null,$e.mode,qe),qe.ref=Os($e,null,je),qe.return=$e,qe;case U:return je=rl(je,$e.mode,qe),je.return=$e,je;case I:var Tt=je._init;return bt($e,Tt(je._payload),qe)}if(xr(je)||X(je))return je=ss(je,$e.mode,qe,null),je.return=$e,je;uo($e,je)}return null}function vt($e,je,qe,Tt){var Zt=je!==null?je.key:null;if(typeof qe=="string"&&qe!==""||typeof qe=="number")return Zt!==null?null:Ce($e,je,""+qe,Tt);if(typeof qe=="object"&&qe!==null){switch(qe.$$typeof){case V:return qe.key===Zt?Fe($e,je,qe,Tt):null;case U:return qe.key===Zt?Ze($e,je,qe,Tt):null;case I:return Zt=qe._init,vt($e,je,Zt(qe._payload),Tt)}if(xr(qe)||X(qe))return Zt!==null?null:xt($e,je,qe,Tt,null);uo($e,qe)}return null}function jt($e,je,qe,Tt,Zt){if(typeof Tt=="string"&&Tt!==""||typeof Tt=="number")return $e=$e.get(qe)||null,Ce(je,$e,""+Tt,Zt);if(typeof Tt=="object"&&Tt!==null){switch(Tt.$$typeof){case V:return $e=$e.get(Tt.key===null?qe:Tt.key)||null,Fe(je,$e,Tt,Zt);case U:return $e=$e.get(Tt.key===null?qe:Tt.key)||null,Ze(je,$e,Tt,Zt);case I:var ir=Tt._init;return jt($e,je,qe,ir(Tt._payload),Zt)}if(xr(Tt)||X(Tt))return $e=$e.get(qe)||null,xt(je,$e,Tt,Zt,null);uo(je,Tt)}return null}function $t($e,je,qe,Tt){for(var Zt=null,ir=null,nr=je,hr=je=0,Pi=null;nr!==null&&hr<qe.length;hr++){nr.index>hr?(Pi=nr,nr=null):Pi=nr.sibling;var Vr=vt($e,nr,qe[hr],Tt);if(Vr===null){nr===null&&(nr=Pi);break}e&&nr&&Vr.alternate===null&&t($e,nr),je=B(Vr,je,hr),ir===null?Zt=Vr:ir.sibling=Vr,ir=Vr,nr=Pi}if(hr===qe.length)return o($e,nr),ti&&Yn($e,hr),Zt;if(nr===null){for(;hr<qe.length;hr++)nr=bt($e,qe[hr],Tt),nr!==null&&(je=B(nr,je,hr),ir===null?Zt=nr:ir.sibling=nr,ir=nr);return ti&&Yn($e,hr),Zt}for(nr=d($e,nr);hr<qe.length;hr++)Pi=jt(nr,$e,hr,qe[hr],Tt),Pi!==null&&(e&&Pi.alternate!==null&&nr.delete(Pi.key===null?hr:Pi.key),je=B(Pi,je,hr),ir===null?Zt=Pi:ir.sibling=Pi,ir=Pi);return e&&nr.forEach(function(Hn){return t($e,Hn)}),ti&&Yn($e,hr),Zt}function Kt($e,je,qe,Tt){var Zt=X(qe);if(typeof Zt!="function")throw Error(a(150));if(qe=Zt.call(qe),qe==null)throw Error(a(151));for(var ir=Zt=null,nr=je,hr=je=0,Pi=null,Vr=qe.next();nr!==null&&!Vr.done;hr++,Vr=qe.next()){nr.index>hr?(Pi=nr,nr=null):Pi=nr.sibling;var Hn=vt($e,nr,Vr.value,Tt);if(Hn===null){nr===null&&(nr=Pi);break}e&&nr&&Hn.alternate===null&&t($e,nr),je=B(Hn,je,hr),ir===null?Zt=Hn:ir.sibling=Hn,ir=Hn,nr=Pi}if(Vr.done)return o($e,nr),ti&&Yn($e,hr),Zt;if(nr===null){for(;!Vr.done;hr++,Vr=qe.next())Vr=bt($e,Vr.value,Tt),Vr!==null&&(je=B(Vr,je,hr),ir===null?Zt=Vr:ir.sibling=Vr,ir=Vr);return ti&&Yn($e,hr),Zt}for(nr=d($e,nr);!Vr.done;hr++,Vr=qe.next())Vr=jt(nr,$e,hr,Vr.value,Tt),Vr!==null&&(e&&Vr.alternate!==null&&nr.delete(Vr.key===null?hr:Vr.key),je=B(Vr,je,hr),ir===null?Zt=Vr:ir.sibling=Vr,ir=Vr);return e&&nr.forEach(function(ah){return t($e,ah)}),ti&&Yn($e,hr),Zt}function mi($e,je,qe,Tt){if(typeof qe=="object"&&qe!==null&&qe.type===Z&&qe.key===null&&(qe=qe.props.children),typeof qe=="object"&&qe!==null){switch(qe.$$typeof){case V:e:{for(var Zt=qe.key,ir=je;ir!==null;){if(ir.key===Zt){if(Zt=qe.type,Zt===Z){if(ir.tag===7){o($e,ir.sibling),je=P(ir,qe.props.children),je.return=$e,$e=je;break e}}else if(ir.elementType===Zt||typeof Zt=="object"&&Zt!==null&&Zt.$$typeof===I&&Vl(Zt)===ir.type){o($e,ir.sibling),je=P(ir,qe.props),je.ref=Os($e,ir,qe),je.return=$e,$e=je;break e}o($e,ir);break}else t($e,ir);ir=ir.sibling}qe.type===Z?(je=ss(qe.props.children,$e.mode,Tt,qe.key),je.return=$e,$e=je):(Tt=Io(qe.type,qe.key,qe.props,null,$e.mode,Tt),Tt.ref=Os($e,je,qe),Tt.return=$e,$e=Tt)}return ie($e);case U:e:{for(ir=qe.key;je!==null;){if(je.key===ir)if(je.tag===4&&je.stateNode.containerInfo===qe.containerInfo&&je.stateNode.implementation===qe.implementation){o($e,je.sibling),je=P(je,qe.children||[]),je.return=$e,$e=je;break e}else{o($e,je);break}else t($e,je);je=je.sibling}je=rl(qe,$e.mode,Tt),je.return=$e,$e=je}return ie($e);case I:return ir=qe._init,mi($e,je,ir(qe._payload),Tt)}if(xr(qe))return $t($e,je,qe,Tt);if(X(qe))return Kt($e,je,qe,Tt);uo($e,qe)}return typeof qe=="string"&&qe!==""||typeof qe=="number"?(qe=""+qe,je!==null&&je.tag===6?(o($e,je.sibling),je=P(je,qe),je.return=$e,$e=je):(o($e,je),je=tl(qe,$e.mode,Tt),je.return=$e,$e=je),ie($e)):o($e,je)}return mi}var vs=jl(!0),Bl=jl(!1),co=zn(null),ho=null,ys=null,ha=null;function da(){ha=ys=ho=null}function fa(e){var t=co.current;Jr(co),e._currentValue=t}function pa(e,t,o){for(;e!==null;){var d=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,d!==null&&(d.childLanes|=t)):d!==null&&(d.childLanes&t)!==t&&(d.childLanes|=t),e===o)break;e=e.return}}function xs(e,t){ho=e,ha=ys=null,e=e.dependencies,e!==null&&e.firstContext!==null&&((e.lanes&t)!==0&&(Qi=!0),e.firstContext=null)}function un(e){var t=e._currentValue;if(ha!==e)if(e={context:e,memoizedValue:t,next:null},ys===null){if(ho===null)throw Error(a(308));ys=e,ho.dependencies={lanes:0,firstContext:e}}else ys=ys.next=e;return t}var Qn=null;function ma(e){Qn===null?Qn=[e]:Qn.push(e)}function Ul(e,t,o,d){var P=t.interleaved;return P===null?(o.next=o,ma(t)):(o.next=P.next,P.next=o),t.interleaved=o,Tn(e,d)}function Tn(e,t){e.lanes|=t;var o=e.alternate;for(o!==null&&(o.lanes|=t),o=e,e=e.return;e!==null;)e.childLanes|=t,o=e.alternate,o!==null&&(o.childLanes|=t),o=e,e=e.return;return o.tag===3?o.stateNode:null}var Ln=!1;function ga(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Gl(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Mn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Fn(e,t,o){var d=e.updateQueue;if(d===null)return null;if(d=d.shared,(Nr&2)!==0){var P=d.pending;return P===null?t.next=t:(t.next=P.next,P.next=t),d.pending=t,Tn(e,o)}return P=d.interleaved,P===null?(t.next=t,ma(d)):(t.next=P.next,P.next=t),d.interleaved=t,Tn(e,o)}function fo(e,t,o){if(t=t.updateQueue,t!==null&&(t=t.shared,(o&4194240)!==0)){var d=t.lanes;d&=e.pendingLanes,o|=d,t.lanes=o,S(e,o)}}function Hl(e,t){var o=e.updateQueue,d=e.alternate;if(d!==null&&(d=d.updateQueue,o===d)){var P=null,B=null;if(o=o.firstBaseUpdate,o!==null){do{var ie={eventTime:o.eventTime,lane:o.lane,tag:o.tag,payload:o.payload,callback:o.callback,next:null};B===null?P=B=ie:B=B.next=ie,o=o.next}while(o!==null);B===null?P=B=t:B=B.next=t}else P=B=t;o={baseState:d.baseState,firstBaseUpdate:P,lastBaseUpdate:B,shared:d.shared,effects:d.effects},e.updateQueue=o;return}e=o.lastBaseUpdate,e===null?o.firstBaseUpdate=t:e.next=t,o.lastBaseUpdate=t}function po(e,t,o,d){var P=e.updateQueue;Ln=!1;var B=P.firstBaseUpdate,ie=P.lastBaseUpdate,Ce=P.shared.pending;if(Ce!==null){P.shared.pending=null;var Fe=Ce,Ze=Fe.next;Fe.next=null,ie===null?B=Ze:ie.next=Ze,ie=Fe;var xt=e.alternate;xt!==null&&(xt=xt.updateQueue,Ce=xt.lastBaseUpdate,Ce!==ie&&(Ce===null?xt.firstBaseUpdate=Ze:Ce.next=Ze,xt.lastBaseUpdate=Fe))}if(B!==null){var bt=P.baseState;ie=0,xt=Ze=Fe=null,Ce=B;do{var vt=Ce.lane,jt=Ce.eventTime;if((d&vt)===vt){xt!==null&&(xt=xt.next={eventTime:jt,lane:0,tag:Ce.tag,payload:Ce.payload,callback:Ce.callback,next:null});e:{var $t=e,Kt=Ce;switch(vt=t,jt=o,Kt.tag){case 1:if($t=Kt.payload,typeof $t=="function"){bt=$t.call(jt,bt,vt);break e}bt=$t;break e;case 3:$t.flags=$t.flags&-65537|128;case 0:if($t=Kt.payload,vt=typeof $t=="function"?$t.call(jt,bt,vt):$t,vt==null)break e;bt=Re({},bt,vt);break e;case 2:Ln=!0}}Ce.callback!==null&&Ce.lane!==0&&(e.flags|=64,vt=P.effects,vt===null?P.effects=[Ce]:vt.push(Ce))}else jt={eventTime:jt,lane:vt,tag:Ce.tag,payload:Ce.payload,callback:Ce.callback,next:null},xt===null?(Ze=xt=jt,Fe=bt):xt=xt.next=jt,ie|=vt;if(Ce=Ce.next,Ce===null){if(Ce=P.shared.pending,Ce===null)break;vt=Ce,Ce=vt.next,vt.next=null,P.lastBaseUpdate=vt,P.shared.pending=null}}while(!0);if(xt===null&&(Fe=bt),P.baseState=Fe,P.firstBaseUpdate=Ze,P.lastBaseUpdate=xt,t=P.shared.interleaved,t!==null){P=t;do ie|=P.lane,P=P.next;while(P!==t)}else B===null&&(P.shared.lanes=0);ts|=ie,e.lanes=ie,e.memoizedState=bt}}function Wl(e,t,o){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var d=e[t],P=d.callback;if(P!==null){if(d.callback=null,d=o,typeof P!="function")throw Error(a(191,P));P.call(d)}}}var Ls={},_n=zn(Ls),Fs=zn(Ls),Ns=zn(Ls);function Jn(e){if(e===Ls)throw Error(a(174));return e}function va(e,t){switch(Zr(Ns,t),Zr(Fs,e),Zr(_n,Ls),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:pe(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=pe(t,e)}Jr(_n),Zr(_n,t)}function _s(){Jr(_n),Jr(Fs),Jr(Ns)}function $l(e){Jn(Ns.current);var t=Jn(_n.current),o=pe(t,e.type);t!==o&&(Zr(Fs,e),Zr(_n,o))}function ya(e){Fs.current===e&&(Jr(_n),Jr(Fs))}var oi=zn(0);function mo(e){for(var t=e;t!==null;){if(t.tag===13){var o=t.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||o.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var xa=[];function _a(){for(var e=0;e<xa.length;e++)xa[e]._workInProgressVersionPrimary=null;xa.length=0}var go=N.ReactCurrentDispatcher,wa=N.ReactCurrentBatchConfig,es=0,ai=null,Si=null,ki=null,vo=!1,Vs=!1,js=0,kc=0;function Bi(){throw Error(a(321))}function ba(e,t){if(t===null)return!1;for(var o=0;o<t.length&&o<e.length;o++)if(!fn(e[o],t[o]))return!1;return!0}function Sa(e,t,o,d,P,B){if(es=B,ai=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,go.current=e===null||e.memoizedState===null?zc:Ic,e=o(d,P),Vs){B=0;do{if(Vs=!1,js=0,25<=B)throw Error(a(301));B+=1,ki=Si=null,t.updateQueue=null,go.current=Oc,e=o(d,P)}while(Vs)}if(go.current=_o,t=Si!==null&&Si.next!==null,es=0,ki=Si=ai=null,vo=!1,t)throw Error(a(300));return e}function Aa(){var e=js!==0;return js=0,e}function wn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ki===null?ai.memoizedState=ki=e:ki=ki.next=e,ki}function cn(){if(Si===null){var e=ai.alternate;e=e!==null?e.memoizedState:null}else e=Si.next;var t=ki===null?ai.memoizedState:ki.next;if(t!==null)ki=t,Si=e;else{if(e===null)throw Error(a(310));Si=e,e={memoizedState:Si.memoizedState,baseState:Si.baseState,baseQueue:Si.baseQueue,queue:Si.queue,next:null},ki===null?ai.memoizedState=ki=e:ki=ki.next=e}return ki}function Bs(e,t){return typeof t=="function"?t(e):t}function Ea(e){var t=cn(),o=t.queue;if(o===null)throw Error(a(311));o.lastRenderedReducer=e;var d=Si,P=d.baseQueue,B=o.pending;if(B!==null){if(P!==null){var ie=P.next;P.next=B.next,B.next=ie}d.baseQueue=P=B,o.pending=null}if(P!==null){B=P.next,d=d.baseState;var Ce=ie=null,Fe=null,Ze=B;do{var xt=Ze.lane;if((es&xt)===xt)Fe!==null&&(Fe=Fe.next={lane:0,action:Ze.action,hasEagerState:Ze.hasEagerState,eagerState:Ze.eagerState,next:null}),d=Ze.hasEagerState?Ze.eagerState:e(d,Ze.action);else{var bt={lane:xt,action:Ze.action,hasEagerState:Ze.hasEagerState,eagerState:Ze.eagerState,next:null};Fe===null?(Ce=Fe=bt,ie=d):Fe=Fe.next=bt,ai.lanes|=xt,ts|=xt}Ze=Ze.next}while(Ze!==null&&Ze!==B);Fe===null?ie=d:Fe.next=Ce,fn(d,t.memoizedState)||(Qi=!0),t.memoizedState=d,t.baseState=ie,t.baseQueue=Fe,o.lastRenderedState=d}if(e=o.interleaved,e!==null){P=e;do B=P.lane,ai.lanes|=B,ts|=B,P=P.next;while(P!==e)}else P===null&&(o.lanes=0);return[t.memoizedState,o.dispatch]}function Ca(e){var t=cn(),o=t.queue;if(o===null)throw Error(a(311));o.lastRenderedReducer=e;var d=o.dispatch,P=o.pending,B=t.memoizedState;if(P!==null){o.pending=null;var ie=P=P.next;do B=e(B,ie.action),ie=ie.next;while(ie!==P);fn(B,t.memoizedState)||(Qi=!0),t.memoizedState=B,t.baseQueue===null&&(t.baseState=B),o.lastRenderedState=B}return[B,d]}function Xl(){}function Kl(e,t){var o=ai,d=cn(),P=t(),B=!fn(d.memoizedState,P);if(B&&(d.memoizedState=P,Qi=!0),d=d.queue,Ta(Yl.bind(null,o,d,e),[e]),d.getSnapshot!==t||B||ki!==null&&ki.memoizedState.tag&1){if(o.flags|=2048,Us(9,Zl.bind(null,o,d,P,t),void 0,null),Ri===null)throw Error(a(349));(es&30)!==0||ql(o,t,P)}return P}function ql(e,t,o){e.flags|=16384,e={getSnapshot:t,value:o},t=ai.updateQueue,t===null?(t={lastEffect:null,stores:null},ai.updateQueue=t,t.stores=[e]):(o=t.stores,o===null?t.stores=[e]:o.push(e))}function Zl(e,t,o,d){t.value=o,t.getSnapshot=d,Ql(t)&&Jl(e)}function Yl(e,t,o){return o(function(){Ql(t)&&Jl(e)})}function Ql(e){var t=e.getSnapshot;e=e.value;try{var o=t();return!fn(e,o)}catch{return!0}}function Jl(e){var t=Tn(e,1);t!==null&&yn(t,e,1,-1)}function eu(e){var t=wn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Bs,lastRenderedState:e},t.queue=e,e=e.dispatch=Dc.bind(null,ai,e),[t.memoizedState,e]}function Us(e,t,o,d){return e={tag:e,create:t,destroy:o,deps:d,next:null},t=ai.updateQueue,t===null?(t={lastEffect:null,stores:null},ai.updateQueue=t,t.lastEffect=e.next=e):(o=t.lastEffect,o===null?t.lastEffect=e.next=e:(d=o.next,o.next=e,e.next=d,t.lastEffect=e)),e}function tu(){return cn().memoizedState}function yo(e,t,o,d){var P=wn();ai.flags|=e,P.memoizedState=Us(1|t,o,void 0,d===void 0?null:d)}function xo(e,t,o,d){var P=cn();d=d===void 0?null:d;var B=void 0;if(Si!==null){var ie=Si.memoizedState;if(B=ie.destroy,d!==null&&ba(d,ie.deps)){P.memoizedState=Us(t,o,B,d);return}}ai.flags|=e,P.memoizedState=Us(1|t,o,B,d)}function ru(e,t){return yo(8390656,8,e,t)}function Ta(e,t){return xo(2048,8,e,t)}function iu(e,t){return xo(4,2,e,t)}function nu(e,t){return xo(4,4,e,t)}function su(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function ou(e,t,o){return o=o!=null?o.concat([e]):null,xo(4,4,su.bind(null,t,e),o)}function Ma(){}function au(e,t){var o=cn();t=t===void 0?null:t;var d=o.memoizedState;return d!==null&&t!==null&&ba(t,d[1])?d[0]:(o.memoizedState=[e,t],e)}function lu(e,t){var o=cn();t=t===void 0?null:t;var d=o.memoizedState;return d!==null&&t!==null&&ba(t,d[1])?d[0]:(e=e(),o.memoizedState=[e,t],e)}function uu(e,t,o){return(es&21)===0?(e.baseState&&(e.baseState=!1,Qi=!0),e.memoizedState=o):(fn(o,t)||(o=A(),ai.lanes|=o,ts|=o,e.baseState=!0),t)}function Rc(e,t){var o=R;R=o!==0&&4>o?o:4,e(!0);var d=wa.transition;wa.transition={};try{e(!1),t()}finally{R=o,wa.transition=d}}function cu(){return cn().memoizedState}function Pc(e,t,o){var d=Bn(e);if(o={lane:d,action:o,hasEagerState:!1,eagerState:null,next:null},hu(e))du(t,o);else if(o=Ul(e,t,o,d),o!==null){var P=Xi();yn(o,e,d,P),fu(o,t,d)}}function Dc(e,t,o){var d=Bn(e),P={lane:d,action:o,hasEagerState:!1,eagerState:null,next:null};if(hu(e))du(t,P);else{var B=e.alternate;if(e.lanes===0&&(B===null||B.lanes===0)&&(B=t.lastRenderedReducer,B!==null))try{var ie=t.lastRenderedState,Ce=B(ie,o);if(P.hasEagerState=!0,P.eagerState=Ce,fn(Ce,ie)){var Fe=t.interleaved;Fe===null?(P.next=P,ma(t)):(P.next=Fe.next,Fe.next=P),t.interleaved=P;return}}catch{}finally{}o=Ul(e,t,P,d),o!==null&&(P=Xi(),yn(o,e,d,P),fu(o,t,d))}}function hu(e){var t=e.alternate;return e===ai||t!==null&&t===ai}function du(e,t){Vs=vo=!0;var o=e.pending;o===null?t.next=t:(t.next=o.next,o.next=t),e.pending=t}function fu(e,t,o){if((o&4194240)!==0){var d=t.lanes;d&=e.pendingLanes,o|=d,t.lanes=o,S(e,o)}}var _o={readContext:un,useCallback:Bi,useContext:Bi,useEffect:Bi,useImperativeHandle:Bi,useInsertionEffect:Bi,useLayoutEffect:Bi,useMemo:Bi,useReducer:Bi,useRef:Bi,useState:Bi,useDebugValue:Bi,useDeferredValue:Bi,useTransition:Bi,useMutableSource:Bi,useSyncExternalStore:Bi,useId:Bi,unstable_isNewReconciler:!1},zc={readContext:un,useCallback:function(e,t){return wn().memoizedState=[e,t===void 0?null:t],e},useContext:un,useEffect:ru,useImperativeHandle:function(e,t,o){return o=o!=null?o.concat([e]):null,yo(4194308,4,su.bind(null,t,e),o)},useLayoutEffect:function(e,t){return yo(4194308,4,e,t)},useInsertionEffect:function(e,t){return yo(4,2,e,t)},useMemo:function(e,t){var o=wn();return t=t===void 0?null:t,e=e(),o.memoizedState=[e,t],e},useReducer:function(e,t,o){var d=wn();return t=o!==void 0?o(t):t,d.memoizedState=d.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},d.queue=e,e=e.dispatch=Pc.bind(null,ai,e),[d.memoizedState,e]},useRef:function(e){var t=wn();return e={current:e},t.memoizedState=e},useState:eu,useDebugValue:Ma,useDeferredValue:function(e){return wn().memoizedState=e},useTransition:function(){var e=eu(!1),t=e[0];return e=Rc.bind(null,e[1]),wn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,o){var d=ai,P=wn();if(ti){if(o===void 0)throw Error(a(407));o=o()}else{if(o=t(),Ri===null)throw Error(a(349));(es&30)!==0||ql(d,t,o)}P.memoizedState=o;var B={value:o,getSnapshot:t};return P.queue=B,ru(Yl.bind(null,d,B,e),[e]),d.flags|=2048,Us(9,Zl.bind(null,d,B,o,t),void 0,null),o},useId:function(){var e=wn(),t=Ri.identifierPrefix;if(ti){var o=Cn,d=En;o=(d&~(1<<32-_r(d)-1)).toString(32)+o,t=":"+t+"R"+o,o=js++,0<o&&(t+="H"+o.toString(32)),t+=":"}else o=kc++,t=":"+t+"r"+o.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Ic={readContext:un,useCallback:au,useContext:un,useEffect:Ta,useImperativeHandle:ou,useInsertionEffect:iu,useLayoutEffect:nu,useMemo:lu,useReducer:Ea,useRef:tu,useState:function(){return Ea(Bs)},useDebugValue:Ma,useDeferredValue:function(e){var t=cn();return uu(t,Si.memoizedState,e)},useTransition:function(){var e=Ea(Bs)[0],t=cn().memoizedState;return[e,t]},useMutableSource:Xl,useSyncExternalStore:Kl,useId:cu,unstable_isNewReconciler:!1},Oc={readContext:un,useCallback:au,useContext:un,useEffect:Ta,useImperativeHandle:ou,useInsertionEffect:iu,useLayoutEffect:nu,useMemo:lu,useReducer:Ca,useRef:tu,useState:function(){return Ca(Bs)},useDebugValue:Ma,useDeferredValue:function(e){var t=cn();return Si===null?t.memoizedState=e:uu(t,Si.memoizedState,e)},useTransition:function(){var e=Ca(Bs)[0],t=cn().memoizedState;return[e,t]},useMutableSource:Xl,useSyncExternalStore:Kl,useId:cu,unstable_isNewReconciler:!1};function mn(e,t){if(e&&e.defaultProps){t=Re({},t),e=e.defaultProps;for(var o in e)t[o]===void 0&&(t[o]=e[o]);return t}return t}function ka(e,t,o,d){t=e.memoizedState,o=o(d,t),o=o==null?t:Re({},t,o),e.memoizedState=o,e.lanes===0&&(e.updateQueue.baseState=o)}var wo={isMounted:function(e){return(e=e._reactInternals)?Gr(e)===e:!1},enqueueSetState:function(e,t,o){e=e._reactInternals;var d=Xi(),P=Bn(e),B=Mn(d,P);B.payload=t,o!=null&&(B.callback=o),t=Fn(e,B,P),t!==null&&(yn(t,e,P,d),fo(t,e,P))},enqueueReplaceState:function(e,t,o){e=e._reactInternals;var d=Xi(),P=Bn(e),B=Mn(d,P);B.tag=1,B.payload=t,o!=null&&(B.callback=o),t=Fn(e,B,P),t!==null&&(yn(t,e,P,d),fo(t,e,P))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var o=Xi(),d=Bn(e),P=Mn(o,d);P.tag=2,t!=null&&(P.callback=t),t=Fn(e,P,d),t!==null&&(yn(t,e,d,o),fo(t,e,d))}};function pu(e,t,o,d,P,B,ie){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(d,B,ie):t.prototype&&t.prototype.isPureReactComponent?!Ms(o,d)||!Ms(P,B):!0}function mu(e,t,o){var d=!1,P=In,B=t.contextType;return typeof B=="object"&&B!==null?B=un(B):(P=Yi(t)?qn:ji.current,d=t.contextTypes,B=(d=d!=null)?fs(e,P):In),t=new t(o,B),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=wo,e.stateNode=t,t._reactInternals=e,d&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=P,e.__reactInternalMemoizedMaskedChildContext=B),t}function gu(e,t,o,d){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(o,d),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(o,d),t.state!==e&&wo.enqueueReplaceState(t,t.state,null)}function Ra(e,t,o,d){var P=e.stateNode;P.props=o,P.state=e.memoizedState,P.refs={},ga(e);var B=t.contextType;typeof B=="object"&&B!==null?P.context=un(B):(B=Yi(t)?qn:ji.current,P.context=fs(e,B)),P.state=e.memoizedState,B=t.getDerivedStateFromProps,typeof B=="function"&&(ka(e,t,B,o),P.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof P.getSnapshotBeforeUpdate=="function"||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(t=P.state,typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount(),t!==P.state&&wo.enqueueReplaceState(P,P.state,null),po(e,o,P,d),P.state=e.memoizedState),typeof P.componentDidMount=="function"&&(e.flags|=4194308)}function ws(e,t){try{var o="",d=t;do o+=Ae(d),d=d.return;while(d);var P=o}catch(B){P=`
Error generating stack: `+B.message+`
`+B.stack}return{value:e,source:t,stack:P,digest:null}}function Pa(e,t,o){return{value:e,source:null,stack:o??null,digest:t??null}}function Da(e,t){try{console.error(t.value)}catch(o){setTimeout(function(){throw o})}}var Lc=typeof WeakMap=="function"?WeakMap:Map;function vu(e,t,o){o=Mn(-1,o),o.tag=3,o.payload={element:null};var d=t.value;return o.callback=function(){Mo||(Mo=!0,Xa=d),Da(e,t)},o}function yu(e,t,o){o=Mn(-1,o),o.tag=3;var d=e.type.getDerivedStateFromError;if(typeof d=="function"){var P=t.value;o.payload=function(){return d(P)},o.callback=function(){Da(e,t)}}var B=e.stateNode;return B!==null&&typeof B.componentDidCatch=="function"&&(o.callback=function(){Da(e,t),typeof d!="function"&&(Vn===null?Vn=new Set([this]):Vn.add(this));var ie=t.stack;this.componentDidCatch(t.value,{componentStack:ie!==null?ie:""})}),o}function xu(e,t,o){var d=e.pingCache;if(d===null){d=e.pingCache=new Lc;var P=new Set;d.set(t,P)}else P=d.get(t),P===void 0&&(P=new Set,d.set(t,P));P.has(o)||(P.add(o),e=Zc.bind(null,e,t,o),t.then(e,e))}function _u(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function wu(e,t,o,d,P){return(e.mode&1)===0?(e===t?e.flags|=65536:(e.flags|=128,o.flags|=131072,o.flags&=-52805,o.tag===1&&(o.alternate===null?o.tag=17:(t=Mn(-1,1),t.tag=2,Fn(o,t,1))),o.lanes|=1),e):(e.flags|=65536,e.lanes=P,e)}var Fc=N.ReactCurrentOwner,Qi=!1;function $i(e,t,o,d){t.child=e===null?Bl(t,null,o,d):vs(t,e.child,o,d)}function bu(e,t,o,d,P){o=o.render;var B=t.ref;return xs(t,P),d=Sa(e,t,o,d,B,P),o=Aa(),e!==null&&!Qi?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~P,kn(e,t,P)):(ti&&o&&oa(t),t.flags|=1,$i(e,t,d,P),t.child)}function Su(e,t,o,d,P){if(e===null){var B=o.type;return typeof B=="function"&&!el(B)&&B.defaultProps===void 0&&o.compare===null&&o.defaultProps===void 0?(t.tag=15,t.type=B,Au(e,t,B,d,P)):(e=Io(o.type,null,d,t,t.mode,P),e.ref=t.ref,e.return=t,t.child=e)}if(B=e.child,(e.lanes&P)===0){var ie=B.memoizedProps;if(o=o.compare,o=o!==null?o:Ms,o(ie,d)&&e.ref===t.ref)return kn(e,t,P)}return t.flags|=1,e=Gn(B,d),e.ref=t.ref,e.return=t,t.child=e}function Au(e,t,o,d,P){if(e!==null){var B=e.memoizedProps;if(Ms(B,d)&&e.ref===t.ref)if(Qi=!1,t.pendingProps=d=B,(e.lanes&P)!==0)(e.flags&131072)!==0&&(Qi=!0);else return t.lanes=e.lanes,kn(e,t,P)}return za(e,t,o,d,P)}function Eu(e,t,o){var d=t.pendingProps,P=d.children,B=e!==null?e.memoizedState:null;if(d.mode==="hidden")if((t.mode&1)===0)t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Zr(Ss,sn),sn|=o;else{if((o&1073741824)===0)return e=B!==null?B.baseLanes|o:o,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Zr(Ss,sn),sn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},d=B!==null?B.baseLanes:o,Zr(Ss,sn),sn|=d}else B!==null?(d=B.baseLanes|o,t.memoizedState=null):d=o,Zr(Ss,sn),sn|=d;return $i(e,t,P,o),t.child}function Cu(e,t){var o=t.ref;(e===null&&o!==null||e!==null&&e.ref!==o)&&(t.flags|=512,t.flags|=2097152)}function za(e,t,o,d,P){var B=Yi(o)?qn:ji.current;return B=fs(t,B),xs(t,P),o=Sa(e,t,o,d,B,P),d=Aa(),e!==null&&!Qi?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~P,kn(e,t,P)):(ti&&d&&oa(t),t.flags|=1,$i(e,t,o,P),t.child)}function Tu(e,t,o,d,P){if(Yi(o)){var B=!0;no(t)}else B=!1;if(xs(t,P),t.stateNode===null)So(e,t),mu(t,o,d),Ra(t,o,d,P),d=!0;else if(e===null){var ie=t.stateNode,Ce=t.memoizedProps;ie.props=Ce;var Fe=ie.context,Ze=o.contextType;typeof Ze=="object"&&Ze!==null?Ze=un(Ze):(Ze=Yi(o)?qn:ji.current,Ze=fs(t,Ze));var xt=o.getDerivedStateFromProps,bt=typeof xt=="function"||typeof ie.getSnapshotBeforeUpdate=="function";bt||typeof ie.UNSAFE_componentWillReceiveProps!="function"&&typeof ie.componentWillReceiveProps!="function"||(Ce!==d||Fe!==Ze)&&gu(t,ie,d,Ze),Ln=!1;var vt=t.memoizedState;ie.state=vt,po(t,d,ie,P),Fe=t.memoizedState,Ce!==d||vt!==Fe||Zi.current||Ln?(typeof xt=="function"&&(ka(t,o,xt,d),Fe=t.memoizedState),(Ce=Ln||pu(t,o,Ce,d,vt,Fe,Ze))?(bt||typeof ie.UNSAFE_componentWillMount!="function"&&typeof ie.componentWillMount!="function"||(typeof ie.componentWillMount=="function"&&ie.componentWillMount(),typeof ie.UNSAFE_componentWillMount=="function"&&ie.UNSAFE_componentWillMount()),typeof ie.componentDidMount=="function"&&(t.flags|=4194308)):(typeof ie.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=d,t.memoizedState=Fe),ie.props=d,ie.state=Fe,ie.context=Ze,d=Ce):(typeof ie.componentDidMount=="function"&&(t.flags|=4194308),d=!1)}else{ie=t.stateNode,Gl(e,t),Ce=t.memoizedProps,Ze=t.type===t.elementType?Ce:mn(t.type,Ce),ie.props=Ze,bt=t.pendingProps,vt=ie.context,Fe=o.contextType,typeof Fe=="object"&&Fe!==null?Fe=un(Fe):(Fe=Yi(o)?qn:ji.current,Fe=fs(t,Fe));var jt=o.getDerivedStateFromProps;(xt=typeof jt=="function"||typeof ie.getSnapshotBeforeUpdate=="function")||typeof ie.UNSAFE_componentWillReceiveProps!="function"&&typeof ie.componentWillReceiveProps!="function"||(Ce!==bt||vt!==Fe)&&gu(t,ie,d,Fe),Ln=!1,vt=t.memoizedState,ie.state=vt,po(t,d,ie,P);var $t=t.memoizedState;Ce!==bt||vt!==$t||Zi.current||Ln?(typeof jt=="function"&&(ka(t,o,jt,d),$t=t.memoizedState),(Ze=Ln||pu(t,o,Ze,d,vt,$t,Fe)||!1)?(xt||typeof ie.UNSAFE_componentWillUpdate!="function"&&typeof ie.componentWillUpdate!="function"||(typeof ie.componentWillUpdate=="function"&&ie.componentWillUpdate(d,$t,Fe),typeof ie.UNSAFE_componentWillUpdate=="function"&&ie.UNSAFE_componentWillUpdate(d,$t,Fe)),typeof ie.componentDidUpdate=="function"&&(t.flags|=4),typeof ie.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof ie.componentDidUpdate!="function"||Ce===e.memoizedProps&&vt===e.memoizedState||(t.flags|=4),typeof ie.getSnapshotBeforeUpdate!="function"||Ce===e.memoizedProps&&vt===e.memoizedState||(t.flags|=1024),t.memoizedProps=d,t.memoizedState=$t),ie.props=d,ie.state=$t,ie.context=Fe,d=Ze):(typeof ie.componentDidUpdate!="function"||Ce===e.memoizedProps&&vt===e.memoizedState||(t.flags|=4),typeof ie.getSnapshotBeforeUpdate!="function"||Ce===e.memoizedProps&&vt===e.memoizedState||(t.flags|=1024),d=!1)}return Ia(e,t,o,d,B,P)}function Ia(e,t,o,d,P,B){Cu(e,t);var ie=(t.flags&128)!==0;if(!d&&!ie)return P&&Dl(t,o,!1),kn(e,t,B);d=t.stateNode,Fc.current=t;var Ce=ie&&typeof o.getDerivedStateFromError!="function"?null:d.render();return t.flags|=1,e!==null&&ie?(t.child=vs(t,e.child,null,B),t.child=vs(t,null,Ce,B)):$i(e,t,Ce,B),t.memoizedState=d.state,P&&Dl(t,o,!0),t.child}function Mu(e){var t=e.stateNode;t.pendingContext?Rl(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Rl(e,t.context,!1),va(e,t.containerInfo)}function ku(e,t,o,d,P){return gs(),ca(P),t.flags|=256,$i(e,t,o,d),t.child}var Oa={dehydrated:null,treeContext:null,retryLane:0};function La(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ru(e,t,o){var d=t.pendingProps,P=oi.current,B=!1,ie=(t.flags&128)!==0,Ce;if((Ce=ie)||(Ce=e!==null&&e.memoizedState===null?!1:(P&2)!==0),Ce?(B=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(P|=1),Zr(oi,P&1),e===null)return ua(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?((t.mode&1)===0?t.lanes=1:e.data==="$!"?t.lanes=8:t.lanes=1073741824,null):(ie=d.children,e=d.fallback,B?(d=t.mode,B=t.child,ie={mode:"hidden",children:ie},(d&1)===0&&B!==null?(B.childLanes=0,B.pendingProps=ie):B=Oo(ie,d,0,null),e=ss(e,d,o,null),B.return=t,e.return=t,B.sibling=e,t.child=B,t.child.memoizedState=La(o),t.memoizedState=Oa,e):Fa(t,ie));if(P=e.memoizedState,P!==null&&(Ce=P.dehydrated,Ce!==null))return Nc(e,t,ie,d,Ce,P,o);if(B){B=d.fallback,ie=t.mode,P=e.child,Ce=P.sibling;var Fe={mode:"hidden",children:d.children};return(ie&1)===0&&t.child!==P?(d=t.child,d.childLanes=0,d.pendingProps=Fe,t.deletions=null):(d=Gn(P,Fe),d.subtreeFlags=P.subtreeFlags&14680064),Ce!==null?B=Gn(Ce,B):(B=ss(B,ie,o,null),B.flags|=2),B.return=t,d.return=t,d.sibling=B,t.child=d,d=B,B=t.child,ie=e.child.memoizedState,ie=ie===null?La(o):{baseLanes:ie.baseLanes|o,cachePool:null,transitions:ie.transitions},B.memoizedState=ie,B.childLanes=e.childLanes&~o,t.memoizedState=Oa,d}return B=e.child,e=B.sibling,d=Gn(B,{mode:"visible",children:d.children}),(t.mode&1)===0&&(d.lanes=o),d.return=t,d.sibling=null,e!==null&&(o=t.deletions,o===null?(t.deletions=[e],t.flags|=16):o.push(e)),t.child=d,t.memoizedState=null,d}function Fa(e,t){return t=Oo({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function bo(e,t,o,d){return d!==null&&ca(d),vs(t,e.child,null,o),e=Fa(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Nc(e,t,o,d,P,B,ie){if(o)return t.flags&256?(t.flags&=-257,d=Pa(Error(a(422))),bo(e,t,ie,d)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(B=d.fallback,P=t.mode,d=Oo({mode:"visible",children:d.children},P,0,null),B=ss(B,P,ie,null),B.flags|=2,d.return=t,B.return=t,d.sibling=B,t.child=d,(t.mode&1)!==0&&vs(t,e.child,null,ie),t.child.memoizedState=La(ie),t.memoizedState=Oa,B);if((t.mode&1)===0)return bo(e,t,ie,null);if(P.data==="$!"){if(d=P.nextSibling&&P.nextSibling.dataset,d)var Ce=d.dgst;return d=Ce,B=Error(a(419)),d=Pa(B,d,void 0),bo(e,t,ie,d)}if(Ce=(ie&e.childLanes)!==0,Qi||Ce){if(d=Ri,d!==null){switch(ie&-ie){case 4:P=2;break;case 16:P=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:P=32;break;case 536870912:P=268435456;break;default:P=0}P=(P&(d.suspendedLanes|ie))!==0?0:P,P!==0&&P!==B.retryLane&&(B.retryLane=P,Tn(e,P),yn(d,e,P,-1))}return Ja(),d=Pa(Error(a(421))),bo(e,t,ie,d)}return P.data==="$?"?(t.flags|=128,t.child=e.child,t=Yc.bind(null,e),P._reactRetry=t,null):(e=B.treeContext,nn=Dn(P.nextSibling),rn=t,ti=!0,pn=null,e!==null&&(an[ln++]=En,an[ln++]=Cn,an[ln++]=Zn,En=e.id,Cn=e.overflow,Zn=t),t=Fa(t,d.children),t.flags|=4096,t)}function Pu(e,t,o){e.lanes|=t;var d=e.alternate;d!==null&&(d.lanes|=t),pa(e.return,t,o)}function Na(e,t,o,d,P){var B=e.memoizedState;B===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:d,tail:o,tailMode:P}:(B.isBackwards=t,B.rendering=null,B.renderingStartTime=0,B.last=d,B.tail=o,B.tailMode=P)}function Du(e,t,o){var d=t.pendingProps,P=d.revealOrder,B=d.tail;if($i(e,t,d.children,o),d=oi.current,(d&2)!==0)d=d&1|2,t.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Pu(e,o,t);else if(e.tag===19)Pu(e,o,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}d&=1}if(Zr(oi,d),(t.mode&1)===0)t.memoizedState=null;else switch(P){case"forwards":for(o=t.child,P=null;o!==null;)e=o.alternate,e!==null&&mo(e)===null&&(P=o),o=o.sibling;o=P,o===null?(P=t.child,t.child=null):(P=o.sibling,o.sibling=null),Na(t,!1,P,o,B);break;case"backwards":for(o=null,P=t.child,t.child=null;P!==null;){if(e=P.alternate,e!==null&&mo(e)===null){t.child=P;break}e=P.sibling,P.sibling=o,o=P,P=e}Na(t,!0,o,null,B);break;case"together":Na(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function So(e,t){(t.mode&1)===0&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function kn(e,t,o){if(e!==null&&(t.dependencies=e.dependencies),ts|=t.lanes,(o&t.childLanes)===0)return null;if(e!==null&&t.child!==e.child)throw Error(a(153));if(t.child!==null){for(e=t.child,o=Gn(e,e.pendingProps),t.child=o,o.return=t;e.sibling!==null;)e=e.sibling,o=o.sibling=Gn(e,e.pendingProps),o.return=t;o.sibling=null}return t.child}function Vc(e,t,o){switch(t.tag){case 3:Mu(t),gs();break;case 5:$l(t);break;case 1:Yi(t.type)&&no(t);break;case 4:va(t,t.stateNode.containerInfo);break;case 10:var d=t.type._context,P=t.memoizedProps.value;Zr(co,d._currentValue),d._currentValue=P;break;case 13:if(d=t.memoizedState,d!==null)return d.dehydrated!==null?(Zr(oi,oi.current&1),t.flags|=128,null):(o&t.child.childLanes)!==0?Ru(e,t,o):(Zr(oi,oi.current&1),e=kn(e,t,o),e!==null?e.sibling:null);Zr(oi,oi.current&1);break;case 19:if(d=(o&t.childLanes)!==0,(e.flags&128)!==0){if(d)return Du(e,t,o);t.flags|=128}if(P=t.memoizedState,P!==null&&(P.rendering=null,P.tail=null,P.lastEffect=null),Zr(oi,oi.current),d)break;return null;case 22:case 23:return t.lanes=0,Eu(e,t,o)}return kn(e,t,o)}var zu,Va,Iu,Ou;zu=function(e,t){for(var o=t.child;o!==null;){if(o.tag===5||o.tag===6)e.appendChild(o.stateNode);else if(o.tag!==4&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===t)break;for(;o.sibling===null;){if(o.return===null||o.return===t)return;o=o.return}o.sibling.return=o.return,o=o.sibling}},Va=function(){},Iu=function(e,t,o,d){var P=e.memoizedProps;if(P!==d){e=t.stateNode,Jn(_n.current);var B=null;switch(o){case"input":P=or(e,P),d=or(e,d),B=[];break;case"select":P=Re({},P,{value:void 0}),d=Re({},d,{value:void 0}),B=[];break;case"textarea":P=Rr(e,P),d=Rr(e,d),B=[];break;default:typeof P.onClick!="function"&&typeof d.onClick=="function"&&(e.onclick=to)}It(o,d);var ie;o=null;for(Ze in P)if(!d.hasOwnProperty(Ze)&&P.hasOwnProperty(Ze)&&P[Ze]!=null)if(Ze==="style"){var Ce=P[Ze];for(ie in Ce)Ce.hasOwnProperty(ie)&&(o||(o={}),o[ie]="")}else Ze!=="dangerouslySetInnerHTML"&&Ze!=="children"&&Ze!=="suppressContentEditableWarning"&&Ze!=="suppressHydrationWarning"&&Ze!=="autoFocus"&&(p.hasOwnProperty(Ze)?B||(B=[]):(B=B||[]).push(Ze,null));for(Ze in d){var Fe=d[Ze];if(Ce=P?.[Ze],d.hasOwnProperty(Ze)&&Fe!==Ce&&(Fe!=null||Ce!=null))if(Ze==="style")if(Ce){for(ie in Ce)!Ce.hasOwnProperty(ie)||Fe&&Fe.hasOwnProperty(ie)||(o||(o={}),o[ie]="");for(ie in Fe)Fe.hasOwnProperty(ie)&&Ce[ie]!==Fe[ie]&&(o||(o={}),o[ie]=Fe[ie])}else o||(B||(B=[]),B.push(Ze,o)),o=Fe;else Ze==="dangerouslySetInnerHTML"?(Fe=Fe?Fe.__html:void 0,Ce=Ce?Ce.__html:void 0,Fe!=null&&Ce!==Fe&&(B=B||[]).push(Ze,Fe)):Ze==="children"?typeof Fe!="string"&&typeof Fe!="number"||(B=B||[]).push(Ze,""+Fe):Ze!=="suppressContentEditableWarning"&&Ze!=="suppressHydrationWarning"&&(p.hasOwnProperty(Ze)?(Fe!=null&&Ze==="onScroll"&&Qr("scroll",e),B||Ce===Fe||(B=[])):(B=B||[]).push(Ze,Fe))}o&&(B=B||[]).push("style",o);var Ze=B;(t.updateQueue=Ze)&&(t.flags|=4)}},Ou=function(e,t,o,d){o!==d&&(t.flags|=4)};function Gs(e,t){if(!ti)switch(e.tailMode){case"hidden":t=e.tail;for(var o=null;t!==null;)t.alternate!==null&&(o=t),t=t.sibling;o===null?e.tail=null:o.sibling=null;break;case"collapsed":o=e.tail;for(var d=null;o!==null;)o.alternate!==null&&(d=o),o=o.sibling;d===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:d.sibling=null}}function Ui(e){var t=e.alternate!==null&&e.alternate.child===e.child,o=0,d=0;if(t)for(var P=e.child;P!==null;)o|=P.lanes|P.childLanes,d|=P.subtreeFlags&14680064,d|=P.flags&14680064,P.return=e,P=P.sibling;else for(P=e.child;P!==null;)o|=P.lanes|P.childLanes,d|=P.subtreeFlags,d|=P.flags,P.return=e,P=P.sibling;return e.subtreeFlags|=d,e.childLanes=o,t}function jc(e,t,o){var d=t.pendingProps;switch(aa(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ui(t),null;case 1:return Yi(t.type)&&io(),Ui(t),null;case 3:return d=t.stateNode,_s(),Jr(Zi),Jr(ji),_a(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(e===null||e.child===null)&&(lo(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,pn!==null&&(Za(pn),pn=null))),Va(e,t),Ui(t),null;case 5:ya(t);var P=Jn(Ns.current);if(o=t.type,e!==null&&t.stateNode!=null)Iu(e,t,o,d,P),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!d){if(t.stateNode===null)throw Error(a(166));return Ui(t),null}if(e=Jn(_n.current),lo(t)){d=t.stateNode,o=t.type;var B=t.memoizedProps;switch(d[xn]=t,d[zs]=B,e=(t.mode&1)!==0,o){case"dialog":Qr("cancel",d),Qr("close",d);break;case"iframe":case"object":case"embed":Qr("load",d);break;case"video":case"audio":for(P=0;P<Rs.length;P++)Qr(Rs[P],d);break;case"source":Qr("error",d);break;case"img":case"image":case"link":Qr("error",d),Qr("load",d);break;case"details":Qr("toggle",d);break;case"input":ar(d,B),Qr("invalid",d);break;case"select":d._wrapperState={wasMultiple:!!B.multiple},Qr("invalid",d);break;case"textarea":Ir(d,B),Qr("invalid",d)}It(o,B),P=null;for(var ie in B)if(B.hasOwnProperty(ie)){var Ce=B[ie];ie==="children"?typeof Ce=="string"?d.textContent!==Ce&&(B.suppressHydrationWarning!==!0&&eo(d.textContent,Ce,e),P=["children",Ce]):typeof Ce=="number"&&d.textContent!==""+Ce&&(B.suppressHydrationWarning!==!0&&eo(d.textContent,Ce,e),P=["children",""+Ce]):p.hasOwnProperty(ie)&&Ce!=null&&ie==="onScroll"&&Qr("scroll",d)}switch(o){case"input":at(d),pr(d,B,!0);break;case"textarea":at(d),wi(d);break;case"select":case"option":break;default:typeof B.onClick=="function"&&(d.onclick=to)}d=P,t.updateQueue=d,d!==null&&(t.flags|=4)}else{ie=P.nodeType===9?P:P.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Hi(o)),e==="http://www.w3.org/1999/xhtml"?o==="script"?(e=ie.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof d.is=="string"?e=ie.createElement(o,{is:d.is}):(e=ie.createElement(o),o==="select"&&(ie=e,d.multiple?ie.multiple=!0:d.size&&(ie.size=d.size))):e=ie.createElementNS(e,o),e[xn]=t,e[zs]=d,zu(e,t,!1,!1),t.stateNode=e;e:{switch(ie=mr(o,d),o){case"dialog":Qr("cancel",e),Qr("close",e),P=d;break;case"iframe":case"object":case"embed":Qr("load",e),P=d;break;case"video":case"audio":for(P=0;P<Rs.length;P++)Qr(Rs[P],e);P=d;break;case"source":Qr("error",e),P=d;break;case"img":case"image":case"link":Qr("error",e),Qr("load",e),P=d;break;case"details":Qr("toggle",e),P=d;break;case"input":ar(e,d),P=or(e,d),Qr("invalid",e);break;case"option":P=d;break;case"select":e._wrapperState={wasMultiple:!!d.multiple},P=Re({},d,{value:void 0}),Qr("invalid",e);break;case"textarea":Ir(e,d),P=Rr(e,d),Qr("invalid",e);break;default:P=d}It(o,P),Ce=P;for(B in Ce)if(Ce.hasOwnProperty(B)){var Fe=Ce[B];B==="style"?Ot(e,Fe):B==="dangerouslySetInnerHTML"?(Fe=Fe?Fe.__html:void 0,Fe!=null&&Oe(e,Fe)):B==="children"?typeof Fe=="string"?(o!=="textarea"||Fe!=="")&&dt(e,Fe):typeof Fe=="number"&&dt(e,""+Fe):B!=="suppressContentEditableWarning"&&B!=="suppressHydrationWarning"&&B!=="autoFocus"&&(p.hasOwnProperty(B)?Fe!=null&&B==="onScroll"&&Qr("scroll",e):Fe!=null&&b(e,B,Fe,ie))}switch(o){case"input":at(e),pr(e,d,!1);break;case"textarea":at(e),wi(e);break;case"option":d.value!=null&&e.setAttribute("value",""+Ie(d.value));break;case"select":e.multiple=!!d.multiple,B=d.value,B!=null?fi(e,!!d.multiple,B,!1):d.defaultValue!=null&&fi(e,!!d.multiple,d.defaultValue,!0);break;default:typeof P.onClick=="function"&&(e.onclick=to)}switch(o){case"button":case"input":case"select":case"textarea":d=!!d.autoFocus;break e;case"img":d=!0;break e;default:d=!1}}d&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Ui(t),null;case 6:if(e&&t.stateNode!=null)Ou(e,t,e.memoizedProps,d);else{if(typeof d!="string"&&t.stateNode===null)throw Error(a(166));if(o=Jn(Ns.current),Jn(_n.current),lo(t)){if(d=t.stateNode,o=t.memoizedProps,d[xn]=t,(B=d.nodeValue!==o)&&(e=rn,e!==null))switch(e.tag){case 3:eo(d.nodeValue,o,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&eo(d.nodeValue,o,(e.mode&1)!==0)}B&&(t.flags|=4)}else d=(o.nodeType===9?o:o.ownerDocument).createTextNode(d),d[xn]=t,t.stateNode=d}return Ui(t),null;case 13:if(Jr(oi),d=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(ti&&nn!==null&&(t.mode&1)!==0&&(t.flags&128)===0)Nl(),gs(),t.flags|=98560,B=!1;else if(B=lo(t),d!==null&&d.dehydrated!==null){if(e===null){if(!B)throw Error(a(318));if(B=t.memoizedState,B=B!==null?B.dehydrated:null,!B)throw Error(a(317));B[xn]=t}else gs(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;Ui(t),B=!1}else pn!==null&&(Za(pn),pn=null),B=!0;if(!B)return t.flags&65536?t:null}return(t.flags&128)!==0?(t.lanes=o,t):(d=d!==null,d!==(e!==null&&e.memoizedState!==null)&&d&&(t.child.flags|=8192,(t.mode&1)!==0&&(e===null||(oi.current&1)!==0?Ai===0&&(Ai=3):Ja())),t.updateQueue!==null&&(t.flags|=4),Ui(t),null);case 4:return _s(),Va(e,t),e===null&&Ps(t.stateNode.containerInfo),Ui(t),null;case 10:return fa(t.type._context),Ui(t),null;case 17:return Yi(t.type)&&io(),Ui(t),null;case 19:if(Jr(oi),B=t.memoizedState,B===null)return Ui(t),null;if(d=(t.flags&128)!==0,ie=B.rendering,ie===null)if(d)Gs(B,!1);else{if(Ai!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(ie=mo(e),ie!==null){for(t.flags|=128,Gs(B,!1),d=ie.updateQueue,d!==null&&(t.updateQueue=d,t.flags|=4),t.subtreeFlags=0,d=o,o=t.child;o!==null;)B=o,e=d,B.flags&=14680066,ie=B.alternate,ie===null?(B.childLanes=0,B.lanes=e,B.child=null,B.subtreeFlags=0,B.memoizedProps=null,B.memoizedState=null,B.updateQueue=null,B.dependencies=null,B.stateNode=null):(B.childLanes=ie.childLanes,B.lanes=ie.lanes,B.child=ie.child,B.subtreeFlags=0,B.deletions=null,B.memoizedProps=ie.memoizedProps,B.memoizedState=ie.memoizedState,B.updateQueue=ie.updateQueue,B.type=ie.type,e=ie.dependencies,B.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),o=o.sibling;return Zr(oi,oi.current&1|2),t.child}e=e.sibling}B.tail!==null&&lt()>As&&(t.flags|=128,d=!0,Gs(B,!1),t.lanes=4194304)}else{if(!d)if(e=mo(ie),e!==null){if(t.flags|=128,d=!0,o=e.updateQueue,o!==null&&(t.updateQueue=o,t.flags|=4),Gs(B,!0),B.tail===null&&B.tailMode==="hidden"&&!ie.alternate&&!ti)return Ui(t),null}else 2*lt()-B.renderingStartTime>As&&o!==1073741824&&(t.flags|=128,d=!0,Gs(B,!1),t.lanes=4194304);B.isBackwards?(ie.sibling=t.child,t.child=ie):(o=B.last,o!==null?o.sibling=ie:t.child=ie,B.last=ie)}return B.tail!==null?(t=B.tail,B.rendering=t,B.tail=t.sibling,B.renderingStartTime=lt(),t.sibling=null,o=oi.current,Zr(oi,d?o&1|2:o&1),t):(Ui(t),null);case 22:case 23:return Qa(),d=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==d&&(t.flags|=8192),d&&(t.mode&1)!==0?(sn&1073741824)!==0&&(Ui(t),t.subtreeFlags&6&&(t.flags|=8192)):Ui(t),null;case 24:return null;case 25:return null}throw Error(a(156,t.tag))}function Bc(e,t){switch(aa(t),t.tag){case 1:return Yi(t.type)&&io(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return _s(),Jr(Zi),Jr(ji),_a(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 5:return ya(t),null;case 13:if(Jr(oi),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(a(340));gs()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Jr(oi),null;case 4:return _s(),null;case 10:return fa(t.type._context),null;case 22:case 23:return Qa(),null;case 24:return null;default:return null}}var Ao=!1,Gi=!1,Uc=typeof WeakSet=="function"?WeakSet:Set,Gt=null;function bs(e,t){var o=e.ref;if(o!==null)if(typeof o=="function")try{o(null)}catch(d){di(e,t,d)}else o.current=null}function ja(e,t,o){try{o()}catch(d){di(e,t,d)}}var Lu=!1;function Gc(e,t){if(Qo=et,e=pl(),Ho(e)){if("selectionStart"in e)var o={start:e.selectionStart,end:e.selectionEnd};else e:{o=(o=e.ownerDocument)&&o.defaultView||window;var d=o.getSelection&&o.getSelection();if(d&&d.rangeCount!==0){o=d.anchorNode;var P=d.anchorOffset,B=d.focusNode;d=d.focusOffset;try{o.nodeType,B.nodeType}catch{o=null;break e}var ie=0,Ce=-1,Fe=-1,Ze=0,xt=0,bt=e,vt=null;t:for(;;){for(var jt;bt!==o||P!==0&&bt.nodeType!==3||(Ce=ie+P),bt!==B||d!==0&&bt.nodeType!==3||(Fe=ie+d),bt.nodeType===3&&(ie+=bt.nodeValue.length),(jt=bt.firstChild)!==null;)vt=bt,bt=jt;for(;;){if(bt===e)break t;if(vt===o&&++Ze===P&&(Ce=ie),vt===B&&++xt===d&&(Fe=ie),(jt=bt.nextSibling)!==null)break;bt=vt,vt=bt.parentNode}bt=jt}o=Ce===-1||Fe===-1?null:{start:Ce,end:Fe}}else o=null}o=o||{start:0,end:0}}else o=null;for(Jo={focusedElem:e,selectionRange:o},et=!1,Gt=t;Gt!==null;)if(t=Gt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Gt=e;else for(;Gt!==null;){t=Gt;try{var $t=t.alternate;if((t.flags&1024)!==0)switch(t.tag){case 0:case 11:case 15:break;case 1:if($t!==null){var Kt=$t.memoizedProps,mi=$t.memoizedState,$e=t.stateNode,je=$e.getSnapshotBeforeUpdate(t.elementType===t.type?Kt:mn(t.type,Kt),mi);$e.__reactInternalSnapshotBeforeUpdate=je}break;case 3:var qe=t.stateNode.containerInfo;qe.nodeType===1?qe.textContent="":qe.nodeType===9&&qe.documentElement&&qe.removeChild(qe.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(a(163))}}catch(Tt){di(t,t.return,Tt)}if(e=t.sibling,e!==null){e.return=t.return,Gt=e;break}Gt=t.return}return $t=Lu,Lu=!1,$t}function Hs(e,t,o){var d=t.updateQueue;if(d=d!==null?d.lastEffect:null,d!==null){var P=d=d.next;do{if((P.tag&e)===e){var B=P.destroy;P.destroy=void 0,B!==void 0&&ja(t,o,B)}P=P.next}while(P!==d)}}function Eo(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var o=t=t.next;do{if((o.tag&e)===e){var d=o.create;o.destroy=d()}o=o.next}while(o!==t)}}function Ba(e){var t=e.ref;if(t!==null){var o=e.stateNode;switch(e.tag){case 5:e=o;break;default:e=o}typeof t=="function"?t(e):t.current=e}}function Fu(e){var t=e.alternate;t!==null&&(e.alternate=null,Fu(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[xn],delete t[zs],delete t[ia],delete t[Ec],delete t[Cc])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Nu(e){return e.tag===5||e.tag===3||e.tag===4}function Vu(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Nu(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Ua(e,t,o){var d=e.tag;if(d===5||d===6)e=e.stateNode,t?o.nodeType===8?o.parentNode.insertBefore(e,t):o.insertBefore(e,t):(o.nodeType===8?(t=o.parentNode,t.insertBefore(e,o)):(t=o,t.appendChild(e)),o=o._reactRootContainer,o!=null||t.onclick!==null||(t.onclick=to));else if(d!==4&&(e=e.child,e!==null))for(Ua(e,t,o),e=e.sibling;e!==null;)Ua(e,t,o),e=e.sibling}function Ga(e,t,o){var d=e.tag;if(d===5||d===6)e=e.stateNode,t?o.insertBefore(e,t):o.appendChild(e);else if(d!==4&&(e=e.child,e!==null))for(Ga(e,t,o),e=e.sibling;e!==null;)Ga(e,t,o),e=e.sibling}var Li=null,gn=!1;function Nn(e,t,o){for(o=o.child;o!==null;)ju(e,t,o),o=o.sibling}function ju(e,t,o){if(Cr&&typeof Cr.onCommitFiberUnmount=="function")try{Cr.onCommitFiberUnmount(Er,o)}catch{}switch(o.tag){case 5:Gi||bs(o,t);case 6:var d=Li,P=gn;Li=null,Nn(e,t,o),Li=d,gn=P,Li!==null&&(gn?(e=Li,o=o.stateNode,e.nodeType===8?e.parentNode.removeChild(o):e.removeChild(o)):Li.removeChild(o.stateNode));break;case 18:Li!==null&&(gn?(e=Li,o=o.stateNode,e.nodeType===8?ra(e.parentNode,o):e.nodeType===1&&ra(e,o),pt(e)):ra(Li,o.stateNode));break;case 4:d=Li,P=gn,Li=o.stateNode.containerInfo,gn=!0,Nn(e,t,o),Li=d,gn=P;break;case 0:case 11:case 14:case 15:if(!Gi&&(d=o.updateQueue,d!==null&&(d=d.lastEffect,d!==null))){P=d=d.next;do{var B=P,ie=B.destroy;B=B.tag,ie!==void 0&&((B&2)!==0||(B&4)!==0)&&ja(o,t,ie),P=P.next}while(P!==d)}Nn(e,t,o);break;case 1:if(!Gi&&(bs(o,t),d=o.stateNode,typeof d.componentWillUnmount=="function"))try{d.props=o.memoizedProps,d.state=o.memoizedState,d.componentWillUnmount()}catch(Ce){di(o,t,Ce)}Nn(e,t,o);break;case 21:Nn(e,t,o);break;case 22:o.mode&1?(Gi=(d=Gi)||o.memoizedState!==null,Nn(e,t,o),Gi=d):Nn(e,t,o);break;default:Nn(e,t,o)}}function Bu(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var o=e.stateNode;o===null&&(o=e.stateNode=new Uc),t.forEach(function(d){var P=Qc.bind(null,e,d);o.has(d)||(o.add(d),d.then(P,P))})}}function vn(e,t){var o=t.deletions;if(o!==null)for(var d=0;d<o.length;d++){var P=o[d];try{var B=e,ie=t,Ce=ie;e:for(;Ce!==null;){switch(Ce.tag){case 5:Li=Ce.stateNode,gn=!1;break e;case 3:Li=Ce.stateNode.containerInfo,gn=!0;break e;case 4:Li=Ce.stateNode.containerInfo,gn=!0;break e}Ce=Ce.return}if(Li===null)throw Error(a(160));ju(B,ie,P),Li=null,gn=!1;var Fe=P.alternate;Fe!==null&&(Fe.return=null),P.return=null}catch(Ze){di(P,t,Ze)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Uu(t,e),t=t.sibling}function Uu(e,t){var o=e.alternate,d=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(vn(t,e),bn(e),d&4){try{Hs(3,e,e.return),Eo(3,e)}catch(Kt){di(e,e.return,Kt)}try{Hs(5,e,e.return)}catch(Kt){di(e,e.return,Kt)}}break;case 1:vn(t,e),bn(e),d&512&&o!==null&&bs(o,o.return);break;case 5:if(vn(t,e),bn(e),d&512&&o!==null&&bs(o,o.return),e.flags&32){var P=e.stateNode;try{dt(P,"")}catch(Kt){di(e,e.return,Kt)}}if(d&4&&(P=e.stateNode,P!=null)){var B=e.memoizedProps,ie=o!==null?o.memoizedProps:B,Ce=e.type,Fe=e.updateQueue;if(e.updateQueue=null,Fe!==null)try{Ce==="input"&&B.type==="radio"&&B.name!=null&&kr(P,B),mr(Ce,ie);var Ze=mr(Ce,B);for(ie=0;ie<Fe.length;ie+=2){var xt=Fe[ie],bt=Fe[ie+1];xt==="style"?Ot(P,bt):xt==="dangerouslySetInnerHTML"?Oe(P,bt):xt==="children"?dt(P,bt):b(P,xt,bt,Ze)}switch(Ce){case"input":Ar(P,B);break;case"textarea":Di(P,B);break;case"select":var vt=P._wrapperState.wasMultiple;P._wrapperState.wasMultiple=!!B.multiple;var jt=B.value;jt!=null?fi(P,!!B.multiple,jt,!1):vt!==!!B.multiple&&(B.defaultValue!=null?fi(P,!!B.multiple,B.defaultValue,!0):fi(P,!!B.multiple,B.multiple?[]:"",!1))}P[zs]=B}catch(Kt){di(e,e.return,Kt)}}break;case 6:if(vn(t,e),bn(e),d&4){if(e.stateNode===null)throw Error(a(162));P=e.stateNode,B=e.memoizedProps;try{P.nodeValue=B}catch(Kt){di(e,e.return,Kt)}}break;case 3:if(vn(t,e),bn(e),d&4&&o!==null&&o.memoizedState.isDehydrated)try{pt(t.containerInfo)}catch(Kt){di(e,e.return,Kt)}break;case 4:vn(t,e),bn(e);break;case 13:vn(t,e),bn(e),P=e.child,P.flags&8192&&(B=P.memoizedState!==null,P.stateNode.isHidden=B,!B||P.alternate!==null&&P.alternate.memoizedState!==null||($a=lt())),d&4&&Bu(e);break;case 22:if(xt=o!==null&&o.memoizedState!==null,e.mode&1?(Gi=(Ze=Gi)||xt,vn(t,e),Gi=Ze):vn(t,e),bn(e),d&8192){if(Ze=e.memoizedState!==null,(e.stateNode.isHidden=Ze)&&!xt&&(e.mode&1)!==0)for(Gt=e,xt=e.child;xt!==null;){for(bt=Gt=xt;Gt!==null;){switch(vt=Gt,jt=vt.child,vt.tag){case 0:case 11:case 14:case 15:Hs(4,vt,vt.return);break;case 1:bs(vt,vt.return);var $t=vt.stateNode;if(typeof $t.componentWillUnmount=="function"){d=vt,o=vt.return;try{t=d,$t.props=t.memoizedProps,$t.state=t.memoizedState,$t.componentWillUnmount()}catch(Kt){di(d,o,Kt)}}break;case 5:bs(vt,vt.return);break;case 22:if(vt.memoizedState!==null){Wu(bt);continue}}jt!==null?(jt.return=vt,Gt=jt):Wu(bt)}xt=xt.sibling}e:for(xt=null,bt=e;;){if(bt.tag===5){if(xt===null){xt=bt;try{P=bt.stateNode,Ze?(B=P.style,typeof B.setProperty=="function"?B.setProperty("display","none","important"):B.display="none"):(Ce=bt.stateNode,Fe=bt.memoizedProps.style,ie=Fe!=null&&Fe.hasOwnProperty("display")?Fe.display:null,Ce.style.display=ht("display",ie))}catch(Kt){di(e,e.return,Kt)}}}else if(bt.tag===6){if(xt===null)try{bt.stateNode.nodeValue=Ze?"":bt.memoizedProps}catch(Kt){di(e,e.return,Kt)}}else if((bt.tag!==22&&bt.tag!==23||bt.memoizedState===null||bt===e)&&bt.child!==null){bt.child.return=bt,bt=bt.child;continue}if(bt===e)break e;for(;bt.sibling===null;){if(bt.return===null||bt.return===e)break e;xt===bt&&(xt=null),bt=bt.return}xt===bt&&(xt=null),bt.sibling.return=bt.return,bt=bt.sibling}}break;case 19:vn(t,e),bn(e),d&4&&Bu(e);break;case 21:break;default:vn(t,e),bn(e)}}function bn(e){var t=e.flags;if(t&2){try{e:{for(var o=e.return;o!==null;){if(Nu(o)){var d=o;break e}o=o.return}throw Error(a(160))}switch(d.tag){case 5:var P=d.stateNode;d.flags&32&&(dt(P,""),d.flags&=-33);var B=Vu(e);Ga(e,B,P);break;case 3:case 4:var ie=d.stateNode.containerInfo,Ce=Vu(e);Ua(e,Ce,ie);break;default:throw Error(a(161))}}catch(Fe){di(e,e.return,Fe)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Hc(e,t,o){Gt=e,Gu(e)}function Gu(e,t,o){for(var d=(e.mode&1)!==0;Gt!==null;){var P=Gt,B=P.child;if(P.tag===22&&d){var ie=P.memoizedState!==null||Ao;if(!ie){var Ce=P.alternate,Fe=Ce!==null&&Ce.memoizedState!==null||Gi;Ce=Ao;var Ze=Gi;if(Ao=ie,(Gi=Fe)&&!Ze)for(Gt=P;Gt!==null;)ie=Gt,Fe=ie.child,ie.tag===22&&ie.memoizedState!==null?$u(P):Fe!==null?(Fe.return=ie,Gt=Fe):$u(P);for(;B!==null;)Gt=B,Gu(B),B=B.sibling;Gt=P,Ao=Ce,Gi=Ze}Hu(e)}else(P.subtreeFlags&8772)!==0&&B!==null?(B.return=P,Gt=B):Hu(e)}}function Hu(e){for(;Gt!==null;){var t=Gt;if((t.flags&8772)!==0){var o=t.alternate;try{if((t.flags&8772)!==0)switch(t.tag){case 0:case 11:case 15:Gi||Eo(5,t);break;case 1:var d=t.stateNode;if(t.flags&4&&!Gi)if(o===null)d.componentDidMount();else{var P=t.elementType===t.type?o.memoizedProps:mn(t.type,o.memoizedProps);d.componentDidUpdate(P,o.memoizedState,d.__reactInternalSnapshotBeforeUpdate)}var B=t.updateQueue;B!==null&&Wl(t,B,d);break;case 3:var ie=t.updateQueue;if(ie!==null){if(o=null,t.child!==null)switch(t.child.tag){case 5:o=t.child.stateNode;break;case 1:o=t.child.stateNode}Wl(t,ie,o)}break;case 5:var Ce=t.stateNode;if(o===null&&t.flags&4){o=Ce;var Fe=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":Fe.autoFocus&&o.focus();break;case"img":Fe.src&&(o.src=Fe.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var Ze=t.alternate;if(Ze!==null){var xt=Ze.memoizedState;if(xt!==null){var bt=xt.dehydrated;bt!==null&&pt(bt)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(a(163))}Gi||t.flags&512&&Ba(t)}catch(vt){di(t,t.return,vt)}}if(t===e){Gt=null;break}if(o=t.sibling,o!==null){o.return=t.return,Gt=o;break}Gt=t.return}}function Wu(e){for(;Gt!==null;){var t=Gt;if(t===e){Gt=null;break}var o=t.sibling;if(o!==null){o.return=t.return,Gt=o;break}Gt=t.return}}function $u(e){for(;Gt!==null;){var t=Gt;try{switch(t.tag){case 0:case 11:case 15:var o=t.return;try{Eo(4,t)}catch(Fe){di(t,o,Fe)}break;case 1:var d=t.stateNode;if(typeof d.componentDidMount=="function"){var P=t.return;try{d.componentDidMount()}catch(Fe){di(t,P,Fe)}}var B=t.return;try{Ba(t)}catch(Fe){di(t,B,Fe)}break;case 5:var ie=t.return;try{Ba(t)}catch(Fe){di(t,ie,Fe)}}}catch(Fe){di(t,t.return,Fe)}if(t===e){Gt=null;break}var Ce=t.sibling;if(Ce!==null){Ce.return=t.return,Gt=Ce;break}Gt=t.return}}var Wc=Math.ceil,Co=N.ReactCurrentDispatcher,Ha=N.ReactCurrentOwner,hn=N.ReactCurrentBatchConfig,Nr=0,Ri=null,_i=null,Fi=0,sn=0,Ss=zn(0),Ai=0,Ws=null,ts=0,To=0,Wa=0,$s=null,Ji=null,$a=0,As=1/0,Rn=null,Mo=!1,Xa=null,Vn=null,ko=!1,jn=null,Ro=0,Xs=0,Ka=null,Po=-1,Do=0;function Xi(){return(Nr&6)!==0?lt():Po!==-1?Po:Po=lt()}function Bn(e){return(e.mode&1)===0?1:(Nr&2)!==0&&Fi!==0?Fi&-Fi:Mc.transition!==null?(Do===0&&(Do=A()),Do):(e=R,e!==0||(e=window.event,e=e===void 0?16:Rt(e.type)),e)}function yn(e,t,o,d){if(50<Xs)throw Xs=0,Ka=null,Error(a(185));E(e,o,d),((Nr&2)===0||e!==Ri)&&(e===Ri&&((Nr&2)===0&&(To|=o),Ai===4&&Un(e,Fi)),en(e,d),o===1&&Nr===0&&(t.mode&1)===0&&(As=lt()+500,so&&On()))}function en(e,t){var o=e.callbackNode;l(e,t);var d=i(e,e===Ri?Fi:0);if(d===0)o!==null&&Ve(o),e.callbackNode=null,e.callbackPriority=0;else if(t=d&-d,e.callbackPriority!==t){if(o!=null&&Ve(o),t===1)e.tag===0?Tc(Ku.bind(null,e)):zl(Ku.bind(null,e)),Sc(function(){(Nr&6)===0&&On()}),o=null;else{switch(O(d)){case 1:o=Mt;break;case 4:o=Pt;break;case 16:o=Lt;break;case 536870912:o=Yt;break;default:o=Lt}o=rc(o,Xu.bind(null,e))}e.callbackPriority=t,e.callbackNode=o}}function Xu(e,t){if(Po=-1,Do=0,(Nr&6)!==0)throw Error(a(327));var o=e.callbackNode;if(Es()&&e.callbackNode!==o)return null;var d=i(e,e===Ri?Fi:0);if(d===0)return null;if((d&30)!==0||(d&e.expiredLanes)!==0||t)t=zo(e,d);else{t=d;var P=Nr;Nr|=2;var B=Zu();(Ri!==e||Fi!==t)&&(Rn=null,As=lt()+500,is(e,t));do try{Kc();break}catch(Ce){qu(e,Ce)}while(!0);da(),Co.current=B,Nr=P,_i!==null?t=0:(Ri=null,Fi=0,t=Ai)}if(t!==0){if(t===2&&(P=h(e),P!==0&&(d=P,t=qa(e,P))),t===1)throw o=Ws,is(e,0),Un(e,d),en(e,lt()),o;if(t===6)Un(e,d);else{if(P=e.current.alternate,(d&30)===0&&!$c(P)&&(t=zo(e,d),t===2&&(B=h(e),B!==0&&(d=B,t=qa(e,B))),t===1))throw o=Ws,is(e,0),Un(e,d),en(e,lt()),o;switch(e.finishedWork=P,e.finishedLanes=d,t){case 0:case 1:throw Error(a(345));case 2:ns(e,Ji,Rn);break;case 3:if(Un(e,d),(d&130023424)===d&&(t=$a+500-lt(),10<t)){if(i(e,0)!==0)break;if(P=e.suspendedLanes,(P&d)!==d){Xi(),e.pingedLanes|=e.suspendedLanes&P;break}e.timeoutHandle=ta(ns.bind(null,e,Ji,Rn),t);break}ns(e,Ji,Rn);break;case 4:if(Un(e,d),(d&4194240)===d)break;for(t=e.eventTimes,P=-1;0<d;){var ie=31-_r(d);B=1<<ie,ie=t[ie],ie>P&&(P=ie),d&=~B}if(d=P,d=lt()-d,d=(120>d?120:480>d?480:1080>d?1080:1920>d?1920:3e3>d?3e3:4320>d?4320:1960*Wc(d/1960))-d,10<d){e.timeoutHandle=ta(ns.bind(null,e,Ji,Rn),d);break}ns(e,Ji,Rn);break;case 5:ns(e,Ji,Rn);break;default:throw Error(a(329))}}}return en(e,lt()),e.callbackNode===o?Xu.bind(null,e):null}function qa(e,t){var o=$s;return e.current.memoizedState.isDehydrated&&(is(e,t).flags|=256),e=zo(e,t),e!==2&&(t=Ji,Ji=o,t!==null&&Za(t)),e}function Za(e){Ji===null?Ji=e:Ji.push.apply(Ji,e)}function $c(e){for(var t=e;;){if(t.flags&16384){var o=t.updateQueue;if(o!==null&&(o=o.stores,o!==null))for(var d=0;d<o.length;d++){var P=o[d],B=P.getSnapshot;P=P.value;try{if(!fn(B(),P))return!1}catch{return!1}}}if(o=t.child,t.subtreeFlags&16384&&o!==null)o.return=t,t=o;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Un(e,t){for(t&=~Wa,t&=~To,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var o=31-_r(t),d=1<<o;e[o]=-1,t&=~d}}function Ku(e){if((Nr&6)!==0)throw Error(a(327));Es();var t=i(e,0);if((t&1)===0)return en(e,lt()),null;var o=zo(e,t);if(e.tag!==0&&o===2){var d=h(e);d!==0&&(t=d,o=qa(e,d))}if(o===1)throw o=Ws,is(e,0),Un(e,t),en(e,lt()),o;if(o===6)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ns(e,Ji,Rn),en(e,lt()),null}function Ya(e,t){var o=Nr;Nr|=1;try{return e(t)}finally{Nr=o,Nr===0&&(As=lt()+500,so&&On())}}function rs(e){jn!==null&&jn.tag===0&&(Nr&6)===0&&Es();var t=Nr;Nr|=1;var o=hn.transition,d=R;try{if(hn.transition=null,R=1,e)return e()}finally{R=d,hn.transition=o,Nr=t,(Nr&6)===0&&On()}}function Qa(){sn=Ss.current,Jr(Ss)}function is(e,t){e.finishedWork=null,e.finishedLanes=0;var o=e.timeoutHandle;if(o!==-1&&(e.timeoutHandle=-1,bc(o)),_i!==null)for(o=_i.return;o!==null;){var d=o;switch(aa(d),d.tag){case 1:d=d.type.childContextTypes,d!=null&&io();break;case 3:_s(),Jr(Zi),Jr(ji),_a();break;case 5:ya(d);break;case 4:_s();break;case 13:Jr(oi);break;case 19:Jr(oi);break;case 10:fa(d.type._context);break;case 22:case 23:Qa()}o=o.return}if(Ri=e,_i=e=Gn(e.current,null),Fi=sn=t,Ai=0,Ws=null,Wa=To=ts=0,Ji=$s=null,Qn!==null){for(t=0;t<Qn.length;t++)if(o=Qn[t],d=o.interleaved,d!==null){o.interleaved=null;var P=d.next,B=o.pending;if(B!==null){var ie=B.next;B.next=P,d.next=ie}o.pending=d}Qn=null}return e}function qu(e,t){do{var o=_i;try{if(da(),go.current=_o,vo){for(var d=ai.memoizedState;d!==null;){var P=d.queue;P!==null&&(P.pending=null),d=d.next}vo=!1}if(es=0,ki=Si=ai=null,Vs=!1,js=0,Ha.current=null,o===null||o.return===null){Ai=1,Ws=t,_i=null;break}e:{var B=e,ie=o.return,Ce=o,Fe=t;if(t=Fi,Ce.flags|=32768,Fe!==null&&typeof Fe=="object"&&typeof Fe.then=="function"){var Ze=Fe,xt=Ce,bt=xt.tag;if((xt.mode&1)===0&&(bt===0||bt===11||bt===15)){var vt=xt.alternate;vt?(xt.updateQueue=vt.updateQueue,xt.memoizedState=vt.memoizedState,xt.lanes=vt.lanes):(xt.updateQueue=null,xt.memoizedState=null)}var jt=_u(ie);if(jt!==null){jt.flags&=-257,wu(jt,ie,Ce,B,t),jt.mode&1&&xu(B,Ze,t),t=jt,Fe=Ze;var $t=t.updateQueue;if($t===null){var Kt=new Set;Kt.add(Fe),t.updateQueue=Kt}else $t.add(Fe);break e}else{if((t&1)===0){xu(B,Ze,t),Ja();break e}Fe=Error(a(426))}}else if(ti&&Ce.mode&1){var mi=_u(ie);if(mi!==null){(mi.flags&65536)===0&&(mi.flags|=256),wu(mi,ie,Ce,B,t),ca(ws(Fe,Ce));break e}}B=Fe=ws(Fe,Ce),Ai!==4&&(Ai=2),$s===null?$s=[B]:$s.push(B),B=ie;do{switch(B.tag){case 3:B.flags|=65536,t&=-t,B.lanes|=t;var $e=vu(B,Fe,t);Hl(B,$e);break e;case 1:Ce=Fe;var je=B.type,qe=B.stateNode;if((B.flags&128)===0&&(typeof je.getDerivedStateFromError=="function"||qe!==null&&typeof qe.componentDidCatch=="function"&&(Vn===null||!Vn.has(qe)))){B.flags|=65536,t&=-t,B.lanes|=t;var Tt=yu(B,Ce,t);Hl(B,Tt);break e}}B=B.return}while(B!==null)}Qu(o)}catch(Zt){t=Zt,_i===o&&o!==null&&(_i=o=o.return);continue}break}while(!0)}function Zu(){var e=Co.current;return Co.current=_o,e===null?_o:e}function Ja(){(Ai===0||Ai===3||Ai===2)&&(Ai=4),Ri===null||(ts&268435455)===0&&(To&268435455)===0||Un(Ri,Fi)}function zo(e,t){var o=Nr;Nr|=2;var d=Zu();(Ri!==e||Fi!==t)&&(Rn=null,is(e,t));do try{Xc();break}catch(P){qu(e,P)}while(!0);if(da(),Nr=o,Co.current=d,_i!==null)throw Error(a(261));return Ri=null,Fi=0,Ai}function Xc(){for(;_i!==null;)Yu(_i)}function Kc(){for(;_i!==null&&!Le();)Yu(_i)}function Yu(e){var t=tc(e.alternate,e,sn);e.memoizedProps=e.pendingProps,t===null?Qu(e):_i=t,Ha.current=null}function Qu(e){var t=e;do{var o=t.alternate;if(e=t.return,(t.flags&32768)===0){if(o=jc(o,t,sn),o!==null){_i=o;return}}else{if(o=Bc(o,t),o!==null){o.flags&=32767,_i=o;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ai=6,_i=null;return}}if(t=t.sibling,t!==null){_i=t;return}_i=t=e}while(t!==null);Ai===0&&(Ai=5)}function ns(e,t,o){var d=R,P=hn.transition;try{hn.transition=null,R=1,qc(e,t,o,d)}finally{hn.transition=P,R=d}return null}function qc(e,t,o,d){do Es();while(jn!==null);if((Nr&6)!==0)throw Error(a(327));o=e.finishedWork;var P=e.finishedLanes;if(o===null)return null;if(e.finishedWork=null,e.finishedLanes=0,o===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var B=o.lanes|o.childLanes;if(M(e,B),e===Ri&&(_i=Ri=null,Fi=0),(o.subtreeFlags&2064)===0&&(o.flags&2064)===0||ko||(ko=!0,rc(Lt,function(){return Es(),null})),B=(o.flags&15990)!==0,(o.subtreeFlags&15990)!==0||B){B=hn.transition,hn.transition=null;var ie=R;R=1;var Ce=Nr;Nr|=4,Ha.current=null,Gc(e,o),Uu(o,e),mc(Jo),et=!!Qo,Jo=Qo=null,e.current=o,Hc(o),yt(),Nr=Ce,R=ie,hn.transition=B}else e.current=o;if(ko&&(ko=!1,jn=e,Ro=P),B=e.pendingLanes,B===0&&(Vn=null),Ur(o.stateNode),en(e,lt()),t!==null)for(d=e.onRecoverableError,o=0;o<t.length;o++)P=t[o],d(P.value,{componentStack:P.stack,digest:P.digest});if(Mo)throw Mo=!1,e=Xa,Xa=null,e;return(Ro&1)!==0&&e.tag!==0&&Es(),B=e.pendingLanes,(B&1)!==0?e===Ka?Xs++:(Xs=0,Ka=e):Xs=0,On(),null}function Es(){if(jn!==null){var e=O(Ro),t=hn.transition,o=R;try{if(hn.transition=null,R=16>e?16:e,jn===null)var d=!1;else{if(e=jn,jn=null,Ro=0,(Nr&6)!==0)throw Error(a(331));var P=Nr;for(Nr|=4,Gt=e.current;Gt!==null;){var B=Gt,ie=B.child;if((Gt.flags&16)!==0){var Ce=B.deletions;if(Ce!==null){for(var Fe=0;Fe<Ce.length;Fe++){var Ze=Ce[Fe];for(Gt=Ze;Gt!==null;){var xt=Gt;switch(xt.tag){case 0:case 11:case 15:Hs(8,xt,B)}var bt=xt.child;if(bt!==null)bt.return=xt,Gt=bt;else for(;Gt!==null;){xt=Gt;var vt=xt.sibling,jt=xt.return;if(Fu(xt),xt===Ze){Gt=null;break}if(vt!==null){vt.return=jt,Gt=vt;break}Gt=jt}}}var $t=B.alternate;if($t!==null){var Kt=$t.child;if(Kt!==null){$t.child=null;do{var mi=Kt.sibling;Kt.sibling=null,Kt=mi}while(Kt!==null)}}Gt=B}}if((B.subtreeFlags&2064)!==0&&ie!==null)ie.return=B,Gt=ie;else e:for(;Gt!==null;){if(B=Gt,(B.flags&2048)!==0)switch(B.tag){case 0:case 11:case 15:Hs(9,B,B.return)}var $e=B.sibling;if($e!==null){$e.return=B.return,Gt=$e;break e}Gt=B.return}}var je=e.current;for(Gt=je;Gt!==null;){ie=Gt;var qe=ie.child;if((ie.subtreeFlags&2064)!==0&&qe!==null)qe.return=ie,Gt=qe;else e:for(ie=je;Gt!==null;){if(Ce=Gt,(Ce.flags&2048)!==0)try{switch(Ce.tag){case 0:case 11:case 15:Eo(9,Ce)}}catch(Zt){di(Ce,Ce.return,Zt)}if(Ce===ie){Gt=null;break e}var Tt=Ce.sibling;if(Tt!==null){Tt.return=Ce.return,Gt=Tt;break e}Gt=Ce.return}}if(Nr=P,On(),Cr&&typeof Cr.onPostCommitFiberRoot=="function")try{Cr.onPostCommitFiberRoot(Er,e)}catch{}d=!0}return d}finally{R=o,hn.transition=t}}return!1}function Ju(e,t,o){t=ws(o,t),t=vu(e,t,1),e=Fn(e,t,1),t=Xi(),e!==null&&(E(e,1,t),en(e,t))}function di(e,t,o){if(e.tag===3)Ju(e,e,o);else for(;t!==null;){if(t.tag===3){Ju(t,e,o);break}else if(t.tag===1){var d=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(Vn===null||!Vn.has(d))){e=ws(o,e),e=yu(t,e,1),t=Fn(t,e,1),e=Xi(),t!==null&&(E(t,1,e),en(t,e));break}}t=t.return}}function Zc(e,t,o){var d=e.pingCache;d!==null&&d.delete(t),t=Xi(),e.pingedLanes|=e.suspendedLanes&o,Ri===e&&(Fi&o)===o&&(Ai===4||Ai===3&&(Fi&130023424)===Fi&&500>lt()-$a?is(e,0):Wa|=o),en(e,t)}function ec(e,t){t===0&&((e.mode&1)===0?t=1:(t=ri,ri<<=1,(ri&130023424)===0&&(ri=4194304)));var o=Xi();e=Tn(e,t),e!==null&&(E(e,t,o),en(e,o))}function Yc(e){var t=e.memoizedState,o=0;t!==null&&(o=t.retryLane),ec(e,o)}function Qc(e,t){var o=0;switch(e.tag){case 13:var d=e.stateNode,P=e.memoizedState;P!==null&&(o=P.retryLane);break;case 19:d=e.stateNode;break;default:throw Error(a(314))}d!==null&&d.delete(t),ec(e,o)}var tc;tc=function(e,t,o){if(e!==null)if(e.memoizedProps!==t.pendingProps||Zi.current)Qi=!0;else{if((e.lanes&o)===0&&(t.flags&128)===0)return Qi=!1,Vc(e,t,o);Qi=(e.flags&131072)!==0}else Qi=!1,ti&&(t.flags&1048576)!==0&&Il(t,ao,t.index);switch(t.lanes=0,t.tag){case 2:var d=t.type;So(e,t),e=t.pendingProps;var P=fs(t,ji.current);xs(t,o),P=Sa(null,t,d,e,P,o);var B=Aa();return t.flags|=1,typeof P=="object"&&P!==null&&typeof P.render=="function"&&P.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Yi(d)?(B=!0,no(t)):B=!1,t.memoizedState=P.state!==null&&P.state!==void 0?P.state:null,ga(t),P.updater=wo,t.stateNode=P,P._reactInternals=t,Ra(t,d,e,o),t=Ia(null,t,d,!0,B,o)):(t.tag=0,ti&&B&&oa(t),$i(null,t,P,o),t=t.child),t;case 16:d=t.elementType;e:{switch(So(e,t),e=t.pendingProps,P=d._init,d=P(d._payload),t.type=d,P=t.tag=eh(d),e=mn(d,e),P){case 0:t=za(null,t,d,e,o);break e;case 1:t=Tu(null,t,d,e,o);break e;case 11:t=bu(null,t,d,e,o);break e;case 14:t=Su(null,t,d,mn(d.type,e),o);break e}throw Error(a(306,d,""))}return t;case 0:return d=t.type,P=t.pendingProps,P=t.elementType===d?P:mn(d,P),za(e,t,d,P,o);case 1:return d=t.type,P=t.pendingProps,P=t.elementType===d?P:mn(d,P),Tu(e,t,d,P,o);case 3:e:{if(Mu(t),e===null)throw Error(a(387));d=t.pendingProps,B=t.memoizedState,P=B.element,Gl(e,t),po(t,d,null,o);var ie=t.memoizedState;if(d=ie.element,B.isDehydrated)if(B={element:d,isDehydrated:!1,cache:ie.cache,pendingSuspenseBoundaries:ie.pendingSuspenseBoundaries,transitions:ie.transitions},t.updateQueue.baseState=B,t.memoizedState=B,t.flags&256){P=ws(Error(a(423)),t),t=ku(e,t,d,o,P);break e}else if(d!==P){P=ws(Error(a(424)),t),t=ku(e,t,d,o,P);break e}else for(nn=Dn(t.stateNode.containerInfo.firstChild),rn=t,ti=!0,pn=null,o=Bl(t,null,d,o),t.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(gs(),d===P){t=kn(e,t,o);break e}$i(e,t,d,o)}t=t.child}return t;case 5:return $l(t),e===null&&ua(t),d=t.type,P=t.pendingProps,B=e!==null?e.memoizedProps:null,ie=P.children,ea(d,P)?ie=null:B!==null&&ea(d,B)&&(t.flags|=32),Cu(e,t),$i(e,t,ie,o),t.child;case 6:return e===null&&ua(t),null;case 13:return Ru(e,t,o);case 4:return va(t,t.stateNode.containerInfo),d=t.pendingProps,e===null?t.child=vs(t,null,d,o):$i(e,t,d,o),t.child;case 11:return d=t.type,P=t.pendingProps,P=t.elementType===d?P:mn(d,P),bu(e,t,d,P,o);case 7:return $i(e,t,t.pendingProps,o),t.child;case 8:return $i(e,t,t.pendingProps.children,o),t.child;case 12:return $i(e,t,t.pendingProps.children,o),t.child;case 10:e:{if(d=t.type._context,P=t.pendingProps,B=t.memoizedProps,ie=P.value,Zr(co,d._currentValue),d._currentValue=ie,B!==null)if(fn(B.value,ie)){if(B.children===P.children&&!Zi.current){t=kn(e,t,o);break e}}else for(B=t.child,B!==null&&(B.return=t);B!==null;){var Ce=B.dependencies;if(Ce!==null){ie=B.child;for(var Fe=Ce.firstContext;Fe!==null;){if(Fe.context===d){if(B.tag===1){Fe=Mn(-1,o&-o),Fe.tag=2;var Ze=B.updateQueue;if(Ze!==null){Ze=Ze.shared;var xt=Ze.pending;xt===null?Fe.next=Fe:(Fe.next=xt.next,xt.next=Fe),Ze.pending=Fe}}B.lanes|=o,Fe=B.alternate,Fe!==null&&(Fe.lanes|=o),pa(B.return,o,t),Ce.lanes|=o;break}Fe=Fe.next}}else if(B.tag===10)ie=B.type===t.type?null:B.child;else if(B.tag===18){if(ie=B.return,ie===null)throw Error(a(341));ie.lanes|=o,Ce=ie.alternate,Ce!==null&&(Ce.lanes|=o),pa(ie,o,t),ie=B.sibling}else ie=B.child;if(ie!==null)ie.return=B;else for(ie=B;ie!==null;){if(ie===t){ie=null;break}if(B=ie.sibling,B!==null){B.return=ie.return,ie=B;break}ie=ie.return}B=ie}$i(e,t,P.children,o),t=t.child}return t;case 9:return P=t.type,d=t.pendingProps.children,xs(t,o),P=un(P),d=d(P),t.flags|=1,$i(e,t,d,o),t.child;case 14:return d=t.type,P=mn(d,t.pendingProps),P=mn(d.type,P),Su(e,t,d,P,o);case 15:return Au(e,t,t.type,t.pendingProps,o);case 17:return d=t.type,P=t.pendingProps,P=t.elementType===d?P:mn(d,P),So(e,t),t.tag=1,Yi(d)?(e=!0,no(t)):e=!1,xs(t,o),mu(t,d,P),Ra(t,d,P,o),Ia(null,t,d,!0,e,o);case 19:return Du(e,t,o);case 22:return Eu(e,t,o)}throw Error(a(156,t.tag))};function rc(e,t){return xe(e,t)}function Jc(e,t,o,d){this.tag=e,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function dn(e,t,o,d){return new Jc(e,t,o,d)}function el(e){return e=e.prototype,!(!e||!e.isReactComponent)}function eh(e){if(typeof e=="function")return el(e)?1:0;if(e!=null){if(e=e.$$typeof,e===ge)return 11;if(e===ue)return 14}return 2}function Gn(e,t){var o=e.alternate;return o===null?(o=dn(e.tag,t,e.key,e.mode),o.elementType=e.elementType,o.type=e.type,o.stateNode=e.stateNode,o.alternate=e,e.alternate=o):(o.pendingProps=t,o.type=e.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=e.flags&14680064,o.childLanes=e.childLanes,o.lanes=e.lanes,o.child=e.child,o.memoizedProps=e.memoizedProps,o.memoizedState=e.memoizedState,o.updateQueue=e.updateQueue,t=e.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},o.sibling=e.sibling,o.index=e.index,o.ref=e.ref,o}function Io(e,t,o,d,P,B){var ie=2;if(d=e,typeof e=="function")el(e)&&(ie=1);else if(typeof e=="string")ie=5;else e:switch(e){case Z:return ss(o.children,P,B,t);case L:ie=8,P|=8;break;case ee:return e=dn(12,o,t,P|2),e.elementType=ee,e.lanes=B,e;case me:return e=dn(13,o,t,P),e.elementType=me,e.lanes=B,e;case Me:return e=dn(19,o,t,P),e.elementType=Me,e.lanes=B,e;case ce:return Oo(o,P,B,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Ee:ie=10;break e;case he:ie=9;break e;case ge:ie=11;break e;case ue:ie=14;break e;case I:ie=16,d=null;break e}throw Error(a(130,e==null?e:typeof e,""))}return t=dn(ie,o,t,P),t.elementType=e,t.type=d,t.lanes=B,t}function ss(e,t,o,d){return e=dn(7,e,d,t),e.lanes=o,e}function Oo(e,t,o,d){return e=dn(22,e,d,t),e.elementType=ce,e.lanes=o,e.stateNode={isHidden:!1},e}function tl(e,t,o){return e=dn(6,e,null,t),e.lanes=o,e}function rl(e,t,o){return t=dn(4,e.children!==null?e.children:[],e.key,t),t.lanes=o,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function th(e,t,o,d,P){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=g(0),this.expirationTimes=g(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=g(0),this.identifierPrefix=d,this.onRecoverableError=P,this.mutableSourceEagerHydrationData=null}function il(e,t,o,d,P,B,ie,Ce,Fe){return e=new th(e,t,o,Ce,Fe),t===1?(t=1,B===!0&&(t|=8)):t=0,B=dn(3,null,null,t),e.current=B,B.stateNode=e,B.memoizedState={element:d,isDehydrated:o,cache:null,transitions:null,pendingSuspenseBoundaries:null},ga(B),e}function rh(e,t,o){var d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:U,key:d==null?null:""+d,children:e,containerInfo:t,implementation:o}}function ic(e){if(!e)return In;e=e._reactInternals;e:{if(Gr(e)!==e||e.tag!==1)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Yi(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(a(171))}if(e.tag===1){var o=e.type;if(Yi(o))return Pl(e,o,t)}return t}function nc(e,t,o,d,P,B,ie,Ce,Fe){return e=il(o,d,!0,e,P,B,ie,Ce,Fe),e.context=ic(null),o=e.current,d=Xi(),P=Bn(o),B=Mn(d,P),B.callback=t??null,Fn(o,B,P),e.current.lanes=P,E(e,P,d),en(e,d),e}function Lo(e,t,o,d){var P=t.current,B=Xi(),ie=Bn(P);return o=ic(o),t.context===null?t.context=o:t.pendingContext=o,t=Mn(B,ie),t.payload={element:e},d=d===void 0?null:d,d!==null&&(t.callback=d),e=Fn(P,t,ie),e!==null&&(yn(e,P,ie,B),fo(e,P,ie)),ie}function Fo(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function sc(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var o=e.retryLane;e.retryLane=o!==0&&o<t?o:t}}function nl(e,t){sc(e,t),(e=e.alternate)&&sc(e,t)}function ih(){return null}var oc=typeof reportError=="function"?reportError:function(e){console.error(e)};function sl(e){this._internalRoot=e}No.prototype.render=sl.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(a(409));Lo(e,t,null,null)},No.prototype.unmount=sl.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;rs(function(){Lo(null,e,null,null)}),t[Sn]=null}};function No(e){this._internalRoot=e}No.prototype.unstable_scheduleHydration=function(e){if(e){var t=W();e={blockedOn:null,target:e,priority:t};for(var o=0;o<Te.length&&t!==0&&t<Te[o].priority;o++);Te.splice(o,0,e),o===0&&tt(e)}};function ol(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Vo(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function ac(){}function nh(e,t,o,d,P){if(P){if(typeof d=="function"){var B=d;d=function(){var Ze=Fo(ie);B.call(Ze)}}var ie=nc(t,d,e,0,null,!1,!1,"",ac);return e._reactRootContainer=ie,e[Sn]=ie.current,Ps(e.nodeType===8?e.parentNode:e),rs(),ie}for(;P=e.lastChild;)e.removeChild(P);if(typeof d=="function"){var Ce=d;d=function(){var Ze=Fo(Fe);Ce.call(Ze)}}var Fe=il(e,0,!1,null,null,!1,!1,"",ac);return e._reactRootContainer=Fe,e[Sn]=Fe.current,Ps(e.nodeType===8?e.parentNode:e),rs(function(){Lo(t,Fe,o,d)}),Fe}function jo(e,t,o,d,P){var B=o._reactRootContainer;if(B){var ie=B;if(typeof P=="function"){var Ce=P;P=function(){var Fe=Fo(ie);Ce.call(Fe)}}Lo(t,ie,e,P)}else ie=nh(o,t,e,P,d);return Fo(ie)}$=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var o=ae(t.pendingLanes);o!==0&&(S(t,o|1),en(t,lt()),(Nr&6)===0&&(As=lt()+500,On()))}break;case 13:rs(function(){var d=Tn(e,1);if(d!==null){var P=Xi();yn(d,e,1,P)}}),nl(e,1)}},G=function(e){if(e.tag===13){var t=Tn(e,134217728);if(t!==null){var o=Xi();yn(t,e,134217728,o)}nl(e,134217728)}},j=function(e){if(e.tag===13){var t=Bn(e),o=Tn(e,t);if(o!==null){var d=Xi();yn(o,e,t,d)}nl(e,t)}},W=function(){return R},H=function(e,t){var o=R;try{return R=e,t()}finally{R=o}},ui=function(e,t,o){switch(t){case"input":if(Ar(e,o),t=o.name,o.type==="radio"&&t!=null){for(o=e;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<o.length;t++){var d=o[t];if(d!==e&&d.form===e.form){var P=ro(d);if(!P)throw Error(a(90));Ft(d),Ar(d,P)}}}break;case"textarea":Di(e,o);break;case"select":t=o.value,t!=null&&fi(e,!!o.multiple,t,!1)}},vi=Ya,bi=rs;var sh={usingClientEntryPoint:!1,Events:[Is,hs,ro,Dr,rr,Ya]},Ks={findFiberByHostInstance:Kn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},oh={bundleType:Ks.bundleType,version:Ks.version,rendererPackageName:Ks.rendererPackageName,rendererConfig:Ks.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:N.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=x(e),e===null?null:e.stateNode},findFiberByHostInstance:Ks.findFiberByHostInstance||ih,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Bo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Bo.isDisabled&&Bo.supportsFiber)try{Er=Bo.inject(oh),Cr=Bo}catch{}}return reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sh,reactDom_production_min.createPortal=function(e,t){var o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ol(t))throw Error(a(200));return rh(e,t,null,o)},reactDom_production_min.createRoot=function(e,t){if(!ol(e))throw Error(a(299));var o=!1,d="",P=oc;return t!=null&&(t.unstable_strictMode===!0&&(o=!0),t.identifierPrefix!==void 0&&(d=t.identifierPrefix),t.onRecoverableError!==void 0&&(P=t.onRecoverableError)),t=il(e,1,!1,null,null,o,!1,d,P),e[Sn]=t.current,Ps(e.nodeType===8?e.parentNode:e),new sl(t)},reactDom_production_min.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(a(188)):(e=Object.keys(e).join(","),Error(a(268,e)));return e=x(t),e=e===null?null:e.stateNode,e},reactDom_production_min.flushSync=function(e){return rs(e)},reactDom_production_min.hydrate=function(e,t,o){if(!Vo(t))throw Error(a(200));return jo(null,e,t,!0,o)},reactDom_production_min.hydrateRoot=function(e,t,o){if(!ol(e))throw Error(a(405));var d=o!=null&&o.hydratedSources||null,P=!1,B="",ie=oc;if(o!=null&&(o.unstable_strictMode===!0&&(P=!0),o.identifierPrefix!==void 0&&(B=o.identifierPrefix),o.onRecoverableError!==void 0&&(ie=o.onRecoverableError)),t=nc(t,null,e,1,o??null,P,!1,B,ie),e[Sn]=t.current,Ps(e),d)for(e=0;e<d.length;e++)o=d[e],P=o._getVersion,P=P(o._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[o,P]:t.mutableSourceEagerHydrationData.push(o,P);return new No(t)},reactDom_production_min.render=function(e,t,o){if(!Vo(t))throw Error(a(200));return jo(null,e,t,!1,o)},reactDom_production_min.unmountComponentAtNode=function(e){if(!Vo(e))throw Error(a(40));return e._reactRootContainer?(rs(function(){jo(null,null,e,!1,function(){e._reactRootContainer=null,e[Sn]=null})}),!0):!1},reactDom_production_min.unstable_batchedUpdates=Ya,reactDom_production_min.unstable_renderSubtreeIntoContainer=function(e,t,o,d){if(!Vo(o))throw Error(a(200));if(e==null||e._reactInternals===void 0)throw Error(a(38));return jo(e,t,o,!1,d)},reactDom_production_min.version="18.3.1-next-f1338f8080-20240426",reactDom_production_min}var hasRequiredReactDom;function requireReactDom(){if(hasRequiredReactDom)return reactDom.exports;hasRequiredReactDom=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(n){console.error(n)}}return r(),reactDom.exports=requireReactDom_production_min(),reactDom.exports}var hasRequiredClient;function requireClient(){if(hasRequiredClient)return client;hasRequiredClient=1;var r=requireReactDom();return client.createRoot=r.createRoot,client.hydrateRoot=r.hydrateRoot,client}var clientExports=requireClient();const corsProxies=[{name:"cors-optimade-science",urlRule:r=>{const n=r.match(/^https?:\/\/(.+)$/);if(!n)throw new Error("Invalid URL for proxy");const[,a]=n;return`https://cors.optimade.science/https/${a}`}},{name:"cors-anywhere",urlRule:r=>`https://cors-anywhere.com/${r}`},{name:"allorigins",urlRule:r=>`https://api.allorigins.win/raw?url=${encodeURIComponent(r)}`}],elements=[{num:1,sym:"H",row:1,col:1,group:"group1"},{num:2,sym:"He",row:1,col:18,group:"group18"},{num:3,sym:"Li",row:2,col:1,group:"group1"},{num:4,sym:"Be",row:2,col:2,group:"group2"},{num:5,sym:"B",row:2,col:13,group:"metalloid"},{num:6,sym:"C",row:2,col:14,group:"mainGroup"},{num:7,sym:"N",row:2,col:15,group:"mainGroup"},{num:8,sym:"O",row:2,col:16,group:"mainGroup"},{num:9,sym:"F",row:2,col:17,group:"group17"},{num:10,sym:"Ne",row:2,col:18,group:"group18"},{num:11,sym:"Na",row:3,col:1,group:"group1"},{num:12,sym:"Mg",row:3,col:2,group:"group2"},{num:13,sym:"Al",row:3,col:13,group:"postTransition"},{num:14,sym:"Si",row:3,col:14,group:"metalloid"},{num:15,sym:"P",row:3,col:15,group:"mainGroup"},{num:16,sym:"S",row:3,col:16,group:"mainGroup"},{num:17,sym:"Cl",row:3,col:17,group:"group17"},{num:18,sym:"Ar",row:3,col:18,group:"group18"},{num:19,sym:"K",row:4,col:1,group:"group1"},{num:20,sym:"Ca",row:4,col:2,group:"group2"},{num:21,sym:"Sc",row:4,col:3,group:"transition"},{num:22,sym:"Ti",row:4,col:4,group:"transition"},{num:23,sym:"V",row:4,col:5,group:"transition"},{num:24,sym:"Cr",row:4,col:6,group:"transition"},{num:25,sym:"Mn",row:4,col:7,group:"transition"},{num:26,sym:"Fe",row:4,col:8,group:"transition"},{num:27,sym:"Co",row:4,col:9,group:"transition"},{num:28,sym:"Ni",row:4,col:10,group:"transition"},{num:29,sym:"Cu",row:4,col:11,group:"transition"},{num:30,sym:"Zn",row:4,col:12,group:"transition"},{num:31,sym:"Ga",row:4,col:13,group:"postTransition"},{num:32,sym:"Ge",row:4,col:14,group:"metalloid"},{num:33,sym:"As",row:4,col:15,group:"metalloid"},{num:34,sym:"Se",row:4,col:16,group:"mainGroup"},{num:35,sym:"Br",row:4,col:17,group:"group17"},{num:36,sym:"Kr",row:4,col:18,group:"group18"},{num:37,sym:"Rb",row:5,col:1,group:"group1"},{num:38,sym:"Sr",row:5,col:2,group:"group2"},{num:39,sym:"Y",row:5,col:3,group:"transition"},{num:40,sym:"Zr",row:5,col:4,group:"transition"},{num:41,sym:"Nb",row:5,col:5,group:"transition"},{num:42,sym:"Mo",row:5,col:6,group:"transition"},{num:43,sym:"Tc",row:5,col:7,group:"transition"},{num:44,sym:"Ru",row:5,col:8,group:"transition"},{num:45,sym:"Rh",row:5,col:9,group:"transition"},{num:46,sym:"Pd",row:5,col:10,group:"transition"},{num:47,sym:"Ag",row:5,col:11,group:"transition"},{num:48,sym:"Cd",row:5,col:12,group:"transition"},{num:49,sym:"In",row:5,col:13,group:"postTransition"},{num:50,sym:"Sn",row:5,col:14,group:"postTransition"},{num:51,sym:"Sb",row:5,col:15,group:"metalloid"},{num:52,sym:"Te",row:5,col:16,group:"metalloid"},{num:53,sym:"I",row:5,col:17,group:"group17"},{num:54,sym:"Xe",row:5,col:18,group:"group18"},{num:55,sym:"Cs",row:6,col:1,group:"group1"},{num:56,sym:"Ba",row:6,col:2,group:"group2"},{num:72,sym:"Hf",row:6,col:4,group:"transition"},{num:73,sym:"Ta",row:6,col:5,group:"transition"},{num:74,sym:"W",row:6,col:6,group:"transition"},{num:75,sym:"Re",row:6,col:7,group:"transition"},{num:76,sym:"Os",row:6,col:8,group:"transition"},{num:77,sym:"Ir",row:6,col:9,group:"transition"},{num:78,sym:"Pt",row:6,col:10,group:"transition"},{num:79,sym:"Au",row:6,col:11,group:"transition"},{num:80,sym:"Hg",row:6,col:12,group:"transition"},{num:81,sym:"Tl",row:6,col:13,group:"postTransition"},{num:82,sym:"Pb",row:6,col:14,group:"postTransition"},{num:83,sym:"Bi",row:6,col:15,group:"postTransition"},{num:84,sym:"Po",row:6,col:16,group:"postTransition"},{num:85,sym:"At",row:6,col:17,group:"group17"},{num:86,sym:"Rn",row:6,col:18,group:"group18"},{num:87,sym:"Fr",row:7,col:1,group:"group1"},{num:88,sym:"Ra",row:7,col:2,group:"group2"},{num:104,sym:"Rf",row:7,col:4,group:"transition"},{num:105,sym:"Db",row:7,col:5,group:"transition"},{num:106,sym:"Sg",row:7,col:6,group:"transition"},{num:107,sym:"Bh",row:7,col:7,group:"transition"},{num:108,sym:"Hs",row:7,col:8,group:"transition"},{num:109,sym:"Mt",row:7,col:9,group:"bg-lime-200"},{num:110,sym:"Ds",row:7,col:10,group:"bg-lime-200"},{num:111,sym:"Rg",row:7,col:11,group:"bg-lime-200"},{num:112,sym:"Cn",row:7,col:12,group:"bg-lime-200"},{num:113,sym:"Nh",row:7,col:13,group:"bg-lime-200"},{num:114,sym:"Fl",row:7,col:14,group:"bg-lime-200"},{num:115,sym:"Mc",row:7,col:15,group:"bg-lime-200"},{num:116,sym:"Lv",row:7,col:16,group:"bg-lime-200"},{num:117,sym:"Ts",row:7,col:17,group:"bg-lime-200"},{num:118,sym:"Og",row:7,col:18,group:"bg-lime-200"},{num:57,sym:"La",row:12,col:3,group:"lanthanide"},{num:58,sym:"Ce",row:12,col:4,group:"lanthanide"},{num:59,sym:"Pr",row:12,col:5,group:"lanthanide"},{num:60,sym:"Nd",row:12,col:6,group:"lanthanide"},{num:61,sym:"Pm",row:12,col:7,group:"lanthanide"},{num:62,sym:"Sm",row:12,col:8,group:"lanthanide"},{num:63,sym:"Eu",row:12,col:9,group:"lanthanide"},{num:64,sym:"Gd",row:12,col:10,group:"lanthanide"},{num:65,sym:"Tb",row:12,col:11,group:"lanthanide"},{num:66,sym:"Dy",row:12,col:12,group:"lanthanide"},{num:67,sym:"Ho",row:12,col:13,group:"lanthanide"},{num:68,sym:"Er",row:12,col:14,group:"lanthanide"},{num:69,sym:"Tm",row:12,col:15,group:"lanthanide"},{num:70,sym:"Yb",row:12,col:16,group:"lanthanide"},{num:71,sym:"Lu",row:12,col:17,group:"lanthanide"},{num:89,sym:"Ac",row:13,col:3,group:"actinide"},{num:90,sym:"Th",row:13,col:4,group:"actinide"},{num:91,sym:"Pa",row:13,col:5,group:"actinide"},{num:92,sym:"U",row:13,col:6,group:"actinide"},{num:93,sym:"Np",row:13,col:7,group:"actinide"},{num:94,sym:"Pu",row:13,col:8,group:"actinide"},{num:95,sym:"Am",row:13,col:9,group:"actinide"},{num:96,sym:"Cm",row:13,col:10,group:"actinide"},{num:97,sym:"Bk",row:13,col:11,group:"actinide"},{num:98,sym:"Cf",row:13,col:12,group:"actinide"},{num:99,sym:"Es",row:13,col:13,group:"actinide"},{num:100,sym:"Fm",row:13,col:14,group:"actinide"},{num:101,sym:"Md",row:13,col:15,group:"actinide"},{num:102,sym:"No",row:13,col:16,group:"actinide"},{num:103,sym:"Lr",row:13,col:17,group:"actinide"}];async function getProvidersList(r="https://raw.githubusercontent.com/Materials-Consortia/providers/refs/heads/master/src/links/v1/providers.json",n=[]){async function a(D){const u=await fetch(D);if(!u.ok)throw new Error(`HTTP error! status: ${u.status}`);return await u.json()}let c;try{c=await a(r)}catch(D){console.warn("Remote fetch failed, falling back to cachedProviders.json:",D);try{c=await a("cachedProviders.json")}catch(u){throw console.error("Both remote and local fetches failed:",u),u}}const p=c.data.filter(D=>!n.includes(D.id));return{...c,data:p}}async function getProviderLinks(r){const n=c=>(c.data||[]).filter(p=>p.attributes?.link_type==="child"),a=[{name:"direct",url:`${r}/v1/links`},...corsProxies.map(c=>({name:c.name,url:c.urlRule(`${r}/v1/links`)}))];for(const{url:c,name:p}of a)try{const D=await fetch(c);if(!D.ok)continue;const u=await D.json();return{children:n(u),error:null}}catch{continue}return{children:[],error:new Error("All fetch attempts failed")}}async function getInfo({providerUrl:r}){const n=[{name:"direct",url:`${r}/v1/info/structures`},...corsProxies.map(a=>({name:a.name,url:a.urlRule(`${r}/v1/info/structures`)}))];for(const{url:a,name:c}of n)try{const p=await fetch(a);if(!p.ok)continue;const D=await p.json();return{customProps:Object.fromEntries(Object.entries(D.data.properties||{}).filter(([v])=>v.startsWith("_"))),error:null}}catch{continue}return{customProps:{},error:new Error("All fetch attempts failed")}}async function getStructures({providerUrl:r,filter:n="",page:a=1,pageSize:c=20}){if(!r)throw new Error("Provider URL is required");const p=(a-1)*c,D=n?`?filter=${encodeURIComponent(n)}&page_offset=${p}`:`?page_offset=${p}`,u=[{name:"direct",url:`${r}/v1/structures${D}`},...corsProxies.map(v=>({name:v.name,url:v.urlRule(`${r}/v1/structures${D}`)}))];for(const{url:v,name:m}of u)try{const _=await fetch(v);if(!_.ok)continue;return await _.json()}catch{continue}throw new Error("All fetch attempts failed for getStructures")}function OptimadeHeader(){return jsxRuntimeExports.jsx("div",{className:"flex justify-center",children:jsxRuntimeExports.jsx("img",{src:"/optimade_logo-min.png",alt:"OptimadeLogo",className:"h-18 sm:h-24 md:h-32 w-auto object-contain"})})}var lodash_debounce,hasRequiredLodash_debounce;function requireLodash_debounce(){if(hasRequiredLodash_debounce)return lodash_debounce;hasRequiredLodash_debounce=1;var r="Expected a function",n=NaN,a="[object Symbol]",c=/^\s+|\s+$/g,p=/^[-+]0x[0-9a-f]+$/i,D=/^0b[01]+$/i,u=/^0o[0-7]+$/i,v=parseInt,m=typeof commonjsGlobal=="object"&&commonjsGlobal&&commonjsGlobal.Object===Object&&commonjsGlobal,_=typeof self=="object"&&self&&self.Object===Object&&self,C=m||_||Function("return this")(),w=Object.prototype,k=w.toString,F=Math.max,T=Math.min,z=function(){return C.Date.now()};function Q(V,U,Z){var L,ee,Ee,he,ge,me,Me=0,ue=!1,I=!1,ce=!0;if(typeof V!="function")throw new TypeError(r);U=N(U)||0,J(Z)&&(ue=!!Z.leading,I="maxWait"in Z,Ee=I?F(N(Z.maxWait)||0,U):Ee,ce="trailing"in Z?!!Z.trailing:ce);function se(Ue){var Ie=L,rt=ee;return L=ee=void 0,Me=Ue,he=V.apply(rt,Ie),he}function X(Ue){return Me=Ue,ge=setTimeout(De,U),ue?se(Ue):he}function Re(Ue){var Ie=Ue-me,rt=Ue-Me,st=U-Ie;return I?T(st,Ee-rt):st}function fe(Ue){var Ie=Ue-me,rt=Ue-Me;return me===void 0||Ie>=U||Ie<0||I&&rt>=Ee}function De(){var Ue=z();if(fe(Ue))return We(Ue);ge=setTimeout(De,Re(Ue))}function We(Ue){return ge=void 0,ce&&L?se(Ue):(L=ee=void 0,he)}function oe(){ge!==void 0&&clearTimeout(ge),Me=0,L=me=ee=ge=void 0}function Ae(){return ge===void 0?he:We(z())}function He(){var Ue=z(),Ie=fe(Ue);if(L=arguments,ee=this,me=Ue,Ie){if(ge===void 0)return X(me);if(I)return ge=setTimeout(De,U),se(me)}return ge===void 0&&(ge=setTimeout(De,U)),he}return He.cancel=oe,He.flush=Ae,He}function J(V){var U=typeof V;return!!V&&(U=="object"||U=="function")}function K(V){return!!V&&typeof V=="object"}function b(V){return typeof V=="symbol"||K(V)&&k.call(V)==a}function N(V){if(typeof V=="number")return V;if(b(V))return n;if(J(V)){var U=typeof V.valueOf=="function"?V.valueOf():V;V=J(U)?U+"":U}if(typeof V!="string")return V===0?V:+V;V=V.replace(c,"");var Z=D.test(V);return Z||u.test(V)?v(V.slice(2),Z?2:8):p.test(V)?n:+V}return lodash_debounce=Q,lodash_debounce}var lodash_debounceExports=requireLodash_debounce();const debounce=getDefaultExportFromCjs(lodash_debounceExports),slateDropdown=`min-w-[325]
  w-full border-2 border-slate-300
  bg-slate-200 py-1 px-3 rounded shadow hover:cursor-pointer
  hover:bg-slate-300 disabled:cursor-not-allowed
  disabled:bg-gray-100 text-sm md:text-base
`;function DatabaseSelector({providers:r,onQueryUrlChange:n,onChildChange:a,onProviderChange:c}){const[p,D]=reactExports.useState(""),[u,v]=reactExports.useState([]),[m,_]=reactExports.useState(null),[C,w]=reactExports.useState(""),[k,F]=reactExports.useState(!1),T=debounce(z=>w(z),700);return reactExports.useEffect(()=>{if(!p){v([]),_(null),n(""),a?.(null);return}if(p==="__custom__"){v([]),_(null),n(C||""),a?.(null);return}async function z(){try{F(!0);const{children:Q}=await getProviderLinks(p),J=Q.map(K=>({id:K.id,...K.attributes??{}}));v(J),J.length===1?(_(J[0]),n(J[0].base_url),a?.(J[0])):(_(null),n(""),a?.(null))}catch(Q){console.error(Q),v([]),_(null),n(""),a?.(null)}finally{F(!1)}}z()},[p]),reactExports.useEffect(()=>{p==="__custom__"?(n(C||""),a?.(null)):m&&(n(m.base_url),a?.(m))},[C,m,p]),reactExports.useEffect(()=>{if(p==="__custom__"||!p)c?.(null);else{const z=r.find(Q=>Q.attributes?.base_url===p);c?.(z||null)}},[p,r,c]),jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-start space-y-2 max-w-md",children:[jsxRuntimeExports.jsxs("select",{className:slateDropdown,value:p,onChange:z=>D(z.target.value),children:[jsxRuntimeExports.jsx("option",{value:"",disabled:!0,children:"Select a provider"}),r.map(z=>jsxRuntimeExports.jsx("option",{value:z.attributes?.base_url||"",children:`${z.id}: ${z.attributes?.name}`},z.attributes?.id??z.id??z.attributes?.base_url)),jsxRuntimeExports.jsx("option",{value:"__custom__",children:"Custom endpoint"})]}),p==="__custom__"?jsxRuntimeExports.jsx("input",{type:"text",placeholder:"Enter custom URL",className:"w-[calc(100%-4px)] mx-auto ring-[1px] ring-slate-300 rounded-sm px-2 py-1",onChange:z=>T(z.target.value)}):jsxRuntimeExports.jsx("select",{className:slateDropdown,value:m?.id||"",onChange:z=>{const Q=u.find(J=>J.id===z.target.value);_(Q||null)},disabled:k,children:k?jsxRuntimeExports.jsx("option",{children:"Loading"}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("option",{value:"",disabled:!0,children:"Select a subdatabase"}),u.map(z=>jsxRuntimeExports.jsx("option",{value:z.id,children:`${z.id}: ${z.name}`},z.id))]})})]})}function HelpIcon({popover:r,size:n=24,color:a="currentColor",strokeWidthBorder:c=2,strokeWidth:p=2.5,placement:D="top",popoutBgColor:u="bg-gray-800",popoutTextColor:v="text-white",popoutStyleOverrides:m=""}){let _="";switch(D){case"top":_="bottom-full left-1/2 transform -translate-x-1/2 mb-2";break;case"bottom":_="top-full left-1/2 transform -translate-x-1/2 mt-2";break;case"left":_="right-full top-1/2 transform -translate-y-1/2 mr-2";break;case"right":_="left-full top-1/2 transform -translate-y-1/2 ml-2";break;default:_="bottom-full left-1/2 transform -translate-x-1/2 mb-2"}return jsxRuntimeExports.jsxs("span",{className:"relative inline-block group",children:[jsxRuntimeExports.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:a,strokeWidth:c,strokeLinecap:"round",strokeLinejoin:"round",children:[jsxRuntimeExports.jsx("circle",{cx:"12",cy:"12",r:"10"}),jsxRuntimeExports.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",strokeWidth:p}),jsxRuntimeExports.jsx("path",{d:"M12 17h.01",strokeWidth:p})]}),r&&jsxRuntimeExports.jsx("span",{className:`absolute ${_} w-max max-w-xs rounded-sm ${u} ${v} text-xs p-1
          text-center opacity-0 group-hover:opacity-100 transition-opacity z-50 pointer-events-none ${m}`,children:r})]})}const defaultColors={group1:"bg-[#d7bbbb]",group2:"bg-[#d7cdbb]",group17:"bg-[#d7d9c2]",group18:"bg-[#d0d5ee]",transition:"bg-[#c4d0d8]",lanthanide:"bg-[#e5cbee]",actinide:"bg-[#aebcee]",metalloid:"bg-[#cdd9c2]",postTransition:"bg-[#c2c8d9]",mainGroup:"bg-[#d9c2ce]",default:"bg-gray-200"};function PTable({providerUrl:r=null,selected:n={},onSelectionChange:a,colors:c=defaultColors,selectedClassName:p="bg-green-400 border border-green-700 text-white scale-105",deselectedClassName:D="bg-red-400 border border-red-700 text-white scale-105",defaultBorderClassName:u="border border-slate-700",hoverClassName:v="transform transition-transform duration-100 hover:scale-105 hover:z-10 hover:cursor-pointer"}){const[m,_]=reactExports.useState(elements),[C,w]=reactExports.useState(null),[k,F]=reactExports.useState(null);reactExports.useEffect(()=>{(async()=>{try{const J=await fetch("./cachedPTable.json");if(!J.ok)throw new Error("Failed to load cached PTable");const K=J.headers.get("last-modified");if(K){const V=new Date(K).toLocaleDateString();F(V)}const b=await J.json(),N={};b.forEach(V=>{N[V.providerUrl]=V.ptable}),w(N)}catch(J){console.error("Failed to load cached PTable:",J)}})()},[]),reactExports.useEffect(()=>{if(!r||!C)return;const Q=C[r]||{},J=elements.map(K=>({...K,present:K.sym in Q?Q[K.sym]:void 0}));_(J)},[r,C]);const T=Q=>{if(!a)return;const J=((n[Q]??0)+1)%3;a({[Q]:J})},z=Q=>{const J=n[Q.sym]??0,K=c[Q.group]??c.default;if(J===1)return p;if(J===2)return D;const b=Q.present===!1?"opacity-30":"";return`${K} ${u} ${b}`};return jsxRuntimeExports.jsx("div",{className:"w-full max-w-full mx-auto px-0 md:px-2",children:jsxRuntimeExports.jsxs("div",{className:"@container",children:[jsxRuntimeExports.jsx("div",{className:"flex justify-end pb-2 pr-1.5",children:jsxRuntimeExports.jsx(HelpIcon,{popover:`All OPTIMADE provider databases have been prefiltered, with unavailable structures greyed out. Last updated: ${k}.`,placement:"left",color:"rgb(40,40,40)"})}),jsxRuntimeExports.jsx("div",{className:"grid @gap-0.5 @sm:gap-1 w-full",style:{gridTemplateColumns:"repeat(18, minmax(0, 1fr))"},children:m.map(Q=>jsxRuntimeExports.jsx("div",{style:{gridColumn:Q.col,gridRow:Q.row},className:"relative w-full",children:jsxRuntimeExports.jsx("div",{className:"w-full aspect-square",children:jsxRuntimeExports.jsxs("button",{onClick:()=>T(Q.sym),className:`flex flex-col justify-center items-center w-full h-full rounded-sm ${v} ${z(Q)}`,children:[jsxRuntimeExports.jsx("span",{className:"text-[0px] opacity-0 @sm:text-[0.3rem] @sm:opacity-100 @md:text-[0.5rem] @lg:text-[0.7rem] text-gray-700 leading-tight",children:Q.num}),jsxRuntimeExports.jsx("span",{className:"text-[0.55rem] font-medium leading-none",style:{fontSize:"clamp(0.55rem, 2.5vw, 1.25rem)"},children:Q.sym})]})})},Q.sym))})]})})}const textNormal=" text-sm md:text-base",textLarge=" text-base md:text-lg",textHyperlink=" text-blue-500 hover:underline hover:text-blue-600",textSmall=" text-xs md:text-sm",textTiny=" text-[13px] md:text-[13px]",textError=" text-center text-red-500",baseButtonStyle=`px-2 py-1 md:px-3 md:py-1.5 rounded
 bg-blue-600 text-white 
 hover:bg-blue-700 hover:cursor-pointer
`,baseContainer="w-full border border-slate-500 rounded-sm bg-slate-50 shadow-sm ",containerStyle=baseContainer+" p-2",containerStyleDropdown=baseContainer+" overflow-hidden text-[11px] md:text-[13px]",containerStyleHalf=baseContainer+` p-2 md:w-1/2  min-h-48 md:h-[450px] h-[200px] text-[11px] md:text-[13px]
   overflow-auto`,warningContainerStyle="w-full rounded-sm bg-yellow-100 border border-yellow-400 text-yellow-800 p-3 text-center";function QueryTextBox({value:r,onChange:n,placeholder:a="Enter OPTIMADE filter",onSubmit:c,loading:p=!1}){return jsxRuntimeExports.jsx("div",{className:textNormal,children:jsxRuntimeExports.jsxs("form",{onSubmit:D=>{D.preventDefault(),c?.()},className:"flex gap-2",children:[jsxRuntimeExports.jsx("input",{type:"text",value:r,onChange:D=>n(D.target.value),placeholder:a,className:`${containerStyle} border-gray-300! bg-white focus:outline-none focus:ring-1 focus:ring-blue-500 `}),jsxRuntimeExports.jsx("button",{type:"submit",disabled:p,className:`${baseButtonStyle} disabled:opacity-50`,children:p?"Loading":"Submit"})]})})}var lib={},Range={},utils={},types={},hasRequiredTypes;function requireTypes(){if(hasRequiredTypes)return types;hasRequiredTypes=1,Object.defineProperty(types,"__esModule",{value:!0}),types.Direction=void 0;var r;return(function(n){n.Right="to right",n.Left="to left",n.Down="to bottom",n.Up="to top"})(r||(types.Direction=r={})),types}var hasRequiredUtils;function requireUtils(){return hasRequiredUtils||(hasRequiredUtils=1,(function(r){var n=utils&&utils.__spreadArray||function(ge,me,Me){if(Me||arguments.length===2)for(var ue=0,I=me.length,ce;ue<I;ue++)(ce||!(ue in me))&&(ce||(ce=Array.prototype.slice.call(me,0,ue)),ce[ue]=me[ue]);return ge.concat(ce||Array.prototype.slice.call(me))};Object.defineProperty(r,"__esModule",{value:!0}),r.isIOS=r.useThumbOverlap=r.assertUnreachable=r.voidFn=r.getTrackBackground=r.replaceAt=r.schd=r.translate=r.getClosestThumbIndex=r.translateThumbs=r.getPaddingAndBorder=r.getMargin=r.checkInitialOverlap=r.checkValuesAgainstBoundaries=r.checkBoundaries=r.isVertical=r.relativeValue=r.normalizeValue=r.isStepDivisible=r.isTouchEvent=r.getStepDecimals=void 0;var a=requireReact(),c=requireTypes(),p=function(ge){var me=ge.toString().split(".")[1];return me?me.length:0};r.getStepDecimals=p;function D(ge){return ge.touches&&ge.touches.length||ge.changedTouches&&ge.changedTouches.length}r.isTouchEvent=D;function u(ge,me,Me){var ue=(me-ge)/Me,I=8,ce=Number(ue.toFixed(I));return parseInt(ce.toString(),10)===ce}r.isStepDivisible=u;function v(ge,me,Me,ue,I,ce,se){var X=1e11;if(ge=Math.round(ge*X)/X,!ce){var Re=se[me-1],fe=se[me+1];if(Re&&Re>ge)return Re;if(fe&&fe<ge)return fe}if(ge>ue)return ue;if(ge<Me)return Me;var De=Math.floor(ge*X-Me*X)%Math.floor(I*X),We=Math.floor(ge*X-Math.abs(De)),oe=De===0?ge:We/X,Ae=Math.abs(De/X)<I/2?oe:oe+I,He=(0,r.getStepDecimals)(I);return parseFloat(Ae.toFixed(He))}r.normalizeValue=v;function m(ge,me,Me){return(ge-me)/(Me-me)}r.relativeValue=m;function _(ge){return ge===c.Direction.Up||ge===c.Direction.Down}r.isVertical=_;function C(ge,me,Me){if(me>=Me)throw new RangeError("min (".concat(me,") is equal/bigger than max (").concat(Me,")"));if(ge<me)throw new RangeError("value (".concat(ge,") is smaller than min (").concat(me,")"));if(ge>Me)throw new RangeError("value (".concat(ge,") is bigger than max (").concat(Me,")"))}r.checkBoundaries=C;function w(ge,me,Me){return ge<me?me:ge>Me?Me:ge}r.checkValuesAgainstBoundaries=w;function k(ge){if(!(ge.length<2)&&!ge.slice(1).every(function(me,Me){return ge[Me]<=me}))throw new RangeError("values={[".concat(ge,"]} needs to be sorted when allowOverlap={false}"))}r.checkInitialOverlap=k;function F(ge){var me=window.getComputedStyle(ge);return{top:parseInt(me["margin-top"],10),bottom:parseInt(me["margin-bottom"],10),left:parseInt(me["margin-left"],10),right:parseInt(me["margin-right"],10)}}r.getMargin=F;function T(ge){var me=window.getComputedStyle(ge);return{top:parseInt(me["padding-top"],10)+parseInt(me["border-top-width"],10),bottom:parseInt(me["padding-bottom"],10)+parseInt(me["border-bottom-width"],10),left:parseInt(me["padding-left"],10)+parseInt(me["border-left-width"],10),right:parseInt(me["padding-right"],10)+parseInt(me["border-right-width"],10)}}r.getPaddingAndBorder=T;function z(ge,me,Me){var ue=Me?-1:1;ge.forEach(function(I,ce){return J(I,ue*me[ce].x,me[ce].y)})}r.translateThumbs=z;function Q(ge,me,Me,ue){for(var I=0,ce=Ee(ge[0],me,Me,ue),se=1;se<ge.length;se++){var X=Ee(ge[se],me,Me,ue);X<ce&&(ce=X,I=se)}return I}r.getClosestThumbIndex=Q;function J(ge,me,Me){ge.style.transform="translate(".concat(me,"px, ").concat(Me,"px)")}r.translate=J;var K=function(ge){var me=[],Me=null,ue=function(){for(var I=[],ce=0;ce<arguments.length;ce++)I[ce]=arguments[ce];me=I,!Me&&(Me=requestAnimationFrame(function(){Me=null,ge.apply(void 0,me)}))};return ue};r.schd=K;function b(ge,me,Me){var ue=ge.slice(0);return ue[me]=Me,ue}r.replaceAt=b;function N(ge){var me=ge.values,Me=ge.colors,ue=ge.min,I=ge.max,ce=ge.direction,se=ce===void 0?c.Direction.Right:ce,X=ge.rtl,Re=X===void 0?!1:X;Re&&se===c.Direction.Right?se=c.Direction.Left:Re&&c.Direction.Left&&(se=c.Direction.Right);var fe=me.slice(0).sort(function(We,oe){return We-oe}).map(function(We){return(We-ue)/(I-ue)*100}),De=fe.reduce(function(We,oe,Ae){return"".concat(We,", ").concat(Me[Ae]," ").concat(oe,"%, ").concat(Me[Ae+1]," ").concat(oe,"%")},"");return"linear-gradient(".concat(se,", ").concat(Me[0]," 0%").concat(De,", ").concat(Me[Me.length-1]," 100%)")}r.getTrackBackground=N;function V(){}r.voidFn=V;function U(ge){throw new Error("Didn't expect to get here")}r.assertUnreachable=U;var Z=function(ge,me,Me,ue,I){I===void 0&&(I=function(se){return se});var ce=Math.ceil(n([ge],Array.from(ge.children),!0).reduce(function(se,X){var Re=Math.ceil(X.getBoundingClientRect().width);if(X.innerText&&X.innerText.includes(Me)&&X.childElementCount===0){var fe=X.cloneNode(!0);fe.innerHTML=I(me.toFixed(ue)),fe.style.visibility="hidden",document.body.appendChild(fe),Re=Math.ceil(fe.getBoundingClientRect().width),document.body.removeChild(fe)}return Re>se?Re:se},ge.getBoundingClientRect().width));return ce},L=function(ge,me,Me,ue,I,ce,se){se===void 0&&(se=function(fe){return fe});var X=[],Re=function(fe){var De=Z(Me[fe],ue[fe],I,ce,se),We=me[fe].x;me.forEach(function(oe,Ae){var He=oe.x,Ue=Z(Me[Ae],ue[Ae],I,ce,se);fe!==Ae&&(We>=He&&We<=He+Ue||We+De>=He&&We+De<=He+Ue)&&(X.includes(Ae)||(X.push(fe),X.push(Ae),X=n(n([],X,!0),[fe,Ae],!1),Re(Ae)))})};return Re(ge),Array.from(new Set(X.sort()))},ee=function(ge,me,Me,ue,I,ce){ue===void 0&&(ue=.1),I===void 0&&(I=" - "),ce===void 0&&(ce=function(Ae){return Ae});var se=(0,r.getStepDecimals)(ue),X=(0,a.useState)({}),Re=X[0],fe=X[1],De=(0,a.useState)(ce(me[Me].toFixed(se))),We=De[0],oe=De[1];return(0,a.useEffect)(function(){if(ge){var Ae=ge.getThumbs();if(Ae.length<1)return;var He={},Ue=ge.getOffsets(),Ie=L(Me,Ue,Ae,me,I,se,ce),rt=ce(me[Me].toFixed(se));if(Ie.length){var st=Ie.reduce(function(ar,kr,Ar,pr){return ar.length?n(n([],ar,!0),[Ue[pr[Ar]].x],!1):[Ue[pr[Ar]].x]},[]);if(Math.min.apply(Math,st)===Ue[Me].x){var at=[];Ie.forEach(function(ar){at.push(me[ar].toFixed(se))}),rt=Array.from(new Set(at.sort(function(ar,kr){return parseFloat(ar)-parseFloat(kr)}))).map(ce).join(I);var Ft=Math.min.apply(Math,st),Et=Math.max.apply(Math,st),or=Ae[Ie[st.indexOf(Et)]].getBoundingClientRect().width;He.left="".concat(Math.abs(Ft-(Et+or))/2,"px"),He.transform="translate(-50%, 0)"}else He.visibility="hidden"}oe(rt),fe(He)}},[ge,me]),[We,Re]};r.useThumbOverlap=ee;function Ee(ge,me,Me,ue){var I=ge.getBoundingClientRect(),ce=I.left,se=I.top,X=I.width,Re=I.height;return _(ue)?Math.abs(Me-(se+Re/2)):Math.abs(me-(ce+X/2))}var he=function(){var ge,me=((ge=navigator.userAgentData)===null||ge===void 0?void 0:ge.platform)||navigator.platform;return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(me)||navigator.userAgent.includes("Mac")&&"ontouchend"in document};r.isIOS=he})(utils)),utils}var hasRequiredRange;function requireRange(){if(hasRequiredRange)return Range;hasRequiredRange=1;var r=Range&&Range.__extends||(function(){var w=function(k,F){return w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(T,z){T.__proto__=z}||function(T,z){for(var Q in z)Object.prototype.hasOwnProperty.call(z,Q)&&(T[Q]=z[Q])},w(k,F)};return function(k,F){if(typeof F!="function"&&F!==null)throw new TypeError("Class extends value "+String(F)+" is not a constructor or null");w(k,F);function T(){this.constructor=k}k.prototype=F===null?Object.create(F):(T.prototype=F.prototype,new T)}})(),n=Range&&Range.__createBinding||(Object.create?(function(w,k,F,T){T===void 0&&(T=F);var z=Object.getOwnPropertyDescriptor(k,F);(!z||("get"in z?!k.__esModule:z.writable||z.configurable))&&(z={enumerable:!0,get:function(){return k[F]}}),Object.defineProperty(w,T,z)}):(function(w,k,F,T){T===void 0&&(T=F),w[T]=k[F]})),a=Range&&Range.__setModuleDefault||(Object.create?(function(w,k){Object.defineProperty(w,"default",{enumerable:!0,value:k})}):function(w,k){w.default=k}),c=Range&&Range.__importStar||function(w){if(w&&w.__esModule)return w;var k={};if(w!=null)for(var F in w)F!=="default"&&Object.prototype.hasOwnProperty.call(w,F)&&n(k,w,F);return a(k,w),k},p=Range&&Range.__spreadArray||function(w,k,F){if(F||arguments.length===2)for(var T=0,z=k.length,Q;T<z;T++)(Q||!(T in k))&&(Q||(Q=Array.prototype.slice.call(k,0,T)),Q[T]=k[T]);return w.concat(Q||Array.prototype.slice.call(k))};Object.defineProperty(Range,"__esModule",{value:!0});var D=c(requireReact()),u=requireUtils(),v=requireTypes(),m=["ArrowRight","ArrowUp","k","PageUp"],_=["ArrowLeft","ArrowDown","j","PageDown"],C=(function(w){r(k,w);function k(F){var T=w.call(this,F)||this;if(T.trackRef=D.createRef(),T.thumbRefs=[],T.state={draggedTrackPos:[-1,-1],draggedThumbIndex:-1,thumbZIndexes:new Array(T.props.values.length).fill(0).map(function(z,Q){return Q}),isChanged:!1,markOffsets:[]},T.getOffsets=function(){var z=T.props,Q=z.direction,J=z.values,K=z.min,b=z.max,N=T.trackRef.current;if(!N)return console.warn("No track element found."),[];var V=N.getBoundingClientRect(),U=(0,u.getPaddingAndBorder)(N);return T.getThumbs().map(function(Z,L){var ee={x:0,y:0},Ee=Z.getBoundingClientRect(),he=(0,u.getMargin)(Z);switch(Q){case v.Direction.Right:return ee.x=(he.left+U.left)*-1,ee.y=((Ee.height-V.height)/2+U.top)*-1,ee.x+=V.width*(0,u.relativeValue)(J[L],K,b)-Ee.width/2,ee;case v.Direction.Left:return ee.x=(he.right+U.right)*-1,ee.y=((Ee.height-V.height)/2+U.top)*-1,ee.x+=V.width-V.width*(0,u.relativeValue)(J[L],K,b)-Ee.width/2,ee;case v.Direction.Up:return ee.x=((Ee.width-V.width)/2+he.left+U.left)*-1,ee.y=-U.left,ee.y+=V.height-V.height*(0,u.relativeValue)(J[L],K,b)-Ee.height/2,ee;case v.Direction.Down:return ee.x=((Ee.width-V.width)/2+he.left+U.left)*-1,ee.y=-U.left,ee.y+=V.height*(0,u.relativeValue)(J[L],K,b)-Ee.height/2,ee;default:return(0,u.assertUnreachable)(Q)}})},T.getThumbs=function(){return T.trackRef&&T.trackRef.current?Array.from(T.trackRef.current.children).filter(function(z){return z.hasAttribute("aria-valuenow")}):(console.warn("No thumbs found in the track container. Did you forget to pass & spread the `props` param in renderTrack?"),[])},T.getTargetIndex=function(z){return T.getThumbs().findIndex(function(Q){return Q===z.target||Q.contains(z.target)})},T.addTouchEvents=function(z){document.addEventListener("touchmove",T.schdOnTouchMove,{passive:!1}),document.addEventListener("touchend",T.schdOnEnd,{passive:!1}),document.addEventListener("touchcancel",T.schdOnEnd,{passive:!1})},T.addMouseEvents=function(z){document.addEventListener("mousemove",T.schdOnMouseMove),document.addEventListener("mouseup",T.schdOnEnd)},T.onMouseDownTrack=function(z){var Q;if(!(z.button!==0||(0,u.isIOS)()))if(z.persist(),z.preventDefault(),T.addMouseEvents(z.nativeEvent),T.props.values.length>1&&T.props.draggableTrack){if(T.thumbRefs.some(function(K){var b;return(b=K.current)===null||b===void 0?void 0:b.contains(z.target)}))return;T.setState({draggedTrackPos:[z.clientX,z.clientY]},function(){return T.onMove(z.clientX,z.clientY)})}else{var J=(0,u.getClosestThumbIndex)(T.thumbRefs.map(function(K){return K.current}),z.clientX,z.clientY,T.props.direction);(Q=T.thumbRefs[J].current)===null||Q===void 0||Q.focus(),T.setState({draggedThumbIndex:J},function(){return T.onMove(z.clientX,z.clientY)})}},T.onResize=function(){(0,u.translateThumbs)(T.getThumbs(),T.getOffsets(),T.props.rtl),T.calculateMarkOffsets()},T.onTouchStartTrack=function(z){var Q;if(z.persist(),T.addTouchEvents(z.nativeEvent),T.props.values.length>1&&T.props.draggableTrack){if(T.thumbRefs.some(function(K){var b;return(b=K.current)===null||b===void 0?void 0:b.contains(z.target)}))return;T.setState({draggedTrackPos:[z.touches[0].clientX,z.touches[0].clientY]},function(){return T.onMove(z.touches[0].clientX,z.touches[0].clientY)})}else{var J=(0,u.getClosestThumbIndex)(T.thumbRefs.map(function(K){return K.current}),z.touches[0].clientX,z.touches[0].clientY,T.props.direction);(Q=T.thumbRefs[J].current)===null||Q===void 0||Q.focus(),T.setState({draggedThumbIndex:J},function(){return T.onMove(z.touches[0].clientX,z.touches[0].clientY)})}},T.onMouseOrTouchStart=function(z){if(!T.props.disabled){var Q=(0,u.isTouchEvent)(z);if(!(!Q&&z.button!==0)){var J=T.getTargetIndex(z);J!==-1&&(Q?T.addTouchEvents(z):T.addMouseEvents(z),T.setState({draggedThumbIndex:J,thumbZIndexes:T.state.thumbZIndexes.map(function(K,b){return b===J?Math.max.apply(Math,T.state.thumbZIndexes):K<=T.state.thumbZIndexes[J]?K:K-1})}))}}},T.onMouseMove=function(z){z.preventDefault(),T.onMove(z.clientX,z.clientY)},T.onTouchMove=function(z){z.preventDefault(),T.onMove(z.touches[0].clientX,z.touches[0].clientY)},T.onKeyDown=function(z){var Q=T.props,J=Q.values,K=Q.onChange,b=Q.step,N=Q.rtl,V=Q.direction,U=T.state.isChanged,Z=T.getTargetIndex(z.nativeEvent),L=N||V===v.Direction.Left||V===v.Direction.Down?-1:1;Z!==-1&&(m.includes(z.key)?(z.preventDefault(),T.setState({draggedThumbIndex:Z,isChanged:!0}),K((0,u.replaceAt)(J,Z,T.normalizeValue(J[Z]+L*(z.key==="PageUp"?b*10:b),Z)))):_.includes(z.key)?(z.preventDefault(),T.setState({draggedThumbIndex:Z,isChanged:!0}),K((0,u.replaceAt)(J,Z,T.normalizeValue(J[Z]-L*(z.key==="PageDown"?b*10:b),Z)))):z.key==="Tab"?T.setState({draggedThumbIndex:-1},function(){U&&T.fireOnFinalChange()}):U&&T.fireOnFinalChange())},T.onKeyUp=function(z){var Q=T.state.isChanged;T.setState({draggedThumbIndex:-1},function(){Q&&T.fireOnFinalChange()})},T.onMove=function(z,Q){var J=T.state,K=J.draggedThumbIndex,b=J.draggedTrackPos,N=T.props,V=N.direction,U=N.min,Z=N.max,L=N.onChange,ee=N.values,Ee=N.step,he=N.rtl;if(K===-1&&b[0]===-1&&b[1]===-1)return null;var ge=T.trackRef.current;if(!ge)return null;var me=ge.getBoundingClientRect(),Me=(0,u.isVertical)(V)?me.height:me.width;if(b[0]!==-1&&b[1]!==-1){var ue=z-b[0],I=Q-b[1],ce=0;switch(V){case v.Direction.Right:case v.Direction.Left:ce=ue/Me*(Z-U);break;case v.Direction.Down:case v.Direction.Up:ce=I/Me*(Z-U);break;default:(0,u.assertUnreachable)(V)}if(he&&(ce*=-1),Math.abs(ce)>=Ee/2){for(var se=0;se<T.thumbRefs.length;se++){if(ee[se]===Z&&Math.sign(ce)===1||ee[se]===U&&Math.sign(ce)===-1)return;var X=ee[se]+ce;X>Z?ce=Z-ee[se]:X<U&&(ce=U-ee[se])}for(var Re=ee.slice(0),se=0;se<T.thumbRefs.length;se++)Re=(0,u.replaceAt)(Re,se,T.normalizeValue(ee[se]+ce,se));T.setState({draggedTrackPos:[z,Q]}),L(Re)}}else{var fe=0;switch(V){case v.Direction.Right:fe=(z-me.left)/Me*(Z-U)+U;break;case v.Direction.Left:fe=(Me-(z-me.left))/Me*(Z-U)+U;break;case v.Direction.Down:fe=(Q-me.top)/Me*(Z-U)+U;break;case v.Direction.Up:fe=(Me-(Q-me.top))/Me*(Z-U)+U;break;default:(0,u.assertUnreachable)(V)}he&&(fe=Z+U-fe),Math.abs(ee[K]-fe)>=Ee/2&&L((0,u.replaceAt)(ee,K,T.normalizeValue(fe,K)))}},T.normalizeValue=function(z,Q){var J=T.props,K=J.min,b=J.max,N=J.step,V=J.allowOverlap,U=J.values;return(0,u.normalizeValue)(z,Q,K,b,N,V,U)},T.onEnd=function(z){if(z.preventDefault(),document.removeEventListener("mousemove",T.schdOnMouseMove),document.removeEventListener("touchmove",T.schdOnTouchMove),document.removeEventListener("mouseup",T.schdOnEnd),document.removeEventListener("touchend",T.schdOnEnd),document.removeEventListener("touchcancel",T.schdOnEnd),T.state.draggedThumbIndex===-1&&T.state.draggedTrackPos[0]===-1&&T.state.draggedTrackPos[1]===-1)return null;T.setState({draggedThumbIndex:-1,draggedTrackPos:[-1,-1]},function(){T.fireOnFinalChange()})},T.fireOnFinalChange=function(){T.setState({isChanged:!1});var z=T.props,Q=z.onFinalChange,J=z.values;Q&&Q(J)},T.updateMarkRefs=function(z){if(!z.renderMark){T.numOfMarks=void 0,T.markRefs=void 0;return}T.numOfMarks=(z.max-z.min)/T.props.step,T.markRefs=[];for(var Q=0;Q<T.numOfMarks+1;Q++)T.markRefs[Q]=D.createRef()},T.calculateMarkOffsets=function(){if(!(!T.props.renderMark||!T.trackRef||!T.numOfMarks||!T.markRefs||T.trackRef.current===null)){for(var z=window.getComputedStyle(T.trackRef.current),Q=parseInt(z.width,10),J=parseInt(z.height,10),K=parseInt(z.paddingLeft,10),b=parseInt(z.paddingTop,10),N=[],V=0;V<T.numOfMarks+1;V++){var U=9999,Z=9999;if(T.markRefs[V].current){var L=T.markRefs[V].current.getBoundingClientRect();U=L.height,Z=L.width}T.props.direction===v.Direction.Left||T.props.direction===v.Direction.Right?N.push([Math.round(Q/T.numOfMarks*V+K-Z/2),-Math.round((U-J)/2)]):N.push([Math.round(J/T.numOfMarks*V+b-U/2),-Math.round((Z-Q)/2)])}T.setState({markOffsets:N})}},F.step===0)throw new Error('"step" property should be a positive number');return T.schdOnMouseMove=(0,u.schd)(T.onMouseMove),T.schdOnTouchMove=(0,u.schd)(T.onTouchMove),T.schdOnEnd=(0,u.schd)(T.onEnd),T.thumbRefs=F.values.map(function(){return D.createRef()}),T.updateMarkRefs(F),T}return k.prototype.componentDidMount=function(){var F=this,T=this.props,z=T.values,Q=T.min,J=T.step;this.resizeObserver=window.ResizeObserver?new window.ResizeObserver(this.onResize):{observe:function(){return window.addEventListener("resize",F.onResize)},unobserve:function(){return window.removeEventListener("resize",F.onResize)}},document.addEventListener("touchstart",this.onMouseOrTouchStart,{passive:!1}),document.addEventListener("mousedown",this.onMouseOrTouchStart,{passive:!1}),!this.props.allowOverlap&&(0,u.checkInitialOverlap)(this.props.values),this.props.values.forEach(function(K){return(0,u.checkBoundaries)(K,F.props.min,F.props.max)}),this.resizeObserver.observe(this.trackRef.current),(0,u.translateThumbs)(this.getThumbs(),this.getOffsets(),this.props.rtl),this.calculateMarkOffsets(),z.forEach(function(K){(0,u.isStepDivisible)(Q,K,J)||console.warn("The `values` property is in conflict with the current `step`, `min`, and `max` properties. Please provide values that are accessible using the min, max, and step values.")})},k.prototype.componentDidUpdate=function(F,T){var z=this.props,Q=z.max,J=z.min,K=z.step,b=z.values,N=z.rtl;(F.max!==Q||F.min!==J||F.step!==K)&&this.updateMarkRefs(this.props),(0,u.translateThumbs)(this.getThumbs(),this.getOffsets(),N),(F.max!==Q||F.min!==J||F.step!==K||T.markOffsets.length!==this.state.markOffsets.length)&&(this.calculateMarkOffsets(),b.forEach(function(V){(0,u.isStepDivisible)(J,V,K)||console.warn("The `values` property is in conflict with the current `step`, `min`, and `max` properties. Please provide values that are accessible using the min, max, and step values.")}))},k.prototype.componentWillUnmount=function(){var F={passive:!1};document.removeEventListener("mousedown",this.onMouseOrTouchStart,F),document.removeEventListener("mousemove",this.schdOnMouseMove),document.removeEventListener("touchmove",this.schdOnTouchMove),document.removeEventListener("touchstart",this.onMouseOrTouchStart),document.removeEventListener("mouseup",this.schdOnEnd),document.removeEventListener("touchend",this.schdOnEnd),this.resizeObserver.unobserve(this.trackRef.current)},k.prototype.render=function(){var F=this,T=this.props,z=T.label,Q=T.labelledBy,J=T.renderTrack,K=T.renderThumb,b=T.renderMark,N=b===void 0?function(){return null}:b,V=T.values,U=T.min,Z=T.max,L=T.allowOverlap,ee=T.disabled,Ee=this.state,he=Ee.draggedThumbIndex,ge=Ee.thumbZIndexes,me=Ee.markOffsets;return J({props:{style:{transform:"scale(1)",cursor:he>-1?"grabbing":this.props.draggableTrack?(0,u.isVertical)(this.props.direction)?"ns-resize":"ew-resize":V.length===1&&!ee?"pointer":"inherit"},onMouseDown:ee?u.voidFn:this.onMouseDownTrack,onTouchStart:ee?u.voidFn:this.onTouchStartTrack,ref:this.trackRef},isDragged:this.state.draggedThumbIndex>-1,disabled:ee,children:p(p([],me.map(function(Me,ue,I){return N({props:{style:F.props.direction===v.Direction.Left||F.props.direction===v.Direction.Right?{position:"absolute",left:"".concat(Me[0],"px"),marginTop:"".concat(Me[1],"px")}:{position:"absolute",top:"".concat(Me[0],"px"),marginLeft:"".concat(Me[1],"px")},key:"mark".concat(ue),ref:F.markRefs[ue]},index:ue})}),!0),V.map(function(Me,ue){var I=F.state.draggedThumbIndex===ue;return K({index:ue,value:Me,isDragged:I,props:{style:{position:"absolute",zIndex:ge[ue],cursor:ee?"inherit":I?"grabbing":"grab",userSelect:"none",touchAction:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none"},key:ue,tabIndex:ee?void 0:0,"aria-valuemax":L?Z:V[ue+1]||Z,"aria-valuemin":L?U:V[ue-1]||U,"aria-valuenow":Me,draggable:!1,ref:F.thumbRefs[ue],"aria-label":z,"aria-labelledby":Q,role:"slider",onKeyDown:ee?u.voidFn:F.onKeyDown,onKeyUp:ee?u.voidFn:F.onKeyUp}})}),!0)})},k.defaultProps={label:"Accessibility label",labelledBy:null,step:1,direction:v.Direction.Right,rtl:!1,disabled:!1,allowOverlap:!1,draggableTrack:!1,min:0,max:100},k})(D.Component);return Range.default=C,Range}var hasRequiredLib;function requireLib(){return hasRequiredLib||(hasRequiredLib=1,(function(r){var n=lib&&lib.__importDefault||function(D){return D&&D.__esModule?D:{default:D}};Object.defineProperty(r,"__esModule",{value:!0}),r.checkValuesAgainstBoundaries=r.relativeValue=r.useThumbOverlap=r.Direction=r.getTrackBackground=r.Range=void 0;var a=n(requireRange());r.Range=a.default;var c=requireUtils();Object.defineProperty(r,"getTrackBackground",{enumerable:!0,get:function(){return c.getTrackBackground}}),Object.defineProperty(r,"useThumbOverlap",{enumerable:!0,get:function(){return c.useThumbOverlap}}),Object.defineProperty(r,"relativeValue",{enumerable:!0,get:function(){return c.relativeValue}}),Object.defineProperty(r,"checkValuesAgainstBoundaries",{enumerable:!0,get:function(){return c.checkValuesAgainstBoundaries}});var p=requireTypes();Object.defineProperty(r,"Direction",{enumerable:!0,get:function(){return p.Direction}})})(lib)),lib}var libExports=requireLib();const inputOverride=`w-12 text-center bg-transparent border-none outline-none p-0
             [&::-webkit-inner-spin-button]:appearance-none
             [&::-webkit-outer-spin-button]:appearance-none
             [-moz-appearance:textfield]`,sliderBgStyle="flex-1 h-2 bg-gray-300 rounded relative",sliderFgStyle="absolute h-2 bg-blue-500 rounded",sliderThumbStyle="w-4.5 h-4.5 bg-slate-100 border-2 border-slate-400 rounded-full transition-transform transform origin-center hover:scale-125";function RangeSlider({title:r,value:n,onChange:a,min:c,max:p}){const[D,u]=reactExports.useState(n.map(String));reactExports.useEffect(()=>{u(n.map(String))},[n]);const v=(_,C)=>{u(k=>{const F=[...k];return F[_]=C,F});const w=parseFloat(C);if(!isNaN(w)){let k=[...n];_===0?k[0]=Math.min(Math.max(w,c),n[1]):k[1]=Math.max(Math.min(w,p),n[0]),a(k)}},m=_=>{const C=parseFloat(D[_]);isNaN(C)&&u(w=>{const k=[...w];return k[_]=String(n[_]),k})};return jsxRuntimeExports.jsxs("div",{className:`${textNormal} p-2  pt-4`,children:[jsxRuntimeExports.jsx("label",{className:"block",children:r}),jsxRuntimeExports.jsxs("div",{className:"flex space-x-2.5 items-center",children:[jsxRuntimeExports.jsx("input",{type:"number",value:D[0],placeholder:c,min:c,max:n[1],onChange:_=>v(0,_.target.value),onBlur:()=>m(0),className:inputOverride}),jsxRuntimeExports.jsx(libExports.Range,{step:1,min:c,max:p,values:n,onChange:a,renderTrack:({props:_,children:C})=>jsxRuntimeExports.jsxs("div",{..._,className:sliderBgStyle,children:[jsxRuntimeExports.jsx("div",{className:sliderFgStyle,style:{left:`${(n[0]-c)/(p-c)*100}%`,width:`${(n[1]-n[0])/(p-c)*100}%`}}),C]}),renderThumb:({props:_})=>jsxRuntimeExports.jsx("div",{..._,className:"relative w-5 h-5 flex items-center",children:jsxRuntimeExports.jsx("div",{className:sliderThumbStyle})})}),jsxRuntimeExports.jsx("input",{type:"number",value:D[1],placeholder:p,min:n[0],max:p,onChange:_=>v(1,_.target.value),onBlur:()=>m(1),className:`${inputOverride} ${textSmall}`})]})]})}function buildQueryString(r,n,a,c,p){const D=[],u=[],v=[];for(const[m,_]of Object.entries(a))_===1&&u.push(m),_===2&&v.push(m);return v.length&&D.push(`NOT elements HAS ANY ${v.map(m=>`"${m}"`).join(", ")}`),u.length&&D.push(`elements HAS ALL ${u.map(m=>`"${m}"`).join(", ")}`),c[0]!==r[0]&&D.push(`nelements>=${c[0]}`),c[1]!==r[1]&&D.push(`nelements<=${c[1]}`),p[0]!==n[0]&&D.push(`nsites>=${p[0]}`),p[1]!==n[1]&&D.push(`nsites<=${p[1]}`),D.join(" AND ")}function OptimadeFilters({queryUrl:r,initialFilter:n,onSubmit:a}){const[c,p]=reactExports.useState([1,118]),[D,u]=reactExports.useState([1,1e3]),[v,m]=reactExports.useState({}),[_,C]=reactExports.useState(!1),[w,k]=reactExports.useState(n||""),F=buildQueryString([1,118],[1,1e3],v,c,D),T=_?w:F,z=()=>{a(T)},Q=()=>{C(J=>!J),_||(k(F),m({}),p([1,118]),u([1,1e3]))};return reactExports.useEffect(()=>{n&&k(n)},[n]),jsxRuntimeExports.jsxs("div",{className:"pb-4 space-y-2",children:[jsxRuntimeExports.jsxs("div",{className:_?"opacity-50 pointer-events-none":"",children:[jsxRuntimeExports.jsx(PTable,{providerUrl:r,selected:v,onSelectionChange:J=>m(K=>({...K,...J}))}),jsxRuntimeExports.jsx(RangeSlider,{title:"Number of elements",value:c,onChange:p,min:1,max:118}),jsxRuntimeExports.jsx(RangeSlider,{title:"Number of sites",value:D,onChange:u,min:0,max:1e3})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2",children:[jsxRuntimeExports.jsx("input",{id:"manual-mode-toggle",type:"checkbox",checked:_,onChange:Q,className:"hover:cursor-pointer h-4 w-4"}),jsxRuntimeExports.jsx("label",{htmlFor:"manual-mode-toggle",className:`${textSmall} text-gray-700 select-none`,children:"Unlock custom query"})]}),jsxRuntimeExports.jsx(QueryTextBox,{value:T,onChange:_?k:()=>{},onSubmit:z})]})}const sectionclassName="space-y-2";function OptimadeFAQs(){const[r,n]=reactExports.useState(!1);return jsxRuntimeExports.jsxs("div",{className:`${containerStyle} ${textSmall} [&>p]:pl-4 [&>section>p]:pl-1`,children:[jsxRuntimeExports.jsxs("section",{className:sectionclassName,children:[jsxRuntimeExports.jsxs("p",{children:["The Materials Cloud OPTIMADE Client is a tool to search through databases exposing an"," ",jsxRuntimeExports.jsx("a",{href:"https://www.optimade.org/",target:"_blank",className:textHyperlink,rel:"noopener noreferrer",children:"OPTIMADE RESTful API"}),". All providers are retrieved from the"," ",jsxRuntimeExports.jsx("a",{href:"https://providers.optimade.org/",target:"_blank",className:textHyperlink,rel:"noopener noreferrer",children:"official OPTIMADE consortium's list"}),"."]}),jsxRuntimeExports.jsxs("button",{className:`flex items-center px-2 mt-2 mb-1 ${textHyperlink} hover:cursor-pointer`,onClick:()=>n(!r),children:[jsxRuntimeExports.jsx("span",{className:textHyperlink,children:r?"Hide additional Info":"More info"}),jsxRuntimeExports.jsx("svg",{className:`w-4 h-4 transition-transform duration-200 ${r?"rotate-90":"rotate-0"}`,fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})})]})]}),r&&jsxRuntimeExports.jsxs("section",{className:sectionclassName,children:[jsxRuntimeExports.jsx("h1",{className:textLarge,children:"Frequently asked questions"}),jsxRuntimeExports.jsx("h4",{className:textNormal,children:"Why is a given provider not shown in the client?"}),jsxRuntimeExports.jsxs("p",{children:["This webapp has filtered some providers for various reasons; some do not support open queries and others have no link to a meta-database. To check the validity of a particular provider visit"," ",jsxRuntimeExports.jsx("a",{href:"https://optimade.org/providers-dashboard/",target:"_blank",className:textHyperlink,rel:"noopener noreferrer",children:"the providers dashboard"}),". Querying of missing providers should still be possible through the 'Custom endpoint' method."]}),jsxRuntimeExports.jsx("h4",{className:textNormal,children:"Why does the structure visualiser not work for some structures?"}),jsxRuntimeExports.jsx("p",{children:"The visualiser is fairly primitive and the OPTIMADE specification is very broad. For complex structure data (assemblies, unknown positions, or partial occupancies), the JSON response is still fetched but the visualisation often fails."}),jsxRuntimeExports.jsxs("p",{className:"italic",children:["An earlier version of this tool was developed by Casper Welzel Andersen. See the source code"," ",jsxRuntimeExports.jsx("a",{href:"https://github.com/CasperWA/voila-optimade-client",target:"_blank",className:textHyperlink,rel:"noopener noreferrer",children:"here."})]})]})]})}const isBoolean=r=>typeof r=="boolean"||r instanceof Boolean,isNumber=r=>typeof r=="number"||r instanceof Number,isBigInt=r=>typeof r=="bigint"||r instanceof BigInt,isDate=r=>!!r&&r instanceof Date,isString=r=>typeof r=="string"||r instanceof String,isArray=r=>Array.isArray(r),isObject$1=r=>typeof r=="object"&&r!==null,isFunction=r=>!!r&&r instanceof Object&&typeof r=="function";function quoteString(r,n){return n===void 0&&(n=!1),!r||n?`"${r}"`:r}function quoteStringValue(r,n,a){return a?JSON.stringify(r):n?`"${r}"`:r}function ExpandableObject(r){let{field:n,value:a,data:c,lastElement:p,openBracket:D,closeBracket:u,level:v,style:m,shouldExpandNode:_,clickToExpandNode:C,outerRef:w,beforeExpandChange:k}=r;const F=reactExports.useRef(!1),[T,z]=reactExports.useState(()=>_(v,a,n)),Q=reactExports.useRef(null);reactExports.useEffect(()=>{F.current?z(_(v,a,n)):F.current=!0},[_]);const J=reactExports.useId();if(c.length===0)return EmptyObject({field:n,openBracket:D,closeBracket:u,lastElement:p,style:m});const K=T?m.collapseIcon:m.expandIcon,b=T?m.ariaLables.collapseJson:m.ariaLables.expandJson,N=v+1,V=c.length-1,U=ee=>{T!==ee&&(!k||k({level:v,value:a,field:n,newExpandValue:ee}))&&z(ee)},Z=ee=>{if(ee.key==="ArrowRight"||ee.key==="ArrowLeft")ee.preventDefault(),U(ee.key==="ArrowRight");else if(ee.key==="ArrowUp"||ee.key==="ArrowDown"){ee.preventDefault();const Ee=ee.key==="ArrowUp"?-1:1;if(!w.current)return;const he=w.current.querySelectorAll("[role=button]");let ge=-1;for(let Me=0;Me<he.length;Me++)if(he[Me].tabIndex===0){ge=Me;break}if(ge<0)return;const me=(ge+Ee+he.length)%he.length;he[ge].tabIndex=-1,he[me].tabIndex=0,he[me].focus()}},L=()=>{var ee;U(!T);const Ee=Q.current;if(!Ee)return;const he=(ee=w.current)===null||ee===void 0?void 0:ee.querySelector('[role=button][tabindex="0"]');he&&(he.tabIndex=-1),Ee.tabIndex=0,Ee.focus()};return reactExports.createElement("div",{className:m.basicChildStyle,role:"treeitem","aria-expanded":T,"aria-selected":void 0},reactExports.createElement("span",{className:K,onClick:L,onKeyDown:Z,role:"button","aria-label":b,"aria-expanded":T,"aria-controls":T?J:void 0,ref:Q,tabIndex:v===0?0:-1}),(n||n==="")&&(C?reactExports.createElement("span",{className:m.clickableLabel,onClick:L,onKeyDown:Z},quoteString(n,m.quotesForFieldNames),":"):reactExports.createElement("span",{className:m.label},quoteString(n,m.quotesForFieldNames),":")),reactExports.createElement("span",{className:m.punctuation},D),T?reactExports.createElement("ul",{id:J,role:"group",className:m.childFieldsContainer},c.map((ee,Ee)=>reactExports.createElement(DataRender,{key:ee[0]||Ee,field:ee[0],value:ee[1],style:m,lastElement:Ee===V,level:N,shouldExpandNode:_,clickToExpandNode:C,beforeExpandChange:k,outerRef:w}))):reactExports.createElement("span",{className:m.collapsedContent,onClick:L,onKeyDown:Z}),reactExports.createElement("span",{className:m.punctuation},u),!p&&reactExports.createElement("span",{className:m.punctuation},","))}function EmptyObject(r){let{field:n,openBracket:a,closeBracket:c,lastElement:p,style:D}=r;return reactExports.createElement("div",{className:D.basicChildStyle,role:"treeitem","aria-selected":void 0},(n||n==="")&&reactExports.createElement("span",{className:D.label},quoteString(n,D.quotesForFieldNames),":"),reactExports.createElement("span",{className:D.punctuation},a),reactExports.createElement("span",{className:D.punctuation},c),!p&&reactExports.createElement("span",{className:D.punctuation},","))}function JsonObject(r){let{field:n,value:a,style:c,lastElement:p,shouldExpandNode:D,clickToExpandNode:u,level:v,outerRef:m,beforeExpandChange:_}=r;return ExpandableObject({field:n,value:a,lastElement:p||!1,level:v,openBracket:"{",closeBracket:"}",style:c,shouldExpandNode:D,clickToExpandNode:u,data:Object.keys(a).map(C=>[C,a[C]]),outerRef:m,beforeExpandChange:_})}function JsonArray(r){let{field:n,value:a,style:c,lastElement:p,level:D,shouldExpandNode:u,clickToExpandNode:v,outerRef:m,beforeExpandChange:_}=r;return ExpandableObject({field:n,value:a,lastElement:p||!1,level:D,openBracket:"[",closeBracket:"]",style:c,shouldExpandNode:u,clickToExpandNode:v,data:a.map(C=>[void 0,C]),outerRef:m,beforeExpandChange:_})}function JsonPrimitiveValue(r){let{field:n,value:a,style:c,lastElement:p}=r,D,u=c.otherValue;return a===null?(D="null",u=c.nullValue):a===void 0?(D="undefined",u=c.undefinedValue):isString(a)?(D=quoteStringValue(a,!c.noQuotesForStringValues,c.stringifyStringValues),u=c.stringValue):isBoolean(a)?(D=a?"true":"false",u=c.booleanValue):isNumber(a)?(D=a.toString(),u=c.numberValue):isBigInt(a)?(D=`${a.toString()}n`,u=c.numberValue):isDate(a)?D=a.toISOString():isFunction(a)?D="function() { }":D=a.toString(),reactExports.createElement("div",{className:c.basicChildStyle,role:"treeitem","aria-selected":void 0},(n||n==="")&&reactExports.createElement("span",{className:c.label},quoteString(n,c.quotesForFieldNames),":"),reactExports.createElement("span",{className:u},D),!p&&reactExports.createElement("span",{className:c.punctuation},","))}function DataRender(r){const n=r.value;return isArray(n)?reactExports.createElement(JsonArray,Object.assign({},r)):isObject$1(n)&&!isDate(n)&&!isFunction(n)?reactExports.createElement(JsonObject,Object.assign({},r)):reactExports.createElement(JsonPrimitiveValue,Object.assign({},r))}var styles={"container-light":"_2IvMF _GzYRV","basic-element-style":"_2bkNM","child-fields-container":"_1BXBN","label-light":"_1MGIk","clickable-label-light":"_2YKJg _1MGIk _1MFti","punctuation-light":"_3uHL6 _3eOF8","value-null-light":"_2T6PJ","value-undefined-light":"_1Gho6","value-string-light":"_vGjyY","value-number-light":"_1bQdo","value-boolean-light":"_3zQKs","value-other-light":"_1xvuR","collapse-icon-light":"_oLqym _f10Tu _1MFti _1LId0","expand-icon-light":"_2AXVT _f10Tu _1MFti _1UmXx","collapsed-content-light":"_2KJWg _1pNG9 _1MFti"};const defaultAriaLables={collapseJson:"collapse JSON",expandJson:"expand JSON"},defaultStyles={container:styles["container-light"],basicChildStyle:styles["basic-element-style"],childFieldsContainer:styles["child-fields-container"],label:styles["label-light"],clickableLabel:styles["clickable-label-light"],nullValue:styles["value-null-light"],undefinedValue:styles["value-undefined-light"],stringValue:styles["value-string-light"],booleanValue:styles["value-boolean-light"],numberValue:styles["value-number-light"],otherValue:styles["value-other-light"],punctuation:styles["punctuation-light"],collapseIcon:styles["collapse-icon-light"],expandIcon:styles["expand-icon-light"],collapsedContent:styles["collapsed-content-light"],noQuotesForStringValues:!1,quotesForFieldNames:!1,ariaLables:defaultAriaLables,stringifyStringValues:!1},allExpanded=()=>!0,JsonView=r=>{let{data:n,style:a=defaultStyles,shouldExpandNode:c=allExpanded,clickToExpandNode:p=!1,beforeExpandChange:D,compactTopLevel:u,...v}=r;const m=reactExports.useRef(null);return reactExports.createElement("div",Object.assign({"aria-label":"JSON view"},v,{className:a.container,ref:m,role:"tree"}),u&&isObject$1(n)?Object.entries(n).map(_=>{let[C,w]=_;return reactExports.createElement(DataRender,{key:C,field:C,value:w,style:{...defaultStyles,...a},lastElement:!0,level:1,shouldExpandNode:c,clickToExpandNode:p,beforeExpandChange:D,outerRef:m})}):reactExports.createElement(DataRender,{value:n,style:{...defaultStyles,...a},lastElement:!0,level:0,shouldExpandNode:c,clickToExpandNode:p,outerRef:m,beforeExpandChange:D}))},ControlBox=({viewerParams:r,onViewerParamChange:n,onViewerEvent:a})=>{const c=(u,v)=>{let m=r.supercell;m[u]=parseInt(v),n("supercell",m)},p=u=>{n(u,!r[u])},D=u=>{a("camera",u)};return jsxRuntimeExports.jsxs("div",{className:"control-box",children:[jsxRuntimeExports.jsxs("div",{className:"control-box-row",children:[jsxRuntimeExports.jsxs("div",{className:"supercell-container",children:[jsxRuntimeExports.jsx("label",{children:"Supercell: "}),jsxRuntimeExports.jsx("div",{style:{display:"flex"},children:[0,1,2].map(u=>jsxRuntimeExports.jsx("input",{className:"supercell-input",type:"number",min:"1",max:"99",value:r.supercell[u],onChange:v=>c(u,v.target.value)},u))})]}),jsxRuntimeExports.jsxs("div",{className:"camera-controls",children:[jsxRuntimeExports.jsx("label",{children:"Camera: "}),jsxRuntimeExports.jsx("button",{className:"camera-button",onClick:()=>D("x"),children:"x"}),jsxRuntimeExports.jsx("button",{className:"camera-button",onClick:()=>D("y"),children:"y"}),jsxRuntimeExports.jsx("button",{className:"camera-button",onClick:()=>D("z"),children:"z"})]})]}),jsxRuntimeExports.jsxs("div",{className:"control-box-row",style:{display:"flex"},children:[jsxRuntimeExports.jsxs("label",{className:"option-checkbox",children:[jsxRuntimeExports.jsx("input",{className:"control-box-input",type:"checkbox",checked:r.bonds,onChange:()=>p("bonds")}),jsxRuntimeExports.jsx("span",{children:"Bonds"})]}),jsxRuntimeExports.jsxs("label",{className:"option-checkbox",children:[jsxRuntimeExports.jsx("input",{className:"control-box-input",type:"checkbox",checked:r.packedCell,onChange:()=>p("packedCell")}),jsxRuntimeExports.jsx("span",{children:"Packed cell"})]}),jsxRuntimeExports.jsxs("label",{className:"option-checkbox",children:[jsxRuntimeExports.jsx("input",{className:"control-box-input",type:"checkbox",checked:r.atomLabels,onChange:()=>p("atomLabels")}),jsxRuntimeExports.jsx("span",{children:"Atom labels"})]}),jsxRuntimeExports.jsxs("label",{className:"option-checkbox",children:[jsxRuntimeExports.jsx("input",{className:"control-box-input",type:"checkbox",checked:r.spaceFilling,onChange:()=>p("vdwRadius")}),jsxRuntimeExports.jsx("span",{children:"vdW radius"})]})]})]})};var _3DmolMin={exports:{}};/*! For license information please see 3Dmol-min.js.LICENSE.txt */var hasRequired_3DmolMin;function require_3DmolMin(){return hasRequired_3DmolMin||(hasRequired_3DmolMin=1,(function(module,exports){var factory;factory=()=>(()=>{var __webpack_modules__={3:(r,n,a)=>{var c=a(663),p=a(981),D=a(972),u=a(681),v=a(834),m=a(746),_=a(670),C=Object.prototype.toString;function w(F){if(!(this instanceof w))return new w(F);this.options=p.assign({chunkSize:16384,windowBits:0,to:""},F||{});var T=this.options;T.raw&&T.windowBits>=0&&T.windowBits<16&&(T.windowBits=-T.windowBits,T.windowBits===0&&(T.windowBits=-15)),!(T.windowBits>=0&&T.windowBits<16)||F&&F.windowBits||(T.windowBits+=32),T.windowBits>15&&T.windowBits<48&&(15&T.windowBits||(T.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new m,this.strm.avail_out=0;var z=c.inflateInit2(this.strm,T.windowBits);if(z!==u.Z_OK)throw new Error(v[z]);if(this.header=new _,c.inflateGetHeader(this.strm,this.header),T.dictionary&&(typeof T.dictionary=="string"?T.dictionary=D.string2buf(T.dictionary):C.call(T.dictionary)==="[object ArrayBuffer]"&&(T.dictionary=new Uint8Array(T.dictionary)),T.raw&&(z=c.inflateSetDictionary(this.strm,T.dictionary))!==u.Z_OK))throw new Error(v[z])}function k(F,T){var z=new w(T);if(z.push(F,!0),z.err)throw z.msg||v[z.err];return z.result}w.prototype.push=function(F,T){var z,Q,J,K,b,N=this.strm,V=this.options.chunkSize,U=this.options.dictionary,Z=!1;if(this.ended)return!1;Q=T===~~T?T:T===!0?u.Z_FINISH:u.Z_NO_FLUSH,typeof F=="string"?N.input=D.binstring2buf(F):C.call(F)==="[object ArrayBuffer]"?N.input=new Uint8Array(F):N.input=F,N.next_in=0,N.avail_in=N.input.length;do{if(N.avail_out===0&&(N.output=new p.Buf8(V),N.next_out=0,N.avail_out=V),(z=c.inflate(N,u.Z_NO_FLUSH))===u.Z_NEED_DICT&&U&&(z=c.inflateSetDictionary(this.strm,U)),z===u.Z_BUF_ERROR&&Z===!0&&(z=u.Z_OK,Z=!1),z!==u.Z_STREAM_END&&z!==u.Z_OK)return this.onEnd(z),this.ended=!0,!1;N.next_out&&(N.avail_out!==0&&z!==u.Z_STREAM_END&&(N.avail_in!==0||Q!==u.Z_FINISH&&Q!==u.Z_SYNC_FLUSH)||(this.options.to==="string"?(J=D.utf8border(N.output,N.next_out),K=N.next_out-J,b=D.buf2string(N.output,J),N.next_out=K,N.avail_out=V-K,K&&p.arraySet(N.output,N.output,J,K,0),this.onData(b)):this.onData(p.shrinkBuf(N.output,N.next_out)))),N.avail_in===0&&N.avail_out===0&&(Z=!0)}while((N.avail_in>0||N.avail_out===0)&&z!==u.Z_STREAM_END);return z===u.Z_STREAM_END&&(Q=u.Z_FINISH),Q===u.Z_FINISH?(z=c.inflateEnd(this.strm),this.onEnd(z),this.ended=!0,z===u.Z_OK):Q!==u.Z_SYNC_FLUSH||(this.onEnd(u.Z_OK),N.avail_out=0,!0)},w.prototype.onData=function(F){this.chunks.push(F)},w.prototype.onEnd=function(F){F===u.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=p.flattenChunks(this.chunks)),this.chunks=[],this.err=F,this.msg=this.strm.msg},n.Inflate=w,n.inflate=k,n.inflateRaw=function(F,T){return(T=T||{}).raw=!0,k(F,T)},n.ungzip=k},16:(r,n,a)=>{a.r(n),a.d(n,{CAP:()=>c,CC:()=>_.CC,CONTEXTS_PER_VIEWPORT:()=>Lt,Color:()=>_.Color,CustomLinear:()=>C.CustomLinear,Cylinder:()=>v.Cylinder,GLDraw:()=>p,GLModel:()=>ur,GLShape:()=>Le,GLViewer:()=>Yt,GLVolumetricRender:()=>Pt,Gradient:()=>C.Gradient,GradientType:()=>C.GradientType,Label:()=>Mt,LabelCount:()=>lt,MarchingCube:()=>x,MarchingCubeInitializer:()=>Bt,Matrix3:()=>m.Matrix3,Matrix4:()=>m.Matrix4,Parsers:()=>It,PausableTimer:()=>w.PausableTimer,PointGrid:()=>ne,ProteinSurface:()=>xe,Quaternion:()=>m.Quaternion,ROYGB:()=>C.ROYGB,RWB:()=>C.RWB,Ray:()=>m.Ray,Sinebow:()=>C.Sinebow,Sphere:()=>v.Sphere,SurfaceType:()=>Gr,Triangle:()=>v.Triangle,Vector2:()=>m.Vector2,Vector3:()=>m.Vector3,VolumeData:()=>Ve.VolumeData,adjustVolumeStyle:()=>w.adjustVolumeStyle,applyPartialCharges:()=>ri,autoinit:()=>_r,autoload:()=>Mi,base64ToArray:()=>w.base64ToArray,bondLength:()=>Ie.bondLength,builtinColorSchemes:()=>_.builtinColorSchemes,builtinGradients:()=>C.builtinGradients,chains:()=>_.chains,clamp:()=>m.clamp,conversionMatrix3:()=>m.conversionMatrix3,createStereoViewer:()=>Ur,createViewer:()=>Er,createViewerGrid:()=>Cr,deepCopy:()=>w.deepCopy,degToRad:()=>m.degToRad,download:()=>w.download,drawCartoon:()=>ge,elementColors:()=>_.elementColors,extend:()=>w.extend,get:()=>w.get,getAtomProperty:()=>w.getAtomProperty,getColorFromStyle:()=>w.getColorFromStyle,getElement:()=>w.getElement,getExtent:()=>w.getExtent,getGradient:()=>C.getGradient,getPropertyRange:()=>w.getPropertyRange,getbin:()=>w.getbin,htmlColors:()=>_.htmlColors,inflateString:()=>w.inflateString,isEmptyObject:()=>w.isEmptyObject,isNumeric:()=>w.isNumeric,makeFunction:()=>w.makeFunction,mergeGeos:()=>w.mergeGeos,normalizeValue:()=>C.normalizeValue,partialCharges:()=>Qt,processing_autoinit:()=>Lr,residues:()=>_.residues,setBondLength:()=>Ie.setBondLength,setSyncSurface:()=>qi,specStringToObject:()=>w.specStringToObject,splitMesh:()=>yt,ssColors:()=>_.ssColors,subdivide_spline:()=>k,syncSurface:()=>Kr,viewers:()=>wr});var c,p,D=a(111),u=a(378),v=a(99),m=a(529),_=a(222);(function(ae){ae[ae.NONE=0]="NONE",ae[ae.FLAT=1]="FLAT",ae[ae.ROUND=2]="ROUND"})(c||(c={})),(function(ae){function i(h,A,g){var E,M,S,R,O,$=Math.hypot(h,A);$<1e-4?(M=0,S=1):(M=-h/$,S=A/$),A=-M*h+S*A,(E=Math.hypot(A,g))<1e-4?(R=0,O=1):(R=g/E,O=A/E);var G=new Float32Array(9);return G[0]=S,G[1]=M,G[2]=0,G[3]=-M*O,G[4]=S*O,G[5]=R,G[6]=M*R,G[7]=-S*R,G[8]=O,G}var s=new class{constructor(){this.cache={};let h,A=[],g=Math.pow(2,4),E=2,M=Math.pow(2,E),S=g/M;for(A[0]=new m.Vector3(-1,0,0),A[S]=new m.Vector3(0,0,1),A[2*S]=new m.Vector3(1,0,0),A[3*S]=new m.Vector3(0,0,-1),E=3;E<=4;E++){for(M=Math.pow(2,E-1),S=g/M,h=0;h<M-1;h++)A[S/2+h*S]=A[h*S].clone().add(A[(h+1)*S]).normalize();h=M-1,A[S/2+h*S]=A[h*S].clone().add(A[0]).normalize()}this.basisVectors=A}getVerticesForRadius(h,A,g){if(this.cache!==void 0&&this.cache[h]!==void 0&&this.cache[h][A+g]!==void 0)return this.cache[h][A+g];for(var E,M=this.basisVectors.length,S=[],R=[],O=0;O<M;O++)S.push(this.basisVectors[O].clone().multiplyScalar(h)),S.push(this.basisVectors[O].clone().multiplyScalar(h)),E=this.basisVectors[O].clone().normalize(),R.push(E),R.push(E);var $,G,j=[],W=10,H=M,Y=2*Math.PI,te=Math.PI,re=!1,de=!1;for(G=0;G<=W;G++){re=G===0||G===W,de=G===5;var le=[],ye=[];for($=0;$<=H;$++)if(de){var Pe=$<H?2*$:0;ye.push(Pe+1),le.push(Pe)}else{var Te=$/H,ke=G/W;if(re&&$!==0)re&&le.push(S.length-1);else if($<H){var we=new m.Vector3;we.x=-h*Math.cos(0+Te*Y)*Math.sin(0+ke*te),we.y=A==1?0:h*Math.cos(0+ke*te),we.z=h*Math.sin(0+Te*Y)*Math.sin(0+ke*te),Math.abs(we.x)<1e-5&&(we.x=0),Math.abs(we.y)<1e-5&&(we.y=0),Math.abs(we.z)<1e-5&&(we.z=0),A==c.FLAT?(E=new m.Vector3(0,Math.cos(0+ke*te),0)).normalize():(E=new m.Vector3(we.x,we.y,we.z)).normalize(),S.push(we),R.push(E),le.push(S.length-1)}else le.push(S.length-H)}de&&j.push(ye),j.push(le)}var Ge={vertices:S,normals:R,verticesRows:j,w:H,h:W};return h in this.cache||(this.cache[h]={}),this.cache[h][A+g]=Ge,Ge}};ae.drawCylinder=function(h,A,g,E,M,S=0,R=0){if(!A||!g)return;let O=function(_e){if(typeof _e=="string"){let ve=_e;return ve.toLowerCase()=="flat"?c.FLAT:ve.toLowerCase()=="round"?c.ROUND:c.NONE}return _e};S=O(S);var $=(R=O(R))||S;M=M||{r:0,g:0,b:0};var G,j,W,H,Y,te,re=i(g.x-A.x,g.y-A.y,g.z-A.z),de=s.getVerticesForRadius(E,R,"to"),le=de.w,ye=de.h,Pe=$?ye*le+2:2*le,Te=h.updateGeoGroup(Pe),ke=de.vertices,we=de.normals,Ge=de.verticesRows,Je=Ge[ye/2],tt=Ge[ye/2+1],Ye=Te.vertices,ut=Te.vertexArray,ft=Te.normalArray,Qe=Te.colorArray,pt=Te.faceArray;for(W=0;W<le;++W){var Be=2*W;H=re[0]*ke[Be].x+re[3]*ke[Be].y+re[6]*ke[Be].z,Y=re[1]*ke[Be].x+re[4]*ke[Be].y+re[7]*ke[Be].z,te=re[5]*ke[Be].y+re[8]*ke[Be].z,G=3*(Ye+Be),j=Te.faceidx,ut[G]=H+A.x,ut[G+1]=Y+A.y,ut[G+2]=te+A.z,ut[G+3]=H+g.x,ut[G+4]=Y+g.y,ut[G+5]=te+g.z,ft[G]=H,ft[G+3]=H,ft[G+1]=Y,ft[G+4]=Y,ft[G+2]=te,ft[G+5]=te,Qe[G]=M.r,Qe[G+3]=M.r,Qe[G+1]=M.g,Qe[G+4]=M.g,Qe[G+2]=M.b,Qe[G+5]=M.b,pt[j]=tt[W]+Ye,pt[j+1]=tt[W+1]+Ye,pt[j+2]=Je[W]+Ye,pt[j+3]=Je[W]+Ye,pt[j+4]=tt[W+1]+Ye,pt[j+5]=Je[W+1]+Ye,Te.faceidx+=6}if($){var et,St,ot,wt,At,it,Rt,Ht,kt,ct,Jt,Nt,qt,Vt,Xt,yr,Fr,Tr,ii,Wr,br,$r,ci,ni,hi,zi,xi,Ii,Hr,Xr,qr,ei,f=S?ye+1:ye/2+1;for(Y=R?0:ye/2;Y<f;Y++)if(Y!==ye/2){var q=Y<=ye/2?g:A,y=s.getVerticesForRadius(E,R,"to"),be=s.getVerticesForRadius(E,S,"from");for(q===g?(ke=y.vertices,we=y.normals,Ge=y.verticesRows):q==A&&(ke=be.vertices,we=be.normals,Ge=be.verticesRows),H=0;H<le;H++)j=Te.faceidx,Hr=3*((et=Ge[Y][H+1])+Ye),Xr=3*((St=Ge[Y][H])+Ye),qr=3*((ot=Ge[Y+1][H])+Ye),ei=3*((wt=Ge[Y+1][H+1])+Ye),At=re[0]*ke[et].x+re[3]*ke[et].y+re[6]*ke[et].z,it=re[0]*ke[St].x+re[3]*ke[St].y+re[6]*ke[St].z,Rt=re[0]*ke[ot].x+re[3]*ke[ot].y+re[6]*ke[ot].z,Ht=re[0]*ke[wt].x+re[3]*ke[wt].y+re[6]*ke[wt].z,kt=re[1]*ke[et].x+re[4]*ke[et].y+re[7]*ke[et].z,ct=re[1]*ke[St].x+re[4]*ke[St].y+re[7]*ke[St].z,Jt=re[1]*ke[ot].x+re[4]*ke[ot].y+re[7]*ke[ot].z,Nt=re[1]*ke[wt].x+re[4]*ke[wt].y+re[7]*ke[wt].z,qt=re[5]*ke[et].y+re[8]*ke[et].z,Vt=re[5]*ke[St].y+re[8]*ke[St].z,Xt=re[5]*ke[ot].y+re[8]*ke[ot].z,yr=re[5]*ke[wt].y+re[8]*ke[wt].z,ut[Hr]=At+q.x,ut[Xr]=it+q.x,ut[qr]=Rt+q.x,ut[ei]=Ht+q.x,ut[Hr+1]=kt+q.y,ut[Xr+1]=ct+q.y,ut[qr+1]=Jt+q.y,ut[ei+1]=Nt+q.y,ut[Hr+2]=qt+q.z,ut[Xr+2]=Vt+q.z,ut[qr+2]=Xt+q.z,ut[ei+2]=yr+q.z,Qe[Hr]=M.r,Qe[Xr]=M.r,Qe[qr]=M.r,Qe[ei]=M.r,Qe[Hr+1]=M.g,Qe[Xr+1]=M.g,Qe[qr+1]=M.g,Qe[ei+1]=M.g,Qe[Hr+2]=M.b,Qe[Xr+2]=M.b,Qe[qr+2]=M.b,Qe[ei+2]=M.b,Fr=re[0]*we[et].x+re[3]*we[et].y+re[6]*we[et].z,Tr=re[0]*we[St].x+re[3]*we[St].y+re[6]*we[St].z,ii=re[0]*we[ot].x+re[3]*we[ot].y+re[6]*we[ot].z,Wr=re[0]*we[wt].x+re[3]*we[wt].y+re[6]*we[wt].z,br=re[1]*we[et].x+re[4]*we[et].y+re[7]*we[et].z,$r=re[1]*we[St].x+re[4]*we[St].y+re[7]*we[St].z,ci=re[1]*we[ot].x+re[4]*we[ot].y+re[7]*we[ot].z,ni=re[1]*we[wt].x+re[4]*we[wt].y+re[7]*we[wt].z,hi=re[5]*we[et].y+re[8]*we[et].z,zi=re[5]*we[St].y+re[8]*we[St].z,xi=re[5]*we[ot].y+re[8]*we[ot].z,Ii=re[5]*we[wt].y+re[8]*we[wt].z,Y===0?(ft[Hr]=Fr,ft[qr]=ii,ft[ei]=Wr,ft[Hr+1]=br,ft[qr+1]=ci,ft[ei+1]=ni,ft[Hr+2]=hi,ft[qr+2]=xi,ft[ei+2]=Ii,pt[j]=et+Ye,pt[j+1]=ot+Ye,pt[j+2]=wt+Ye,Te.faceidx+=3):Y===f-1?(ft[Hr]=Fr,ft[Xr]=Tr,ft[qr]=ii,ft[Hr+1]=br,ft[Xr+1]=$r,ft[qr+1]=ci,ft[Hr+2]=hi,ft[Xr+2]=zi,ft[qr+2]=xi,pt[j]=et+Ye,pt[j+1]=St+Ye,pt[j+2]=ot+Ye,Te.faceidx+=3):(ft[Hr]=Fr,ft[Xr]=Tr,ft[ei]=Wr,ft[Hr+1]=br,ft[Xr+1]=$r,ft[ei+1]=ni,ft[Hr+2]=hi,ft[Xr+2]=zi,ft[ei+2]=Ii,ft[Xr]=Tr,ft[qr]=ii,ft[ei]=Wr,ft[Xr+1]=$r,ft[qr+1]=ci,ft[ei+1]=ni,ft[Xr+2]=zi,ft[qr+2]=xi,ft[ei+2]=Ii,pt[j]=et+Ye,pt[j+1]=St+Ye,pt[j+2]=wt+Ye,pt[j+3]=St+Ye,pt[j+4]=ot+Ye,pt[j+5]=wt+Ye,Te.faceidx+=6)}}Te.vertices+=Pe},ae.drawCone=function(h,A,g,E,M){if(!A||!g)return;M=M||{r:0,g:0,b:0};let S=new m.Vector3(g.x-A.x,g.y-A.y,g.z-A.z);var R=i(S.x,S.y,S.z);S=S.normalize();var O,$,G,j,W,H,Y=s.basisVectors.length,te=s.basisVectors,re=Y+2,de=h.updateGeoGroup(re),le=de.vertices,ye=de.vertexArray,Pe=de.normalArray,Te=de.colorArray,ke=de.faceArray;for(ye[O=3*le]=A.x,ye[O+1]=A.y,ye[O+2]=A.z,Pe[O]=-S.x,Pe[O+1]=-S.y,Pe[O+2]=-S.z,Te[O]=M.r,Te[O+1]=M.g,Te[O+2]=M.b,ye[O+3]=g.x,ye[O+4]=g.y,ye[O+5]=g.z,Pe[O+3]=S.x,Pe[O+4]=S.y,Pe[O+5]=S.z,Te[O+3]=M.r,Te[O+4]=M.g,Te[O+5]=M.b,O+=6,G=0;G<Y;++G){var we=te[G].clone();we.multiplyScalar(E),j=R[0]*we.x+R[3]*we.y+R[6]*we.z,W=R[1]*we.x+R[4]*we.y+R[7]*we.z,H=R[5]*we.y+R[8]*we.z,ye[O]=j+A.x,ye[O+1]=W+A.y,ye[O+2]=H+A.z,Pe[O]=j,Pe[O+1]=W,Pe[O+2]=H,Te[O]=M.r,Te[O+1]=M.g,Te[O+2]=M.b,O+=3}for(de.vertices+=Y+2,$=de.faceidx,G=0;G<Y;G++){var Ge=le+2+G,Je=le+2+(G+1)%Y;ke[$]=Ge,ke[$+1]=Je,ke[$+2]=le,ke[$+=3]=Ge,ke[$+1]=Je,ke[$+2]=le+1,$+=3}de.faceidx+=6*Y};var l=new class{constructor(){this.cache=new Map}getVerticesForRadius(h,A){A=A||2,this.cache.has(A)||this.cache.set(A,new Map);let g=this.cache.get(A);if(g.has(h))return g.get(h);var E={vertices:[],verticesRows:[],normals:[]},M=16*A,S=10*A;h<1&&(M=10*A,S=8*A);var R,O,$=2*Math.PI,G=Math.PI;for(O=0;O<=S;O++){let W=[];for(R=0;R<=M;R++){let H=R/M,Y=O/S,te=-h*Math.cos(0+H*$)*Math.sin(0+Y*G),re=h*Math.cos(0+Y*G),de=h*Math.sin(0+H*$)*Math.sin(0+Y*G);var j=new m.Vector3(te,re,de);j.normalize(),E.vertices.push({x:te,y:re,z:de}),E.normals.push(j),W.push(E.vertices.length-1)}E.verticesRows.push(W)}return g.set(h,E),E}};ae.drawSphere=function(h,A,g,E,M){var S=l.getVerticesForRadius(g,M),R=S.vertices,O=S.normals,$=h.updateGeoGroup(R.length),G=$.vertices,j=$.vertexArray,W=$.colorArray,H=$.faceArray,Y=$.lineArray,te=$.normalArray;for(let le=0,ye=R.length;le<ye;++le){let Pe=3*(G+le),Te=R[le];j[Pe]=Te.x+A.x,j[Pe+1]=Te.y+A.y,j[Pe+2]=Te.z+A.z,W[Pe]=E.r,W[Pe+1]=E.g,W[Pe+2]=E.b}$.vertices+=R.length;let re=S.verticesRows,de=re.length-1;for(let le=0;le<de;le++){let ye=re[le].length-1;for(let Pe=0;Pe<ye;Pe++){let Te=$.faceidx,ke=$.lineidx,we=re[le][Pe+1]+G,Ge=3*we,Je=re[le][Pe]+G,tt=3*Je,Ye=re[le+1][Pe]+G,ut=3*Ye,ft=re[le+1][Pe+1]+G,Qe=3*ft,pt=O[we-G],Be=O[Je-G],et=O[Ye-G],St=O[ft-G];Math.abs(R[we-G].y)===g?(te[Ge]=pt.x,te[ut]=et.x,te[Qe]=St.x,te[Ge+1]=pt.y,te[ut+1]=et.y,te[Qe+1]=St.y,te[Ge+2]=pt.z,te[ut+2]=et.z,te[Qe+2]=St.z,H[Te]=we,H[Te+1]=Ye,H[Te+2]=ft,Y[ke]=we,Y[ke+1]=Ye,Y[ke+2]=we,Y[ke+3]=ft,Y[ke+4]=Ye,Y[ke+5]=ft,$.faceidx+=3,$.lineidx+=6):Math.abs(R[Ye-G].y)===g?(te[Ge]=pt.x,te[tt]=Be.x,te[ut]=et.x,te[Ge+1]=pt.y,te[tt+1]=Be.y,te[ut+1]=et.y,te[Ge+2]=pt.z,te[tt+2]=Be.z,te[ut+2]=et.z,H[Te]=we,H[Te+1]=Je,H[Te+2]=Ye,Y[ke]=we,Y[ke+1]=Je,Y[ke+2]=we,Y[ke+3]=Ye,Y[ke+4]=Je,Y[ke+5]=Ye,$.faceidx+=3,$.lineidx+=6):(te[Ge]=pt.x,te[tt]=Be.x,te[Qe]=St.x,te[Ge+1]=pt.y,te[tt+1]=Be.y,te[Qe+1]=St.y,te[Ge+2]=pt.z,te[tt+2]=Be.z,te[Qe+2]=St.z,te[tt]=Be.x,te[ut]=et.x,te[Qe]=St.x,te[tt+1]=Be.y,te[ut+1]=et.y,te[Qe+1]=St.y,te[tt+2]=Be.z,te[ut+2]=et.z,te[Qe+2]=St.z,H[Te]=we,H[Te+1]=Je,H[Te+2]=ft,H[Te+3]=Je,H[Te+4]=Ye,H[Te+5]=ft,Y[ke]=we,Y[ke+1]=Je,Y[ke+2]=we,Y[ke+3]=ft,Y[ke+4]=Je,Y[ke+5]=Ye,Y[ke+6]=Ye,Y[ke+7]=ft,$.faceidx+=6,$.lineidx+=8)}}}})(p||(p={}));var C=a(546),w=a(864);function k(ae,i){var s,l,h,A,g,E,M,S,R,O=[],$=ae;for(($=[]).push(ae[0]),s=1,l=ae.length-1;s<l;s++)if(g=ae[s],E=ae[s+1],g.smoothen){var G=new m.Vector3((g.x+E.x)/2,(g.y+E.y)/2,(g.z+E.z)/2);G.atom=g.atom,$.push(G)}else $.push(g);for($.push(ae[ae.length-1]),s=-1,h=$.length;s<=h-3;s++)if(A=$[s===-1?0:s],g=$[s+1],E=$[s+2],M=$[s===h-3?h-1:s+3],S=new m.Vector3().subVectors(E,A).multiplyScalar(.5),R=new m.Vector3().subVectors(M,g).multiplyScalar(.5),!E.skip)for(var j=0;j<i;j++){var W=1/i*j,H=g.x+W*S.x+W*W*(-3*g.x+3*E.x-2*S.x-R.x)+W*W*W*(2*g.x-2*E.x+S.x+R.x),Y=g.y+W*S.y+W*W*(-3*g.y+3*E.y-2*S.y-R.y)+W*W*W*(2*g.y-2*E.y+S.y+R.y),te=g.z+W*S.z+W*W*(-3*g.z+3*E.z-2*S.z-R.z)+W*W*W*(2*g.z-2*E.z+S.z+R.z),re=new m.Vector3(H,Y,te);re.atom=j<i/2?g.atom:E.atom,O.push(re)}return O.push($[$.length-1]),O}const F=.5,T=1.3,z=.8,Q=.4,J=.4;function K(ae,i,s,l){for(var h,A,g,E,M=0,S=i.length;M<S;M++){E=Math.round(M*(l.length-1)/S),g=_.CC.color(l[E]);var R=ae.updateGeoGroup(2),O=R.vertexArray,$=R.colorArray,G=R.faceArray;O[A=3*(h=R.vertices)]=i[M].x,O[A+1]=i[M].y,O[A+2]=i[M].z,O[A+3]=s[M].x,O[A+4]=s[M].y,O[A+5]=s[M].z;for(var j=0;j<6;++j)$[A+3*j]=g.r,$[A+1+3*j]=g.g,$[A+2+3*j]=g.b;if(M>0){var W=[h,h+1,h-1,h-2],H=R.faceidx;G[H]=W[0],G[H+1]=W[1],G[H+2]=W[3],G[H+3]=W[1],G[H+4]=W[2],G[H+5]=W[3],R.faceidx+=6}R.vertices+=2}}function b(ae,i,s,l,h,A,g){g&&g!=="default"||(g="rectangle"),g==="edged"?(function(E,M,S,R,O){if(!(M.length<2)){var $,G;if($=M[0],G=M[M.length-1],$=k($,R),G=k(G,R),!O)return K(E,$,G,S);var j,W,H,Y,te,re,de,le,ye,Pe,Te,ke,we,Ge,Je,tt,Ye,ut,ft,Qe,pt,Be,et=[],St=[[0,2,-6,-8],[-4,-2,6,4],[7,-1,-5,3],[-3,5,1,-7]];for(we=0,Ge=$.length;we<Ge;we++){if(Pe=Math.round(we*(S.length-1)/Ge),ye=_.CC.color(S[Pe]),et.push(W=$[we]),et.push(W),et.push(H=G[we]),et.push(H),we<Ge-1){var ot=$[we+1].clone().sub($[we]);j=G[we].clone().sub($[we]).cross(ot).normalize().multiplyScalar(O)}for(et.push(Y=$[we].clone().add(j)),et.push(Y),et.push(te=G[we].clone().add(j)),et.push(te),W.atom!==void 0&&(Te=W.atom),Qe=(ft=E.updateGeoGroup(8)).vertexArray,pt=ft.colorArray,Be=ft.faceArray,Qe[de=3*(re=ft.vertices)]=W.x,Qe[de+1]=W.y,Qe[de+2]=W.z,Qe[de+3]=W.x,Qe[de+4]=W.y,Qe[de+5]=W.z,Qe[de+6]=H.x,Qe[de+7]=H.y,Qe[de+8]=H.z,Qe[de+9]=H.x,Qe[de+10]=H.y,Qe[de+11]=H.z,Qe[de+12]=Y.x,Qe[de+13]=Y.y,Qe[de+14]=Y.z,Qe[de+15]=Y.x,Qe[de+16]=Y.y,Qe[de+17]=Y.z,Qe[de+18]=te.x,Qe[de+19]=te.y,Qe[de+20]=te.z,Qe[de+21]=te.x,Qe[de+22]=te.y,Qe[de+23]=te.z,Je=0;Je<8;++Je)pt[de+3*Je]=ye.r,pt[de+1+3*Je]=ye.g,pt[de+2+3*Je]=ye.b;if(we>0){var wt=ke!==void 0&&Te!==void 0&&ke.serial!==Te.serial;for(Je=0;Je<4;Je++){var At=[re+St[Je][0],re+St[Je][1],re+St[Je][2],re+St[Je][3]];if(Be[le=ft.faceidx]=At[0],Be[le+1]=At[1],Be[le+2]=At[3],Be[le+3]=At[1],Be[le+4]=At[2],Be[le+5]=At[3],ft.faceidx+=6,Te.clickable||ke.clickable||Te.hoverable||ke.hoverable){var it=et[At[3]].clone(),Rt=et[At[0]].clone(),Ht=et[At[2]].clone(),kt=et[At[1]].clone();if(it.atom=et[At[3]].atom||null,Ht.atom=et[At[2]].atom||null,Rt.atom=et[At[0]].atom||null,kt.atom=et[At[1]].atom||null,wt){var ct=it.clone().add(Rt).multiplyScalar(.5),Jt=Ht.clone().add(kt).multiplyScalar(.5),Nt=it.clone().add(kt).multiplyScalar(.5);Je%2==0?((ke.clickable||ke.hoverable)&&(tt=new v.Triangle(ct,Nt,it),Ye=new v.Triangle(Jt,Ht,Nt),ut=new v.Triangle(Nt,Ht,it),ke.intersectionShape.triangle.push(tt),ke.intersectionShape.triangle.push(Ye),ke.intersectionShape.triangle.push(ut)),(Te.clickable||Te.hoverable)&&(tt=new v.Triangle(Rt,kt,Nt),Ye=new v.Triangle(kt,Jt,Nt),ut=new v.Triangle(Rt,Nt,ct),Te.intersectionShape.triangle.push(tt),Te.intersectionShape.triangle.push(Ye),Te.intersectionShape.triangle.push(ut))):((Te.clickable||Te.hoverable)&&(tt=new v.Triangle(ct,Nt,it),Ye=new v.Triangle(Jt,Ht,Nt),ut=new v.Triangle(Nt,Ht,it),Te.intersectionShape.triangle.push(tt),Te.intersectionShape.triangle.push(Ye),Te.intersectionShape.triangle.push(ut)),(ke.clickable||ke.hoverable)&&(tt=new v.Triangle(Rt,kt,Nt),Ye=new v.Triangle(kt,Jt,Nt),ut=new v.Triangle(Rt,Nt,ct),ke.intersectionShape.triangle.push(tt),ke.intersectionShape.triangle.push(Ye),ke.intersectionShape.triangle.push(ut)))}else(Te.clickable||Te.hoverable)&&(tt=new v.Triangle(Rt,kt,it),Ye=new v.Triangle(kt,Ht,it),Te.intersectionShape.triangle.push(tt),Te.intersectionShape.triangle.push(Ye))}}}ft.vertices+=8,ke=Te}var qt=et.length-8;for(Qe=(ft=E.updateGeoGroup(8)).vertexArray,pt=ft.colorArray,Be=ft.faceArray,de=3*(re=ft.vertices),le=ft.faceidx,we=0;we<4;we++){et.push(et[2*we]),et.push(et[qt+2*we]);var Vt=et[2*we],Xt=et[qt+2*we];Qe[de+6*we]=Vt.x,Qe[de+1+6*we]=Vt.y,Qe[de+2+6*we]=Vt.z,Qe[de+3+6*we]=Xt.x,Qe[de+4+6*we]=Xt.y,Qe[de+5+6*we]=Xt.z,pt[de+6*we]=ye.r,pt[de+1+6*we]=ye.g,pt[de+2+6*we]=ye.b,pt[de+3+6*we]=ye.r,pt[de+4+6*we]=ye.g,pt[de+5+6*we]=ye.b}qt+=8,tt=[re,re+2,re+6,re+4],Ye=[re+1,re+5,re+7,re+3],Be[le]=tt[0],Be[le+1]=tt[1],Be[le+2]=tt[3],Be[le+3]=tt[1],Be[le+4]=tt[2],Be[le+5]=tt[3],Be[le+6]=Ye[0],Be[le+7]=Ye[1],Be[le+8]=Ye[3],Be[le+9]=Ye[1],Be[le+10]=Ye[2],Be[le+11]=Ye[3],ft.faceidx+=12,ft.vertices+=8}})(ae,i,s,l,h):g!=="rectangle"&&g!=="oval"&&g!=="parabola"||(function(E,M,S,R,O,$,G){var j,W,H,Y,te,re,de,le,ye,Pe;if((H=M.length)<2||M[0].length<2)return;for(j=0;j<H;j++)M[j]=k(M[j],R);if(Y=M[0].length,!O)return K(E,M[0],M[H-1],S);var Te=[],ke=[],we=[];for(W=0;W<H;W++)Te.push(.25+1.5*Math.sqrt((H-1)*W-Math.pow(W,2))/(H-1)),ke.push(.5),we.push(2*(Math.pow(W/H,2)-W/H)+.6);var Ge,Je,tt,Ye,ut,ft,Qe,pt,Be,et,St=[];for(W=0;W<2*H-1;W++)St[W]=[W,W+1,W+1-2*H,W-2*H];St[2*H-1]=[W,W+1-2*H,W+1-4*H,W-2*H];let ot=E.updateGeoGroup();for(j=0;j<Y;j++){let Rt=E.groups,Ht=!1;var wt,At;for(ot=E.updateGeoGroup(2*H),Rt!=E.groups&&j>0&&(j-=1,Ht=!0),ft=Math.round(j*(S.length-1)/Y),ut=_.CC.color(S[ft]),ye=de,Pe=le,de=[],le=[],te=[],M[0][j].atom!==void 0&&(Ye=M[0][j].atom,G==="oval"?re=Te:G==="rectangle"?re=ke:G==="parabola"&&(re=we)),re||(re=ke),W=0;W<H;W++)wt=j<Y-1?M[W][j+1].clone().sub(M[W][j]):M[W][j-1].clone().sub(M[W][j]).negate(),At=W<H-1?M[W+1][j].clone().sub(M[W][j]):M[W-1][j].clone().sub(M[W][j]).negate(),te[W]=At.cross(wt).normalize().multiplyScalar(O*re[W]);for(W=0;W<H;W++)de[W]=M[W][j].clone().add(te[W].clone().negate());for(W=0;W<H;W++)le[W]=M[W][j].clone().add(te[W]);for(Qe=ot.vertexArray,pt=ot.colorArray,Be=ot.faceArray,Je=3*(Ge=ot.vertices),W=0;W<H;W++)Qe[Je+3*W+0]=de[W].x,Qe[Je+3*W+1]=de[W].y,Qe[Je+3*W+2]=de[W].z;for(W=0;W<H;W++)Qe[Je+3*W+0+3*H]=le[H-1-W].x,Qe[Je+3*W+1+3*H]=le[H-1-W].y,Qe[Je+3*W+2+3*H]=le[H-1-W].z;for(W=0;W<2*H;++W)pt[Je+3*W+0]=ut.r,pt[Je+3*W+1]=ut.g,pt[Je+3*W+2]=ut.b;if(j>0&&!Ht){for(W=0;W<2*H;W++)et=[Ge+St[W][0],Ge+St[W][1],Ge+St[W][2],Ge+St[W][3]],Be[tt=ot.faceidx]=et[0],Be[tt+1]=et[1],Be[tt+2]=et[3],Be[tt+3]=et[1],Be[tt+4]=et[2],Be[tt+5]=et[3],ot.faceidx+=6;if(Ye.clickable||Ye.hoverable){var it=[];for(W in it.push(new v.Triangle(ye[0],de[0],de[H-1])),it.push(new v.Triangle(ye[0],de[H-1],ye[H-1])),it.push(new v.Triangle(ye[H-1],de[H-1],le[H-1])),it.push(new v.Triangle(ye[H-1],le[H-1],Pe[H-1])),it.push(new v.Triangle(le[0],Pe[0],Pe[H-1])),it.push(new v.Triangle(le[H-1],le[0],Pe[H-1])),it.push(new v.Triangle(de[0],ye[0],Pe[0])),it.push(new v.Triangle(le[0],de[0],Pe[0])),it)Ye.intersectionShape.triangle.push(it[W])}}ot.vertices+=2*H}for(Qe=ot.vertexArray,pt=ot.colorArray,Be=ot.faceArray,Je=3*(Ge=ot.vertices),tt=ot.faceidx,j=0;j<H-1;j++)et=[j,j+1,2*H-2-j,2*H-1-j],Be[tt=ot.faceidx]=et[0],Be[tt+1]=et[1],Be[tt+2]=et[3],Be[tt+3]=et[1],Be[tt+4]=et[2],Be[tt+5]=et[3],ot.faceidx+=6;for(j=0;j<H-1;j++)et=[Ge-1-j,Ge-2-j,Ge-2*H+j+1,Ge-2*H+j],Be[tt=ot.faceidx]=et[0],Be[tt+1]=et[1],Be[tt+2]=et[3],Be[tt+3]=et[1],Be[tt+4]=et[2],Be[tt+5]=et[3],ot.faceidx+=6})(ae,i,s,l,h,0,g)}function N(ae){return ae&&ae.elem==="C"&&ae.atom==="CA"}function V(ae,i){if(ae&&i&&ae.chain===i.chain){if(!(ae.hetflag||i.hetflag||ae.reschain!==i.reschain||ae.resi!==i.resi&&ae.resi!==i.resi-1))return!0;if(ae.resi<i.resi){var s=ae.x-i.x,l=ae.y-i.y,h=ae.z-i.z,A=s*s+l*l+h*h;if(ae.atom=="CA"&&i.atom=="CA"&&A<16||(ae.atom=="P"||i.atom=="P")&&A<64)return!0}}return!1}function U(ae,i,s,l,h){if(i!=null&&i.vertices!=0){h&&(i.initTypedArrays(),i.setUpNormals());var A=new u.MeshDoubleLambertMaterial;A.vertexColors=u.Coloring.FaceColors,typeof s=="number"&&s>=0&&s<1&&(A.transparent=!0,A.opacity=s),A.outline=l;var g=new u.Mesh(i,A);ae.add(g)}}function Z(ae,i,s,l,h,A,g,E,M){var S,R,O,$,G,j;if(l&&h&&g){var W=h.sub(l);W.normalize();var H=E[M];for(R=M+1;R<E.length&&(H=E[R]).atom!=g.atom;R++);if((H=H?new m.Vector3(H.x,H.y,H.z):new m.Vector3(0,0,0)).sub(l),g.ss==="arrow start"){var Y=H.clone().multiplyScalar(.3).cross(h);l.add(Y);var te=H.clone().cross(W).normalize();W.rotateAboutVector(te,.43)}for(g.style.cartoon.ribbon?S=g.style.cartoon.thickness||Q:g.style.cartoon.width?S=g.style.cartoon.width:g.ss==="c"?S=g.atom==="P"?z:F:g.ss==="arrow start"?(S=T,G=!0):S=g.ss==="arrow end"||g.ss==="h"&&g.style.cartoon.tubes||g.ss==="tube start"?F:T,A!=null&&W.dot(A)<0&&W.negate(),W.multiplyScalar(S),R=0;R<i;R++)O=2*R/(i-1)-1,($=new m.Vector3(l.x+O*W.x,l.y+O*W.y,l.z+O*W.z)).atom=g,g.ss==="s"&&($.smoothen=!0),ae[R].push($);if(G)for(W.multiplyScalar(2),R=0;R<i;R++)O=2*R/(i-1)-1,($=new m.Vector3(l.x+O*W.x,l.y+O*W.y,l.z+O*W.z)).atom=g,$.smoothen=!1,$.skip=!0,ae[R].push($);return j=g.style.cartoon.style||"default",ae.style?ae.style!=j&&(console.log("Warning: a cartoon chain's strand-style is ambiguous"),ae.style="default"):ae.style=j,g.ss!=="arrow start"&&g.ss!=="arrow end"||(g.ss="s"),G}}const L={C:!0,CA:!0,O:!0,P:!0,OP2:!0,O2P:!0,"O5'":!0,"O3'":!0,"C5'":!0,"C2'":!0,"O5*":!0,"O3*":!0,"C5*":!0,"C2*":!0,N1:!0,N3:!0},ee={DA:!0,DG:!0,A:!0,G:!0},Ee={DT:!0,DC:!0,U:!0,C:!0,T:!0},he={DA:!0,DG:!0,A:!0,G:!0,DT:!0,DC:!0,U:!0,C:!0,T:!0};function ge(ae,i,s,l=10){let h=l,A=l;var g,E,M,S,R,O,$,G,j,W,H,Y,te,re,de,le,ye,Pe,Te=new u.Geometry(!0),ke=new u.Geometry(!0),we=[],Ge=[],Je=1,tt=!1,Ye={};for(var ut in C.Gradient.builtinGradients)C.Gradient.builtinGradients.hasOwnProperty(ut)&&(Ye[ut]=new C.Gradient.builtinGradients[ut](s[1],s[0]));var ft=function(Vt,Xt){return s&&Xt.color==="spectrum"?Xt.colorscheme in Ye?Ye[Xt.colorscheme].valueToHex(Vt.resi):Ye.sinebow.valueToHex(Vt.resi):(0,w.getColorFromStyle)(Vt,Xt).getHex()};for(G=0;G<h;G++)Ge[G]=[];var Qe=!1,pt=!1,Be=[];for(G in i){if((S=i[G]).elem==="C"&&S.atom==="CA"){var et=V(M,S);et&&S.ss==="s"?Qe=!0:Qe&&(M&&E&&M.style.cartoon.arrows&&E.style.cartoon.arrows&&(M.ss="arrow end",E.ss="arrow start"),Qe=!1),et&&(M.ss==="h"||M.ss=="tube start")&&M.style.cartoon.tubes?!pt&&M.ss!="tube start"&&S.style.cartoon.tubes&&(S.ss="tube start",pt=!0):pt&&(M.ss==="tube start"?M.ss="tube end":E&&E.style.cartoon.tubes&&(E.ss="tube end"),pt=!1),E=M,M=S}S&&S.atom in L&&Be.push(S)}pt&&M.style.cartoon.tubes&&(M.ss="tube end",pt=!1);var St=function(Vt){Ge[0].length>0&&b(ke,Ge,we,A,$,0,Ge.style);var Xt=[],yr=null;if(Vt){for(G=0;G<h;G++)Xt[G]=Ge[G][Ge[G].length-1];yr=we[we.length-1]}for(Ge=[],G=0;G<h;G++)Ge[G]=[];if(we=[],Vt){for(G=0;G<h;G++)Ge[G].push(Xt[G]);we.push(yr)}U(ae,ke,Je,tt,!0),U(ae,Te,Je,tt,!1),ke=new u.Geometry(!0),Te=new u.Geometry(!0)};M=void 0;let ot=[];for(var wt=0;wt<Be.length;wt++){var At=(S=Be[wt]).resn.trim(),it=At in he;if(Je=1,g=S.style.cartoon,M&&M.style.cartoon&&(Je=M.style.cartoon.opacity),M&&M.style.cartoon&&M.style.cartoon.outline&&(tt=M.style.cartoon.outline),!M||!M.style.cartoon||S.style.cartoon&&M.style.cartoon.opacity==S.style.cartoon.opacity||St(M.chain==S.chain),M&&S&&!V(M,S)&&M.chain&&M.chain==S.chain&&!M.hetflag&&!S.hetflag&&M.reschain+1==S.reschain&&ot.push([M,S]),g.style==="trace"){if(!S.hetflag&&(S.elem==="C"&&S.atom==="CA"||it&&S.atom==="P"||S.atom==="BB")){if(O=ft(S,g),$=(0,w.isNumeric)(g.thickness)?g.thickness:Q,V(M,S))if(O==R){var Rt=_.CC.color(O);p.drawCylinder(Te,M,S,$,Rt,2,2)}else{var Ht=new m.Vector3().addVectors(M,S).multiplyScalar(.5),kt=_.CC.color(R),ct=_.CC.color(O);p.drawCylinder(Te,M,Ht,$,kt,2,0),p.drawCylinder(Te,Ht,S,$,ct,0,2)}if((S.clickable===!0||S.hoverable)&&S.intersectionShape!==void 0){var Jt=new m.Vector3(S.x,S.y,S.z);S.intersectionShape.sphere.push(new v.Sphere(Jt,$))}M=S,R=O}}else{if(N(S)||it&&(S.atom==="P"||S.atom.indexOf("O5")==0)){if(Pe)if(S.ss==="tube end")Pe=!1,ye=new m.Vector3(S.x,S.y,S.z),p.drawCylinder(Te,le,ye,2,_.CC.color(R),1,1),S.ss="h";else{if(M.chain==S.chain&&M.ss!=="tube end")continue;Pe=!1,M.ss="h",ye=new m.Vector3(M.x,M.y,M.z),p.drawCylinder(Te,le,ye,2,_.CC.color(R),1,1)}if(M&&(!V(M,S)||M.ss==="tube start")){for(M.ss==="tube start"&&(Pe=!0,le=new m.Vector3(M.x,M.y,M.z),M.ss="h"),de&&(re=Y?new m.Vector3().addVectors(M,Y).multiplyScalar(.5):new m.Vector3(M.x,M.y,M.z),p.drawCylinder(Te,re,de,J,_.CC.color(de.color),0,2),Z(Ge,h,!0,Y,te,H,M,Be,wt),we.push(O),re=null,de=null),Ge[0].length>0&&b(ke,Ge,we,A,$,0,Ge.style),Ge=[],G=0;G<h;G++)Ge[G]=[];we=[]}if(M===void 0||M.rescode!=S.rescode||M.resi!=S.resi){if(de&&M!=null){var Nt=(re=new m.Vector3().addVectors(M,S).multiplyScalar(.5)).clone().sub(de).multiplyScalar(.02);re.add(Nt),p.drawCylinder(Te,re,de,J,_.CC.color(de.color),0,2),re=null,de=null}O=ft(S,g),we.push(O),$=(0,w.isNumeric)(g.thickness)?g.thickness:Q,M=S,(j=new m.Vector3(M.x,M.y,M.z)).resi=M.resi,R=O}S.clickable!==!0&&S.hoverable!==!0||S.intersectionShape!==void 0&&S.intersectionShape.triangle!==void 0||(S.intersectionShape={sphere:null,cylinder:[],line:[],triangle:[]})}else M!=null&&(N(M)&&S.atom==="O"||it&&M.atom==="P"&&(S.atom==="OP2"||S.atom==="O2P")||it&&M.atom.indexOf("O5")==0&&S.atom.indexOf("C5")==0)?((W=new m.Vector3(S.x,S.y,S.z)).resi=S.resi,S.atom!=="OP2"&&S.atom!=="O2P"||(te=new m.Vector3(S.x,S.y,S.z))):it&&S.atom.indexOf("O3")==0?Y=new m.Vector3(S.x,S.y,S.z):(S.atom==="N1"&&At in ee||S.atom==="N3"&&At in Ee)&&((de=new m.Vector3(S.x,S.y,S.z)).color=(0,w.getColorFromStyle)(S,g).getHex());W&&j&&W.resi===j.resi&&(Z(Ge,h,!0,j,W,H,M,Be,wt),H=W,j=null,W=null,we.push(O))}}de&&(re=Y?new m.Vector3().addVectors(M,Y).multiplyScalar(.5):new m.Vector3(M.x,M.y,M.z),p.drawCylinder(Te,re,de,J,_.CC.color(de.color),0,2),Z(Ge,h,!0,Y,te,H,M,Be,wt),we.push(O)),St(!1);var qt=function(Vt,Xt){if(Vt.style.cartoon.gapcutoff&&Vt.style.cartoon.gapcutoff==Xt.style.cartoon.gapcutoff){let Fr=Vt.style.cartoon.gapcutoff,Tr=Xt.resi-Vt.resi;if(Tr>0&&Tr<Fr){let ii=.25,Wr=Xt.x-Vt.x,br=Xt.y-Vt.y,$r=Xt.z-Vt.z,ci=Math.sqrt(Wr*Wr+br*br+$r*$r),ni=ci/(2*Tr),hi=new m.Vector3(Vt.x,Vt.y,Vt.z),zi=ci/ni,xi=new m.Vector3((Xt.x-Vt.x)/zi,(Xt.y-Vt.y)/zi,(Xt.z-Vt.z)/zi);hi.add({x:xi.x/2,y:xi.y/2,z:xi.z/2});let Ii=hi.clone().add(xi);xi.multiplyScalar(2);let Hr=(0,w.extend)({},Vt);for(var yr=0;yr<Tr;yr++){Hr.resi+=1;let Xr=ft(Hr,Hr.style.cartoon);p.drawCylinder(Te,hi,Ii,ii,_.CC.color(Xr),c.FLAT,c.FLAT),hi.add(xi),Ii.add(xi)}St(!1)}}};for(let Vt of ot)qt(Vt[0],Vt[1])}var me=a(797),Me=a(865),ue=a(392);function I(ae,i){for(var s=[[]],l=(i=i||{}).assignBonds===void 0||i.assignBonds,h=ae.trimStart().split(/\r?\n|\r/);h.length>0&&!(h.length<3);){var A=parseInt(h[0]);if(isNaN(A)||A<=0||h.length<A+2)break;var g=/Lattice\s*=\s*["\{\}]([^"\{\}]+)["\{\}]\s*/gi.exec(h[1]);if(g!=null&&g.length>1){var E=new Float32Array(g[1].split(/\s+/)),M=new u.Matrix3(E[0],E[3],E[6],E[1],E[4],E[7],E[2],E[5],E[8]);s.modelData=[{cryst:{matrix:M}}]}for(var S=2,R=s[s.length-1].length,O=R+A,$=R;$<O;$++){var G=h[S++].trim().split(/\s+/),j={};j.serial=$;var W=G[0];j.atom=j.elem=W[0].toUpperCase()+W.substring(1,2).toLowerCase(),j.x=parseFloat(G[1]),j.y=parseFloat(G[2]),j.z=parseFloat(G[3]),j.hetflag=!0,j.bonds=[],j.bondOrder=[],j.properties={},s[s.length-1][$]=j,G.length>=7&&(j.dx=parseFloat(G[4]),j.dy=parseFloat(G[5]),j.dz=parseFloat(G[6]))}if(!i.multimodel)break;s.push([]),h.splice(0,S)}if(l)for(let Y=0;Y<s.length;Y++)(0,ue.assignBonds)(s[Y],i);if(i.onemol){var H=s;(s=[]).push(H[0]);for(let Y=1;Y<H.length;Y++){let te=s[0].length;for(let re=0;re<H[Y].length;re++){let de=H[Y][re];for(let le=0;le<de.bonds.length;le++)de.bonds[le]=de.bonds[le]+te;de.index=s[0].length,de.serial=s[0].length,s[0].push(de)}}}return s}function ce(ae,i){var s="V2000",l=ae.split(/\r?\n|\r/);return l.length>3&&l[3].length>38&&(s=l[3].substring(34,39)),s==="V2000"?(function(h,A){var g=[[]],E=!1;for(A.keepH!==void 0&&(E=!A.keepH);h.length>0&&!(h.length<4);){var M=parseInt(h[3].substring(0,3));if(isNaN(M)||M<=0)break;var S=parseInt(h[3].substring(3,6)),R=4;if(h.length<4+M+S)break;var O,$,G=[],j=g[g.length-1].length,W=j+M;for(O=j;O<W;O++,R++){var H={},Y=($=h[R]).substring(31,34).replace(/ /g,"");H.atom=H.elem=Y[0].toUpperCase()+Y.substring(1).toLowerCase(),H.elem==="H"&&E||(H.serial=O,G[O]=g[g.length-1].length,H.x=parseFloat($.substring(0,10)),H.y=parseFloat($.substring(10,20)),H.z=parseFloat($.substring(20,30)),H.hetflag=!0,H.bonds=[],H.bondOrder=[],H.properties={},H.index=g[g.length-1].length,g[g.length-1].push(H))}for(O=0;O<S;O++,R++){$=h[R];var te=G[parseInt($.substring(0,3))-1+j],re=G[parseInt($.substring(3,6))-1+j],de=parseFloat($.substring(6));te!==void 0&&re!==void 0&&(g[g.length-1][te].bonds.push(re),g[g.length-1][te].bondOrder.push(de),g[g.length-1][re].bonds.push(te),g[g.length-1][re].bondOrder.push(de))}if(!A.multimodel)break;for(A.onemol||g.push([]);h[R]!=="$$$$"&&R<h.length;)R++;h.splice(0,++R)}return g})(l,i):s==="V3000"?(function(h,A){var g=[[]],E=!1;for(A.keepH!==void 0&&(E=!A.keepH);h.length>0&&!(h.length<8)&&h[4].startsWith("M  V30 BEGIN CTAB")&&h[5].startsWith("M  V30 COUNTS")&&!(h[5].length<14);){var M=h[5].substring(13).match(/\S+/g);if(M.length<2)break;var S=parseInt(M[0]);if(isNaN(S)||S<=0)break;var R=parseInt(M[1]),O=7;if(h.length<8+S+R)break;var $,G=[],j=g[g.length-1].length,W=j+S;for($=j;$<W;$++,O++){var H=h[O].substring(6).match(/\S+/g);if(H.length>4){var Y={},te=H[1].replace(/ /g,"");Y.atom=Y.elem=te[0].toUpperCase()+te.substring(1).toLowerCase(),Y.elem==="H"&&E||(Y.serial=$,G[$]=g[g.length-1].length,Y.x=parseFloat(H[2]),Y.y=parseFloat(H[3]),Y.z=parseFloat(H[4]),Y.hetflag=!0,Y.bonds=[],Y.bondOrder=[],Y.properties={},Y.index=g[g.length-1].length,g[g.length-1].push(Y))}}if(h[O]!=="M  V30 END ATOM"||(O++,R===0||h[O]!=="M  V30 BEGIN BOND"))break;for(O++,$=0;$<R;$++,O++){var re=h[O].substring(6).match(/\S+/g);if(re.length>3){var de=G[parseInt(re[2])-1+j],le=G[parseInt(re[3])-1+j],ye=parseFloat(re[1]);de!==void 0&&le!==void 0&&(g[g.length-1][de].bonds.push(le),g[g.length-1][de].bondOrder.push(ye),g[g.length-1][le].bonds.push(de),g[g.length-1][le].bondOrder.push(ye))}}if(!A.multimodel)break;for(A.onemol||g.push([]);h[O]!=="$$$$"&&O<h.length;)O++;h.splice(0,++O)}return g})(l,i):[[""]]}function se(ae,i){var s=[[]];typeof ae=="string"&&(ae=JSON.parse(ae));for(var l=ae.m,h=l[0].a,A=l[0].b,g=l[0].s,E=i!==void 0&&i.parseStyle!==void 0?i.parseStyle:g!==void 0,M=s[s.length-1].length,S=0;S<h.length;S++){var R=h[S],O={};O.id=R.i,O.x=R.x,O.y=R.y,O.z=R.z||0,O.bonds=[],O.bondOrder=[];var $=R.l||"C";O.elem=$[0].toUpperCase()+$.substring(1).toLowerCase(),O.serial=s[s.length-1].length,E&&(O.style=g[R.s||0]),s[s.length-1].push(O)}for(let G=0;G<A.length;G++){let j=A[G],W=j.b+M,H=j.e+M,Y=j.o||1,te=s[s.length-1][W],re=s[s.length-1][H];te.bonds.push(H),te.bondOrder.push(Y),re.bonds.push(W),re.bondOrder.push(Y)}return s}function X(ae,i){(function(S,R){const O=R||3.2,$=O*O,G=[];for(let j=0,W=S.length;j<W;j++){S[j].index=j;const H=S[j];H.hetflag||H.atom!=="N"&&H.atom!=="O"||(G.push(H),H.hbondOther=null,H.hbondDistanceSq=Number.POSITIVE_INFINITY)}G.sort(function(j,W){return j.z-W.z});for(let j=0,W=G.length;j<W;j++){const H=G[j];for(let Y=j+1;Y<W;Y++){const te=G[Y],re=te.z-H.z;if(re>O)break;if(te.atom==H.atom)continue;const de=Math.abs(te.y-H.y);if(de>O)continue;const le=Math.abs(te.x-H.x);if(le>O)continue;const ye=le*le+de*de+re*re;ye>$||te.chain==H.chain&&Math.abs(te.resi-H.resi)<4||(ye<H.hbondDistanceSq&&(H.hbondOther=te,H.hbondDistanceSq=ye),ye<te.hbondDistanceSq&&(te.hbondOther=H,te.hbondDistanceSq=ye))}}})(ae,i);const s={};let l,h,A,g,E,M;for(l=0,h=ae.length;l<h;l++)if(E=ae[l],s[E.chain]===void 0&&(s[E.chain]=[]),isFinite(E.hbondDistanceSq)){const S=E.hbondOther;s[S.chain]===void 0&&(s[S.chain]=[]),Math.abs(S.resi-E.resi)===4&&(s[E.chain][E.resi]="h")}for(A in s)for(g=1;g<s[A].length-1;g++){const S=s[A][g-1],R=s[A][g+1];M=s[A][g],S=="h"&&S==R&&M!=S&&(s[A][g]=S)}for(l=0,h=ae.length;l<h;l++)E=ae[l],isFinite(E.hbondDistanceSq)&&s[E.chain][E.resi]!="h"&&E.ss!=="h"&&(s[E.chain][E.resi]="maybesheet");for(let S=0,R=ae.length;S<R;S++)if(E=ae[S],isFinite(E.hbondDistanceSq)&&s[E.chain][E.resi]=="maybesheet"){let O=E.hbondOther,$=s[O.chain][O.resi];$!="maybesheet"&&$!="s"||(s[E.chain][E.resi]="s",s[O.chain][O.resi]="s")}for(let S in s){for(let R=1;R<s[S].length-1;R++){const O=s[S][R-1],$=s[S][R+1];M=s[S][R],O=="s"&&O==$&&M!=O&&(s[S][R]=O)}for(let R=0;R<s[S].length;R++){const O=s[S][R];O!="h"&&O!="s"||s[S][R-1]!=O&&s[S][R+1]!=O&&delete s[S][R]}}for(l=0,h=ae.length;l<h;l++)E=ae[l],M=s[E.chain][E.resi],delete E.hbondOther,delete E.hbondDistanceSq,M!==void 0&&M!=="maybesheet"&&(E.ss=M,s[E.chain][E.resi-1]!=M&&(E.ssbegin=!0),s[E.chain][E.resi+1]!=M&&(E.ssend=!0))}function Re(ae,i,s,l){const h=!s.duplicateAssemblyAtoms,A=i.length;let g=A,E=-1,M=null,S=null;(s.normalizeAssembly||s.wrapAtoms)&&l&&(M=(0,u.conversionMatrix3)(l.a,l.b,l.c,l.alpha,l.beta,l.gamma),S=new u.Matrix3,S.getInverse3(M));let R=function(G){let j=G.clone().applyMatrix3(S);const W=[j.x,j.y,j.z],H=[0,0,0];for(let te=0;te<3;te++){for(;W[te]<-.001;)W[te]+=1,H[te]+=1;for(;W[te]>1.001;)W[te]-=1,H[te]-=1}const Y=new u.Vector3(H[0],H[1],H[2]);return Y.applyMatrix3(M),Y};if(s.normalizeAssembly&&l)for(let G=0;G<ae.length;G++){const j=new u.Vector3(0,0,0);for(let H=0;H<A;H++){const Y=new u.Vector3(i[H].x,i[H].y,i[H].z);Y.applyMatrix4(ae[G]),j.add(Y)}j.divideScalar(A);const W=R(j);ae[G].isNearlyIdentity()&&W.lengthSq()>.001&&(E=G),ae[G].translate(W)}if(h){if(ae.length>1)for(let G=0;G<i.length;G++){var O=[];for(let j=0;j<ae.length;j++)if(!ae[j].isNearlyIdentity()){var $=new u.Vector3;$.set(i[G].x,i[G].y,i[G].z),$.applyMatrix4(ae[j]),O.push($)}i[G].symmetries=O}}else{for(let G=0;G<A;G++)i[G].sym=-1;for(let G=0;G<ae.length;G++)if(ae[G].isNearlyIdentity()||E==G)for(let j=0;j<A;j++)i[j].sym=G;else{let j=new u.Vector3;for(let W=0;W<A;W++){const H=[];for(let te=0;te<i[W].bonds.length;te++)H.push(i[W].bonds[te]+g);if(j.set(i[W].x,i[W].y,i[W].z),j.applyMatrix4(ae[G]),s.wrapAtoms&&l){let te=R(j);j.add(te)}const Y={};for(const te in i[W])Y[te]=i[W][te];Y.x=j.x,Y.y=j.y,Y.z=j.z,Y.bonds=H,Y.sym=G,Y.index=i.length,i.push(Y)}g=i.length}if(s.wrapAtoms&&l){let G=new u.Vector3;for(let j=0;j<A;j++){G.set(i[j].x,i[j].y,i[j].z);let W=R(G);G.add(W),i[j].x=G.x,i[j].y=G.y,i[j].z=G.z}}if(E>=0){const G=new u.Vector3;for(let j=0;j<A;j++)G.set(i[j].x,i[j].y,i[j].z),G.applyMatrix4(ae[E]),i[j].x=G.x,i[j].y=G.y,i[j].z=G.z}ae.length=0}}var fe=a(408);const De=new Set(["ABU","ACD","ALA","ALB","ALI","ARG","AR0","ASN","ASP","ASX","BAS","CYS","CYH","CYX","CSS","CSH","GLN","GLU","GLX","GLY","HIS","HIE","HID","HIP","HYP","ILE","ILU","LEU","LYS","MET","PCA","PGA","PHE","PR0","PRO","PRZ","SER","THR","TRP","TYR","VAL","A","1MA","C","5MC","OMC","G","1MG","2MG","M2G","7MG","OMG","YG","I","T","U","+U","H2U","5MU","PSU","ACE","F0R","H2O","HOH","WAT"]);function We(ae,i){const s=[],l=[];for(let E=0,M=ae.length;E<M;E++){const S=ae[E];S.index=E,S.hetflag||!De.has(S.resn)?l.push(S):s.push(S)}(0,ue.assignBonds)(l,i),s.sort(function(E,M){return E.chain!==M.chain?E.chain<M.chain?-1:1:E.resi-M.resi});let h,A=-1,g=-1;for(let E=0,M=s.length;E<M;E++){const S=s[E];S.resi!==A&&(A=S.resi,h||g++,h=!1),S.reschain=g;for(let R=E+1;R<s.length;R++){const O=s[R];if(O.chain!==S.chain||O.resi-S.resi>1)break;(0,fe.areConnected)(S,O,i)&&(S.bonds.indexOf(O.index)===-1&&(S.bonds.push(O.index),S.bondOrder.push(1),O.bonds.push(S.index),O.bondOrder.push(1)),S.resi!==O.resi&&(h=!0))}}}const oe=function(ae,i,s,l){return new u.Vector3(i,s,l).applyMatrix3(ae)};function Ae(ae,i={}){const s=[],l=!i.doAssembly,h=s.modelData=[],A=i.assignBonds===void 0||i.assignBonds;function g($,G){const j=[];let W=0,H=0;for(;H<$.length;){for(;$.substring(H,H+G.length)!==G&&H<$.length;)if($[H]==="'"){for(H++;H<$.length&&$[H]!=="'";)H++;for(;$.substring(H,H+G.length)!==G&&H<$.length;)H++}else if($[H]==='"'){for(H++;H<$.length&&$[H]!=='"';)H++;H++}else H++;j.push($.substring(W,H)),W=H+=G.length}return j}const E=ae.split(/\r?\n|\r/),M=[];let S=!1;for(let $=0;$<E.length;$++){var R=E[$].split("#")[0];if(S?R[0]===";"&&(S=!1):R[0]===";"&&(S=!0),S||R!==""){if(!S&&(R=R.trim())[0]==="_"){const G=R.split(/\s/)[0].indexOf(".");if(G>-1){let j=R.split("");j[G]="_",R=(R=j.join("")).substring(0,G)+"_"+R.substring(G+1)}}M.push(R)}}let O=0;for(;O<M.length;){for(;!M[O].startsWith("data_")||M[O]==="data_global";)O++;O++;const $={};for(;O<M.length&&!M[O].startsWith("data_");)if(M[O][0]===void 0)O++;else if(M[O][0]==="_"){const H=M[O].split(/\s/)[0].toLowerCase(),Y=$[H]=$[H]||[],te=M[O].substring(M[O].indexOf(H)+H.length);if(te==="")if(O++,M[O][0]===";"){let re=M[O].substring(1);for(O++;M[O]!==";";)re=re+`
`+M[O],O++;Y.push(re)}else Y.push(M[O]);else Y.push(te.trim());O++}else if(M[O].substring(0,5)==="loop_"){O++;const H=[];for(;M[O]===""||M[O][0]==="_";){if(M[O]!==""){let te=M[O].split(/\s/)[0].toLowerCase(),re=$[te]=$[te]||[];H.push(re)}O++}let Y=0;for(;O<M.length&&M[O][0]!=="_"&&!M[O].startsWith("loop_")&&!M[O].startsWith("data_");){let te=g(M[O]," ");for(let re=0;re<te.length;re++)te[re]!==""&&(H[Y].push(te[re]),Y=(Y+1)%H.length);O++}}else O++;h.push({symmetries:[]}),s.push([]);const G=$._atom_site_id!==void 0?$._atom_site_id.length:$._atom_site_label.length;let j;if($._cell_length_a!==void 0){const H=parseFloat($._cell_length_a),Y=parseFloat($._cell_length_b),te=parseFloat($._cell_length_c),re=parseFloat($._cell_angle_alpha)||90,de=parseFloat($._cell_angle_beta)||90,le=parseFloat($._cell_angle_gamma)||90;j=(0,u.conversionMatrix3)(H,Y,te,re,de,le),h[h.length-1].cryst={a:H,b:Y,c:te,alpha:re,beta:de,gamma:le}}for(let H=0;H<G;H++){if($._atom_site_group_pdb!==void 0&&$._atom_site_group_pdb[H]==="TER")continue;const Y={};if($._atom_site_cartn_x!==void 0)Y.x=parseFloat($._atom_site_cartn_x[H]),Y.y=parseFloat($._atom_site_cartn_y[H]),Y.z=parseFloat($._atom_site_cartn_z[H]);else{const re=oe(j,parseFloat($._atom_site_fract_x[H]),parseFloat($._atom_site_fract_y[H]),parseFloat($._atom_site_fract_z[H]));Y.x=re.x,Y.y=re.y,Y.z=re.z}Y.chain=$._atom_site_auth_asym_id?$._atom_site_auth_asym_id[H]:$._atom_site_label_asym_id?$._atom_site_label_asym_id[H]:void 0,Y.lchain=$._atom_site_label_asym_id?$._atom_site_label_asym_id[H]:void 0,Y.resi=$._atom_site_auth_seq_id?parseInt($._atom_site_auth_seq_id[H]):$._atom_site_label_seq_id?$._atom_site_label_seq_id[H]:void 0,Y.resn=$._atom_site_auth_comp_id?$._atom_site_auth_comp_id[H].trim():$._atom_site_label_comp_id?$._atom_site_label_comp_id[H].trim():void 0,Y.atom=$._atom_site_auth_atom_id?$._atom_site_auth_atom_id[H].replace(/"/gm,""):$._atom_site_label_atom_id?$._atom_site_label_atom_id[H].replace(/"/gm,""):void 0,Y.hetflag=!$._atom_site_group_pdb||$._atom_site_group_pdb[H]==="HETA"||$._atom_site_group_pdb[H]==="HETATM",$._atom_site_b_iso_or_equiv&&(Y.b=parseFloat($._atom_site_b_iso_or_equiv[H]));let te="X";$._atom_site_type_symbol?te=$._atom_site_type_symbol[H].replace(/\(?\+?\d+.*/,""):$._atom_site_label&&(te=$._atom_site_label[H].split("_")[0].replace(/\(?\d+.*/,"")),Y.elem=te[0].toUpperCase()+te.substring(1,2).toLowerCase(),Y.bonds=[],Y.ss="c",Y.serial=H,Y.bondOrder=[],Y.properties={},s[s.length-1].push(Y)}if($._pdbx_struct_oper_list_id!==void 0&&!l)for(let H=0;H<$._pdbx_struct_oper_list_id.length;H++){const Y=parseFloat($["_pdbx_struct_oper_list_matrix[1][1]"][H]),te=parseFloat($["_pdbx_struct_oper_list_matrix[1][2]"][H]),re=parseFloat($["_pdbx_struct_oper_list_matrix[1][3]"][H]),de=parseFloat($["_pdbx_struct_oper_list_vector[1]"][H]),le=parseFloat($["_pdbx_struct_oper_list_matrix[2][1]"][H]),ye=parseFloat($["_pdbx_struct_oper_list_matrix[2][2]"][H]),Pe=parseFloat($["_pdbx_struct_oper_list_matrix[2][3]"][H]),Te=parseFloat($["_pdbx_struct_oper_list_vector[2]"][H]),ke=parseFloat($["_pdbx_struct_oper_list_matrix[3][1]"][H]),we=parseFloat($["_pdbx_struct_oper_list_matrix[3][2]"][H]),Ge=parseFloat($["_pdbx_struct_oper_list_matrix[3][3]"][H]),Je=parseFloat($["_pdbx_struct_oper_list_vector[3]"][H]),tt=new u.Matrix4(Y,te,re,de,le,ye,Pe,Te,ke,we,Ge,Je);h[h.length-1].symmetries.push(tt)}const W=function(H){const Y=H.match("-"),te=(H=H.replace(/[-xyz]/g,"")).split("/");let re,de;return de=te[1]===void 0?1:parseInt(te[1]),re=te[0]===""?1:parseInt(te[0]),re/de*(Y?-1:1)};if($._symmetry_equiv_pos_as_xyz!==void 0&&!l)for(let H=0;H<$._symmetry_equiv_pos_as_xyz.length;H++){const Y=$._symmetry_equiv_pos_as_xyz[H].replace(/["' ]/g,"").split(",").map(function(le){return le.replace(/-/g,"+-")});let te=new u.Matrix4(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1);for(let le=0;le<3;le++){const ye=Y[le].split("+");for(let Pe=0;Pe<ye.length;Pe++){const Te=ye[Pe];if(Te==="")continue;const ke=W(Te);Te.match("x")?te.elements[le+0]=ke:Te.match("y")?te.elements[le+4]=ke:Te.match("z")?te.elements[le+8]=ke:te.elements[le+12]=ke}}const re=j.getMatrix4(),de=new u.Matrix4().getInverse(re,!0);te=new u.Matrix4().multiplyMatrices(te,de),te=new u.Matrix4().multiplyMatrices(re,te),h[h.length-1].symmetries.push(te)}}for(let $=0;$<s.length;$++)!A||i.duplicateAssemblyAtoms&&!i.dontConnectDuplicatedAtoms||We(s[$],i),X(s[$],i.hbondCutoff),Re(h[$].symmetries,s[$],i,h[$].cryst),i.duplicateAssemblyAtoms&&!i.dontConnectDuplicatedAtoms&&A&&We(s[$],i);return s}let He={"C.1":"C",C1:"C","C.2":"C",C2:"C","C.3":"C",C3:"C","C.ar":"C",Car:"C","C.cat":"C",Ccat:"C","H.spc":"H",Hspc:"H","H.t3p":"H",Ht3p:"H","N.1":"N",N1:"N","N.2":"N",N2:"N","N.3":"N",N3:"N","N.4":"N",N4:"N","N.am":"N",Nam:"N","N.ar":"N",Nar:"N","N.p13":"N",Np13:"N","O.2":"O",O2:"O","O.3":"O",O3:"O","O.co2":"O",Oco2:"O","O.spc":"O",Ospc:"O","O.t3p":"O",Ot3p:"O","P.3":"P",P3:"P","S.2":"S",S2:"S","S.3":"S",S3:"S","S.o":"S",So:"S","S.o2":"S",So2:"S"};function Ue(ae,i){var s=[[]],l=!1;i.keepH!==void 0&&(l=!i.keepH);var h=ae.search(/@<TRIPOS>MOLECULE/),A=ae.search(/@<TRIPOS>ATOM/);if(h==-1||A==-1)return s;for(var g=ae.substring(h).split(/\r?\n|\r/);g.length>0;){var E=[],M=g[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),S=parseInt(M[0]),R=0;M.length>1&&(R=parseInt(M[1]));var O,$=4;for(O=3;O<g.length;O++)if(g[O]=="@<TRIPOS>ATOM"){$=O+1;break}var G=s[s.length-1].length,j=G+S;for(O=G;O<j;O++){var W={},H=(M=g[$++].replace(/^\s+/,"").replace(/\s+/g," ").split(" "))[5];if(H=He[H]!==void 0?He[H]:(H=H.split(".")[0])[0].toUpperCase()+H.substring(1).toLowerCase(),W.atom=M[1],W.elem=H,!(W.elem=="H"&&l)){var Y=s[s.length-1].length,te=parseInt(M[0]);W.serial=te,W.x=parseFloat(M[2]),W.y=parseFloat(M[3]),W.z=parseFloat(M[4]),W.atom=M[5];var re=parseFloat(M[8]);W.index=Y,W.bonds=[],W.bondOrder=[],W.properties={charge:re,partialCharge:re},E[te]=Y,s[s.length-1].push(W)}}for(var de=!1;$<g.length;)if(g[$++]=="@<TRIPOS>BOND"){de=!0;break}if(de&&R)for(O=0;O<R;O++){M=g[$++].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");var le=parseInt(M[1]),ye=s[s.length-1][E[le]],Pe=parseInt(M[2]),Te=s[s.length-1][E[Pe]],ke=parseInt(M[3]);isNaN(ke)&&(ke=1),ye!==void 0&&Te!==void 0&&(ye.bonds.push(E[Pe]),ye.bondOrder.push(ke),Te.bonds.push(E[le]),Te.bondOrder.push(ke))}if(!i.multimodel)break;i.onemol||s.push([]),g.splice(0,$),ae=g.join(`
`)}return s}var Ie=a(40);function rt(ae,i){let s=ae.replace(/ /g,"");return s.length>0&&s[0]==="H"&&s!=="Hg"&&s!=="He"&&s!=="Hf"&&s!=="Hs"&&s!=="Ho"&&(s="H"),s.length>1&&(s=s[0].toUpperCase()+s.substring(1).toLowerCase(),Ie.bondTable[s]===void 0?s=s[0]:i&&(s==="Ca"||s==="Cd")&&(s="C")),s}function st(ae){for(const i in ae)return!1;return!0}function at(ae,i,s){const l=[],h=i.assignBonds===void 0||i.assignBonds,A=!i.keepH,g=!!i.noSecondaryStructure,E=!i.noComputeSecondaryStructure,M=!i.doAssembly,S=i.altLoc?i.altLoc:"A",R={symmetries:[],cryst:void 0};let O,$=[];const G=[];let j;const W={};for(let H=0;H<ae.length;H++){j=ae[H].replace(/^\s*/,"");const Y=j.substring(0,6);let te,re,de;if(Y.indexOf("END")===0){if($=ae.slice(H+1),Y==="END")for(const le in s)s.hasOwnProperty(le)&&delete s[le];break}if(Y==="ATOM  "||Y==="HETATM"){let le,ye,Pe,Te,ke,we,Ge,Je,tt,Ye,ut,ft;if(ut=j.substring(16,17),ut!==" "&&ut!==S&&S!=="*"||(Ye=parseInt(j.substring(6,11)),O=j.substring(12,16).replace(/ /g,""),le=j.substring(17,20).replace(/ /g,""),ye=j.substring(21,22),Pe=parseInt(j.substring(22,26)),Te=j.substring(26,27),ke=parseFloat(j.substring(30,38)),we=parseFloat(j.substring(38,46)),Ge=parseFloat(j.substring(46,54)),ft=parseFloat(j.substring(60,68)),tt=j.substring(76,78).replace(/ /g,""),tt=tt===""||Ie.bondTable[tt]===void 0?rt(j.substring(12,14),j[0]=="A"):tt[0].toUpperCase()+tt.substring(1).toLowerCase(),tt==="H"&&A))continue;Je=Y[0]=="H",G[Ye]=l.length,l.push({resn:le,x:ke,y:we,z:Ge,elem:tt,hetflag:Je,altLoc:ut,chain:ye,resi:Pe,icode:Te,rescode:Pe+(Te!==" "?"^"+Te:""),serial:Ye,atom:O,bonds:[],ss:"c",bondOrder:[],properties:{},b:ft,pdbline:j})}else if(Y==="SHEET "){te=j.substring(21,22),re=parseInt(j.substring(22,26)),de=parseInt(j.substring(33,37)),te in s||(s[te]={}),s[te][re]="s1";for(let le=re+1;le<de;le++)s[te][le]="s";s[te][de]="s2"}else if(Y==="CONECT"){const le=G[parseInt(j.substring(6,11))],ye=l[le],Pe=[11,16,21,26];for(let Te=0;Te<4;Te++){const ke=G[parseInt(j.substring(Pe[Te],Pe[Te]+5))];let we=le+":"+ke;const Ge=l[ke];if(ye!==void 0&&Ge!==void 0)if(W[we]){W[we]+=1;for(let Je=0;Je<ye.bonds.length;Je++)if(ye.bonds[Je]==ke){const tt=W[we];ye.bondOrder[Je]=tt>=4?1:tt}}else W[we]=1,ye.bonds.length!=0&&ye.bonds[ye.bonds.length-1]===ke||(ye.bonds.push(ke),ye.bondOrder.push(1))}}else if(Y==="HELIX "){te=j.substring(19,20),re=parseInt(j.substring(21,25)),de=parseInt(j.substring(33,37)),te in s||(s[te]={}),s[te][re]="h1";for(let le=re+1;le<de;le++)s[te][le]="h";s[te][de]="h2"}else if(M||Y!=="REMARK"||j.substring(13,18)!=="BIOMT"){if(Y==="CRYST1"){let le,ye,Pe,Te,ke,we;le=parseFloat(j.substring(7,15)),ye=parseFloat(j.substring(16,24)),Pe=parseFloat(j.substring(25,33)),Te=parseFloat(j.substring(34,40)),ke=parseFloat(j.substring(41,47)),we=parseFloat(j.substring(48,54)),R.cryst={a:le,b:ye,c:Pe,alpha:Te,beta:ke,gamma:we}}else if(Y==="ANISOU"){const le=l[G[parseInt(j.substring(6,11))]];if(le){const ye=j.substring(30).trim().split(/\s+/),Pe={u11:parseInt(ye[0]),u22:parseInt(ye[1]),u33:parseInt(ye[2]),u12:parseInt(ye[3]),u13:parseInt(ye[4]),u23:parseInt(ye[5])};le.uMat=Pe}}}else{let le,ye=new u.Matrix4;for(le=1;le<=3;le++)if(j=ae[H].replace(/^\s*/,""),parseInt(j.substring(18,19))==le)ye.elements[le-1]=parseFloat(j.substring(23,33)),ye.elements[le-1+4]=parseFloat(j.substring(33,43)),ye.elements[le-1+8]=parseFloat(j.substring(43,53)),ye.elements[le-1+12]=parseFloat(j.substring(53)),H++;else for(;j.substring(13,18)==="BIOMT";)H++,j=ae[H].replace(/^\s*/,"");ye.elements[3]=0,ye.elements[7]=0,ye.elements[11]=0,ye.elements[15]=1,R.symmetries.push(ye),H--}}if((function(H,Y){for(let te=0,re=H.length;te<re;te++){const de=H[te];for(let le=0;le<de.bonds.length;le++){const ye=H[de.bonds[le]],Pe=Y[de.serial];ye&&Pe&&ye.bonds.indexOf(Pe)<0&&(ye.bonds.push(Pe),ye.bondOrder.push(de.bondOrder[le]))}}})(l,G),h&&We(l,i),M||Re(R.symmetries,l,i,R.cryst),E&&!g&&X(l,i.hbondCutoff),!st(s))for(let H=0;H<l.length;H++){const Y=l[H];if(Y!==void 0&&Y.chain in s&&Y.resi in s[Y.chain]){const te=s[Y.chain][Y.resi];Y.ss=te[0],te.length>1&&(te[1]=="1"?Y.ssbegin=!0:te[1]=="2"&&(Y.ssend=!0))}}return[l,R,$]}function Ft(ae,i){i=i||{};var s=[],l={};s.modelData=[];for(var h=ae.split(/\r?\n|\r/);h.length>0;){var A=at(h,i,l),g=A[0],E=A[1];if(h=A[2],g.length!=0){if(i.multimodel&&i.onemol&&s.length>0)for(var M=s[0].length,S=0;S<g.length;S++){var R=g[S];R.index=S;for(var O=0;O<R.bonds.length;O++)R.bonds[O]+=M;s[0].push(R)}else s.modelData.push(E),s.push(g);if(!i.multimodel)break}}return s}function Et(ae,i){var s=[[]],l=!i.noSecondaryStructure;s.modelData=[{symmetries:[]}];var h,A=[],g=ae.split(/\r?\n|\r/);for(let de=0;de<g.length;de++){var E=(h=g[de].replace(/^\s*/,"")).substring(0,6);if(E.indexOf("END")==0){if(i.multimodel){i.onemol||s.push([]);continue}break}if(E=="ATOM  "||E=="HETATM"){var M;let le=parseInt(h.substring(6,11)),ye=h.substring(12,16).replace(/ /g,""),Pe=h.substring(17,20).trim(),Te=h.substring(21,22),ke=parseInt(h.substring(22,26));var S=h.substring(30).trim().split(/\s+/),R=parseFloat(S[0]),O=parseFloat(S[1]),$=parseFloat(S[2]),G=parseFloat(S[3]),j=parseFloat(S[4]),W=ye[0];ye.length>1&&ye[1].toUpperCase()!=ye[1]&&(W=ye.substring(0,2)),M=h[0]=="H",A[le]=s[s.length-1].length,s[s.length-1].push({resn:Pe,x:R,y:O,z:$,elem:W,hetflag:M,chain:Te,resi:ke,serial:le,atom:ye,bonds:[],ss:"c",bondOrder:[],properties:{charge:G,partialCharge:G,radius:j},pdbline:h})}else if(E=="CONECT"){var H=parseInt(h.substring(6,11)),Y=s[s.length-1][A[H]];for(let le=0;le<4;le++){var te=parseInt(h.substring([11,16,21,26][le],[11,16,21,26][le]+5)),re=s[s.length-1][A[te]];Y!==void 0&&re!==void 0&&(Y.bonds.push(A[te]),Y.bondOrder.push(1))}}}for(let de=0;de<s.length;de++)We(s[de],i),l&&X(s[de],i.hbondCutoff);return s}var or=a(471),ar=function(ae){return String.fromCharCode.apply(null,ae).replace(/\0/g,"")},kr=function(ae){return ae==0||ae==2||ae==4?"h":ae==3?"s":"c"};let Ar=new Set(["D-SACCHARIDE","D-SACCHARIDE 1,4 AND 1,4 LINKING","D-SACCHARIDE 1,4 AND 1,6 LINKING","L-SACCHARIDE","L-SACCHARIDE 1,4 AND 1,4 LINKING","L-SACCHARIDE 1,4 AND 1,6 LINKING","NON-POLYMER","OTHER","PEPTIDE-LIKE","SACCHARIDE"]);function pr(ae,i){var s=!i.keepH,l=i.altLoc?i.altLoc:"A",h=!!i.noSecondaryStructure,A=!i.noComputeSecondaryStructure,g=!i.doAssembly,E=i.assemblyIndex?i.assemblyIndex:0;ae=typeof ae=="string"?(0,w.base64ToArray)(ae):new Uint8Array(ae);var M,S,R,O,$,G,j=or.decode(ae),W=[[]],H=W.modelData=[],Y=0,te=0,re=0,de=j.secStructList,le=j.bFactorList,ye=j.altLocList,Pe=j.occupancyList,Te=j.bondAtomList,ke=j.bondOrderList,we=j.numModels;if(we==0)return W;i.multimodel||(we=1);var Ge=[];if(!g&&j.bioAssemblyList&&j.bioAssemblyList.length>0){var Je=j.bioAssemblyList[E].transformList;for(M=0,G=Je.length;M<G;M++){var tt=new u.Matrix4(Je[M].matrix);tt.transpose(),Ge.push(tt)}}var Ye=null;if(j.unitCell){var ut=j.unitCell;Ye={a:ut[0],b:ut[1],c:ut[2],alpha:ut[3],beta:ut[4],gamma:ut[5]}}let ft=[];j.entityList.forEach(q=>{q.chainIndexList.forEach(y=>{ft[y]=q.type=="polymer"})});var Qe=0;for($=0;$<we;$++){var pt=j.chainsPerModel[$],Be=W[W.length-1],et=[];for(H.push({symmetries:Ge,cryst:Ye}),M=0;M<pt;++M){var St=j.groupsPerChain[Y],ot=ar(j.chainIdList.subarray(4*Y,4*Y+4));j.chainNameList&&(ot=ar(j.chainNameList.subarray(4*Y,4*Y+4)));var wt=te,At="";for(S=0;S<St;++S){var it=j.groupList[j.groupTypeList[te]],Rt=it.atomNameList.length,Ht=0,kt=!1,ct=!1;if(de){Ht=de[te];var Jt=kr(Ht);te!=0&&Jt==At||(kt=!0),At=Jt;var Nt=te+1;(Nt>=de.length||kr(de[Nt]!=Jt))&&(ct=!0)}var qt=j.groupIdList[te],Vt=it.groupName;let q=it.chemCompType;var Xt=re;let y=Ar.has(q)||!ft[Y];for(R=0;R<Rt;++R){var yr=it.elementList[R];if(s&&yr=="H")re+=1;else{var Fr="";le&&(Fr=le[re]);var Tr="";ye&&ye[re]&&(Tr=String.fromCharCode(ye[re]));var ii="";if(Pe&&(ii=Pe[re]),Tr==""||Tr==l||l=="*"){var Wr=j.atomIdList[re],br=it.atomNameList[R],$r=0;it.atomChargeList&&($r=it.atomChargeList[R]);var ci=j.xCoordList[re],ni=j.yCoordList[re],hi=j.zCoordList[re];et[re]=Be.length,Be.push({resn:Vt,x:ci,y:ni,z:hi,elem:yr,hetflag:y,chain:ot,resi:qt,icode:Tr,rescode:qt+(Tr!=" "?"^"+Tr:""),serial:Wr,altLoc:Tr,index:re,atom:br,bonds:[],ss:kr(Ht),ssbegin:kt,ssend:ct,bondOrder:[],properties:{charge:$r,occupancy:ii},b:Fr}),re+=1}else re+=1}}var zi=it.bondAtomList;for(R=0,O=it.bondOrderList.length;R<O;++R){var xi=Xt+zi[2*R],Ii=Xt+zi[2*R+1],Hr=it.bondOrderList[R],Xr=et[xi],qr=et[Ii],ei=Be[Xr],f=Be[qr];ei&&f&&(ei.bonds.push(qr),ei.bondOrder.push(Hr),f.bonds.push(Xr),f.bondOrder.push(Hr))}te+=1}for(te=wt,S=0;S<St;++S)te+=1;Y+=1}if(Te)for(let q=Qe,y=Te.length;q<y;q+=2){let be=Te[q],_e=Te[q+1],ve=ke?ke[q/2]:1;if(be>=re){Qe=q;break}let Xe=et[be],ze=et[_e],gt=Be[Xe],Ne=Be[ze];gt&&Ne&&(gt.bonds.push(ze),gt.bondOrder.push(ve),Ne.bonds.push(Xe),Ne.bondOrder.push(ve))}i.multimodel&&(i.onemol||W.push([]))}if(!g)for(let q=0;q<W.length;q++)Re(H[q].symmetries,W[q],i,H[q].cryst);return A&&!h&&X(W,i.hbondCutoff),W}function vr(ae){var i,s=[],l=0,h=ae.split(/\r?\n|\r/);if(!(h.length>0&&h[0].includes("VERSION")))return[];{var A=h.filter(function(j){return j.includes("POINTERS")||j.includes("ATOM_NAME")||j.includes("CHARGE")||j.includes("RADII")||j.includes("BONDS_INC_HYDROGEN")||j.includes("BONDS_WITHOUT_HYDROGEN")||j.includes("RESIDUE_LABEL")||j.includes("RESIDUE_POINTER")}),g=O("POINTERS");if(g==-1)return[];var E=$(g),M=parseInt(h[g+1].slice(0,E[1]));let G=parseInt(h[g+2].slice(E[1],E[0]+E[1]));if(isNaN(M)||M<=0)return[];if((g=O("ATOM_NAME"))==-1)return[];var S=(E=$(g))[0];for(let j=0;j<M/E[0];j++){j==parseInt(M/E[0])&&(S=M%E[0]);for(let W=0;W<S;W++){let H={},Y={charge:"",radii:""};H.serial=l,H.x=0,H.y=0,H.z=0,H.atom=h[g+1].slice(E[1]*W,E[1]*(W+1)).trim(),H.elem=h[g+1].slice(E[1]*W,E[1]*W+1).trim(),H.properties=Y,H.bonds=[],H.bondOrder=[],H.index=s.length,s.push(H),l++}g++}if((g=O("CHARGE"))!=-1){l=0,S=(E=$(g))[0];for(let j=0;j<M/E[0];j++){j==parseInt(M/E[0])&&(S=M%E[0]);for(let W=0;W<S;W++)s[l].properties.charge=parseFloat(h[g+1].slice(E[1]*W,E[1]*(W+1))),l++;g++}}var R=[];if((g=O("RESIDUE_POINTER"))!=-1){S=(E=$(g))[0],g+=1;for(let j=0;j<G/E[0];j++){j==parseInt(G/E[0])&&(S=G%E[0]);for(let W=0;W<S;W++)R.push(parseInt(h[g].slice(E[1]*W,E[1]*(W+1))));g++}if((g=O("RESIDUE_LABEL"))!=-1){let j=[];S=(E=$(g))[0],g+=1;for(let te=0;te<G/E[0];te++){te==parseInt(G/E[0])&&(S=G%E[0]);for(let re=0;re<S;re++)j.push(h[g].slice(E[1]*re,E[1]*(re+1)).trim());g++}let W=0,H=0,Y="";R.push(s.length+1);for(let te=0;te<s.length;te++)te+1>=R[W]&&(Y=j[W],W+=1,H+=1),s[te].resi=H,s[te].resn=Y}}if((g=O("RADII"))!=-1){l=0,S=(E=$(g))[0];for(let j=0;j<M/E[0];j++){j==parseInt(M/E[0])&&(S=M%E[0]);for(let W=0;W<S;W++)s[l].properties.radii=parseFloat(h[g+1].slice(E[1]*W,E[1]*(W+1))),l++;g++}}if((g=O("BONDS_WITHOUT_HYDROGEN"))!=-1)for(l=0,S=(E=$(g))[0],g+=1;!h[g].match(/^%FLAG/);){h[g+1].match(/^%FLAG/)&&(S=M%E[0]);for(let j=0;j<S;j++)l%3==0?i=parseInt(h[g].slice(E[1]*j,E[1]*(j+1))/3):l%3==1&&(s[i].bonds.push(parseInt(h[g].slice(E[1]*j,E[1]*(j+1))/3)),s[i].bondOrder.push(1)),l++;g++}if((g=O("BONDS_INC_HYDROGEN"))!=-1)for(l=0,S=(E=$(g))[0],g+=1;!h[g].match(/^%FLAG/);){h[g+1].match(/^%FLAG/)&&(S=M%E[0]);for(let j=0;j<S;j++)l%3==0?i=parseInt(h[g].slice(E[1]*j,E[1]*(j+1))/3):l%3==1&&(s[i].bonds.push(parseInt(h[g].slice(E[1]*j,E[1]*(j+1))/3)),s[i].bonds.push(1)),l++;g++}}function O(G){var j=h.indexOf(A.filter(function(W){return W.includes(G)})[0]);if(Number.isInteger(j)&&j>0){for(;!h[j].includes("FORMAT");)j++;return j}return-1}function $(G){var j=h[G].match(/\((\d*)\S*/),W=h[G].match(/[a-zA-Z](\d*)\)\s*/);return W==null&&(W=h[G].match(/[a-zA-Z](\d*)\.\d*\)\s*/)),[parseInt(j[1]),parseInt(W[1])]}return[s]}function xr(ae,i){const s=[],l=ae.split(/\r?\n|\r/);for(;l.length>0;){const h=parseInt(l[1]);if(l.length<3||isNaN(h)||h<=0||l.length<h+3)break;const A=[];s.push(A);let g=2;const E=A.length,M=E+h;for(let S=E;S<M;S++){const R=l[g++],O={};O.serial=S,O.atom=R.slice(10,15).trim(),O.elem=rt(O.atom,!0),O.x=10*parseFloat(R.slice(20,28)),O.y=10*parseFloat(R.slice(28,36)),O.z=10*parseFloat(R.slice(36,44)),O.resi=parseInt(R.slice(0,5)),O.resn=R.slice(5,10).trim(),O.bonds=[],O.bondOrder=[],O.properties={},R.length>44&&(O.dx=10*parseFloat(R.slice(44,52)),O.dy=10*parseFloat(R.slice(52,60)),O.dz=10*parseFloat(R.slice(60,68))),A[S]=O}if(l.length<=g+3){const S=l[g++].trim().split(/\s+/);if(S.length===3){for(let R=0;R<3;R++)S[R]=(10*parseFloat(S[R])).toString();s.box=S}}l.splice(0,++g)}for(let h=0;h<s.length;h++)We(s[h],i);return s}const fi={id:"serial",type:"atom",element:"elem",q:"charge",radius:"radius",x:"x",xu:"x",xs:"x",xsu:"x",y:"y",yu:"y",ys:"y",ysu:"y",z:"z",zu:"z",zs:"z",zsu:"z"};function Rr(ae,i){const s=[],l=ae.split(/\r?\n|\r/);let h=0,A=0,g=0;for(;g<l.length-9;){for(var E=g;E<l.length;E++)if(l[E].match(/ITEM: NUMBER OF ATOMS/)&&(A=parseInt(l[E+1])),l[E].match(/ITEM: ATOMS/)){h=E+1;break}const M=l[h-1].replace("ITEM: ATOMS ","").split(" ");s.push([]);for(let S=h;S<h+A;S++){const R={},O={},$=l[S].split(" ");for(let G=0;G<$.length;G++){const j=fi[M[G]];j!==void 0&&(j==="serial"?R[j]=parseInt($[G]):j==="x"||j==="y"||j==="z"?R[j]=parseFloat($[G]):j==="charge"||j==="radius"?O[j]=parseFloat($[G]):R[j]=$[G]),R.properties=O,R.bonds=[],R.bondOrder=[]}s[s.length-1][S-h]=R}g=h+A-1}if(i.assignBonds)for(let M=0;M<s.length;M++)(0,ue.assignBonds)(s[M],i);return s}var Ir;(function(ae){(function(i){i[i.Int8=1]="Int8",i[i.Int16=2]="Int16",i[i.Int32=3]="Int32",i[i.Uint8=4]="Uint8",i[i.Uint16=5]="Uint16",i[i.Uint32=6]="Uint32"})(ae.IntDataType||(ae.IntDataType={})),(function(i){i[i.Float32=32]="Float32",i[i.Float64=33]="Float64"})(ae.FloatDataType||(ae.FloatDataType={})),ae.getDataType=function(i){let s;return s=i instanceof Int8Array?ae.IntDataType.Int8:i instanceof Int16Array?ae.IntDataType.Int16:i instanceof Int32Array?ae.IntDataType.Int32:i instanceof Uint8Array?ae.IntDataType.Uint8:i instanceof Uint16Array?ae.IntDataType.Uint16:i instanceof Uint32Array?ae.IntDataType.Uint32:i instanceof Float32Array?ae.FloatDataType.Float32:i instanceof Float64Array?ae.FloatDataType.Float64:ae.IntDataType.Int32,s},ae.isSignedIntegerDataType=function(i){if(i instanceof Int8Array||i instanceof Int16Array||i instanceof Int32Array)return!0;for(let s=0,l=i.length;s<l;s++)if(s<0)return!1;return!0}})(Ir||(Ir={}));const Di=new Uint16Array(new Uint8Array([18,52]).buffer)[0]===13330;function wi(ae){let i=ae.data;for(let s=ae.encoding.length-1;s>=0;s--)i=Hi(i,ae.encoding[s]);return i}function Hi(ae,i){switch(i.kind){case"ByteArray":switch(i.type){case Ir.IntDataType.Uint8:return ae;case Ir.IntDataType.Int8:return(function(s){return new Int8Array(s.buffer,s.byteOffset)})(ae);case Ir.IntDataType.Int16:return(function(s){return Oe(s,2,Int16Array)})(ae);case Ir.IntDataType.Uint16:return(function(s){return Oe(s,2,Uint16Array)})(ae);case Ir.IntDataType.Int32:return(function(s){return Oe(s,4,Int32Array)})(ae);case Ir.IntDataType.Uint32:return(function(s){return Oe(s,4,Uint32Array)})(ae);case Ir.FloatDataType.Float32:return(function(s){return Oe(s,4,Float32Array)})(ae);case Ir.FloatDataType.Float64:return(function(s){return Oe(s,8,Float64Array)})(ae);default:throw new Error("unreachable")}case"FixedPoint":return(function(s,l){const h=s.length,A=Se(l.srcType,h),g=1/l.factor;for(let E=0;E<h;E++)A[E]=g*s[E];return A})(ae,i);case"IntervalQuantization":return(function(s,l){const h=s.length,A=Se(l.srcType,h),g=(l.max-l.min)/(l.numSteps-1),E=l.min;for(let M=0;M<h;M++)A[M]=E+g*s[M];return A})(ae,i);case"RunLength":return(function(s,l){const h=pe(l.srcType,l.srcSize);let A=0;for(let g=0,E=s.length;g<E;g+=2){const M=s[g],S=s[g+1];for(let R=0;R<S;++R)h[A++]=M}return h})(ae,i);case"Delta":return(function(s,l){const h=s.length,A=pe(l.srcType,h);if(!h)return s;A[0]=s[0]+(0|l.origin);for(let g=1;g<h;++g)A[g]=s[g]+A[g-1];return A})(ae,i);case"IntegerPacking":return(function(s,l){return s.length===l.srcSize?s:l.isUnsigned?(function(h,A){const g=A.byteCount===1?255:65535,E=h.length,M=new Int32Array(A.srcSize);let S=0,R=0;for(;S<E;){let O=0,$=h[S];for(;$===g;)O+=$,S++,$=h[S];O+=$,M[R]=O,S++,R++}return M})(s,l):(function(h,A){const g=A.byteCount===1?127:32767,E=-g-1,M=h.length,S=new Int32Array(A.srcSize);let R=0,O=0;for(;R<M;){let $=0,G=h[R];for(;G===g||G===E;)$+=G,R++,G=h[R];$+=G,S[O]=$,R++,O++}return S})(s,l)})(ae,i);case"StringArray":return(function(s,l){const h=wi({encoding:l.offsetEncoding,data:l.offsets}),A=wi({encoding:l.dataEncoding,data:s}),g=l.stringData,E=new Array(h.length);E[0]="";for(let R=1,O=h.length;R<O;R++)E[R]=g.substring(h[R-1],h[R]);let M=0;const S=new Array(A.length);for(let R=0,O=A.length;R<O;R++)S[M++]=E[A[R]+1];return S})(ae,i)}}function pe(ae,i){switch(ae){case Ir.IntDataType.Int8:return new Int8Array(i);case Ir.IntDataType.Int16:return new Int16Array(i);case Ir.IntDataType.Int32:return new Int32Array(i);case Ir.IntDataType.Uint8:return new Uint8Array(i);case Ir.IntDataType.Uint16:return new Uint16Array(i);case Ir.IntDataType.Uint32:return new Uint32Array(i);default:return new Int32Array(i)}}function Se(ae,i){switch(ae){case Ir.FloatDataType.Float32:return new Float32Array(i);case Ir.FloatDataType.Float64:default:return new Float64Array(i)}}function Oe(ae,i,s){return ae.byteOffset==0&&ae.byteLength==ae.buffer.byteLength||(ae=new Uint8Array(ae)),new s(Di?ae.buffer:(function(l,h){const A=new ArrayBuffer(l.length),g=new Uint8Array(A);for(let E=0,M=l.length;E<M;E+=h)for(let S=0;S<h;S++)g[E+h-S-1]=l[E+S];return A})(ae,i))}function dt(ae){const i=Object.create(null),s=Object.create(null);for(const l of ae.columns)i[l.name]=l;return{rowCount:ae.rowCount,name:ae.name.substring(1),fieldNames:ae.columns.map(l=>l.name),getField(l){const h=i[l];if(h)return s[l]||(s[l]=wi(h.data)),s[l]}}}var nt=a(471);class zt{constructor(i){if(this.C={},i){let s=i.getField("comp_id"),l=i.getField("atom_id_1"),h=i.getField("atom_id_2"),A=i.getField("value_order");for(let g=0;g<s.length;g++){let E=s[g],M=l[g],S=h[g],R=A[g],O=1;R=="doub"?O=2:R=="trip"&&(O=3),this.C[E]==null&&(this.C[E]={}),this.C[E][M]==null&&(this.C[E][M]={}),this.C[E][S]==null&&(this.C[E][S]={}),this.C[E][M][S]=O,this.C[E][S][M]=O}}}order(i,s,l){return this.C[i]!==void 0&&this.C[i][s]!==void 0&&this.C[i][s][l]!==void 0?this.C[i][s][l]:0}}class ht{constructor(i){if(this.C=[],i){let s=i.getField("conn_type_id"),l=i.getField("ptnr1_label_asym_id"),h=i.getField("ptnr1_label_seq_id"),A=i.getField("ptnr1_label_comp_id"),g=i.getField("ptnr1_label_atom_id"),E=i.getField("ptnr2_label_asym_id"),M=i.getField("ptnr2_label_seq_id"),S=i.getField("ptnr2_label_comp_id"),R=i.getField("ptnr2_label_atom_id"),O=i.getField("pdbx_value_order");for(let $=0;$<s.length;$++)if(s[$]=="disulf"||s[$]=="covale"){let G=O?O[$]==""?1:parseInt(O[$]):1;this.C.push([[l[$],h[$],A[$],g[$]],[E[$],M[$],S[$],R[$]],G])}}}}class Ot{constructor(){this.R={}}add(i){this.R[i.lchain]==null&&(this.R[i.lchain]={}),this.R[i.lchain][i.lresi]==null&&(this.R[i.lchain][i.lresi]={}),this.R[i.lchain][i.lresi][i.lresn]==null&&(this.R[i.lchain][i.lresi][i.lresn]=[]),this.R[i.lchain][i.lresi][i.lresn].push(i),this.R[i.lchain][i.lresi][i.lresn][i.atom]=i}geta([i,s,l,h]){if(this.R[i]!==void 0&&this.R[i][s]!==void 0&&this.R[i][s][l]!==void 0)return this.R[i][s][l][h]}setBonds(i,s){for(let l in this.R)for(let h in this.R[l])for(let A in this.R[l][h]){let g=this.R[l][h][A];for(let E=0;E<g.length;E++)for(let M=E+1;M<g.length;M++){let S=g[E],R=g[M],O=i.order(A,S.atom,R.atom);S.altLoc!=R.altLoc&&S.altLoc!=""&&R.altLoc!=""&&(O=0),O>0&&(S.bonds.push(R.index),R.bonds.push(S.index),S.bondOrder.push(O),R.bondOrder.push(O))}}for(let l of s.C){let h=l[0],A=l[1],g=l[2],E=this.geta(h),M=this.geta(A);E!=null&&M!=null&&(E.bonds.push(M.index),M.bonds.push(E.index),E.bondOrder.push(g),M.bondOrder.push(g))}}}function Ut(ae,i){var s=!i.keepH,l=i.altLoc?i.altLoc:"A",h=!i.noComputeSecondaryStructure;const A=!i.doAssembly,g=i.assignBonds===void 0||i.assignBonds;if(typeof ae=="string")try{ae=(0,w.base64ToArray)(ae)}catch{ae=new TextEncoder().encode(ae)}else ae=new Uint8Array(ae);var E=nt.decodeMsgpack(ae);E==31&&(ae=(0,w.inflateString)(ae,!1),E=nt.decodeMsgpack(ae));var M=[],S=M.modelData=[],R=E.dataBlocks.length;if(R==0)return M;i.multimodel||(R=1);for(let O=0;O<R;O++){let $=M.length;const G=[];S.push({symmetries:[]}),M.push([]);const j=E.dataBlocks[O],W=Object.create(null);for(const kt of j.categories)W[kt.name.substr(1)]=dt(kt);let H={},Y=W.struct_conf;if(Y){let kt=Y.getField("conf_type_id"),ct=Y.getField("beg_label_asym_id"),Jt=Y.getField("beg_label_seq_id"),Nt=Y.getField("end_label_seq_id");for(let qt=0;qt<kt.length;qt++)if(kt[qt].startsWith("H")){let Vt=ct[qt],Xt=Jt[qt],yr=Nt[qt];Vt in H||(H[Vt]={}),H[Vt][Xt]="h1";for(let Fr=Xt+1;Fr<yr;Fr++)H[Vt][Fr]="h";H[Vt][yr]="h2"}}let te=W.struct_sheet_range;if(te){let kt=te.getField("id"),ct=te.getField("beg_label_asym_id"),Jt=te.getField("beg_label_seq_id"),Nt=te.getField("end_label_seq_id");for(let qt=0;qt<kt.length;qt++){let Vt=ct[qt],Xt=Jt[qt],yr=Nt[qt];Vt in H||(H[Vt]={}),H[Vt][Xt]="s1";for(let Fr=Xt+1;Fr<yr;Fr++)H[Vt][Fr]="s";H[Vt][yr]="s2"}}let re=W.pdbx_struct_oper_list,de=re.getField("id");if(de&&!A){let kt=re.getField("matrix[1][1]"),ct=re.getField("matrix[1][2]"),Jt=re.getField("matrix[1][3]"),Nt=re.getField("matrix[2][1]"),qt=re.getField("matrix[2][2]"),Vt=re.getField("matrix[2][3]"),Xt=re.getField("matrix[3][1]"),yr=re.getField("matrix[3][2]"),Fr=re.getField("matrix[3][3]"),Tr=re.getField("vector[1]"),ii=re.getField("vector[2]"),Wr=re.getField("vector[3]");for(let br=0;br<de.length;br++){const $r=new u.Matrix4(kt[br],ct[br],Jt[br],Tr[br],Nt[br],qt[br],Vt[br],ii[br],Xt[br],yr[br],Fr[br],Wr[br]);S[S.length-1].symmetries.push($r)}}let le=new zt(W.chem_comp_bond),ye=new Ot,Pe=new ht(W.struct_conn),Te=W.atom_site,ke=Te.rowCount,we=Te.getField("group_PDB"),Ge=Te.getField("Cartn_x"),Je=Te.getField("Cartn_y"),tt=Te.getField("Cartn_z"),Ye=Te.getField("auth_asym_id"),ut=Te.getField("label_asym_id"),ft=Te.getField("auth_seq_id"),Qe=Te.getField("label_seq_id"),pt=Te.getField("auth_comp_id"),Be=Te.getField("label_comp_id"),et=Te.getField("auth_atom_id"),St=Te.getField("label_atom_id"),ot=Te.getField("type_symbol"),wt=Te.getField("B_iso_or_equiv"),At=Te.getField("id"),it=Te.getField("label_alt_id"),Rt=Te.getField("pdbx_PDB_model_num"),Ht=Rt?Rt[0]:0;for(let kt=0;kt<ke;kt++){if(we!==void 0&&we[kt]==="TER")continue;if(Rt&&Rt[kt]!=Ht){if(Ht=Rt[kt],!i.multimodel)break;i.onemol||(M.push([]),S.push(S[S.length-1]),Ht=Rt[kt],ye.setBonds(le,Pe),ye=new Ot)}const ct={};ct.x=Ge[kt],ct.y=Je[kt],ct.z=tt[kt],ct.chain=Ye?Ye[kt]:ut?ut[kt]:void 0,ct.lchain=ut?ut[kt]:void 0,ct.resi=ft?ft[kt]:Qe?Qe[kt]:void 0,ct.lresi=Qe?Qe[kt]:void 0,ct.resn=pt?pt[kt].trim():Be?Be[kt].trim():void 0,ct.lresn=Be?Be[kt].trim():void 0,ct.atom=et?et[kt].replace(/"/gm,""):St?St[kt].replace(/"/gm,""):void 0,ct.icode=it?it[kt]:void 0,ct.altLoc=ct.icode,ct.hetflag=!we||we[kt]==="HETA"||we[kt]==="HETATM";let Jt="X";ot&&(Jt=ot[kt].replace(/\(?\+?\d+.*/,"")),ct.elem=Jt[0].toUpperCase()+Jt.substring(1,2).toLowerCase(),wt&&(ct.b=wt[kt]),s&&ct.elem=="H"||ct.altLoc!=""&&ct.altLoc!=l&&l!="*"||(ct.bonds=[],ct.ss="c",ct.serial=At[kt],ct.model=Ht,ct.bondOrder=[],ct.properties={},ct.index=M[M.length-1].length,G[ct.serial]=[M.length,ct.index],M[M.length-1].push(ct),ye.add(ct))}if(ye.setBonds(le,Pe),!st(H))for(let kt=$;kt<M.length;kt++){let ct=M[kt];for(let Jt=0;Jt<ct.length;Jt++){const Nt=ct[Jt];if(Nt!==void 0&&Nt.lchain in H&&Nt.lresi in H[Nt.lchain]){const qt=H[Nt.lchain][Nt.lresi];Nt.ss=qt[0],qt.length>1&&(qt[1]=="1"?Nt.ssbegin=!0:qt[1]=="2"&&(Nt.ssend=!0))}}}i.multimodel&&O<R-1&&(i.onemol||(M.push([]),S.push({symmetries:[]})))}for(let O=0;O<M.length;O++)!g||i.duplicateAssemblyAtoms&&!i.dontConnectDuplicatedAtoms||We(M[O],i),h&&X(M[O],i.hbondCutoff),Re(S[O].symmetries,M[O],i,S[O].cryst),i.duplicateAssemblyAtoms&&!i.dontConnectDuplicatedAtoms&&g&&We(M[O],i);return M}const It={vasp:me.VASP,VASP:me.VASP,cube:Me.CUBE,CUBE:Me.CUBE,xyz:I,XYZ:I,sdf:ce,SDF:ce,json:se,cdjson:se,CDJSON:se,mcif:Ae,cif:Ae,CIF:Ae,mol2:Ue,MOL2:Ue,pdb:Ft,PDB:Ft,pdbqt:Ft,PDBQT:Ft,pqr:Et,PQR:Et,mmtf:pr,MMTF:pr,prmtop:vr,PRMTOP:vr,gro:xr,GRO:xr,lammpstrj:Rr,LAMMPSTRJ:Rr,bcif:Ut,BCIF:Ut};function mr(ae,i="utf8"){return new TextDecoder(i).decode(ae)}const li=new TextEncoder,Ei=(()=>{const ae=new Uint8Array(4);return!((new Uint32Array(ae.buffer)[0]=1)&ae[0])})(),ui={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class gi{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(i=8192,s={}){let l=!1;typeof i=="number"?i=new ArrayBuffer(i):(l=!0,this.lastWrittenByte=i.byteLength);const h=s.offset?s.offset>>>0:0,A=i.byteLength-h;let g=h;(ArrayBuffer.isView(i)||i instanceof gi)&&(i.byteLength!==i.buffer.byteLength&&(g=i.byteOffset+h),i=i.buffer),this.lastWrittenByte=l?A:0,this.buffer=i,this.length=A,this.byteLength=A,this.byteOffset=g,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,g,A),this._mark=0,this._marks=[]}available(i=1){return this.offset+i<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(i=1){return this.offset+=i,this}back(i=1){return this.offset-=i,this}seek(i){return this.offset=i,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const i=this._marks.pop();if(i===void 0)throw new Error("Mark stack empty");return this.seek(i),this}rewind(){return this.offset=0,this}ensureAvailable(i=1){if(!this.available(i)){const s=2*(this.offset+i),l=new Uint8Array(s);l.set(new Uint8Array(this.buffer)),this.buffer=l.buffer,this.length=s,this.byteLength=s,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(i=1){return this.readArray(i,"uint8")}readArray(i,s){const l=ui[s].BYTES_PER_ELEMENT*i,h=this.byteOffset+this.offset,A=this.buffer.slice(h,h+l);if(this.littleEndian===Ei&&s!=="uint8"&&s!=="int8"){const E=new Uint8Array(this.buffer.slice(h,h+l));E.reverse();const M=new ui[s](E.buffer);return this.offset+=l,M.reverse(),M}const g=new ui[s](A);return this.offset+=l,g}readInt16(){const i=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,i}readUint16(){const i=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,i}readInt32(){const i=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,i}readUint32(){const i=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,i}readFloat32(){const i=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,i}readFloat64(){const i=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,i}readBigInt64(){const i=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,i}readBigUint64(){const i=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,i}readChar(){return String.fromCharCode(this.readInt8())}readChars(i=1){let s="";for(let l=0;l<i;l++)s+=this.readChar();return s}readUtf8(i=1){return mr(this.readBytes(i))}decodeText(i=1,s="utf8"){return mr(this.readBytes(i),s)}writeBoolean(i){return this.writeUint8(i?255:0),this}writeInt8(i){return this.ensureAvailable(1),this._data.setInt8(this.offset++,i),this._updateLastWrittenByte(),this}writeUint8(i){return this.ensureAvailable(1),this._data.setUint8(this.offset++,i),this._updateLastWrittenByte(),this}writeByte(i){return this.writeUint8(i)}writeBytes(i){this.ensureAvailable(i.length);for(let s=0;s<i.length;s++)this._data.setUint8(this.offset++,i[s]);return this._updateLastWrittenByte(),this}writeInt16(i){return this.ensureAvailable(2),this._data.setInt16(this.offset,i,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(i){return this.ensureAvailable(2),this._data.setUint16(this.offset,i,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(i){return this.ensureAvailable(4),this._data.setInt32(this.offset,i,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(i){return this.ensureAvailable(4),this._data.setUint32(this.offset,i,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(i){return this.ensureAvailable(4),this._data.setFloat32(this.offset,i,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(i){return this.ensureAvailable(8),this._data.setFloat64(this.offset,i,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(i){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,i,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(i){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,i,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(i){return this.writeUint8(i.charCodeAt(0))}writeChars(i){for(let s=0;s<i.length;s++)this.writeUint8(i.charCodeAt(s));return this}writeUtf8(i){return this.writeBytes((function(s){return li.encode(s)})(i))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}const jr=1,Or=2,Dr=3,rr=4,vi=5,bi=6;function Ki(ae){switch(Number(ae)){case jr:return"byte";case Or:return"char";case Dr:return"short";case rr:return"int";case vi:return"float";case bi:return"double";default:return"undefined"}}function Ci(ae){switch(Number(ae)){case jr:case Or:return 1;case Dr:return 2;case rr:case vi:return 4;case bi:return 8;default:return-1}}function Ni(ae){switch(String(ae)){case"byte":return jr;case"char":return Or;case"short":return Dr;case"int":return rr;case"float":return vi;case"double":return bi;default:return-1}}function Ti(ae,i){if(ae!==1){const s=new Array(ae);for(let l=0;l<ae;l++)s[l]=i();return s}return i()}function pi(ae,i,s){switch(i){case jr:return Array.from(ae.readBytes(s));case Or:return(l=ae.readChars(s)).charCodeAt(l.length-1)===0?l.substring(0,l.length-1):l;case Dr:return Ti(s,ae.readInt16.bind(ae));case rr:return Ti(s,ae.readInt32.bind(ae));case vi:return Ti(s,ae.readFloat32.bind(ae));case bi:return Ti(s,ae.readFloat64.bind(ae));default:throw new Error(`non valid type ${i}`)}var l}function Br(ae,i){if(ae)throw new TypeError(`Not a valid NetCDF v3.x file: ${i}`)}function Yr(ae){ae.offset%4!=0&&ae.skip(4-ae.offset%4)}function Vi(ae){const i=ae.readUint32(),s=ae.readChars(i);return Yr(ae),s}function yi(ae,i){const s={version:i},l={length:ae.readUint32()},h=(function(g){const E={};let M,S;const R=g.readUint32();let O;if(R===0)return Br(g.readUint32()!==0,"wrong empty tag for list of dimensions"),[];{Br(R!==10,"wrong tag for list of dimensions");const $=g.readUint32();O=new Array($);for(let G=0;G<$;G++){const j=Vi(g),W=g.readUint32();W===0&&(M=G,S=j),O[G]={name:j,size:W}}}return M!==void 0&&(E.recordId=M),S!==void 0&&(E.recordName=S),E.dimensions=O,E})(ae);Array.isArray(h)||(l.id=h.recordId,l.name=h.recordName,s.dimensions=h.dimensions),s.globalAttributes=Wi(ae);const A=(function(g,E,M){const S=g.readUint32();let R,O=0;if(S===0)return Br(g.readUint32()!==0,"wrong empty tag for list of variables"),[];{Br(S!==11,"wrong tag for list of variables");const $=g.readUint32();R=new Array($);for(let G=0;G<$;G++){const j=Vi(g),W=g.readUint32(),H=new Array(W);for(let ye=0;ye<W;ye++)H[ye]=g.readUint32();const Y=Wi(g),te=g.readUint32();Br(te<1&&te>6,`non valid type ${te}`);const re=g.readUint32();let de=g.readUint32();M===2&&(Br(de>0,"offsets larger than 4GB not supported"),de=g.readUint32());let le=!1;E!==void 0&&H[0]===E&&(O+=re,le=!0),R[G]={name:j,dimensions:H,attributes:Y,type:Ki(te),size:re,offset:de,record:le}}}return{variables:R,recordStep:O}})(ae,l?.id,i);return Array.isArray(A)||(s.variables=A.variables,l.recordStep=A.recordStep),s.recordDimension=l,s}function Wi(ae){const i=ae.readUint32();let s;if(i===0)return Br(ae.readUint32()!==0,"wrong empty tag for list of attributes"),[];{Br(i!==12,"wrong tag for list of attributes");const l=ae.readUint32();s=new Array(l);for(let h=0;h<l;h++){const A=Vi(ae),g=ae.readUint32();Br(g<1||g>6,`non valid type ${g}`);const E=ae.readUint32(),M=pi(ae,g,E);Yr(ae),s[h]={name:A,type:Ki(g),value:M}}}return s}function tn(){const ae=[];ae.push("DIMENSIONS");for(const s of this.dimensions)ae.push(`  ${s.name.padEnd(30)} = size: ${s.size}`);ae.push(""),ae.push("GLOBAL ATTRIBUTES");for(const s of this.globalAttributes)ae.push(`  ${s.name.padEnd(30)} = ${s.value}`);const i=JSON.parse(JSON.stringify(this.variables));ae.push(""),ae.push("VARIABLES:");for(const s of i){s.value=this.getDataVariable(s);let l=JSON.stringify(s.value);l.length>50&&(l=l.substring(0,50)),isNaN(s.value.length)||(l+=` (length: ${s.value.length})`),ae.push(`  ${s.name.padEnd(30)} = ${l}`)}return ae.join(`
`)}class on{constructor(i){this.toString=tn;const s=new gi(i);s.setBigEndian(),Br(s.readChars(3)!=="CDF","should start with CDF");const l=s.readByte();Br(l>2,"unknown version"),this.header=yi(s,l),this.buffer=s}get version(){return this.header.version===1?"classic format":"64-bit offset format"}get recordDimension(){return this.header.recordDimension}get dimensions(){return this.header.dimensions}get globalAttributes(){return this.header.globalAttributes}getAttribute(i){const s=this.globalAttributes.find(l=>l.name===i);return s?s.value:null}getDataVariableAsString(i){const s=this.getDataVariable(i);return s?s.join(""):null}get variables(){return this.header.variables}getDataVariable(i){let s;if(s=typeof i=="string"?this.header.variables.find(l=>l.name===i):i,s===void 0)throw new Error("Not a valid NetCDF v3.x file: variable not found");return this.buffer.seek(s.offset),s.record?(function(l,h,A){const g=Ni(h.type),E=h.size?h.size/Ci(g):1,M=A.length,S=new Array(M),R=A.recordStep;if(!R)throw new Error("recordDimension.recordStep is undefined");for(let O=0;O<M;O++){const $=l.offset;S[O]=pi(l,g,E),l.seek($+R)}return S})(this.buffer,s,this.header.recordDimension):(function(l,h){const A=Ni(h.type),g=h.size/Ci(A),E=new Array(g);for(let M=0;M<g;M++)E[M]=pi(l,A,1);return E})(this.buffer,s)}dataVariableExists(i){return this.header.variables.find(s=>s.name===i)!==void 0}attributeExists(i){return this.globalAttributes.find(s=>s.name===i)!==void 0}}class ur{static sameObj(i,s){return i&&s?JSON.stringify(i)==JSON.stringify(s):i==s}constructor(i,s,l){this.atoms=[],this.frames=[],this.box=null,this.atomdfs=null,this.id=0,this.hidden=!1,this.molObj=null,this.renderedMolObj=null,this.lastColors=null,this.modelData={},this.modelDatas=null,this.idMatrix=new m.Matrix4,this.dontDuplicateAtoms=!0,this.defaultColor=_.elementColors.defaultColor,this.defaultStickRadius=.25,this.options=s||{},this.viewer=l,this.ElementColors=this.options.defaultcolors?this.options.defaultcolors:_.elementColors.defaultColors,this.defaultSphereRadius=this.options.defaultSphereRadius?this.options.defaultSphereRadius:1.5,this.defaultCartoonQuality=this.options.cartoonQuality?this.options.cartoonQuality:10,this.id=i}getRadiusFromStyle(i,s){var l=this.defaultSphereRadius;if(s.radius!==void 0)l=s.radius;else if(ur.vdwRadii[i.elem])l=ur.vdwRadii[i.elem];else if(i.elem.length>1){let h=i.elem;h=h[0].toUpperCase()+h[1].toLowerCase(),ur.vdwRadii[h]&&(l=ur.vdwRadii[h])}return s.scale!==void 0&&(l*=s.scale),l}drawAtomCross(i,s){if(i.style.cross){var l=i.style.cross;if(!l.hidden){var h=l.linewidth||ur.defaultlineWidth;s[h]||(s[h]=new u.Geometry);var A=s[h].updateGeoGroup(6),g=this.getRadiusFromStyle(i,l),E=[[g,0,0],[-g,0,0],[0,g,0],[0,-g,0],[0,0,g],[0,0,-g]],M=i.clickable||i.hoverable;M&&i.intersectionShape===void 0&&(i.intersectionShape={sphere:[],cylinder:[],line:[]});for(var S=(0,w.getColorFromStyle)(i,l),R=A.vertexArray,O=A.colorArray,$=0;$<6;$++){var G=3*A.vertices;if(A.vertices++,R[G]=i.x+E[$][0],R[G+1]=i.y+E[$][1],R[G+2]=i.z+E[$][2],O[G]=S.r,O[G+1]=S.g,O[G+2]=S.b,M){var j=new m.Vector3(E[$][0],E[$][1],E[$][2]);j.multiplyScalar(.1),j.set(j.x+i.x,j.y+i.y,j.z+i.z),i.intersectionShape.line.push(j)}}}}}getGoodCross(i,s,l,h){for(var A=null,g=-1,E=0,M=i.bonds.length;E<M;E++)if(i.bonds[E]!=s.index){let R=i.bonds[E],O=this.atoms[R],$=new m.Vector3(O.x,O.y,O.z).clone();$.sub(l);let G=$.clone();G.cross(h);var S=G.lengthSq();if(S>g&&(A=G,(g=S)>.1))return A}return A}getSideBondV(i,s,l){var h,A,g,E,M=new m.Vector3(i.x,i.y,i.z),S=new m.Vector3(s.x,s.y,s.z).clone(),R=null;if(S.sub(M),i.bonds.length===1)s.bonds.length===1?(R=S.clone(),Math.abs(R.x)>1e-4?R.y+=1:R.x+=1):(h=(l+1)%s.bonds.length,A=s.bonds[h],(g=this.atoms[A]).index==i.index&&(h=(h+1)%s.bonds.length,A=s.bonds[h],g=this.atoms[A]),(E=new m.Vector3(g.x,g.y,g.z).clone()).sub(M),(R=E.clone()).cross(S));else if((R=this.getGoodCross(i,s,M,S)).lengthSq()<.01){var O=this.getGoodCross(s,i,M,S);O!=null&&(R=O)}return R.lengthSq()<.01&&(R=S.clone(),Math.abs(R.x)>1e-4?R.y+=1:R.x+=1),R.cross(S),R.normalize(),R}addLine(i,s,l,h,A,g){i[l]=h.x,i[l+1]=h.y,i[l+2]=h.z,s[l]=g.r,s[l+1]=g.g,s[l+2]=g.b,i[l+3]=A.x,i[l+4]=A.y,i[l+5]=A.z,s[l+3]=g.r,s[l+4]=g.g,s[l+5]=g.b}drawBondLines(i,s,l){if(i.style.line){var h=i.style.line;if(!h.hidden){var A,g,E,M,S=h.linewidth||ur.defaultlineWidth;l[S]||(l[S]=new u.Geometry);for(var R=l[S].updateGeoGroup(6*i.bonds.length),O=R.vertexArray,$=R.colorArray,G=0;G<i.bonds.length;G++){var j=s[i.bonds[G]];if(j.style.line&&!(i.index>=j.index)){var W=new m.Vector3(i.x,i.y,i.z),H=new m.Vector3(j.x,j.y,j.z),Y=W.clone().add(H).multiplyScalar(.5),te=!1,re=i.clickable||i.hoverable,de=j.clickable||j.hoverable;(re||de)&&(re&&(i.intersectionShape===void 0&&(i.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),i.intersectionShape.line.push(W),i.intersectionShape.line.push(Y)),de&&(j.intersectionShape===void 0&&(j.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),j.intersectionShape.line.push(Y),j.intersectionShape.line.push(H)));var le=(0,w.getColorFromStyle)(i,i.style.line),ye=(0,w.getColorFromStyle)(j,j.style.line);if(i.bondStyles&&i.bondStyles[G]){var Pe=i.bondStyles[G];if(!Pe.iswire)continue;Pe.singleBond&&(te=!0),Pe.color1!==void 0&&(le=_.CC.color(Pe.color1)),Pe.color2!==void 0&&(ye=_.CC.color(Pe.color2))}var Te,ke,we=3*R.vertices;if(i.bondOrder[G]>1&&i.bondOrder[G]<4&&!te){var Ge=this.getSideBondV(i,j,G),Je=H.clone();Je.sub(W),i.bondOrder[G]==2?(Ge.multiplyScalar(.1),(A=W.clone()).add(Ge),(g=W.clone()).sub(Ge),(E=A.clone()).add(Je),(M=g.clone()).add(Je),le==ye?(R.vertices+=4,this.addLine(O,$,we,A,E,le),this.addLine(O,$,we+6,g,M,le)):(R.vertices+=8,Je.multiplyScalar(.5),(Te=A.clone()).add(Je),(ke=g.clone()).add(Je),this.addLine(O,$,we,A,Te,le),this.addLine(O,$,we+6,Te,E,ye),this.addLine(O,$,we+12,g,ke,le),this.addLine(O,$,we+18,ke,M,ye))):i.bondOrder[G]==3&&(Ge.multiplyScalar(.1),(A=W.clone()).add(Ge),(g=W.clone()).sub(Ge),(E=A.clone()).add(Je),(M=g.clone()).add(Je),le==ye?(R.vertices+=6,this.addLine(O,$,we,W,H,le),this.addLine(O,$,we+6,A,E,le),this.addLine(O,$,we+12,g,M,le)):(R.vertices+=12,Je.multiplyScalar(.5),(Te=A.clone()).add(Je),(ke=g.clone()).add(Je),this.addLine(O,$,we,W,Y,le),this.addLine(O,$,we+6,Y,H,ye),this.addLine(O,$,we+12,A,Te,le),this.addLine(O,$,we+18,Te,E,ye),this.addLine(O,$,we+24,g,ke,le),this.addLine(O,$,we+30,ke,M,ye)))}else le==ye?(R.vertices+=2,this.addLine(O,$,we,W,H,le)):(R.vertices+=4,this.addLine(O,$,we,W,Y,le),this.addLine(O,$,we+6,Y,H,ye))}}}}}drawAtomSphere(i,s){if(i.style.sphere){var l=i.style.sphere;if(!l.hidden){var h=(0,w.getColorFromStyle)(i,l),A=this.getRadiusFromStyle(i,l);if((i.clickable===!0||i.hoverable)&&i.intersectionShape!==void 0){var g=new m.Vector3(i.x,i.y,i.z);i.intersectionShape.sphere.push(new v.Sphere(g,A))}p.drawSphere(s,i,A,h)}}}drawAtomClickSphere(i){if(i.style.clicksphere){var s=i.style.clicksphere;if(!s.hidden){var l=this.getRadiusFromStyle(i,s);if((i.clickable===!0||i.hoverable)&&i.intersectionShape!==void 0){var h=new m.Vector3(i.x,i.y,i.z);i.intersectionShape.sphere.push(new v.Sphere(h,l))}}}}drawAtomInstanced(i,s){if(i.style.sphere){var l=i.style.sphere;if(!l.hidden){var h=this.getRadiusFromStyle(i,l),A=(0,w.getColorFromStyle)(i,l),g=s.updateGeoGroup(1),E=g.vertices,M=3*E,S=g.vertexArray,R=g.colorArray,O=g.radiusArray;if(S[M]=i.x,S[M+1]=i.y,S[M+2]=i.z,R[M]=A.r,R[M+1]=A.g,R[M+2]=A.b,O[E]=h,(i.clickable===!0||i.hoverable)&&i.intersectionShape!==void 0){var $=new m.Vector3(i.x,i.y,i.z);i.intersectionShape.sphere.push(new v.Sphere($,h))}g.vertices+=1}}}drawSphereImposter(i,s,l,h){var A,g=i.updateGeoGroup(4),E=g.vertices,M=3*E,S=g.vertexArray,R=g.colorArray;for(A=0;A<4;A++)S[M+3*A]=s.x,S[M+3*A+1]=s.y,S[M+3*A+2]=s.z;var O=g.normalArray;for(A=0;A<4;A++)R[M+3*A]=h.r,R[M+3*A+1]=h.g,R[M+3*A+2]=h.b;O[M+0]=-l,O[M+1]=l,O[M+2]=0,O[M+3]=-l,O[M+4]=-l,O[M+5]=0,O[M+6]=l,O[M+7]=-l,O[M+8]=0,O[M+9]=l,O[M+10]=l,O[M+11]=0,g.vertices+=4;var $=g.faceArray,G=g.faceidx;$[G+0]=E,$[G+1]=E+1,$[G+2]=E+2,$[G+3]=E+2,$[G+4]=E+3,$[G+5]=E,g.faceidx+=6}drawAtomImposter(i,s){if(i.style.sphere){var l=i.style.sphere;if(!l.hidden){var h=this.getRadiusFromStyle(i,l),A=(0,w.getColorFromStyle)(i,l);if((i.clickable===!0||i.hoverable)&&i.intersectionShape!==void 0){var g=new m.Vector3(i.x,i.y,i.z);i.intersectionShape.sphere.push(new v.Sphere(g,h))}this.drawSphereImposter(s,i,h,A)}}}calculateDashes(i,s,l,h,A){var g=Math.sqrt(Math.pow(i.x-s.x,2)+Math.pow(i.y-s.y,2)+Math.pow(i.z-s.z,2));l=Math.max(l,0),A=Math.max(A,0)+2*l,(h=Math.max(h,.001))+A>g&&(h=g,A=0);var E,M=Math.floor((g-h)/(h+A))+1;A=(g-M*h)/M;for(var S=new m.Vector3(i.x,i.y,i.z),R=new m.Vector3((s.x-i.x)/(g/A),(s.y-i.y)/(g/A),(s.z-i.z)/(g/A)),O=new m.Vector3((s.x-i.x)/(g/h),(s.y-i.y)/(g/h),(s.z-i.z)/(g/h)),$=[],G=0;G<M;G++)E=new m.Vector3(S.x+O.x,S.y+O.y,S.z+O.z),$.push({from:S,to:E}),S=new m.Vector3(E.x+R.x,E.y+R.y,E.z+R.z);return $}static drawStickImposter(i,s,l,h,A,g=0,E=0){for(var M=i.updateGeoGroup(4),S=M.vertices,R=3*S,O=M.vertexArray,$=M.colorArray,G=M.radiusArray,j=M.normalArray,W=A.r,H=A.g,Y=A.b,te=function(Pe){var Te=-Pe;return Te==0&&(Te=-1e-4),Te},re=R,de=0;de<4;de++)O[re]=s.x,j[re]=l.x,$[re]=W,O[++re]=s.y,j[re]=l.y,$[re]=H,O[++re]=s.z,j[re]=l.z,$[re]=de<2?Y:te(Y),re++;M.vertices+=4,G[S]=-h,G[S+1]=h,G[S+2]=-h,G[S+3]=h;var le=M.faceArray,ye=M.faceidx;le[ye+0]=S,le[ye+1]=S+1,le[ye+2]=S+2,le[ye+3]=S+2,le[ye+4]=S+3,le[ye+5]=S,M.faceidx+=6}drawBondSticks(i,s,l){var h,A;if(i.style.stick){var g=i.style.stick;if(!g.hidden){var E,M,S,R,O,$,G,j,W,H,Y,te,re,de,le=g.radius||this.defaultStickRadius,ye=g.doubleBondScaling||.4,Pe=g.tripleBondScaling||.25,Te=((h=g.dashedBondConfig)===null||h===void 0?void 0:h.dashLength)||.1,ke=((A=g.dashedBondConfig)===null||A===void 0?void 0:A.gapLength)||.25,we=le,Ge=g.singleBonds||!1,Je=g.dashedBonds||!1,tt=0,Ye=0,ut=(0,w.getColorFromStyle)(i,g);!i.capDrawn&&i.bonds.length<4&&(tt=2);var ft=Wr=>{var br=l.imposter?ur.drawStickImposter:p.drawCylinder;return!Je&&Wr>=1?br:($r,ci,ni,hi,zi,xi=0,Ii=0,Hr=.1,Xr=.25)=>{this.calculateDashes(ci,ni,hi,Hr,Xr).forEach(qr=>{br($r,qr.from,qr.to,hi,zi,xi,Ii)})}};for(S=0;S<i.bonds.length;S++){var Qe=ft(i.bondOrder[S]),pt=s[i.bonds[S]];if(te=re=de=null,i.index<pt.index){var Be=pt.style;if(!Be.stick||Be.stick.hidden)continue;var et=(0,w.getColorFromStyle)(pt,Be.stick);if(we=le,R=Ge,i.bondStyles&&i.bondStyles[S]){if((O=i.bondStyles[S]).iswire)continue;O.radius&&(we=O.radius),O.singleBond&&(R=!0),O.color1!==void 0&&(ut=_.CC.color(O.color1)),O.color2!==void 0&&(et=_.CC.color(O.color2))}var St=new m.Vector3(i.x,i.y,i.z),ot=new m.Vector3(pt.x,pt.y,pt.z);if(i.bondOrder[S]<=1||R||i.bondOrder[S]>3){if(i.bondOrder[S]<1&&(we*=i.bondOrder[S]),!pt.capDrawn&&pt.bonds.length<4&&(Ye=2),ut!=et?(te=new m.Vector3().addVectors(St,ot).multiplyScalar(.5),Qe(l,St,te,we,ut,tt,0,Te,ke),Qe(l,te,ot,we,et,0,Ye,Te,ke)):Qe(l,St,ot,we,ut,tt,Ye,Te,ke),E=i.clickable||i.hoverable,M=pt.clickable||pt.hoverable,E||M){if(te||(te=new m.Vector3().addVectors(St,ot).multiplyScalar(.5)),E){var wt=new v.Cylinder(St,te,we),At=new v.Sphere(St,we);i.intersectionShape.cylinder.push(wt),i.intersectionShape.sphere.push(At)}if(M){var it=new v.Cylinder(ot,te,we),Rt=new v.Sphere(ot,we);pt.intersectionShape.cylinder.push(it),pt.intersectionShape.sphere.push(Rt)}}}else if(i.bondOrder[S]>1){var Ht=0,kt=0;we!=le&&(Ht=2,kt=2);var ct,Jt,Nt,qt,Vt,Xt=ot.clone(),yr=null;Xt.sub(St),yr=this.getSideBondV(i,pt,S),i.bondOrder[S]==2?(ct=we*ye,yr.multiplyScalar(1.5*ct),(Jt=St.clone()).add(yr),(Nt=St.clone()).sub(yr),(qt=Jt.clone()).add(Xt),(Vt=Nt.clone()).add(Xt),ut!=et?(te=new m.Vector3().addVectors(Jt,qt).multiplyScalar(.5),re=new m.Vector3().addVectors(Nt,Vt).multiplyScalar(.5),Qe(l,Jt,te,ct,ut,Ht,0),Qe(l,te,qt,ct,et,0,kt),Qe(l,Nt,re,ct,ut,Ht,0),Qe(l,re,Vt,ct,et,0,kt)):(Qe(l,Jt,qt,ct,ut,Ht,kt),Qe(l,Nt,Vt,ct,ut,Ht,kt)),E=i.clickable||i.hoverable,M=pt.clickable||pt.hoverable,(E||M)&&(te||(te=new m.Vector3().addVectors(Jt,qt).multiplyScalar(.5)),re||(re=new m.Vector3().addVectors(Nt,Vt).multiplyScalar(.5)),E&&($=new v.Cylinder(Jt,te,ct),G=new v.Cylinder(Nt,re,ct),i.intersectionShape.cylinder.push($),i.intersectionShape.cylinder.push(G)),M&&(W=new v.Cylinder(qt,te,ct),H=new v.Cylinder(Vt,re,ct),pt.intersectionShape.cylinder.push(W),pt.intersectionShape.cylinder.push(H)))):i.bondOrder[S]==3&&(ct=we*Pe,yr.cross(Xt),yr.normalize(),yr.multiplyScalar(3*ct),(Jt=St.clone()).add(yr),(Nt=St.clone()).sub(yr),(qt=Jt.clone()).add(Xt),(Vt=Nt.clone()).add(Xt),ut!=et?(te=new m.Vector3().addVectors(Jt,qt).multiplyScalar(.5),re=new m.Vector3().addVectors(Nt,Vt).multiplyScalar(.5),de=new m.Vector3().addVectors(St,ot).multiplyScalar(.5),Qe(l,Jt,te,ct,ut,Ht,0),Qe(l,te,qt,ct,et,0,kt),Qe(l,St,de,ct,ut,tt,0),Qe(l,de,ot,ct,et,0,Ye),Qe(l,Nt,re,ct,ut,Ht,0),Qe(l,re,Vt,ct,et,0,kt)):(Qe(l,Jt,qt,ct,ut,Ht,kt),Qe(l,St,ot,ct,ut,tt,Ye),Qe(l,Nt,Vt,ct,ut,Ht,kt)),E=i.clickable||i.hoverable,M=pt.clickable||pt.hoverable,(E||M)&&(te||(te=new m.Vector3().addVectors(Jt,qt).multiplyScalar(.5)),re||(re=new m.Vector3().addVectors(Nt,Vt).multiplyScalar(.5)),de||(de=new m.Vector3().addVectors(St,ot).multiplyScalar(.5)),E&&($=new v.Cylinder(Jt.clone(),te.clone(),ct),G=new v.Cylinder(Nt.clone(),re.clone(),ct),j=new v.Cylinder(St.clone(),de.clone(),ct),i.intersectionShape.cylinder.push($),i.intersectionShape.cylinder.push(G),i.intersectionShape.cylinder.push(j)),M&&(W=new v.Cylinder(qt.clone(),te.clone(),ct),H=new v.Cylinder(Vt.clone(),re.clone(),ct),Y=new v.Cylinder(ot.clone(),de.clone(),ct),pt.intersectionShape.cylinder.push(W),pt.intersectionShape.cylinder.push(H),pt.intersectionShape.cylinder.push(Y))))}}}var Fr=!1,Tr=0,ii=!1;for(S=0;S<i.bonds.length;S++)R=Ge,i.bondStyles&&i.bondStyles[S]&&((O=i.bondStyles[S]).singleBond&&(R=!0),O.radius&&O.radius!=le&&(ii=!0)),(R||i.bondOrder[S]==1)&&Tr++;ii?Tr>0&&(Fr=!0):Tr==0&&(i.bonds.length>0||g.showNonBonded)&&(Fr=!0),Fr&&(we=le,l.imposter?this.drawSphereImposter(l.sphereGeometry,i,we,ut):p.drawSphere(l,i,we,ut))}}}createMolObj(i,s){s=s||{};var l,h,A,g,E=new u.Object3D,M=[],S={},R={},O=this.drawAtomSphere,$=null,G=null;s.supportsImposters?(O=this.drawAtomImposter,($=new u.Geometry(!0)).imposter=!0,(G=new u.Geometry(!0,!0)).imposter=!0,G.sphereGeometry=new u.Geometry(!0),G.sphereGeometry.imposter=!0,G.drawnCaps={}):s.supportsAIA?(O=this.drawAtomInstanced,($=new u.Geometry(!1,!0,!0)).instanced=!0,G=new u.Geometry(!0)):($=new u.Geometry(!0),G=new u.Geometry(!0));var j,W={},H=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];for(l=0,A=i.length;l<A;l++){var Y=i[l];if(Y&&Y.style){for(h in(Y.clickable||Y.hoverable)&&Y.intersectionShape===void 0&&(Y.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),g={line:void 0,cross:void 0,stick:void 0,sphere:void 0})Y.style[h]?Y.style[h].opacity?g[h]=parseFloat(Y.style[h].opacity):g[h]=1:g[h]=void 0,W[h]?g[h]!=null&&W[h]!=g[h]&&(console.log("Warning: "+h+" opacity is ambiguous"),W[h]=1):W[h]=g[h];O.call(this,Y,$),this.drawAtomClickSphere(Y),this.drawAtomCross(Y,R),this.drawBondLines(Y,i,S),this.drawBondSticks(Y,i,G),Y.style.cartoon===void 0||Y.style.cartoon.hidden||(Y.style.cartoon.color!=="spectrum"||typeof Y.resi!="number"||Y.hetflag||(Y.resi<H[0]&&(H[0]=Y.resi),Y.resi>H[1]&&(H[1]=Y.resi)),M.push(Y))}}if(M.length>0&&ge(E,M,H,this.defaultCartoonQuality),$&&$.vertices>0){$.initTypedArrays();var te=null,re=null;$.imposter?te=new u.SphereImposterMaterial({ambient:0,vertexColors:!0,reflectivity:0}):$.instanced?(re=new u.Geometry(!0),p.drawSphere(re,{x:0,y:0,z:0},1,new _.Color(.5,.5,.5)),re.initTypedArrays(),te=new u.InstancedMaterial({sphereMaterial:new u.MeshLambertMaterial({ambient:0,vertexColors:!0,reflectivity:0}),sphere:re})):te=new u.MeshLambertMaterial({ambient:0,vertexColors:!0,reflectivity:0}),W.sphere<1&&W.sphere>=0&&(te.transparent=!0,te.opacity=W.sphere),re=new u.Mesh($,te),E.add(re)}if(G.vertices>0){var de=null,le=null,ye=G.sphereGeometry;ye&&ye.vertices!==void 0&&ye.vertices!=0||(ye=null),G.initTypedArrays(),ye&&ye.initTypedArrays();var Pe={ambient:0,vertexColors:!0,reflectivity:0};G.imposter?(de=new u.StickImposterMaterial(Pe),le=new u.SphereImposterMaterial(Pe)):(de=new u.MeshLambertMaterial(Pe),le=new u.MeshLambertMaterial(Pe),de.wireframe&&(G.setUpWireframe(),ye&&ye.setUpWireframe())),W.stick<1&&W.stick>=0&&(de.transparent=!0,de.opacity=W.stick,le.transparent=!0,le.opacity=W.stick);var Te=new u.Mesh(G,de);if(E.add(Te),ye){var ke=new u.Mesh(ye,le);E.add(ke)}}for(l in S)if(S.hasOwnProperty(l)){j=l;var we=new u.LineBasicMaterial({linewidth:j,vertexColors:!0});W.line<1&&W.line>=0&&(we.transparent=!0,we.opacity=W.line),S[l].initTypedArrays();var Ge=new u.Line(S[l],we,u.LineStyle.LinePieces);E.add(Ge)}for(l in R)if(R.hasOwnProperty(l)){j=l;var Je=new u.LineBasicMaterial({linewidth:j,vertexColors:!0});W.cross<1&&W.cross>=0&&(Je.transparent=!0,Je.opacity=W.cross),R[l].initTypedArrays();var tt=new u.Line(R[l],Je,u.LineStyle.LinePieces);E.add(tt)}if(this.dontDuplicateAtoms&&this.modelData.symmetries&&this.modelData.symmetries.length>0){var Ye,ut=new u.Object3D;for(Ye=0;Ye<this.modelData.symmetries.length;Ye++){var ft=new u.Object3D;(ft=E.clone()).matrix.copy(this.modelData.symmetries[Ye]),ft.matrixAutoUpdate=!1,ut.add(ft)}return ut}return E}getViewer(){return this.viewer}getInternalState(){return{atoms:this.atoms,frames:this.frames}}setInternalState(i){this.atoms=i.atoms,this.frames=i.frames,this.molObj=null}getCrystData(){if(this.modelData.cryst){if(!this.modelData.cryst.matrix){const i=this.modelData.cryst;this.modelData.cryst.matrix=(0,m.conversionMatrix3)(i.a,i.b,i.c,i.alpha,i.beta,i.gamma)}return this.modelData.cryst}return null}setCrystData(i,s,l,h,A,g){i=i||1,s=s||1,l=l||1,h=h||90,A=A||90,g=g||90;const E=(0,m.conversionMatrix3)(i,s,l,h,A,g);this.modelData.cryst={a:i,b:s,c:l,alpha:h,beta:A,gamma:g,matrix:E}}setCrystMatrix(i){i=i||new m.Matrix3(1,0,0,0,1,0,0,0,1),this.modelData.cryst={matrix:i}}getSymmetries(){return this.modelData.symmetries===void 0&&(this.modelData.symmetries=[this.idMatrix]),this.modelData.symmetries}setSymmetries(i){i===void 0?this.modelData.symmetries=[this.idMatrix]:(this.modelData.symmetries=i,this.molObj=null)}getID(){return this.id}getNumFrames(){return this.frames.numFrames!=null?this.frames.numFrames:this.frames.length}adjustCoord(i,s,l,h){var A=s-i;return A<-l?s+h:A>l?s-h:s}adjustCoordinatesToBox(){if(this.box&&this.atomdfs)for(var i=this.box[0],s=this.box[1],l=this.box[2],h=.9*i,A=.9*s,g=.9*l,E=0;E<this.atomdfs.length;E++)for(var M=this.atomdfs[E],S=1;S<M.length;S++){var R=this.atoms[M[S][0]],O=this.atoms[M[S][1]];R.x=this.adjustCoord(O.x,R.x,h,i),R.y=this.adjustCoord(O.y,R.y,A,s),R.z=this.adjustCoord(O.z,R.z,g,l)}}setFrame(i){var s=this.getNumFrames();let l=this,h=this.viewer;return new Promise(function(A,g){if(s==0&&A(),(i<0||i>=s)&&(i=s-1),l.frames.url!=null){var E=l.frames.url;(0,w.getbin)(E+"/traj/frame/"+i+"/"+l.frames.path,void 0,"POST",void 0).then(function(M){for(var S=new Float32Array(M,44),R=0,O=0;O<l.atoms.length;O++)l.atoms[O].x=S[R++],l.atoms[O].y=S[R++],l.atoms[O].z=S[R++];l.box&&l.atomdfs&&l.adjustCoordinatesToBox(),A()}).catch(g)}else l.atoms=l.frames[i],A();l.molObj=null,l.modelDatas&&i<l.modelDatas.length&&(l.modelData=l.modelDatas[i],l.unitCellObjects&&h&&(h.removeUnitCell(l),h.addUnitCell(l)))})}addFrame(i){this.frames.push(i)}vibrate(i=10,s=1,l=!1,h){var A=0,g=i;let E=this.viewer;l&&(A=-i,g=i),this.frames!==void 0&&this.frames.origIndex!==void 0?this.setFrame(this.frames.origIndex):this.setFrame(0),A<g&&(this.frames=[]),l&&(this.frames.origIndex=i);for(var M=A;M<g;M++){var S=[],R=this.frames.length;if(M!=0||h){for(var O=0;O<this.atoms.length;O++){var $=(0,w.getAtomProperty)(this.atoms[O],"dx"),G=(0,w.getAtomProperty)(this.atoms[O],"dy"),j=(0,w.getAtomProperty)(this.atoms[O],"dz"),W=new m.Vector3($,G,j),H=new m.Vector3(this.atoms[O].x,this.atoms[O].y,this.atoms[O].z),Y=M*s/i;W.multiplyScalar(Y),H.add(W);var te={};for(var re in this.atoms[O])te[re]=this.atoms[O][re];if(te.x=H.x,te.y=H.y,te.z=H.z,S.push(te),E&&h){var de=(0,w.extend)({},h),le=new m.Vector3($,G,j);if(le.multiplyScalar(s),le.add(H),de.start=H,de.end=le,de.frame=R,!de.color){var ye=te.style.sphere;ye||(ye=te.style.stick),ye||(ye=te.style.line),de.color=(0,w.getColorFromStyle)(te,ye)}E.addArrow(de)}}this.frames.push(S)}else this.frames.push(this.atoms)}}setAtomDefaults(i){for(let s=0;s<i.length;s++){let l=i[s];l&&(l.style=l.style||(0,w.deepCopy)(ur.defaultAtomStyle),l.color=l.color||this.ElementColors[l.elem]||this.defaultColor,l.model=this.id,(l.clickable||l.hoverable)&&(l.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}))}}addMolData(i,s,l={}){var h=ur.parseMolData(i,s,l);this.dontDuplicateAtoms=!l.duplicateAssemblyAtoms;var A=h.modelData;if(A&&(Array.isArray(A)?(this.modelData=A[0],l.frames&&(this.modelDatas=A)):this.modelData=A),h.box?this.box=h.box:this.box=null,this.frames.length==0){for(let E=0;E<h.length;E++)h[E].length!=0&&this.frames.push(h[E]);this.frames[0]&&(this.atoms=this.frames[0])}else if(l.frames)for(let E=0;E<h.length;E++)this.frames.push(h[E]);else for(var g=0;g<h.length;g++)this.addAtoms(h[g]);for(let E=0;E<this.frames.length;E++)this.setAtomDefaults(this.frames[E]);l.vibrate&&l.vibrate.frames&&l.vibrate.amplitude&&this.vibrate(l.vibrate.frames,l.vibrate.amplitude),l.style&&this.setStyle({},l.style)}setDontDuplicateAtoms(i){this.dontDuplicateAtoms=i}setModelData(i){this.modelData=i}propertyMatches(i,s){if(i==s)return!0;if(typeof s=="string"&&typeof i=="number"){var l=s.match(/(-?\d+)\s*-\s*(-?\d+)/);if(l){var h=parseInt(l[1]),A=parseInt(l[2]);if(l&&i>=h&&i<=A)return!0}}return!1}static deepCopyAndCache(i,s){if(typeof i!="object"||i==null||i instanceof ur||i.__cache_created)return i;const l={};for(const h in i){const A=i[h];if(Array.isArray(A)){l[h]=[];for(let g=0;g<A.length;g++)l[h].push(ur.deepCopyAndCache(A[g],s))}else l[h]=typeof A=="object"&&h!="properties"&&h!="model"?ur.deepCopyAndCache(A,s):A;if(h=="and"||h=="or"){const g=[];for(const E of l[h]){const M=new Set;for(const S of s.selectedAtoms(E))M.add(S.index);g.push(M)}if(h=="and"){const E=function(S,R){const O=new Set;for(const $ of R)S.has($)&&O.add($);return O};let M=new Set(g[0]);for(const S of g.splice(1))M=E(M,S);l[h].__cached_results=M}else if(h=="or"){const E=new Set;for(const M of g)for(const S of M)E.add(S);l[h].__cached_results=E}}}return l.__cache_created=!0,l}atomIsSelected(i,s){if(s===void 0)return!0;var l=!!s.invert,h=!0;for(var A in s)if(A=="and"||A=="or"||A=="not"){if(A=="not"){if(this.atomIsSelected(i,s[A])){h=!1;break}}else if(s[A].__cached_results===void 0&&(s=ur.deepCopyAndCache(s,this)),!(h=s[A].__cached_results.has(i.index)))break}else if(A==="predicate"){if(!s.predicate(i)){h=!1;break}}else if(A=="properties"&&i[A]){for(var g in s.properties)if(!g.startsWith("__cache")){if(i.properties[g]===void 0){h=!1;break}if(i.properties[g]!=s.properties[g]){h=!1;break}}}else if(A=="model"){let S=s.model;if(typeof S=="number"&&S<0&&(S=this.viewer.getNextModelId()+S),Array.isArray(S)){let R=!1;for(let O=0;O<S.length;O++)if(S[O]==this||S[O]==this.id){R=!0;break}if(!R){h=!1;break}}else if(S!=this&&S!=this.id){h=!1;break}}else if(s.hasOwnProperty(A)&&!ur.ignoredKeys.has(A)&&!A.startsWith("__cache")){if(i[A]===void 0){h=!1;break}let S=!1;if(A==="bonds"){if(s[A]!=i.bonds.length){h=!1;break}}else if(Array.isArray(s[A])){var E=s[A],M=i[A];for(let R=0;R<E.length;R++)if(this.propertyMatches(M,E[R])){S=!0;break}if(!S){h=!1;break}}else{let R=s[A];if(!this.propertyMatches(i[A],R)){h=!1;break}}}return l?!h:h}static squaredDistance(i,s){var l=s.x-i.x,h=s.y-i.y,A=s.z-i.z;return l*l+h*h+A*A}expandAtomList(i,s){if(s<=0)return i;for(var l=(0,w.getExtent)(i,void 0),h=[[],[],[]],A=0;A<3;A++)h[0][A]=l[0][A]-s,h[1][A]=l[1][A]+s,h[2][A]=l[2][A];var g=[];for(let R=0;R<this.atoms.length;R++){var E=this.atoms[R].x,M=this.atoms[R].y,S=this.atoms[R].z;E>=h[0][0]&&E<=h[1][0]&&M>=h[0][1]&&M<=h[1][1]&&S>=h[0][2]&&S<=h[1][2]&&(E>=l[0][0]&&E<=l[1][0]&&M>=l[0][1]&&M<=l[1][1]&&S>=l[0][2]&&S<=l[1][2]||g.push(this.atoms[R]))}return g}static getFloat(i){return typeof i=="number"?i:parseFloat(i)}selectedAtoms(i,s){var l=[];i=ur.deepCopyAndCache(i||{},this),s||(s=this.atoms);for(var h=s.length,A=0;A<h;A++){var g=s[A];g&&this.atomIsSelected(g,i)&&l.push(g)}if(i.hasOwnProperty("expand")){const te=ur.getFloat(i.expand);let re=this.expandAtomList(l,te),de=l.length;const le=te*te;for(let ye=0;ye<re.length;ye++)for(let Pe=0;Pe<de;Pe++){var E=ur.squaredDistance(re[ye],l[Pe]);E<le&&E>0&&l.push(re[ye])}}if(i.hasOwnProperty("within")&&i.within.hasOwnProperty("sel")&&i.within.hasOwnProperty("distance")){var M=this.selectedAtoms(i.within.sel,this.atoms),S={};const te=ur.getFloat(i.within.distance),re=te*te;for(let de=0;de<M.length;de++)for(let le=0;le<l.length;le++){let ye=ur.squaredDistance(M[de],l[le]);ye<re&&ye>0&&(S[le]=1)}var R=[];if(i.within.invert)for(let de=0;de<l.length;de++)S[de]||R.push(l[de]);else for(let de in S)R.push(l[de]);l=R}if(i.hasOwnProperty("byres")){var O={},$=[],G=[];for(let te=0;te<l.length;te++){let re=l[te];var j=re.chain,W=re.resi;if(O[j]===void 0&&(O[j]={}),re.hasOwnProperty("resi")&&O[j][W]===void 0){for(O[j][W]=!0,G.push(re);G.length>0;)if(re=G.pop(),j=re.chain,W=re.resi,$[re.index]===void 0){$[re.index]=!0;for(var H=0;H<re.bonds.length;H++){var Y=this.atoms[re.bonds[H]];$[Y.index]===void 0&&Y.hasOwnProperty("resi")&&Y.chain==j&&Y.resi==W&&(G.push(Y),l.push(Y))}}}}}return l}addAtoms(i){this.molObj=null;var s,l=this.atoms.length,h=[];for(s=0;s<i.length;s++)i[s].index===void 0&&(i[s].index=s),i[s].serial===void 0&&(i[s].serial=s),h[i[s].index]=l+s;for(s=0;s<i.length;s++){var A=i[s],g=h[A.index],E=(0,w.extend)({},A);E.index=g,E.bonds=[],E.bondOrder=[],E.model=this.id,E.style=E.style||(0,w.deepCopy)(ur.defaultAtomStyle),E.color===void 0&&(E.color=this.ElementColors[E.elem]||this.defaultColor);for(var M=A.bonds?A.bonds.length:0,S=0;S<M;S++){var R=h[A.bonds[S]];R!==void 0&&(E.bonds.push(R),E.bondOrder.push(A.bondOrder?A.bondOrder[S]:1))}this.atoms.push(E)}}assignBonds(){(0,ue.assignBonds)(this.atoms,{assignBonds:!0})}removeAtoms(i){this.molObj=null;var s,l=[];for(s=0;s<i.length;s++)l[i[s].index]=!0;var h=[];for(s=0;s<this.atoms.length;s++){var A=this.atoms[s];l[A.index]||h.push(A)}this.atoms=[],this.addAtoms(h)}setStyle(i,s,l){s===void 0&&l===void 0&&(s=i,i={}),typeof s=="string"&&(s=(0,w.specStringToObject)(s));var h=!1,A=this,g=function(M){var S=A.selectedAtoms(i,M);for(let R=0;R<M.length;R++)M[R]&&(M[R].capDrawn=!1);for(let R=0;R<S.length;R++){h=!0,(S[R].clickable||S[R].hoverable)&&(S[R].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),l||(S[R].style={});for(let O in s)s.hasOwnProperty(O)&&(S[R].style[O]=S[R].style[O]||{},Object.assign(S[R].style[O],s[O]))}};if(i.frame!==void 0&&i.frame<this.frames.length){let M=i.frame;M<0&&(M=this.frames.length+M),g(this.frames[M])}else{g(this.atoms);for(var E=0;E<this.frames.length;E++)this.frames[E]!==this.atoms&&g(this.frames[E])}h&&(this.molObj=null)}setClickable(i,s,l){if(s=!!s,(l=(0,w.makeFunction)(l))!==null){var h=this.selectedAtoms(i,this.atoms),A=h.length;for(let g=0;g<A;g++)h[g].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},h[g].clickable=s,l&&(h[g].callback=l);A>0&&(this.molObj=null)}else console.log("Callback is not a function")}setHoverable(i,s,l,h){if(s=!!s,l=(0,w.makeFunction)(l),h=(0,w.makeFunction)(h),l!==null)if(h!==null){var A=this.selectedAtoms(i,this.atoms),g=A.length;for(let E=0;E<g;E++)A[E].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},A[E].hoverable=s,l&&(A[E].hover_callback=l),h&&(A[E].unhover_callback=h);g>0&&(this.molObj=null)}else console.log("Unhover_callback is not a function");else console.log("Hover_callback is not a function")}enableContextMenu(i,s){var l;s=!!s;var h=this.selectedAtoms(i,this.atoms),A=h.length;for(l=0;l<A;l++)h[l].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},h[l].contextMenuEnabled=s;A>0&&(this.molObj=null)}setColorByElement(i,s){if(this.molObj===null||!ur.sameObj(s,this.lastColors)){this.lastColors=s;var l=this.selectedAtoms(i,l);l.length>0&&(this.molObj=null);for(var h=0;h<l.length;h++){var A=l[h];s[A.elem]!==void 0&&(A.color=s[A.elem])}}}setColorByProperty(i,s,l,h){var A,g,E=this.selectedAtoms(i,E);for(this.lastColors=null,E.length>0&&(this.molObj=null),typeof l=="string"&&C.Gradient.builtinGradients[l]!==void 0&&(l=new C.Gradient.builtinGradients[l]),h||(h=l.range()),h||(h=(0,w.getPropertyRange)(E,s)),A=0;A<E.length;A++)g=E[A],(0,w.getAtomProperty)(g,s)!=null&&(g.color=l.valueToHex(parseFloat(g.properties[s]),h))}setColorByFunction(i,s){var l=this.selectedAtoms(i,l);if(typeof s=="function"){this.lastColors=null,l.length>0&&(this.molObj=null);for(let h=0;h<l.length;h++){let A=l[h];A.color=s(A)}}}toCDObject(i=!1){var s={a:[],b:[]};i&&(s.s=[]);for(let h=0;h<this.atoms.length;h++){let A={},g=this.atoms[h];if(A.x=g.x,A.y=g.y,A.z=g.z,g.elem!="C"&&(A.l=g.elem),i){for(var l=0;l<s.s.length&&JSON.stringify(g.style)!==JSON.stringify(s.s[l]);)l++;l===s.s.length&&s.s.push(g.style),l!==0&&(A.s=l)}s.a.push(A);for(let E=0;E<g.bonds.length;E++){let M=h,S=g.bonds[E];if(M>=S)continue;let R={b:M,e:S},O=g.bondOrder[E];O!=1&&(R.o=O),s.b.push(R)}}return s}globj(i,s){(this.molObj===null||s.regen)&&(this.molObj=this.createMolObj(this.atoms,s),this.renderedMolObj&&(i.remove(this.renderedMolObj),this.renderedMolObj=null),this.renderedMolObj=this.molObj.clone(),this.hidden&&(this.renderedMolObj.setVisible(!1),this.molObj.setVisible(!1)),i.add(this.renderedMolObj))}exportVRML(){return this.createMolObj(this.atoms,{supportsImposters:!1,supportsAIA:!1}).vrml()}removegl(i){this.renderedMolObj&&(this.renderedMolObj.geometry!==void 0&&this.renderedMolObj.geometry.dispose(),this.renderedMolObj.material!==void 0&&this.renderedMolObj.material.dispose(),i.remove(this.renderedMolObj),this.renderedMolObj=null),this.molObj=null}hide(){this.hidden=!0,this.renderedMolObj&&this.renderedMolObj.setVisible(!1),this.molObj&&this.molObj.setVisible(!1)}show(){this.hidden=!1,this.renderedMolObj&&this.renderedMolObj.setVisible(!0),this.molObj&&this.molObj.setVisible(!0)}addPropertyLabels(i,s,l){let h=this.selectedAtoms(s),A=this.viewer,g=(0,w.deepCopy)(l);for(let M=0;M<h.length;M++){let S=h[M];var E=null;S[i]!==void 0?E=String(S[i]):S.properties[i]!==void 0&&(E=String(S.properties[i])),E!=null&&(g.position=S,A.addLabel(E,g))}}addResLabels(i,s,l=!1){let h=this.viewer;var A=[],g=function(M,S){for(var R=M.selectedAtoms(i,R),O={},$=0;$<R.length;$++){var G=R[$],j=G.chain,W=G.resn+""+G.resi;O[j]||(O[j]={}),O[j][W]||(O[j][W]=[]),O[j][W].push(G)}var H=(0,w.deepCopy)(s);for(let te in O)if(O.hasOwnProperty(te)){var Y=O[te];for(let re in Y)if(Y.hasOwnProperty(re)){let de=Y[re],le=new m.Vector3(0,0,0);for(let Pe=0;Pe<de.length;Pe++){let Te=de[Pe];le.x+=Te.x,le.y+=Te.y,le.z+=Te.z}le.divideScalar(de.length),H.position=le,H.frame=S;let ye=h.addLabel(re,H,void 0,!0);A.push(ye)}}};if(l){var E=this.getNumFrames();let M=this.atoms;for(let S=0;S<E;S++)this.frames[S]&&(this.atoms=this.frames[S],g(this,S));this.atoms=M}else g(this);return A}setupDFS(){this.atomdfs=[];var i=this,s=new Int8Array(this.atoms.length);s.fill(0);for(var l=function(g,E,M){M.push([g,E]);var S=i.atoms[g];s[g]=1;for(var R=0;R<S.bonds.length;R++){var O=S.bonds[R];i.atoms[O]&&!s[O]&&l(O,g,M)}},h=0;h<this.atoms.length;h++)if(this.atoms[h]&&!s[h]){var A=[];l(h,-1,A),this.atomdfs.push(A)}}setCoordinatesFromURL(i,s){this.frames=[];var l=this;return this.box&&this.setupDFS(),i.startsWith("http")||(i="http://"+i),(0,w.get)(i+"/traj/numframes/"+s,function(h){if(!isNaN(parseInt(h)))return l.frames.push(l.atoms),l.frames.numFrames=h,l.frames.url=i,l.frames.path=s,l.setFrame(0)})}setCoordinates(i,s){if(!i)return[];if(/\.gz$/.test(s=s||"")){s=s.replace(/\.gz$/,"");try{i=(0,w.inflateString)(i)}catch(R){console.log(R)}}if({mdcrd:"",inpcrd:"",pdb:"",netcdf:"",array:""}.hasOwnProperty(s)){this.frames=[];for(var l=this.atoms.length,h=ur.parseCrd(i,s),A=0;A<h.length;){for(var g=[],E=0;E<l;E++){var M={};for(var S in this.atoms[E])M[S]=this.atoms[E][S];g[E]=M,g[E].x=h[A++],g[E].y=h[A++],g[E].z=h[A++]}this.frames.push(g)}return this.atoms=this.frames[0],this.frames}return[]}addAtomSpecs(i){}static parseCrd(i,s){var l=[],h=0;if(s=="pdb")for(var A=i.indexOf(`
ATOM`);A!=-1;){for(;i.slice(A,A+5)==`
ATOM`||i.slice(A,A+7)==`
HETATM`;)l[h++]=parseFloat(i.slice(A+31,A+39)),l[h++]=parseFloat(i.slice(A+39,A+47)),l[h++]=parseFloat(i.slice(A+47,A+55)),A=i.indexOf(`
`,A+54),i.slice(A,A+4)==`
TER`&&(A=i.indexOf(`
`,A+5));A=i.indexOf(`
ATOM`,A)}else if(s=="netcdf"){var g=new on(i);l=[].concat.apply([],g.getDataVariable("coordinates"))}else{if(s=="array"||Array.isArray(i))return i.flat(2);{let E=i.indexOf(`
`);s=="inpcrd"&&(E=i.indexOf(`
`,E+1)),l=(i=i.slice(E+1)).match(/\S+/g).map(parseFloat)}}return l}static parseMolData(i,s="",l){if(!i)return[];if(/\.gz$/.test(s)){s=s.replace(/\.gz$/,"");try{i=s.match(/bcif/i)?(0,w.inflateString)(i,!1):(0,w.inflateString)(i)}catch(h){console.log(h)}}return It[s]===void 0&&(s=s.split(".").pop(),It[s]===void 0&&(console.log("Unknown format: "+s),s=i instanceof Uint8Array?"bcif":i.match(/^@<TRIPOS>MOLECULE/gm)?"mol2":i.match(/^data_/gm)&&i.match(/^loop_/gm)?"cif":i.match(/^HETATM/gm)||i.match(/^ATOM/gm)?"pdb":i.match(/ITEM: TIMESTEP/gm)?"lammpstrj":i.match(/^.*\n.*\n.\s*(\d+)\s+(\d+)/gm)?"sdf":i.match(/^%VERSION\s+VERSION_STAMP/gm)?"prmtop":"xyz",console.log("Best guess: "+s))),(0,It[s])(i,l)}}var Gr;ur.defaultAtomStyle={line:{}},ur.defaultlineWidth=1,ur.vdwRadii={H:1.2,He:1.4,Li:1.82,Be:1.53,B:1.92,C:1.7,N:1.55,O:1.52,F:1.47,Ne:1.54,Na:2.27,Mg:1.73,Al:1.84,Si:2.1,P:1.8,S:1.8,Cl:1.75,Ar:1.88,K:2.75,Ca:2.31,Ni:1.63,Cu:1.4,Zn:1.39,Ga:1.87,Ge:2.11,As:1.85,Se:1.9,Br:1.85,Kr:2.02,Rb:3.03,Sr:2.49,Pd:1.63,Ag:1.72,Cd:1.58,In:1.93,Sn:2.17,Sb:2.06,Te:2.06,I:1.98,Xe:2.16,Cs:3.43,Ba:2.68,Pt:1.75,Au:1.66,Hg:1.55,Tl:1.96,Pb:2.02,Bi:2.07,Po:1.97,At:2.02,Rn:2.2,Fr:3.48,Ra:2.83,U:1.86},ur.ignoredKeys=new Set(["props","invert","model","frame","byres","expand","within","and","or","not"]),(function(ae){ae[ae.VDW=1]="VDW",ae[ae.MS=2]="MS",ae[ae.SAS=3]="SAS",ae[ae.SES=4]="SES"})(Gr||(Gr={}));var Kr=!1;function qi(ae){Kr=ae}(window.navigator.userAgent.indexOf("MSIE ")>=0||window.navigator.userAgent.indexOf("Trident/")>=0)&&(Kr=!0);class Bt{constructor(){this.ISDONE=2,this.edgeTable=new Uint32Array([0,0,0,0,0,0,0,2816,0,0,0,1792,0,3328,3584,3840,0,0,0,138,0,21,0,134,0,0,0,652,0,2067,3865,3600,0,0,0,42,0,0,0,294,0,0,21,28,0,3875,1049,3360,0,168,162,170,0,645,2475,2210,0,687,293,172,4010,3747,3497,3232,0,0,0,0,0,69,0,900,0,0,0,1792,138,131,1608,1920,0,81,0,2074,84,85,84,86,0,81,0,3676,330,1105,1881,1616,0,0,0,42,0,69,0,502,0,0,21,3580,138,2035,1273,1520,2816,104,2337,106,840,581,367,102,2816,3695,3429,3180,1898,1635,1385,1120,0,0,0,0,0,0,0,3910,0,0,69,588,42,2083,41,2880,0,0,0,1722,0,2293,4095,3830,0,255,757,764,2538,2291,3065,2800,0,0,81,338,0,3925,1119,3414,84,855,85,340,2130,2899,89,2384,1792,712,194,1162,4036,3781,3535,3270,708,719,197,204,3018,2755,2505,2240,0,0,0,0,168,420,168,1958,162,162,676,2988,170,163,680,928,3328,3096,3328,3642,52,53,1855,1590,2340,2111,2869,2620,298,51,825,560,3584,3584,3090,3482,1668,1941,1183,1430,146,2975,2069,2460,154,915,153,400,3840,3592,3329,3082,1796,1541,1295,1030,2818,2575,2309,2060,778,515,265,0]),this.triTable=[[],[],[],[],[],[],[],[11,9,8],[],[],[],[8,10,9],[],[10,8,11],[9,11,10],[8,10,9,8,11,10],[],[],[],[1,7,3],[],[4,2,0],[],[2,1,7],[],[],[],[2,7,3,2,9,7],[],[1,4,11,1,0,4],[3,8,0,11,9,4,11,10,9],[4,11,9,11,10,9],[],[],[],[5,3,1],[],[],[],[2,5,8,2,1,5],[],[],[2,4,0],[3,2,4],[],[0,9,1,8,10,5,8,11,10],[3,4,0,3,10,4],[5,8,10,8,11,10],[],[3,5,7],[7,1,5],[1,7,3,1,5,7],[],[9,2,0,9,7,2],[0,3,8,1,7,11,1,5,7],[11,1,7,1,5,7],[],[9,1,0,5,3,2,5,7,3],[8,2,5,8,0,2],[2,5,3,5,7,3],[3,9,1,3,8,9,7,11,10,7,10,5],[9,1,0,10,7,11,10,5,7],[3,8,0,7,10,5,7,11,10],[11,5,7,11,10,5],[],[],[],[],[],[0,6,2],[],[7,2,9,7,9,8],[],[],[],[8,10,9],[7,1,3],[7,1,0],[6,9,3,6,10,9],[7,10,8,10,9,8],[],[6,0,4],[],[11,1,4,11,3,1],[2,4,6],[2,0,4,2,4,6],[2,4,6],[1,4,2,4,6,2],[],[6,0,4],[],[2,11,3,6,9,4,6,10,9],[8,6,1,8,1,3],[10,0,6,0,4,6],[8,0,3,9,6,10,9,4,6],[10,4,6,10,9,4],[],[],[],[5,3,1],[],[0,6,2],[],[7,4,8,5,2,1,5,6,2],[],[],[2,4,0],[7,4,8,2,11,3,10,5,6],[7,1,3],[5,6,10,0,9,1,8,7,4],[5,6,10,7,0,3,7,4,0],[10,5,6,4,8,7],[9,11,8],[3,5,6],[0,5,11,0,11,8],[6,3,5,3,1,5],[3,9,6,3,8,9],[9,6,0,6,2,0],[0,3,8,2,5,6,2,1,5],[1,6,2,1,5,6],[9,11,8],[1,0,9,6,10,5,11,3,2],[6,10,5,2,8,0,2,11,8],[3,2,11,10,5,6],[10,5,6,9,3,8,9,1,3],[0,9,1,5,6,10],[8,0,3,10,5,6],[10,5,6],[],[],[],[],[],[],[],[1,10,2,9,11,6,9,8,11],[],[],[6,0,2],[3,6,9,3,2,6],[3,5,1],[0,5,1,0,11,5],[0,3,5],[6,9,11,9,8,11],[],[],[],[4,5,9,7,1,10,7,3,1],[],[11,6,7,2,4,5,2,0,4],[11,6,7,8,0,3,1,10,2,9,4,5],[6,7,11,1,10,2,9,4,5],[],[4,1,0,4,5,1,6,7,3,6,3,2],[9,4,5,0,6,7,0,2,6],[4,5,9,6,3,2,6,7,3],[6,7,11,5,3,8,5,1,3],[6,7,11,4,1,0,4,5,1],[4,5,9,3,8,0,11,6,7],[9,4,5,7,11,6],[],[],[0,6,4],[8,6,4,8,1,6],[],[0,10,2,0,9,10,4,8,11,4,11,6],[10,2,1,6,0,3,6,4,0],[10,2,1,11,4,8,11,6,4],[4,2,6],[1,0,9,2,4,8,2,6,4],[2,4,0,2,6,4],[8,2,4,2,6,4],[11,4,1,11,6,4],[0,9,1,4,11,6,4,8,11],[3,6,0,6,4,0],[8,6,4,8,11,6],[10,8,9],[6,3,9,6,7,3],[6,7,1],[10,7,1,7,3,1],[7,11,6,8,10,2,8,9,10],[11,6,7,10,0,9,10,2,0],[2,1,10,7,11,6,8,0,3],[1,10,2,6,7,11],[7,2,6,7,9,2],[1,0,9,3,6,7,3,2,6],[7,0,6,0,2,6],[2,7,3,2,6,7],[7,11,6,3,9,1,3,8,9],[9,1,0,11,6,7],[0,3,8,11,6,7],[11,6,7],[],[],[],[],[5,3,7],[8,5,2,8,7,5],[5,3,7],[1,10,2,5,8,7,5,9,8],[1,7,5],[1,7,5],[9,2,7,9,7,5],[11,3,2,8,5,9,8,7,5],[1,3,7,1,7,5],[0,7,1,7,5,1],[9,3,5,3,7,5],[9,7,5,9,8,7],[8,10,11],[3,4,10,3,10,11],[8,10,11],[5,9,4,1,11,3,1,10,11],[2,4,5],[5,2,4,2,0,4],[0,3,8,5,9,4,10,2,1],[2,1,10,9,4,5],[2,8,5,2,11,8],[3,2,11,1,4,5,1,0,4],[9,4,5,8,2,11,8,0,2],[11,3,2,9,4,5],[8,5,3,5,1,3],[5,0,4,5,1,0],[3,8,0,4,5,9],[9,4,5],[11,9,10],[11,9,10],[1,11,4,1,10,11],[8,7,4,11,1,10,11,3,1],[2,7,9,2,9,10],[4,8,7,0,10,2,0,9,10],[2,1,10,0,7,4,0,3,7],[10,2,1,8,7,4],[1,7,4],[3,2,11,4,8,7,9,1,0],[11,4,2,4,0,2],[2,11,3,7,4,8],[4,1,7,1,3,7],[1,0,9,8,7,4],[3,4,0,3,7,4],[8,7,4],[8,9,10,8,10,11],[3,9,11,9,10,11],[0,10,8,10,11,8],[10,3,1,10,11,3],[2,8,10,8,9,10],[9,2,0,9,10,2],[8,0,3,1,10,2],[10,2,1],[1,11,9,11,8,9],[11,3,2,0,9,1],[11,0,2,11,8,0],[11,3,2],[8,1,3,8,9,1],[9,1,0],[8,0,3],[]],this.edgeTable2=[0,265,515,778,2060,2309,2575,2822,1030,1295,1541,1804,3082,3331,3593,3840,400,153,915,666,2460,2197,2975,2710,1430,1183,1941,1692,3482,3219,3993,3728,560,825,51,314,2620,2869,2111,2358,1590,1855,1077,1340,3642,3891,3129,3376,928,681,419,170,2988,2725,2479,2214,1958,1711,1445,1196,4010,3747,3497,3232,2240,2505,2755,3018,204,453,719,966,3270,3535,3781,4044,1226,1475,1737,1984,2384,2137,2899,2650,348,85,863,598,3414,3167,3925,3676,1370,1107,1881,1616,2800,3065,2291,2554,764,1013,255,502,3830,4095,3317,3580,1786,2035,1273,1520,2912,2665,2403,2154,876,613,367,102,3942,3695,3429,3180,1898,1635,1385,1120,1120,1385,1635,1898,3180,3429,3695,3942,102,367,613,876,2154,2403,2665,2912,1520,1273,2035,1786,3580,3317,4095,3830,502,255,1013,764,2554,2291,3065,2800,1616,1881,1107,1370,3676,3925,3167,3414,598,863,85,348,2650,2899,2137,2384,1984,1737,1475,1226,4044,3781,3535,3270,966,719,453,204,3018,2755,2505,2240,3232,3497,3747,4010,1196,1445,1711,1958,2214,2479,2725,2988,170,419,681,928,3376,3129,3891,3642,1340,1077,1855,1590,2358,2111,2869,2620,314,51,825,560,3728,3993,3219,3482,1692,1941,1183,1430,2710,2975,2197,2460,666,915,153,400,3840,3593,3331,3082,1804,1541,1295,1030,2822,2575,2309,2060,778,515,265,0],this.triTable2=[[],[8,3,0],[9,0,1],[8,3,1,8,1,9],[11,2,3],[11,2,0,11,0,8],[11,2,3,0,1,9],[2,1,11,1,9,11,11,9,8],[10,1,2],[8,3,0,1,2,10],[9,0,2,9,2,10],[3,2,8,2,10,8,8,10,9],[10,1,3,10,3,11],[1,0,10,0,8,10,10,8,11],[0,3,9,3,11,9,9,11,10],[8,10,9,8,11,10],[8,4,7],[3,0,4,3,4,7],[1,9,0,8,4,7],[9,4,1,4,7,1,1,7,3],[2,3,11,7,8,4],[7,11,4,11,2,4,4,2,0],[3,11,2,4,7,8,9,0,1],[2,7,11,2,1,7,1,4,7,1,9,4],[10,1,2,8,4,7],[2,10,1,0,4,7,0,7,3],[4,7,8,0,2,10,0,10,9],[2,7,3,2,9,7,7,9,4,2,10,9],[8,4,7,11,10,1,11,1,3],[11,4,7,1,4,11,1,11,10,1,0,4],[3,8,0,7,11,4,11,9,4,11,10,9],[7,11,4,4,11,9,11,10,9],[9,5,4],[3,0,8,4,9,5],[5,4,0,5,0,1],[4,8,5,8,3,5,5,3,1],[11,2,3,9,5,4],[9,5,4,8,11,2,8,2,0],[3,11,2,1,5,4,1,4,0],[8,5,4,2,5,8,2,8,11,2,1,5],[2,10,1,9,5,4],[0,8,3,5,4,9,10,1,2],[10,5,2,5,4,2,2,4,0],[3,4,8,3,2,4,2,5,4,2,10,5],[5,4,9,1,3,11,1,11,10],[0,9,1,4,8,5,8,10,5,8,11,10],[3,4,0,3,10,4,4,10,5,3,11,10],[4,8,5,5,8,10,8,11,10],[9,5,7,9,7,8],[0,9,3,9,5,3,3,5,7],[8,0,7,0,1,7,7,1,5],[1,7,3,1,5,7],[11,2,3,8,9,5,8,5,7],[9,2,0,9,7,2,2,7,11,9,5,7],[0,3,8,2,1,11,1,7,11,1,5,7],[2,1,11,11,1,7,1,5,7],[1,2,10,5,7,8,5,8,9],[9,1,0,10,5,2,5,3,2,5,7,3],[5,2,10,8,2,5,8,5,7,8,0,2],[10,5,2,2,5,3,5,7,3],[3,9,1,3,8,9,7,11,10,7,10,5],[9,1,0,10,7,11,10,5,7],[3,8,0,7,10,5,7,11,10],[11,5,7,11,10,5],[11,7,6],[0,8,3,11,7,6],[9,0,1,11,7,6],[7,6,11,3,1,9,3,9,8],[2,3,7,2,7,6],[8,7,0,7,6,0,0,6,2],[1,9,0,3,7,6,3,6,2],[7,6,2,7,2,9,2,1,9,7,9,8],[1,2,10,6,11,7],[2,10,1,7,6,11,8,3,0],[11,7,6,10,9,0,10,0,2],[7,6,11,3,2,8,8,2,10,8,10,9],[6,10,7,10,1,7,7,1,3],[6,10,1,6,1,7,7,1,0,7,0,8],[9,0,3,6,9,3,6,10,9,6,3,7],[6,10,7,7,10,8,10,9,8],[8,4,6,8,6,11],[11,3,6,3,0,6,6,0,4],[0,1,9,4,6,11,4,11,8],[1,9,4,11,1,4,11,3,1,11,4,6],[3,8,2,8,4,2,2,4,6],[2,0,4,2,4,6],[1,9,0,3,8,2,2,8,4,2,4,6],[9,4,1,1,4,2,4,6,2],[10,1,2,11,8,4,11,4,6],[10,1,2,11,3,6,6,3,0,6,0,4],[0,2,10,0,10,9,4,11,8,4,6,11],[2,11,3,6,9,4,6,10,9],[8,4,6,8,6,1,6,10,1,8,1,3],[1,0,10,10,0,6,0,4,6],[8,0,3,9,6,10,9,4,6],[10,4,6,10,9,4],[9,5,4,7,6,11],[4,9,5,3,0,8,11,7,6],[6,11,7,4,0,1,4,1,5],[6,11,7,4,8,5,5,8,3,5,3,1],[4,9,5,6,2,3,6,3,7],[9,5,4,8,7,0,0,7,6,0,6,2],[4,0,1,4,1,5,6,3,7,6,2,3],[7,4,8,5,2,1,5,6,2],[6,11,7,1,2,10,9,5,4],[11,7,6,8,3,0,1,2,10,9,5,4],[11,7,6,10,5,2,2,5,4,2,4,0],[7,4,8,2,11,3,10,5,6],[4,9,5,6,10,7,7,10,1,7,1,3],[5,6,10,0,9,1,8,7,4],[5,6,10,7,0,3,7,4,0],[10,5,6,4,8,7],[5,6,9,6,11,9,9,11,8],[0,9,5,0,5,3,3,5,6,3,6,11],[0,1,5,0,5,11,5,6,11,0,11,8],[11,3,6,6,3,5,3,1,5],[9,5,6,3,9,6,3,8,9,3,6,2],[5,6,9,9,6,0,6,2,0],[0,3,8,2,5,6,2,1,5],[1,6,2,1,5,6],[1,2,10,5,6,9,9,6,11,9,11,8],[1,0,9,6,10,5,11,3,2],[6,10,5,2,8,0,2,11,8],[3,2,11,10,5,6],[10,5,6,9,3,8,9,1,3],[0,9,1,5,6,10],[8,0,3,10,5,6],[10,5,6],[10,6,5],[8,3,0,10,6,5],[0,1,9,5,10,6],[10,6,5,9,8,3,9,3,1],[3,11,2,10,6,5],[6,5,10,2,0,8,2,8,11],[1,9,0,6,5,10,11,2,3],[1,10,2,5,9,6,9,11,6,9,8,11],[1,2,6,1,6,5],[0,8,3,2,6,5,2,5,1],[5,9,6,9,0,6,6,0,2],[9,6,5,3,6,9,3,9,8,3,2,6],[11,6,3,6,5,3,3,5,1],[0,5,1,0,11,5,5,11,6,0,8,11],[0,5,9,0,3,5,3,6,5,3,11,6],[5,9,6,6,9,11,9,8,11],[10,6,5,4,7,8],[5,10,6,7,3,0,7,0,4],[5,10,6,0,1,9,8,4,7],[4,5,9,6,7,10,7,1,10,7,3,1],[7,8,4,2,3,11,10,6,5],[11,6,7,10,2,5,2,4,5,2,0,4],[11,6,7,8,0,3,1,10,2,9,4,5],[6,7,11,1,10,2,9,4,5],[7,8,4,5,1,2,5,2,6],[4,1,0,4,5,1,6,7,3,6,3,2],[9,4,5,8,0,7,0,6,7,0,2,6],[4,5,9,6,3,2,6,7,3],[6,7,11,4,5,8,5,3,8,5,1,3],[6,7,11,4,1,0,4,5,1],[4,5,9,3,8,0,11,6,7],[9,4,5,7,11,6],[10,6,4,10,4,9],[8,3,0,9,10,6,9,6,4],[1,10,0,10,6,0,0,6,4],[8,6,4,8,1,6,6,1,10,8,3,1],[2,3,11,6,4,9,6,9,10],[0,10,2,0,9,10,4,8,11,4,11,6],[10,2,1,11,6,3,6,0,3,6,4,0],[10,2,1,11,4,8,11,6,4],[9,1,4,1,2,4,4,2,6],[1,0,9,3,2,8,2,4,8,2,6,4],[2,4,0,2,6,4],[3,2,8,8,2,4,2,6,4],[1,4,9,11,4,1,11,1,3,11,6,4],[0,9,1,4,11,6,4,8,11],[11,6,3,3,6,0,6,4,0],[8,6,4,8,11,6],[6,7,10,7,8,10,10,8,9],[9,3,0,6,3,9,6,9,10,6,7,3],[6,1,10,6,7,1,7,0,1,7,8,0],[6,7,10,10,7,1,7,3,1],[7,11,6,3,8,2,8,10,2,8,9,10],[11,6,7,10,0,9,10,2,0],[2,1,10,7,11,6,8,0,3],[1,10,2,6,7,11],[7,2,6,7,9,2,2,9,1,7,8,9],[1,0,9,3,6,7,3,2,6],[8,0,7,7,0,6,0,2,6],[2,7,3,2,6,7],[7,11,6,3,9,1,3,8,9],[9,1,0,11,6,7],[0,3,8,11,6,7],[11,6,7],[11,7,5,11,5,10],[3,0,8,7,5,10,7,10,11],[9,0,1,10,11,7,10,7,5],[3,1,9,3,9,8,7,10,11,7,5,10],[10,2,5,2,3,5,5,3,7],[5,10,2,8,5,2,8,7,5,8,2,0],[9,0,1,10,2,5,5,2,3,5,3,7],[1,10,2,5,8,7,5,9,8],[2,11,1,11,7,1,1,7,5],[0,8,3,2,11,1,1,11,7,1,7,5],[9,0,2,9,2,7,2,11,7,9,7,5],[11,3,2,8,5,9,8,7,5],[1,3,7,1,7,5],[8,7,0,0,7,1,7,5,1],[0,3,9,9,3,5,3,7,5],[9,7,5,9,8,7],[4,5,8,5,10,8,8,10,11],[3,0,4,3,4,10,4,5,10,3,10,11],[0,1,9,4,5,8,8,5,10,8,10,11],[5,9,4,1,11,3,1,10,11],[3,8,4,3,4,2,2,4,5,2,5,10],[10,2,5,5,2,4,2,0,4],[0,3,8,5,9,4,10,2,1],[2,1,10,9,4,5],[8,4,5,2,8,5,2,11,8,2,5,1],[3,2,11,1,4,5,1,0,4],[9,4,5,8,2,11,8,0,2],[11,3,2,9,4,5],[4,5,8,8,5,3,5,1,3],[5,0,4,5,1,0],[3,8,0,4,5,9],[9,4,5],[7,4,11,4,9,11,11,9,10],[3,0,8,7,4,11,11,4,9,11,9,10],[11,7,4,1,11,4,1,10,11,1,4,0],[8,7,4,11,1,10,11,3,1],[2,3,7,2,7,9,7,4,9,2,9,10],[4,8,7,0,10,2,0,9,10],[2,1,10,0,7,4,0,3,7],[10,2,1,8,7,4],[2,11,7,2,7,1,1,7,4,1,4,9],[3,2,11,4,8,7,9,1,0],[7,4,11,11,4,2,4,0,2],[2,11,3,7,4,8],[9,1,4,4,1,7,1,3,7],[1,0,9,8,7,4],[3,4,0,3,7,4],[8,7,4],[8,9,10,8,10,11],[0,9,3,3,9,11,9,10,11],[1,10,0,0,10,8,10,11,8],[10,3,1,10,11,3],[3,8,2,2,8,10,8,9,10],[9,2,0,9,10,2],[8,0,3,1,10,2],[10,2,1],[2,11,1,1,11,9,11,8,9],[11,3,2,0,9,1],[11,0,2,11,8,0],[11,3,2],[8,1,3,8,9,1],[9,1,0],[8,0,3],[]]}march(i,s,l,h){let A=!!h.fulltable,g=h.hasOwnProperty("origin")&&h.origin.hasOwnProperty("x")?h.origin:{x:0,y:0,z:0},E=!!h.voxel,M=h.matrix,S=h.nX||0,R=h.nY||0,O=h.nZ||0,$=h.scale||1,G=null;G=h.unitCube?h.unitCube:{x:$,y:$,z:$};let j,W,H=new Int32Array(S*R*O);for(j=0,W=H.length;j<W;++j)H[j]=-1;let Y=function(le,ye,Pe,Te,ke,we){let Ge={x:0,y:0,z:0},Je=ke;if(!(Te&1<<ke)&&Te&1<<we&&(Je=we),1&Je&&Pe++,2&Je&&ye++,4&Je&&le++,M){let Ye=new m.Vector3(le,ye,Pe);Ye=Ye.applyMatrix4(M),Ge={x:Ye.x,y:Ye.y,z:Ye.z}}else Ge.x=g.x+G.x*le,Ge.y=g.y+G.y*ye,Ge.z=g.z+G.z*Pe;let tt=(R*le+ye)*O+Pe;return E?(s.push(Ge),s.length-1):(H[tt]<0&&(H[tt]=s.length,s.push(Ge)),H[tt])},te=new Int32Array(12),re=A?this.edgeTable2:this.edgeTable,de=A?this.triTable2:this.triTable;for(j=0;j<S-1;++j)for(let le=0;le<R-1;++le)for(let ye=0;ye<O-1;++ye){let Pe=0;for(let we=0;we<8;++we)Pe|=!!(i[(R*(j+((4&we)>>2))+le+((2&we)>>1))*O+ye+(1&we)]&this.ISDONE)<<we;if(Pe===0||Pe===255)continue;let Te=re[Pe];if(Te===0)continue;let ke=de[Pe];1&Te&&(te[0]=Y(j,le,ye,Pe,0,1)),2&Te&&(te[1]=Y(j,le,ye,Pe,1,3)),4&Te&&(te[2]=Y(j,le,ye,Pe,3,2)),8&Te&&(te[3]=Y(j,le,ye,Pe,2,0)),16&Te&&(te[4]=Y(j,le,ye,Pe,4,5)),32&Te&&(te[5]=Y(j,le,ye,Pe,5,7)),64&Te&&(te[6]=Y(j,le,ye,Pe,7,6)),128&Te&&(te[7]=Y(j,le,ye,Pe,6,4)),256&Te&&(te[8]=Y(j,le,ye,Pe,0,4)),512&Te&&(te[9]=Y(j,le,ye,Pe,1,5)),1024&Te&&(te[10]=Y(j,le,ye,Pe,3,7)),2048&Te&&(te[11]=Y(j,le,ye,Pe,2,6));for(let we=0;we<ke.length;we+=3){let Ge=te[ke[we]],Je=te[ke[we+1]],tt=te[ke[we+2]];E&&we>=3&&(s.push(s[Ge]),Ge=s.length-1,s.push(s[Je]),Je=s.length-1,s.push(s[tt]),tt=s.length-1),l.push(Ge),l.push(Je),l.push(tt)}}}laplacianSmooth(i,s,l){let h,A,g,E,M,S=new Array(s.length);for(h=0,A=s.length;h<A;h++)S[h]={x:0,y:0,z:0};let R,O=new Array(20);for(h=0;h<20;h++)O[h]=new Array(s.length);for(h=0,A=s.length;h<A;h++)O[0][h]=0;for(h=0,A=l.length/3;h<A;h++){let G=3*h,j=3*h+1,W=3*h+2;for(R=!0,g=0,E=O[0][l[G]];g<E;g++)if(l[j]==O[g+1][l[G]]){R=!1;break}for(R&&(O[0][l[G]]++,O[O[0][l[G]]][l[G]]=l[j]),R=!0,g=0,E=O[0][l[G]];g<E;g++)if(l[W]==O[g+1][l[G]]){R=!1;break}for(R&&(O[0][l[G]]++,O[O[0][l[G]]][l[G]]=l[W]),R=!0,g=0,E=O[0][l[j]];g<E;g++)if(l[G]==O[g+1][l[j]]){R=!1;break}for(R&&(O[0][l[j]]++,O[O[0][l[j]]][l[j]]=l[G]),R=!0,g=0,E=O[0][l[j]];g<E;g++)if(l[W]==O[g+1][l[j]]){R=!1;break}for(R&&(O[0][l[j]]++,O[O[0][l[j]]][l[j]]=l[W]),R=!0,g=0;g<O[0][l[W]];g++)if(l[G]==O[g+1][l[W]]){R=!1;break}for(R&&(O[0][l[W]]++,O[O[0][l[W]]][l[W]]=l[G]),R=!0,g=0,E=O[0][l[W]];g<E;g++)if(l[j]==O[g+1][l[W]]){R=!1;break}R&&(O[0][l[W]]++,O[O[0][l[W]]][l[W]]=l[j])}let $=.5;for(M=0;M<i;M++){for(h=0,A=s.length;h<A;h++)if(O[0][h]<3)S[h].x=s[h].x,S[h].y=s[h].y,S[h].z=s[h].z;else if(O[0][h]==3||O[0][h]==4){for(S[h].x=0,S[h].y=0,S[h].z=0,g=0,E=O[0][h];g<E;g++)S[h].x+=s[O[g+1][h]].x,S[h].y+=s[O[g+1][h]].y,S[h].z+=s[O[g+1][h]].z;S[h].x+=$*s[h].x,S[h].y+=$*s[h].y,S[h].z+=$*s[h].z,S[h].x/=$+O[0][h],S[h].y/=$+O[0][h],S[h].z/=$+O[0][h]}else{for(S[h].x=0,S[h].y=0,S[h].z=0,g=0,E=O[0][h];g<E;g++)S[h].x+=s[O[g+1][h]].x,S[h].y+=s[O[g+1][h]].y,S[h].z+=s[O[g+1][h]].z;S[h].x+=1*s[h].x,S[h].y+=1*s[h].y,S[h].z+=1*s[h].z,S[h].x/=1+O[0][h],S[h].y/=1+O[0][h],S[h].z/=1+O[0][h]}for(h=0,A=s.length;h<A;h++)s[h].x=S[h].x,s[h].y=S[h].y,s[h].z=S[h].z}}}let x=new Bt;class ne{constructor(i,s,l){this.data=new Int32Array(i*s*l*3),this.width=s,this.height=l}set(i,s,l,h){let A=3*((i*this.width+s)*this.height+l);this.data[A]=h.ix,this.data[A+1]=h.iy,this.data[A+2]=h.iz}get(i,s,l){let h=3*((i*this.width+s)*this.height+l);return{ix:this.data[h],iy:this.data[h+1],iz:this.data[h+2]}}}class xe{constructor(){this.INOUT=1,this.ISDONE=2,this.ISBOUND=4,this.ptranx=0,this.ptrany=0,this.ptranz=0,this.probeRadius=1.4,this.defaultScaleFactor=2,this.scaleFactor=this.defaultScaleFactor,this.pHeight=0,this.pWidth=0,this.pLength=0,this.cutRadius=0,this.vpBits=null,this.vpDistance=null,this.vpAtomID=null,this.pminx=0,this.pminy=0,this.pminz=0,this.pmaxx=0,this.pmaxy=0,this.pmaxz=0,this.depty={},this.widxz={},this.faces=[],this.verts=[],this.vdwRadii={H:1.2,Li:1.82,Na:2.27,K:2.75,C:1.7,N:1.55,O:1.52,F:1.47,P:1.8,S:1.8,CL:1.75,BR:1.85,SE:1.9,ZN:1.39,CU:1.4,NI:1.63,X:2},this.nb=[new Int32Array([1,0,0]),new Int32Array([-1,0,0]),new Int32Array([0,1,0]),new Int32Array([0,-1,0]),new Int32Array([0,0,1]),new Int32Array([0,0,-1]),new Int32Array([1,1,0]),new Int32Array([1,-1,0]),new Int32Array([-1,1,0]),new Int32Array([-1,-1,0]),new Int32Array([1,0,1]),new Int32Array([1,0,-1]),new Int32Array([-1,0,1]),new Int32Array([-1,0,-1]),new Int32Array([0,1,1]),new Int32Array([0,1,-1]),new Int32Array([0,-1,1]),new Int32Array([0,-1,-1]),new Int32Array([1,1,1]),new Int32Array([1,1,-1]),new Int32Array([1,-1,1]),new Int32Array([-1,1,1]),new Int32Array([1,-1,-1]),new Int32Array([-1,-1,1]),new Int32Array([-1,1,-1]),new Int32Array([-1,-1,-1])],xe.MarchingCube||(xe.MarchingCube=new Bt)}getVDWIndex(i){return i.elem&&this.vdwRadii[i.elem]!==void 0?i.elem:"X"}getFacesAndVertices(i){let s={};for(let A=0,g=i.length;A<g;A++)s[i[A]]=!0;let l=this.verts;for(let A=0,g=l.length;A<g;A++)l[A].x=l[A].x/this.scaleFactor-this.ptranx,l[A].y=l[A].y/this.scaleFactor-this.ptrany,l[A].z=l[A].z/this.scaleFactor-this.ptranz;let h=[];for(let A=0,g=this.faces.length;A<g;A+=3){let E=this.faces[A],M=this.faces[A+1],S=this.faces[A+2],R=l[E].atomid,O=l[M].atomid,$=l[S].atomid,G=R;O<G&&(G=O),$<G&&(G=$),s[G]&&E!==M&&M!==S&&E!==S&&(h.push(E),h.push(M),h.push(S))}return this.vpBits=null,this.vpDistance=null,this.vpAtomID=null,{vertices:l,faces:h}}initparm(i,s,l){l>1e6&&(this.scaleFactor=this.defaultScaleFactor/2);let h=1/this.scaleFactor*5.5;this.pminx=i[0][0],this.pmaxx=i[1][0],this.pminy=i[0][1],this.pmaxy=i[1][1],this.pminz=i[0][2],this.pmaxz=i[1][2],s?(this.pminx-=this.probeRadius+h,this.pminy-=this.probeRadius+h,this.pminz-=this.probeRadius+h,this.pmaxx+=this.probeRadius+h,this.pmaxy+=this.probeRadius+h,this.pmaxz+=this.probeRadius+h):(this.pminx-=h,this.pminy-=h,this.pminz-=h,this.pmaxx+=h,this.pmaxy+=h,this.pmaxz+=h),this.pminx=Math.floor(this.pminx*this.scaleFactor)/this.scaleFactor,this.pminy=Math.floor(this.pminy*this.scaleFactor)/this.scaleFactor,this.pminz=Math.floor(this.pminz*this.scaleFactor)/this.scaleFactor,this.pmaxx=Math.ceil(this.pmaxx*this.scaleFactor)/this.scaleFactor,this.pmaxy=Math.ceil(this.pmaxy*this.scaleFactor)/this.scaleFactor,this.pmaxz=Math.ceil(this.pmaxz*this.scaleFactor)/this.scaleFactor,this.ptranx=-this.pminx,this.ptrany=-this.pminy,this.ptranz=-this.pminz,this.pLength=Math.ceil(this.scaleFactor*(this.pmaxx-this.pminx))+1,this.pWidth=Math.ceil(this.scaleFactor*(this.pmaxy-this.pminy))+1,this.pHeight=Math.ceil(this.scaleFactor*(this.pmaxz-this.pminz))+1,this.boundingatom(s),this.cutRadius=this.probeRadius*this.scaleFactor,this.vpBits=new Uint8Array(this.pLength*this.pWidth*this.pHeight),this.vpDistance=new Float64Array(this.pLength*this.pWidth*this.pHeight),this.vpAtomID=new Int32Array(this.pLength*this.pWidth*this.pHeight)}boundingatom(i){let s={};for(const l in this.vdwRadii){let h=this.vdwRadii[l];s[l]=i?(h+this.probeRadius)*this.scaleFactor+.5:h*this.scaleFactor+.5;let A=s[l]*s[l];this.widxz[l]=Math.floor(s[l])+1,this.depty[l]=new Int32Array(this.widxz[l]*this.widxz[l]);let g=0;for(let E=0;E<this.widxz[l];E++)for(let M=0;M<this.widxz[l];M++){let S=E*E+M*M;if(S>A)this.depty[l][g]=-1;else{let R=Math.sqrt(A-S);this.depty[l][g]=Math.floor(R)}g++}}}fillvoxels(i,s){for(let l=0,h=this.vpBits.length;l<h;l++)this.vpBits[l]=0,this.vpDistance[l]=-1,this.vpAtomID[l]=-1;for(let l in s){let h=i[s[l]];h!==void 0&&this.fillAtom(h,i)}for(let l=0,h=this.vpBits.length;l<h;l++)this.vpBits[l]&this.INOUT&&(this.vpBits[l]|=this.ISDONE)}fillAtom(i,s){let l=Math.floor(.5+this.scaleFactor*(i.x+this.ptranx)),h=Math.floor(.5+this.scaleFactor*(i.y+this.ptrany)),A=Math.floor(.5+this.scaleFactor*(i.z+this.ptranz)),g=this.getVDWIndex(i),E=0,M=this.pWidth*this.pHeight;for(let S=0,R=this.widxz[g];S<R;S++)for(let O=0;O<R;O++){if(this.depty[g][E]!=-1){for(let $=-1;$<2;$++)for(let G=-1;G<2;G++)for(let j=-1;j<2;j++)if($!==0&&G!==0&&j!==0){let W=$*S,H=j*O;for(let Y=0;Y<=this.depty[g][E];Y++){let te=Y*G,re=l+W,de=h+te,le=A+H;if(re<0||de<0||le<0||re>=this.pLength||de>=this.pWidth||le>=this.pHeight)continue;let ye=re*M+de*this.pHeight+le;if(this.vpBits[ye]&this.INOUT){let Pe=s[this.vpAtomID[ye]];if(Pe.serial!=i.serial){let Te=l+W-Math.floor(.5+this.scaleFactor*(Pe.x+this.ptranx)),ke=h+te-Math.floor(.5+this.scaleFactor*(Pe.y+this.ptrany)),we=A+H-Math.floor(.5+this.scaleFactor*(Pe.z+this.ptranz));W*W+te*te+H*H<Te*Te+ke*ke+we*we&&(this.vpAtomID[ye]=i.serial)}}else this.vpBits[ye]|=this.INOUT,this.vpAtomID[ye]=i.serial}}}E++}}fillvoxelswaals(i,s){for(let l=0,h=this.vpBits.length;l<h;l++)this.vpBits[l]&=~this.ISDONE;for(let l in s){let h=i[s[l]];h!==void 0&&this.fillAtomWaals(h,i)}}fillAtomWaals(i,s){let l=0,h=Math.floor(.5+this.scaleFactor*(i.x+this.ptranx)),A=Math.floor(.5+this.scaleFactor*(i.y+this.ptrany)),g=Math.floor(.5+this.scaleFactor*(i.z+this.ptranz)),E=this.getVDWIndex(i),M=this.pWidth*this.pHeight;for(let S=0,R=this.widxz[E];S<R;S++)for(let O=0;O<R;O++){if(this.depty[E][l]!=-1){for(let $=-1;$<2;$++)for(let G=-1;G<2;G++)for(let j=-1;j<2;j++)if($!==0&&G!==0&&j!==0){let W=$*S,H=j*O;for(let Y=0;Y<=this.depty[E][l];Y++){let te=Y*G,re=h+W,de=A+te,le=g+H;if(re<0||de<0||le<0||re>=this.pLength||de>=this.pWidth||le>=this.pHeight)continue;let ye=re*M+de*this.pHeight+le;if(this.vpBits[ye]&this.ISDONE){let Pe=s[this.vpAtomID[ye]];if(Pe.serial!=i.serial){let Te=h+W-Math.floor(.5+this.scaleFactor*(Pe.x+this.ptranx)),ke=A+te-Math.floor(.5+this.scaleFactor*(Pe.y+this.ptrany)),we=g+H-Math.floor(.5+this.scaleFactor*(Pe.z+this.ptranz));W*W+te*te+H*H<Te*Te+ke*ke+we*we&&(this.vpAtomID[ye]=i.serial)}}else this.vpBits[ye]|=this.ISDONE,this.vpAtomID[ye]=i.serial}}}l++}}buildboundary(){let i=this.pWidth*this.pHeight;for(let s=0;s<this.pLength;s++)for(let l=0;l<this.pHeight;l++)for(let h=0;h<this.pWidth;h++){let A=s*i+h*this.pHeight+l;if(this.vpBits[A]&this.INOUT){let g=0;for(;g<26;){let E=s+this.nb[g][0],M=l+this.nb[g][2],S=h+this.nb[g][1];if(E>-1&&E<this.pLength&&S>-1&&S<this.pWidth&&M>-1&&M<this.pHeight&&!(this.vpBits[E*i+S*this.pHeight+M]&this.INOUT)){this.vpBits[A]|=this.ISBOUND;break}g++}}}}fastdistancemap(){let i,s=new ne(this.pLength,this.pWidth,this.pHeight),l=this.pWidth*this.pHeight,h=this.cutRadius*this.cutRadius,A=[],g=[];for(let S=0;S<this.pLength;S++)for(let R=0;R<this.pWidth;R++)for(let O=0;O<this.pHeight;O++)if(i=S*l+R*this.pHeight+O,this.vpBits[i]&=~this.ISDONE,this.vpBits[i]&this.INOUT&&this.vpBits[i]&this.ISBOUND){let $={ix:S,iy:R,iz:O};s.set(S,R,O,$),A.push($),this.vpDistance[i]=0,this.vpBits[i]|=this.ISDONE,this.vpBits[i]&=~this.ISBOUND}do{g=this.fastoneshell(A,s),A=[];for(let S=0,R=g.length;S<R;S++)i=l*g[S].ix+this.pHeight*g[S].iy+g[S].iz,this.vpBits[i]&=~this.ISBOUND,this.vpDistance[i]<=1.0404*h&&A.push({ix:g[S].ix,iy:g[S].iy,iz:g[S].iz})}while(A.length!==0);A=[],g=[],s=null;let E=this.scaleFactor-.5;E<0&&(E=0);let M=h-.5/(.1+E);for(let S=0;S<this.pLength;S++)for(let R=0;R<this.pWidth;R++)for(let O=0;O<this.pHeight;O++)i=S*l+R*this.pHeight+O,this.vpBits[i]&=~this.ISBOUND,this.vpBits[i]&this.INOUT&&(this.vpBits[i]&this.ISDONE&&!(this.vpBits[i]&this.ISDONE&&this.vpDistance[i]>=M)||(this.vpBits[i]|=this.ISBOUND))}fastoneshell(i,s){let l,h,A,g,E,M,S,R,O,$=[];if(i.length===0)return $;let G={ix:-1,iy:-1,iz:-1},j=this.pWidth*this.pHeight;for(let W=0,H=i.length;W<H;W++){l=i[W].ix,h=i[W].iy,A=i[W].iz,R=s.get(l,h,A);for(let Y=0;Y<6;Y++)G.ix=l+this.nb[Y][0],G.iy=h+this.nb[Y][1],G.iz=A+this.nb[Y][2],G.ix<this.pLength&&G.ix>-1&&G.iy<this.pWidth&&G.iy>-1&&G.iz<this.pHeight&&G.iz>-1&&(O=G.ix*j+this.pHeight*G.iy+G.iz,this.vpBits[O]&this.INOUT&&!(this.vpBits[O]&this.ISDONE)?(s.set(G.ix,G.iy,A+this.nb[Y][2],R),g=G.ix-R.ix,E=G.iy-R.iy,M=G.iz-R.iz,S=g*g+E*E+M*M,this.vpDistance[O]=S,this.vpBits[O]|=this.ISDONE,this.vpBits[O]|=this.ISBOUND,$.push({ix:G.ix,iy:G.iy,iz:G.iz})):this.vpBits[O]&this.INOUT&&this.vpBits[O]&this.ISDONE&&(g=G.ix-R.ix,E=G.iy-R.iy,M=G.iz-R.iz,S=g*g+E*E+M*M,S<this.vpDistance[O]&&(s.set(G.ix,G.iy,G.iz,R),this.vpDistance[O]=S,this.vpBits[O]&this.ISBOUND||(this.vpBits[O]|=this.ISBOUND,$.push({ix:G.ix,iy:G.iy,iz:G.iz})))))}for(let W=0,H=i.length;W<H;W++){l=i[W].ix,h=i[W].iy,A=i[W].iz,R=s.get(l,h,A);for(let Y=6;Y<18;Y++)G.ix=l+this.nb[Y][0],G.iy=h+this.nb[Y][1],G.iz=A+this.nb[Y][2],G.ix<this.pLength&&G.ix>-1&&G.iy<this.pWidth&&G.iy>-1&&G.iz<this.pHeight&&G.iz>-1&&(O=G.ix*j+this.pHeight*G.iy+G.iz,this.vpBits[O]&this.INOUT&&!(this.vpBits[O]&this.ISDONE)?(s.set(G.ix,G.iy,A+this.nb[Y][2],R),g=G.ix-R.ix,E=G.iy-R.iy,M=G.iz-R.iz,S=g*g+E*E+M*M,this.vpDistance[O]=S,this.vpBits[O]|=this.ISDONE,this.vpBits[O]|=this.ISBOUND,$.push({ix:G.ix,iy:G.iy,iz:G.iz})):this.vpBits[O]&this.INOUT&&this.vpBits[O]&this.ISDONE&&(g=G.ix-R.ix,E=G.iy-R.iy,M=G.iz-R.iz,S=g*g+E*E+M*M,S<this.vpDistance[O]&&(s.set(G.ix,G.iy,G.iz,R),this.vpDistance[O]=S,this.vpBits[O]&this.ISBOUND||(this.vpBits[O]|=this.ISBOUND,$.push({ix:G.ix,iy:G.iy,iz:G.iz})))))}for(let W=0,H=i.length;W<H;W++){l=i[W].ix,h=i[W].iy,A=i[W].iz,R=s.get(l,h,A);for(let Y=18;Y<26;Y++)G.ix=l+this.nb[Y][0],G.iy=h+this.nb[Y][1],G.iz=A+this.nb[Y][2],G.ix<this.pLength&&G.ix>-1&&G.iy<this.pWidth&&G.iy>-1&&G.iz<this.pHeight&&G.iz>-1&&(O=G.ix*j+this.pHeight*G.iy+G.iz,this.vpBits[O]&this.INOUT&&!(this.vpBits[O]&this.ISDONE)?(s.set(G.ix,G.iy,A+this.nb[Y][2],R),g=G.ix-R.ix,E=G.iy-R.iy,M=G.iz-R.iz,S=g*g+E*E+M*M,this.vpDistance[O]=S,this.vpBits[O]|=this.ISDONE,this.vpBits[O]|=this.ISBOUND,$.push({ix:G.ix,iy:G.iy,iz:G.iz})):this.vpBits[O]&this.INOUT&&this.vpBits[O]&this.ISDONE&&(g=G.ix-R.ix,E=G.iy-R.iy,M=G.iz-R.iz,S=g*g+E*E+M*M,S<this.vpDistance[O]&&(s.set(G.ix,G.iy,G.iz,R),this.vpDistance[O]=S,this.vpBits[O]&this.ISBOUND||(this.vpBits[O]|=this.ISBOUND,$.push({ix:G.ix,iy:G.iy,iz:G.iz})))))}return $}marchingcubeinit(i){for(let s=0,l=this.vpBits.length;s<l;s++)i==1?this.vpBits[s]&=~this.ISBOUND:i==4?(this.vpBits[s]&=~this.ISDONE,this.vpBits[s]&this.ISBOUND&&(this.vpBits[s]|=this.ISDONE),this.vpBits[s]&=~this.ISBOUND):i==2?this.vpBits[s]&this.ISBOUND&&this.vpBits[s]&this.ISDONE?this.vpBits[s]&=~this.ISBOUND:this.vpBits[s]&this.ISBOUND&&!(this.vpBits[s]&this.ISDONE)&&(this.vpBits[s]|=this.ISDONE):i==3&&(this.vpBits[s]&=~this.ISBOUND)}marchingcube(i){this.marchingcubeinit(i),this.verts=[],this.faces=[],xe.MarchingCube.march(this.vpBits,this.verts,this.faces,{smooth:1,nX:this.pLength,nY:this.pWidth,nZ:this.pHeight});let s=this.pWidth*this.pHeight;for(let l=0,h=this.verts.length;l<h;l++)this.verts[l].atomid=this.vpAtomID[this.verts[l].x*s+this.pHeight*this.verts[l].y+this.verts[l].z];xe.MarchingCube.laplacianSmooth(1,this.verts,this.faces)}}xe.MarchingCube=new Bt;var Ve=a(848);class Le{static finalizeGeo(i){var s=i.updateGeoGroup(0);s.vertices>0&&s.truncateArrayBuffers(!0,!0)}static updateColor(i,s){var l,h,A;s=s||_.CC.color(s),i.colorsNeedUpdate=!0,s.constructor!==Array&&(l=s.r,h=s.g,A=s.b);for(let g in i.geometryGroups){let E=i.geometryGroups[g],M=E.colorArray;for(let S=0,R=E.vertices;S<R;++S){if(s.constructor===Array){let O=s[S];l=O.r,h=O.g,A=O.b}M[3*S]=l,M[3*S+1]=h,M[3*S+2]=A}}}static drawArrow(i,s,l){var h=l.start,A=l.end,g=l.radius,E=l.radiusRatio,M=l.mid,S=l.midpos;if(!h||!A)return;var R=s.updateGeoGroup(51),O=new m.Vector3(A.x,A.y,A.z).sub(h);if(S){let hi=O.length();M=S>0?S/hi:(hi+S)/hi}O.multiplyScalar(M);var $=new m.Vector3(h.x,h.y,h.z).add(O),G=O.clone().negate();let j=new m.Vector3(h.x,h.y,h.z);i.intersectionShape.cylinder.push(new v.Cylinder(j,$.clone(),g)),i.intersectionShape.sphere.push(new v.Sphere(j,g));var W=[];W[0]=O.clone(),Math.abs(W[0].x)>1e-4?W[0].y+=1:W[0].x+=1,W[0].cross(O),W[0].normalize(),W[4]=W[0].clone(),W[4].crossVectors(W[0],O),W[4].normalize(),W[8]=W[0].clone().negate(),W[12]=W[4].clone().negate(),W[2]=W[0].clone().add(W[4]).normalize(),W[6]=W[4].clone().add(W[8]).normalize(),W[10]=W[8].clone().add(W[12]).normalize(),W[14]=W[12].clone().add(W[0]).normalize(),W[1]=W[0].clone().add(W[2]).normalize(),W[3]=W[2].clone().add(W[4]).normalize(),W[5]=W[4].clone().add(W[6]).normalize(),W[7]=W[6].clone().add(W[8]).normalize(),W[9]=W[8].clone().add(W[10]).normalize(),W[11]=W[10].clone().add(W[12]).normalize(),W[13]=W[12].clone().add(W[14]).normalize(),W[15]=W[14].clone().add(W[0]).normalize();var H,Y,te,re,de,le,ye,Pe,Te,ke,we,Ge,Je,tt,Ye,ut,ft,Qe,pt,Be,et,St,ot=R.vertices,wt=R.vertexArray,At=R.faceArray,it=R.normalArray,Rt=R.lineArray;for(Y=0,te=W.length;Y<te;++Y){H=3*(ot+3*Y);var Ht=W[Y].clone().multiplyScalar(g).add(h),kt=W[Y].clone().multiplyScalar(g).add($),ct=W[Y].clone().multiplyScalar(g*E).add($);if(wt[H]=Ht.x,wt[H+1]=Ht.y,wt[H+2]=Ht.z,wt[H+3]=kt.x,wt[H+4]=kt.y,wt[H+5]=kt.z,wt[H+6]=ct.x,wt[H+7]=ct.y,wt[H+8]=ct.z,Y>0){var Jt=wt[H-3],Nt=wt[H-2],qt=wt[H-1],Vt=new m.Vector3(Jt,Nt,qt),Xt=new m.Vector3(A.x,A.y,A.z),yr=$.clone(),Fr=new m.Vector3(ct.x,ct.y,ct.z);i.intersectionShape.triangle.push(new v.Triangle(Fr,Xt,Vt)),i.intersectionShape.triangle.push(new v.Triangle(Vt.clone(),yr,Fr.clone()))}}R.vertices+=48,wt[H=3*R.vertices]=h.x,wt[H+1]=h.y,wt[H+2]=h.z,wt[H+3]=$.x,wt[H+4]=$.y,wt[H+5]=$.z,wt[H+6]=A.x,wt[H+7]=A.y,wt[H+8]=A.z,R.vertices+=3;var Tr=R.vertices-3,ii=R.vertices-2,Wr=R.vertices-1,br=3*Tr,$r=3*ii,ci=3*Wr;for(Y=0,te=W.length-1;Y<te;++Y){var ni=ot+3*Y;H=3*ni,de=R.faceidx,le=R.lineidx,Je=3*(ye=ni),tt=3*(Pe=ni+1),Ye=3*(Te=ni+2),ut=3*(ke=ni+4),ft=3*(we=ni+5),Qe=3*(Ge=ni+3),pt=Be=W[Y],et=St=W[Y+1],it[Je]=pt.x,it[tt]=Be.x,it[Qe]=St.x,it[Je+1]=pt.y,it[tt+1]=Be.y,it[Qe+1]=St.y,it[Je+2]=pt.z,it[tt+2]=Be.z,it[Qe+2]=St.z,it[tt]=Be.x,it[ut]=et.x,it[Qe]=St.x,it[tt+1]=Be.y,it[ut+1]=et.y,it[Qe+1]=St.y,it[tt+2]=Be.z,it[ut+2]=et.z,it[Qe+2]=St.z,it[Ye]=Be.x,it[ft]=et.x,it[Ye+1]=Be.y,it[ft+1]=et.y,it[Ye+2]=Be.z,it[ft+2]=et.z,At[de]=ye,At[de+1]=Pe,At[de+2]=Ge,At[de+3]=Pe,At[de+4]=ke,At[de+5]=Ge,At[de+6]=ye,At[de+7]=Ge,At[de+8]=Tr,At[de+9]=Te,At[de+10]=ii,At[de+11]=we,At[de+12]=Te,At[de+13]=Wr,At[de+14]=we,Rt[le]=ye,Rt[le+1]=Pe,Rt[le+2]=ye,Rt[le+3]=Ge,Rt[le+4]=ke,Rt[le+5]=Ge,Rt[le+6]=ye,Rt[le+7]=Ge,Rt[le+8]=Te,Rt[le+9]=Pe,Rt[le+10]=Te,Rt[le+11]=we,Rt[le+12]=ke,Rt[le+13]=we,Rt[le+14]=Te,Rt[le+15]=Wr,Rt[le+16]=Te,Rt[le+17]=we,Rt[le+18]=Wr,Rt[le+19]=we,R.faceidx+=15,R.lineidx+=20}re=[ot+45,ot+46,ot+1,ot,ot+47,ot+2],de=R.faceidx,le=R.lineidx,Je=3*(ye=re[0]),tt=3*(Pe=re[1]),Ye=3*(Te=re[4]),ut=3*(ke=re[2]),ft=3*(we=re[5]),Qe=3*(Ge=re[3]),pt=Be=W[15],et=St=W[0],it[Je]=pt.x,it[tt]=Be.x,it[Qe]=St.x,it[Je+1]=pt.y,it[tt+1]=Be.y,it[Qe+1]=St.y,it[Je+2]=pt.z,it[tt+2]=Be.z,it[Qe+2]=St.z,it[tt]=Be.x,it[ut]=et.x,it[Qe]=St.x,it[tt+1]=Be.y,it[ut+1]=et.y,it[Qe+1]=St.y,it[tt+2]=Be.z,it[ut+2]=et.z,it[Qe+2]=St.z,it[Ye]=Be.x,it[ft]=et.x,it[Ye+1]=Be.y,it[ft+1]=et.y,it[Ye+2]=Be.z,it[ft+2]=et.z,O.normalize(),G.normalize(),it[br]=G.x,it[$r]=it[ci]=O.x,it[br+1]=G.y,it[$r+1]=it[ci+1]=O.y,it[br+2]=G.z,it[$r+2]=it[ci+2]=O.z,At[de]=ye,At[de+1]=Pe,At[de+2]=Ge,At[de+3]=Pe,At[de+4]=ke,At[de+5]=Ge,At[de+6]=ye,At[de+7]=Ge,At[de+8]=Tr,At[de+9]=Te,At[de+10]=ii,At[de+11]=we,At[de+12]=Te,At[de+13]=Wr,At[de+14]=we,Rt[le]=ye,Rt[le+1]=Pe,Rt[le+2]=ye,Rt[le+3]=Ge,Rt[le+4]=ke,Rt[le+5]=Ge,Rt[le+6]=ye,Rt[le+7]=Ge,Rt[le+8]=Te,Rt[le+9]=Pe,Rt[le+10]=Te,Rt[le+11]=we,Rt[le+12]=ke,Rt[le+13]=we,Rt[le+14]=Te,Rt[le+15]=Wr,Rt[le+16]=Te,Rt[le+17]=we,Rt[le+18]=Wr,Rt[le+19]=we,R.faceidx+=15,R.lineidx+=20}static updateBoundingFromPoints(i,s,l,h){i.center.set(0,0,0);let A=1/0,g=1/0,E=1/0,M=-1/0,S=-1/0,R=-1/0;i.box&&(A=i.box.min.x,M=i.box.max.x,g=i.box.min.y,S=i.box.max.y,E=i.box.min.z,R=i.box.max.z);for(let j=0,W=h;j<W;j++){var O=l[3*j],$=l[3*j+1],G=l[3*j+2];O<A&&(A=O),$<g&&(g=$),G<E&&(E=G),O>M&&(M=O),$>S&&(S=$),G>R&&(R=G)}i.center.set((M+A)/2,(S+g)/2,(R+E)/2),i.radius=i.center.distanceTo({x:M,y:S,z:R}),i.box={min:{x:A,y:g,z:E},max:{x:M,y:S,z:R}}}static addCustomGeo(i,s,l,h,A){var g,E,M,S,R,O,$,G,j,W=s.addGeoGroup(),H=l.vertexArr,Y=l.normalArr,te=l.faceArr;W.vertices=H.length,W.faceidx=te.length;var re=W.vertexArray,de=W.colorArray;for(h.constructor!==Array&&(G=h.r,j=h.g,S=h.b),O=0,$=W.vertices;O<$;++O)g=3*O,E=H[O],re[g]=E.x,re[g+1]=E.y,re[g+2]=E.z,h.constructor===Array&&(G=(R=h[O]).r,j=R.g,S=R.b),de[g]=G,de[g+1]=j,de[g+2]=S;if(A)for(O=0,$=W.faceidx/3;O<$;++O){M=te[g=3*O],S=te[g+1],R=te[g+2];var le=new m.Vector3,ye=new m.Vector3,Pe=new m.Vector3;i.intersectionShape.triangle.push(new v.Triangle(le.copy(H[M]),ye.copy(H[S]),Pe.copy(H[R])))}if(A){var Te=new m.Vector3(0,0,0),ke=0;for(let Je=0;Je<s.geometryGroups.length;Je++)Te.add(s.geometryGroups[Je].getCentroid()),ke++;Te.divideScalar(ke),Le.updateBoundingFromPoints(i.boundingSphere,{centroid:Te},re,W.vertices)}if(W.faceArray=new Uint16Array(te),W.truncateArrayBuffers(!0,!0),Y.length<W.vertices)W.setNormals();else{var we,Ge=W.normalArray=new Float32Array(3*W.vertices);for(O=0,$=W.vertices;O<$;++O)g=3*O,we=Y[O],Ge[g]=we.x,Ge[g+1]=we.y,Ge[g+2]=we.z}W.setLineIndices(),W.lineidx=W.lineArray.length}static updateFromStyle(i,s){s.color!==void 0?(i.color=s.color||new _.Color,s.color instanceof _.Color||(i.color=_.CC.color(s.color))):i.color=_.CC.color(0),i.wireframe=!!s.wireframe,i.opacity=s.alpha?(0,m.clamp)(s.alpha,0,1):1,s.opacity!==void 0&&(i.opacity=(0,m.clamp)(s.opacity,0,1)),i.side=s.side!==void 0?s.side:u.DoubleSide,i.linewidth=s.linewidth===void 0?1:s.linewidth,i.clickable=!!s.clickable,i.callback=(0,w.makeFunction)(s.callback),i.hoverable=!!s.hoverable,i.hover_callback=(0,w.makeFunction)(s.hover_callback),i.unhover_callback=(0,w.makeFunction)(s.unhover_callback),i.contextMenuEnabled=!!s.contextMenuEnabled,i.hidden=s.hidden,i.frame=s.frame}constructor(i){this.color=16777215,this.hidden=!1,this.wireframe=!1,this.opacity=1,this.linewidth=1,this.clickable=!1,this.hoverable=!1,this.contextMenuEnabled=!1,this.side=u.DoubleSide,this.stylespec=i||{},this.boundingSphere=new v.Sphere,this.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},Le.updateFromStyle(this,this.stylespec),this.components=[],this.shapeObj=null,this.renderedShapeObj=null,this.geo=new u.Geometry(!0),this.linegeo=new u.Geometry(!0)}updateStyle(i){for(var s in i)this.stylespec[s]=i[s];if(Le.updateFromStyle(this,this.stylespec),i.voldata&&i.volscheme){(0,w.adjustVolumeStyle)(i);const l=i.volscheme,h=i.voldata,A=_.CC,g=l.range()||[-1,1];this.geo.setColors(function(E,M,S){let R=h.getVal(E,M,S);return A.color(l.valueToHex(R,g))}),delete this.color}}addCustom(i){i.vertexArr=i.vertexArr||[],i.faceArr=i.faceArr||[],i.normalArr=i.normalArr||[],Le.drawCustom(this,this.geo,i)}addSphere(i){i.center||(i.center=new m.Vector3(0,0,0)),i.radius=i.radius?(0,m.clamp)(i.radius,0,1/0):1.5,i.color=_.CC.color(i.color),this.intersectionShape.sphere.push(new v.Sphere(i.center,i.radius)),p.drawSphere(this.geo,i.center,i.radius,i.color,i.quality),this.components.push({centroid:new m.Vector3(i.center.x,i.center.y,i.center.z)});var s=this.geo.updateGeoGroup(0);Le.updateBoundingFromPoints(this.boundingSphere,this.components,s.vertexArray,s.vertices)}addBox(i){var s,l,h,A=i.dimensions||{w:1,h:1,d:1};s=typeof A.w=="number"?{x:A.w,y:0,z:0}:A.w,l=typeof A.h=="number"?{x:0,y:A.h,z:0}:A.h,h=typeof A.d=="number"?{x:0,y:0,z:A.d}:A.d;var g=i.corner;g==null&&(g=i.center!==void 0?{x:i.center.x-.5*(s.x+l.x+h.x),y:i.center.y-.5*(s.y+l.y+h.y),z:i.center.z-.5*(s.z+l.z+h.z)}:{x:0,y:0,z:0});var E=[{x:g.x,y:g.y,z:g.z},{x:g.x+s.x,y:g.y+s.y,z:g.z+s.z},{x:g.x+l.x,y:g.y+l.y,z:g.z+l.z},{x:g.x+s.x+l.x,y:g.y+s.y+l.y,z:g.z+s.z+l.z},{x:g.x+h.x,y:g.y+h.y,z:g.z+h.z},{x:g.x+s.x+h.x,y:g.y+s.y+h.y,z:g.z+s.z+h.z},{x:g.x+l.x+h.x,y:g.y+l.y+h.y,z:g.z+l.z+h.z},{x:g.x+s.x+l.x+h.x,y:g.y+s.y+l.y+h.y,z:g.z+s.z+l.z+h.z}],M=[],S=[];M.splice(M.length,0,E[0],E[1],E[2],E[3]),S.splice(S.length,0,0,2,1,1,2,3);var R=4;M.splice(M.length,0,E[2],E[3],E[6],E[7]),S.splice(S.length,0,R+0,R+2,R+1,R+1,R+2,R+3),R+=4,M.splice(M.length,0,E[4],E[5],E[0],E[1]),S.splice(S.length,0,R+0,R+2,R+1,R+1,R+2,R+3),R+=4,M.splice(M.length,0,E[6],E[7],E[4],E[5]),S.splice(S.length,0,R+0,R+2,R+1,R+1,R+2,R+3),R+=4,M.splice(M.length,0,E[3],E[1],E[7],E[5]),S.splice(S.length,0,R+0,R+2,R+1,R+1,R+2,R+3),R+=4,M.splice(M.length,0,E[2],E[6],E[0],E[4]),S.splice(S.length,0,R+0,R+2,R+1,R+1,R+2,R+3),R+=4;var O=(0,w.extend)({},i);O.vertexArr=M,O.faceArr=S,O.normalArr=[],Le.drawCustom(this,this.geo,O);var $=new m.Vector3;this.components.push({centroid:$.addVectors(E[0],E[7]).multiplyScalar(.5)});var G=this.geo.updateGeoGroup(0);Le.updateBoundingFromPoints(this.boundingSphere,this.components,G.vertexArray,G.vertices)}addCylinder(i){var s,l;s=i.start?new m.Vector3(i.start.x||0,i.start.y||0,i.start.z||0):new m.Vector3(0,0,0),i.end?(l=new m.Vector3(i.end.x,i.end.y||0,i.end.z||0)).x===void 0&&(l.x=3):l=new m.Vector3(0,0,0);var h=i.radius||.1,A=_.CC.color(i.color);this.intersectionShape.cylinder.push(new v.Cylinder(s,l,h)),p.drawCylinder(this.geo,s,l,h,A,i.fromCap,i.toCap);var g=new m.Vector3;this.components.push({centroid:g.addVectors(s,l).multiplyScalar(.5)});var E=this.geo.updateGeoGroup(0);Le.updateBoundingFromPoints(this.boundingSphere,this.components,E.vertexArray,E.vertices)}addDashedCylinder(i){var s,l;i.dashLength=i.dashLength||.25,i.gapLength=i.gapLength||.25,s=i.start?new m.Vector3(i.start.x||0,i.start.y||0,i.start.z||0):new m.Vector3(0,0,0),i.end?(l=new m.Vector3(i.end.x,i.end.y||0,i.end.z||0)).x===void 0&&(l.x=3):l=new m.Vector3(3,0,0);for(var h=i.radius||.1,A=_.CC.color(i.color),g=Math.sqrt(Math.pow(s.x-l.x,2)+Math.pow(s.y-l.y,2)+Math.pow(s.z-l.z,2)),E=g/(i.gapLength+i.dashLength),M=new m.Vector3(i.start.x||0,i.start.y||0,i.start.z||0),S=new m.Vector3(i.end.x,i.end.y||0,i.end.z||0),R=new m.Vector3((l.x-s.x)/(g/i.gapLength),(l.y-s.y)/(g/i.gapLength),(l.z-s.z)/(g/i.gapLength)),O=new m.Vector3((l.x-s.x)/(g/i.dashLength),(l.y-s.y)/(g/i.dashLength),(l.z-s.z)/(g/i.dashLength)),$=0;$<E;$++)S=new m.Vector3(M.x+O.x,M.y+O.y,M.z+O.z),this.intersectionShape.cylinder.push(new v.Cylinder(M,S,h)),p.drawCylinder(this.geo,M,S,h,A,i.fromCap,i.toCap),M=new m.Vector3(S.x+R.x,S.y+R.y,S.z+R.z);var G=new m.Vector3;this.components.push({centroid:G.addVectors(s,l).multiplyScalar(.5)});var j=this.geo.updateGeoGroup(0);Le.updateBoundingFromPoints(this.boundingSphere,this.components,j.vertexArray,j.vertices)}addCurve(i){i.points=i.points||[],i.smooth=i.smooth||10,i.fromCap===void 0&&(i.fromCap=2),i.toCap===void 0&&(i.toCap=2);var s=k(i.points,i.smooth);if(s.length<3)console.log("Too few points in addCurve");else{var l=i.radius||.1,h=_.CC.color(i.color),A=0,g=s.length-1,E=s[0].distanceTo(s[1]),M=Math.ceil(2*l/E);if(i.toArrow){let $={start:s[g-=M],end:s[s.length-1],radius:l,color:h,mid:1e-4};this.addArrow($)}if(i.fromArrow){let $={start:s[A+=M],end:s[0],radius:l,color:h,mid:1e-4};this.addArrow($)}for(var S=Math.ceil(s.length/2),R={radius:l,color:h,fromCap:2,toCap:2},O=A;O<g;O++)R.start=s[O],R.end=s[O+1],R.fromCap=2,R.toCap=2,O<S?(R.fromCap=2,R.toCap=0):O>S?(R.fromCap=0,R.toCap=2):(R.fromCap=2,R.toCap=2),this.addCylinder(R)}}addLine(i){var s,l;s=i.start?new m.Vector3(i.start.x||0,i.start.y||0,i.start.z||0):new m.Vector3(0,0,0),i.end?(l=new m.Vector3(i.end.x,i.end.y||0,i.end.z||0)).x===void 0&&(l.x=3):l=new m.Vector3(3,0,0);var h=this.geo.updateGeoGroup(2),A=h.vertices,g=3*A,E=h.vertexArray;E[g]=s.x,E[g+1]=s.y,E[g+2]=s.z,E[g+3]=l.x,E[g+4]=l.y,E[g+5]=l.z,h.vertices+=2;var M=h.lineArray,S=h.lineidx;M[S]=A,M[S+1]=A+1,h.lineidx+=2;var R=new m.Vector3;this.components.push({centroid:R.addVectors(s,l).multiplyScalar(.5)}),h=this.geo.updateGeoGroup(0),Le.updateBoundingFromPoints(this.boundingSphere,this.components,h.vertexArray,h.vertices)}addArrow(i){if(i.start?i.start=new m.Vector3(i.start.x||0,i.start.y||0,i.start.z||0):i.start=new m.Vector3(0,0,0),i.dir instanceof m.Vector3&&typeof i.length=="number"){var s=i.dir.clone().multiplyScalar(i.length).add(i.start);i.end=s}else i.end?(i.end=new m.Vector3(i.end.x,i.end.y||0,i.end.z||0),i.end.x===void 0&&(i.end.x=3)):i.end=new m.Vector3(3,0,0);i.radius=i.radius||.1,i.radiusRatio=i.radiusRatio||1.618034,i.mid=0<i.mid&&i.mid<1?i.mid:.618034,Le.drawArrow(this,this.geo,i);var l=new m.Vector3;this.components.push({centroid:l.addVectors(i.start,i.end).multiplyScalar(.5)});var h=this.geo.updateGeoGroup(0);Le.updateBoundingFromPoints(this.boundingSphere,this.components,h.vertexArray,h.vertices)}static distance_from(i,s){return Math.sqrt(Math.pow(i.x-s.x,2)+Math.pow(i.y-s.y,2)+Math.pow(i.z-s.z,2))}static inSelectedRegion(i,s,l){for(var h=0;h<s.length;h++)if(Le.distance_from(s[h],i)<=l)return!0;return!1}addIsosurface(i,s,l,h){var A,g,E=s.isoval!==void 0&&typeof s.isoval=="number"?s.isoval:0,M=!!s.voxel,S=s.smoothness===void 0?1:s.smoothness,R=i.size.x,O=i.size.y,$=i.size.z,G=new Int16Array(R*O*$),j=i.data;for(A=0,g=G.length;A<g;++A)G[A]=-1;var W=new Uint8Array(R*O*$);for(A=0,g=j.length;A<g;++A)(E>=0?j[A]-E:E-j[A])>0&&(W[A]|=Le.ISDONE);var H=[],Y=[];x.march(W,H,Y,{fulltable:!0,voxel:M,unitCube:i.unit,origin:i.origin,matrix:i.matrix,nX:R,nY:O,nZ:$}),!M&&S>0&&x.laplacianSmooth(S,H,Y);var te=[],re=[],de=[];if(s.selectedRegion&&s.coords===void 0&&(s.coords=s.selectedRegion),s.coords===void 0&&s.selection!==void 0&&(h?s.coords=h.selectedAtoms(s.selection):console.log("addIsosurface needs viewer is selection provided.")),s.coords!==void 0){var le=s.coords[0].x,ye=s.coords[0].y,Pe=s.coords[0].z,Te=s.coords[0].x,ke=s.coords[0].y,we=s.coords[0].z;for(let Be=0;Be<s.coords.length;Be++)s.coords[Be].x>le?le=s.coords[Be].x:s.coords[Be].x<Te&&(Te=s.coords[Be].x),s.coords[Be].y>ye?ye=s.coords[Be].y:s.coords[Be].y<ke&&(ke=s.coords[Be].y),s.coords[Be].z>Pe?Pe=s.coords[Be].z:s.coords[Be].z<we&&(we=s.coords[Be].z);var Ge=2;s.radius!==void 0&&(Ge=s.radius),s.selectedOffset!==void 0&&(Ge=s.selectedOffset),s.seldist!==void 0&&(Ge=s.seldist),Te-=Ge,le+=Ge,ke-=Ge,ye+=Ge,we-=Ge,Pe+=Ge;for(let Be=0;Be<H.length;Be++)H[Be].x>Te&&H[Be].x<le&&H[Be].y>ke&&H[Be].y<ye&&H[Be].z>we&&H[Be].z<Pe&&Le.inSelectedRegion(H[Be],s.coords,Ge)?(te.push(re.length),re.push(H[Be])):te.push(-1);for(let Be=0;Be+2<Y.length;Be+=3)te[Y[Be]]!==-1&&te[Y[Be+1]]!==-1&&te[Y[Be+2]]!==-1&&(de.push(Y[Be]-(Y[Be]-te[Y[Be]])),de.push(Y[Be+1]-(Y[Be+1]-te[Y[Be+1]])),de.push(Y[Be+2]-(Y[Be+2]-te[Y[Be+2]])));H=re,Y=de}Le.drawCustom(this,this.geo,{vertexArr:H,faceArr:Y,normalArr:[],clickable:s.clickable,hoverable:s.hoverable}),this.updateStyle(s);var Je=new m.Vector3(i.origin.x,i.origin.y,i.origin.z),tt=new m.Vector3(i.size.x*i.unit.x,i.size.y*i.unit.y,i.size.z*i.unit.z),Ye=new m.Vector3(0,0,0),ut=Je.clone(),ft=Je.clone().add(tt);for(let Be=0;Be<H.length;Be++)Ye.add(H[Be]),ut.max(H[Be]),ft.min(H[Be]);Ye.divideScalar(H.length);var Qe=Ye.distanceTo(ft),pt=Ye.distanceTo(ut);this.boundingSphere.center=Ye,this.boundingSphere.radius=Math.max(Qe,pt),typeof l=="function"&&l()}addVolumetricData(i,s,l){i=new Ve.VolumeData(i,s),this.addIsosurface(i,l)}finalize(){return Le.finalizeGeo(this.geo),this.geo.initTypedArrays(),this.geo}globj(i){if(this.renderedShapeObj&&(i.remove(this.renderedShapeObj),this.renderedShapeObj=null),!this.hidden){Le.finalizeGeo(this.geo),this.geo.initTypedArrays(),this.wireframe&&this.geo.setUpWireframe(),this.color!==void 0&&Le.updateColor(this.geo,this.color),this.shapeObj=new u.Object3D;var s=null;s=this.side==u.DoubleSide?new u.MeshDoubleLambertMaterial({wireframe:this.wireframe,side:this.side,transparent:this.opacity<1,opacity:this.opacity,wireframeLinewidth:this.linewidth,vertexColors:u.Coloring.VertexColors}):new u.MeshLambertMaterial({wireframe:this.wireframe,side:this.side,transparent:this.opacity<1,opacity:this.opacity,wireframeLinewidth:this.linewidth,vertexColors:u.Coloring.VertexColors});var l=new u.Mesh(this.geo,s);if(this.shapeObj.add(l),this.linegeo&&this.linegeo.vertices>0){var h=new u.LineBasicMaterial({linewidth:this.linewidth,color:this.color}),A=new u.Line(this.linegeo,h,u.LineStyle.LinePieces);this.shapeObj.add(A)}this.renderedShapeObj=this.shapeObj.clone(),i.add(this.renderedShapeObj)}}removegl(i){this.renderedShapeObj&&(this.renderedShapeObj.geometry!==void 0&&this.renderedShapeObj.geometry.dispose(),this.renderedShapeObj.material!==void 0&&this.renderedShapeObj.material.dispose(),i.remove(this.renderedShapeObj),this.renderedShapeObj=null),this.shapeObj=null}get position(){return this.boundingSphere.center}get x(){return this.boundingSphere.center.x}get y(){return this.boundingSphere.center.y}get z(){return this.boundingSphere.center.z}}function yt(ae){if(ae.vertexArr.length<64e3)return[ae];var i=[{vertexArr:[],normalArr:[],faceArr:[]}];ae.colorArr&&(i.colorArr=[]);var s=[],l=[],h=0,A=ae.faceArr;for(let E=0,M=A.length;E<M;E+=3){let S=i[h];for(let R=0;R<3;R++){var g=A[E+R];s[g]!==h&&(s[g]=h,l[g]=S.vertexArr.length,S.vertexArr.push(ae.vertexArr[g]),ae.normalArr&&ae.normalArr[g]&&S.normalArr.push(ae.normalArr[g]),ae.colorArr&&ae.colorArr[g]&&S.colorArr.push(ae.colorArr[g])),S.faceArr.push(l[g])}S.vertexArr.length>=64e3&&(i.push({vertexArr:[],normalArr:[],faceArr:[]}),ae.colorArr&&(i.colorArr=[]),h++)}return i}Le.ISDONE=2,Le.drawCustom=function(ae,i,s){var l=s,h=l.vertexArr,A=l.faceArr;h.length!==0&&A.length!==0||console.warn("Error adding custom shape component: No vertices and/or face indices supplied!");var g=s.color;g===void 0&&(g=ae.color),g=_.CC.color(g);for(var E=yt(l),M=0,S=E.length;M<S;M++)Le.addCustomGeo(ae,i,E[M],E[M].colorArr?E[M].colorArr:g,s.clickable)};let lt=0;function mt(ae,i,s){var l=s;return ae!==void 0&&(ae instanceof _.Color?l=ae.scaled():(l=_.CC.color(ae)).scaled!==void 0&&(l=l.scaled())),i!==void 0&&(l.a=parseFloat(i)),l}class Mt{constructor(i,s){this.id=lt++,this.stylespec=s||{},this.canvas=document.createElement("canvas"),this.canvas.width=134,this.canvas.height=35,this.context=this.canvas.getContext("2d"),this.sprite=new u.Sprite,this.text=i,this.frame=this.stylespec.frame}getStyle(){return this.stylespec}hide(){this.sprite&&(this.sprite.visible=!1)}show(){this.sprite&&(this.sprite.visible=!0)}setContext(){var i=this.stylespec,s=i.useScreen!==void 0&&i.useScreen,l=i.showBackground;l!=="0"&&l!=="false"||(l=!1),l===void 0&&(l=!0);var h=i.font?i.font:"sans-serif",A=parseInt(i.fontSize)?parseInt(i.fontSize):18,g=mt(i.fontColor,i.fontOpacity,{r:255,g:255,b:255,a:1}),E=i.padding?i.padding:4,M=i.borderThickness?i.borderThickness:0,S=mt(i.backgroundColor,i.backgroundOpacity,{r:0,g:0,b:0,a:1}),R=mt(i.borderColor,i.borderOpacity,S),O=i.position?i.position:{x:-10,y:1,z:1},$=i.inFront===void 0||i.inFront;$!=="false"&&$!=="0"||($=!1);var G=i.alignment||u.SpriteAlignment.topLeft;typeof G=="string"&&G in u.SpriteAlignment&&(G=u.SpriteAlignment[G]);var j="";i.bold&&(j="bold "),this.context.font=j+A+"px  "+h;var W=this.context.measureText(this.text).width;l||(M=0);var H=W+2.5*M+2*E,Y=1.25*A+2*M+2*E;if(i.backgroundImage){var te=i.backgroundImage,re=i.backgroundWidth?i.backgroundWidth:te.width,de=i.backgroundHeight?i.backgroundHeight:te.height;re>H&&(H=re),de>Y&&(Y=de)}if(this.canvas.width=H,this.canvas.height=Y,this.context.clearRect(0,0,this.canvas.width,this.canvas.height),j="",i.bold&&(j="bold "),this.context.font=j+A+"px  "+h,this.context.fillStyle="rgba("+S.r+","+S.g+","+S.b+","+S.a+")",this.context.strokeStyle="rgba("+R.r+","+R.g+","+R.b+","+R.a+")",i.backgroundGradient){let ye=this.context.createLinearGradient(0,Y/2,H,Y/2),Pe=C.Gradient.getGradient(i.backgroundGradient),Te=Pe.range(),ke=-1,we=1;Te&&(ke=Te[0],we=Te[1]);let Ge=we-ke;for(let Je=0;Je<1.01;Je+=.1){let tt=mt(Pe.valueToHex(ke+Ge*Je)),Ye="rgba("+tt.r+","+tt.g+","+tt.b+","+tt.a+")";ye.addColorStop(Je,Ye)}this.context.fillStyle=ye}this.context.lineWidth=M,l&&(function(ye,Pe,Te,ke,we,Ge,Je){ye.beginPath(),ye.moveTo(Pe+Ge,Te),ye.lineTo(Pe+ke-Ge,Te),ye.quadraticCurveTo(Pe+ke,Te,Pe+ke,Te+Ge),ye.lineTo(Pe+ke,Te+we-Ge),ye.quadraticCurveTo(Pe+ke,Te+we,Pe+ke-Ge,Te+we),ye.lineTo(Pe+Ge,Te+we),ye.quadraticCurveTo(Pe,Te+we,Pe,Te+we-Ge),ye.lineTo(Pe,Te+Ge),ye.quadraticCurveTo(Pe,Te,Pe+Ge,Te),ye.closePath(),ye.fill(),Je&&ye.stroke()})(this.context,M,M,H-2*M,Y-2*M,6,M>0),i.backgroundImage&&this.context.drawImage(te,0,0,H,Y),this.context.fillStyle="rgba("+g.r+","+g.g+","+g.b+","+g.a+")",this.context.fillText(this.text,M+E,A+M+E,W);var le=new u.Texture(this.canvas);le.needsUpdate=!0,this.sprite.material=new u.SpriteMaterial({map:le,useScreenCoordinates:s,alignment:G,depthTest:!$,screenOffset:i.screenOffset||null}),this.sprite.scale.set(1,1,1),this.sprite.position.set(O.x,O.y,O.z)}dispose(){this.sprite.material.map!==void 0&&this.sprite.material.map.dispose(),this.sprite.material!==void 0&&this.sprite.material.dispose()}}class Pt{static interpolateArray(i,s){function l(O,$,G){return O+($-O)*G}var h=[],A=(i.length-1)/(s-1);h[0]=i[0];for(var g=1;g<s-1;g++){var E=g*A,M=Math.floor(E),S=Math.ceil(E),R=E-M;h[g]=l(i[M],i[S],R)}return h[s-1]=i[i.length-1],h}constructor(i,s,l){this.hidden=!1,this.boundingSphere=new v.Sphere,this.renderedShapeObj=null,this.shapeObj=null,this.subsamples=5,this.data=null,this.transferfunctionbuffer=[],this.min=0,this.max=0,s=s||{};var h,A,g,E,M,S,R,O,$,G,j=Object.assign([],s.transferfn);this.subsamples=s.subsamples||5,j.forEach(function(H){H.value=parseFloat(H.value)}),j.sort(function(H,Y){return H.value-Y.value}),this.min=j[0].value,j.length==0&&j.push(j[0]),this.max=j[j.length-1].value;for(let H=0;H<j.length-1;H++)if(g=_.CC.color(j[H].color),E=_.CC.color(j[H+1].color),$=j[H].opacity,G=j[H+1].opacity,(h=Math.floor(256*(j[H].value-this.min)/(this.max-this.min)))!=(A=Math.floor(256*(j[H+1].value-this.min)/(this.max-this.min)))){M=Pt.interpolateArray([255*g.r,255*E.r],A-h),S=Pt.interpolateArray([255*g.g,255*E.g],A-h),R=Pt.interpolateArray([255*g.b,255*E.b],A-h),O=Pt.interpolateArray([255*$,255*G],A-h);for(let Y=0;Y<M.length;Y++)this.transferfunctionbuffer.push(M[Y]),this.transferfunctionbuffer.push(S[Y]),this.transferfunctionbuffer.push(R[Y]),this.transferfunctionbuffer.push(O[Y])}if(this.transferfunctionbuffer=new Uint8ClampedArray(this.transferfunctionbuffer),i.matrix){let H=new m.Vector3(0,0,0),Y=new m.Vector3(i.size.x,i.size.y,i.size.z),te=new m.Vector3(1,1,1);H.applyMatrix4(i.matrix),Y.applyMatrix4(i.matrix),te.applyMatrix4(i.matrix).sub(H),this.extent=[[H.x,H.y,H.z],[Y.x,Y.y,Y.z]];for(let ye=1;ye<7;ye++)Y.x=1&ye?i.size.x:0,Y.y=2&ye?i.size.y:0,Y.z=4&ye?i.size.z:0,Y.applyMatrix4(i.matrix),this.extent[0][0]=Math.min(this.extent[0][0],Y.x),this.extent[0][1]=Math.min(this.extent[0][1],Y.y),this.extent[0][2]=Math.min(this.extent[0][2],Y.z),this.extent[1][0]=Math.max(this.extent[1][0],Y.x),this.extent[1][1]=Math.max(this.extent[1][1],Y.y),this.extent[1][2]=Math.max(this.extent[1][2],Y.z);let re=Y.x-H.x,de=Y.y-H.y,le=Y.z-H.z;this.maxdepth=Math.sqrt(re*re+de*de+le*le),this.minunit=Math.min(Math.min(te.x,te.y),te.z),this.texmatrix=new m.Matrix4().identity().scale({x:i.size.x,y:i.size.y,z:i.size.z}),this.texmatrix=this.texmatrix.multiplyMatrices(i.matrix,this.texmatrix),this.texmatrix=this.texmatrix.getInverse(this.texmatrix)}else{this.texmatrix=new m.Matrix4().identity();let H=i.unit.x*i.size.x,Y=i.unit.y*i.size.y,te=i.unit.z*i.size.z;this.texmatrix.makeTranslation(-i.origin.x/H,-i.origin.y/Y,-i.origin.z/te),this.texmatrix.scale({x:1/H,y:1/Y,z:1/te}),this.minunit=Math.min(Math.min(i.unit.x,i.unit.y),i.unit.z),this.extent=[[i.origin.x,i.origin.y,i.origin.z],[i.origin.x+H,i.origin.y+Y,i.origin.z+te]],this.maxdepth=Math.sqrt(H*H+Y*Y+te*te)}var W=new Le({});if(W.addBox({corner:{x:this.extent[0][0],y:this.extent[0][1],z:this.extent[0][2]},dimensions:{w:this.extent[1][0]-this.extent[0][0],h:this.extent[1][1]-this.extent[0][1],d:this.extent[1][2]-this.extent[0][2]}}),this.geo=W.finalize(),this.boundingSphere.center=new m.Vector3((this.extent[0][0]+this.extent[1][0])/2,(this.extent[0][1]+this.extent[1][1])/2,(this.extent[0][2]+this.extent[1][2])/2),this.boundingSphere.radius=this.maxdepth/2,s.coords===void 0&&s.selection!==void 0&&(l?s.coords=l.selectedAtoms(s.selection):console.log("Need to provide viewer to volumetric renderer if selection specified.")),s.coords!==void 0&&s.seldist!==void 0){let H=new Uint8Array(i.data.length),Y=s.seldist,te=Y*Y;for(let re=0,de=s.coords.length;re<de;re++){let le=s.coords[re],ye=le.x-Y,Pe=le.y-Y,Te=le.z-Y,ke=le.x+Y,we=le.y+Y,Ge=le.z+Y;if(i.getIndex(ye,Pe,Te)>=0||i.getIndex(ke,we,Ge)>=0)for(let Je=ye;Je<ke;Je+=this.minunit)for(let tt=Pe;tt<we;tt+=this.minunit)for(let Ye=Te;Ye<Ge;Ye+=this.minunit){let ut=i.getIndex(Je,tt,Ye);ut>=0&&!H[ut]&&(Je-le.x)*(Je-le.x)+(tt-le.y)*(tt-le.y)+(Ye-le.z)*(Ye-le.z)<te&&(H[ut]=1)}}for(let re=0,de=i.data.length;re<de;re++)H[re]==0&&(i.data[re]=1/0)}this.data=i}globj(i){if(this.renderedShapeObj&&(i.remove(this.renderedShapeObj),this.renderedShapeObj=null),!this.hidden){this.shapeObj=new u.Object3D;var s,l=new u.Texture(this.data,!0),h=new u.Texture(this.transferfunctionbuffer,!1);l.needsUpdate=!0,h.needsUpdate=!0,h.flipY=!1,s=new u.VolumetricMaterial({transferfn:h,transfermin:this.min,transfermax:this.max,map:l,extent:this.extent,maxdepth:this.maxdepth,texmatrix:this.texmatrix,unit:this.minunit,subsamples:this.subsamples});var A=new u.Mesh(this.geo,s);this.shapeObj.add(A),this.renderedShapeObj=this.shapeObj.clone(),i.add(this.renderedShapeObj)}}removegl(i){this.renderedShapeObj&&(this.renderedShapeObj.geometry!==void 0&&this.renderedShapeObj.geometry.dispose(),this.renderedShapeObj.material!==void 0&&this.renderedShapeObj.material.dispose(),i.remove(this.renderedShapeObj),this.renderedShapeObj=null),this.shapeObj=null}get position(){return this.boundingSphere.center}get x(){return this.boundingSphere.center.x}get y(){return this.boundingSphere.center.y}get z(){return this.boundingSphere.center.z}}const Lt=16;class gr extends Array{constructor(i){super(...i)}getSymmetries(){if(this.length==0)return[];let i=this[0];return i.symmetries===void 0&&this.setSymmetries([new m.Matrix4]),i.symmetries}setSymmetries(i){i===void 0&&(i=[new m.Matrix4]);for(let s of this)s.symmetries=i,s.finished=!1}}class Yt{getWidth(){let i=this.container,s=i.offsetWidth;if(s==0&&i.style.display==="none"){let l=i.style.position,h=i.style.visibility;i.style.display="block",i.style.visibility="hidden",i.style.position="absolute",s=i.offsetWidth,i.style.display="none",i.style.visibility=h,i.style.position=l}return s}getHeight(){let i=this.container,s=i.offsetHeight;if(s==0&&i.style.display==="none"){let l=i.style.position,h=i.style.visibility;i.style.display="block",i.style.visibility="hidden",i.style.position="absolute",s=i.offsetHeight,i.style.display="none",i.style.visibility=h,i.style.position=l}return s}setupRenderer(){let i=Object.assign(Object.assign({},this.config),{preserveDrawingBuffer:!0,premultipliedAlpha:!1,containerWidth:this.WIDTH,containerHeight:this.HEIGHT});this.renderer=new u.Renderer(i),this.renderer.domElement.style.width="100%",this.renderer.domElement.style.height="100%",this.renderer.domElement.style.padding="0",this.renderer.domElement.style.position="absolute",this.renderer.domElement.style.top="0px",this.renderer.domElement.style.left="0px",this.renderer.domElement.style.zIndex="0"}initializeScene(){this.scene=new u.Scene,this.scene.fog=new u.Fog(this.bgColor,100,200),this.modelGroup=new u.Object3D,this.rotationGroup=new u.Object3D,this.rotationGroup.useQuaternion=!0,this.rotationGroup.quaternion=new m.Quaternion(0,0,0,1),this.rotationGroup.add(this.modelGroup),this.scene.add(this.rotationGroup);var i=new u.Light(16777215);i.position=new m.Vector3(.2,.2,1).normalize(),i.intensity=1,this.scene.add(i)}_handleLostContext(i){const s=function(l){const h=l.getBoundingClientRect();return!(h.right<0||h.bottom<0||h.top>(window.innerHeight||document.documentElement.clientHeight)||h.left>(window.innerWidth||document.documentElement.clientWidth))};if(s(this.container)){let l=0;for(let h of document.getElementsByTagName("canvas"))if(s(h)&&h._3dmol_viewer!=null&&(h._3dmol_viewer.resize(),l+=1,l>=Lt))break}}initContainer(i){this.container=i,this.WIDTH=this.getWidth(),this.HEIGHT=this.getHeight(),this.ASPECT=this.renderer.getAspect(this.WIDTH,this.HEIGHT),this.renderer.setSize(this.WIDTH,this.HEIGHT),this.container.append(this.renderer.domElement),this.glDOM=this.renderer.domElement,this.glDOM._3dmol_viewer=this,this.glDOM.addEventListener("webglcontextlost",this._handleLostContext.bind(this)),this.nomouse||(this.glDOM.addEventListener("mousedown",this._handleMouseDown.bind(this),{passive:!1}),this.glDOM.addEventListener("touchstart",this._handleMouseDown.bind(this),{passive:!1}),this.glDOM.addEventListener("wheel",this._handleMouseScroll.bind(this),{passive:!1}),this.glDOM.addEventListener("mousemove",this._handleMouseMove.bind(this),{passive:!1}),this.glDOM.addEventListener("touchmove",this._handleMouseMove.bind(this),{passive:!1}),this.glDOM.addEventListener("contextmenu",this._handleContextMenu.bind(this),{passive:!1}))}decAnim(){this.animated--,this.animated<0&&(this.animated=0)}incAnim(){this.animated++}nextSurfID(){var i=0;for(let l in this.surfaces)if(this.surfaces.hasOwnProperty(l)){var s=parseInt(l);isNaN(s)||s>i&&(i=s)}return i+1}setSlabAndFog(){let i=this.camera.position.z-this.rotationGroup.position.z;i<1&&(i=1),this.camera.near=i+this.slabNear,!this.camera.ortho&&this.camera.near<1&&(this.camera.near=1),this.camera.far=i+this.slabFar,this.camera.near+1>this.camera.far&&(this.camera.far=this.camera.near+1),this.camera.fov=this.fov,this.camera.right=i*Math.tan(Math.PI/180*this.fov),this.camera.left=-this.camera.right,this.camera.top=this.camera.right/this.ASPECT,this.camera.bottom=-this.camera.top,this.camera.updateProjectionMatrix(),this.scene.fog.near=this.camera.near+this.fogStart*(this.camera.far-this.camera.near),this.scene.fog.far=this.camera.near+this.fogEnd*(this.camera.far-this.camera.near),this.config.disableFog&&(this.scene.fog.near=this.scene.fog.far)}show(i){if(this.renderer.setViewport(),this.scene&&(this.setSlabAndFog(),this.renderer.render(this.scene,this.camera),this.viewChangeCallback&&this.viewChangeCallback(this._viewer.getView()),!i&&this.linkedViewers.length>0))for(var s=this._viewer.getView(),l=0;l<this.linkedViewers.length;l++)this.linkedViewers[l].setView(s,!0)}updateClickables(){this.clickables.splice(0,this.clickables.length),this.hoverables.splice(0,this.hoverables.length),this.contextMenuEnabledObjects.splice(0,this.contextMenuEnabledObjects.length);for(let i=0,s=this.models.length;i<s;i++){let l=this.models[i];if(l){let h=l.selectedAtoms({clickable:!0}),A=l.selectedAtoms({hoverable:!0}),g=l.selectedAtoms({contextMenuEnabled:!0});for(let E=0;E<A.length;E++)this.hoverables.push(A[E]);for(let E=0;E<h.length;E++)this.clickables.push(h[E]);for(let E=0;E<g.length;E++)this.contextMenuEnabledObjects.push(g[E])}}for(let i=0,s=this.shapes.length;i<s;i++){let l=this.shapes[i];l&&l.clickable&&this.clickables.push(l),l&&l.hoverable&&this.hoverables.push(l),l&&l.contextMenuEnabled&&this.contextMenuEnabledObjects.push(l)}}handleClickSelection(i,s,l){let h=this.targetedObjects(i,s,this.clickables);if(h.length){var A=h[0].clickable;A.callback!==void 0&&(typeof A.callback!="function"&&(A.callback=(0,w.makeFunction)(A.callback)),typeof A.callback=="function")&&(this.mouseButton===3&&this.contextMenuEnabledObjects.includes(A)&&this.userContextMenuHandler||A.callback(A,this._viewer,l,this.container,h))}}canvasOffset(){let i=this.glDOM,s=i.getBoundingClientRect(),l=i.ownerDocument,h=l.documentElement,A=l.defaultView;return{top:s.top+A.pageYOffset-h.clientTop,left:s.left+A.pageXOffset-h.clientLeft}}setHover(i,s,l){this.current_hover!=i&&(this.current_hover&&(typeof this.current_hover.unhover_callback!="function"&&(this.current_hover.unhover_callback=(0,w.makeFunction)(this.current_hover.unhover_callback)),this.current_hover.unhover_callback(this.current_hover,this._viewer,s,this.container,l)),this.current_hover=i,i&&i.hover_callback!==void 0&&(typeof i.hover_callback!="function"&&(i.hover_callback=(0,w.makeFunction)(i.hover_callback)),typeof i.hover_callback=="function"&&i.hover_callback(i,this._viewer,s,this.container,l)))}handleHoverSelection(i,s,l){if(this.hoverables.length==0)return;let h=this.targetedObjects(i,s,this.hoverables);if(h.length){var A=h[0].clickable;this.setHover(A,l,h),this.current_hover=A}else this.setHover(null)}handleHoverContinue(i,s){let l=this.targetedObjects(i,s,this.hoverables);l.length!=0&&l[0]!==void 0||this.setHover(null),l[0]!==void 0&&l[0].clickable!==this.current_hover&&this.setHover(null)}closeEnoughForClick(i,{allowTolerance:s=i.targetTouches,tolerance:l=5}={}){const h=this.getX(i),A=this.getY(i);if(s){const g=Math.abs(h-this.mouseStartX),E=Math.abs(A-this.mouseStartY);return g<=l&&E<=l}return h===this.mouseStartX&&A===this.mouseStartY}calcTouchDistance(i){var s=i.targetTouches[0].pageX-i.targetTouches[1].pageX,l=i.targetTouches[0].pageY-i.targetTouches[1].pageY;return Math.hypot(s,l)}getX(i){var s=i.pageX;return s==null&&(s=i.pageX),i.targetTouches&&i.targetTouches[0]?s=i.targetTouches[0].pageX:i.changedTouches&&i.changedTouches[0]&&(s=i.changedTouches[0].pageX),s}getY(i){var s=i.pageY;return s==null&&(s=i.pageY),i.targetTouches&&i.targetTouches[0]?s=i.targetTouches[0].pageY:i.changedTouches&&i.changedTouches[0]&&(s=i.changedTouches[0].pageY),s}isInViewer(i,s){if(this.viewers!=null){var l=this.WIDTH/this.cols,h=this.HEIGHT/this.rows,A=this.canvasOffset(),g=i-A.left,E=s-A.top,M=this.rows-Math.floor(E/h)-1,S=Math.floor(g/l);if(M!=this.row||S!=this.col)return!1}return!0}adjustZoomToLimits(i){if(this.config.lowerZoomLimit&&this.config.lowerZoomLimit>0){let s=this.CAMERA_Z-this.config.lowerZoomLimit;i>s&&(i=s)}if(this.config.upperZoomLimit&&this.config.upperZoomLimit>0){let s=this.CAMERA_Z-this.config.upperZoomLimit;i<s&&(i=s)}return i>this.CAMERA_Z-1&&(i=this.CAMERA_Z-1),i}static slerp(i,s,l){if(l==1)return s.clone();if(l==0)return i.clone();let h=i.x*s.x+i.y*s.y+i.z*s.z+i.w*s.w;if(h>.9995){let R=new m.Quaternion(i.x+l*(s.x-i.x),i.y+l*(s.y-i.y),i.z+l*(s.z-i.z),i.w+l*(s.w-i.w));return R.normalize(),R}h<0&&(s=s.clone().multiplyScalar(-1),h=-h),h>1?h=1:h<-1&&(h=-1);var A=Math.acos(h)*l,g=s.clone();g.sub(i.clone().multiplyScalar(h)),g.normalize();var E=Math.cos(A),M=Math.sin(A),S=new m.Quaternion(i.x*E+g.x*M,i.y*E+g.y*M,i.z*E+g.z*M,i.w*E+g.w*M);return S.normalize(),S}constructor(i,s={}){if(this.nomouse=!1,this.glDOM=null,this.models=[],this.surfaces={},this.shapes=[],this.labels=[],this.clickables=[],this.hoverables=[],this.contextMenuEnabledObjects=[],this.current_hover=null,this.hoverDuration=500,this.longTouchDuration=1e3,this.viewer_frame=0,this.viewChangeCallback=null,this.stateChangeCallback=null,this.NEAR=1,this.FAR=800,this.CAMERA_Z=150,this.fov=20,this.linkedViewers=[],this.renderer=null,this.control_all=!1,this.scene=null,this.rotationGroup=null,this.modelGroup=null,this.fogStart=.4,this.fogEnd=1,this.slabNear=-50,this.slabFar=50,this.cq=new m.Quaternion(0,0,0,1),this.dq=new m.Quaternion(0,0,0,1),this.animated=0,this.animationTimers=new Set,this.isDragging=!1,this.mouseStartX=0,this.mouseStartY=0,this.touchDistanceStart=0,this.touchHold=!1,this.currentModelPos=0,this.cz=0,this.cslabNear=0,this.cslabFar=0,this.userContextMenuHandler=null,this.config=s,this.callback=this.config.callback,this.defaultcolors=this.config.defaultcolors,this.defaultcolors||(this.defaultcolors=_.elementColors.defaultColors),this.nomouse=!!this.config.nomouse,this.bgColor=0,this.config.backgroundColor=this.config.backgroundColor||"#ffffff",this.config.backgroundColor!==void 0&&(this.bgColor=_.CC.color(this.config.backgroundColor).getHex()),this.config.backgroundAlpha=this.config.backgroundAlpha==null?1:this.config.backgroundAlpha,this.camerax=0,this.config.camerax!==void 0&&(this.camerax=typeof this.config.camerax=="string"?parseFloat(this.config.camerax):this.config.camerax),this._viewer=this,this.container=i,this.config.hoverDuration!=null&&(this.hoverDuration=this.config.hoverDuration),this.config.antialias===void 0&&(this.config.antialias=!0),this.config.cartoonQuality===void 0&&(this.config.cartoonQuality=10),this.WIDTH=this.getWidth(),this.HEIGHT=this.getHeight(),this.setupRenderer(),this.row=this.config.row==null?0:this.config.row,this.col=this.config.col==null?0:this.config.col,this.cols=this.config.cols,this.rows=this.config.rows,this.viewers=this.config.viewers,this.control_all=this.config.control_all,this.ASPECT=this.renderer.getAspect(this.WIDTH,this.HEIGHT),this.camera=new u.Camera(this.fov,this.ASPECT,this.NEAR,this.FAR,this.config.orthographic),this.camera.position=new m.Vector3(this.camerax,0,this.CAMERA_Z),this.lookingAt=new m.Vector3,this.camera.lookAt(this.lookingAt),this.raycaster=new u.Raycaster(new m.Vector3(0,0,0),new m.Vector3(0,0,0)),this.projector=new u.Projector,this.initializeScene(),this.renderer.setClearColorHex(this.bgColor,this.config.backgroundAlpha),this.scene.fog.color=_.CC.color(this.bgColor),document.body.addEventListener("mouseup",this._handleMouseUp.bind(this)),document.body.addEventListener("touchend",this._handleMouseUp.bind(this)),this.initContainer(this.container),this.config.style&&this.setViewStyle(this.config),window.addEventListener("resize",this.resize.bind(this)),window.ResizeObserver!==void 0&&(this.divwatcher=new window.ResizeObserver(this.resize.bind(this)),this.divwatcher.observe(this.container)),window.IntersectionObserver!==void 0){let l=(h,A)=>{h.forEach(g=>{g.isIntersecting&&this.resize()})};this.intwatcher=new window.IntersectionObserver(l),this.intwatcher.observe(this.container)}try{typeof this.callback=="function"&&this.callback(this)}catch(l){console.log("error with glviewer callback: "+l)}}targetedObjects(i,s,l){var h={x:i,y:s,z:-1};return Array.isArray(l)||(l=this.selectedAtoms(l)),l.length==0?[]:(this.raycaster.setFromCamera(h,this.camera),this.raycaster.intersectObjects(this.modelGroup,l))}modelToScreen(i){let s=!1;Array.isArray(i)||(i=[i],s=!0);let l=this.renderer.getXRatio(),h=this.renderer.getYRatio(),A=this.col,g=this.row,E=A*(this.WIDTH/l),M=(h-g-1)*(this.HEIGHT/h),S=[],R=this.canvasOffset();return i.forEach(O=>{let $=new m.Vector3(O.x,O.y,O.z);$.applyMatrix4(this.modelGroup.matrixWorld),this.projector.projectVector($,this.camera);let G=this.WIDTH/l*($.x+1)/2+R.left+E,j=-this.HEIGHT/h*($.y-1)/2+R.top+M;S.push({x:G,y:j})}),s&&(S=S[0]),S}screenOffsetToModel(i,s,l){var h=i/this.WIDTH,A=s/this.HEIGHT,g=l===void 0?this.rotationGroup.position.z:l,E=this.rotationGroup.quaternion,M=new m.Vector3(0,0,g);return this.projector.projectVector(M,this.camera),M.x+=2*h,M.y-=2*A,this.projector.unprojectVector(M,this.camera),M.z=0,M.applyQuaternion(E),M}screenToModelDistance(i,s){let l=this.canvasOffset(),h=new m.Vector3(s.x,s.y,s.z);h.applyMatrix4(this.modelGroup.matrixWorld);let A=h.clone();this.projector.projectVector(h,this.camera);let g=new m.Vector3(2*(i.x-l.left)/this.WIDTH-1,2*(i.y-l.top)/-this.HEIGHT+1,h.z);return this.projector.unprojectVector(g,this.camera),g.distanceTo(A)}setViewChangeCallback(i){typeof i!="function"&&i!=null||(this.viewChangeCallback=i)}setStateChangeCallback(i){typeof i!="function"&&i!=null||(this.stateChangeCallback=i)}getConfig(){return this.config}setConfig(i){this.config=i,i.ambientOcclusion&&this.renderer.enableAmbientOcclusion(i.ambientOcclusion)}getInternalState(){var i={models:[],surfaces:[],shapes:[],labels:[]};for(let s=0;s<this.models.length;s++)this.models[s]&&(i.models[s]=this.models[s].getInternalState());return i}setInternalState(i){this.clear();var s=i.models;for(let l=0;l<s.length;l++)s[l]&&(this.models[l]=new ur(l,void 0,this),this.models[l].setInternalState(s[l]));this.render()}setZoomLimits(i,s){i!==void 0&&(this.config.lowerZoomLimit=i),s&&(this.config.upperZoomLimit=s),this.rotationGroup.position.z=this.adjustZoomToLimits(this.rotationGroup.position.z),this.show()}setCameraParameters(i){i.fov!==void 0&&(this.fov=i.fov,this.camera.fov=this.fov),i.z!==void 0&&(this.CAMERA_Z=i.z,this.camera.z=this.CAMERA_Z),i.orthographic!==void 0&&(this.camera.ortho=i.orthographic),this.setSlabAndFog()}_handleMouseDown(i){if(i.preventDefault(),!this.scene)return;var s=this.getX(i),l=this.getY(i);if(s===void 0)return;this.isDragging=!0,this.mouseButton=i.which,this.mouseStartX=s,this.mouseStartY=l,this.touchHold=!0,this.touchDistanceStart=0,i.targetTouches&&i.targetTouches.length==2&&(this.touchDistanceStart=this.calcTouchDistance(i)),this.cq=this.rotationGroup.quaternion.clone(),this.cz=this.rotationGroup.position.z,this.currentModelPos=this.modelGroup.position.clone(),this.cslabNear=this.slabNear,this.cslabFar=this.slabFar;let h=this;i.targetTouches&&i.targetTouches.length===1&&(this.longTouchTimeout=setTimeout(function(){if(h.touchHold==1){h.glDOM=h.renderer.domElement;const A=i.targetTouches[0],g=new PointerEvent("contextmenu",Object.assign(Object.assign({},i),{pageX:A.pageX,pageY:A.pageY,screenX:A.screenX,screenY:A.screenY,clientX:A.clientX,clientY:A.clientY}));h.glDOM.dispatchEvent(g)}},this.longTouchDuration))}_handleMouseUp(i){if(this.touchHold=!1,this.isDragging&&this.scene){var s=this.getX(i),l=this.getY(i);if(this.closeEnoughForClick(i)&&this.isInViewer(s,l)){let h=this.mouseXY(s,l);this.handleClickSelection(h.x,h.y,i)}}this.isDragging=!1}_handleMouseScroll(i){if(i.preventDefault(),this.scene){var s=this.getX(i),l=this.getY(i);if(s!==void 0&&(this.control_all||this.isInViewer(s,l))){var h=.85*(this.CAMERA_Z-this.rotationGroup.position.z),A=1;if(i.ctrlKey&&(A=-1),i.detail)this.rotationGroup.position.z+=A*h*i.detail/10;else if(i.wheelDelta){let g=600*i.wheelDelta/(i.wheelDelta+600);this.rotationGroup.position.z-=A*h*g/400}this.rotationGroup.position.z=this.adjustZoomToLimits(this.rotationGroup.position.z),this.show()}}}pngURI(){return this.getCanvas().toDataURL("image/png")}apngURI(i){let s=this;return i=i||1,new Promise(function(l){let h=0,A=s.viewChangeCallback,g=[],E=[],M=Date.now();s.viewChangeCallback=function(){E.push(Date.now()-M),M=Date.now(),g.push(new Promise(S=>{s.getCanvas().toBlob(function(R){R.arrayBuffer().then(S)},"image/png")})),h+=1,h==i&&(s.viewChangeCallback=A,Promise.all(g).then(S=>{let R=[];for(let H=0;H<S.length;H++){let Y=(0,D.decode)(S[H]);R.push((0,D.toRGBA8)(Y)[0])}let O=s.getCanvas().width,$=s.getCanvas().height,G=(0,D.encode)(R,O,$,0,E),j=new Blob([G],{type:"image/png"}),W=new FileReader;W.onload=function(H){l(H.target.result)},W.readAsDataURL(j)}))}})}getCanvas(){return this.glDOM}getRenderer(){return this.renderer}setHoverDuration(i){this.hoverDuration=i}mouseXY(i,s){let l=this.canvasOffset(),h=this.renderer.getXRatio(),A=this.renderer.getYRatio(),g=this.col,E=this.row,M=g*(this.WIDTH/h),S=(A-E-1)*(this.HEIGHT/A);return{x:(i-l.left-M)/(this.WIDTH/h)*2-1,y:-(s-l.top-S)/(this.HEIGHT/A)*2+1}}_handleMouseMove(i){clearTimeout(this.hoverTimeout),i.preventDefault();let s=this.getX(i),l=this.getY(i);if(s===void 0)return;let h=this.renderer.getXRatio(),A=this.renderer.getYRatio(),g=this.mouseXY(s,l),E=this;this.current_hover!==null&&this.handleHoverContinue(g.x,g.y);var M=0;if((this.control_all||this.isInViewer(s,l))&&this.scene&&(this.hoverables.length>0&&(this.hoverTimeout=setTimeout(function(){E.handleHoverSelection(g.x,g.y,i)},this.hoverDuration)),this.isDragging)){i.targetTouches&&(i.targetTouches.length>1||i.targetTouches.length===1&&!this.closeEnoughForClick(i))&&clearTimeout(this.longTouchTimeout);var S=(s-this.mouseStartX)/this.WIDTH,R=(l-this.mouseStartY)/this.HEIGHT;this.touchDistanceStart!=0&&i.targetTouches&&i.targetTouches.length==2?(M=2,R=2*(this.calcTouchDistance(i)-this.touchDistanceStart)/(this.WIDTH+this.HEIGHT)):i.targetTouches&&i.targetTouches.length==3&&(M=1),S*=h,R*=A;var O,$=Math.hypot(S,R);if(M==3||this.mouseButton==3&&i.ctrlKey)this.slabNear=this.cslabNear+100*S,this.slabFar=this.cslabFar-100*R;else if(M==2||this.mouseButton==3||i.shiftKey)(O=.85*(this.CAMERA_Z-this.rotationGroup.position.z))<80&&(O=80),this.rotationGroup.position.z=this.cz+R*O,this.rotationGroup.position.z=this.adjustZoomToLimits(this.rotationGroup.position.z);else if(M==1||this.mouseButton==2||i.ctrlKey){var G=this.screenOffsetToModel(h*(s-this.mouseStartX),A*(l-this.mouseStartY));this.modelGroup.position.addVectors(this.currentModelPos,G)}else if((M===0||this.mouseButton==1)&&$!==0){var j=Math.sin($*Math.PI)/$;this.dq.x=Math.cos($*Math.PI),this.dq.y=0,this.dq.z=j*S,this.dq.w=-j*R,this.rotationGroup.quaternion.set(1,0,0,0),this.rotationGroup.quaternion.multiply(this.dq),this.rotationGroup.quaternion.multiply(this.cq)}this.show()}}_handleContextMenu(i){if(i.preventDefault(),this.closeEnoughForClick(i)){var s=this.mouseStartX,l=this.mouseStartY,h=this.canvasOffset();let g=this.mouseXY(s,l),E=g.x,M=g.y,S=this.targetedObjects(E,M,this.contextMenuEnabledObjects);var A=null;S.length&&(A=S[0].clickable),h=this.canvasOffset(),s=this.mouseStartX-h.left,l=this.mouseStartY-h.top,this.userContextMenuHandler&&(this.userContextMenuHandler(A,s,l,S,i),this.isDragging=!1)}}setContainer(i){let s=(0,w.getElement)(i)||this.container;return this.initContainer(s),this}setBackgroundColor(i,s){(s===void 0||s<0||s>1)&&(s=1);var l=_.CC.color(i);return this.scene.fog.color=l,this.bgColor=l.getHex(),this.renderer.setClearColorHex(l.getHex(),s),this.show(),this}setProjection(i){this.camera.ortho=i==="orthographic",this.setSlabAndFog()}setViewStyle(i){if((i=i||{}).style=i.style||"",i.style.includes("outline")?this.renderer.enableOutline(i):this.renderer.disableOutline(),i.style.includes("ambientOcclusion")){var s={};i.strength&&(s.strength=i.strength),i.radius&&(s.radius=i.radius),this.renderer.enableAmbientOcclusion(s)}else this.renderer.disableAmbientOcclusion();return this}updateSize(){this.renderer.setSize(this.WIDTH,this.HEIGHT),this.ASPECT=this.renderer.getAspect(this.WIDTH,this.HEIGHT),this.renderer.setSize(this.WIDTH,this.HEIGHT),this.camera.aspect=this.ASPECT,this.camera.updateProjectionMatrix()}setWidth(i){return this.WIDTH=i||this.WIDTH,this.updateSize(),this}setHeight(i){return this.HEIGHT=i||this.HEIGHT,this.updateSize(),this}resize(){this.WIDTH=this.getWidth(),this.HEIGHT=this.getHeight();let i=!1;if(this.renderer.isLost()&&this.WIDTH>0&&this.HEIGHT>0){let s=!1,l=this.container.querySelector("canvas");l&&l!=this.renderer.getCanvas()?this.config.canvas=l:(l.remove(),this.config&&this.config.canvas!=null&&(delete this.config.canvas,s=!0)),this.setupRenderer(),this.initContainer(this.container),this.renderer.setClearColorHex(this.bgColor,this.config.backgroundAlpha),i=!0,s&&(this.config.canvas=this.renderer.getCanvas())}if(this.WIDTH==0||this.HEIGHT==0?this.animated&&this._viewer.pauseAnimate():this.animated&&this._viewer.resumeAnimate(),this.updateSize(),i){let s=this.renderer.supportedExtensions();if(s.regen=!0,this.viewers)for(let l=0,h=this.viewers.length;l<h;l++)for(let A=0,g=this.viewers[l].length;A<g;A++)this.viewers[l][A].render(null,s);this._viewer.render(null,s)}else this.WIDTH>0&&this.HEIGHT>0&&this.show();return this}getModel(i){return i===void 0?this.models.length==0?null:this.models[this.models.length-1]:i instanceof ur?i:i in this.models?this.models[i]:this.models.length==0?null:this.models[this.models.length-1]}spin(i,s=1,l=!1){if(clearInterval(this.spinInterval),i===void 0&&(i="y"),typeof i=="boolean"){if(!i)return;i="y"}Array.isArray(i)&&(i={x:i[0],y:i[1],z:i[2]});var h=this;this.spinInterval=setInterval(function(){!h.getCanvas().isConnected&&h.renderer.isLost()&&clearInterval(h.spinInterval),(!l||h.container.checkVisibility&&h.container.checkVisibility())&&h.rotate(1*s,i)},25)}animateMotion(i,s,l,h,A,g){var E=Math.ceil(i/20);E<1&&(E=1),this.incAnim();var M={mpos:this.modelGroup.position.clone(),rz:this.rotationGroup.position.z,rot:this.rotationGroup.quaternion.clone(),cam:this.lookingAt.clone()};if(s){let O=new Array(E);for(let W=0;W<E;W++){let H=(W+1)/E,Y={mpos:M.mpos,rz:M.rz,rot:M.rot};Y.mpos=l.clone().sub(M.mpos).multiplyScalar(H).add(M.mpos),Y.rz=M.rz+H*(h-M.rz),Y.rot=Yt.slerp(M.rot,A,H),Y.cam=g.clone().sub(M.cam).multiplyScalar(H).add(M.cam),O[W]=Y}let $=0,G=this,j=function(){var W=O[$];$+=1,G.modelGroup.position=W.mpos,G.rotationGroup.position.z=W.rz,G.rotationGroup.quaternion=W.rot,G.camera.lookAt(W.cam),$<O.length?setTimeout(j,20):G.decAnim(),G.show()};setTimeout(j,20)}else{var S={};let O=1/E;if(l&&(S.mpos=l.clone().sub(M.mpos).multiplyScalar(O)),h!==void 0&&h!=null&&(S.rz=O*(h-M.rz)),A){var R=Yt.slerp(M.rot,A,O);S.rot=M.rot.clone().inverse().multiply(R)}g&&(S.cam=g.clone().sub(M.cam).multiplyScalar(O));let $=0,G=this,j=function(){$+=1,S.mpos&&G.modelGroup.position.add(S.mpos),S.rz&&(G.rotationGroup.position.z+=S.rz),S.rot&&G.rotationGroup.quaternion.multiply(S.rot),S.cam&&(G.lookingAt.add(S.cam),G.camera.lookAt(G.lookingAt)),$<E?setTimeout(j,20):G.decAnim(),G.show()};setTimeout(j,20)}}rotate(i,s="y",l=0,h=!1){if(s=="x"?s={x:1,y:0,z:0}:s=="y"?s={x:0,y:1,z:0}:s=="z"&&(s={x:0,y:0,z:1}),s=="vx"?s={vx:1,vy:0,vz:0}:s=="vy"?s={vx:0,vy:1,vz:0}:s=="vz"&&(s={vx:0,vy:0,vz:1}),s.vx!==void 0){var A=new m.Vector3(s.vx,s.vy,s.vz);A.applyQuaternion(this.rotationGroup.quaternion),s={x:A.x,y:A.y,z:A.z}}var g=(function(M){var S,R,O,$=Math.sin(M/2),G=Math.cos(M/2);return S=s.x*$,R=s.y*$,O=s.z*$,new m.Quaternion(S,R,O,G).normalize()})(Math.PI*i/180);if(l){var E=new m.Quaternion().copy(this.rotationGroup.quaternion).multiply(g);this.animateMotion(l,h,this.modelGroup.position,this.rotationGroup.position.z,E,this.lookingAt)}else this.rotationGroup.quaternion.multiply(g),this.show();return this}surfacesFinished(){for(var i in this.surfaces)if(!this.surfaces[i][0].done)return!1;return!0}getView(){if(!this.modelGroup)return[0,0,0,0,0,0,0,1];var i=this.modelGroup.position,s=this.rotationGroup.quaternion;return[i.x,i.y,i.z,this.rotationGroup.position.z,s.x,s.y,s.z,s.w]}setView(i,s){return i!==void 0&&(i instanceof Array||i.length!==8)&&this.modelGroup&&this.rotationGroup?(this.modelGroup.position.x=i[0],this.modelGroup.position.y=i[1],this.modelGroup.position.z=i[2],this.rotationGroup.position.z=i[3],this.rotationGroup.quaternion.x=i[4],this.rotationGroup.quaternion.y=i[5],this.rotationGroup.quaternion.z=i[6],this.rotationGroup.quaternion.w=i[7],i[8]!==void 0&&(this.rotationGroup.position.x=i[8],this.rotationGroup.position.y=i[9]),this.show(s),this):this}render(i,s){this.renderer.setViewport(),this.updateClickables();var l,h,A=this.getView();for(this.stateChangeCallback&&this.stateChangeCallback(this.getInternalState()),s||(s=this.renderer.supportedExtensions()),l=0;l<this.models.length;l++)this.models[l]&&this.models[l].globj(this.modelGroup,s);for(l=0;l<this.shapes.length;l++)this.shapes[l]&&(this.shapes[l].frame===void 0||this.viewer_frame<0||this.shapes[l].frame<0||this.shapes[l].frame==this.viewer_frame?this.shapes[l].globj(this.modelGroup,s):this.shapes[l].removegl(this.modelGroup));for(l=0;l<this.labels.length;l++)s.regen&&(this.labels[l].dispose(),this.modelGroup.remove(this.labels[l].sprite),this.labels[l].setContext(),this.modelGroup.add(this.labels[l].sprite)),this.labels[l]&&this.labels[l].frame!==void 0&&this.labels[l].frame>=0&&(this.modelGroup.remove(this.labels[l].sprite),(this.viewer_frame<0||this.labels[l].frame==this.viewer_frame)&&this.modelGroup.add(this.labels[l].sprite));for(l in this.surfaces)if(this.surfaces.hasOwnProperty(l)){var g=this.surfaces[l];for(h=0;h<g.length;h++)if(g.hasOwnProperty(h)){var E=g[h].geo;if(!g[h].finished||s.regen){E.verticesNeedUpdate=!0,E.elementsNeedUpdate=!0,E.normalsNeedUpdate=!0,E.colorsNeedUpdate=!0,E.buffersNeedUpdate=!0,g[h].mat.needsUpdate=!0,g[h].done&&(g[h].finished=!0),g[h].lastGL&&this.modelGroup.remove(g[h].lastGL);var M=null;if(g[h].mat instanceof u.LineBasicMaterial?M=new u.Line(E,g[h].mat):("wireframe"in g.style&&g.style.wireframe&&E.setUpWireframe(),M=new u.Mesh(E,g[h].mat)),g[h].mat.transparent&&g[h].mat.opacity==0?M.visible=!1:M.visible=!0,g[h].symmetries.length>1||g[h].symmetries.length==1&&!g[h].symmetries[0].isIdentity()){var S,R=new u.Object3D;for(S=0;S<g[h].symmetries.length;S++){var O=M.clone();O.matrix=g[h].symmetries[S],O.matrixAutoUpdate=!1,R.add(O)}g[h].lastGL=R,this.modelGroup.add(R)}else g[h].lastGL=M,this.modelGroup.add(M)}}}return this.setView(A),typeof i=="function"&&i(this),this}getModelList(i){let s=[];if(i===void 0||i.model===void 0)for(let h=0;h<this.models.length;h++)this.models[h]&&s.push(this.models[h]);else{let h=i.model;Array.isArray(h)||(h=[h]);for(let A=0;A<h.length;A++)if(typeof h[A]=="number"){var l=h[A];l<0&&(l+=this.models.length),s.push(this.models[l])}else s.push(h[A])}return s}getAtomsFromSel(i){var s=[];i===void 0&&(i={});var l=this.getModelList(i);for(let h=0;h<l.length;h++)s=s.concat(l[h].selectedAtoms(i));return s}atomIsSelected(i,s){s===void 0&&(s={});for(var l=this.getModelList(s),h=0;h<l.length;h++)if(l[h].atomIsSelected(i,s))return!0;return!1}selectedAtoms(i){return this.getAtomsFromSel(i)}getUniqueValues(i,s){s===void 0&&(s={});var l=this.getAtomsFromSel(s),h={};for(var A in l)l[A].hasOwnProperty(i)&&(h[l[A][i]]=!0);return Object.keys(h)}pdbData(i){for(var s=this.getAtomsFromSel(i),l="",h=0,A=s.length;h<A;++h)l+=s[h].pdbline+`
`;return l}zoom(i=2,s=0,l=!1){var h=(this.CAMERA_Z-this.rotationGroup.position.z)/i,A=this.CAMERA_Z-h;return s>0?this.animateMotion(s,l,this.modelGroup.position,this.adjustZoomToLimits(A),this.rotationGroup.quaternion,this.lookingAt):(this.rotationGroup.position.z=this.adjustZoomToLimits(A),this.show()),this}translate(i,s,l=0,h=!1){var A=i/this.WIDTH,g=s/this.HEIGHT,E=new m.Vector3(0,0,-this.CAMERA_Z);this.projector.projectVector(E,this.camera),E.x-=A,E.y-=g,this.projector.unprojectVector(E,this.camera),E.z=0;var M=this.lookingAt.clone().add(E);return l>0?this.animateMotion(l,h,this.modelGroup.position,this.rotationGroup.position.z,this.rotationGroup.quaternion,M):(this.lookingAt=M,this.camera.lookAt(this.lookingAt),this.show()),this}translateScene(i,s,l=0,h=!1){var A=this.screenOffsetToModel(i,s),g=this.modelGroup.position.clone().add(A);return l>0?this.animateMotion(l,h,this.modelGroup.position,this.rotationGroup.position.z,this.rotationGroup.quaternion,this.lookingAt):(this.modelGroup.position=g,this.show()),this}fitSlab(i){i=i||{};var s=this.getAtomsFromSel(i),l=(0,w.getExtent)(s),h=l[1][0]-l[0][0],A=l[1][1]-l[0][1],g=l[1][2]-l[0][2],E=Math.hypot(h,A,g);return E<5&&(E=5),this.slabNear=-E/1.9,this.slabFar=E/2,this}center(i={},s=0,l=!1){var h,A,g=this.getAtomsFromSel(i),E=(0,w.getExtent)(g);(0,w.isEmptyObject)(i)?(this.shapes.forEach(Y=>{if(Y&&Y.boundingSphere&&Y.boundingSphere.center){var te=Y.boundingSphere.center,re=Y.boundingSphere.radius;re>0?(g.push(new m.Vector3(te.x+re,te.y,te.z)),g.push(new m.Vector3(te.x-re,te.y,te.z)),g.push(new m.Vector3(te.x,te.y+re,te.z)),g.push(new m.Vector3(te.x,te.y-re,te.z)),g.push(new m.Vector3(te.x,te.y,te.z+re)),g.push(new m.Vector3(te.x,te.y,te.z-re))):g.push(te)}}),E=(0,w.getExtent)(g),h=g,A=E):(h=this.getAtomsFromSel({}),A=(0,w.getExtent)(h));var M=new m.Vector3(E[2][0],E[2][1],E[2][2]),S=A[1][0]-A[0][0],R=A[1][1]-A[0][1],O=A[1][2]-A[0][2],$=Math.hypot(S,R,O);$<5&&($=5),this.slabNear=-$/1.9,this.slabFar=$/2,S=E[1][0]-E[0][0],R=E[1][1]-E[0][1],O=E[1][2]-E[0][2],($=Math.hypot(S,R,O))<5&&($=5);for(var G=25,j=0;j<g.length;j++)if(g[j]){var W=M.distanceToSquared(g[j]);W>G&&(G=W)}$=2*Math.sqrt(G);var H=M.clone().multiplyScalar(-1);return s>0?this.animateMotion(s,l,H,this.rotationGroup.position.z,this.rotationGroup.quaternion,this.lookingAt):(this.modelGroup.position=H,this.show()),this}zoomTo(i={},s=0,l=!1){let h=this.getAtomsFromSel(i),A=(0,w.getExtent)(h),g=A;if((0,w.isEmptyObject)(i)){let te=h&&h.length;if(this.shapes.forEach(re=>{if(re&&re.boundingSphere){if(re.boundingSphere.box){let ye=re.boundingSphere.box;h.push(new m.Vector3(ye.min.x,ye.min.y,ye.min.z)),h.push(new m.Vector3(ye.max.x,ye.max.y,ye.max.z))}else if(re.boundingSphere.center){var de=re.boundingSphere.center,le=re.boundingSphere.radius;le>0?(h.push(new m.Vector3(de.x+le,de.y,de.z)),h.push(new m.Vector3(de.x-le,de.y,de.z)),h.push(new m.Vector3(de.x,de.y+le,de.z)),h.push(new m.Vector3(de.x,de.y-le,de.z)),h.push(new m.Vector3(de.x,de.y,de.z+le)),h.push(new m.Vector3(de.x,de.y,de.z-le))):h.push(de)}}}),g=(0,w.getExtent)(h),!te)for(let re=0;re<3;re++)A[2][re]=(g[0][re]+g[1][re])/2}else{let te=this.getAtomsFromSel({});g=(0,w.getExtent)(te)}var E=new m.Vector3(A[2][0],A[2][1],A[2][2]),M=g[1][0]-g[0][0],S=g[1][1]-g[0][1],R=g[1][2]-g[0][2],O=Math.hypot(M,S,R);O<5&&(O=5),this.slabNear=-O/1.9,this.slabFar=O/2,Object.keys(i).length===0&&(this.slabNear=Math.min(2*-O,-50),this.slabFar=Math.max(2*O,50));var $=this.config.minimumZoomToDistance||5;M=A[1][0]-A[0][0],S=A[1][1]-A[0][1],R=A[1][2]-A[0][2],(O=Math.hypot(M,S,R))<$&&(O=$);for(var G=$*$,j=0;j<h.length;j++)if(h[j]){var W=E.distanceToSquared(h[j]);W>G&&(G=W)}O=2*Math.sqrt(G);var H=E.clone().multiplyScalar(-1),Y=-(.5*O/Math.tan(Math.PI/180*this.camera.fov/2)-this.CAMERA_Z);return Y=this.adjustZoomToLimits(Y),s>0?this.animateMotion(s,l,H,Y,this.rotationGroup.quaternion,this.lookingAt):(this.modelGroup.position=H,this.rotationGroup.position.z=Y,this.show()),this}setSlab(i,s){this.slabNear=i,this.slabFar=s}getSlab(){return{near:this.slabNear,far:this.slabFar}}addLabel(i,s={},l,h=!1){if(l){var A=(0,w.getExtent)(this.getAtomsFromSel(l));s.position={x:A[2][0],y:A[2][1],z:A[2][2]}}var g=new Mt(i,s);return g.setContext(),this.modelGroup.add(g.sprite),this.labels.push(g),h||this.show(),g}addResLabels(i,s,l=!1){let h=this.labels.length;return this.applyToModels("addResLabels",i,s,l),this.show(),this.labels.slice(h)}addPropertyLabels(i,s,l){return this.applyToModels("addPropertyLabels",i,s,l),this.show(),this}removeLabel(i){for(var s=0;s<this.labels.length;s++)if(this.labels[s]==i){this.labels.splice(s,1),i.dispose(),this.modelGroup.remove(i.sprite);break}return this.show(),this}removeAllLabels(){for(var i=0;i<this.labels.length;i++)this.labels[i]&&this.labels[i].sprite&&this.modelGroup.remove(this.labels[i].sprite);return this.labels.splice(0,this.labels.length),this.show(),this}hideAllLabels(){for(var i=0;i<this.labels.length;i++)this.labels[i]&&this.labels[i].hide();return this.show(),this}showAllLabels(){for(var i=0;i<this.labels.length;i++)this.labels[i]&&this.labels[i].show();return this.show(),this}setLabelStyle(i,s){return this.modelGroup.remove(i.sprite),i.dispose(),i.stylespec=s,i.setContext(),this.modelGroup.add(i.sprite),this.show(),i}setLabelText(i,s){return this.modelGroup.remove(i.sprite),i.dispose(),i.text=s,i.setContext(),this.modelGroup.add(i.sprite),this.show(),i}addShape(i){var s=new Le(i=i||{});return s.shapePosition=this.shapes.length,this.shapes.push(s),s}removeShape(i){if(!i)return this;for(i.removegl(this.modelGroup),delete this.shapes[i.shapePosition];this.shapes.length>0&&this.shapes[this.shapes.length-1]===void 0;)this.shapes.pop();return this}removeAllShapes(){for(var i=0;i<this.shapes.length;i++){var s=this.shapes[i];s&&s.removegl(this.modelGroup)}return this.shapes.splice(0,this.shapes.length),this}getSelectionCenter(i){if(i.hasOwnProperty("x")&&i.hasOwnProperty("y")&&i.hasOwnProperty("z"))return i;var s=this.getAtomsFromSel(i);if(s.length==0)return{x:0,y:0,z:0};var l=(0,w.getExtent)(s);return{x:l[0][0]+(l[1][0]-l[0][0])/2,y:l[0][1]+(l[1][1]-l[0][1])/2,z:l[0][2]+(l[1][2]-l[0][2])/2}}addSphere(i){(i=i||{}).center=this.getSelectionCenter(i.center);var s=new Le(i);return s.shapePosition=this.shapes.length,s.addSphere(i),this.shapes.push(s),s.finalize(),s}addBox(i={}){i.corner!=null&&(i.corner=this.getSelectionCenter(i.corner)),i.center!=null&&(i.center=this.getSelectionCenter(i.center));var s=new Le(i);return s.shapePosition=this.shapes.length,s.addBox(i),this.shapes.push(s),s.finalize(),s}addArrow(i={}){i.start=this.getSelectionCenter(i.start),i.end=this.getSelectionCenter(i.end);var s=new Le(i);return s.shapePosition=this.shapes.length,s.addArrow(i),this.shapes.push(s),s.finalize(),s}addCylinder(i={}){i.start=this.getSelectionCenter(i.start),i.end=this.getSelectionCenter(i.end);var s=new Le(i);return s.shapePosition=this.shapes.length,i.dashed?s.addDashedCylinder(i):s.addCylinder(i),this.shapes.push(s),s.finalize(),s}addCurve(i={}){var s=new Le(i);return s.shapePosition=this.shapes.length,s.addCurve(i),this.shapes.push(s),s.finalize(),s}addLine(i={}){i.start=this.getSelectionCenter(i.start),i.end=this.getSelectionCenter(i.end),i.wireframe=!0;var s=new Le(i);return s.shapePosition=this.shapes.length,i.dashed?s=this.addLineDashed(i,s):s.addLine(i),this.shapes.push(s),s.finalize(),s}addUnitCell(i,s){i=this.getModel(i),(s=s||{alabel:"a",blabel:"b",clabel:"c"}).box=s.box||{},s.astyle=s.astyle||{color:"red",radius:.1,midpos:-1},s.bstyle=s.bstyle||{color:"green",radius:.1,midpos:-1},s.cstyle=s.cstyle||{color:"blue",radius:.1,midpos:-1},s.alabelstyle=s.alabelstyle||{fontColor:"red",showBackground:!1,alignment:"center",inFront:!1},s.blabelstyle=s.blabelstyle||{fontColor:"green",showBackground:!1,alignment:"center",inFront:!1},s.clabelstyle=s.clabelstyle||{fontColor:"blue",showBackground:!1,alignment:"center",inFront:!1},i.unitCellObjects&&this.removeUnitCell(i),i.unitCellObjects={shapes:[],labels:[]};var l=i.getCrystData(),h=null;if(l){if(l.matrix)h=l.matrix;else{var A,g,E,M=l.a,S=l.b,R=l.c,O=l.alpha,$=l.beta,G=l.gamma;O=O*Math.PI/180,$=$*Math.PI/180,G=G*Math.PI/180,A=Math.cos($),g=(Math.cos(O)-Math.cos($)*Math.cos(G))/Math.sin(G),E=Math.sqrt(Math.max(0,1-A*A-g*g)),h=new m.Matrix3(M,S*Math.cos(G),R*A,0,S*Math.sin(G),R*g,0,0,R*E)}var j=[new m.Vector3(0,0,0),new m.Vector3(1,0,0),new m.Vector3(0,1,0),new m.Vector3(0,0,1),new m.Vector3(1,1,0),new m.Vector3(0,1,1),new m.Vector3(1,0,1),new m.Vector3(1,1,1)];if(l.matrix4)for(let H=0;H<j.length;H++)l.size&&j[H].multiplyVectors(j[H],l.size),j[H]=j[H].applyMatrix4(l.matrix4);else for(let H=0;H<j.length;H++)j[H]=j[H].applyMatrix3(h);if(s.box&&!s.box.hidden){s.box.wireframe=!0;var W=new Le(s.box);W.shapePosition=this.shapes.length,W.addLine({start:j[0],end:j[1]}),W.addLine({start:j[0],end:j[2]}),W.addLine({start:j[1],end:j[4]}),W.addLine({start:j[2],end:j[4]}),W.addLine({start:j[0],end:j[3]}),W.addLine({start:j[3],end:j[5]}),W.addLine({start:j[2],end:j[5]}),W.addLine({start:j[1],end:j[6]}),W.addLine({start:j[4],end:j[7]}),W.addLine({start:j[6],end:j[7]}),W.addLine({start:j[3],end:j[6]}),W.addLine({start:j[5],end:j[7]}),this.shapes.push(W),i.unitCellObjects.shapes.push(W),W.finalize()}if(!s.astyle.hidden){s.astyle.start=j[0],s.astyle.end=j[1];let H=this.addArrow(s.astyle);i.unitCellObjects.shapes.push(H)}if(!s.bstyle.hidden){s.bstyle.start=j[0],s.bstyle.end=j[2];let H=this.addArrow(s.bstyle);i.unitCellObjects.shapes.push(H)}if(!s.cstyle.hidden){s.cstyle.start=j[0],s.cstyle.end=j[3];let H=this.addArrow(s.cstyle);i.unitCellObjects.shapes.push(H)}if(s.alabel){s.alabelstyle.position=j[1];let H=this.addLabel(s.alabel,s.alabelstyle);i.unitCellObjects.labels.push(H)}if(s.blabel){s.blabelstyle.position=j[2];let H=this.addLabel(s.blabel,s.blabelstyle);i.unitCellObjects.labels.push(H)}if(s.clabel){s.clabelstyle.position=j[3];let H=this.addLabel(s.clabel,s.clabelstyle);i.unitCellObjects.labels.push(H)}}}removeUnitCell(i){if((i=this.getModel(i)).unitCellObjects){let s=this;i.unitCellObjects.shapes.forEach(function(l){s.removeShape(l)}),i.unitCellObjects.labels.forEach(function(l){s.removeLabel(l)})}delete i.unitCellObjects}replicateUnitCell(i=3,s=i,l=s,h,A,g){let E=(h=this.getModel(h)).getCrystData();if(E){const M=h.selectedAtoms({}),S=E.matrix;let R=function($){return $%2==0?-$/2:Math.ceil($/2)};i<=1&&s<=1&&l<=1&&(g=!0,i=s=l=3);let O=function($,G,j){return!1};if(g){const $=new m.Matrix3().getInverse3(S);O=function(G,j,W){let H=new m.Vector3(G,j,W).applyMatrix3($);return!(H.x>-1e-4&&H.x<1.0001&&H.y>-1e-4&&H.y<1.0001&&H.z>-1e-4&&H.z<1.0001)}}for(let $=0;$<i;$++)for(let G=0;G<s;G++)for(let j=0;j<l;j++){if($==0&&G==0&&j==0)continue;let W=new m.Vector3(R($),R(G),R(j));W.applyMatrix3(S);let H=[];for(let Y=0;Y<M.length;Y++){let te=M[Y].x+W.x,re=M[Y].y+W.y,de=M[Y].z+W.z;if(O(te,re,de))continue;let le={};for(let ye in M[Y])le[ye]=M[Y][ye];le.x=te,le.y=re,le.z=de,H.push(le)}h.addAtoms(H)}A&&h.assignBonds()}}addLineDashed(i,s){var l,h;i.dashLength=i.dashLength||.5,i.gapLength=i.gapLength||.5,l=i.start?new m.Vector3(i.start.x||0,i.start.y||0,i.start.z||0):new m.Vector3(0,0,0),h=i.end?new m.Vector3(i.end.x,i.end.y||0,i.end.z||0):new m.Vector3(0,0,0);var A,g,E,M=new m.Vector3,S=new m.Vector3,R=new m.Vector3,O=l.clone(),$=0;for(M.subVectors(h,l),A=M.length(),M.normalize(),S=M.clone(),R=M.clone(),S.multiplyScalar(i.dashLength),R.multiplyScalar(i.gapLength),g=S.length(),E=R.length();$<A;){if($+g>A){i.start=l,i.end=h,s.addLine(i);break}O.addVectors(l,S),i.start=l,i.end=O,s.addLine(i),l=O.clone(),$+=g,O.addVectors(l,R),l=O.clone(),$+=E}return s.finalize(),s}addCustom(i){var s=new Le(i=i||{});return s.shapePosition=this.shapes.length,s.addCustom(i),this.shapes.push(s),s.finalize(),s}addVolumetricData(i,s,l={}){var h=new Ve.VolumeData(i,s);return l.hasOwnProperty("transferfn")?this.addVolumetricRender(h,l):this.addIsosurface(h,l)}addIsosurface(i,s={},l){var h=new Le(s);return h.shapePosition=this.shapes.length,h.addIsosurface(i,s,l,this),this.shapes.push(h),h}addVolumetricRender(i,s){var l=new Pt(i,s=s||{},this);return l.shapePosition=this.shapes.length,this.shapes.push(l),l}hasVolumetricRender(){return this.renderer.supportsVolumetric()}enableFog(i){if(i){this.scene.fog=new u.Fog(this.bgColor,100,200),this.config.disableFog=!1;const s=i;s.fogStart==null?this.fogStart=.4:this.fogStart=s.fogStart,s.fogEnd==null?this.fogEnd=1:this.fogEnd=s.fogEnd}else this.config.disableFog=!0,this.show()}setFrame(i){this.viewer_frame=i;let s=this;return new Promise(function(l){var h=s.models.map(function(A){return A.setFrame(i)});Promise.all(h).then(function(){l()})})}getFrame(){return this.viewer_frame}getNumFrames(){var i=0;for(let s=0;s<this.models.length;s++)this.models[s].getNumFrames()>i&&(i=this.models[s].getNumFrames());for(let s=0;s<this.shapes.length;s++)this.shapes[s].frame&&this.shapes[s].frame>=i&&(i=this.shapes[s].frame+1);for(let s=0;s<this.labels.length;s++)this.labels[s].frame&&this.labels[s].frame>=i&&(i=this.labels[s].frame+1);return i}getNextModelId(){return this.models.length}animate(i){this.incAnim();var s=100,l="forward",h=1/0;(i=i||{}).interval&&(s=i.interval),i.loop&&(l=i.loop),i.reps&&(h=i.reps);var A=this.getNumFrames(),g=this,E=0;i.startFrame&&(E=i.startFrame%A);var M=1;i.step&&(h/=M=i.step);var S,R,O=0,$=A*h,G=new Date,j=function(W){G=new Date,W=="forward"?g.setFrame(E).then(function(){E=(E+M)%A,S()}):W=="backward"?g.setFrame(A-1-E).then(function(){E=(E+M)%A,S()}):g.setFrame(E).then(function(){M*=(E+=M)%(A-1)==0?-1:1,S()})};return S=function(){if(g.render(),g.getCanvas().isConnected)if(++O>=$||!g.isAnimated())R.cancel(),g.animationTimers.delete(R),g.decAnim();else{var W=s-(new Date().getTime()-G.getTime());W=W>0?W:0,R.cancel(),g.animationTimers.delete(R),R=new w.PausableTimer(j,W,l),g.animationTimers.add(R)}else g.stopAnimate()},R=new w.PausableTimer(j,0,l),this.animationTimers.add(R),this}stopAnimate(){return this.animated=0,this.animationTimers.forEach(function(i){i.cancel()}),this.animationTimers=new Set,this}pauseAnimate(){return this.animationTimers.forEach(function(i){i.pause()}),this}resumeAnimate(){return this.animationTimers.forEach(function(i){i.resume()}),this}isAnimated(){return this.animated>0}getModelOpt(i){return i&&!i.defaultcolors?(i.defaultcolors=this.defaultcolors,i.cartoonQuality=i.cartoonQuality||this.config.cartoonQuality):i===void 0&&(i={defaultcolors:this.defaultcolors,cartoonQuality:this.config.cartoonQuality}),i}addModel(i,s="",l){l=this.getModelOpt(l);var h=new ur(this.models.length,l,this);return h.addMolData(i,s,l),this.models.push(h),h}addModels(i,s,l){(l=this.getModelOpt(l)).multimodel=!0,l.frames=!0;for(var h=ur.parseMolData(i,s,l),A=0;A<h.length;A++){var g=new ur(this.models.length,l,this);g.setAtomDefaults(h[A]),g.addFrame(h[A]),g.setFrame(0),h.modelData&&g.setModelData(h.modelData[A]),g.setDontDuplicateAtoms(!l.duplicateAssemblyAtoms),this.models.push(g)}return this.models}addModelsAsFrames(i,s,l){(l=this.getModelOpt(l)).multimodel=!0,l.frames=!0;var h=new ur(this.models.length,l,this);return h.addMolData(i,s,l),this.models.push(h),h}addAsOneMolecule(i,s,l){(l=this.getModelOpt(l)).multimodel=!0,l.onemol=!0;var h=new ur(this.models.length,l,this);return h.addMolData(i,s,l),this.models.push(h),h}removeModel(i){if(i=this.getModel(i)){for(i.removegl(this.modelGroup),delete this.models[i.getID()];this.models.length>0&&this.models[this.models.length-1]===void 0;)this.models.pop();return this}}removeAllModels(){for(var i=0;i<this.models.length;i++){var s=this.models[i];s&&s.removegl(this.modelGroup)}return this.models.splice(0,this.models.length),this}exportJSON(i,s){var l={};return l.m=s===void 0?this.models.map(function(h){return h.toCDObject(i)}):[this.models[s].toCDObject()],JSON.stringify(l)}exportVRML(){var i=this.modelGroup;this.applyToModels("removegl",this.modelGroup),this.modelGroup=new u.Object3D,this.render(null,{supportsImposters:!1,supportsAIA:!1,regen:!0});var s=`#VRML V2.0 utf8
`+this.modelGroup.vrml()+`
`;return this.applyToModels("removegl",this.modelGroup),this.modelGroup=i,s}createModelFrom(i,s=!1){for(var l=new ur(this.models.length,this.defaultcolors,this),h=0;h<this.models.length;h++)if(this.models[h]){var A=this.models[h].selectedAtoms(i);l.addAtoms(A),s&&this.models[h].removeAtoms(A)}return this.models.push(l),l}applyToModels(i,s,l,h,A,g,E){for(var M=this.getModelList(s),S=0;S<M.length;S++)M[S][i](s,l,h,A,g,E)}setStyle(i,s){return s===void 0&&(s=i,i={}),this.applyToModels("setStyle",i,s,!1),this}addStyle(i,s){return s===void 0&&(s=i,i={}),this.applyToModels("setStyle",i,s,!0),this}setClickable(i,s,l){return this.applyToModels("setClickable",i,s,l),this}setHoverable(i,s,l,h){return this.applyToModels("setHoverable",i,s,l,h),this}enableContextMenu(i,s){return this.applyToModels("enableContextMenu",i,s),this}vibrate(i,s,l,h){return this.applyToModels("vibrate",i,s,l,h),this}setColorByProperty(i,s,l,h){return this.applyToModels("setColorByProperty",i,s,l,h),this}setColorByElement(i,s){return this.applyToModels("setColorByElement",i,s),this}static getAtomsWithin(i,s){var l=[];for(let A=0;A<i.length;A++){var h=i[A];h!==void 0&&(h.x<s[0][0]||h.x>s[1][0]||h.y<s[0][1]||h.y>s[1][1]||h.z<s[0][2]||h.z>s[1][2]||l.push(h))}return l}static volume(i){return(i[1][0]-i[0][0])*(i[1][1]-i[0][1])*(i[1][2]-i[0][2])}carveUpExtent(i,s,l){let h=[],A={};for(let R=0,O=s.length;R<O;R++)A[s[R].index]=R;let g=function(R){let O=[];for(let $=0,G=R.length;$<G;$++)R[$].index in A&&O.push(A[R[$].index]);return O},E=function(R){let O=[];return O[0]=[R[0][0],R[0][1],R[0][2]],O[1]=[R[1][0],R[1][1],R[1][2]],O},M=function(R){if(Yt.volume(R)<Yt.maxVolume)return[R];var O,$=R[1][0]-R[0][0],G=R[1][1]-R[0][1],j=R[1][2]-R[0][2];O=$>G&&$>j?0:G>$&&G>j?1:2;var W=E(R),H=E(R),Y=(R[1][O]-R[0][O])/2+R[0][O];W[1][O]=Y,H[0][O]=Y;var te=M(W),re=M(H);return te.concat(re)},S=M(i);for(let R=0,O=S.length;R<O;R++){let $=E(S[R]);$[0][0]-=6,$[0][1]-=6,$[0][2]-=6,$[1][0]+=6,$[1][1]+=6,$[1][2]+=6;let G=Yt.getAtomsWithin(s,$),j=Yt.getAtomsWithin(l,S[R]);h.push({extent:S[R],atoms:g(G),toshow:g(j)})}return h}static generateSurfaceMesh(i,s,l){var h=new u.Geometry(!0),A=h.updateGeoGroup(0),g=[];for(let ke=0,we=i.length;ke<we;ke++){var E=i[ke];E&&(E.surfaceColor!==void 0?g[ke]=E.surfaceColor:E.color&&(g[ke]=_.CC.color(E.color)))}var M=A.vertexArray,S=s.vertices;for(let ke=0,we=S.length;ke<we;ke++){let Ge=3*A.vertices;M[Ge]=S[ke].x,M[Ge+1]=S[ke].y,M[Ge+2]=S[ke].z,A.vertices++}var R=A.colorArray;let O=A.atomArray;if(l.voldata&&l.volscheme){var $=l.volscheme,G=l.voldata,j=$.range()||[-1,1];for(let ke=0,we=S.length;ke<we;ke++){let Ge=S[ke].atomid,Je=G.getVal(S[ke].x,S[ke].y,S[ke].z),tt=_.CC.color($.valueToHex(Je,j)),Ye=3*ke;R[Ye]=tt.r,R[Ye+1]=tt.g,R[Ye+2]=tt.b,O[ke]=i[Ge]}}else if(g.length>0)for(let ke=0,we=S.length;ke<we;ke++){let Ge=S[ke].atomid,Je=3*ke;R[Je]=g[Ge].r,R[Je+1]=g[Ge].g,R[Je+2]=g[Ge].b,O[ke]=i[Ge]}var W=s.faces;A.faceidx=W.length,h.initTypedArrays();var H,Y,te,re,de=A.vertexArray,le=A.normalArray;for(let ke=0,we=W.length;ke<we;ke+=3){var ye=3*W[ke],Pe=3*W[ke+1],Te=3*W[ke+2];H=new m.Vector3(de[ye],de[ye+1],de[ye+2]),Y=new m.Vector3(de[Pe],de[Pe+1],de[Pe+2]),(te=new m.Vector3(de[Te],de[Te+1],de[Te+2])).subVectors(te,Y),H.subVectors(H,Y),te.cross(H),(re=te).normalize(),le[ye]+=re.x,le[Pe]+=re.x,le[Te]+=re.x,le[ye+1]+=re.y,le[Pe+1]+=re.y,le[Te+1]+=re.y,le[ye+2]+=re.z,le[Pe+2]+=re.z,le[Te+2]+=re.z}return A.faceArray=new Uint16Array(W),new u.Mesh(h,l)}static generateMeshSyncHelper(i,s,l,h,A,g){var E=new xe;return E.initparm(s,i!==1,g),E.fillvoxels(A,l),E.buildboundary(),i!=Gr.SES&&i!=Gr.MS||(E.fastdistancemap(),E.boundingatom(!1),E.fillvoxelswaals(A,l)),E.marchingcube(i),E.getFacesAndVertices(h)}static getMatWithStyle(i){let s=null;for(var l in s=i.onesided?new u.MeshLambertMaterial:new u.MeshDoubleLambertMaterial,s.vertexColors=u.Coloring.VertexColors,i)l==="color"||l==="map"||i.hasOwnProperty(l)&&(s[l]=i[l]);return i.opacity!==void 0&&(i.opacity===1?s.transparent=!1:s.transparent=!0),i.wireframe!==void 0&&(s.wireframe=i.wireframe),s}addMesh(i){let s={geo:i.geometry,mat:i.material,done:!0,finished:!1};var l=this.nextSurfID();return this.surfaces[l]=new gr([s]),l}static shallowCopy(i){var s=[];let l=i.length;for(let h=0;h<l;h++)s[h]=(0,w.extend)({},i[h]);return s}addSurface(i,s={},l={},h,A,g){let E=this.nextSurfID(),M=null,S=this,R=Gr.VDW;typeof i=="string"?Yt.surfaceTypeMap[i.toUpperCase()]!==void 0?R=Yt.surfaceTypeMap[i]:console.log("Surface type : "+i+" is not recognized"):typeof i=="number"&&(R=i);var O=null,$=null,G=Yt.shallowCopy(this.getAtomsFromSel(l));O=h?Yt.shallowCopy(this.getAtomsFromSel(h)):G,(0,w.adjustVolumeStyle)(s);var j,W=!1;for(j=0;j<this.models.length;j++)if(this.models[j]){var H=this.models[j].getSymmetries();if(H.length>1||H.length==1&&!H[0].isIdentity()){W=!0;break}}var Y=function(Pe,Te,ke){var we;$=A?Yt.shallowCopy(S.getAtomsFromSel(A)):ke;var Ge=(0,w.getExtent)(ke,!0);if(s.map&&s.map.prop){var Je=s.map.prop;let ot=(0,C.getGradient)(s.map.scheme||s.map.gradient||new C.Gradient.RWB),wt=ot.range();wt||(wt=(0,w.getPropertyRange)(ke,Je)),s.colorscheme={prop:Je,gradient:ot}}for(let ot=0,wt=Te.length;ot<wt;ot++)(we=Te[ot]).surfaceColor=(0,w.getColorFromStyle)(we,s);var tt=Yt.volume(Ge),Ye=S.carveUpExtent(Ge,Te,ke);if($&&$.length&&$.length>0){var ut=(0,w.getExtent)($,!0);Ye.sort(function(ot,wt){var At=function(it,Rt){var Ht=it.extent,kt=Ht[1][0]-Ht[0][0],ct=Ht[1][1]-Ht[0][1],Jt=Ht[1][2]-Ht[0][2],Nt=kt-Rt[2][0];Nt*=Nt;var qt=ct-Rt[2][1];qt*=qt;var Vt=Jt-Rt[2][2];return Nt+qt+(Vt*=Vt)};return At(ot,ut)-At(wt,ut)})}var ft=[];for(let ot=0,wt=Te.length;ot<wt;ot++)we=Te[ot],ft[ot]={x:we.x,y:we.y,z:we.z,serial:ot,elem:we.elem};var Qe=!!Kr;if(typeof $3Dmol<"u"&&$3Dmol.SurfaceWorker!==void 0||(console.log("$3Dmol.SurfaceWorker is not defined, using synchronous surface generation."),Qe=!0),Qe){var pt=function(ot){return new Promise(function(wt){for(var At=Yt.generateMeshSyncHelper(R,Ye[ot].extent,Ye[ot].atoms,Ye[ot].toshow,ft,tt),it=yt({vertexArr:At.vertices,faceArr:At.faces}),Rt=0,Ht=it.length;Rt<Ht;Rt++){At={vertices:it[Rt].vertexArr,faces:it[Rt].faceArr};var kt=Yt.generateSurfaceMesh(Te,At,M);(0,w.mergeGeos)(Pe.geo,kt)}S.render(),wt()})},Be=[];for(let ot=0;ot<Ye.length;ot++)Be.push(pt(ot));return Promise.all(Be).then(function(){return Pe.done=!0,S.render(),Promise.resolve(E)})}var et=[];R<0&&(R=0);for(let ot=0,wt=Yt.numWorkers;ot<wt;ot++){var St=new Worker($3Dmol.SurfaceWorker);et.push(St),St.postMessage({type:-1,atoms:ft,volume:tt})}return new Promise(function(ot,wt){var At=0,it=function(){et&&et.length&&et.forEach(function(ct){ct&&ct.terminate&&ct.terminate()})},Rt=function(ct){for(var Jt=yt({vertexArr:ct.data.vertices,faceArr:ct.data.faces}),Nt=0,qt=Jt.length;Nt<qt;Nt++){var Vt={vertices:Jt[Nt].vertexArr,faces:Jt[Nt].faceArr},Xt=Yt.generateSurfaceMesh(Te,Vt,M);(0,w.mergeGeos)(Pe.geo,Xt)}S.render(),++At==Ye.length&&(Pe.done=!0,it(),ot(E))},Ht=function(ct){it(),console.log(ct.message+" ("+ct.filename+":"+ct.lineno+")"),wt(ct)};for(let ct=0;ct<Ye.length;ct++){var kt=et[ct%et.length];kt.onmessage=Rt,kt.onerror=Ht,kt.postMessage({type:R,expandedExtent:Ye[ct].extent,extendedAtoms:Ye[ct].atoms,atomsToShow:Ye[ct].toshow})}})};s=s||{},M=Yt.getMatWithStyle(s);let te=new gr([]);te.style=s,te.atomsel=l,te.allsel=h,te.focus=A;var re=null;if(W){var de={},le={};for(j=0;j<this.models.length;j++)de[j]=[],le[j]=[];for(j=0;j<O.length;j++)de[O[j].model].push(O[j]);for(j=0;j<G.length;j++)le[G[j].model].push(G[j]);var ye=[];for(j=0;j<this.models.length;j++)le[j].length>0&&(te.push({geo:new u.Geometry(!0),mat:M,done:!1,finished:!1,symmetries:this.models[j].getSymmetries()}),ye.push(Y(te[te.length-1],de[j],le[j])));re=Promise.all(ye)}else te.push({geo:new u.Geometry(!0),mat:M,done:!1,finished:!1,symmetries:[new m.Matrix4]}),re=Y(te[te.length-1],O,G);return this.surfaces[E]=te,re.surfid=E,g&&typeof g=="function"?(re.then(function(Pe){g(Pe)}),E):re}setSurfaceMaterialStyle(i,s){if((0,w.adjustVolumeStyle)(s),this.surfaces[i]){var l=this.surfaces[i];for(let A=0;A<l.length;A++){var h=l[A].mat=Yt.getMatWithStyle(s);if(l[A].mat.side=u.FrontSide,s.wireframe&&l[A].geo.setUpWireframe(),s.color){l[A].mat.color=_.CC.color(s.color),l[A].geo.colorsNeedUpdate=!0;const g=_.CC.color(s.color);l[A].geo.setColor(g)}else if(h.voldata&&h.volscheme){const g=h.volscheme,E=h.voldata,M=_.CC,S=g.range()||[-1,1];l[A].geo.setColors(function(R,O,$){let G=E.getVal(R,O,$);return M.color(g.valueToHex(G,S))})}else{l[A].geo.colorsNeedUpdate=!0;for(let g of l[A].geo.geometryGroups)for(let E=0;E<g.vertices;E++){let M=(0,w.getColorFromStyle)(g.atomArray[E],s),S=3*E;g.colorArray[S]=M.r,g.colorArray[S+1]=M.g,g.colorArray[S+2]=M.b}}l[A].finished=!1}}return this}getSurface(i){return this.surfaces[i]}removeSurface(i){for(var s=this.surfaces[i],l=0;l<s.length;l++)s[l]&&s[l].lastGL&&(s[l].geo!==void 0&&s[l].geo.dispose(),s[l].mat!==void 0&&s[l].mat.dispose(),this.modelGroup.remove(s[l].lastGL));return delete this.surfaces[i],this.show(),this}removeAllSurfaces(){for(var i in this.surfaces)if(this.surfaces.hasOwnProperty(i)){for(var s=this.surfaces[i],l=0;l<s.length;l++)s[l]&&s[l].lastGL&&(s[l].geo!==void 0&&s[l].geo.dispose(),s[l].mat!==void 0&&s[l].mat.dispose(),this.modelGroup.remove(s[l].lastGL));delete this.surfaces[i]}return this.show(),this}jmolMoveTo(){var i=this.modelGroup.position,s="center { "+-i.x+" "+-i.y+" "+-i.z+" }; ",l=this.rotationGroup.quaternion;return s+="moveto .5 quaternion { "+l.x+" "+l.y+" "+l.z+" "+l.w+" };"}clear(){return this.removeAllSurfaces(),this.removeAllModels(),this.removeAllLabels(),this.removeAllShapes(),this.show(),this}mapAtomProperties(i,s){s=s||{};var l=this.getAtomsFromSel(s);if(typeof i=="function")for(let g=0,E=l.length;g<E;g++)i(l[g]);else for(let g=0,E=l.length;g<E;g++){var h=l[g];for(let M=0,S=i.length;M<S;M++){let R=i[M];if(R.props)for(var A in R.props)R.props.hasOwnProperty(A)&&this.atomIsSelected(h,R)&&(h.properties||(h.properties={}),h.properties[A]=R.props[A])}}return this}linkViewer(i){return this.linkedViewers.push(i),this}getPerceivedDistance(){return this.CAMERA_Z-this.rotationGroup.position.z}setPerceivedDistance(i){this.rotationGroup.position.z=this.CAMERA_Z-i}setAutoEyeSeparation(i,s){var l=this.getPerceivedDistance();return s||(s=5),i||this.camera.position.x>0?this.camera.position.x=l*Math.tan(Math.PI/180*s):this.camera.position.x=-l*Math.tan(Math.PI/180*s),this.camera.lookAt(new m.Vector3(0,0,this.rotationGroup.position.z)),this.camera.position.x}setDefaultCartoonQuality(i){this.config.cartoonQuality=i}}function Er(ae,i){if(ae=(0,w.getElement)(ae)){i=i||{};try{return new Yt(ae,i)}catch(s){throw"error creating viewer: "+s}}}function Cr(ae,i={},s={}){if(ae=(0,w.getElement)(ae)){var l=[],h=document.createElement("canvas");s.rows=i.rows,s.cols=i.cols,s.control_all=i.control_all!=null&&i.control_all,ae.appendChild(h);try{for(var A=0;A<i.rows;A++){for(var g=[],E=0;E<i.cols;E++){s.row=A,s.col=E,s.canvas=h,s.viewers=l,s.control_all=i.control_all;var M=Er(ae,(0,w.extend)({},s));g.push(M)}l.unshift(g)}}catch(S){throw"error creating viewer grid: "+S}return l}}function Ur(ae){var i=this;if(ae=(0,w.getElement)(ae)){var s=Cr(ae,{rows:1,cols:2,control_all:!0});this.glviewer1=s[0][0],this.glviewer2=s[0][1],this.glviewer1.setAutoEyeSeparation(!1),this.glviewer2.setAutoEyeSeparation(!0),this.glviewer1.linkViewer(this.glviewer2),this.glviewer2.linkViewer(this.glviewer1);for(var l=Object.getOwnPropertyNames(this.glviewer1.__proto__).filter(function(A){return typeof i.glviewer1[A]=="function"}),h=0;h<l.length;h++)this[l[h]]=(function(A){return function(){return[this.glviewer1[A].apply(this.glviewer1,arguments),this.glviewer2[A].apply(this.glviewer2,arguments)]}})(l[h]);this.setCoordinates=function(A,g,E){for(var M=0;M<A.length;M++)A[M].setCoordinates(g,E)},this.surfacesFinished=function(){return this.glviewer1.surfacesFinished()&&this.glviewer2.surfacesFinished()},this.isAnimated=function(){return this.glviewer1.isAnimated()||this.glviewer2.isAnimated()},this.render=function(A){this.glviewer1.render(),this.glviewer2.render(),A&&A(this)},this.getCanvas=function(){return this.glviewer1.getCanvas()}}}Yt.numWorkers=4,Yt.maxVolume=64e3,Yt.surfaceTypeMap={VDW:Gr.VDW,MS:Gr.MS,SAS:Gr.SAS,SES:Gr.SES};var _r=!1,Lr=!1,wr={};function Mi(ae,i){var s,l,h;if(document.querySelector(".viewer_3Dmoljs")!=null&&(_r=!0),_r){Lr=!0,ae=ae??null;var A=0;document.querySelectorAll(".viewer_3Dmoljs").forEach(g=>{var E=[],M=[],S="";g.style.position=="static"&&(g.style.position="relative");var R=null;if(h=null,g.dataset.pdb)E.push("https://files.rcsb.org/view/"+g.dataset.pdb+".pdb"),M.push("pdb");else if(g.dataset.cid)M.push("sdf"),E.push("https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+g.dataset.cid+"/SDF?record_type=3d");else if(g.dataset.href||g.dataset.url){if(S=g.dataset.href?g.dataset.href:g.dataset.url,E.push(S),(h=S.substring(S.lastIndexOf(".")+1))=="gz"){let ot=S.substring(0,S.lastIndexOf(".")).lastIndexOf(".");h=S.substring(ot+1)}M.push(h);var O=S.substring(S.lastIndexOf("/")+1,S.lastIndexOf("."));O=="/"&&(O=S.substring(S.lastIndexOf("/")+1)),g.dataset[M[M.length-1]]=O}let $=g.dataset;for(s in $)s.substring(0,3)==="pdb"&&s!=="pdb"?(E.push("https://files.rcsb.org/view/"+$[s]+".pdb"),M.push("pdb")):s.substring(0,4)==="href"&&s!=="href"?(S=$[s],E.push(S),M.push(S.substring(S.lastIndexOf(".")+1))):s.substring(0,3)==="cid"&&s!=="cid"&&(E.push("https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+$[s]+"/SDF?record_type=3d"),M.push("sdf"));var G={};g.dataset.options&&(G=(0,w.specStringToObject)(g.dataset.options));var j=_.CC.color(g.dataset.backgroundcolor),W=g.dataset.backgroundalpha;W=W==null?1:parseFloat(W);var H={line:{}};g.dataset.style&&(H=(0,w.specStringToObject)(g.dataset.style));var Y={};g.dataset.select&&(Y=(0,w.specStringToObject)(g.dataset.select));var te=[],re=[],de=[],le={},ye=null,Pe=g.dataset,Te=/style(.+)/,ke=/surface(.*)/,we=/labelres(.*)/,Ge=[];for(l in Pe)Object.prototype.hasOwnProperty.call(Pe,l)&&Ge.push(l);for(Ge.sort(),s=0;s<Ge.length;s++){l=Ge[s];var Je,tt,Ye,ut=Te.exec(l);ut&&(Je="select"+ut[1],tt=(0,w.specStringToObject)(Pe[Je]),Ye=(0,w.specStringToObject)(Pe[l]),te.push([tt,Ye])),(ut=ke.exec(l))&&(Je="select"+ut[1],tt=(0,w.specStringToObject)(Pe[Je]),Ye=(0,w.specStringToObject)(Pe[l]),re.push([tt,Ye])),(ut=we.exec(l))&&(Je="select"+ut[1],tt=(0,w.specStringToObject)(Pe[Je]),Ye=(0,w.specStringToObject)(Pe[l]),de.push([tt,Ye])),l=="zoomto"&&(le=(0,w.specStringToObject)(Pe[l])),l=="spin"&&(ye=(0,w.specStringToObject)(Pe[l]))}var ft=function(ot){for(ot.setStyle(Y,H),R&&R.createSelectionAndStyle(Y,H),s=0;s<te.length;s++){let wt=te[s][0]||{},At=te[s][1]||{line:{}};ot.setStyle(wt,At),R&&R.createSelectionAndStyle(Y,H)}for(s=0;s<re.length;s++){let wt=re[s][0]||{},At=re[s][1]||{};R?ot.addSurface(Gr.VDW,At,wt,wt).then(it=>{R.loadSurface("VDW",wt,At,it)}):ot.addSurface(Gr.VDW,At,wt,wt)}for(s=0;s<de.length;s++){let wt=de[s][0]||{},At=de[s][1]||{};ot.addResLabels(wt,At)}ot.render(),ot.zoomTo(le),ye&&ot.spin(ye.axis,ye.speed)};let Qe=ae;try{var pt=(0,w.specStringToObject)(g.dataset.config)||{};pt.backgroundColor===void 0&&(pt.backgroundColor=j),pt.backgroundAlpha===void 0&&(pt.backgroundAlpha=W),Qe==null?Qe=wr[g.id||A++]=Er(g,pt):(Qe.setBackgroundColor(j,W),Qe.setConfig(pt),R&&R.initiateUI()),g.dataset.ui&&$3Dmol.StateManager&&(R=new $3Dmol.StateManager(Qe))}catch(ot){console.log(ot),g.textContent="WebGL appears to be disabled."}if(E.length!=0){let ot=0,wt=((At,it)=>function(Rt){S=E[ot];var Ht=At.dataset.type||At.dataset.datatype||M[ot];if(it.addModel(Rt,Ht,G),R){var kt=At.dataset[M[ot]];R.setModelTitle(kt)}ot+=1,ot<E.length?(0,w.get)(E[ot]).then(wt):(ft(it),At.dataset.callback&&(0,w.makeFunction)(At.dataset.callback)(it),Lr=!1,i&&i(it))})(g,Qe);h&&h.endsWith("gz")?(0,w.getbin)(E[0]).then(wt):(0,w.get)(E[0]).then(wt)}else{if(g.dataset.element){var Be="#"+g.dataset.element,et=document.querySelector(Be),St=et?et.textContent:"";h=g.dataset.type||g.dataset.datatype,Qe.addModel(St,h,G)}ft(Qe),g.dataset.callback&&(0,w.makeFunction)(g.dataset.callback)(Qe),Lr=!1,i&&i(Qe)}})}}document.onreadystatechange=()=>{document.readyState==="complete"&&Mi()};const Qt={"ALA:N":-.15,"ALA:CA":.1,"ALA:CB":0,"ALA:C":.6,"ALA:O":-.55,"ARG:N":-.15,"ARG:CA":.1,"ARG:CB":0,"ARG:CG":0,"ARG:CD":.1,"ARG:NE":-.1,"ARG:CZ":.5,"ARG:NH1":.25,"ARG:NH2":.25,"ARG:C":.6,"ARG:O":-.55,"ASN:N":-.15,"ASN:CA":.1,"ASN:CB":0,"ASN:CG":.55,"ASN:OD1":-.55,"ASN:ND2":0,"ASN:C":.6,"ASN:O":-.55,"ASP:N":-.15,"ASP:CA":.1,"ASP:CB":0,"ASP:CG":.14,"ASP:OD1":-.57,"ASP:OD2":-.57,"ASP:C":.6,"ASP:O":-.55,"CYS:N":-.15,"CYS:CA":.1,"CYS:CB":.19,"CYS:SG":-.19,"CYS:C":.6,"CYS:O":-.55,"GLN:N":-.15,"GLN:CA":.1,"GLN:CB":0,"GLN:CG":0,"GLN:CD":.55,"GLN:OE1":-.55,"GLN:NE2":0,"GLN:C":.6,"GLN:O":-.55,"GLU:N":-.15,"GLU:CA":.1,"GLU:CB":0,"GLU:CG":0,"GLU:CD":.14,"GLU:OE1":-.57,"GLU:OE2":-.57,"GLU:C":.6,"GLU:O":-.55,"GLY:N":-.15,"GLY:CA":.1,"GLY:C":.6,"GLY:O":-.55,"HIS:N":-.15,"HIS:CA":.1,"HIS:CB":0,"HIS:CG":.1,"HIS:ND1":-.1,"HIS:CD2":.1,"HIS:NE2":-.4,"HIS:CE1":.3,"HIS:C":.6,"HIS:O":-.55,"ILE:N":-.15,"ILE:CA":.1,"ILE:CB":0,"ILE:CG2":0,"ILE:CG1":0,"ILE:CD":0,"ILE:C":.6,"ILE:O":-.55,"LEU:N":-.15,"LEU:CA":.1,"LEU:CB":0,"LEU:CG":0,"LEU:CD1":0,"LEU:CD2":0,"LEU:C":.6,"LEU:O":-.55,"LYS:N":-.15,"LYS:CA":.1,"LYS:CB":0,"LYS:CG":0,"LYS:CD":0,"LYS:CE":.25,"LYS:NZ":.75,"LYS:C":.6,"LYS:O":-.55,"MET:N":-.15,"MET:CA":.1,"MET:CB":0,"MET:CG":.06,"MET:SD":-.12,"MET:CE":.06,"MET:C":.6,"MET:O":-.55,"PHE:N":-.15,"PHE:CA":.1,"PHE:CB":0,"PHE:CG":0,"PHE:CD1":0,"PHE:CD2":0,"PHE:CE1":0,"PHE:CE2":0,"PHE:CZ":0,"PHE:C":.6,"PHE:O":-.55,"PRO:N":-.25,"PRO:CD":.1,"PRO:CA":.1,"PRO:CB":0,"PRO:CG":0,"PRO:C":.6,"PRO:O":-.55,"SER:N":-.15,"SER:CA":.1,"SER:CB":.25,"SER:OG":-.25,"SER:C":.6,"SER:O":-.55,"THR:N":-.15,"THR:CA":.1,"THR:CB":.25,"THR:OG1":-.25,"THR:CG2":0,"THR:C":.6,"THR:O":-.55,"TRP:N":-.15,"TRP:CA":.1,"TRP:CB":0,"TRP:CG":-.03,"TRP:CD2":.1,"TRP:CE2":-.04,"TRP:CE3":-.03,"TRP:CD1":.06,"TRP:NE1":-.06,"TRP:CZ2":0,"TRP:CZ3":0,"TRP:CH2":0,"TRP:C":.6,"TRP:O":-.55,"TYR:N":-.15,"TYR:CA":.1,"TYR:CB":0,"TYR:CG":0,"TYR:CD1":0,"TYR:CE1":0,"TYR:CD2":0,"TYR:CE2":0,"TYR:CZ":.25,"TYR:OH":-.25,"TYR:C":.6,"TYR:O":-.55,"VAL:N":-.15,"VAL:CA":.1,"VAL:CB":0,"VAL:CG1":0,"VAL:CG2":0,"VAL:C":.6,"VAL:O":-.55};function ri(ae,i){if((!i||ae.partialCharge===void 0)&&ae.resn&&ae.atom){var s=ae.resn+":"+ae.atom;ae.properties.partialCharge=Qt[s]}}window&&(window.$3Dmol=n)},40:(r,n,a)=>{a.r(n),a.d(n,{bondLength:()=>p,bondTable:()=>c,setBondLength:()=>D});let c={H:.37,He:.32,Li:1.34,Be:.9,B:.82,C:.77,N:.75,O:.73,F:.71,Ne:.69,Na:1.54,Mg:1.3,Al:1.18,Si:1.11,P:1.06,S:1.02,Cl:.99,Ar:.97,K:1.96,Ca:1.74,Sc:1.44,Ti:1.56,V:1.25,Mn:1.39,Fe:1.25,Co:1.26,Ni:1.21,Cu:1.38,Zn:1.31,Ga:1.26,Ge:1.22,Se:1.16,Br:1.14,Kr:1.1,Rb:2.11,Sr:1.92,Y:1.62,Zr:1.48,Nb:1.37,Mo:1.45,Tc:1.56,Ru:1.26,Rh:1.35,Pd:1.31,Ag:1.53,Cd:1.48,In:1.44,Sn:1.41,Sb:1.38,Te:1.35,I:1.33,Xe:1.3,Cs:2.25,Ba:1.98,Lu:1.6,Hf:1.5,Ta:1.38,W:1.46,Re:1.59,Os:1.44,Ir:1.37,Pt:1.28,Au:1.44,Hg:1.49,Tl:1.48,Pb:1.47,Bi:1.46,Rn:1.45};function p(u){return c[u]||1.6}function D(u,v){v<0&&(v=0),c[u]=v}},71:(r,n,a)=>{var c=a(107),p=a(981),D=a(972),u=a(834),v=a(746),m=Object.prototype.toString;function _(w){if(!(this instanceof _))return new _(w);this.options=p.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},w||{});var k=this.options;k.raw&&k.windowBits>0?k.windowBits=-k.windowBits:k.gzip&&k.windowBits>0&&k.windowBits<16&&(k.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new v,this.strm.avail_out=0;var F=c.deflateInit2(this.strm,k.level,k.method,k.windowBits,k.memLevel,k.strategy);if(F!==0)throw new Error(u[F]);if(k.header&&c.deflateSetHeader(this.strm,k.header),k.dictionary){var T;if(T=typeof k.dictionary=="string"?D.string2buf(k.dictionary):m.call(k.dictionary)==="[object ArrayBuffer]"?new Uint8Array(k.dictionary):k.dictionary,(F=c.deflateSetDictionary(this.strm,T))!==0)throw new Error(u[F]);this._dict_set=!0}}function C(w,k){var F=new _(k);if(F.push(w,!0),F.err)throw F.msg||u[F.err];return F.result}_.prototype.push=function(w,k){var F,T,z=this.strm,Q=this.options.chunkSize;if(this.ended)return!1;T=k===~~k?k:k===!0?4:0,typeof w=="string"?z.input=D.string2buf(w):m.call(w)==="[object ArrayBuffer]"?z.input=new Uint8Array(w):z.input=w,z.next_in=0,z.avail_in=z.input.length;do{if(z.avail_out===0&&(z.output=new p.Buf8(Q),z.next_out=0,z.avail_out=Q),(F=c.deflate(z,T))!==1&&F!==0)return this.onEnd(F),this.ended=!0,!1;z.avail_out!==0&&(z.avail_in!==0||T!==4&&T!==2)||(this.options.to==="string"?this.onData(D.buf2binstring(p.shrinkBuf(z.output,z.next_out))):this.onData(p.shrinkBuf(z.output,z.next_out)))}while((z.avail_in>0||z.avail_out===0)&&F!==1);return T===4?(F=c.deflateEnd(this.strm),this.onEnd(F),this.ended=!0,F===0):T!==2||(this.onEnd(0),z.avail_out=0,!0)},_.prototype.onData=function(w){this.chunks.push(w)},_.prototype.onEnd=function(w){w===0&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=p.flattenChunks(this.chunks)),this.chunks=[],this.err=w,this.msg=this.strm.msg},n.Deflate=_,n.deflate=C,n.deflateRaw=function(w,k){return(k=k||{}).raw=!0,C(w,k)},n.gzip=function(w,k){return(k=k||{}).gzip=!0,C(w,k)}},75:(r,n,a)=>{function c(f){let q=f.length;for(;--q>=0;)f[q]=0}a.r(n),a.d(n,{Deflate:()=>ci,Inflate:()=>xi,constants:()=>qr,default:()=>ei,deflate:()=>ni,deflateRaw:()=>hi,gzip:()=>zi,inflate:()=>Ii,inflateRaw:()=>Hr,ungzip:()=>Xr});const p=256,D=286,u=30,v=15,m=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),_=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),C=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),w=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),k=new Array(576);c(k);const F=new Array(60);c(F);const T=new Array(512);c(T);const z=new Array(256);c(z);const Q=new Array(29);c(Q);const J=new Array(u);function K(f,q,y,be,_e){this.static_tree=f,this.extra_bits=q,this.extra_base=y,this.elems=be,this.max_length=_e,this.has_stree=f&&f.length}let b,N,V;function U(f,q){this.dyn_tree=f,this.max_code=0,this.stat_desc=q}c(J);const Z=f=>f<256?T[f]:T[256+(f>>>7)],L=(f,q)=>{f.pending_buf[f.pending++]=255&q,f.pending_buf[f.pending++]=q>>>8&255},ee=(f,q,y)=>{f.bi_valid>16-y?(f.bi_buf|=q<<f.bi_valid&65535,L(f,f.bi_buf),f.bi_buf=q>>16-f.bi_valid,f.bi_valid+=y-16):(f.bi_buf|=q<<f.bi_valid&65535,f.bi_valid+=y)},Ee=(f,q,y)=>{ee(f,y[2*q],y[2*q+1])},he=(f,q)=>{let y=0;do y|=1&f,f>>>=1,y<<=1;while(--q>0);return y>>>1},ge=(f,q,y)=>{const be=new Array(16);let _e,ve,Xe=0;for(_e=1;_e<=v;_e++)Xe=Xe+y[_e-1]<<1,be[_e]=Xe;for(ve=0;ve<=q;ve++){let ze=f[2*ve+1];ze!==0&&(f[2*ve]=he(be[ze]++,ze))}},me=f=>{let q;for(q=0;q<D;q++)f.dyn_ltree[2*q]=0;for(q=0;q<u;q++)f.dyn_dtree[2*q]=0;for(q=0;q<19;q++)f.bl_tree[2*q]=0;f.dyn_ltree[512]=1,f.opt_len=f.static_len=0,f.sym_next=f.matches=0},Me=f=>{f.bi_valid>8?L(f,f.bi_buf):f.bi_valid>0&&(f.pending_buf[f.pending++]=f.bi_buf),f.bi_buf=0,f.bi_valid=0},ue=(f,q,y,be)=>{const _e=2*q,ve=2*y;return f[_e]<f[ve]||f[_e]===f[ve]&&be[q]<=be[y]},I=(f,q,y)=>{const be=f.heap[y];let _e=y<<1;for(;_e<=f.heap_len&&(_e<f.heap_len&&ue(q,f.heap[_e+1],f.heap[_e],f.depth)&&_e++,!ue(q,be,f.heap[_e],f.depth));)f.heap[y]=f.heap[_e],y=_e,_e<<=1;f.heap[y]=be},ce=(f,q,y)=>{let be,_e,ve,Xe,ze=0;if(f.sym_next!==0)do be=255&f.pending_buf[f.sym_buf+ze++],be+=(255&f.pending_buf[f.sym_buf+ze++])<<8,_e=f.pending_buf[f.sym_buf+ze++],be===0?Ee(f,_e,q):(ve=z[_e],Ee(f,ve+p+1,q),Xe=m[ve],Xe!==0&&(_e-=Q[ve],ee(f,_e,Xe)),be--,ve=Z(be),Ee(f,ve,y),Xe=_[ve],Xe!==0&&(be-=J[ve],ee(f,be,Xe)));while(ze<f.sym_next);Ee(f,256,q)},se=(f,q)=>{const y=q.dyn_tree,be=q.stat_desc.static_tree,_e=q.stat_desc.has_stree,ve=q.stat_desc.elems;let Xe,ze,gt,Ne=-1;for(f.heap_len=0,f.heap_max=573,Xe=0;Xe<ve;Xe++)y[2*Xe]!==0?(f.heap[++f.heap_len]=Ne=Xe,f.depth[Xe]=0):y[2*Xe+1]=0;for(;f.heap_len<2;)gt=f.heap[++f.heap_len]=Ne<2?++Ne:0,y[2*gt]=1,f.depth[gt]=0,f.opt_len--,_e&&(f.static_len-=be[2*gt+1]);for(q.max_code=Ne,Xe=f.heap_len>>1;Xe>=1;Xe--)I(f,y,Xe);gt=ve;do Xe=f.heap[1],f.heap[1]=f.heap[f.heap_len--],I(f,y,1),ze=f.heap[1],f.heap[--f.heap_max]=Xe,f.heap[--f.heap_max]=ze,y[2*gt]=y[2*Xe]+y[2*ze],f.depth[gt]=(f.depth[Xe]>=f.depth[ze]?f.depth[Xe]:f.depth[ze])+1,y[2*Xe+1]=y[2*ze+1]=gt,f.heap[1]=gt++,I(f,y,1);while(f.heap_len>=2);f.heap[--f.heap_max]=f.heap[1],((Ke,dr)=>{const Wt=dr.dyn_tree,_t=dr.max_code,si=dr.stat_desc.static_tree,Mr=dr.stat_desc.has_stree,er=dr.stat_desc.extra_bits,zr=dr.stat_desc.extra_base,lr=dr.stat_desc.max_length;let Ct,sr,Pr,Dt,Sr,cr,tr=0;for(Dt=0;Dt<=v;Dt++)Ke.bl_count[Dt]=0;for(Wt[2*Ke.heap[Ke.heap_max]+1]=0,Ct=Ke.heap_max+1;Ct<573;Ct++)sr=Ke.heap[Ct],Dt=Wt[2*Wt[2*sr+1]+1]+1,Dt>lr&&(Dt=lr,tr++),Wt[2*sr+1]=Dt,sr>_t||(Ke.bl_count[Dt]++,Sr=0,sr>=zr&&(Sr=er[sr-zr]),cr=Wt[2*sr],Ke.opt_len+=cr*(Dt+Sr),Mr&&(Ke.static_len+=cr*(si[2*sr+1]+Sr)));if(tr!==0){do{for(Dt=lr-1;Ke.bl_count[Dt]===0;)Dt--;Ke.bl_count[Dt]--,Ke.bl_count[Dt+1]+=2,Ke.bl_count[lr]--,tr-=2}while(tr>0);for(Dt=lr;Dt!==0;Dt--)for(sr=Ke.bl_count[Dt];sr!==0;)Pr=Ke.heap[--Ct],Pr>_t||(Wt[2*Pr+1]!==Dt&&(Ke.opt_len+=(Dt-Wt[2*Pr+1])*Wt[2*Pr],Wt[2*Pr+1]=Dt),sr--)}})(f,q),ge(y,Ne,f.bl_count)},X=(f,q,y)=>{let be,_e,ve=-1,Xe=q[1],ze=0,gt=7,Ne=4;for(Xe===0&&(gt=138,Ne=3),q[2*(y+1)+1]=65535,be=0;be<=y;be++)_e=Xe,Xe=q[2*(be+1)+1],++ze<gt&&_e===Xe||(ze<Ne?f.bl_tree[2*_e]+=ze:_e!==0?(_e!==ve&&f.bl_tree[2*_e]++,f.bl_tree[32]++):ze<=10?f.bl_tree[34]++:f.bl_tree[36]++,ze=0,ve=_e,Xe===0?(gt=138,Ne=3):_e===Xe?(gt=6,Ne=3):(gt=7,Ne=4))},Re=(f,q,y)=>{let be,_e,ve=-1,Xe=q[1],ze=0,gt=7,Ne=4;for(Xe===0&&(gt=138,Ne=3),be=0;be<=y;be++)if(_e=Xe,Xe=q[2*(be+1)+1],!(++ze<gt&&_e===Xe)){if(ze<Ne)do Ee(f,_e,f.bl_tree);while(--ze!==0);else _e!==0?(_e!==ve&&(Ee(f,_e,f.bl_tree),ze--),Ee(f,16,f.bl_tree),ee(f,ze-3,2)):ze<=10?(Ee(f,17,f.bl_tree),ee(f,ze-3,3)):(Ee(f,18,f.bl_tree),ee(f,ze-11,7));ze=0,ve=_e,Xe===0?(gt=138,Ne=3):_e===Xe?(gt=6,Ne=3):(gt=7,Ne=4)}};let fe=!1;const De=(f,q,y,be)=>{ee(f,0+(be?1:0),3),Me(f),L(f,y),L(f,~y),y&&f.pending_buf.set(f.window.subarray(q,q+y),f.pending),f.pending+=y};var We=(f,q,y,be)=>{let _e,ve,Xe=0;f.level>0?(f.strm.data_type===2&&(f.strm.data_type=(ze=>{let gt,Ne=4093624447;for(gt=0;gt<=31;gt++,Ne>>>=1)if(1&Ne&&ze.dyn_ltree[2*gt]!==0)return 0;if(ze.dyn_ltree[18]!==0||ze.dyn_ltree[20]!==0||ze.dyn_ltree[26]!==0)return 1;for(gt=32;gt<p;gt++)if(ze.dyn_ltree[2*gt]!==0)return 1;return 0})(f)),se(f,f.l_desc),se(f,f.d_desc),Xe=(ze=>{let gt;for(X(ze,ze.dyn_ltree,ze.l_desc.max_code),X(ze,ze.dyn_dtree,ze.d_desc.max_code),se(ze,ze.bl_desc),gt=18;gt>=3&&ze.bl_tree[2*w[gt]+1]===0;gt--);return ze.opt_len+=3*(gt+1)+5+5+4,gt})(f),_e=f.opt_len+3+7>>>3,ve=f.static_len+3+7>>>3,ve<=_e&&(_e=ve)):_e=ve=y+5,y+4<=_e&&q!==-1?De(f,q,y,be):f.strategy===4||ve===_e?(ee(f,2+(be?1:0),3),ce(f,k,F)):(ee(f,4+(be?1:0),3),((ze,gt,Ne,Ke)=>{let dr;for(ee(ze,gt-257,5),ee(ze,Ne-1,5),ee(ze,Ke-4,4),dr=0;dr<Ke;dr++)ee(ze,ze.bl_tree[2*w[dr]+1],3);Re(ze,ze.dyn_ltree,gt-1),Re(ze,ze.dyn_dtree,Ne-1)})(f,f.l_desc.max_code+1,f.d_desc.max_code+1,Xe+1),ce(f,f.dyn_ltree,f.dyn_dtree)),me(f),be&&Me(f)},oe={_tr_init:f=>{fe||((()=>{let q,y,be,_e,ve;const Xe=new Array(16);for(be=0,_e=0;_e<28;_e++)for(Q[_e]=be,q=0;q<1<<m[_e];q++)z[be++]=_e;for(z[be-1]=_e,ve=0,_e=0;_e<16;_e++)for(J[_e]=ve,q=0;q<1<<_[_e];q++)T[ve++]=_e;for(ve>>=7;_e<u;_e++)for(J[_e]=ve<<7,q=0;q<1<<_[_e]-7;q++)T[256+ve++]=_e;for(y=0;y<=v;y++)Xe[y]=0;for(q=0;q<=143;)k[2*q+1]=8,q++,Xe[8]++;for(;q<=255;)k[2*q+1]=9,q++,Xe[9]++;for(;q<=279;)k[2*q+1]=7,q++,Xe[7]++;for(;q<=287;)k[2*q+1]=8,q++,Xe[8]++;for(ge(k,287,Xe),q=0;q<u;q++)F[2*q+1]=5,F[2*q]=he(q,5);b=new K(k,m,257,D,v),N=new K(F,_,0,u,v),V=new K(new Array(0),C,0,19,7)})(),fe=!0),f.l_desc=new U(f.dyn_ltree,b),f.d_desc=new U(f.dyn_dtree,N),f.bl_desc=new U(f.bl_tree,V),f.bi_buf=0,f.bi_valid=0,me(f)},_tr_stored_block:De,_tr_flush_block:We,_tr_tally:(f,q,y)=>(f.pending_buf[f.sym_buf+f.sym_next++]=q,f.pending_buf[f.sym_buf+f.sym_next++]=q>>8,f.pending_buf[f.sym_buf+f.sym_next++]=y,q===0?f.dyn_ltree[2*y]++:(f.matches++,q--,f.dyn_ltree[2*(z[y]+p+1)]++,f.dyn_dtree[2*Z(q)]++),f.sym_next===f.sym_end),_tr_align:f=>{ee(f,2,3),Ee(f,256,k),(q=>{q.bi_valid===16?(L(q,q.bi_buf),q.bi_buf=0,q.bi_valid=0):q.bi_valid>=8&&(q.pending_buf[q.pending++]=255&q.bi_buf,q.bi_buf>>=8,q.bi_valid-=8)})(f)}},Ae=(f,q,y,be)=>{let _e=65535&f,ve=f>>>16&65535,Xe=0;for(;y!==0;){Xe=y>2e3?2e3:y,y-=Xe;do _e=_e+q[be++]|0,ve=ve+_e|0;while(--Xe);_e%=65521,ve%=65521}return _e|ve<<16};const He=new Uint32Array((()=>{let f,q=[];for(var y=0;y<256;y++){f=y;for(var be=0;be<8;be++)f=1&f?3988292384^f>>>1:f>>>1;q[y]=f}return q})());var Ue=(f,q,y,be)=>{const _e=He,ve=be+y;f^=-1;for(let Xe=be;Xe<ve;Xe++)f=f>>>8^_e[255&(f^q[Xe])];return-1^f},Ie={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},rt={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:st,_tr_stored_block:at,_tr_flush_block:Ft,_tr_tally:Et,_tr_align:or}=oe,{Z_NO_FLUSH:ar,Z_PARTIAL_FLUSH:kr,Z_FULL_FLUSH:Ar,Z_FINISH:pr,Z_BLOCK:vr,Z_OK:xr,Z_STREAM_END:fi,Z_STREAM_ERROR:Rr,Z_DATA_ERROR:Ir,Z_BUF_ERROR:Di,Z_DEFAULT_COMPRESSION:wi,Z_FILTERED:Hi,Z_HUFFMAN_ONLY:pe,Z_RLE:Se,Z_FIXED:Oe,Z_DEFAULT_STRATEGY:dt,Z_UNKNOWN:nt,Z_DEFLATED:zt}=rt,ht=258,Ot=262,Ut=42,It=113,mr=666,li=(f,q)=>(f.msg=Ie[q],q),Ei=f=>2*f-(f>4?9:0),ui=f=>{let q=f.length;for(;--q>=0;)f[q]=0},gi=f=>{let q,y,be,_e=f.w_size;q=f.hash_size,be=q;do y=f.head[--be],f.head[be]=y>=_e?y-_e:0;while(--q);q=_e,be=q;do y=f.prev[--be],f.prev[be]=y>=_e?y-_e:0;while(--q)};let jr=(f,q,y)=>(q<<f.hash_shift^y)&f.hash_mask;const Or=f=>{const q=f.state;let y=q.pending;y>f.avail_out&&(y=f.avail_out),y!==0&&(f.output.set(q.pending_buf.subarray(q.pending_out,q.pending_out+y),f.next_out),f.next_out+=y,q.pending_out+=y,f.total_out+=y,f.avail_out-=y,q.pending-=y,q.pending===0&&(q.pending_out=0))},Dr=(f,q)=>{Ft(f,f.block_start>=0?f.block_start:-1,f.strstart-f.block_start,q),f.block_start=f.strstart,Or(f.strm)},rr=(f,q)=>{f.pending_buf[f.pending++]=q},vi=(f,q)=>{f.pending_buf[f.pending++]=q>>>8&255,f.pending_buf[f.pending++]=255&q},bi=(f,q,y,be)=>{let _e=f.avail_in;return _e>be&&(_e=be),_e===0?0:(f.avail_in-=_e,q.set(f.input.subarray(f.next_in,f.next_in+_e),y),f.state.wrap===1?f.adler=Ae(f.adler,q,_e,y):f.state.wrap===2&&(f.adler=Ue(f.adler,q,_e,y)),f.next_in+=_e,f.total_in+=_e,_e)},Ki=(f,q)=>{let y,be,_e=f.max_chain_length,ve=f.strstart,Xe=f.prev_length,ze=f.nice_match;const gt=f.strstart>f.w_size-Ot?f.strstart-(f.w_size-Ot):0,Ne=f.window,Ke=f.w_mask,dr=f.prev,Wt=f.strstart+ht;let _t=Ne[ve+Xe-1],si=Ne[ve+Xe];f.prev_length>=f.good_match&&(_e>>=2),ze>f.lookahead&&(ze=f.lookahead);do if(y=q,Ne[y+Xe]===si&&Ne[y+Xe-1]===_t&&Ne[y]===Ne[ve]&&Ne[++y]===Ne[ve+1]){ve+=2,y++;do;while(Ne[++ve]===Ne[++y]&&Ne[++ve]===Ne[++y]&&Ne[++ve]===Ne[++y]&&Ne[++ve]===Ne[++y]&&Ne[++ve]===Ne[++y]&&Ne[++ve]===Ne[++y]&&Ne[++ve]===Ne[++y]&&Ne[++ve]===Ne[++y]&&ve<Wt);if(be=ht-(Wt-ve),ve=Wt-ht,be>Xe){if(f.match_start=q,Xe=be,be>=ze)break;_t=Ne[ve+Xe-1],si=Ne[ve+Xe]}}while((q=dr[q&Ke])>gt&&--_e!==0);return Xe<=f.lookahead?Xe:f.lookahead},Ci=f=>{const q=f.w_size;let y,be,_e;do{if(be=f.window_size-f.lookahead-f.strstart,f.strstart>=q+(q-Ot)&&(f.window.set(f.window.subarray(q,q+q-be),0),f.match_start-=q,f.strstart-=q,f.block_start-=q,f.insert>f.strstart&&(f.insert=f.strstart),gi(f),be+=q),f.strm.avail_in===0)break;if(y=bi(f.strm,f.window,f.strstart+f.lookahead,be),f.lookahead+=y,f.lookahead+f.insert>=3)for(_e=f.strstart-f.insert,f.ins_h=f.window[_e],f.ins_h=jr(f,f.ins_h,f.window[_e+1]);f.insert&&(f.ins_h=jr(f,f.ins_h,f.window[_e+3-1]),f.prev[_e&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=_e,_e++,f.insert--,!(f.lookahead+f.insert<3)););}while(f.lookahead<Ot&&f.strm.avail_in!==0)},Ni=(f,q)=>{let y,be,_e,ve=f.pending_buf_size-5>f.w_size?f.w_size:f.pending_buf_size-5,Xe=0,ze=f.strm.avail_in;do{if(y=65535,_e=f.bi_valid+42>>3,f.strm.avail_out<_e||(_e=f.strm.avail_out-_e,be=f.strstart-f.block_start,y>be+f.strm.avail_in&&(y=be+f.strm.avail_in),y>_e&&(y=_e),y<ve&&(y===0&&q!==pr||q===ar||y!==be+f.strm.avail_in)))break;Xe=q===pr&&y===be+f.strm.avail_in?1:0,at(f,0,0,Xe),f.pending_buf[f.pending-4]=y,f.pending_buf[f.pending-3]=y>>8,f.pending_buf[f.pending-2]=~y,f.pending_buf[f.pending-1]=~y>>8,Or(f.strm),be&&(be>y&&(be=y),f.strm.output.set(f.window.subarray(f.block_start,f.block_start+be),f.strm.next_out),f.strm.next_out+=be,f.strm.avail_out-=be,f.strm.total_out+=be,f.block_start+=be,y-=be),y&&(bi(f.strm,f.strm.output,f.strm.next_out,y),f.strm.next_out+=y,f.strm.avail_out-=y,f.strm.total_out+=y)}while(Xe===0);return ze-=f.strm.avail_in,ze&&(ze>=f.w_size?(f.matches=2,f.window.set(f.strm.input.subarray(f.strm.next_in-f.w_size,f.strm.next_in),0),f.strstart=f.w_size,f.insert=f.strstart):(f.window_size-f.strstart<=ze&&(f.strstart-=f.w_size,f.window.set(f.window.subarray(f.w_size,f.w_size+f.strstart),0),f.matches<2&&f.matches++,f.insert>f.strstart&&(f.insert=f.strstart)),f.window.set(f.strm.input.subarray(f.strm.next_in-ze,f.strm.next_in),f.strstart),f.strstart+=ze,f.insert+=ze>f.w_size-f.insert?f.w_size-f.insert:ze),f.block_start=f.strstart),f.high_water<f.strstart&&(f.high_water=f.strstart),Xe?4:q!==ar&&q!==pr&&f.strm.avail_in===0&&f.strstart===f.block_start?2:(_e=f.window_size-f.strstart,f.strm.avail_in>_e&&f.block_start>=f.w_size&&(f.block_start-=f.w_size,f.strstart-=f.w_size,f.window.set(f.window.subarray(f.w_size,f.w_size+f.strstart),0),f.matches<2&&f.matches++,_e+=f.w_size,f.insert>f.strstart&&(f.insert=f.strstart)),_e>f.strm.avail_in&&(_e=f.strm.avail_in),_e&&(bi(f.strm,f.window,f.strstart,_e),f.strstart+=_e,f.insert+=_e>f.w_size-f.insert?f.w_size-f.insert:_e),f.high_water<f.strstart&&(f.high_water=f.strstart),_e=f.bi_valid+42>>3,_e=f.pending_buf_size-_e>65535?65535:f.pending_buf_size-_e,ve=_e>f.w_size?f.w_size:_e,be=f.strstart-f.block_start,(be>=ve||(be||q===pr)&&q!==ar&&f.strm.avail_in===0&&be<=_e)&&(y=be>_e?_e:be,Xe=q===pr&&f.strm.avail_in===0&&y===be?1:0,at(f,f.block_start,y,Xe),f.block_start+=y,Or(f.strm)),Xe?3:1)},Ti=(f,q)=>{let y,be;for(;;){if(f.lookahead<Ot){if(Ci(f),f.lookahead<Ot&&q===ar)return 1;if(f.lookahead===0)break}if(y=0,f.lookahead>=3&&(f.ins_h=jr(f,f.ins_h,f.window[f.strstart+3-1]),y=f.prev[f.strstart&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=f.strstart),y!==0&&f.strstart-y<=f.w_size-Ot&&(f.match_length=Ki(f,y)),f.match_length>=3)if(be=Et(f,f.strstart-f.match_start,f.match_length-3),f.lookahead-=f.match_length,f.match_length<=f.max_lazy_match&&f.lookahead>=3){f.match_length--;do f.strstart++,f.ins_h=jr(f,f.ins_h,f.window[f.strstart+3-1]),y=f.prev[f.strstart&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=f.strstart;while(--f.match_length!==0);f.strstart++}else f.strstart+=f.match_length,f.match_length=0,f.ins_h=f.window[f.strstart],f.ins_h=jr(f,f.ins_h,f.window[f.strstart+1]);else be=Et(f,0,f.window[f.strstart]),f.lookahead--,f.strstart++;if(be&&(Dr(f,!1),f.strm.avail_out===0))return 1}return f.insert=f.strstart<2?f.strstart:2,q===pr?(Dr(f,!0),f.strm.avail_out===0?3:4):f.sym_next&&(Dr(f,!1),f.strm.avail_out===0)?1:2},pi=(f,q)=>{let y,be,_e;for(;;){if(f.lookahead<Ot){if(Ci(f),f.lookahead<Ot&&q===ar)return 1;if(f.lookahead===0)break}if(y=0,f.lookahead>=3&&(f.ins_h=jr(f,f.ins_h,f.window[f.strstart+3-1]),y=f.prev[f.strstart&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=f.strstart),f.prev_length=f.match_length,f.prev_match=f.match_start,f.match_length=2,y!==0&&f.prev_length<f.max_lazy_match&&f.strstart-y<=f.w_size-Ot&&(f.match_length=Ki(f,y),f.match_length<=5&&(f.strategy===Hi||f.match_length===3&&f.strstart-f.match_start>4096)&&(f.match_length=2)),f.prev_length>=3&&f.match_length<=f.prev_length){_e=f.strstart+f.lookahead-3,be=Et(f,f.strstart-1-f.prev_match,f.prev_length-3),f.lookahead-=f.prev_length-1,f.prev_length-=2;do++f.strstart<=_e&&(f.ins_h=jr(f,f.ins_h,f.window[f.strstart+3-1]),y=f.prev[f.strstart&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=f.strstart);while(--f.prev_length!==0);if(f.match_available=0,f.match_length=2,f.strstart++,be&&(Dr(f,!1),f.strm.avail_out===0))return 1}else if(f.match_available){if(be=Et(f,0,f.window[f.strstart-1]),be&&Dr(f,!1),f.strstart++,f.lookahead--,f.strm.avail_out===0)return 1}else f.match_available=1,f.strstart++,f.lookahead--}return f.match_available&&(be=Et(f,0,f.window[f.strstart-1]),f.match_available=0),f.insert=f.strstart<2?f.strstart:2,q===pr?(Dr(f,!0),f.strm.avail_out===0?3:4):f.sym_next&&(Dr(f,!1),f.strm.avail_out===0)?1:2};function Br(f,q,y,be,_e){this.good_length=f,this.max_lazy=q,this.nice_length=y,this.max_chain=be,this.func=_e}const Yr=[new Br(0,0,0,0,Ni),new Br(4,4,8,4,Ti),new Br(4,5,16,8,Ti),new Br(4,6,32,32,Ti),new Br(4,4,16,16,pi),new Br(8,16,32,32,pi),new Br(8,16,128,128,pi),new Br(8,32,128,256,pi),new Br(32,128,258,1024,pi),new Br(32,258,258,4096,pi)];function Vi(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=zt,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),ui(this.dyn_ltree),ui(this.dyn_dtree),ui(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),ui(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),ui(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const yi=f=>{if(!f)return 1;const q=f.state;return!q||q.strm!==f||q.status!==Ut&&q.status!==57&&q.status!==69&&q.status!==73&&q.status!==91&&q.status!==103&&q.status!==It&&q.status!==mr?1:0},Wi=f=>{if(yi(f))return li(f,Rr);f.total_in=f.total_out=0,f.data_type=nt;const q=f.state;return q.pending=0,q.pending_out=0,q.wrap<0&&(q.wrap=-q.wrap),q.status=q.wrap===2?57:q.wrap?Ut:It,f.adler=q.wrap===2?0:1,q.last_flush=-2,st(q),xr},tn=f=>{const q=Wi(f);var y;return q===xr&&((y=f.state).window_size=2*y.w_size,ui(y.head),y.max_lazy_match=Yr[y.level].max_lazy,y.good_match=Yr[y.level].good_length,y.nice_match=Yr[y.level].nice_length,y.max_chain_length=Yr[y.level].max_chain,y.strstart=0,y.block_start=0,y.lookahead=0,y.insert=0,y.match_length=y.prev_length=2,y.match_available=0,y.ins_h=0),q},on=(f,q,y,be,_e,ve)=>{if(!f)return Rr;let Xe=1;if(q===wi&&(q=6),be<0?(Xe=0,be=-be):be>15&&(Xe=2,be-=16),_e<1||_e>9||y!==zt||be<8||be>15||q<0||q>9||ve<0||ve>Oe||be===8&&Xe!==1)return li(f,Rr);be===8&&(be=9);const ze=new Vi;return f.state=ze,ze.strm=f,ze.status=Ut,ze.wrap=Xe,ze.gzhead=null,ze.w_bits=be,ze.w_size=1<<ze.w_bits,ze.w_mask=ze.w_size-1,ze.hash_bits=_e+7,ze.hash_size=1<<ze.hash_bits,ze.hash_mask=ze.hash_size-1,ze.hash_shift=~~((ze.hash_bits+3-1)/3),ze.window=new Uint8Array(2*ze.w_size),ze.head=new Uint16Array(ze.hash_size),ze.prev=new Uint16Array(ze.w_size),ze.lit_bufsize=1<<_e+6,ze.pending_buf_size=4*ze.lit_bufsize,ze.pending_buf=new Uint8Array(ze.pending_buf_size),ze.sym_buf=ze.lit_bufsize,ze.sym_end=3*(ze.lit_bufsize-1),ze.level=q,ze.strategy=ve,ze.method=y,tn(f)};var ur={deflateInit:(f,q)=>on(f,q,zt,15,8,dt),deflateInit2:on,deflateReset:tn,deflateResetKeep:Wi,deflateSetHeader:(f,q)=>yi(f)||f.state.wrap!==2?Rr:(f.state.gzhead=q,xr),deflate:(f,q)=>{if(yi(f)||q>vr||q<0)return f?li(f,Rr):Rr;const y=f.state;if(!f.output||f.avail_in!==0&&!f.input||y.status===mr&&q!==pr)return li(f,f.avail_out===0?Di:Rr);const be=y.last_flush;if(y.last_flush=q,y.pending!==0){if(Or(f),f.avail_out===0)return y.last_flush=-1,xr}else if(f.avail_in===0&&Ei(q)<=Ei(be)&&q!==pr)return li(f,Di);if(y.status===mr&&f.avail_in!==0)return li(f,Di);if(y.status===Ut&&y.wrap===0&&(y.status=It),y.status===Ut){let _e=zt+(y.w_bits-8<<4)<<8,ve=-1;if(ve=y.strategy>=pe||y.level<2?0:y.level<6?1:y.level===6?2:3,_e|=ve<<6,y.strstart!==0&&(_e|=32),_e+=31-_e%31,vi(y,_e),y.strstart!==0&&(vi(y,f.adler>>>16),vi(y,65535&f.adler)),f.adler=1,y.status=It,Or(f),y.pending!==0)return y.last_flush=-1,xr}if(y.status===57){if(f.adler=0,rr(y,31),rr(y,139),rr(y,8),y.gzhead)rr(y,(y.gzhead.text?1:0)+(y.gzhead.hcrc?2:0)+(y.gzhead.extra?4:0)+(y.gzhead.name?8:0)+(y.gzhead.comment?16:0)),rr(y,255&y.gzhead.time),rr(y,y.gzhead.time>>8&255),rr(y,y.gzhead.time>>16&255),rr(y,y.gzhead.time>>24&255),rr(y,y.level===9?2:y.strategy>=pe||y.level<2?4:0),rr(y,255&y.gzhead.os),y.gzhead.extra&&y.gzhead.extra.length&&(rr(y,255&y.gzhead.extra.length),rr(y,y.gzhead.extra.length>>8&255)),y.gzhead.hcrc&&(f.adler=Ue(f.adler,y.pending_buf,y.pending,0)),y.gzindex=0,y.status=69;else if(rr(y,0),rr(y,0),rr(y,0),rr(y,0),rr(y,0),rr(y,y.level===9?2:y.strategy>=pe||y.level<2?4:0),rr(y,3),y.status=It,Or(f),y.pending!==0)return y.last_flush=-1,xr}if(y.status===69){if(y.gzhead.extra){let _e=y.pending,ve=(65535&y.gzhead.extra.length)-y.gzindex;for(;y.pending+ve>y.pending_buf_size;){let ze=y.pending_buf_size-y.pending;if(y.pending_buf.set(y.gzhead.extra.subarray(y.gzindex,y.gzindex+ze),y.pending),y.pending=y.pending_buf_size,y.gzhead.hcrc&&y.pending>_e&&(f.adler=Ue(f.adler,y.pending_buf,y.pending-_e,_e)),y.gzindex+=ze,Or(f),y.pending!==0)return y.last_flush=-1,xr;_e=0,ve-=ze}let Xe=new Uint8Array(y.gzhead.extra);y.pending_buf.set(Xe.subarray(y.gzindex,y.gzindex+ve),y.pending),y.pending+=ve,y.gzhead.hcrc&&y.pending>_e&&(f.adler=Ue(f.adler,y.pending_buf,y.pending-_e,_e)),y.gzindex=0}y.status=73}if(y.status===73){if(y.gzhead.name){let _e,ve=y.pending;do{if(y.pending===y.pending_buf_size){if(y.gzhead.hcrc&&y.pending>ve&&(f.adler=Ue(f.adler,y.pending_buf,y.pending-ve,ve)),Or(f),y.pending!==0)return y.last_flush=-1,xr;ve=0}_e=y.gzindex<y.gzhead.name.length?255&y.gzhead.name.charCodeAt(y.gzindex++):0,rr(y,_e)}while(_e!==0);y.gzhead.hcrc&&y.pending>ve&&(f.adler=Ue(f.adler,y.pending_buf,y.pending-ve,ve)),y.gzindex=0}y.status=91}if(y.status===91){if(y.gzhead.comment){let _e,ve=y.pending;do{if(y.pending===y.pending_buf_size){if(y.gzhead.hcrc&&y.pending>ve&&(f.adler=Ue(f.adler,y.pending_buf,y.pending-ve,ve)),Or(f),y.pending!==0)return y.last_flush=-1,xr;ve=0}_e=y.gzindex<y.gzhead.comment.length?255&y.gzhead.comment.charCodeAt(y.gzindex++):0,rr(y,_e)}while(_e!==0);y.gzhead.hcrc&&y.pending>ve&&(f.adler=Ue(f.adler,y.pending_buf,y.pending-ve,ve))}y.status=103}if(y.status===103){if(y.gzhead.hcrc){if(y.pending+2>y.pending_buf_size&&(Or(f),y.pending!==0))return y.last_flush=-1,xr;rr(y,255&f.adler),rr(y,f.adler>>8&255),f.adler=0}if(y.status=It,Or(f),y.pending!==0)return y.last_flush=-1,xr}if(f.avail_in!==0||y.lookahead!==0||q!==ar&&y.status!==mr){let _e=y.level===0?Ni(y,q):y.strategy===pe?((ve,Xe)=>{let ze;for(;;){if(ve.lookahead===0&&(Ci(ve),ve.lookahead===0)){if(Xe===ar)return 1;break}if(ve.match_length=0,ze=Et(ve,0,ve.window[ve.strstart]),ve.lookahead--,ve.strstart++,ze&&(Dr(ve,!1),ve.strm.avail_out===0))return 1}return ve.insert=0,Xe===pr?(Dr(ve,!0),ve.strm.avail_out===0?3:4):ve.sym_next&&(Dr(ve,!1),ve.strm.avail_out===0)?1:2})(y,q):y.strategy===Se?((ve,Xe)=>{let ze,gt,Ne,Ke;const dr=ve.window;for(;;){if(ve.lookahead<=ht){if(Ci(ve),ve.lookahead<=ht&&Xe===ar)return 1;if(ve.lookahead===0)break}if(ve.match_length=0,ve.lookahead>=3&&ve.strstart>0&&(Ne=ve.strstart-1,gt=dr[Ne],gt===dr[++Ne]&&gt===dr[++Ne]&&gt===dr[++Ne])){Ke=ve.strstart+ht;do;while(gt===dr[++Ne]&&gt===dr[++Ne]&&gt===dr[++Ne]&&gt===dr[++Ne]&&gt===dr[++Ne]&&gt===dr[++Ne]&&gt===dr[++Ne]&&gt===dr[++Ne]&&Ne<Ke);ve.match_length=ht-(Ke-Ne),ve.match_length>ve.lookahead&&(ve.match_length=ve.lookahead)}if(ve.match_length>=3?(ze=Et(ve,1,ve.match_length-3),ve.lookahead-=ve.match_length,ve.strstart+=ve.match_length,ve.match_length=0):(ze=Et(ve,0,ve.window[ve.strstart]),ve.lookahead--,ve.strstart++),ze&&(Dr(ve,!1),ve.strm.avail_out===0))return 1}return ve.insert=0,Xe===pr?(Dr(ve,!0),ve.strm.avail_out===0?3:4):ve.sym_next&&(Dr(ve,!1),ve.strm.avail_out===0)?1:2})(y,q):Yr[y.level].func(y,q);if(_e!==3&&_e!==4||(y.status=mr),_e===1||_e===3)return f.avail_out===0&&(y.last_flush=-1),xr;if(_e===2&&(q===kr?or(y):q!==vr&&(at(y,0,0,!1),q===Ar&&(ui(y.head),y.lookahead===0&&(y.strstart=0,y.block_start=0,y.insert=0))),Or(f),f.avail_out===0))return y.last_flush=-1,xr}return q!==pr?xr:y.wrap<=0?fi:(y.wrap===2?(rr(y,255&f.adler),rr(y,f.adler>>8&255),rr(y,f.adler>>16&255),rr(y,f.adler>>24&255),rr(y,255&f.total_in),rr(y,f.total_in>>8&255),rr(y,f.total_in>>16&255),rr(y,f.total_in>>24&255)):(vi(y,f.adler>>>16),vi(y,65535&f.adler)),Or(f),y.wrap>0&&(y.wrap=-y.wrap),y.pending!==0?xr:fi)},deflateEnd:f=>{if(yi(f))return Rr;const q=f.state.status;return f.state=null,q===It?li(f,Ir):xr},deflateSetDictionary:(f,q)=>{let y=q.length;if(yi(f))return Rr;const be=f.state,_e=be.wrap;if(_e===2||_e===1&&be.status!==Ut||be.lookahead)return Rr;if(_e===1&&(f.adler=Ae(f.adler,q,y,0)),be.wrap=0,y>=be.w_size){_e===0&&(ui(be.head),be.strstart=0,be.block_start=0,be.insert=0);let gt=new Uint8Array(be.w_size);gt.set(q.subarray(y-be.w_size,y),0),q=gt,y=be.w_size}const ve=f.avail_in,Xe=f.next_in,ze=f.input;for(f.avail_in=y,f.next_in=0,f.input=q,Ci(be);be.lookahead>=3;){let gt=be.strstart,Ne=be.lookahead-2;do be.ins_h=jr(be,be.ins_h,be.window[gt+3-1]),be.prev[gt&be.w_mask]=be.head[be.ins_h],be.head[be.ins_h]=gt,gt++;while(--Ne);be.strstart=gt,be.lookahead=2,Ci(be)}return be.strstart+=be.lookahead,be.block_start=be.strstart,be.insert=be.lookahead,be.lookahead=0,be.match_length=be.prev_length=2,be.match_available=0,f.next_in=Xe,f.input=ze,f.avail_in=ve,be.wrap=_e,xr},deflateInfo:"pako deflate (from Nodeca project)"};const Gr=(f,q)=>Object.prototype.hasOwnProperty.call(f,q);var Kr=function(f){const q=Array.prototype.slice.call(arguments,1);for(;q.length;){const y=q.shift();if(y){if(typeof y!="object")throw new TypeError(y+"must be non-object");for(const be in y)Gr(y,be)&&(f[be]=y[be])}}return f},qi=f=>{let q=0;for(let be=0,_e=f.length;be<_e;be++)q+=f[be].length;const y=new Uint8Array(q);for(let be=0,_e=0,ve=f.length;be<ve;be++){let Xe=f[be];y.set(Xe,_e),_e+=Xe.length}return y};let Bt=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Bt=!1}const x=new Uint8Array(256);for(let f=0;f<256;f++)x[f]=f>=252?6:f>=248?5:f>=240?4:f>=224?3:f>=192?2:1;x[254]=x[254]=1;var ne=f=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(f);let q,y,be,_e,ve,Xe=f.length,ze=0;for(_e=0;_e<Xe;_e++)y=f.charCodeAt(_e),(64512&y)==55296&&_e+1<Xe&&(be=f.charCodeAt(_e+1),(64512&be)==56320&&(y=65536+(y-55296<<10)+(be-56320),_e++)),ze+=y<128?1:y<2048?2:y<65536?3:4;for(q=new Uint8Array(ze),ve=0,_e=0;ve<ze;_e++)y=f.charCodeAt(_e),(64512&y)==55296&&_e+1<Xe&&(be=f.charCodeAt(_e+1),(64512&be)==56320&&(y=65536+(y-55296<<10)+(be-56320),_e++)),y<128?q[ve++]=y:y<2048?(q[ve++]=192|y>>>6,q[ve++]=128|63&y):y<65536?(q[ve++]=224|y>>>12,q[ve++]=128|y>>>6&63,q[ve++]=128|63&y):(q[ve++]=240|y>>>18,q[ve++]=128|y>>>12&63,q[ve++]=128|y>>>6&63,q[ve++]=128|63&y);return q},xe=(f,q)=>{const y=q||f.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(f.subarray(0,q));let be,_e;const ve=new Array(2*y);for(_e=0,be=0;be<y;){let Xe=f[be++];if(Xe<128){ve[_e++]=Xe;continue}let ze=x[Xe];if(ze>4)ve[_e++]=65533,be+=ze-1;else{for(Xe&=ze===2?31:ze===3?15:7;ze>1&&be<y;)Xe=Xe<<6|63&f[be++],ze--;ze>1?ve[_e++]=65533:Xe<65536?ve[_e++]=Xe:(Xe-=65536,ve[_e++]=55296|Xe>>10&1023,ve[_e++]=56320|1023&Xe)}}return((Xe,ze)=>{if(ze<65534&&Xe.subarray&&Bt)return String.fromCharCode.apply(null,Xe.length===ze?Xe:Xe.subarray(0,ze));let gt="";for(let Ne=0;Ne<ze;Ne++)gt+=String.fromCharCode(Xe[Ne]);return gt})(ve,_e)},Ve=(f,q)=>{(q=q||f.length)>f.length&&(q=f.length);let y=q-1;for(;y>=0&&(192&f[y])==128;)y--;return y<0||y===0?q:y+x[f[y]]>q?y:q},Le=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const yt=Object.prototype.toString,{Z_NO_FLUSH:lt,Z_SYNC_FLUSH:mt,Z_FULL_FLUSH:Mt,Z_FINISH:Pt,Z_OK:Lt,Z_STREAM_END:gr,Z_DEFAULT_COMPRESSION:Yt,Z_DEFAULT_STRATEGY:Er,Z_DEFLATED:Cr}=rt;function Ur(f){this.options=Kr({level:Yt,method:Cr,chunkSize:16384,windowBits:15,memLevel:8,strategy:Er},f||{});let q=this.options;q.raw&&q.windowBits>0?q.windowBits=-q.windowBits:q.gzip&&q.windowBits>0&&q.windowBits<16&&(q.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Le,this.strm.avail_out=0;let y=ur.deflateInit2(this.strm,q.level,q.method,q.windowBits,q.memLevel,q.strategy);if(y!==Lt)throw new Error(Ie[y]);if(q.header&&ur.deflateSetHeader(this.strm,q.header),q.dictionary){let be;if(be=typeof q.dictionary=="string"?ne(q.dictionary):yt.call(q.dictionary)==="[object ArrayBuffer]"?new Uint8Array(q.dictionary):q.dictionary,y=ur.deflateSetDictionary(this.strm,be),y!==Lt)throw new Error(Ie[y]);this._dict_set=!0}}function _r(f,q){const y=new Ur(q);if(y.push(f,!0),y.err)throw y.msg||Ie[y.err];return y.result}Ur.prototype.push=function(f,q){const y=this.strm,be=this.options.chunkSize;let _e,ve;if(this.ended)return!1;for(ve=q===~~q?q:q===!0?Pt:lt,typeof f=="string"?y.input=ne(f):yt.call(f)==="[object ArrayBuffer]"?y.input=new Uint8Array(f):y.input=f,y.next_in=0,y.avail_in=y.input.length;;)if(y.avail_out===0&&(y.output=new Uint8Array(be),y.next_out=0,y.avail_out=be),(ve===mt||ve===Mt)&&y.avail_out<=6)this.onData(y.output.subarray(0,y.next_out)),y.avail_out=0;else{if(_e=ur.deflate(y,ve),_e===gr)return y.next_out>0&&this.onData(y.output.subarray(0,y.next_out)),_e=ur.deflateEnd(this.strm),this.onEnd(_e),this.ended=!0,_e===Lt;if(y.avail_out!==0){if(ve>0&&y.next_out>0)this.onData(y.output.subarray(0,y.next_out)),y.avail_out=0;else if(y.avail_in===0)break}else this.onData(y.output)}return!0},Ur.prototype.onData=function(f){this.chunks.push(f)},Ur.prototype.onEnd=function(f){f===Lt&&(this.result=qi(this.chunks)),this.chunks=[],this.err=f,this.msg=this.strm.msg};var Lr={Deflate:Ur,deflate:_r,deflateRaw:function(f,q){return(q=q||{}).raw=!0,_r(f,q)},gzip:function(f,q){return(q=q||{}).gzip=!0,_r(f,q)}};const wr=16209;var Mi=function(f,q){let y,be,_e,ve,Xe,ze,gt,Ne,Ke,dr,Wt,_t,si,Mr,er,zr,lr,Ct,sr,Pr,Dt,Sr,cr,tr;const fr=f.state;y=f.next_in,cr=f.input,be=y+(f.avail_in-5),_e=f.next_out,tr=f.output,ve=_e-(q-f.avail_out),Xe=_e+(f.avail_out-257),ze=fr.dmax,gt=fr.wsize,Ne=fr.whave,Ke=fr.wnext,dr=fr.window,Wt=fr.hold,_t=fr.bits,si=fr.lencode,Mr=fr.distcode,er=(1<<fr.lenbits)-1,zr=(1<<fr.distbits)-1;e:do{_t<15&&(Wt+=cr[y++]<<_t,_t+=8,Wt+=cr[y++]<<_t,_t+=8),lr=si[Wt&er];t:for(;;){if(Ct=lr>>>24,Wt>>>=Ct,_t-=Ct,Ct=lr>>>16&255,Ct===0)tr[_e++]=65535&lr;else{if(!(16&Ct)){if(64&Ct){if(32&Ct){fr.mode=16191;break e}f.msg="invalid literal/length code",fr.mode=wr;break e}lr=si[(65535&lr)+(Wt&(1<<Ct)-1)];continue t}for(sr=65535&lr,Ct&=15,Ct&&(_t<Ct&&(Wt+=cr[y++]<<_t,_t+=8),sr+=Wt&(1<<Ct)-1,Wt>>>=Ct,_t-=Ct),_t<15&&(Wt+=cr[y++]<<_t,_t+=8,Wt+=cr[y++]<<_t,_t+=8),lr=Mr[Wt&zr];;){if(Ct=lr>>>24,Wt>>>=Ct,_t-=Ct,Ct=lr>>>16&255,16&Ct){if(Pr=65535&lr,Ct&=15,_t<Ct&&(Wt+=cr[y++]<<_t,_t+=8,_t<Ct&&(Wt+=cr[y++]<<_t,_t+=8)),Pr+=Wt&(1<<Ct)-1,Pr>ze){f.msg="invalid distance too far back",fr.mode=wr;break e}if(Wt>>>=Ct,_t-=Ct,Ct=_e-ve,Pr>Ct){if(Ct=Pr-Ct,Ct>Ne&&fr.sane){f.msg="invalid distance too far back",fr.mode=wr;break e}if(Dt=0,Sr=dr,Ke===0){if(Dt+=gt-Ct,Ct<sr){sr-=Ct;do tr[_e++]=dr[Dt++];while(--Ct);Dt=_e-Pr,Sr=tr}}else if(Ke<Ct){if(Dt+=gt+Ke-Ct,Ct-=Ke,Ct<sr){sr-=Ct;do tr[_e++]=dr[Dt++];while(--Ct);if(Dt=0,Ke<sr){Ct=Ke,sr-=Ct;do tr[_e++]=dr[Dt++];while(--Ct);Dt=_e-Pr,Sr=tr}}}else if(Dt+=Ke-Ct,Ct<sr){sr-=Ct;do tr[_e++]=dr[Dt++];while(--Ct);Dt=_e-Pr,Sr=tr}for(;sr>2;)tr[_e++]=Sr[Dt++],tr[_e++]=Sr[Dt++],tr[_e++]=Sr[Dt++],sr-=3;sr&&(tr[_e++]=Sr[Dt++],sr>1&&(tr[_e++]=Sr[Dt++]))}else{Dt=_e-Pr;do tr[_e++]=tr[Dt++],tr[_e++]=tr[Dt++],tr[_e++]=tr[Dt++],sr-=3;while(sr>2);sr&&(tr[_e++]=tr[Dt++],sr>1&&(tr[_e++]=tr[Dt++]))}break}if(64&Ct){f.msg="invalid distance code",fr.mode=wr;break e}lr=Mr[(65535&lr)+(Wt&(1<<Ct)-1)]}}break}}while(y<be&&_e<Xe);sr=_t>>3,y-=sr,_t-=sr<<3,Wt&=(1<<_t)-1,f.next_in=y,f.next_out=_e,f.avail_in=y<be?be-y+5:5-(y-be),f.avail_out=_e<Xe?Xe-_e+257:257-(_e-Xe),fr.hold=Wt,fr.bits=_t};const Qt=15,ri=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),ae=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),i=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),s=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var l=(f,q,y,be,_e,ve,Xe,ze)=>{const gt=ze.bits;let Ne,Ke,dr,Wt,_t,si,Mr=0,er=0,zr=0,lr=0,Ct=0,sr=0,Pr=0,Dt=0,Sr=0,cr=0,tr=null;const fr=new Uint16Array(16),Oi=new Uint16Array(16);let Wn,os,$n,Xn=null;for(Mr=0;Mr<=Qt;Mr++)fr[Mr]=0;for(er=0;er<be;er++)fr[q[y+er]]++;for(Ct=gt,lr=Qt;lr>=1&&fr[lr]===0;lr--);if(Ct>lr&&(Ct=lr),lr===0)return _e[ve++]=20971520,_e[ve++]=20971520,ze.bits=1,0;for(zr=1;zr<lr&&fr[zr]===0;zr++);for(Ct<zr&&(Ct=zr),Dt=1,Mr=1;Mr<=Qt;Mr++)if(Dt<<=1,Dt-=fr[Mr],Dt<0)return-1;if(Dt>0&&(f===0||lr!==1))return-1;for(Oi[1]=0,Mr=1;Mr<Qt;Mr++)Oi[Mr+1]=Oi[Mr]+fr[Mr];for(er=0;er<be;er++)q[y+er]!==0&&(Xe[Oi[q[y+er]]++]=er);if(f===0?(tr=Xn=Xe,si=20):f===1?(tr=ri,Xn=ae,si=257):(tr=i,Xn=s,si=0),cr=0,er=0,Mr=zr,_t=ve,sr=Ct,Pr=0,dr=-1,Sr=1<<Ct,Wt=Sr-1,f===1&&Sr>852||f===2&&Sr>592)return 1;for(;;){Wn=Mr-Pr,Xe[er]+1<si?(os=0,$n=Xe[er]):Xe[er]>=si?(os=Xn[Xe[er]-si],$n=tr[Xe[er]-si]):(os=96,$n=0),Ne=1<<Mr-Pr,Ke=1<<sr,zr=Ke;do Ke-=Ne,_e[_t+(cr>>Pr)+Ke]=Wn<<24|os<<16|$n;while(Ke!==0);for(Ne=1<<Mr-1;cr&Ne;)Ne>>=1;if(Ne!==0?(cr&=Ne-1,cr+=Ne):cr=0,er++,--fr[Mr]===0){if(Mr===lr)break;Mr=q[y+Xe[er]]}if(Mr>Ct&&(cr&Wt)!==dr){for(Pr===0&&(Pr=Ct),_t+=zr,sr=Mr-Pr,Dt=1<<sr;sr+Pr<lr&&(Dt-=fr[sr+Pr],!(Dt<=0));)sr++,Dt<<=1;if(Sr+=1<<sr,f===1&&Sr>852||f===2&&Sr>592)return 1;dr=cr&Wt,_e[dr]=Ct<<24|sr<<16|_t-ve}}return cr!==0&&(_e[_t+cr]=Mr-Pr<<24|64<<16),ze.bits=Ct,0};const{Z_FINISH:h,Z_BLOCK:A,Z_TREES:g,Z_OK:E,Z_STREAM_END:M,Z_NEED_DICT:S,Z_STREAM_ERROR:R,Z_DATA_ERROR:O,Z_MEM_ERROR:$,Z_BUF_ERROR:G,Z_DEFLATED:j}=rt,W=16180,H=16190,Y=16191,te=16192,re=16194,de=16199,le=16200,ye=16206,Pe=16209,Te=f=>(f>>>24&255)+(f>>>8&65280)+((65280&f)<<8)+((255&f)<<24);function ke(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const we=f=>{if(!f)return 1;const q=f.state;return!q||q.strm!==f||q.mode<W||q.mode>16211?1:0},Ge=f=>{if(we(f))return R;const q=f.state;return f.total_in=f.total_out=q.total=0,f.msg="",q.wrap&&(f.adler=1&q.wrap),q.mode=W,q.last=0,q.havedict=0,q.flags=-1,q.dmax=32768,q.head=null,q.hold=0,q.bits=0,q.lencode=q.lendyn=new Int32Array(852),q.distcode=q.distdyn=new Int32Array(592),q.sane=1,q.back=-1,E},Je=f=>{if(we(f))return R;const q=f.state;return q.wsize=0,q.whave=0,q.wnext=0,Ge(f)},tt=(f,q)=>{let y;if(we(f))return R;const be=f.state;return q<0?(y=0,q=-q):(y=5+(q>>4),q<48&&(q&=15)),q&&(q<8||q>15)?R:(be.window!==null&&be.wbits!==q&&(be.window=null),be.wrap=y,be.wbits=q,Je(f))},Ye=(f,q)=>{if(!f)return R;const y=new ke;f.state=y,y.strm=f,y.window=null,y.mode=W;const be=tt(f,q);return be!==E&&(f.state=null),be};let ut,ft,Qe=!0;const pt=f=>{if(Qe){ut=new Int32Array(512),ft=new Int32Array(32);let q=0;for(;q<144;)f.lens[q++]=8;for(;q<256;)f.lens[q++]=9;for(;q<280;)f.lens[q++]=7;for(;q<288;)f.lens[q++]=8;for(l(1,f.lens,0,288,ut,0,f.work,{bits:9}),q=0;q<32;)f.lens[q++]=5;l(2,f.lens,0,32,ft,0,f.work,{bits:5}),Qe=!1}f.lencode=ut,f.lenbits=9,f.distcode=ft,f.distbits=5},Be=(f,q,y,be)=>{let _e;const ve=f.state;return ve.window===null&&(ve.wsize=1<<ve.wbits,ve.wnext=0,ve.whave=0,ve.window=new Uint8Array(ve.wsize)),be>=ve.wsize?(ve.window.set(q.subarray(y-ve.wsize,y),0),ve.wnext=0,ve.whave=ve.wsize):(_e=ve.wsize-ve.wnext,_e>be&&(_e=be),ve.window.set(q.subarray(y-be,y-be+_e),ve.wnext),(be-=_e)?(ve.window.set(q.subarray(y-be,y),0),ve.wnext=be,ve.whave=ve.wsize):(ve.wnext+=_e,ve.wnext===ve.wsize&&(ve.wnext=0),ve.whave<ve.wsize&&(ve.whave+=_e))),0};var et={inflateReset:Je,inflateReset2:tt,inflateResetKeep:Ge,inflateInit:f=>Ye(f,15),inflateInit2:Ye,inflate:(f,q)=>{let y,be,_e,ve,Xe,ze,gt,Ne,Ke,dr,Wt,_t,si,Mr,er,zr,lr,Ct,sr,Pr,Dt,Sr,cr=0;const tr=new Uint8Array(4);let fr,Oi;const Wn=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(we(f)||!f.output||!f.input&&f.avail_in!==0)return R;y=f.state,y.mode===Y&&(y.mode=te),Xe=f.next_out,_e=f.output,gt=f.avail_out,ve=f.next_in,be=f.input,ze=f.avail_in,Ne=y.hold,Ke=y.bits,dr=ze,Wt=gt,Sr=E;e:for(;;)switch(y.mode){case W:if(y.wrap===0){y.mode=te;break}for(;Ke<16;){if(ze===0)break e;ze--,Ne+=be[ve++]<<Ke,Ke+=8}if(2&y.wrap&&Ne===35615){y.wbits===0&&(y.wbits=15),y.check=0,tr[0]=255&Ne,tr[1]=Ne>>>8&255,y.check=Ue(y.check,tr,2,0),Ne=0,Ke=0,y.mode=16181;break}if(y.head&&(y.head.done=!1),!(1&y.wrap)||(((255&Ne)<<8)+(Ne>>8))%31){f.msg="incorrect header check",y.mode=Pe;break}if((15&Ne)!==j){f.msg="unknown compression method",y.mode=Pe;break}if(Ne>>>=4,Ke-=4,Dt=8+(15&Ne),y.wbits===0&&(y.wbits=Dt),Dt>15||Dt>y.wbits){f.msg="invalid window size",y.mode=Pe;break}y.dmax=1<<y.wbits,y.flags=0,f.adler=y.check=1,y.mode=512&Ne?16189:Y,Ne=0,Ke=0;break;case 16181:for(;Ke<16;){if(ze===0)break e;ze--,Ne+=be[ve++]<<Ke,Ke+=8}if(y.flags=Ne,(255&y.flags)!==j){f.msg="unknown compression method",y.mode=Pe;break}if(57344&y.flags){f.msg="unknown header flags set",y.mode=Pe;break}y.head&&(y.head.text=Ne>>8&1),512&y.flags&&4&y.wrap&&(tr[0]=255&Ne,tr[1]=Ne>>>8&255,y.check=Ue(y.check,tr,2,0)),Ne=0,Ke=0,y.mode=16182;case 16182:for(;Ke<32;){if(ze===0)break e;ze--,Ne+=be[ve++]<<Ke,Ke+=8}y.head&&(y.head.time=Ne),512&y.flags&&4&y.wrap&&(tr[0]=255&Ne,tr[1]=Ne>>>8&255,tr[2]=Ne>>>16&255,tr[3]=Ne>>>24&255,y.check=Ue(y.check,tr,4,0)),Ne=0,Ke=0,y.mode=16183;case 16183:for(;Ke<16;){if(ze===0)break e;ze--,Ne+=be[ve++]<<Ke,Ke+=8}y.head&&(y.head.xflags=255&Ne,y.head.os=Ne>>8),512&y.flags&&4&y.wrap&&(tr[0]=255&Ne,tr[1]=Ne>>>8&255,y.check=Ue(y.check,tr,2,0)),Ne=0,Ke=0,y.mode=16184;case 16184:if(1024&y.flags){for(;Ke<16;){if(ze===0)break e;ze--,Ne+=be[ve++]<<Ke,Ke+=8}y.length=Ne,y.head&&(y.head.extra_len=Ne),512&y.flags&&4&y.wrap&&(tr[0]=255&Ne,tr[1]=Ne>>>8&255,y.check=Ue(y.check,tr,2,0)),Ne=0,Ke=0}else y.head&&(y.head.extra=null);y.mode=16185;case 16185:if(1024&y.flags&&(_t=y.length,_t>ze&&(_t=ze),_t&&(y.head&&(Dt=y.head.extra_len-y.length,y.head.extra||(y.head.extra=new Uint8Array(y.head.extra_len)),y.head.extra.set(be.subarray(ve,ve+_t),Dt)),512&y.flags&&4&y.wrap&&(y.check=Ue(y.check,be,_t,ve)),ze-=_t,ve+=_t,y.length-=_t),y.length))break e;y.length=0,y.mode=16186;case 16186:if(2048&y.flags){if(ze===0)break e;_t=0;do Dt=be[ve+_t++],y.head&&Dt&&y.length<65536&&(y.head.name+=String.fromCharCode(Dt));while(Dt&&_t<ze);if(512&y.flags&&4&y.wrap&&(y.check=Ue(y.check,be,_t,ve)),ze-=_t,ve+=_t,Dt)break e}else y.head&&(y.head.name=null);y.length=0,y.mode=16187;case 16187:if(4096&y.flags){if(ze===0)break e;_t=0;do Dt=be[ve+_t++],y.head&&Dt&&y.length<65536&&(y.head.comment+=String.fromCharCode(Dt));while(Dt&&_t<ze);if(512&y.flags&&4&y.wrap&&(y.check=Ue(y.check,be,_t,ve)),ze-=_t,ve+=_t,Dt)break e}else y.head&&(y.head.comment=null);y.mode=16188;case 16188:if(512&y.flags){for(;Ke<16;){if(ze===0)break e;ze--,Ne+=be[ve++]<<Ke,Ke+=8}if(4&y.wrap&&Ne!==(65535&y.check)){f.msg="header crc mismatch",y.mode=Pe;break}Ne=0,Ke=0}y.head&&(y.head.hcrc=y.flags>>9&1,y.head.done=!0),f.adler=y.check=0,y.mode=Y;break;case 16189:for(;Ke<32;){if(ze===0)break e;ze--,Ne+=be[ve++]<<Ke,Ke+=8}f.adler=y.check=Te(Ne),Ne=0,Ke=0,y.mode=H;case H:if(y.havedict===0)return f.next_out=Xe,f.avail_out=gt,f.next_in=ve,f.avail_in=ze,y.hold=Ne,y.bits=Ke,S;f.adler=y.check=1,y.mode=Y;case Y:if(q===A||q===g)break e;case te:if(y.last){Ne>>>=7&Ke,Ke-=7&Ke,y.mode=ye;break}for(;Ke<3;){if(ze===0)break e;ze--,Ne+=be[ve++]<<Ke,Ke+=8}switch(y.last=1&Ne,Ne>>>=1,Ke-=1,3&Ne){case 0:y.mode=16193;break;case 1:if(pt(y),y.mode=de,q===g){Ne>>>=2,Ke-=2;break e}break;case 2:y.mode=16196;break;case 3:f.msg="invalid block type",y.mode=Pe}Ne>>>=2,Ke-=2;break;case 16193:for(Ne>>>=7&Ke,Ke-=7&Ke;Ke<32;){if(ze===0)break e;ze--,Ne+=be[ve++]<<Ke,Ke+=8}if((65535&Ne)!=(Ne>>>16^65535)){f.msg="invalid stored block lengths",y.mode=Pe;break}if(y.length=65535&Ne,Ne=0,Ke=0,y.mode=re,q===g)break e;case re:y.mode=16195;case 16195:if(_t=y.length,_t){if(_t>ze&&(_t=ze),_t>gt&&(_t=gt),_t===0)break e;_e.set(be.subarray(ve,ve+_t),Xe),ze-=_t,ve+=_t,gt-=_t,Xe+=_t,y.length-=_t;break}y.mode=Y;break;case 16196:for(;Ke<14;){if(ze===0)break e;ze--,Ne+=be[ve++]<<Ke,Ke+=8}if(y.nlen=257+(31&Ne),Ne>>>=5,Ke-=5,y.ndist=1+(31&Ne),Ne>>>=5,Ke-=5,y.ncode=4+(15&Ne),Ne>>>=4,Ke-=4,y.nlen>286||y.ndist>30){f.msg="too many length or distance symbols",y.mode=Pe;break}y.have=0,y.mode=16197;case 16197:for(;y.have<y.ncode;){for(;Ke<3;){if(ze===0)break e;ze--,Ne+=be[ve++]<<Ke,Ke+=8}y.lens[Wn[y.have++]]=7&Ne,Ne>>>=3,Ke-=3}for(;y.have<19;)y.lens[Wn[y.have++]]=0;if(y.lencode=y.lendyn,y.lenbits=7,fr={bits:y.lenbits},Sr=l(0,y.lens,0,19,y.lencode,0,y.work,fr),y.lenbits=fr.bits,Sr){f.msg="invalid code lengths set",y.mode=Pe;break}y.have=0,y.mode=16198;case 16198:for(;y.have<y.nlen+y.ndist;){for(;cr=y.lencode[Ne&(1<<y.lenbits)-1],er=cr>>>24,zr=cr>>>16&255,lr=65535&cr,!(er<=Ke);){if(ze===0)break e;ze--,Ne+=be[ve++]<<Ke,Ke+=8}if(lr<16)Ne>>>=er,Ke-=er,y.lens[y.have++]=lr;else{if(lr===16){for(Oi=er+2;Ke<Oi;){if(ze===0)break e;ze--,Ne+=be[ve++]<<Ke,Ke+=8}if(Ne>>>=er,Ke-=er,y.have===0){f.msg="invalid bit length repeat",y.mode=Pe;break}Dt=y.lens[y.have-1],_t=3+(3&Ne),Ne>>>=2,Ke-=2}else if(lr===17){for(Oi=er+3;Ke<Oi;){if(ze===0)break e;ze--,Ne+=be[ve++]<<Ke,Ke+=8}Ne>>>=er,Ke-=er,Dt=0,_t=3+(7&Ne),Ne>>>=3,Ke-=3}else{for(Oi=er+7;Ke<Oi;){if(ze===0)break e;ze--,Ne+=be[ve++]<<Ke,Ke+=8}Ne>>>=er,Ke-=er,Dt=0,_t=11+(127&Ne),Ne>>>=7,Ke-=7}if(y.have+_t>y.nlen+y.ndist){f.msg="invalid bit length repeat",y.mode=Pe;break}for(;_t--;)y.lens[y.have++]=Dt}}if(y.mode===Pe)break;if(y.lens[256]===0){f.msg="invalid code -- missing end-of-block",y.mode=Pe;break}if(y.lenbits=9,fr={bits:y.lenbits},Sr=l(1,y.lens,0,y.nlen,y.lencode,0,y.work,fr),y.lenbits=fr.bits,Sr){f.msg="invalid literal/lengths set",y.mode=Pe;break}if(y.distbits=6,y.distcode=y.distdyn,fr={bits:y.distbits},Sr=l(2,y.lens,y.nlen,y.ndist,y.distcode,0,y.work,fr),y.distbits=fr.bits,Sr){f.msg="invalid distances set",y.mode=Pe;break}if(y.mode=de,q===g)break e;case de:y.mode=le;case le:if(ze>=6&&gt>=258){f.next_out=Xe,f.avail_out=gt,f.next_in=ve,f.avail_in=ze,y.hold=Ne,y.bits=Ke,Mi(f,Wt),Xe=f.next_out,_e=f.output,gt=f.avail_out,ve=f.next_in,be=f.input,ze=f.avail_in,Ne=y.hold,Ke=y.bits,y.mode===Y&&(y.back=-1);break}for(y.back=0;cr=y.lencode[Ne&(1<<y.lenbits)-1],er=cr>>>24,zr=cr>>>16&255,lr=65535&cr,!(er<=Ke);){if(ze===0)break e;ze--,Ne+=be[ve++]<<Ke,Ke+=8}if(zr&&!(240&zr)){for(Ct=er,sr=zr,Pr=lr;cr=y.lencode[Pr+((Ne&(1<<Ct+sr)-1)>>Ct)],er=cr>>>24,zr=cr>>>16&255,lr=65535&cr,!(Ct+er<=Ke);){if(ze===0)break e;ze--,Ne+=be[ve++]<<Ke,Ke+=8}Ne>>>=Ct,Ke-=Ct,y.back+=Ct}if(Ne>>>=er,Ke-=er,y.back+=er,y.length=lr,zr===0){y.mode=16205;break}if(32&zr){y.back=-1,y.mode=Y;break}if(64&zr){f.msg="invalid literal/length code",y.mode=Pe;break}y.extra=15&zr,y.mode=16201;case 16201:if(y.extra){for(Oi=y.extra;Ke<Oi;){if(ze===0)break e;ze--,Ne+=be[ve++]<<Ke,Ke+=8}y.length+=Ne&(1<<y.extra)-1,Ne>>>=y.extra,Ke-=y.extra,y.back+=y.extra}y.was=y.length,y.mode=16202;case 16202:for(;cr=y.distcode[Ne&(1<<y.distbits)-1],er=cr>>>24,zr=cr>>>16&255,lr=65535&cr,!(er<=Ke);){if(ze===0)break e;ze--,Ne+=be[ve++]<<Ke,Ke+=8}if(!(240&zr)){for(Ct=er,sr=zr,Pr=lr;cr=y.distcode[Pr+((Ne&(1<<Ct+sr)-1)>>Ct)],er=cr>>>24,zr=cr>>>16&255,lr=65535&cr,!(Ct+er<=Ke);){if(ze===0)break e;ze--,Ne+=be[ve++]<<Ke,Ke+=8}Ne>>>=Ct,Ke-=Ct,y.back+=Ct}if(Ne>>>=er,Ke-=er,y.back+=er,64&zr){f.msg="invalid distance code",y.mode=Pe;break}y.offset=lr,y.extra=15&zr,y.mode=16203;case 16203:if(y.extra){for(Oi=y.extra;Ke<Oi;){if(ze===0)break e;ze--,Ne+=be[ve++]<<Ke,Ke+=8}y.offset+=Ne&(1<<y.extra)-1,Ne>>>=y.extra,Ke-=y.extra,y.back+=y.extra}if(y.offset>y.dmax){f.msg="invalid distance too far back",y.mode=Pe;break}y.mode=16204;case 16204:if(gt===0)break e;if(_t=Wt-gt,y.offset>_t){if(_t=y.offset-_t,_t>y.whave&&y.sane){f.msg="invalid distance too far back",y.mode=Pe;break}_t>y.wnext?(_t-=y.wnext,si=y.wsize-_t):si=y.wnext-_t,_t>y.length&&(_t=y.length),Mr=y.window}else Mr=_e,si=Xe-y.offset,_t=y.length;_t>gt&&(_t=gt),gt-=_t,y.length-=_t;do _e[Xe++]=Mr[si++];while(--_t);y.length===0&&(y.mode=le);break;case 16205:if(gt===0)break e;_e[Xe++]=y.length,gt--,y.mode=le;break;case ye:if(y.wrap){for(;Ke<32;){if(ze===0)break e;ze--,Ne|=be[ve++]<<Ke,Ke+=8}if(Wt-=gt,f.total_out+=Wt,y.total+=Wt,4&y.wrap&&Wt&&(f.adler=y.check=y.flags?Ue(y.check,_e,Wt,Xe-Wt):Ae(y.check,_e,Wt,Xe-Wt)),Wt=gt,4&y.wrap&&(y.flags?Ne:Te(Ne))!==y.check){f.msg="incorrect data check",y.mode=Pe;break}Ne=0,Ke=0}y.mode=16207;case 16207:if(y.wrap&&y.flags){for(;Ke<32;){if(ze===0)break e;ze--,Ne+=be[ve++]<<Ke,Ke+=8}if(4&y.wrap&&Ne!==(4294967295&y.total)){f.msg="incorrect length check",y.mode=Pe;break}Ne=0,Ke=0}y.mode=16208;case 16208:Sr=M;break e;case Pe:Sr=O;break e;case 16210:return $;default:return R}return f.next_out=Xe,f.avail_out=gt,f.next_in=ve,f.avail_in=ze,y.hold=Ne,y.bits=Ke,(y.wsize||Wt!==f.avail_out&&y.mode<Pe&&(y.mode<ye||q!==h))&&Be(f,f.output,f.next_out,Wt-f.avail_out),dr-=f.avail_in,Wt-=f.avail_out,f.total_in+=dr,f.total_out+=Wt,y.total+=Wt,4&y.wrap&&Wt&&(f.adler=y.check=y.flags?Ue(y.check,_e,Wt,f.next_out-Wt):Ae(y.check,_e,Wt,f.next_out-Wt)),f.data_type=y.bits+(y.last?64:0)+(y.mode===Y?128:0)+(y.mode===de||y.mode===re?256:0),(dr===0&&Wt===0||q===h)&&Sr===E&&(Sr=G),Sr},inflateEnd:f=>{if(we(f))return R;let q=f.state;return q.window&&(q.window=null),f.state=null,E},inflateGetHeader:(f,q)=>{if(we(f))return R;const y=f.state;return 2&y.wrap?(y.head=q,q.done=!1,E):R},inflateSetDictionary:(f,q)=>{const y=q.length;let be,_e,ve;return we(f)?R:(be=f.state,be.wrap!==0&&be.mode!==H?R:be.mode===H&&(_e=1,_e=Ae(_e,q,y,0),_e!==be.check)?O:(ve=Be(f,q,y,y),ve?(be.mode=16210,$):(be.havedict=1,E)))},inflateInfo:"pako inflate (from Nodeca project)"},St=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const ot=Object.prototype.toString,{Z_NO_FLUSH:wt,Z_FINISH:At,Z_OK:it,Z_STREAM_END:Rt,Z_NEED_DICT:Ht,Z_STREAM_ERROR:kt,Z_DATA_ERROR:ct,Z_MEM_ERROR:Jt}=rt;function Nt(f){this.options=Kr({chunkSize:65536,windowBits:15,to:""},f||{});const q=this.options;q.raw&&q.windowBits>=0&&q.windowBits<16&&(q.windowBits=-q.windowBits,q.windowBits===0&&(q.windowBits=-15)),!(q.windowBits>=0&&q.windowBits<16)||f&&f.windowBits||(q.windowBits+=32),q.windowBits>15&&q.windowBits<48&&(15&q.windowBits||(q.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Le,this.strm.avail_out=0;let y=et.inflateInit2(this.strm,q.windowBits);if(y!==it)throw new Error(Ie[y]);if(this.header=new St,et.inflateGetHeader(this.strm,this.header),q.dictionary&&(typeof q.dictionary=="string"?q.dictionary=ne(q.dictionary):ot.call(q.dictionary)==="[object ArrayBuffer]"&&(q.dictionary=new Uint8Array(q.dictionary)),q.raw&&(y=et.inflateSetDictionary(this.strm,q.dictionary),y!==it)))throw new Error(Ie[y])}function qt(f,q){const y=new Nt(q);if(y.push(f),y.err)throw y.msg||Ie[y.err];return y.result}Nt.prototype.push=function(f,q){const y=this.strm,be=this.options.chunkSize,_e=this.options.dictionary;let ve,Xe,ze;if(this.ended)return!1;for(Xe=q===~~q?q:q===!0?At:wt,ot.call(f)==="[object ArrayBuffer]"?y.input=new Uint8Array(f):y.input=f,y.next_in=0,y.avail_in=y.input.length;;){for(y.avail_out===0&&(y.output=new Uint8Array(be),y.next_out=0,y.avail_out=be),ve=et.inflate(y,Xe),ve===Ht&&_e&&(ve=et.inflateSetDictionary(y,_e),ve===it?ve=et.inflate(y,Xe):ve===ct&&(ve=Ht));y.avail_in>0&&ve===Rt&&y.state.wrap>0&&f[y.next_in]!==0;)et.inflateReset(y),ve=et.inflate(y,Xe);switch(ve){case kt:case ct:case Ht:case Jt:return this.onEnd(ve),this.ended=!0,!1}if(ze=y.avail_out,y.next_out&&(y.avail_out===0||ve===Rt))if(this.options.to==="string"){let gt=Ve(y.output,y.next_out),Ne=y.next_out-gt,Ke=xe(y.output,gt);y.next_out=Ne,y.avail_out=be-Ne,Ne&&y.output.set(y.output.subarray(gt,gt+Ne),0),this.onData(Ke)}else this.onData(y.output.length===y.next_out?y.output:y.output.subarray(0,y.next_out));if(ve!==it||ze!==0){if(ve===Rt)return ve=et.inflateEnd(this.strm),this.onEnd(ve),this.ended=!0,!0;if(y.avail_in===0)break}}return!0},Nt.prototype.onData=function(f){this.chunks.push(f)},Nt.prototype.onEnd=function(f){f===it&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=qi(this.chunks)),this.chunks=[],this.err=f,this.msg=this.strm.msg};var Vt={Inflate:Nt,inflate:qt,inflateRaw:function(f,q){return(q=q||{}).raw=!0,qt(f,q)},ungzip:qt};const{Deflate:Xt,deflate:yr,deflateRaw:Fr,gzip:Tr}=Lr,{Inflate:ii,inflate:Wr,inflateRaw:br,ungzip:$r}=Vt;var ci=Xt,ni=yr,hi=Fr,zi=Tr,xi=ii,Ii=Wr,Hr=br,Xr=$r,qr=rt,ei={Deflate:Xt,deflate:yr,deflateRaw:Fr,gzip:Tr,Inflate:ii,inflate:Wr,inflateRaw:br,ungzip:$r,constants:rt}},99:(r,n,a)=>{a.r(n),a.d(n,{Cylinder:()=>u,Sphere:()=>p,Triangle:()=>m});var c=a(529);class p{constructor(C={x:0,y:0,z:0},w=0){this.center=new c.Vector3(C.x,C.y,C.z),this.radius=w}set(C,w){return this.center.copy(C),this.radius=w,this}copy(C){return this.center.copy(C.center),this.radius=C.radius,this}applyMatrix4(C){return this.center.applyMatrix4(C),this.radius=this.radius*C.getMaxScaleOnAxis(),this}translate(C){return this.center.add(C),this}equals(C){return C.center.equals(this.center)&&C.radius===this.radius}clone(){return new p().copy(this)}}let D=new c.Vector3;class u{constructor(C=new c.Vector3,w=new c.Vector3,k=0){this.c1=C,this.c2=w,this.radius=k,this.direction=new c.Vector3().subVectors(this.c2,this.c1).normalize()}copy(C){return this.c1.copy(C.c1),this.c2.copy(C.c2),this.direction.copy(C.direction),this.radius=C.radius,this}lengthSq(){return D.subVectors(this.c2,this.c1).lengthSq()}applyMatrix4(C){return this.direction.add(this.c1).applyMatrix4(C),this.c1.applyMatrix4(C),this.c2.applyMatrix4(C),this.direction.sub(this.c1).normalize(),this.radius=this.radius*C.getMaxScaleOnAxis(),this}}const v=new c.Vector3;class m{constructor(C=new c.Vector3,w=new c.Vector3,k=new c.Vector3){this.a=C,this.b=w,this.c=k}copy(C){return this.a.copy(C.a),this.b.copy(C.b),this.c.copy(C.c),this}applyMatrix4(C){return this.a.applyMatrix4(C),this.b.applyMatrix4(C),this.c.applyMatrix4(C),this}getNormal(){var C=this.a.clone();return C.sub(this.b),v.subVectors(this.c,this.b),C.cross(v),C.normalize(),C}}},107:(r,n,a)=>{var c,p=a(981),D=a(697),u=a(701),v=a(407),m=a(834),_=-2,C=258,w=262,k=103,F=113,T=666;function z(I,ce){return I.msg=m[ce],ce}function Q(I){return(I<<1)-(I>4?9:0)}function J(I){for(var ce=I.length;--ce>=0;)I[ce]=0}function K(I){var ce=I.state,se=ce.pending;se>I.avail_out&&(se=I.avail_out),se!==0&&(p.arraySet(I.output,ce.pending_buf,ce.pending_out,se,I.next_out),I.next_out+=se,ce.pending_out+=se,I.total_out+=se,I.avail_out-=se,ce.pending-=se,ce.pending===0&&(ce.pending_out=0))}function b(I,ce){D._tr_flush_block(I,I.block_start>=0?I.block_start:-1,I.strstart-I.block_start,ce),I.block_start=I.strstart,K(I.strm)}function N(I,ce){I.pending_buf[I.pending++]=ce}function V(I,ce){I.pending_buf[I.pending++]=ce>>>8&255,I.pending_buf[I.pending++]=255&ce}function U(I,ce,se,X){var Re=I.avail_in;return Re>X&&(Re=X),Re===0?0:(I.avail_in-=Re,p.arraySet(ce,I.input,I.next_in,Re,se),I.state.wrap===1?I.adler=u(I.adler,ce,Re,se):I.state.wrap===2&&(I.adler=v(I.adler,ce,Re,se)),I.next_in+=Re,I.total_in+=Re,Re)}function Z(I,ce){var se,X,Re=I.max_chain_length,fe=I.strstart,De=I.prev_length,We=I.nice_match,oe=I.strstart>I.w_size-w?I.strstart-(I.w_size-w):0,Ae=I.window,He=I.w_mask,Ue=I.prev,Ie=I.strstart+C,rt=Ae[fe+De-1],st=Ae[fe+De];I.prev_length>=I.good_match&&(Re>>=2),We>I.lookahead&&(We=I.lookahead);do if(Ae[(se=ce)+De]===st&&Ae[se+De-1]===rt&&Ae[se]===Ae[fe]&&Ae[++se]===Ae[fe+1]){fe+=2,se++;do;while(Ae[++fe]===Ae[++se]&&Ae[++fe]===Ae[++se]&&Ae[++fe]===Ae[++se]&&Ae[++fe]===Ae[++se]&&Ae[++fe]===Ae[++se]&&Ae[++fe]===Ae[++se]&&Ae[++fe]===Ae[++se]&&Ae[++fe]===Ae[++se]&&fe<Ie);if(X=C-(Ie-fe),fe=Ie-C,X>De){if(I.match_start=ce,De=X,X>=We)break;rt=Ae[fe+De-1],st=Ae[fe+De]}}while((ce=Ue[ce&He])>oe&&--Re!==0);return De<=I.lookahead?De:I.lookahead}function L(I){var ce,se,X,Re,fe,De=I.w_size;do{if(Re=I.window_size-I.lookahead-I.strstart,I.strstart>=De+(De-w)){p.arraySet(I.window,I.window,De,De,0),I.match_start-=De,I.strstart-=De,I.block_start-=De,ce=se=I.hash_size;do X=I.head[--ce],I.head[ce]=X>=De?X-De:0;while(--se);ce=se=De;do X=I.prev[--ce],I.prev[ce]=X>=De?X-De:0;while(--se);Re+=De}if(I.strm.avail_in===0)break;if(se=U(I.strm,I.window,I.strstart+I.lookahead,Re),I.lookahead+=se,I.lookahead+I.insert>=3)for(fe=I.strstart-I.insert,I.ins_h=I.window[fe],I.ins_h=(I.ins_h<<I.hash_shift^I.window[fe+1])&I.hash_mask;I.insert&&(I.ins_h=(I.ins_h<<I.hash_shift^I.window[fe+3-1])&I.hash_mask,I.prev[fe&I.w_mask]=I.head[I.ins_h],I.head[I.ins_h]=fe,fe++,I.insert--,!(I.lookahead+I.insert<3)););}while(I.lookahead<w&&I.strm.avail_in!==0)}function ee(I,ce){for(var se,X;;){if(I.lookahead<w){if(L(I),I.lookahead<w&&ce===0)return 1;if(I.lookahead===0)break}if(se=0,I.lookahead>=3&&(I.ins_h=(I.ins_h<<I.hash_shift^I.window[I.strstart+3-1])&I.hash_mask,se=I.prev[I.strstart&I.w_mask]=I.head[I.ins_h],I.head[I.ins_h]=I.strstart),se!==0&&I.strstart-se<=I.w_size-w&&(I.match_length=Z(I,se)),I.match_length>=3)if(X=D._tr_tally(I,I.strstart-I.match_start,I.match_length-3),I.lookahead-=I.match_length,I.match_length<=I.max_lazy_match&&I.lookahead>=3){I.match_length--;do I.strstart++,I.ins_h=(I.ins_h<<I.hash_shift^I.window[I.strstart+3-1])&I.hash_mask,se=I.prev[I.strstart&I.w_mask]=I.head[I.ins_h],I.head[I.ins_h]=I.strstart;while(--I.match_length!==0);I.strstart++}else I.strstart+=I.match_length,I.match_length=0,I.ins_h=I.window[I.strstart],I.ins_h=(I.ins_h<<I.hash_shift^I.window[I.strstart+1])&I.hash_mask;else X=D._tr_tally(I,0,I.window[I.strstart]),I.lookahead--,I.strstart++;if(X&&(b(I,!1),I.strm.avail_out===0))return 1}return I.insert=I.strstart<2?I.strstart:2,ce===4?(b(I,!0),I.strm.avail_out===0?3:4):I.last_lit&&(b(I,!1),I.strm.avail_out===0)?1:2}function Ee(I,ce){for(var se,X,Re;;){if(I.lookahead<w){if(L(I),I.lookahead<w&&ce===0)return 1;if(I.lookahead===0)break}if(se=0,I.lookahead>=3&&(I.ins_h=(I.ins_h<<I.hash_shift^I.window[I.strstart+3-1])&I.hash_mask,se=I.prev[I.strstart&I.w_mask]=I.head[I.ins_h],I.head[I.ins_h]=I.strstart),I.prev_length=I.match_length,I.prev_match=I.match_start,I.match_length=2,se!==0&&I.prev_length<I.max_lazy_match&&I.strstart-se<=I.w_size-w&&(I.match_length=Z(I,se),I.match_length<=5&&(I.strategy===1||I.match_length===3&&I.strstart-I.match_start>4096)&&(I.match_length=2)),I.prev_length>=3&&I.match_length<=I.prev_length){Re=I.strstart+I.lookahead-3,X=D._tr_tally(I,I.strstart-1-I.prev_match,I.prev_length-3),I.lookahead-=I.prev_length-1,I.prev_length-=2;do++I.strstart<=Re&&(I.ins_h=(I.ins_h<<I.hash_shift^I.window[I.strstart+3-1])&I.hash_mask,se=I.prev[I.strstart&I.w_mask]=I.head[I.ins_h],I.head[I.ins_h]=I.strstart);while(--I.prev_length!==0);if(I.match_available=0,I.match_length=2,I.strstart++,X&&(b(I,!1),I.strm.avail_out===0))return 1}else if(I.match_available){if((X=D._tr_tally(I,0,I.window[I.strstart-1]))&&b(I,!1),I.strstart++,I.lookahead--,I.strm.avail_out===0)return 1}else I.match_available=1,I.strstart++,I.lookahead--}return I.match_available&&(X=D._tr_tally(I,0,I.window[I.strstart-1]),I.match_available=0),I.insert=I.strstart<2?I.strstart:2,ce===4?(b(I,!0),I.strm.avail_out===0?3:4):I.last_lit&&(b(I,!1),I.strm.avail_out===0)?1:2}function he(I,ce,se,X,Re){this.good_length=I,this.max_lazy=ce,this.nice_length=se,this.max_chain=X,this.func=Re}function ge(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new p.Buf16(1146),this.dyn_dtree=new p.Buf16(122),this.bl_tree=new p.Buf16(78),J(this.dyn_ltree),J(this.dyn_dtree),J(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new p.Buf16(16),this.heap=new p.Buf16(573),J(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new p.Buf16(573),J(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function me(I){var ce;return I&&I.state?(I.total_in=I.total_out=0,I.data_type=2,(ce=I.state).pending=0,ce.pending_out=0,ce.wrap<0&&(ce.wrap=-ce.wrap),ce.status=ce.wrap?42:F,I.adler=ce.wrap===2?0:1,ce.last_flush=0,D._tr_init(ce),0):z(I,_)}function Me(I){var ce,se=me(I);return se===0&&((ce=I.state).window_size=2*ce.w_size,J(ce.head),ce.max_lazy_match=c[ce.level].max_lazy,ce.good_match=c[ce.level].good_length,ce.nice_match=c[ce.level].nice_length,ce.max_chain_length=c[ce.level].max_chain,ce.strstart=0,ce.block_start=0,ce.lookahead=0,ce.insert=0,ce.match_length=ce.prev_length=2,ce.match_available=0,ce.ins_h=0),se}function ue(I,ce,se,X,Re,fe){if(!I)return _;var De=1;if(ce===-1&&(ce=6),X<0?(De=0,X=-X):X>15&&(De=2,X-=16),Re<1||Re>9||se!==8||X<8||X>15||ce<0||ce>9||fe<0||fe>4)return z(I,_);X===8&&(X=9);var We=new ge;return I.state=We,We.strm=I,We.wrap=De,We.gzhead=null,We.w_bits=X,We.w_size=1<<We.w_bits,We.w_mask=We.w_size-1,We.hash_bits=Re+7,We.hash_size=1<<We.hash_bits,We.hash_mask=We.hash_size-1,We.hash_shift=~~((We.hash_bits+3-1)/3),We.window=new p.Buf8(2*We.w_size),We.head=new p.Buf16(We.hash_size),We.prev=new p.Buf16(We.w_size),We.lit_bufsize=1<<Re+6,We.pending_buf_size=4*We.lit_bufsize,We.pending_buf=new p.Buf8(We.pending_buf_size),We.d_buf=1*We.lit_bufsize,We.l_buf=3*We.lit_bufsize,We.level=ce,We.strategy=fe,We.method=se,Me(I)}c=[new he(0,0,0,0,function(I,ce){var se=65535;for(se>I.pending_buf_size-5&&(se=I.pending_buf_size-5);;){if(I.lookahead<=1){if(L(I),I.lookahead===0&&ce===0)return 1;if(I.lookahead===0)break}I.strstart+=I.lookahead,I.lookahead=0;var X=I.block_start+se;if((I.strstart===0||I.strstart>=X)&&(I.lookahead=I.strstart-X,I.strstart=X,b(I,!1),I.strm.avail_out===0)||I.strstart-I.block_start>=I.w_size-w&&(b(I,!1),I.strm.avail_out===0))return 1}return I.insert=0,ce===4?(b(I,!0),I.strm.avail_out===0?3:4):(I.strstart>I.block_start&&(b(I,!1),I.strm.avail_out),1)}),new he(4,4,8,4,ee),new he(4,5,16,8,ee),new he(4,6,32,32,ee),new he(4,4,16,16,Ee),new he(8,16,32,32,Ee),new he(8,16,128,128,Ee),new he(8,32,128,256,Ee),new he(32,128,258,1024,Ee),new he(32,258,258,4096,Ee)],n.deflateInit=function(I,ce){return ue(I,ce,8,15,8,0)},n.deflateInit2=ue,n.deflateReset=Me,n.deflateResetKeep=me,n.deflateSetHeader=function(I,ce){return I&&I.state?I.state.wrap!==2?_:(I.state.gzhead=ce,0):_},n.deflate=function(I,ce){var se,X,Re,fe;if(!I||!I.state||ce>5||ce<0)return I?z(I,_):_;if(X=I.state,!I.output||!I.input&&I.avail_in!==0||X.status===T&&ce!==4)return z(I,I.avail_out===0?-5:_);if(X.strm=I,se=X.last_flush,X.last_flush=ce,X.status===42)if(X.wrap===2)I.adler=0,N(X,31),N(X,139),N(X,8),X.gzhead?(N(X,(X.gzhead.text?1:0)+(X.gzhead.hcrc?2:0)+(X.gzhead.extra?4:0)+(X.gzhead.name?8:0)+(X.gzhead.comment?16:0)),N(X,255&X.gzhead.time),N(X,X.gzhead.time>>8&255),N(X,X.gzhead.time>>16&255),N(X,X.gzhead.time>>24&255),N(X,X.level===9?2:X.strategy>=2||X.level<2?4:0),N(X,255&X.gzhead.os),X.gzhead.extra&&X.gzhead.extra.length&&(N(X,255&X.gzhead.extra.length),N(X,X.gzhead.extra.length>>8&255)),X.gzhead.hcrc&&(I.adler=v(I.adler,X.pending_buf,X.pending,0)),X.gzindex=0,X.status=69):(N(X,0),N(X,0),N(X,0),N(X,0),N(X,0),N(X,X.level===9?2:X.strategy>=2||X.level<2?4:0),N(X,3),X.status=F);else{var De=8+(X.w_bits-8<<4)<<8;De|=(X.strategy>=2||X.level<2?0:X.level<6?1:X.level===6?2:3)<<6,X.strstart!==0&&(De|=32),De+=31-De%31,X.status=F,V(X,De),X.strstart!==0&&(V(X,I.adler>>>16),V(X,65535&I.adler)),I.adler=1}if(X.status===69)if(X.gzhead.extra){for(Re=X.pending;X.gzindex<(65535&X.gzhead.extra.length)&&(X.pending!==X.pending_buf_size||(X.gzhead.hcrc&&X.pending>Re&&(I.adler=v(I.adler,X.pending_buf,X.pending-Re,Re)),K(I),Re=X.pending,X.pending!==X.pending_buf_size));)N(X,255&X.gzhead.extra[X.gzindex]),X.gzindex++;X.gzhead.hcrc&&X.pending>Re&&(I.adler=v(I.adler,X.pending_buf,X.pending-Re,Re)),X.gzindex===X.gzhead.extra.length&&(X.gzindex=0,X.status=73)}else X.status=73;if(X.status===73)if(X.gzhead.name){Re=X.pending;do{if(X.pending===X.pending_buf_size&&(X.gzhead.hcrc&&X.pending>Re&&(I.adler=v(I.adler,X.pending_buf,X.pending-Re,Re)),K(I),Re=X.pending,X.pending===X.pending_buf_size)){fe=1;break}fe=X.gzindex<X.gzhead.name.length?255&X.gzhead.name.charCodeAt(X.gzindex++):0,N(X,fe)}while(fe!==0);X.gzhead.hcrc&&X.pending>Re&&(I.adler=v(I.adler,X.pending_buf,X.pending-Re,Re)),fe===0&&(X.gzindex=0,X.status=91)}else X.status=91;if(X.status===91)if(X.gzhead.comment){Re=X.pending;do{if(X.pending===X.pending_buf_size&&(X.gzhead.hcrc&&X.pending>Re&&(I.adler=v(I.adler,X.pending_buf,X.pending-Re,Re)),K(I),Re=X.pending,X.pending===X.pending_buf_size)){fe=1;break}fe=X.gzindex<X.gzhead.comment.length?255&X.gzhead.comment.charCodeAt(X.gzindex++):0,N(X,fe)}while(fe!==0);X.gzhead.hcrc&&X.pending>Re&&(I.adler=v(I.adler,X.pending_buf,X.pending-Re,Re)),fe===0&&(X.status=k)}else X.status=k;if(X.status===k&&(X.gzhead.hcrc?(X.pending+2>X.pending_buf_size&&K(I),X.pending+2<=X.pending_buf_size&&(N(X,255&I.adler),N(X,I.adler>>8&255),I.adler=0,X.status=F)):X.status=F),X.pending!==0){if(K(I),I.avail_out===0)return X.last_flush=-1,0}else if(I.avail_in===0&&Q(ce)<=Q(se)&&ce!==4)return z(I,-5);if(X.status===T&&I.avail_in!==0)return z(I,-5);if(I.avail_in!==0||X.lookahead!==0||ce!==0&&X.status!==T){var We=X.strategy===2?(function(oe,Ae){for(var He;;){if(oe.lookahead===0&&(L(oe),oe.lookahead===0)){if(Ae===0)return 1;break}if(oe.match_length=0,He=D._tr_tally(oe,0,oe.window[oe.strstart]),oe.lookahead--,oe.strstart++,He&&(b(oe,!1),oe.strm.avail_out===0))return 1}return oe.insert=0,Ae===4?(b(oe,!0),oe.strm.avail_out===0?3:4):oe.last_lit&&(b(oe,!1),oe.strm.avail_out===0)?1:2})(X,ce):X.strategy===3?(function(oe,Ae){for(var He,Ue,Ie,rt,st=oe.window;;){if(oe.lookahead<=C){if(L(oe),oe.lookahead<=C&&Ae===0)return 1;if(oe.lookahead===0)break}if(oe.match_length=0,oe.lookahead>=3&&oe.strstart>0&&(Ue=st[Ie=oe.strstart-1])===st[++Ie]&&Ue===st[++Ie]&&Ue===st[++Ie]){rt=oe.strstart+C;do;while(Ue===st[++Ie]&&Ue===st[++Ie]&&Ue===st[++Ie]&&Ue===st[++Ie]&&Ue===st[++Ie]&&Ue===st[++Ie]&&Ue===st[++Ie]&&Ue===st[++Ie]&&Ie<rt);oe.match_length=C-(rt-Ie),oe.match_length>oe.lookahead&&(oe.match_length=oe.lookahead)}if(oe.match_length>=3?(He=D._tr_tally(oe,1,oe.match_length-3),oe.lookahead-=oe.match_length,oe.strstart+=oe.match_length,oe.match_length=0):(He=D._tr_tally(oe,0,oe.window[oe.strstart]),oe.lookahead--,oe.strstart++),He&&(b(oe,!1),oe.strm.avail_out===0))return 1}return oe.insert=0,Ae===4?(b(oe,!0),oe.strm.avail_out===0?3:4):oe.last_lit&&(b(oe,!1),oe.strm.avail_out===0)?1:2})(X,ce):c[X.level].func(X,ce);if(We!==3&&We!==4||(X.status=T),We===1||We===3)return I.avail_out===0&&(X.last_flush=-1),0;if(We===2&&(ce===1?D._tr_align(X):ce!==5&&(D._tr_stored_block(X,0,0,!1),ce===3&&(J(X.head),X.lookahead===0&&(X.strstart=0,X.block_start=0,X.insert=0))),K(I),I.avail_out===0))return X.last_flush=-1,0}return ce!==4?0:X.wrap<=0?1:(X.wrap===2?(N(X,255&I.adler),N(X,I.adler>>8&255),N(X,I.adler>>16&255),N(X,I.adler>>24&255),N(X,255&I.total_in),N(X,I.total_in>>8&255),N(X,I.total_in>>16&255),N(X,I.total_in>>24&255)):(V(X,I.adler>>>16),V(X,65535&I.adler)),K(I),X.wrap>0&&(X.wrap=-X.wrap),X.pending!==0?0:1)},n.deflateEnd=function(I){var ce;return I&&I.state?(ce=I.state.status)!==42&&ce!==69&&ce!==73&&ce!==91&&ce!==k&&ce!==F&&ce!==T?z(I,_):(I.state=null,ce===F?z(I,-3):0):_},n.deflateSetDictionary=function(I,ce){var se,X,Re,fe,De,We,oe,Ae,He=ce.length;if(!I||!I.state||(fe=(se=I.state).wrap)===2||fe===1&&se.status!==42||se.lookahead)return _;for(fe===1&&(I.adler=u(I.adler,ce,He,0)),se.wrap=0,He>=se.w_size&&(fe===0&&(J(se.head),se.strstart=0,se.block_start=0,se.insert=0),Ae=new p.Buf8(se.w_size),p.arraySet(Ae,ce,He-se.w_size,se.w_size,0),ce=Ae,He=se.w_size),De=I.avail_in,We=I.next_in,oe=I.input,I.avail_in=He,I.next_in=0,I.input=ce,L(se);se.lookahead>=3;){X=se.strstart,Re=se.lookahead-2;do se.ins_h=(se.ins_h<<se.hash_shift^se.window[X+3-1])&se.hash_mask,se.prev[X&se.w_mask]=se.head[se.ins_h],se.head[se.ins_h]=X,X++;while(--Re);se.strstart=X,se.lookahead=2,L(se)}return se.strstart+=se.lookahead,se.block_start=se.strstart,se.insert=se.lookahead,se.lookahead=0,se.match_length=se.prev_length=2,se.match_available=0,I.next_in=We,I.input=oe,I.avail_in=De,se.wrap=fe,0},n.deflateInfo="pako deflate (from Nodeca project)"},111:(r,n,a)=>{var c;c={},r.exports=c,(function(p,D){p.toRGBA8=function(u){var v=u.width,m=u.height;if(u.tabs.acTL==null)return[p.toRGBA8.decodeImage(u.data,v,m,u).buffer];var _=[];u.frames[0].data==null&&(u.frames[0].data=u.data);for(var C,w=new Uint8Array(v*m*4),k=0;k<u.frames.length;k++){var F=u.frames[k],T=F.rect.x,z=F.rect.y,Q=F.rect.width,J=F.rect.height,K=p.toRGBA8.decodeImage(F.data,Q,J,u);if(k==0?C=K:F.blend==0?p._copyTile(K,Q,J,C,v,m,T,z,0):F.blend==1&&p._copyTile(K,Q,J,C,v,m,T,z,1),_.push(C.buffer),C=C.slice(0),F.dispose!=0){if(F.dispose==1)p._copyTile(w,Q,J,C,v,m,T,z,0);else if(F.dispose==2){for(var b=k-1;u.frames[b].dispose==2;)b--;C=new Uint8Array(_[b]).slice(0)}}}return _},p.toRGBA8.decodeImage=function(u,v,m,_){var C=v*m,w=p.decode._getBPP(_),k=Math.ceil(v*w/8),F=new Uint8Array(4*C),T=new Uint32Array(F.buffer),z=_.ctype,Q=_.depth,J=p._bin.readUshort;if(z==6){var K=C<<2;if(Q==8)for(var b=0;b<K;b++)F[b]=u[b];if(Q==16)for(b=0;b<K;b++)F[b]=u[b<<1]}else if(z==2){var N=_.tabs.tRNS,V=-1,U=-1,Z=-1;if(N&&(V=N[0],U=N[1],Z=N[2]),Q==8)for(b=0;b<C;b++){var L=3*b;F[ue=b<<2]=u[L],F[ue+1]=u[L+1],F[ue+2]=u[L+2],F[ue+3]=255,V!=-1&&u[L]==V&&u[L+1]==U&&u[L+2]==Z&&(F[ue+3]=0)}if(Q==16)for(b=0;b<C;b++)L=6*b,F[ue=b<<2]=u[L],F[ue+1]=u[L+2],F[ue+2]=u[L+4],F[ue+3]=255,V!=-1&&J(u,L)==V&&J(u,L+2)==U&&J(u,L+4)==Z&&(F[ue+3]=0)}else if(z==3){var ee=_.tabs.PLTE,Ee=_.tabs.tRNS,he=Ee?Ee.length:0;if(Q==1)for(var ge=0;ge<m;ge++){var me=ge*k,Me=ge*v;for(b=0;b<v;b++){var ue=Me+b<<2,I=3*(ce=u[me+(b>>3)]>>7-(7&b)&1);F[ue]=ee[I],F[ue+1]=ee[I+1],F[ue+2]=ee[I+2],F[ue+3]=ce<he?Ee[ce]:255}}if(Q==2)for(ge=0;ge<m;ge++)for(me=ge*k,Me=ge*v,b=0;b<v;b++)ue=Me+b<<2,I=3*(ce=u[me+(b>>2)]>>6-((3&b)<<1)&3),F[ue]=ee[I],F[ue+1]=ee[I+1],F[ue+2]=ee[I+2],F[ue+3]=ce<he?Ee[ce]:255;if(Q==4)for(ge=0;ge<m;ge++)for(me=ge*k,Me=ge*v,b=0;b<v;b++)ue=Me+b<<2,I=3*(ce=u[me+(b>>1)]>>4-((1&b)<<2)&15),F[ue]=ee[I],F[ue+1]=ee[I+1],F[ue+2]=ee[I+2],F[ue+3]=ce<he?Ee[ce]:255;if(Q==8)for(b=0;b<C;b++){var ce;ue=b<<2,I=3*(ce=u[b]),F[ue]=ee[I],F[ue+1]=ee[I+1],F[ue+2]=ee[I+2],F[ue+3]=ce<he?Ee[ce]:255}}else if(z==4){if(Q==8)for(b=0;b<C;b++){ue=b<<2;var se=u[X=b<<1];F[ue]=se,F[ue+1]=se,F[ue+2]=se,F[ue+3]=u[X+1]}if(Q==16)for(b=0;b<C;b++){var X;ue=b<<2,se=u[X=b<<2],F[ue]=se,F[ue+1]=se,F[ue+2]=se,F[ue+3]=u[X+2]}}else if(z==0){if(V=_.tabs.tRNS?_.tabs.tRNS:-1,Q==1)for(b=0;b<C;b++){var Re=(se=255*(u[b>>3]>>7-(7&b)&1))==255*V?0:255;T[b]=Re<<24|se<<16|se<<8|se}if(Q==2)for(b=0;b<C;b++)Re=(se=85*(u[b>>2]>>6-((3&b)<<1)&3))==85*V?0:255,T[b]=Re<<24|se<<16|se<<8|se;if(Q==4)for(b=0;b<C;b++)Re=(se=17*(u[b>>1]>>4-((1&b)<<2)&15))==17*V?0:255,T[b]=Re<<24|se<<16|se<<8|se;if(Q==8)for(b=0;b<C;b++)Re=(se=u[b])==V?0:255,T[b]=Re<<24|se<<16|se<<8|se;if(Q==16)for(b=0;b<C;b++)se=u[b<<1],Re=J(u,b<<1)==V?0:255,T[b]=Re<<24|se<<16|se<<8|se}return F},p.decode=function(u){for(var v,m=new Uint8Array(u),_=8,C=p._bin,w=C.readUshort,k=C.readUint,F={tabs:{},frames:[]},T=new Uint8Array(m.length),z=0,Q=0,J=[137,80,78,71,13,10,26,10],K=0;K<8;K++)if(m[K]!=J[K])throw"The input is not a PNG file!";for(;_<m.length;){var b=C.readUint(m,_);_+=4;var N=C.readASCII(m,_,4);if(_+=4,N=="IHDR")p.decode._IHDR(m,_,F);else if(N=="IDAT"){for(K=0;K<b;K++)T[z+K]=m[_+K];z+=b}else if(N=="acTL")F.tabs[N]={num_frames:k(m,_),num_plays:k(m,_+4)},v=new Uint8Array(m.length);else if(N=="fcTL"){Q!=0&&((me=F.frames[F.frames.length-1]).data=p.decode._decompress(F,v.slice(0,Q),me.rect.width,me.rect.height),Q=0);var V={x:k(m,_+12),y:k(m,_+16),width:k(m,_+4),height:k(m,_+8)},U=w(m,_+22);U=w(m,_+20)/(U==0?100:U);var Z={rect:V,delay:Math.round(1e3*U),dispose:m[_+24],blend:m[_+25]};F.frames.push(Z)}else if(N=="fdAT"){for(K=0;K<b-4;K++)v[Q+K]=m[_+K+4];Q+=b-4}else if(N=="pHYs")F.tabs[N]=[C.readUint(m,_),C.readUint(m,_+4),m[_+8]];else if(N=="cHRM")for(F.tabs[N]=[],K=0;K<8;K++)F.tabs[N].push(C.readUint(m,_+4*K));else if(N=="tEXt"){F.tabs[N]==null&&(F.tabs[N]={});var L=C.nextZero(m,_),ee=C.readASCII(m,_,L-_),Ee=C.readASCII(m,L+1,_+b-L-1);F.tabs[N][ee]=Ee}else if(N=="iTXt"){F.tabs[N]==null&&(F.tabs[N]={}),L=0;var he=_;L=C.nextZero(m,he),ee=C.readASCII(m,he,L-he),m[he=L+1],m[he+1],he+=2,L=C.nextZero(m,he),C.readASCII(m,he,L-he),he=L+1,L=C.nextZero(m,he),C.readUTF8(m,he,L-he),he=L+1,Ee=C.readUTF8(m,he,b-(he-_)),F.tabs[N][ee]=Ee}else if(N=="PLTE")F.tabs[N]=C.readBytes(m,_,b);else if(N=="hIST"){var ge=F.tabs.PLTE.length/3;for(F.tabs[N]=[],K=0;K<ge;K++)F.tabs[N].push(w(m,_+2*K))}else if(N=="tRNS")F.ctype==3?F.tabs[N]=C.readBytes(m,_,b):F.ctype==0?F.tabs[N]=w(m,_):F.ctype==2&&(F.tabs[N]=[w(m,_),w(m,_+2),w(m,_+4)]);else if(N=="gAMA")F.tabs[N]=C.readUint(m,_)/1e5;else if(N=="sRGB")F.tabs[N]=m[_];else if(N=="bKGD")F.ctype==0||F.ctype==4?F.tabs[N]=[w(m,_)]:F.ctype==2||F.ctype==6?F.tabs[N]=[w(m,_),w(m,_+2),w(m,_+4)]:F.ctype==3&&(F.tabs[N]=m[_]);else if(N=="IEND"){var me;Q!=0&&((me=F.frames[F.frames.length-1]).data=p.decode._decompress(F,v.slice(0,Q),me.rect.width,me.rect.height),Q=0),F.data=p.decode._decompress(F,T,F.width,F.height);break}_+=b,C.readUint(m,_),_+=4}return delete F.compress,delete F.interlace,delete F.filter,F},p.decode._decompress=function(u,v,m,_){return u.compress==0&&(v=p.decode._inflate(v)),u.interlace==0?v=p.decode._filterZero(v,u,0,m,_):u.interlace==1&&(v=p.decode._readInterlace(v,u)),v},p.decode._inflate=function(u){return D.inflate(u)},p.decode._readInterlace=function(u,v){for(var m=v.width,_=v.height,C=p.decode._getBPP(v),w=C>>3,k=Math.ceil(m*C/8),F=new Uint8Array(_*k),T=0,z=[0,0,4,0,2,0,1],Q=[0,4,0,2,0,1,0],J=[8,8,8,4,4,2,2],K=[8,8,4,4,2,2,1],b=0;b<7;){for(var N=J[b],V=K[b],U=0,Z=0,L=z[b];L<_;)L+=N,Z++;for(var ee=Q[b];ee<m;)ee+=V,U++;var Ee=Math.ceil(U*C/8);p.decode._filterZero(u,v,T,U,Z);for(var he=0,ge=z[b];ge<_;){for(var me=Q[b],Me=T+he*Ee<<3;me<m;){var ue;if(C==1&&(ue=(ue=u[Me>>3])>>7-(7&Me)&1,F[ge*k+(me>>3)]|=ue<<7-(3&me)),C==2&&(ue=(ue=u[Me>>3])>>6-(7&Me)&3,F[ge*k+(me>>2)]|=ue<<6-((3&me)<<1)),C==4&&(ue=(ue=u[Me>>3])>>4-(7&Me)&15,F[ge*k+(me>>1)]|=ue<<4-((1&me)<<2)),C>=8)for(var I=ge*k+me*w,ce=0;ce<w;ce++)F[I+ce]=u[(Me>>3)+ce];Me+=C,me+=V}he++,ge+=N}U*Z!=0&&(T+=Z*(1+Ee)),b+=1}return F},p.decode._getBPP=function(u){return[1,null,3,1,2,null,4][u.ctype]*u.depth},p.decode._filterZero=function(u,v,m,_,C){var w=p.decode._getBPP(v),k=Math.ceil(_*w/8),F=p.decode._paeth;w=Math.ceil(w/8);for(var T=0;T<C;T++){var z=m+T*k,Q=z+T+1,J=u[Q-1];if(J==0)for(var K=0;K<k;K++)u[z+K]=u[Q+K];else if(J==1){for(K=0;K<w;K++)u[z+K]=u[Q+K];for(K=w;K<k;K++)u[z+K]=u[Q+K]+u[z+K-w]&255}else if(T==0){for(K=0;K<w;K++)u[z+K]=u[Q+K];if(J==2)for(K=w;K<k;K++)u[z+K]=255&u[Q+K];if(J==3)for(K=w;K<k;K++)u[z+K]=u[Q+K]+(u[z+K-w]>>1)&255;if(J==4)for(K=w;K<k;K++)u[z+K]=u[Q+K]+F(u[z+K-w],0,0)&255}else{if(J==2)for(K=0;K<k;K++)u[z+K]=u[Q+K]+u[z+K-k]&255;if(J==3){for(K=0;K<w;K++)u[z+K]=u[Q+K]+(u[z+K-k]>>1)&255;for(K=w;K<k;K++)u[z+K]=u[Q+K]+(u[z+K-k]+u[z+K-w]>>1)&255}if(J==4){for(K=0;K<w;K++)u[z+K]=u[Q+K]+F(0,u[z+K-k],0)&255;for(K=w;K<k;K++)u[z+K]=u[Q+K]+F(u[z+K-w],u[z+K-k],u[z+K-w-k])&255}}}return u},p.decode._paeth=function(u,v,m){var _=u+v-m,C=Math.abs(_-u),w=Math.abs(_-v),k=Math.abs(_-m);return C<=w&&C<=k?u:w<=k?v:m},p.decode._IHDR=function(u,v,m){var _=p._bin;m.width=_.readUint(u,v),v+=4,m.height=_.readUint(u,v),v+=4,m.depth=u[v],v++,m.ctype=u[v],v++,m.compress=u[v],v++,m.filter=u[v],v++,m.interlace=u[v],v++},p._bin={nextZero:function(u,v){for(;u[v]!=0;)v++;return v},readUshort:function(u,v){return u[v]<<8|u[v+1]},writeUshort:function(u,v,m){u[v]=m>>8&255,u[v+1]=255&m},readUint:function(u,v){return 16777216*u[v]+(u[v+1]<<16|u[v+2]<<8|u[v+3])},writeUint:function(u,v,m){u[v]=m>>24&255,u[v+1]=m>>16&255,u[v+2]=m>>8&255,u[v+3]=255&m},readASCII:function(u,v,m){for(var _="",C=0;C<m;C++)_+=String.fromCharCode(u[v+C]);return _},writeASCII:function(u,v,m){for(var _=0;_<m.length;_++)u[v+_]=m.charCodeAt(_)},readBytes:function(u,v,m){for(var _=[],C=0;C<m;C++)_.push(u[v+C]);return _},pad:function(u){return u.length<2?"0"+u:u},readUTF8:function(u,v,m){for(var _,C="",w=0;w<m;w++)C+="%"+p._bin.pad(u[v+w].toString(16));try{_=decodeURIComponent(C)}catch{return p._bin.readASCII(u,v,m)}return _}},p._copyTile=function(u,v,m,_,C,w,k,F,T){for(var z=Math.min(v,C),Q=Math.min(m,w),J=0,K=0,b=0;b<Q;b++)for(var N=0;N<z;N++)if(k>=0&&F>=0?(J=b*v+N<<2,K=(F+b)*C+k+N<<2):(J=(-F+b)*v-k+N<<2,K=b*C+N<<2),T==0)_[K]=u[J],_[K+1]=u[J+1],_[K+2]=u[J+2],_[K+3]=u[J+3];else if(T==1){var V=u[J+3]*.00392156862745098,U=u[J]*V,Z=u[J+1]*V,L=u[J+2]*V,ee=_[K+3]*(1/255),Ee=_[K]*ee,he=_[K+1]*ee,ge=_[K+2]*ee,me=1-V,Me=V+ee*me,ue=Me==0?0:1/Me;_[K+3]=255*Me,_[K+0]=(U+Ee*me)*ue,_[K+1]=(Z+he*me)*ue,_[K+2]=(L+ge*me)*ue}else if(T==2)V=u[J+3],U=u[J],Z=u[J+1],L=u[J+2],ee=_[K+3],Ee=_[K],he=_[K+1],ge=_[K+2],V==ee&&U==Ee&&Z==he&&L==ge?(_[K]=0,_[K+1]=0,_[K+2]=0,_[K+3]=0):(_[K]=U,_[K+1]=Z,_[K+2]=L,_[K+3]=V);else if(T==3){if(V=u[J+3],U=u[J],Z=u[J+1],L=u[J+2],ee=_[K+3],Ee=_[K],he=_[K+1],ge=_[K+2],V==ee&&U==Ee&&Z==he&&L==ge)continue;if(V<220&&ee>20)return!1}return!0},p.encode=function(u,v,m,_,C,w){_==null&&(_=0),w==null&&(w=!1);for(var k=new Uint8Array(u[0].byteLength*u.length+100),F=[137,80,78,71,13,10,26,10],T=0;T<8;T++)k[T]=F[T];var z=8,Q=p._bin,J=p.crc.crc,K=Q.writeUint,b=Q.writeUshort,N=Q.writeASCII,V=p.encode.compressPNG(u,v,m,_,w);K(k,z,13),N(k,z+=4,"IHDR"),K(k,z+=4,v),K(k,z+=4,m),k[z+=4]=V.depth,k[++z]=V.ctype,k[++z]=0,k[++z]=0,k[++z]=0,K(k,++z,J(k,z-17,17)),K(k,z+=4,1),N(k,z+=4,"sRGB"),k[z+=4]=1,K(k,++z,J(k,z-5,5)),z+=4;var U=u.length>1;if(U&&(K(k,z,8),N(k,z+=4,"acTL"),K(k,z+=4,u.length),K(k,z+=4,0),K(k,z+=4,J(k,z-12,12)),z+=4),V.ctype==3){for(K(k,z,3*(ue=V.plte.length)),N(k,z+=4,"PLTE"),z+=4,T=0;T<ue;T++){var Z=3*T,L=V.plte[T],ee=255&L,Ee=L>>8&255,he=L>>16&255;k[z+Z+0]=ee,k[z+Z+1]=Ee,k[z+Z+2]=he}if(K(k,z+=3*ue,J(k,z-3*ue-4,3*ue+4)),z+=4,V.gotAlpha){for(K(k,z,ue),N(k,z+=4,"tRNS"),z+=4,T=0;T<ue;T++)k[z+T]=V.plte[T]>>24&255;K(k,z+=ue,J(k,z-ue-4,ue+4)),z+=4}}for(var ge=0,me=0;me<V.frames.length;me++){var Me=V.frames[me];U&&(K(k,z,26),N(k,z+=4,"fcTL"),K(k,z+=4,ge++),K(k,z+=4,Me.rect.width),K(k,z+=4,Me.rect.height),K(k,z+=4,Me.rect.x),K(k,z+=4,Me.rect.y),b(k,z+=4,C[me]),b(k,z+=2,1e3),k[z+=2]=Me.dispose,k[++z]=Me.blend,K(k,++z,J(k,z-30,30)),z+=4);var ue,I=Me.cimg;K(k,z,(ue=I.length)+(me==0?0:4));var ce=z+=4;for(N(k,z,me==0?"IDAT":"fdAT"),z+=4,me!=0&&(K(k,z,ge++),z+=4),T=0;T<ue;T++)k[z+T]=I[T];K(k,z+=ue,J(k,ce,z-ce)),z+=4}return K(k,z,0),N(k,z+=4,"IEND"),K(k,z+=4,J(k,z-4,4)),z+=4,k.buffer.slice(0,z)},p.encode.compressPNG=function(u,v,m,_,C){for(var w=p.encode.compress(u,v,m,_,!1,C),k=0;k<u.length;k++){var F=w.frames[k],T=(F.rect.width,F.rect.height),z=F.bpl,Q=F.bpp,J=new Uint8Array(T*z+T);F.cimg=p.encode._filterZero(F.img,T,Q,z,J)}return w},p.encode.compress=function(u,v,m,_,C,w){w==null&&(w=!1);for(var k=6,F=8,T=4,z=255,Q=0;Q<u.length;Q++)for(var J=new Uint8Array(u[Q]),K=J.length,b=0;b<K;b+=4)z&=J[b+3];var N=z!=255,V={},U=[];if(u.length!=0&&(V[0]=0,U.push(0),_!=0&&_--),_!=0){var Z=p.quantize(u,_,C);for(u=Z.bufs,b=0;b<Z.plte.length;b++)V[ee=Z.plte[b].est.rgba]==null&&(V[ee]=U.length,U.push(ee))}else for(Q=0;Q<u.length;Q++){var L=new Uint32Array(u[Q]);for(K=L.length,b=0;b<K;b++){var ee=L[b];if((b<v||ee!=L[b-1]&&ee!=L[b-v])&&V[ee]==null&&(V[ee]=U.length,U.push(ee),U.length>=300))break}}var Ee=!!N&&C,he=U.length;he<=256&&w==0&&(F=he<=2?1:he<=4?2:he<=16?4:8,C&&(F=8),N=!0);var ge=[];for(Q=0;Q<u.length;Q++){var me=new Uint8Array(u[Q]),Me=new Uint32Array(me.buffer),ue=0,I=0,ce=v,se=m,X=0;if(Q!=0&&!Ee){for(var Re=C||Q==1||ge[ge.length-2].dispose==2?1:2,fe=0,De=1e9,We=0;We<Re;We++){for(var oe=new Uint8Array(u[Q-1-We]),Ae=new Uint32Array(u[Q-1-We]),He=v,Ue=m,Ie=-1,rt=-1,st=0;st<m;st++)for(var at=0;at<v;at++)Me[b=st*v+at]!=Ae[b]&&(at<He&&(He=at),at>Ie&&(Ie=at),st<Ue&&(Ue=st),st>rt&&(rt=st));var Ft=Ie==-1?1:(Ie-He+1)*(rt-Ue+1);Ft<De&&(De=Ft,fe=We,Ie==-1?(ue=I=0,ce=se=1):(ue=He,I=Ue,ce=Ie-He+1,se=rt-Ue+1))}oe=new Uint8Array(u[Q-1-fe]),fe==1&&(ge[ge.length-1].dispose=2);var Et=new Uint8Array(ce*se*4);new Uint32Array(Et.buffer),p._copyTile(oe,v,m,Et,ce,se,-ue,-I,0),p._copyTile(me,v,m,Et,ce,se,-ue,-I,3)?(p._copyTile(me,v,m,Et,ce,se,-ue,-I,2),X=1):(p._copyTile(me,v,m,Et,ce,se,-ue,-I,0),X=0),me=Et,Me=new Uint32Array(me.buffer)}var or=4*ce;if(he<=256&&w==0){for(or=Math.ceil(F*ce/8),Et=new Uint8Array(or*se),st=0;st<se;st++){b=st*or;var ar=st*ce;if(F==8)for(at=0;at<ce;at++)Et[b+at]=V[Me[ar+at]];else if(F==4)for(at=0;at<ce;at++)Et[b+(at>>1)]|=V[Me[ar+at]]<<4-4*(1&at);else if(F==2)for(at=0;at<ce;at++)Et[b+(at>>2)]|=V[Me[ar+at]]<<6-2*(3&at);else if(F==1)for(at=0;at<ce;at++)Et[b+(at>>3)]|=V[Me[ar+at]]<<7-1*(7&at)}me=Et,k=3,T=1}else if(N==0&&u.length==1){Et=new Uint8Array(ce*se*3);var kr=ce*se;for(b=0;b<kr;b++){var Ar=3*b,pr=4*b;Et[Ar]=me[pr],Et[Ar+1]=me[pr+1],Et[Ar+2]=me[pr+2]}me=Et,k=2,T=3,or=3*ce}ge.push({rect:{x:ue,y:I,width:ce,height:se},img:me,bpl:or,bpp:T,blend:X,dispose:Ee?1:0})}return{ctype:k,depth:F,plte:U,gotAlpha:N,frames:ge}},p.encode._filterZero=function(u,v,m,_,C){for(var w=[],k=0;k<5;k++)if(!(v*_>5e5)||k!=2&&k!=3&&k!=4){for(var F=0;F<v;F++)p.encode._filterLine(C,u,F,_,m,k);if(w.push(D.deflate(C)),m==1)break}for(var T,z=1e9,Q=0;Q<w.length;Q++)w[Q].length<z&&(T=Q,z=w[Q].length);return w[T]},p.encode._filterLine=function(u,v,m,_,C,w){var k=m*_,F=k+m,T=p.decode._paeth;if(u[F]=w,F++,w==0)for(var z=0;z<_;z++)u[F+z]=v[k+z];else if(w==1){for(z=0;z<C;z++)u[F+z]=v[k+z];for(z=C;z<_;z++)u[F+z]=v[k+z]-v[k+z-C]+256&255}else if(m==0){for(z=0;z<C;z++)u[F+z]=v[k+z];if(w==2)for(z=C;z<_;z++)u[F+z]=v[k+z];if(w==3)for(z=C;z<_;z++)u[F+z]=v[k+z]-(v[k+z-C]>>1)+256&255;if(w==4)for(z=C;z<_;z++)u[F+z]=v[k+z]-T(v[k+z-C],0,0)+256&255}else{if(w==2)for(z=0;z<_;z++)u[F+z]=v[k+z]+256-v[k+z-_]&255;if(w==3){for(z=0;z<C;z++)u[F+z]=v[k+z]+256-(v[k+z-_]>>1)&255;for(z=C;z<_;z++)u[F+z]=v[k+z]+256-(v[k+z-_]+v[k+z-C]>>1)&255}if(w==4){for(z=0;z<C;z++)u[F+z]=v[k+z]+256-T(0,v[k+z-_],0)&255;for(z=C;z<_;z++)u[F+z]=v[k+z]+256-T(v[k+z-C],v[k+z-_],v[k+z-C-_])&255}}},p.crc={table:(function(){for(var u=new Uint32Array(256),v=0;v<256;v++){for(var m=v,_=0;_<8;_++)1&m?m=3988292384^m>>>1:m>>>=1;u[v]=m}return u})(),update:function(u,v,m,_){for(var C=0;C<_;C++)u=p.crc.table[255&(u^v[m+C])]^u>>>8;return u},crc:function(u,v,m){return 4294967295^p.crc.update(4294967295,u,v,m)}},p.quantize=function(u,v,m){for(var _=[],C=0,w=0;w<u.length;w++)_.push(p.encode.alphaMul(new Uint8Array(u[w]),m)),C+=u[w].byteLength;var k=new Uint8Array(C),F=new Uint32Array(k.buffer),T=0;for(w=0;w<_.length;w++){for(var z=_[w],Q=z.length,J=0;J<Q;J++)k[T+J]=z[J];T+=Q}var K={i0:0,i1:k.length,bst:null,est:null,tdst:0,left:null,right:null};K.bst=p.quantize.stats(k,K.i0,K.i1),K.est=p.quantize.estats(K.bst);for(var b=[K];b.length<v;){var N=0,V=0;for(w=0;w<b.length;w++)b[w].est.L>N&&(N=b[w].est.L,V=w);if(N<.001)break;var U=b[V],Z=p.quantize.splitPixels(k,F,U.i0,U.i1,U.est.e,U.est.eMq255),L={i0:U.i0,i1:Z,bst:null,est:null,tdst:0,left:null,right:null};L.bst=p.quantize.stats(k,L.i0,L.i1),L.est=p.quantize.estats(L.bst);var ee={i0:Z,i1:U.i1,bst:null,est:null,tdst:0,left:null,right:null};for(ee.bst={R:[],m:[],N:U.bst.N-L.bst.N},w=0;w<16;w++)ee.bst.R[w]=U.bst.R[w]-L.bst.R[w];for(w=0;w<4;w++)ee.bst.m[w]=U.bst.m[w]-L.bst.m[w];ee.est=p.quantize.estats(ee.bst),U.left=L,U.right=ee,b[V]=L,b.push(ee)}b.sort(function(Re,fe){return fe.bst.N-Re.bst.N});for(var Ee=0;Ee<_.length;Ee++){var he=p.quantize.planeDst,ge=new Uint8Array(_[Ee].buffer),me=new Uint32Array(_[Ee].buffer),Me=ge.length;for(w=0;w<Me;w+=4){for(var ue=ge[w]*.00392156862745098,I=ge[w+1]*.00392156862745098,ce=ge[w+2]*.00392156862745098,se=ge[w+3]*.00392156862745098,X=K;X.left;)X=he(X.est,ue,I,ce,se)<=0?X.left:X.right;me[w>>2]=X.est.rgba}_[Ee]=me.buffer}return{bufs:_,plte:b}},p.quantize.getNearest=function(u,v,m,_,C){if(u.left==null)return u.tdst=p.quantize.dist(u.est.q,v,m,_,C),u;var w=p.quantize.planeDst(u.est,v,m,_,C),k=u.left,F=u.right;w>0&&(k=u.right,F=u.left);var T=p.quantize.getNearest(k,v,m,_,C);if(T.tdst<=w*w)return T;var z=p.quantize.getNearest(F,v,m,_,C);return z.tdst<T.tdst?z:T},p.quantize.planeDst=function(u,v,m,_,C){var w=u.e;return w[0]*v+w[1]*m+w[2]*_+w[3]*C-u.eMq},p.quantize.dist=function(u,v,m,_,C){var w=v-u[0],k=m-u[1],F=_-u[2],T=C-u[3];return w*w+k*k+F*F+T*T},p.quantize.splitPixels=function(u,v,m,_,C,w){var k=p.quantize.vecDot;for(_-=4;m<_;){for(;k(u,m,C)<=w;)m+=4;for(;k(u,_,C)>w;)_-=4;if(m>=_)break;var F=v[m>>2];v[m>>2]=v[_>>2],v[_>>2]=F,m+=4,_-=4}for(;k(u,m,C)>w;)m-=4;return m+4},p.quantize.vecDot=function(u,v,m){return u[v]*m[0]+u[v+1]*m[1]+u[v+2]*m[2]+u[v+3]*m[3]},p.quantize.stats=function(u,v,m){for(var _=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],C=[0,0,0,0],w=m-v>>2,k=v;k<m;k+=4){var F=u[k]*.00392156862745098,T=u[k+1]*(1/255),z=u[k+2]*(1/255),Q=u[k+3]*(1/255);C[0]+=F,C[1]+=T,C[2]+=z,C[3]+=Q,_[0]+=F*F,_[1]+=F*T,_[2]+=F*z,_[3]+=F*Q,_[5]+=T*T,_[6]+=T*z,_[7]+=T*Q,_[10]+=z*z,_[11]+=z*Q,_[15]+=Q*Q}return _[4]=_[1],_[8]=_[2],_[12]=_[3],_[9]=_[6],_[13]=_[7],_[14]=_[11],{R:_,m:C,N:w}},p.quantize.estats=function(u){var v=u.R,m=u.m,_=u.N,C=m[0],w=m[1],k=m[2],F=m[3],T=_==0?0:1/_,z=[v[0]-C*C*T,v[1]-C*w*T,v[2]-C*k*T,v[3]-C*F*T,v[4]-w*C*T,v[5]-w*w*T,v[6]-w*k*T,v[7]-w*F*T,v[8]-k*C*T,v[9]-k*w*T,v[10]-k*k*T,v[11]-k*F*T,v[12]-F*C*T,v[13]-F*w*T,v[14]-F*k*T,v[15]-F*F*T],Q=z,J=p.M4,K=[.5,.5,.5,.5],b=0,N=0;if(_!=0)for(var V=0;V<10&&(K=J.multVec(Q,K),N=Math.sqrt(J.dot(K,K)),K=J.sml(1/N,K),!(Math.abs(N-b)<1e-9));V++)b=N;var U=[C*T,w*T,k*T,F*T],Z=J.dot(J.sml(255,U),K),L=U[3]<.001?0:1/U[3];return{Cov:z,q:U,e:K,L:b,eMq255:Z,eMq:J.dot(K,U),rgba:(Math.round(255*U[3])<<24|Math.round(255*U[2]*L)<<16|Math.round(255*U[1]*L)<<8|Math.round(255*U[0]*L))>>>0}},p.M4={multVec:function(u,v){return[u[0]*v[0]+u[1]*v[1]+u[2]*v[2]+u[3]*v[3],u[4]*v[0]+u[5]*v[1]+u[6]*v[2]+u[7]*v[3],u[8]*v[0]+u[9]*v[1]+u[10]*v[2]+u[11]*v[3],u[12]*v[0]+u[13]*v[1]+u[14]*v[2]+u[15]*v[3]]},dot:function(u,v){return u[0]*v[0]+u[1]*v[1]+u[2]*v[2]+u[3]*v[3]},sml:function(u,v){return[u*v[0],u*v[1],u*v[2],u*v[3]]}},p.encode.alphaMul=function(u,v){for(var m=new Uint8Array(u.length),_=u.length>>2,C=0;C<_;C++){var w=C<<2,k=u[w+3];v&&(k=k<128?0:255);var F=k*(1/255);m[w+0]=u[w+0]*F,m[w+1]=u[w+1]*F,m[w+2]=u[w+2]*F,m[w+3]=k}return m}})(c,a(788))},165:r=>{r.exports=function(n,a){var c,p,D,u,v,m,_,C,w,k,F,T,z,Q,J,K,b,N,V,U,Z,L,ee,Ee,he;c=n.state,p=n.next_in,Ee=n.input,D=p+(n.avail_in-5),u=n.next_out,he=n.output,v=u-(a-n.avail_out),m=u+(n.avail_out-257),_=c.dmax,C=c.wsize,w=c.whave,k=c.wnext,F=c.window,T=c.hold,z=c.bits,Q=c.lencode,J=c.distcode,K=(1<<c.lenbits)-1,b=(1<<c.distbits)-1;e:do{z<15&&(T+=Ee[p++]<<z,z+=8,T+=Ee[p++]<<z,z+=8),N=Q[T&K];t:for(;;){if(T>>>=V=N>>>24,z-=V,(V=N>>>16&255)==0)he[u++]=65535&N;else{if(!(16&V)){if(64&V){if(32&V){c.mode=12;break e}n.msg="invalid literal/length code",c.mode=30;break e}N=Q[(65535&N)+(T&(1<<V)-1)];continue t}for(U=65535&N,(V&=15)&&(z<V&&(T+=Ee[p++]<<z,z+=8),U+=T&(1<<V)-1,T>>>=V,z-=V),z<15&&(T+=Ee[p++]<<z,z+=8,T+=Ee[p++]<<z,z+=8),N=J[T&b];;){if(T>>>=V=N>>>24,z-=V,16&(V=N>>>16&255)){if(Z=65535&N,z<(V&=15)&&(T+=Ee[p++]<<z,(z+=8)<V&&(T+=Ee[p++]<<z,z+=8)),(Z+=T&(1<<V)-1)>_){n.msg="invalid distance too far back",c.mode=30;break e}if(T>>>=V,z-=V,Z>(V=u-v)){if((V=Z-V)>w&&c.sane){n.msg="invalid distance too far back",c.mode=30;break e}if(L=0,ee=F,k===0){if(L+=C-V,V<U){U-=V;do he[u++]=F[L++];while(--V);L=u-Z,ee=he}}else if(k<V){if(L+=C+k-V,(V-=k)<U){U-=V;do he[u++]=F[L++];while(--V);if(L=0,k<U){U-=V=k;do he[u++]=F[L++];while(--V);L=u-Z,ee=he}}}else if(L+=k-V,V<U){U-=V;do he[u++]=F[L++];while(--V);L=u-Z,ee=he}for(;U>2;)he[u++]=ee[L++],he[u++]=ee[L++],he[u++]=ee[L++],U-=3;U&&(he[u++]=ee[L++],U>1&&(he[u++]=ee[L++]))}else{L=u-Z;do he[u++]=he[L++],he[u++]=he[L++],he[u++]=he[L++],U-=3;while(U>2);U&&(he[u++]=he[L++],U>1&&(he[u++]=he[L++]))}break}if(64&V){n.msg="invalid distance code",c.mode=30;break e}N=J[(65535&N)+(T&(1<<V)-1)]}}break}}while(p<D&&u<m);p-=U=z>>3,T&=(1<<(z-=U<<3))-1,n.next_in=p,n.next_out=u,n.avail_in=p<D?D-p+5:5-(p-D),n.avail_out=u<m?m-u+257:257-(u-m),c.hold=T,c.bits=z}},185:()=>{$3Dmol.workerString=(function(){self.onmessage=function(r){var n=r.data,a=n.type;if(a<0)self.atomData=n.atoms,self.volume=n.volume,self.ps=new ProteinSurface;else{var c=self.ps;c.initparm(n.expandedExtent,a!=1,self.volume),c.fillvoxels(self.atomData,n.extendedAtoms),c.buildboundary(),a!==4&&a!==2||(c.fastdistancemap(),c.boundingatom(!1),c.fillvoxelswaals(self.atomData,n.extendedAtoms)),c.marchingcube(a);var p=c.getFacesAndVertices(n.atomsToShow);self.postMessage(p)}}}).toString().replace(/(^.*?\{|\}$)/g,""),$3Dmol.workerString+=`;
function _classCallCheck() {};`,$3Dmol.workerString+=`;
`+$3Dmol.Vector3.toString(),$3Dmol.workerString+=`;
`+$3Dmol.MarchingCubeInitializer.toString()+`;

`,$3Dmol.workerString+=`;
`+$3Dmol.PointGrid.toString()+`;
`,$3Dmol.workerString+=`;
var ProteinSurface = `+$3Dmol.ProteinSurface.toString()+`;
`,$3Dmol.SurfaceWorker=window.URL?window.URL.createObjectURL(new Blob([$3Dmol.workerString],{type:"text/javascript"})):void 0},222:(r,n,a)=>{a.r(n),a.d(n,{CC:()=>p,Color:()=>c,builtinColorSchemes:()=>w,chains:()=>C,elementColors:()=>m,htmlColors:()=>D,residues:()=>_,ssColors:()=>u});class c{constructor(F,T,z){return this.r=0,this.g=0,this.b=0,arguments.length>1&&typeof F=="number"?(this.r=F||0,this.g=T||0,this.b=z||0,this):this.set(F||0)}set(F){return F instanceof c?F.clone():(typeof F=="number"?this.setHex(F):typeof F=="object"&&(this.r=F?.r||0,this.g=F?.g||0,this.b=F?.b||0),this)}setHex(F){return F=Math.floor(F),this.r=(F>>16&255)/255,this.g=(F>>8&255)/255,this.b=(255&F)/255,this}getHex(){return Math.round(255*this.r)<<16|Math.round(255*this.g)<<8|Math.round(255*this.b)}clone(){return new c(this.r,this.g,this.b)}copy(F){return this.r=F.r,this.g=F.g,this.b=F.b,this}scaled(){var F={};return F.r=Math.round(255*this.r),F.g=Math.round(255*this.g),F.b=Math.round(255*this.b),F.a=1,F}}class p{static color(F){if(!F)return p.cache[0];if(F instanceof c)return F;if(typeof F=="number"&&p.cache[F]!==void 0)return p.cache[F];if(F&&Array.isArray(F))return F.map(p.color);let T=p.getHex(F),z=new c(T);return p.cache[T]=z,z}static getHex(F){if(Array.isArray(F))return F.map(p.getHex);if(typeof F=="string"){let T=F;if(!isNaN(parseInt(T)))return parseInt(T);if(T=T.trim(),T.length==4&&T[0]=="#"&&(T="#"+T[1]+T[1]+T[2]+T[2]+T[3]+T[3]),T.length==7&&T[0]=="#")return parseInt(T.substring(1),16);let z=p.rgbRegEx.exec(T);if(z){z[1]!=""&&console.log("WARNING: Opacity value in rgba ignored.  Specify separately as opacity attribute.");let J=0;for(let K=2;K<5;K++){J*=256;let b=z[K].endsWith("%")?255*parseFloat(z[K])/100:parseFloat(z[K]);J+=Math.round(b)}return J}let Q=D[T.toLowerCase()];return Q!==void 0?Q:(console.error("color not found",F.toLowerCase(),D),0)}return F}}p.rgbRegEx=/rgb(a?)\(\s*([^ ,\)\t]+)\s*,\s*([^ ,\)\t]+)\s*,\s*([^ ,\)\t]+)/i,p.cache={0:new c(0)};const D={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgrey:11119017,darkgreen:25600,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,grey:8421504,green:32768,greenyellow:11403055,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgrey:13882323,lightgreen:9498256,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074,b:255,g:32768,r:16711680,c:49087,m:12517567,y:12566272,k:0,w:16777215},u={pyMol:{h:16711680,s:16776960,c:65280},Jmol:{h:16711808,s:16762880,c:16777215}},v={H:16777215,He:16761035,HE:16761035,Li:11674146,LI:11674146,B:65280,C:13158600,N:9408511,O:15728640,F:14329120,Na:255,NA:255,Mg:2263842,MG:2263842,Al:8421520,AL:8421520,Si:14329120,SI:14329120,P:16753920,S:16762930,Cl:65280,CL:65280,Ca:8421520,CA:8421520,Ti:8421520,TI:8421520,Cr:8421520,CR:8421520,Mn:8421520,MN:8421520,Fe:16753920,FE:16753920,Ni:10824234,NI:10824234,Cu:10824234,CU:10824234,Zn:10824234,ZN:10824234,Br:10824234,BR:10824234,Ag:8421520,AG:8421520,I:10494192,Ba:16753920,BA:16753920,Au:14329120,AU:14329120},m={defaultColor:16716947,Jmol:{H:16777215,He:14286847,HE:14286847,Li:13402367,LI:13402367,Be:12779264,BE:12779264,B:16758197,C:9474192,N:3166456,O:16715021,F:9494608,Ne:11789301,NE:11789301,Na:11230450,NA:11230450,Mg:9109248,MG:9109248,Al:12560038,AL:12560038,Si:1578e4,SI:1578e4,P:16744448,S:16777008,Cl:2093087,CL:2093087,Ar:8442339,AR:8442339,K:9388244,Ca:4062976,CA:4062976,Sc:15132390,SC:15132390,Ti:12567239,TI:12567239,V:10921643,Cr:9083335,CR:9083335,Mn:10255047,MN:10255047,Fe:14706227,FE:14706227,Co:15765664,CO:15765664,Ni:5296208,NI:5296208,Cu:13140019,CU:13140019,Zn:8224944,ZN:8224944,Ga:12750735,GA:12750735,Ge:6721423,GE:6721423,As:12419299,AS:12419299,Se:16752896,SE:16752896,Br:10889513,BR:10889513,Kr:6076625,KR:6076625,Rb:7351984,RB:7351984,Sr:65280,SR:65280,Y:9764863,Zr:9756896,ZR:9756896,Nb:7586505,NB:7586505,Mo:5551541,MO:5551541,Tc:3907230,TC:3907230,Ru:2396047,RU:2396047,Rh:687500,RH:687500,Pd:27013,PD:27013,Ag:12632256,AG:12632256,Cd:16767375,CD:16767375,In:10909043,IN:10909043,Sn:6717568,SN:6717568,Sb:10380213,SB:10380213,Te:13924864,TE:13924864,I:9699476,Xe:4366e3,XE:4366e3,Cs:5707663,CS:5707663,Ba:51456,BA:51456,La:7394559,LA:7394559,Ce:16777159,CE:16777159,Pr:14286791,PR:14286791,Nd:13107143,ND:13107143,Pm:10747847,PM:10747847,Sm:9437127,SM:9437127,Eu:6422471,EU:6422471,Gd:4587463,GD:4587463,Tb:3211207,TB:3211207,Dy:2097095,DY:2097095,Ho:65436,HO:65436,Er:58997,ER:58997,Tm:54354,TM:54354,Yb:48952,YB:48952,Lu:43812,LU:43812,Hf:5096191,HF:5096191,Ta:5089023,TA:5089023,W:2200790,Re:2522539,RE:2522539,Os:2516630,OS:2516630,Ir:1528967,IR:1528967,Pt:13684960,PT:13684960,Au:16765219,AU:16765219,Hg:12105936,HG:12105936,Tl:10900557,TL:10900557,Pb:5724513,PB:5724513,Bi:10375093,BI:10375093,Po:11230208,PO:11230208,At:7688005,AT:7688005,Rn:4358806,RN:4358806,Fr:4325478,FR:4325478,Ra:32e3,RA:32e3,Ac:7384058,AC:7384058,Th:47871,TH:47871,Pa:41471,PA:41471,U:36863,Np:33023,NP:33023,Pu:27647,PU:27647,Am:5528818,AM:5528818,Cm:7888099,CM:7888099,Bk:9064419,BK:9064419,Cf:10565332,CF:10565332,Es:11739092,ES:11739092,Fm:11739066,FM:11739066,Md:11734438,MD:11734438,No:12389767,NO:12389767,Lr:13041766,LR:13041766,Rf:13369433,RF:13369433,Db:13697103,DB:13697103,Sg:14221381,SG:14221381,Bh:14680120,BH:14680120,Hs:15073326,HS:15073326,Mt:15400998,MT:15400998},rasmol:v,defaultColors:Object.assign({},v),greenCarbon:Object.assign(Object.assign({},v),{C:65280}),cyanCarbon:Object.assign(Object.assign({},v),{C:65535}),magentaCarbon:Object.assign(Object.assign({},v),{C:16711935}),yellowCarbon:Object.assign(Object.assign({},v),{C:16776960}),whiteCarbon:Object.assign(Object.assign({},v),{C:16777215}),orangeCarbon:Object.assign(Object.assign({},v),{C:16753920}),purpleCarbon:Object.assign(Object.assign({},v),{C:8388736}),blueCarbon:Object.assign(Object.assign({},v),{C:255})},_={amino:{ALA:13158600,ARG:1334015,ASN:56540,ASP:15075850,CYS:15132160,GLN:56540,GLU:15075850,GLY:15461355,HIS:8553170,ILE:1016335,LEU:1016335,LYS:1334015,MET:15132160,PHE:3289770,PRO:14456450,SER:16422400,THR:16422400,TRP:11819700,TYR:3289770,VAL:1016335,ASX:16738740,GLX:16738740},shapely:{ALA:9240460,ARG:124,ASN:16743536,ASP:10485826,CYS:16777072,GLN:16731212,GLU:6684672,GLY:16777215,HIS:7368959,ILE:19456,LEU:4546117,LYS:4671416,MET:12099650,PHE:5459026,PRO:5395026,SER:16740418,THR:12078080,TRP:5195264,TYR:9203788,VAL:16747775,ASX:16711935,GLX:16711935},nucleic:{A:10526975,G:16740464,I:8454143,C:16747595,T:10551200,U:16744576}},C={atom:{A:12636415,B:11599792,C:16761032,D:16777088,E:16761087,F:11596016,G:16765040,H:15761536,I:16113331,J:49151,K:13458524,L:6737322,M:10145074,N:15631086,O:52945,P:65407,Q:3978097,R:139,S:12433259,T:25600,U:8388608,V:8421376,W:8388736,X:32896,Y:12092939,Z:11674146},hetatm:{A:9478351,B:8441752,C:13602992,D:13619056,E:13603023,F:8437952,G:13607008,H:12603504,I:12955267,J:42959,K:11881548,L:5682578,M:9090346,N:12481214,O:46753,P:53103,Q:3447649,R:187,S:10854235,T:37888,U:11534336,V:11579392,W:11534512,X:45232,Y:15250963,Z:12726834}},w={ssPyMol:{prop:"ss",map:u.pyMol},ssJmol:{prop:"ss",map:u.Jmol},Jmol:{prop:"elem",map:m.Jmol},amino:{prop:"resn",map:_.amino},shapely:{prop:"resn",map:_.shapely},nucleic:{prop:"resn",map:_.nucleic},chain:{prop:"chain",map:C.atom},rasmol:{prop:"elem",map:m.rasmol},default:{prop:"elem",map:m.defaultColors},greenCarbon:{prop:"elem",map:m.greenCarbon},chainHetatm:{prop:"chain",map:C.hetatm},cyanCarbon:{prop:"elem",map:m.cyanCarbon},magentaCarbon:{prop:"elem",map:m.magentaCarbon},purpleCarbon:{prop:"elem",map:m.purpleCarbon},whiteCarbon:{prop:"elem",map:m.whiteCarbon},orangeCarbon:{prop:"elem",map:m.orangeCarbon},yellowCarbon:{prop:"elem",map:m.yellowCarbon},blueCarbon:{prop:"elem",map:m.blueCarbon}}},307:r=>{typeof r.exports=="object"&&(r.exports=window.$3Dmol)},358:(r,n,a)=>{var c=a(981),p=15,D=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],u=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],v=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],m=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(_,C,w,k,F,T,z,Q){var J,K,b,N,V,U,Z,L,ee,Ee=Q.bits,he=0,ge=0,me=0,Me=0,ue=0,I=0,ce=0,se=0,X=0,Re=0,fe=null,De=0,We=new c.Buf16(16),oe=new c.Buf16(16),Ae=null,He=0;for(he=0;he<=p;he++)We[he]=0;for(ge=0;ge<k;ge++)We[C[w+ge]]++;for(ue=Ee,Me=p;Me>=1&&We[Me]===0;Me--);if(ue>Me&&(ue=Me),Me===0)return F[T++]=20971520,F[T++]=20971520,Q.bits=1,0;for(me=1;me<Me&&We[me]===0;me++);for(ue<me&&(ue=me),se=1,he=1;he<=p;he++)if(se<<=1,(se-=We[he])<0)return-1;if(se>0&&(_===0||Me!==1))return-1;for(oe[1]=0,he=1;he<p;he++)oe[he+1]=oe[he]+We[he];for(ge=0;ge<k;ge++)C[w+ge]!==0&&(z[oe[C[w+ge]]++]=ge);if(_===0?(fe=Ae=z,U=19):_===1?(fe=D,De-=257,Ae=u,He-=257,U=256):(fe=v,Ae=m,U=-1),Re=0,ge=0,he=me,V=T,I=ue,ce=0,b=-1,N=(X=1<<ue)-1,_===1&&X>852||_===2&&X>592)return 1;for(;;){Z=he-ce,z[ge]<U?(L=0,ee=z[ge]):z[ge]>U?(L=Ae[He+z[ge]],ee=fe[De+z[ge]]):(L=96,ee=0),J=1<<he-ce,me=K=1<<I;do F[V+(Re>>ce)+(K-=J)]=Z<<24|L<<16|ee;while(K!==0);for(J=1<<he-1;Re&J;)J>>=1;if(J!==0?(Re&=J-1,Re+=J):Re=0,ge++,--We[he]===0){if(he===Me)break;he=C[w+z[ge]]}if(he>ue&&(Re&N)!==b){for(ce===0&&(ce=ue),V+=me,se=1<<(I=he-ce);I+ce<Me&&!((se-=We[I+ce])<=0);)I++,se<<=1;if(X+=1<<I,_===1&&X>852||_===2&&X>592)return 1;F[b=Re&N]=ue<<24|I<<16|V-T}}return Re!==0&&(F[V+Re]=he-ce<<24|4194304),Q.bits=ue,0}},378:(r,n,a)=>{var c;a.r(n),a.d(n,{BackSide:()=>D,Camera:()=>Wi,ClampToEdgeWrapping:()=>C,Coloring:()=>c,Cylinder:()=>X.Cylinder,DoubleSide:()=>u,EventDispatcher:()=>N,FloatType:()=>z,Fog:()=>tn,FrontSide:()=>p,Geometry:()=>he,GeometryGroup:()=>Ee,GeometryIDCount:()=>ge,ImposterMaterial:()=>kr,InstancedMaterial:()=>Ar,Light:()=>I,Line:()=>Se,LineBasicMaterial:()=>L,LineStyle:()=>pe,LinearFilter:()=>w,LinearMipMapLinearFilter:()=>F,Material:()=>U,MaterialIdCount:()=>Z,Matrix3:()=>m.Matrix3,Matrix4:()=>m.Matrix4,Mesh:()=>Oe,MeshDoubleLambertMaterial:()=>vr,MeshLambertMaterial:()=>pr,MeshOutlineMaterial:()=>xr,NearestFilter:()=>k,Object3D:()=>Me,Object3DIDCount:()=>me,Projector:()=>se,Quaternion:()=>m.Quaternion,R32Format:()=>K,RFormat:()=>J,RGBAFormat:()=>Q,Ray:()=>m.Ray,Raycaster:()=>De,Renderer:()=>qi,Scene:()=>ue,ShaderLib:()=>Yr,ShaderUtils:()=>yi,Shading:()=>v,Sphere:()=>X.Sphere,SphereImposterMaterial:()=>fi,SphereImposterOutlineMaterial:()=>Rr,Sprite:()=>dt,SpriteAlignment:()=>_,SpriteMaterial:()=>Ir,SpritePlugin:()=>on,StickImposterMaterial:()=>Di,StickImposterOutlineMaterial:()=>wi,Texture:()=>or,TextureIdCount:()=>ar,TextureOperations:()=>b,Triangle:()=>X.Triangle,UVMapping:()=>Et,UnsignedByteType:()=>T,Vector2:()=>m.Vector2,Vector3:()=>m.Vector3,VolumetricMaterial:()=>Hi,basic:()=>zt,clamp:()=>m.clamp,clone:()=>Vi,conversionMatrix3:()=>m.conversionMatrix3,degToRad:()=>m.degToRad,instanced:()=>Ot,intersectObject:()=>Ft,lambert:()=>It,lambertdouble:()=>li,outline:()=>ui,screen:()=>gi,screenaa:()=>jr,sphereimposter:()=>Dr,sphereimposteroutline:()=>vi,sprite:()=>bi,stickimposter:()=>Ni,stickimposteroutline:()=>Ti,volumetric:()=>Br}),(function(Bt){Bt[Bt.NoColors=0]="NoColors",Bt[Bt.FaceColors=1]="FaceColors",Bt[Bt.VertexColors=2]="VertexColors"})(c||(c={}));const p=0,D=1,u=2;var v;(function(Bt){Bt[Bt.NoShading=0]="NoShading",Bt[Bt.FlatShading=1]="FlatShading",Bt[Bt.SmoothShading=2]="SmoothShading"})(v||(v={}));var m=a(529);const _={topLeft:new m.Vector2(1,-1),topCenter:new m.Vector2(0,-1),topRight:new m.Vector2(-1,-1),centerLeft:new m.Vector2(1,0),center:new m.Vector2(0,0),centerRight:new m.Vector2(-1,0),bottomLeft:new m.Vector2(1,1),bottomCenter:new m.Vector2(0,1),bottomRight:new m.Vector2(-1,1)},C=1001,w=1006,k=1007,F=1008,T=1009,z=1010,Q=1021,J=1022,K=1023;var b;(function(Bt){Bt[Bt.MultiplyOperation=0]="MultiplyOperation",Bt[Bt.MixOperation=1]="MixOperation",Bt[Bt.AddOperation=2]="AddOperation"})(b||(b={}));class N{constructor(){this.listeners={}}dispatchEvent(x){var ne=this.listeners[x.type];if(ne!==void 0){x.target=this;for(var xe=0,Ve=ne.length;xe<Ve;xe++)ne[xe].call(this,x)}}removeEventListener(x,ne){if(ne){var xe=this.listeners[x].indexOf(ne);xe!==-1&&this.listeners[x].splice(xe,1)}else this.listeners[x]=[]}addEventListener(x,ne){this.listeners[x]===void 0&&(this.listeners[x]=[]),this.listeners[x].indexOf(ne)===-1&&this.listeners[x].push(ne)}}var V=a(222);class U extends N{constructor(){super(...arguments),this.id=Z++,this.name="",this.side=p,this.opacity=1,this.transparent=!1,this.depthTest=!0,this.depthWrite=!0,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.alphaTest=0,this.visible=!0,this.needsUpdate=!0,this.outline=!1,this.wireframe=!1,this.shaded=!1}setValues(x={}){if(x!==void 0)for(var ne in x){var xe=x[ne];if(xe!==void 0){if(ne in this){var Ve=this[ne];Ve instanceof V.Color&&xe instanceof V.Color?Ve.copy(xe):Ve instanceof V.Color?Ve.set(xe):Ve instanceof m.Vector3&&xe instanceof m.Vector3?Ve.copy(xe):this[ne]=xe}}else console.warn("$3Dmol.Material: '"+ne+"' parameter is undefined.")}}clone(x=new U){return x.name=this.name,x.side=this.side,x.opacity=this.opacity,x.transparent=this.transparent,x.depthTest=this.depthTest,x.depthWrite=this.depthWrite,x.polygonOffset=this.polygonOffset,x.polygonOffsetFactor=this.polygonOffsetFactor,x.polygonOffsetUnits=this.polygonOffsetUnits,x.alphaTest=this.alphaTest,x.overdraw=this.overdraw,x.visible=this.visible,x}makeShaded(x){this.shaded=!0,this.uniforms&&(this.uniforms.shading={type:"i",value:x},this.uniforms.vWidth={type:"f",value:1},this.uniforms.vHeight={type:"f",value:1})}dispose(){this.dispatchEvent({type:"dispose"})}}let Z=0;class L extends U{constructor(x){super(),this.color=new V.Color(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.vertexColors=!1,this.fog=!0,this.shaderID="basic",this.setValues(x)}clone(x=new L){return super.clone.call(this,x),x.color.copy(this.color),x}}const ee=65535;class Ee{constructor(x=0){this.vertexArray=null,this.colorArray=null,this.normalArray=null,this.radiusArray=null,this.faceArray=null,this.lineArray=null,this.atomArray=Array(),this.vertices=0,this.faceidx=0,this.lineidx=0,this.__inittedArrays=!1,this.id=x}setColor(x){var ne=this.vertexArray,xe=this.colorArray;if(!ne)throw new Error("vertex array not initialized");if(!xe)throw new Error("color array not initialized");let Ve=V.CC.color(x);for(var Le=0;Le<ne.length;Le+=3)xe[Le]=Ve.r,xe[Le+1]=Ve.g,xe[Le+2]=Ve.b}setColors(x){var ne=this.vertexArray,xe=this.colorArray;if(!ne)throw new Error("vertex array not initialized");if(!xe)throw new Error("color array not initialized");if(ne.length==xe.length)for(var Ve=0;Ve<ne.length;Ve+=3){var Le=x(ne[Ve],ne[Ve+1],ne[Ve+2]);Le instanceof V.Color||(Le=V.CC.color(Le)),xe[Ve]=Le.r,xe[Ve+1]=Le.g,xe[Ve+2]=Le.b}else console.log("Cannot re-color geometry group due to mismatched lengths.")}getNumVertices(){return this.vertices}getVertices(){return this.vertexArray}getCentroid(){if(!this.vertexArray)throw new Error("vertex array not initialized");for(var x,ne,xe,Ve,Le=new m.Vector3,yt=0;yt<this.vertices;++yt)x=3*yt,ne=this.vertexArray[x],xe=this.vertexArray[x+1],Ve=this.vertexArray[x+2],Le.x+=ne,Le.y+=xe,Le.z+=Ve;return Le.divideScalar(this.vertices),Le}setNormals(){var x=this.faceArray,ne=this.vertexArray,xe=this.normalArray;if(this.vertices&&this.faceidx){if(!x)throw new Error("face array not initialized");if(!ne)throw new Error("vertex array not initialized");if(!xe)throw new Error("normal array not initialized");for(var Ve,Le,yt,lt,mt,Mt,Pt,Lt=0;Lt<x.length/3;++Lt)Ve=3*x[3*Lt],Le=3*x[3*Lt+1],yt=3*x[3*Lt+2],lt=new m.Vector3(ne[Ve],ne[Ve+1],ne[Ve+2]),mt=new m.Vector3(ne[Le],ne[Le+1],ne[Le+2]),Mt=new m.Vector3(ne[yt],ne[yt+1],ne[yt+2]),lt.subVectors(lt,mt),Mt.subVectors(Mt,mt),Mt.cross(lt),(Pt=Mt).normalize(),xe[Ve]+=Pt.x,xe[Le]+=Pt.x,xe[yt]+=Pt.x,xe[Ve+1]+=Pt.y,xe[Le+1]+=Pt.y,xe[yt+1]+=Pt.y,xe[Ve+2]+=Pt.z,xe[Le+2]+=Pt.z,xe[yt+2]+=Pt.z}}setLineIndices(){if(this.faceidx&&(!this.lineArray||this.lineArray.length!=2*this.faceidx||this.lineidx!=2*this.faceidx)){var x=this.faceArray,ne=this.lineArray=new Uint16Array(2*this.faceidx);if(this.lineidx=2*this.faceidx,!x)throw new Error("face array not initialized");for(var xe=0;xe<this.faceidx/3;++xe){var Ve=3*xe,Le=2*Ve,yt=x[Ve],lt=x[Ve+1],mt=x[Ve+2];ne[Le]=yt,ne[Le+1]=lt,ne[Le+2]=yt,ne[Le+3]=mt,ne[Le+4]=lt,ne[Le+5]=mt}}}vrml(x,ne){var xe,Ve,Le,yt,lt,mt,Mt,Pt,Lt,gr,Yt,Er,Cr,Ur,_r,Lr,wr,Mi,Qt="";if(Qt+=x+`Shape {
`+x+` appearance Appearance {
`+x+`  material Material {
`+x+"   diffuseColor "+((xe=ne?.color)===null||xe===void 0?void 0:xe.r)+" "+((Ve=ne?.color)===null||Ve===void 0?void 0:Ve.g)+" "+((Le=ne?.color)===null||Le===void 0?void 0:Le.b)+`
`,ne.wireframe&&this.colorArray){let ae=this.colorArray;Qt+=x+"    emissiveColor "+ae[0]+" "+ae[1]+" "+ae[2]+`
`}ne?.transparent&&(Qt+=x+"   transparency "+(1-ne.opacity)+`
`),Qt+=x+`  }
`,Qt+=x+` }
`;var ri=x;if(x+=" ",ne instanceof L||ne.wireframe){let ae,i,s;Qt+=x+`geometry IndexedLineSet {
`+x+` colorPerVertex TRUE
`+x+` coord Coordinate {
`+x+`  point [
`;for(let l=0;l<this.vertices;++l){let h=3*l;ae=(yt=this.vertexArray)===null||yt===void 0?void 0:yt[h],i=(lt=this.vertexArray)===null||lt===void 0?void 0:lt[h+1],s=(mt=this.vertexArray)===null||mt===void 0?void 0:mt[h+2],Qt+=x+"   "+ae+" "+i+" "+s+`,
`}if(Qt+=x+`  ]
`,Qt+=x+` }
`,this.colorArray&&!ne.wireframe){Qt+=x+` color Color {
`+x+`  color [
`;for(let l=0;l<this.vertices;++l){let h=3*l;ae=this.colorArray[h],i=this.colorArray[h+1],s=this.colorArray[h+2],Qt+=x+"   "+ae+" "+i+" "+s+`,
`}Qt+=x+`  ]
`,Qt+=x+` }
`}if(Qt+=x+` coordIndex [
`,ne.wireframe&&this.faceArray)for(let l=0;l<this.faceidx;l+=3)ae=(Mt=this.faceArray)===null||Mt===void 0?void 0:Mt[l],i=(Pt=this.faceArray)===null||Pt===void 0?void 0:Pt[l+1],s=(Lt=this.faceArray)===null||Lt===void 0?void 0:Lt[l+2],Qt+=x+"  "+ae+", "+i+", "+s+`, -1,
`;else for(let l=0;l<this.vertices-1;l+=2)Qt+=x+"  "+l+", "+(l+1)+`, -1,
`;Qt+=x+` ]
`,Qt+=x+`}
`}else{let ae,i,s;Qt+=x+`geometry IndexedFaceSet {
`+x+` colorPerVertex TRUE
`+x+` normalPerVertex TRUE
`+x+` solid FALSE
`,Qt+=x+` coord Coordinate {
`+x+`  point [
`;for(let l=0;l<this.vertices;++l){let h=3*l;ae=(gr=this.vertexArray)===null||gr===void 0?void 0:gr[h],i=(Yt=this.vertexArray)===null||Yt===void 0?void 0:Yt[h+1],s=(Er=this.vertexArray)===null||Er===void 0?void 0:Er[h+2],Qt+=x+"   "+ae+" "+i+" "+s+`,
`}Qt+=x+`  ]
`,Qt+=x+` }
`,Qt+=x+` normal Normal {
`+x+`  vector [
`;for(let l=0;l<this.vertices;++l){let h=3*l;ae=(Cr=this.normalArray)===null||Cr===void 0?void 0:Cr[h],i=(Ur=this.normalArray)===null||Ur===void 0?void 0:Ur[h+1],s=(_r=this.normalArray)===null||_r===void 0?void 0:_r[h+2],Qt+=x+"   "+ae+" "+i+" "+s+`,
`}if(Qt+=x+`  ]
`,Qt+=x+` }
`,this.colorArray){Qt+=x+` color Color {
`+x+`  color [
`;for(let l=0;l<this.vertices;++l){let h=3*l;ae=this.colorArray[h],i=this.colorArray[h+1],s=this.colorArray[h+2],Qt+=x+"   "+ae+" "+i+" "+s+`,
`}Qt+=x+`  ]
`,Qt+=x+` }
`}Qt+=x+` coordIndex [
`;for(let l=0;l<this.faceidx;l+=3)ae=(Lr=this.faceArray)===null||Lr===void 0?void 0:Lr[l],i=(wr=this.faceArray)===null||wr===void 0?void 0:wr[l+1],s=(Mi=this.faceArray)===null||Mi===void 0?void 0:Mi[l+2],Qt+=x+"  "+ae+", "+i+", "+s+`, -1,
`;Qt+=x+` ]
`,Qt+=x+`}
`}return Qt+=ri+"}"}truncateArrayBuffers(x=!0,ne=!1){var xe=this.vertexArray,Ve=this.colorArray,Le=this.normalArray,yt=this.faceArray,lt=this.lineArray,mt=this.radiusArray;this.vertexArray=xe?.subarray(0,3*this.vertices)||null,this.colorArray=Ve?.subarray(0,3*this.vertices)||null,x?(this.normalArray=Le?.subarray(0,3*this.vertices)||null,this.faceArray=yt?.subarray(0,this.faceidx)||null,this.lineidx>0?this.lineArray=lt?.subarray(0,this.lineidx)||null:this.lineArray=new Uint16Array(0)):(this.normalArray=new Float32Array(0),this.faceArray=new Uint16Array(0),this.lineArray=new Uint16Array(0)),mt&&(this.radiusArray=mt.subarray(0,this.vertices)),ne&&(this.normalArray&&(this.normalArray=new Float32Array(this.normalArray)),this.faceArray&&(this.faceArray=new Uint16Array(this.faceArray)),this.lineArray&&(this.lineArray=new Uint16Array(this.lineArray)),this.vertexArray&&(this.vertexArray=new Float32Array(this.vertexArray)),this.colorArray&&(this.colorArray=new Float32Array(this.colorArray)),this.radiusArray&&(this.radiusArray=new Float32Array(this.radiusArray))),this.__inittedArrays=!0}}class he extends N{constructor(x=!1,ne=!1,xe=!1){super(),this.name="",this.hasTangents=!1,this.dynamic=!0,this.verticesNeedUpdate=!1,this.elementsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.buffersNeedUpdate=!1,this.imposter=!1,this.instanced=!1,this.geometryGroups=[],this.groups=0,this.id=ge++,this.mesh=x,this.radii=ne,this.offset=xe}updateGeoGroup(x=0){var ne,xe=this.groups>0?this.geometryGroups[this.groups-1]:null;return(!xe||xe.vertices+x>(((ne=xe?.vertexArray)===null||ne===void 0?void 0:ne.length)||0)/3)&&(xe=this.addGeoGroup()),xe}vrml(x,ne){for(var xe="",Ve=this.geometryGroups.length,Le=0;Le<Ve;Le++)xe+=this.geometryGroups[Le].vrml(x,ne)+`,
`;return xe}addGeoGroup(){var x=new Ee(this.geometryGroups.length);return this.geometryGroups.push(x),this.groups=this.geometryGroups.length,x.vertexArray=new Float32Array(196605),x.colorArray=new Float32Array(196605),this.mesh&&(x.normalArray=new Float32Array(196605),x.faceArray=new Uint16Array(393210),x.lineArray=new Uint16Array(393210)),this.radii&&(x.radiusArray=new Float32Array(ee)),x.useOffset=this.offset,x}setUpNormals(...x){for(var ne=0;ne<this.groups;ne++)this.geometryGroups[ne].setNormals(...x)}setColors(...x){for(var ne=this.geometryGroups.length,xe=0;xe<ne;xe++)this.geometryGroups[xe].setColors(...x)}setColor(...x){let ne=this.geometryGroups.length;for(var xe=0;xe<ne;xe++)this.geometryGroups[xe].setColor(...x)}setUpWireframe(...x){let ne=this.geometryGroups.length;for(var xe=0;xe<ne;xe++)this.geometryGroups[xe].setLineIndices(...x)}initTypedArrays(){for(var x=0;x<this.groups;x++){var ne=this.geometryGroups[x];ne.__inittedArrays!==!0&&ne.truncateArrayBuffers(this.mesh,!1)}}dispose(){this.dispatchEvent({type:"dispose"})}get vertices(){for(var x=0,ne=0;ne<this.groups;ne++)x+=this.geometryGroups[ne].vertices;return x}}let ge=0,me=0;class Me{constructor(){this.id=me++,this.name="",this.children=[],this.position=new m.Vector3,this.rotation=new m.Vector3,this.matrix=new m.Matrix4,this.matrixWorld=new m.Matrix4,this.quaternion=new m.Quaternion,this.eulerOrder="XYZ",this.up=new m.Vector3(0,1,0),this.scale=new m.Vector3(1,1,1),this.matrixAutoUpdate=!0,this.matrixWorldNeedsUpdate=!0,this.rotationAutoUpdate=!0,this.useQuaternion=!1,this.visible=!0}lookAt(x){this.matrix.lookAt(x,this.position,this.up),this.rotationAutoUpdate&&(this.useQuaternion===!0?console.error("Unimplemented math operation."):this.rotation instanceof m.Vector3&&this.rotation.setEulerFromRotationMatrix(this.matrix,this.eulerOrder))}add(x){if(x!==this){x.parent=this,this.children.push(x);for(var ne=this;ne.parent!==void 0;)ne=ne.parent;ne!==void 0&&ne instanceof ue&&ne.__addObject(x)}else console.error("Can't add $3Dmol.Object3D to itself")}remove(x){var ne=this.children.indexOf(x);if(ne!==-1){x.parent=void 0,this.children.splice(ne,1);for(var xe=this;xe.parent!==void 0;)xe=xe.parent;xe!==void 0&&xe instanceof ue&&xe.__removeObject(x)}}vrml(x){x||(x=" ");var ne=2*Math.atan2(this.quaternion.lengthxyz(),this.quaternion.w),xe=0,Ve=0,Le=0;if(ne!=0){let mt=Math.sin(ne/2);xe=this.quaternion.x/mt,Ve=this.quaternion.y/mt,Le=this.quaternion.z/mt}var yt=x+`Transform {
`+x+" center "+this.position.x+" "+this.position.y+" "+this.position.z+`
`+x+" rotation "+xe+" "+Ve+" "+Le+" "+ne+`
`+x+` children [
`;this.geometry&&(yt+=this.geometry.vrml(x,this.material));for(var lt=0;lt<this.children.length;lt++)yt+=this.children[lt].vrml(x+" ")+`,
`;return yt+=` ]
`,yt+="}"}updateMatrix(){this.matrix.setPosition(this.position),this.useQuaternion===!1&&this.rotation instanceof m.Vector3?this.matrix.setRotationFromEuler(this.rotation,this.eulerOrder):this.matrix.setRotationFromQuaternion(this.quaternion),this.scale.x===1&&this.scale.y===1&&this.scale.z===1||this.matrix.scale(this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(x){this.matrixAutoUpdate===!0&&this.updateMatrix(),this.matrixWorldNeedsUpdate!==!0&&x!==!0||(this.parent===void 0?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1;for(var ne=0;ne<this.children.length;ne++)this.children[ne].updateMatrixWorld(!0)}clone(x){x===void 0&&(x=new Me),x.name=this.name,x.up.copy(this.up),x.position.copy(this.position),x.rotation instanceof m.Vector3&&this.rotation instanceof m.Vector3?x.rotation.copy(this.rotation):x.rotation=this.rotation,x.eulerOrder=this.eulerOrder,x.scale.copy(this.scale),x.rotationAutoUpdate=this.rotationAutoUpdate,x.matrix.copy(this.matrix),x.matrixWorld.copy(this.matrixWorld),x.quaternion.copy(this.quaternion),x.matrixAutoUpdate=this.matrixAutoUpdate,x.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate,x.useQuaternion=this.useQuaternion,x.visible=this.visible;for(var ne=0;ne<this.children.length;ne++){var xe=this.children[ne];x.add(xe.clone())}return x}setVisible(x){this.visible=x;for(var ne=0;ne<this.children.length;ne++)this.children[ne].setVisible(x)}}class ue extends Me{constructor(){super(...arguments),this.fog=null,this.overrideMaterial=null,this.matrixAutoUpdate=!1,this.__objects=[],this.__lights=[],this.__objectsAdded=[],this.__objectsRemoved=[]}__addObject(x){if(x instanceof I)this.__lights.indexOf(x)===-1&&this.__lights.push(x),x.target&&x.target.parent===void 0&&this.add(x.target);else if(this.__objects.indexOf(x)===-1){this.__objects.push(x),this.__objectsAdded.push(x);var ne=this.__objectsRemoved.indexOf(x);ne!==-1&&this.__objectsRemoved.splice(ne,1)}for(var xe=0;xe<x.children.length;xe++)this.__addObject(x.children[xe])}__removeObject(x){var ne;x instanceof I?(ne=this.__lights.indexOf(x))!==-1&&this.__lights.splice(ne,1):(ne=this.__objects.indexOf(x))!==-1&&(this.__objects.splice(ne,1),this.__objectsRemoved.push(x),this.__objectsAdded.indexOf(x)!==-1&&this.__objectsAdded.splice(ne,1));for(var xe=0;xe<x.children.length;xe++)this.__removeObject(x.children[xe])}}class I extends Me{constructor(x,ne=1){super(),this.position=new m.Vector3(0,1,0),this.target=new Me,this.castShadow=!1,this.onlyShadow=!1,this.color=new V.Color(x),this.intensity=ne}}const ce=new m.Matrix4;class se{static unprojectVector(x,ne){return ne.projectionMatrixInverse.getInverse(ne.projectionMatrix),ce.multiplyMatrices(ne.matrixWorld,ne.projectionMatrixInverse),x.applyProjection(ce)}static projectVector(x,ne){return ne.matrixWorldInverse.getInverse(ne.matrixWorld),ce.multiplyMatrices(ne.projectionMatrix,ne.matrixWorldInverse),x.applyProjection(ce)}projectVector(x,ne){return se.projectVector(x,ne)}unprojectVector(x,ne){return se.unprojectVector(x,ne)}}var X=a(99);const Re=(Bt,x)=>Bt.distance-x.distance,fe=new m.Matrix4;class De{constructor(x,ne,xe,Ve){this.precision=1e-4,this.linePrecision=.2,this.ray=new m.Ray(x,ne),this.ray.direction.lengthSq()>0&&this.ray.direction.normalize(),this.near=Ve||0,this.far=xe||1/0}set(x,ne){this.ray.set(x,ne)}setFromCamera(x,ne){ne.ortho?(this.ray.origin.set(x.x,x.y,(ne.near+ne.far)/(ne.near-ne.far)).unproject(ne),this.ray.direction.set(0,0,-1).transformDirection(ne.matrixWorld)):(this.ray.origin.setFromMatrixPosition(ne.matrixWorld),this.ray.direction.set(x.x,x.y,x.z),ne.projectionMatrixInverse.getInverse(ne.projectionMatrix),fe.multiplyMatrices(ne.matrixWorld,ne.projectionMatrixInverse),this.ray.direction.applyProjection(fe),this.ray.direction.sub(this.ray.origin).normalize())}intersectObjects(x,ne){for(var xe=[],Ve=0,Le=ne.length;Ve<Le;Ve++)Ft(x,ne[Ve],this,xe);return xe.sort(Re),xe}}const We=Bt=>Math.min(Math.max(Bt,-1),1);var oe=new X.Sphere,Ae=new X.Cylinder,He=new X.Triangle,Ue=new m.Vector3,Ie=new m.Vector3,rt=new m.Vector3,st=new m.Vector3,at=new m.Vector3;function Ft(Bt,x,ne,xe){if(at.getPositionFromMatrix(Bt.matrixWorld),x.intersectionShape===void 0||x.hidden)return xe;var Ve,Le,yt,lt,mt,Mt,Pt,Lt,gr,Yt,Er,Cr,Ur,_r,Lr=x.intersectionShape,wr=ne.linePrecision,Mi=(wr*=Bt.matrixWorld.getMaxScaleOnAxis())*wr;if(x.boundingSphere!==void 0&&x.boundingSphere instanceof X.Sphere&&(oe.copy(x.boundingSphere),oe.applyMatrix4(Bt.matrixWorld),!ne.ray.isIntersectionSphere(oe)))return xe;for(Ve=0,Le=Lr.triangle.length;Ve<Le;Ve++)if(Lr.triangle[Ve]instanceof X.Triangle){if(He.copy(Lr.triangle[Ve]),He.applyMatrix4(Bt.matrixWorld),yt=He.getNormal(),(lt=ne.ray.direction.dot(yt))>=0||(Ue.subVectors(He.a,ne.ray.origin),(Pt=yt.dot(Ue)/lt)<0))continue;Ie.copy(ne.ray.direction).multiplyScalar(Pt).add(ne.ray.origin),Ie.sub(He.a),rt.copy(He.b).sub(He.a),st.copy(He.c).sub(He.a);var Qt=rt.dot(st),ri=rt.lengthSq(),ae=st.lengthSq();if((Cr=(ri*Ie.dot(st)-Qt*Ie.dot(rt))/(ri*ae-Qt*Qt))<0||Cr>1||(Er=(Ie.dot(rt)-Cr*Qt)/ri)<0||Er>1||Er+Cr>1)continue;xe.push({clickable:x,distance:Pt})}for(Ve=0,Le=Lr.cylinder.length;Ve<Le;Ve++)if(Lr.cylinder[Ve]instanceof X.Cylinder){if(Ae.copy(Lr.cylinder[Ve]),Ae.applyMatrix4(Bt.matrixWorld),Ue.subVectors(Ae.c1,ne.ray.origin),mt=Ue.dot(Ae.direction),Mt=Ue.dot(ne.ray.direction),(gr=1-(lt=We(ne.ray.direction.dot(Ae.direction)))*lt)==0)continue;Ur=(lt*Mt-mt)/gr,_r=(Mt-lt*mt)/gr,Ie.copy(Ae.direction).multiplyScalar(Ur).add(Ae.c1),rt.copy(ne.ray.direction).multiplyScalar(_r).add(ne.ray.origin),Lt=st.subVectors(Ie,rt).lengthSq();var i=Ae.radius*Ae.radius;if(Lt<=i){if((Er=lt*(Cr=Pt=(Yt=(lt*mt-Mt)*(lt*mt-Mt)-gr*(Ue.lengthSq()-mt*mt-i))<=0?Math.sqrt(Lt):(Mt-lt*mt-Math.sqrt(Yt))/gr)-mt)<0||Er*Er>Ae.lengthSq()||Cr<0)continue;xe.push({clickable:x,distance:Pt})}}for(Ve=0,Le=Lr.line.length;Ve<Le;Ve+=2){Ie.copy(Lr.line[Ve]),Ie.applyMatrix4(Bt.matrixWorld),rt.copy(Lr.line[Ve+1]),rt.applyMatrix4(Bt.matrixWorld),st.subVectors(rt,Ie);var s=st.lengthSq();st.normalize(),Ue.subVectors(Ie,ne.ray.origin);var l=Ue.dot(st);Mt=Ue.dot(ne.ray.direction),(gr=1-(lt=We(ne.ray.direction.dot(st)))*lt)!=0&&(Ur=(lt*Mt-l)/gr,_r=(Mt-lt*l)/gr,Ie.add(st.multiplyScalar(Ur)),rt.copy(ne.ray.direction).multiplyScalar(_r).add(ne.ray.origin),(Lt=st.subVectors(rt,Ie).lengthSq())<Mi&&Ur*Ur<s&&xe.push({clickable:x,distance:_r}))}for(Ve=0,Le=Lr.sphere.length;Ve<Le;Ve++)if(Lr.sphere[Ve]instanceof X.Sphere&&(oe.copy(Lr.sphere[Ve]),oe.applyMatrix4(Bt.matrixWorld),ne.ray.isIntersectionSphere(oe))){Ie.subVectors(oe.center,ne.ray.origin);var h=Ie.dot(ne.ray.direction);if(Yt=h*h-(Ie.lengthSq()-oe.radius*oe.radius),h<0)return xe;Pt=Yt<=0?h:h-Math.sqrt(Yt),xe.push({clickable:x,distance:Pt})}return xe}class Et{}class or extends N{constructor(x,ne){super(),this.id=ar++,this.name="",this.image=x,this.mapping=new Et,this.wrapS=C,this.wrapT=C,this.anisotropy=1,ne?(this.format=J,this.type=z,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.magFilter=k,this.minFilter=k):(this.format=Q,this.type=T,this.offset=new m.Vector2(0,0),this.repeat=new m.Vector2(1,1),this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.magFilter=w,this.minFilter=F),this.needsUpdate=!1,this.onUpdate=null}clone(x=new or){return x.image=this.image,x.mapping=this.mapping,x.wrapS=this.wrapS,x.wrapT=this.wrapT,x.magFilter=this.magFilter,x.minFilter=this.minFilter,x.anisotropy=this.anisotropy,x.format=this.format,x.type=this.type,x.offset.copy(this.offset),x.repeat.copy(this.repeat),x.premultiplyAlpha=this.premultiplyAlpha,x.flipY=this.flipY,x.unpackAlignment=this.unpackAlignment,x}dispose(){this.dispatchEvent({type:"dispose"})}}let ar=0;class kr extends U{constructor(x){super(),this.color=new V.Color(16777215),this.ambient=new V.Color(1048575),this.emissive=new V.Color(0),this.imposter=!0,this.wrapAround=!1,this.wrapRGB=new m.Vector3(1,1,1),this.map=void 0,this.lightMap=null,this.specularMap=null,this.envMap=null,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.shading=v.SmoothShading,this.shaderID=null,this.vertexColors=c.NoColors,this.skinning=!1,this.setValues(x)}clone(x=new kr){return super.clone.call(this,x),x.color.copy(this.color),x.ambient.copy(this.ambient),x.emissive.copy(this.emissive),x.wrapAround=this.wrapAround,x.wrapRGB.copy(this.wrapRGB),x.map=this.map,x.lightMap=this.lightMap,x.specularMap=this.specularMap,x.envMap=this.envMap,x.combine=this.combine,x.reflectivity=this.reflectivity,x.refractionRatio=this.refractionRatio,x.fog=this.fog,x.shading=this.shading,x.shaderID=this.shaderID,x.vertexColors=this.vertexColors,x.skinning=this.skinning,x.morphTargets=this.morphTargets,x.morphNormals=this.morphNormals,x}}class Ar extends U{constructor(x){super(),this.color=new V.Color(16777215),this.ambient=new V.Color(1048575),this.emissive=new V.Color(0),this.wrapAround=!1,this.wrapRGB=new m.Vector3(1,1,1),this.map=void 0,this.lightMap=null,this.specularMap=null,this.envMap=null,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.shading=v.SmoothShading,this.shaderID="instanced",this.vertexColors=c.NoColors,this.skinning=!1,this.sphere=null,this.setValues(x)}clone(x=new Ar){return super.clone.call(this,x),x.color.copy(this.color),x.ambient.copy(this.ambient),x.emissive.copy(this.emissive),x.wrapAround=this.wrapAround,x.wrapRGB.copy(this.wrapRGB),x.map=this.map,x.lightMap=this.lightMap,x.specularMap=this.specularMap,x.envMap=this.envMap,x.combine=this.combine,x.reflectivity=this.reflectivity,x.refractionRatio=this.refractionRatio,x.fog=this.fog,x.shading=this.shading,x.shaderID=this.shaderID,x.vertexColors=this.vertexColors,x.skinning=this.skinning,x.morphTargets=this.morphTargets,x.morphNormals=this.morphNormals,x.sphere=this.sphere,x}}class pr extends U{constructor(x){super(),this.color=new V.Color(16777215),this.ambient=new V.Color(1048575),this.emissive=new V.Color(0),this.wrapAround=!1,this.wrapRGB=new m.Vector3(1,1,1),this.map=void 0,this.lightMap=null,this.specularMap=null,this.envMap=null,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.shading=v.SmoothShading,this.shaderID="lambert",this.vertexColors=c.NoColors,this.skinning=!1,this.setValues(x)}clone(x=new pr){return super.clone.call(this,x),x.color.copy(this.color),x.ambient.copy(this.ambient),x.emissive.copy(this.emissive),x.wrapAround=this.wrapAround,x.wrapRGB.copy(this.wrapRGB),x.map=this.map,x.lightMap=this.lightMap,x.specularMap=this.specularMap,x.envMap=this.envMap,x.combine=this.combine,x.reflectivity=this.reflectivity,x.refractionRatio=this.refractionRatio,x.fog=this.fog,x.shading=this.shading,x.shaderID=this.shaderID,x.vertexColors=this.vertexColors,x.skinning=this.skinning,x.morphTargets=this.morphTargets,x.morphNormals=this.morphNormals,x}}class vr extends pr{constructor(x){super(x),this.shaderID="lambertdouble",this.side=u,this.outline=!1}clone(x=new vr){return super.clone.call(this,x),x}}class xr extends U{constructor(x){super(),x=x||{},this.fog=!0,this.shaderID="outline",this.wireframe=!1,this.outlineColor=V.CC.color(x.color||new V.Color(0,0,0)),this.outlineWidth=x.width||.1,this.outlinePushback=x.pushback||1,this.outlineMaxPixels=x.maxpixels||0}clone(x=new xr){return super.clone.call(this,x),x.fog=this.fog,x.shaderID=this.shaderID,x.wireframe=this.wireframe,x.outlineColor=this.outlineColor,x.outlineWidth=this.outlineWidth,x.outlinePushback=this.outlinePushback,x.outlineMaxPixels=this.outlineMaxPixels,x}}class fi extends kr{constructor(x){super(x),this.shaderID="sphereimposter",this.setValues(x)}clone(x=new fi){return super.clone.call(this,x),x}}class Rr extends kr{constructor(x){super(x),x=x||{},this.shaderID="sphereimposteroutline",this.outlineColor=V.CC.color(x.color||new V.Color(0,0,0)),this.outlineWidth=x.width||.1,this.outlinePushback=x.pushback||1,this.outlineMaxPixels=x.maxpixels||0,this.setValues(x)}clone(x=new Rr){return super.clone.call(this,x),x.outlineColor=this.outlineColor,x.outlineWidth=this.outlineWidth,x.outlinePushback=this.outlinePushback,x.outlineMaxPixels=this.outlineMaxPixels,x}}class Ir extends U{constructor(x){super(),this.color=new V.Color(16777215),this.map=new or,this.useScreenCoordinates=!0,this.fog=!1,this.uvOffset=new m.Vector2(0,0),this.uvScale=new m.Vector2(1,1),this.depthTest=!this.useScreenCoordinates,this.sizeAttenuation=!this.useScreenCoordinates,this.screenOffset=this.screenOffset,this.scaleByViewPort=!this.sizeAttenuation,this.alignment=_.center.clone(),this.setValues(x),(x=x||{}).depthTest===void 0&&(this.depthTest=!this.useScreenCoordinates),x.sizeAttenuation===void 0&&(this.sizeAttenuation=!this.useScreenCoordinates),x.scaleByViewPort===void 0&&(this.scaleByViewPort=!this.sizeAttenuation)}clone(x=new Ir){return super.clone.call(this,x),x.color.copy(this.color),x.map=this.map,x.useScreenCoordinates=this.useScreenCoordinates,x.screenOffset=this.screenOffset,x.sizeAttenuation=this.sizeAttenuation,x.scaleByViewport=this.scaleByViewPort,x.alignment.copy(this.alignment),x.uvOffset.copy(this.uvOffset),x}}class Di extends kr{constructor(x){super(x),this.shaderID="stickimposter",this.setValues(x)}clone(x=new Di){return super.clone.call(this,x),x}}class wi extends kr{constructor(x={}){super(x),this.shaderID="stickimposteroutline",this.outlineColor=new V.Color(0,0,0),this.outlineWidth=.1,this.outlinePushback=1,this.outlineMaxPixels=0,x.color&&(this.outlineColor=V.CC.color(x.color)),x.width&&(this.outlineWidth=x.width),x.pushback&&(this.outlinePushback=x.pushback),x.maxpixels&&(this.outlineMaxPixels=x.maxpixels),this.setValues(x)}clone(x=new wi){return super.clone.call(this,x),x.outlineColor=this.outlineColor,x.outlineWidth=this.outlineWidth,x.outlinePushback=this.outlinePushback,x.outlineMaxPixels=this.outlineMaxPixels,x}}class Hi extends U{constructor(x){super(),this.transparent=!1,this.volumetric=!0,this.color=new V.Color(16777215),this.transferfn=null,this.map=void 0,this.extent=[],this.maxdepth=100,this.unit=0,this.texmatrix=null,this.transfermin=-1,this.transfermax=1,this.subsamples=5,this.shaderID="volumetric",this.side=p,this.setValues(x)}clone(x=new Hi){return super.clone.call(this,x),x.transparent=this.transparent,x.volumetric=this.volumetric,x.color=this.color,x.transferfn=this.transferfn,x.map=this.map,x.extent=this.extent,x.maxdepth=this.maxdepth,x.unit=this.unit,x.texmatrix=this.texmatrix,x.transfermin=this.transfermin,x.transfermax=this.transfermax,x.subsamples=this.subsamples,x.shaderID=this.shaderID,x.side=this.side,x}}var pe;(function(Bt){Bt[Bt.LineStrip=0]="LineStrip",Bt[Bt.LinePieces=1]="LinePieces"})(pe||(pe={}));class Se extends Me{constructor(x,ne=new L({color:16777215*Math.random()}),xe=pe.LineStrip){super(),this.geometry=x,this.material=ne,this.type=xe}clone(x=new Se(this.geometry,this.material,this.type)){return super.clone.call(this,x),x}}class Oe extends Me{constructor(x,ne){super(),this.geometry=x,this.material=ne}clone(x){return x===void 0&&(x=new Oe(this.geometry,this.material)),super.clone.call(this,x),x}}class dt extends Me{constructor(x=new Ir){super(),this.material=x,this.rotation3d=this.rotation,this.rotation=0}updateMatrix(){this.matrix.setPosition(this.position),this.rotation3d.set(0,0,this.rotation),this.matrix.setRotationFromEuler(this.rotation3d),this.scale.x===1&&this.scale.y===1||this.matrix.scale(this.scale),this.matrixWorldNeedsUpdate=!0}clone(x=new dt(this.material)){return Me.prototype.clone.call(this,x),x}}const nt={opacity:{type:"f",value:1},fogColor:{type:"c",value:new V.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3}},zt={vertexShader:`uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;

attribute vec3 position;
attribute vec3 color;

varying vec3 vColor;
varying vec4 mvPosition;

void main() {

    vColor = color;
    mvPosition = modelViewMatrix * vec4( position, 1.0 );
    gl_Position = projectionMatrix * mvPosition;

}`.replace("#define GLSLIFY 1",""),fragmentShader:`uniform mat4 viewMatrix;
uniform float opacity;
uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
varying vec3 vColor;
varying vec4 mvPosition;

//DEFINEFRAGCOLOR
void main() {
    gl_FragColor = vec4( vColor, opacity );
    if(fogNear != fogFar) {
        float depth = -mvPosition.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }
}`.replace("#define GLSLIFY 1",""),uniforms:nt},ht={opacity:{type:"f",value:1},fogColor:{type:"c",value:new V.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}},Ot={fragmentShader:`uniform mat4 viewMatrix;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
#ifdef SHADED
uniform highp sampler2D shading;
#endif
varying vec3 vLightFront;
varying vec3 vColor;
//DEFINEFRAGCOLOR

void main() {

    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );

    #ifndef WIREFRAME
    gl_FragColor.xyz *= vLightFront;
    #endif

#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    vColor *= shadowFactor;
#endif
    gl_FragColor = gl_FragColor * vec4( vColor, opacity );
    float depth = gl_FragCoord.z / gl_FragCoord.w;

    float fogFactor = smoothstep( fogNear, fogFar, depth );

    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );

}


`.replace("#define GLSLIFY 1",""),vertexShader:`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 offset;
attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;
attribute float radius;

varying vec3 vColor;
varying vec3 vLightFront;

void main() {

    vColor = color;

    vec3 objectNormal = normal;
    vec3 transformedNormal = normalMatrix * objectNormal;
    vec4 mvPosition = modelViewMatrix * vec4( position * radius + offset, 1.0 );

    vLightFront = vec3( 0.0 );

    transformedNormal = normalize( transformedNormal );

    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vec3 dirVector = normalize( lDirection.xyz );
    float dotProduct = dot( transformedNormal, dirVector );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );

    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;

    gl_Position = projectionMatrix * mvPosition;
}

`.replace("#define GLSLIFY 1",""),uniforms:ht},Ut={opacity:{type:"f",value:1},fogColor:{type:"c",value:new V.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}},It={fragmentShader:`uniform mat4 viewMatrix;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
#ifdef SHADED
uniform highp sampler2D shading;
#endif
varying vec3 vLightFront;
varying vec3 vColor;
varying vec4 mvPosition;


//DEFINEFRAGCOLOR

void main() {

    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );

    #ifndef WIREFRAME
    gl_FragColor.xyz *= vLightFront;
    #endif
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    vColor *= shadowFactor;
#endif
    gl_FragColor = gl_FragColor * vec4( vColor, opacity );

    if(fogNear != fogFar) {
        float depth = -mvPosition.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }

}`.replace("#define GLSLIFY 1",""),vertexShader:`
uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec3 vColor;
varying vec3 vLightFront;
varying vec4 mvPosition;

void main() {

    vColor = color;

    vec3 objectNormal = normal;
    vec3 transformedNormal = normalMatrix * objectNormal;
    mvPosition = modelViewMatrix * vec4( position, 1.0 );

    vLightFront = vec3( 0.0 );

    transformedNormal = normalize( transformedNormal );

    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vec3 dirVector = normalize( lDirection.xyz );
    float dotProduct = dot( transformedNormal, dirVector );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );

    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;

    gl_Position = projectionMatrix * mvPosition;
}`.replace("#define GLSLIFY 1",""),uniforms:Ut},mr={opacity:{type:"f",value:1},fogColor:{type:"c",value:new V.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}},li={fragmentShader:`
#ifdef SHADED
uniform highp sampler2D shading;
#endif

uniform mat4 viewMatrix;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;

varying vec3 vLightFront;
varying vec3 vLightBack;

varying vec3 vColor;
varying vec4 mvPosition;

//DEFINEFRAGCOLOR

void main() {

    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );

    #ifndef WIREFRAME
    if ( gl_FrontFacing )
       gl_FragColor.xyz *= vLightFront;
    else
       gl_FragColor.xyz *= vLightBack;
    #endif

    vec3 color = vColor;
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    color *= shadowFactor;
#endif
    gl_FragColor = gl_FragColor * vec4( color, opacity );

    if(fogNear != fogFar) {
        float depth = -mvPosition.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }

}


`.replace("#define GLSLIFY 1",""),vertexShader:`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec3 vColor;
varying vec3 vLightFront;
varying vec3 vLightBack;
varying vec4 mvPosition;

void main() {

    vColor = color;

    vec3 objectNormal = normal;
    vec3 transformedNormal = normalMatrix * objectNormal;
    mvPosition = modelViewMatrix * vec4( position, 1.0 );

    vLightFront = vec3( 0.0 );
    vLightBack = vec3( 0.0 );

    transformedNormal = normalize( transformedNormal );

    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vec3 dirVector = normalize( lDirection.xyz );
    float dotProduct = dot( transformedNormal, dirVector );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );
    vec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );

    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;
    vLightBack += directionalLightColor[ 0 ] * directionalLightWeightingBack;

    gl_Position = projectionMatrix * mvPosition;
}

`.replace("#define GLSLIFY 1",""),uniforms:mr},Ei={opacity:{type:"f",value:1},outlineColor:{type:"c",value:new V.Color(0,0,0)},fogColor:{type:"c",value:new V.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},outlineWidth:{type:"f",value:.1},outlinePushback:{type:"f",value:1},outlineMaxPixels:{type:"f",value:0}},ui={fragmentShader:`

uniform float opacity;
uniform vec3 outlineColor;
uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;

varying vec4 mvPosition;
//DEFINEFRAGCOLOR

void main() {
    gl_FragColor = vec4( outlineColor, 1 );

    if(fogNear != fogFar) {
        float depth = -mvPosition.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }
}


`.replace("#define GLSLIFY 1",""),vertexShader:`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform float outlineWidth;
uniform float outlinePushback;
uniform float vWidth;
uniform float vHeight;
uniform float outlineMaxPixels;

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec4 mvPosition;

void main() {

    vec4 norm = modelViewMatrix*vec4(normalize(normal),0.0);
    mvPosition = modelViewMatrix * vec4( position, 1.0 );
    mvPosition.xy += norm.xy*outlineWidth;
    vec4 outpos = projectionMatrix * mvPosition;

    if(outlineMaxPixels > 0.0) {
        vec4 unadjusted = projectionMatrix*modelViewMatrix * vec4( position, 1.0 );
        float w = outpos.w;
        //normalize homogeneous coords
        unadjusted /= unadjusted.w;
        outpos /= outpos.w;
        vec2 diff = outpos.xy-unadjusted.xy;
        //put into pixels
        diff.x *= vWidth;
        diff.y *= vHeight;
        if ( length(diff) > outlineMaxPixels) {
            vec2 ndiff = normalize(diff)*outlineMaxPixels;
            ndiff.x /= vWidth;
            ndiff.y /= vHeight;
            outpos.xy = unadjusted.xy;
            outpos.xy += ndiff;
        }
        outpos *= w; //if I don't do this things blow up
    }
    gl_Position = outpos;
    mvPosition.z -= outlinePushback; //go backwards in model space
    vec4 pushpos = projectionMatrix*mvPosition; //project to get z in projection space, I'm probably missing some simple math to do the same thing..
    gl_Position.z = gl_Position.w*pushpos.z/pushpos.w;
}

`.replace("#define GLSLIFY 1",""),uniforms:Ei},gi={fragmentShader:`uniform sampler2D colormap;
varying highp vec2 vTexCoords;
uniform vec2 dimensions;
//DEFINEFRAGCOLOR
void main (void) {
   gl_FragColor = texture2D(colormap, vTexCoords);

   //gl_FragColor.g = gl_FragColor.b =  gl_FragColor.r; //debug shading 
}
        `.replace("#define GLSLIFY 1",""),vertexShader:`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `.replace("#define GLSLIFY 1",""),uniforms:{}},jr={fragmentShader:`
        
precision highp float;
precision highp int;
precision highp sampler2D;

uniform sampler2D tColor;
varying highp vec2 vTexCoords;

// adapted from https://github.com/kosua20/Rendu
// MIT License Copyright (c) 2017 Simon Rodriguez
// by way of molstar (https://github.com/molstar/molstar/blob/master/src/mol-gl/shader/fxaa.frag.ts)

#define QUALITY(q) ((q) < 5 ? 1.0 : ((q) > 5 ? ((q) < 10 ? 2.0 : ((q) < 11 ? 4.0 : 8.0)) : 1.5))

float rgb2luma(vec3 rgb){
    return sqrt(dot(rgb, vec3(0.299, 0.587, 0.114)));
}

float sampleLuma(vec2 uv) {
    return rgb2luma(texture2D(tColor, uv).rgb);
}

float sampleLuma(vec2 uv, float uOffset, float vOffset) {
    uv += vec2(uOffset, vOffset);
    return sampleLuma(uv);
}

//DEFINEFRAGCOLOR
void main(void) {
    ivec2 dim = textureSize(tColor,0);
    vec2 dimensions = vec2(float(dim.x),float(dim.y));
    vec2 inverseScreenSize = vec2(1.0 / dimensions.x, 1.0 / dimensions.y);
    vec2 coords = vTexCoords;

    vec4 colorCenter = texture2D(tColor, coords);
    float dEdgeThresholdMin = 0.0312;
    float dEdgeThresholdMax = 0.125;
    int dIterations = 12;
    float dSubpixelQuality = 0.3;

    // Luma at the current fragment
    float lumaCenter = rgb2luma(colorCenter.rgb);

    // Luma at the four direct neighbours of the current fragment.
    float lumaDown = sampleLuma(coords, 0.0, -inverseScreenSize.y);
    float lumaUp = sampleLuma(coords, 0.0, inverseScreenSize.y);
    float lumaLeft = sampleLuma(coords, -inverseScreenSize.x, 0.0);
    float lumaRight = sampleLuma(coords, inverseScreenSize.x, 0.0);

    // Find the maximum and minimum luma around the current fragment.
    float lumaMin = min(lumaCenter, min(min(lumaDown, lumaUp), min(lumaLeft, lumaRight)));
    float lumaMax = max(lumaCenter, max(max(lumaDown, lumaUp), max(lumaLeft, lumaRight)));

    // Compute the delta.
    float lumaRange = lumaMax - lumaMin;

    // If the luma variation is lower that a threshold (or if we are in a really dark area),
    // we are not on an edge, don't perform any AA.
    if (lumaRange < max(dEdgeThresholdMin, lumaMax * dEdgeThresholdMax)) {
        gl_FragColor = colorCenter;
        return;
    }

    // Query the 4 remaining corners lumas.
    float lumaDownLeft = sampleLuma(coords, -inverseScreenSize.x, -inverseScreenSize.y);
    float lumaUpRight = sampleLuma(coords, inverseScreenSize.x, inverseScreenSize.y);
    float lumaUpLeft = sampleLuma(coords, -inverseScreenSize.x, inverseScreenSize.y);
    float lumaDownRight = sampleLuma(coords, inverseScreenSize.x, -inverseScreenSize.y);

    // Combine the four edges lumas (using intermediary variables for future computations
    // with the same values).
    float lumaDownUp = lumaDown + lumaUp;
    float lumaLeftRight = lumaLeft + lumaRight;

    // Same for corners
    float lumaLeftCorners = lumaDownLeft + lumaUpLeft;
    float lumaDownCorners = lumaDownLeft + lumaDownRight;
    float lumaRightCorners = lumaDownRight + lumaUpRight;
    float lumaUpCorners = lumaUpRight + lumaUpLeft;

    // Compute an estimation of the gradient along the horizontal and vertical axis.
    float edgeHorizontal = abs(-2.0 * lumaLeft + lumaLeftCorners) + abs(-2.0 * lumaCenter + lumaDownUp) * 2.0 + abs(-2.0 * lumaRight + lumaRightCorners);
    float edgeVertical = abs(-2.0 * lumaUp + lumaUpCorners) + abs(-2.0 * lumaCenter + lumaLeftRight) * 2.0 + abs(-2.0 * lumaDown + lumaDownCorners);

    // Is the local edge horizontal or vertical ?
    bool isHorizontal = (edgeHorizontal >= edgeVertical);

    // Choose the step size (one pixel) accordingly.
    float stepLength = isHorizontal ? inverseScreenSize.y : inverseScreenSize.x;

    // Select the two neighboring texels lumas in the opposite direction to the local edge.
    float luma1 = isHorizontal ? lumaDown : lumaLeft;
    float luma2 = isHorizontal ? lumaUp : lumaRight;
    // Compute gradients in this direction.
    float gradient1 = luma1 - lumaCenter;
    float gradient2 = luma2 - lumaCenter;

    // Which direction is the steepest ?
    bool is1Steepest = abs(gradient1) >= abs(gradient2);

    // Gradient in the corresponding direction, normalized.
    float gradientScaled = 0.25 * max(abs(gradient1), abs(gradient2));

    // Average luma in the correct direction.
    float lumaLocalAverage = 0.0;
    if(is1Steepest){
        // Switch the direction
        stepLength = -stepLength;
        lumaLocalAverage = 0.5 * (luma1 + lumaCenter);
    } else {
        lumaLocalAverage = 0.5 * (luma2 + lumaCenter);
    }

    // Shift UV in the correct direction by half a pixel.
    vec2 currentUv = coords;
    if(isHorizontal){
        currentUv.y += stepLength * 0.5;
    } else {
        currentUv.x += stepLength * 0.5;
    }

    // Compute offset (for each iteration step) in the right direction.
    vec2 offset = isHorizontal ? vec2(inverseScreenSize.x, 0.0) : vec2(0.0, inverseScreenSize.y);
    // Compute UVs to explore on each side of the edge, orthogonally.
    // The QUALITY allows us to step faster.
    vec2 uv1 = currentUv - offset * QUALITY(0);
    vec2 uv2 = currentUv + offset * QUALITY(0);

    // Read the lumas at both current extremities of the exploration segment,
    // and compute the delta wrt to the local average luma.
    float lumaEnd1 = sampleLuma(uv1);
    float lumaEnd2 = sampleLuma(uv2);
    lumaEnd1 -= lumaLocalAverage;
    lumaEnd2 -= lumaLocalAverage;

    // If the luma deltas at the current extremities is larger than the local gradient,
    // we have reached the side of the edge.
    bool reached1 = abs(lumaEnd1) >= gradientScaled;
    bool reached2 = abs(lumaEnd2) >= gradientScaled;
    bool reachedBoth = reached1 && reached2;

    // If the side is not reached, we continue to explore in this direction.
    if(!reached1){
        uv1 -= offset * QUALITY(1);
    }
    if(!reached2){
        uv2 += offset * QUALITY(1);
    }

    // If both sides have not been reached, continue to explore.
    if(!reachedBoth){
        for(int i = 2; i < dIterations; i++){
            // If needed, read luma in 1st direction, compute delta.
            if(!reached1){
                lumaEnd1 = sampleLuma(uv1);
                lumaEnd1 = lumaEnd1 - lumaLocalAverage;
            }
            // If needed, read luma in opposite direction, compute delta.
            if(!reached2){
                lumaEnd2 = sampleLuma(uv2);
                lumaEnd2 = lumaEnd2 - lumaLocalAverage;
            }
            // If the luma deltas at the current extremities is larger than the local gradient,
            // we have reached the side of the edge.
            reached1 = abs(lumaEnd1) >= gradientScaled;
            reached2 = abs(lumaEnd2) >= gradientScaled;
            reachedBoth = reached1 && reached2;

            // If the side is not reached, we continue to explore in this direction,
            // with a variable quality.
            if(!reached1){
                uv1 -= offset * QUALITY(i);
            }
            if(!reached2){
                uv2 += offset * QUALITY(i);
            }

            // If both sides have been reached, stop the exploration.
            if(reachedBoth){
                break;
            }
        }
    }

    // Compute the distances to each side edge of the edge (!).
    float distance1 = isHorizontal ? (coords.x - uv1.x) : (coords.y - uv1.y);
    float distance2 = isHorizontal ? (uv2.x - coords.x) : (uv2.y - coords.y);

    // In which direction is the side of the edge closer ?
    bool isDirection1 = distance1 < distance2;
    float distanceFinal = min(distance1, distance2);

    // Thickness of the edge.
    float edgeThickness = (distance1 + distance2);

    // Is the luma at center smaller than the local average ?
    bool isLumaCenterSmaller = lumaCenter < lumaLocalAverage;

    // If the luma at center is smaller than at its neighbour,
    // the delta luma at each end should be positive (same variation).
    bool correctVariation1 = (lumaEnd1 < 0.0) != isLumaCenterSmaller;
    bool correctVariation2 = (lumaEnd2 < 0.0) != isLumaCenterSmaller;

    // Only keep the result in the direction of the closer side of the edge.
    bool correctVariation = isDirection1 ? correctVariation1 : correctVariation2;

    // UV offset: read in the direction of the closest side of the edge.
    float pixelOffset = - distanceFinal / edgeThickness + 0.5;

    // If the luma variation is incorrect, do not offset.
    float finalOffset = correctVariation ? pixelOffset : 0.0;

    // Sub-pixel shifting
    // Full weighted average of the luma over the 3x3 neighborhood.
    float lumaAverage = (1.0 / 12.0) * (2.0 * (lumaDownUp + lumaLeftRight) + lumaLeftCorners + lumaRightCorners);
    // Ratio of the delta between the global average and the center luma,
    // over the luma range in the 3x3 neighborhood.
    float subPixelOffset1 = clamp(abs(lumaAverage - lumaCenter) / lumaRange, 0.0, 1.0);
    float subPixelOffset2 = (-2.0 * subPixelOffset1 + 3.0) * subPixelOffset1 * subPixelOffset1;
    // Compute a sub-pixel offset based on this delta.
    float subPixelOffsetFinal = subPixelOffset2 * subPixelOffset2 * float(dSubpixelQuality);

    // Pick the biggest of the two offsets.
    finalOffset = max(finalOffset, subPixelOffsetFinal);

    // Compute the final UV coordinates.
    vec2 finalUv = coords;
    if(isHorizontal){
        finalUv.y += finalOffset * stepLength;
    } else {
        finalUv.x += finalOffset * stepLength;
    }

    // Read the color at the new UV coordinates, and use it.
    gl_FragColor = texture2D(tColor, finalUv);
}        

/* old fxaa implementation
uniform highp sampler2D colormap;
varying highp vec2 vTexCoords;


// Basic FXAA implementation based on the code on geeks3d.com 
#define FXAA_REDUCE_MIN (1.0/ 128.0)
#define FXAA_REDUCE_MUL (1.0 / 8.0)
#define FXAA_SPAN_MAX 8.0


vec4 applyFXAA(vec2 fragCoord, highp sampler2D tex)
{
    vec4 color;
    ivec2 dim = textureSize(tex,0);
    vec2 dimensions = vec2(float(dim.x),float(dim.y));
    vec2 inverseVP = vec2(1.0 / dimensions.x, 1.0 / dimensions.y);
    vec4 rgbNW = texture2D(tex, fragCoord + vec2(-1.0, -1.0) * inverseVP);
    vec4 rgbNE = texture2D(tex, fragCoord + vec2(1.0, -1.0) * inverseVP);
    vec4 rgbSW = texture2D(tex, fragCoord + vec2(-1.0, 1.0) * inverseVP);
    vec4 rgbSE = texture2D(tex, fragCoord + vec2(1.0, 1.0) * inverseVP);
    vec4 rgbM  = texture2D(tex, fragCoord );
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW.xyz, luma);
    float lumaNE = dot(rgbNE.xyz, luma);
    float lumaSW = dot(rgbSW.xyz, luma);
    float lumaSE = dot(rgbSE.xyz, luma);
    float lumaM  = dot(rgbM.xyz,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                        (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
            max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
            dir * rcpDirMin)) * inverseVP;

    vec4 rgbA = 0.5 * (
        texture2D(tex, fragCoord + dir * (1.0 / 3.0 - 0.5)) +
        texture2D(tex, fragCoord  + dir * (2.0 / 3.0 - 0.5)));
    vec4 rgbB = rgbA * 0.5 + 0.25 * (
        texture2D(tex, fragCoord  + dir * -0.5) +
        texture2D(tex, fragCoord  + dir * 0.5));

    float lumaB = dot(rgbB.xyz, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = rgbA;
    else
        color = rgbB;

    return color;
}


//DEFINEFRAGCOLOR
void main (void) {
    ivec2 dim = textureSize(colormap,0);

  gl_FragColor = applyFXAA(vTexCoords, colormap);
}
        
*/`.replace("#define GLSLIFY 1",""),vertexShader:`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `.replace("#define GLSLIFY 1",""),uniforms:{}},Or={opacity:{type:"f",value:1},fogColor:{type:"c",value:new V.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}},Dr={vertexShader:`uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec2 mapping;
varying vec3 vColor;
varying float rval;
varying vec3 vLight;
varying vec3 center;

void main() {

    vColor = color;
    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
    center = mvPosition.xyz;
    vec4 projPosition = projectionMatrix * mvPosition;
    vec4 adjust = projectionMatrix* vec4(normal,0.0); adjust.z = 0.0; adjust.w = 0.0;
    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vLight = normalize( lDirection.xyz );
    mapping = normal.xy;
    rval = abs(normal.x);
    gl_Position = projPosition+adjust;

}
`.replace("#define GLSLIFY 1",""),fragmentShader:`
uniform mat4 viewMatrix;
uniform float opacity;
uniform mat4 projectionMatrix;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
uniform float uDepth;
uniform vec3 directionalLightColor[ 1 ];

varying vec3 vColor;
varying vec2 mapping;
varying float rval;
varying vec3 vLight;
varying vec3 center;

#ifdef SHADED
uniform highp sampler2D shading;
#endif

//DEFINEFRAGCOLOR

void main() {
    float lensqr = dot(mapping,mapping);
    float rsqr = rval*rval;
    if(lensqr > rsqr)
       discard;
    float z = sqrt(rsqr-lensqr);
    vec3 cameraPos = center+ vec3(mapping.x,mapping.y,z);
    vec4 clipPos = projectionMatrix * vec4(cameraPos, 1.0);
    float ndcDepth = clipPos.z / clipPos.w;
    gl_FragDepthEXT = ((gl_DepthRange.diff * ndcDepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
    vec3 norm = normalize(vec3(mapping.x,mapping.y,z));
    float dotProduct = dot( norm, vLight );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );
    vec3 vLight = directionalLightColor[ 0 ] * directionalLightWeighting;
    vec3 color = vLight*vColor;
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    color *= shadowFactor;
#endif    
    gl_FragColor = vec4(color, opacity*opacity );

    if(fogNear != fogFar) {
        float depth = -cameraPos.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }
     
}

`.replace("#define GLSLIFY 1",""),uniforms:Or},rr={opacity:{type:"f",value:1},outlineColor:{type:"c",value:new V.Color(0,0,0)},fogColor:{type:"c",value:new V.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},outlineWidth:{type:"f",value:.1},outlinePushback:{type:"f",value:1},outlineMaxPixels:{type:"f",value:0}},vi={fragmentShader:`

uniform float opacity;
uniform vec3 outlineColor;
uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
uniform mat4 projectionMatrix;
varying vec2 mapping;
varying float rval;
varying vec3 center;

uniform float outlinePushback;

//DEFINEFRAGCOLOR

void main() {
    float lensqr = dot(mapping,mapping);
    float rsqr = rval*rval;
    if(lensqr > rsqr)
       discard;
    float z = sqrt(rsqr-lensqr);
    vec3 cameraPos = center+ vec3(mapping.x,mapping.y,z-outlinePushback);
    vec4 clipPos = projectionMatrix * vec4(cameraPos, 1.0);
    float ndcDepth = clipPos.z / clipPos.w;
    gl_FragDepthEXT = ((gl_DepthRange.diff * ndcDepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
    gl_FragColor = vec4(outlineColor, 1 );

    if(fogNear != fogFar) {
        float depth = -cameraPos.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }
}


`.replace("#define GLSLIFY 1",""),vertexShader:`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform float outlineWidth;
uniform float outlinePushback;
uniform float outlineMaxPixels;
uniform float vWidth;
uniform float vHeight;

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec2 mapping;
varying float rval;
varying vec3 center;

void main() {

    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
    center = mvPosition.xyz;
    vec4 projPosition = projectionMatrix * mvPosition;
    vec2 norm = normal.xy + vec2(sign(normal.x)*outlineWidth,sign(normal.y)*outlineWidth);

    vec4 adjust = projectionMatrix* vec4(norm,normal.z,1.0); 
    mapping = norm.xy;
    rval = abs(norm.x);
    gl_Position = projPosition+vec4(adjust.xy,0.0,0.0);

    if(outlineMaxPixels > 0.0) {
        vec4 unadjusted = projectionMatrix*vec4(center.x+normal.x, center.y,center.z,1.0); 
        vec4 ccoord = projectionMatrix*vec4(center.xyz,1.0);
        adjust = projectionMatrix* vec4(center.x+norm.x,center.y,center.z,1.0); 
        //subtract center 
        unadjusted.xyz -= ccoord.xyz;
        adjust.xyz -= ccoord.xyz;
        unadjusted /= unadjusted.w;
        adjust /= adjust.w;
        float diff = abs(adjust.x-unadjusted.x);
        diff *= vWidth;
        if(diff > outlineMaxPixels) {
            
            float fixlen = abs(unadjusted.x) + outlineMaxPixels/vWidth;
            //adjsut reval by ratio of lengths
            rval *= fixlen/abs(adjust.x);
        }

    }
}

`.replace("#define GLSLIFY 1",""),uniforms:rr},bi={fragmentShader:`

uniform vec3 color;
uniform sampler2D map;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
uniform float alphaTest;

varying vec2 vUV;
//DEFINEFRAGCOLOR

void main() {

    vec4 texture = texture2D(map, vUV);

    if (texture.a <= alphaTest) discard;

    gl_FragColor = vec4(color * texture.xyz, texture.a * opacity);

    if (fogNear != fogFar) {

        float depth = gl_FragCoord.z / gl_FragCoord.w; //probably wrong
        float fogFactor = smoothstep(fogNear, fogFar, depth);        
        gl_FragColor = mix(gl_FragColor, vec4(fogColor, gl_FragColor.w), fogFactor);
    }
}

`.replace("#define GLSLIFY 1",""),vertexShader:`

uniform int useScreenCoordinates;
uniform vec3 screenPosition;
uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform float rotation;
uniform vec2 scale;
uniform vec2 alignment;
uniform vec2 uvOffset;
uniform vec2 uvScale;

attribute vec2 position;
attribute vec2 uv;

varying vec2 vUV;

void main() {

    vUV = uvOffset + uv * uvScale;

    vec2 alignedPosition = position + alignment;

    vec2 rotatedPosition;
    rotatedPosition.x = ( cos(rotation) * alignedPosition.x - sin(rotation) * alignedPosition.y ) * scale.x;
    rotatedPosition.y = ( sin(rotation) * alignedPosition.x + cos(rotation) * alignedPosition.y ) * scale.y;

    vec4 finalPosition;

    if(useScreenCoordinates != 0) {
        finalPosition = vec4(screenPosition.xy + rotatedPosition, screenPosition.z, 1.0);
    }

    else {
        finalPosition = projectionMatrix * modelViewMatrix * vec4(0.0, 0.0, 0.0, 1.0); finalPosition /= finalPosition.w;
        finalPosition.xy += rotatedPosition; 
    }

    gl_Position = finalPosition;

}

`.replace("#define GLSLIFY 1",""),uniforms:{}},Ki={opacity:{type:"f",value:1},fogColor:{type:"c",value:new V.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}},Ci=`uniform float opacity;
uniform mat4 projectionMatrix;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;

varying vec3 vLight;
varying vec3 vColor;
varying vec3 cposition;
varying vec3 p1;
varying vec3 p2;
varying float r;

#ifdef SHADED
uniform highp sampler2D shading;
#endif

//DEFINEFRAGCOLOR

//cylinder-ray intersection testing taken from http://mrl.nyu.edu/~dzorin/cg05/lecture12.pdf
//also useful: http://stackoverflow.com/questions/9595300/cylinder-impostor-in-glsl
//with a bit more care (caps) this could be a general cylinder imposter (see also outline)
void main() {
    vec3 color = abs(vColor);
    vec3 pos = cposition;
    vec3 p = pos; //ray point
    vec3 v = vec3(0.0,0.0,-1.0); //ray normal - orthographic
    if(projectionMatrix[3][3] == 0.0) v = normalize(pos); //ray normal - perspective
    vec3 pa = p1; //cyl start
    vec3 va = normalize(p2-p1); //cyl norm
    vec3 tmp1 = v-(dot(v,va)*va);
    vec3 deltap = p-pa;
    float A = dot(tmp1,tmp1);
    if(A == 0.0) discard;
    vec3 tmp2 = deltap-(dot(deltap,va)*va);
    float B = 2.0*dot(tmp1, tmp2);
    float C = dot(tmp2,tmp2)-r*r;
//quadratic equation!
    float det = (B*B) - (4.0*A*C);
    if(det < 0.0) discard;
    float sqrtDet = sqrt(det);
    float posT = (-B+sqrtDet)/(2.0*A);
    float negT = (-B-sqrtDet)/(2.0*A);
    float intersectionT = min(posT,negT);
    vec3 qi = p+v*intersectionT;
    float dotp1 = dot(va,qi-p1);
    float dotp2 = dot(va,qi-p2);
    vec3 norm;
    if( dotp1 < 0.0 || dotp2 > 0.0) { //(p-c)^2 + 2(p-c)vt +v^2+t^2 - r^2 = 0
       vec3 cp;
       if( dotp1 < 0.0) {  
//        if(vColor.x < 0.0 ) discard; //color sign bit indicates if we should cap or not
        cp = p1;
       } else {
//          if(vColor.y < 0.0 ) discard;
          cp = p2;
       }
       vec3 diff = p-cp;
       A = dot(v,v);
       B = dot(diff,v)*2.0;
       C = dot(diff,diff)-r*r;
       det = (B*B) - (4.0*C);
       if(det < 0.0) discard;
       sqrtDet = sqrt(det);
       posT = (-B+sqrtDet)/(2.0);
       negT = (-B-sqrtDet)/(2.0);
       float t = min(posT,negT);
       qi = p+v*t; 
       norm = normalize(qi-cp); 
    } else {
       norm = normalize(qi-(dotp1*va + p1));
    }
    vec4 clipPos = projectionMatrix * vec4(qi, 1.0);
    float ndcDepth = clipPos.z / clipPos.w;
    float depth = ((gl_DepthRange.diff * ndcDepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
    gl_FragDepthEXT = depth;`,Ni={fragmentShader:[Ci,`    float dotProduct = dot( norm, vLight );
    vec3 light = vec3( max( dotProduct, 0.0 ) );
    color *= light;
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    color *= shadowFactor;
#endif    
    gl_FragColor = vec4(color, opacity*opacity );
    if(fogNear != fogFar) {
        float depth = -qi.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }
}`].join(`
`),vertexShader:`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;
attribute float radius;

varying vec3 vColor;
varying vec3 vLight;
varying vec3 cposition;
varying vec3 p1;
varying vec3 p2;
varying float r;

void main() {

    vColor = color; vColor.z = abs(vColor.z); //z indicates which vertex and so would vary
    r = abs(radius);
    vec4 to = modelViewMatrix*vec4(normal, 1.0); //normal is other point of cylinder
    vec4 pt = modelViewMatrix*vec4(position, 1.0);
    vec4 mvPosition = pt;
    p1 = pt.xyz; p2 = to.xyz;
    vec3 norm = to.xyz-pt.xyz;
    float mult = 1.1; //slop to account for perspective of sphere
    if(length(p1) > length(p2)) { //billboard at level of closest point
       mvPosition = to;
    }
    vec3 n = normalize(mvPosition.xyz);
    bool isperspective = (projectionMatrix[3][3] == 0.0);
//intersect with the plane defined by the camera looking at the billboard point
    if(color.z >= 0.0) { //p1
       if(isperspective) { //perspective
         vec3 pnorm = normalize(p1);
         float t = dot(mvPosition.xyz-p1,n)/dot(pnorm,n);
         mvPosition.xyz = p1+t*pnorm; 
       } else { //orthographic
         mvPosition.xyz = p1;
       }
    } else {
      if(isperspective) { //perspective
         vec3 pnorm = normalize(p2);
         float t = dot(mvPosition.xyz-p2,n)/dot(pnorm,n);
         mvPosition.xyz = p2+t*pnorm;
       } else { //orthographic
         mvPosition.xyz = p2;
       } 
       mult *= -1.0;
    }

    if(isperspective) { //perspective
      vec3 cr = normalize(cross(mvPosition.xyz,norm))*radius;
      vec3 doublecr = normalize(cross(mvPosition.xyz,cr))*radius;
      mvPosition.xyz +=  mult*(cr + doublecr).xyz;
    } else {
      vec3 cr = normalize(cross(vec3(0.0,0.0,-1.0),norm))*radius;
      vec3 doublecr = normalize(cross(vec3(0.0,0.0,-1.0),cr))*radius;
      mvPosition.xyz +=  mult*(cr + doublecr).xyz;     
    }

    cposition = mvPosition.xyz;
    gl_Position = projectionMatrix * mvPosition;
    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vLight = normalize( lDirection.xyz )*directionalLightColor[0]; //not really sure this is right, but color is always white so..
}

`,uniforms:Ki},Ti={fragmentShader:Ci+`
    gl_FragColor = vec4(color, opacity*opacity );
    if(fogNear != fogFar) {
        float depth = -qi.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }
}`,vertexShader:`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];
uniform vec3 outlineColor;
uniform float outlineWidth;
uniform float outlinePushback;
uniform float outlineMaxPixels;
uniform float vWidth;
uniform mat4 projinv;


attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;
attribute float radius;

varying vec3 vColor;
varying vec3 vLight;
varying vec3 cposition;
varying vec3 p1;
varying vec3 p2;
varying float r;

void main() {

    vColor = outlineColor;
    float rad = radius+sign(radius)*outlineWidth;
    r = abs(rad);

    vec4 to = modelViewMatrix*vec4(normal, 1.0); //normal is other point of cylinder
    vec4 pt = modelViewMatrix*vec4(position, 1.0);
//pushback
    float scale = 1.0;
    if(projectionMatrix[3][3] != 0.0) { //orthographic
        to.z -= outlinePushback;
        pt.z -= outlinePushback;
    } else { //perspective
        vec4 midbefore = pt;
        if(length(to.xyz) < length(pt)) {
            midbefore = to;
        }
        vec4 midafter = midbefore;
        midafter.xyz += normalize(midbefore.xyz)*outlinePushback;

        to.xyz += normalize(to.xyz)*outlinePushback;
        pt.xyz += normalize(pt.xyz)*outlinePushback;

        //figure out a scaling factor for radius to account for perspective setback
        vec4 midbeforer = vec4(midbefore.x+rad,midbefore.y, midbefore.z, midbefore.w);
        vec4 midafterr = vec4(midafter.x+rad,midafter.y, midafter.z, midafter.w);

        vec4 mb = projectionMatrix*midbefore;
        vec4 mbr = projectionMatrix*midbeforer;
        vec4 ma = projectionMatrix*midafter;
        vec4 mar = projectionMatrix*midafterr;
        mb /= mb.w;
        mbr /= mbr.w;
        ma /= ma.w;
        mar /= mar.w;
        scale = abs((mbr.x-mb.x)/(mar.x-ma.x));
        rad *= scale;
        r = abs(rad);
    }
    vec4 mvPosition = pt;
    p1 = pt.xyz; p2 = to.xyz;
    vec3 norm = to.xyz-pt.xyz;
    float mult = 1.1; //slop to account for perspective of sphere
    if(length(p1) > length(p2)) { //billboard at level of closest point
       mvPosition = to;
    }

    vec3 n = normalize(mvPosition.xyz);
//intersect with the plane defined by the camera looking at the billboard point
    if(color.z >= 0.0) { //p1
       vec3 pnorm = normalize(p1);
       float t = dot(mvPosition.xyz-p1,n)/dot(pnorm,n);
       mvPosition.xyz = p1+t*pnorm;
    } else {
       vec3 pnorm = normalize(p2);
       float t = dot(mvPosition.xyz-p2,n)/dot(pnorm,n);
       mvPosition.xyz = p2+t*pnorm;
       mult *= -1.0;
    }

    if(outlineMaxPixels > 0.0) {
        vec4 cpos = mvPosition;
        vec4 unadjusted = projectionMatrix*vec4(cpos.x+abs(scale*radius), cpos.y,cpos.z,cpos.w); 
        vec4 ccoord = projectionMatrix*cpos;
        vec4 adjust = projectionMatrix*vec4(cpos.x+r,cpos.y,cpos.z,cpos.w); 
        unadjusted /= unadjusted.w;
        adjust /= adjust.w;
        unadjusted.xyz -= ccoord.xyz/ccoord.w;
        adjust.xyz -= ccoord.xyz/ccoord.w;
        float diff = abs(adjust.x-unadjusted.x);
        diff *= vWidth; //this should now be in pixels
        if(diff > outlineMaxPixels) {
            float fixlen = abs(unadjusted.x) + outlineMaxPixels/vWidth; 
            vec4 pcoord = ccoord;
            pcoord.x += fixlen*pcoord.w;
            vec4 altc = projinv*pcoord;
            r= abs(altc.x-cpos.x);
        }
    }

    vec3 cr = normalize(cross(mvPosition.xyz,norm))*rad;
    vec3 doublecr = normalize(cross(mvPosition.xyz,cr))*rad;
    mvPosition.xy +=  mult*(cr + doublecr).xy;
    cposition = mvPosition.xyz;
    gl_Position = projectionMatrix * mvPosition;
    vLight = vec3(1.0,1.0,1.0);
}

`,uniforms:{opacity:{type:"f",value:1},fogColor:{type:"c",value:new V.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},outlineColor:{type:"c",value:new V.Color(0,0,0)},outlineWidth:{type:"f",value:.1},outlinePushback:{type:"f",value:1},outlineMaxPixels:{type:"f",value:0},projinv:{type:"mat4",value:[]}}},pi={opacity:{type:"f",value:1},fogColor:{type:"c",value:new V.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},data:{type:"i",value:3},colormap:{type:"i",value:4},depthmap:{type:"i",value:5},step:{type:"f",value:1},maxdepth:{type:"f",value:100},subsamples:{type:"f",value:5},textmat:{type:"mat4",value:[]},projinv:{type:"mat4",value:[]},transfermin:{type:"f",value:-.2},transfermax:{type:"f",value:.2}},Br={fragmentShader:`
uniform highp sampler3D data;
uniform highp sampler2D colormap;
uniform highp sampler2D depthmap;


uniform mat4 textmat;
uniform mat4 projinv;
uniform mat4 projectionMatrix;

uniform float step;
uniform float subsamples;
uniform float maxdepth;
uniform float transfermin;
uniform float transfermax;
in  vec4 mvPosition;
out vec4 color;
void main(void) {

   vec4 pos = mvPosition;
   bool seengood = false;
   float i = 0.0;
   color = vec4(1,1,1,0);
   float increment = 1.0/subsamples;
   float maxsteps = (maxdepth*subsamples/step);
//there's probably a better way to do this..
//calculate farthest possible point in model coordinates
   vec4 maxpos = vec4(pos.x,pos.y,pos.z-maxdepth,1.0);
// convert to projection
   maxpos = projectionMatrix*maxpos;
   vec4 startp = projectionMatrix*pos;
// homogonize
   maxpos /= maxpos.w;
   startp /= startp.w;
//take x,y from start and z from max
   maxpos = vec4(startp.x,startp.y,maxpos.z,1.0);
//convert back to model space
   maxpos = projinv*maxpos;
   maxpos /= maxpos.w;
   float incr = step/subsamples;
//get depth from depthmap
//startp is apparently [-1,1]
   vec2 tpos = startp.xy/2.0+0.5;
   float depth = texture(depthmap, tpos).r;
//compute vector between start and end
   vec4 direction = maxpos-pos;
   for( i = 0.0; i <= maxsteps; i++) {
      vec4 pt = (pos+(i/maxsteps)*direction);
      vec4 ppt = projectionMatrix*pt;
      float ptdepth = ppt.z/ppt.w;
      ptdepth = ((gl_DepthRange.diff * ptdepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
      if(ptdepth > depth) break;
      pt = textmat*pt;
//       pt /= pt.w;
      if(pt.x >= -0.01 && pt.y >= -0.01 && pt.z >= -0.01 && pt.x <= 1.01 && pt.y <= 1.01 && pt.z <= 1.01) {
         seengood = true;
      } else if(seengood) {
         break;
      }
      if( pt.x < -0.01 || pt.x > 1.01 || pt.y < -0.01 || pt.y > 1.01 || pt.z < -0.01 || pt.z > 1.01  ){
          color.a = 0.0;
          continue;
      }
      else {
         float val = texture(data, pt.zyx).r;
         if(isinf(val)) continue; //masked out
         float cval = (val-transfermin)/(transfermax-transfermin); //scale to texture 0-1 range
         vec4 val_color = texture(colormap, vec2(cval,0.5));
         color.rgb = color.rgb*color.a + (1.0-color.a)*val_color.a*val_color.rgb;
         color.a += (1.0 - color.a) * val_color.a; 
         if(color.a > 0.0) color.rgb /= color.a;
//          color = vec4(pt.x, pt.y, pt.z, 1.0);
      }
//       color = vec4(pt.x, pt.y, pt.z, 0.0)
    }
}

        `.replace("#define GLSLIFY 1",""),vertexShader:`uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;

in vec3 position;
out vec4 mvPosition;
void main() {

    mvPosition = modelViewMatrix * vec4( position, 1.0 );
    gl_Position = projectionMatrix*mvPosition;
}
`.replace("#define GLSLIFY 1",""),uniforms:pi},Yr={basic:zt,blur:{fragmentShader:`const float INV_TOTAL_SAMPLES_FACTOR = 1.0 / 9.0;
uniform highp sampler2D inTex;
varying highp vec2 vTexCoords;
    
void main() {
 
 vec2 texelSize = 1.0 / vec2(textureSize(inTex,0));
 float blurred_visibility_factor = 0.0f;
 for (int t = -1; t <= 1; ++t) {
  for (int s = -1; s <= 1; ++s) {
   vec2 offset = vec2(float(s), float(t)) * texelSize;
   blurred_visibility_factor += texture2D(inTex, vTexCoords + offset).r;
  }
 }
    
 gl_FragDepthEXT = blurred_visibility_factor * INV_TOTAL_SAMPLES_FACTOR;
 
}`,vertexShader:`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `,uniforms:{}},instanced:Ot,lambert:It,lambertdouble:li,outline:ui,screen:gi,screenaa:jr,ssao:{fragmentShader:`uniform sampler2D depthmap;
varying highp vec2 vTexCoords;
uniform float vWidth;
uniform float vHeight;
uniform float total_strength;
uniform float radius;
uniform mat4 projinv;
uniform mat4 projectionMatrix;

//code for pseudorandom vector from chatgpt
float hash(vec3 p) {
    p = fract(p * vec3(0.1031, 0.1030, 0.0973));
    p += dot(p, p.yzx + 33.33);
    return fract((p.x + p.y) * p.z);
}

// Generate a pseudorandom vec3 from a seed vec3
vec3 pseudorandomVec3(vec3 seed) {
    vec3 randomVec;
    randomVec.x = hash(seed);
    randomVec.y = hash(seed + vec3(1.0, 0.0, 17.1));
    randomVec.z = hash(seed + vec3(0.0, 13.23, 0.0));
    return randomVec;
}

void main(void)
{   
   const float base = 0.2;
   const float area = 0.75;
   const int cycles = 1;

   const int samples = 64;
   vec3 sample_sphere[64] = vec3[](
      vec3(0.091258,-0.510164,0.000000),
      vec3(-0.204347,-0.872967,0.187199),
      vec3(0.009690,-0.263696,-0.110414),
      vec3(0.175208,-0.563987,0.228527),
      vec3(-0.001824,-0.003113,-0.000323),
      vec3(0.411134,-0.719869,-0.261530),
      vec3(-0.074272,-0.377368,0.276290),
      vec3(-0.147773,-0.381587,-0.284529),
      vec3(0.173317,-0.199635,0.063295),
      vec3(-0.186452,-0.199460,0.076965),
      vec3(0.143985,-0.308160,-0.307687),
      vec3(0.053194,-0.148286,0.169589),
      vec3(-0.547656,-0.486476,-0.317378),
      vec3(0.020804,-0.015092,-0.004574),
      vec3(-0.038006,-0.043165,0.054059),
      vec3(-0.094795,-0.443908,-0.731525),
      vec3(0.547552,-0.396466,0.461477),
      vec3(-0.176886,-0.089989,0.007315),
      vec3(0.074401,-0.048840,-0.074039),
      vec3(-0.008240,-0.075697,0.178197),
      vec3(-0.307880,-0.185053,-0.368943),
      vec3(0.309520,-0.108483,0.041646),
      vec3(-0.773478,-0.292946,0.538166),
      vec3(0.184487,-0.231594,-0.820065),
      vec3(0.207318,-0.100531,0.361797),
      vec3(-0.173306,-0.037737,-0.055289),
      vec3(0.548102,-0.105342,-0.253237),
      vec3(-0.119342,-0.043907,0.285162),
      vec3(-0.270247,-0.087861,-0.751357),
      vec3(0.449312,-0.039777,0.236146),
      vec3(-0.743773,-0.036095,0.196056),
      vec3(0.148819,-0.004300,-0.231448),
      vec3(0.008773,0.000809,0.051047),
      vec3(-0.461467,0.027390,-0.357386),
      vec3(0.169626,0.013338,-0.014053),
      vec3(-0.043786,0.007095,0.047331),
      vec3(0.004821,0.140371,-0.988260),
      vec3(0.092402,0.023994,0.101860),
      vec3(-0.295335,0.061530,-0.027372),
      vec3(0.024903,0.007537,-0.018901),
      vec3(-0.081463,0.125402,0.447794),
      vec3(-0.397119,0.231805,-0.631062),
      vec3(0.163853,0.059014,0.044905),
      vec3(-0.495220,0.214357,0.254139),
      vec3(0.306123,0.373687,-0.825715),
      vec3(0.021665,0.026737,0.053220),
      vec3(-0.208231,0.117129,-0.098685),
      vec3(0.139749,0.080968,-0.043086),
      vec3(-0.153599,0.182814,0.262090),
      vec3(-0.159673,0.496777,-0.743568),
      vec3(0.134797,0.117152,0.095753),
      vec3(-0.155626,0.120533,0.019395),
      vec3(0.042311,0.054462,-0.049709),
      vec3(0.001257,0.031288,0.034468),
      vec3(-0.002271,0.003199,-0.002304),
      vec3(0.662104,0.717307,0.033854),
      vec3(-0.373100,0.576021,0.308274),
      vec3(0.024233,0.231316,-0.173688),
      vec3(0.161311,0.420217,0.234273),
      vec3(-0.045248,0.078031,-0.010411),
      vec3(0.167453,0.376942,-0.094872),
      vec3(-0.056194,0.433247,0.173218),
      vec3(-0.016224,0.123149,-0.035569),
      vec3(0.067127,0.407641,0.028479)
   );

   float depth = texture2D(depthmap, vTexCoords).r;
   if(depth == 1.0) {
      discard;
   }

   vec4 screen_position = vec4(vTexCoords, depth,1.0);
   vec4 pos = projinv*screen_position;
   pos /= pos.w;
   vec3 position = pos.xyz;

   //approximate the normal from the depth map; I find this simpler
   //than trying to recompute the exact normal within every possible object shader

   //pixel offset positions in screen space
   ivec2 dim = textureSize(depthmap,0);
   vec2 offset1 = vec2(0.0,1.0/float(dim.y));
   vec2 offset2 = vec2(1.0/float(dim.x),0.0);
   float depth1 = texture2D(depthmap, vTexCoords + offset1).r;
   float depth2 = texture2D(depthmap, vTexCoords + offset2).r;
   
   vec3 p1 = vec3(screen_position.xy+offset1, depth1 - depth);
   vec3 p2 = vec3(screen_position.xy+offset2, depth2 - depth);

   //convert to model space
   vec4 pos1 = projinv*vec4(p1,1);
   pos1 /= pos1.w;
   vec4 pos2 = projinv*vec4(p2,1);
   pos2 /= pos2.w;

   vec3 normal = normalize(cross(pos1.xyz-position, pos2.xyz-position)); //model normal, important we normalize in model space

   //pseudo random number

   float occlusion = 0.0;
   for(int c = 0; c < cycles; c++) {
   vec3 random = normalize(pseudorandomVec3(position+float(c)));
   for(int i=0; i < samples; i++) {

      vec3 ray = radius * reflect(sample_sphere[i],random);
      vec3 hemi_ray = position + sign(dot(ray,normal)) * ray; //model space
      vec4 hemi_screen = projectionMatrix*vec4(hemi_ray,1.0);
      hemi_screen /= hemi_screen.w;
      
      float occ_depth = texture2D(depthmap, clamp(hemi_screen.xy,0.0,1.0)).r;
      float difference = hemi_screen.z - occ_depth;
      
      occlusion += step(0.0, difference) * (1.0-smoothstep(0.0, area, difference));
   }
   }
   float ao = 1.0 - total_strength * occlusion * (1.0 / float(cycles*samples));
   gl_FragDepthEXT = clamp(ao+base,0.0,1.0);

}`,vertexShader:`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `,uniforms:{total_strength:{type:"f",value:1},radius:{type:"f",value:5},projinv:{type:"mat4",value:[]}}},sphereimposter:Dr,sphereimposteroutline:vi,sprite:bi,stickimposter:Ni,stickimposteroutline:Ti,volumetric:Br};function Vi(Bt){let x={};for(const xe in Bt){x[xe]={},x[xe].type=Bt[xe].type;var ne=Bt[xe].value;ne instanceof V.Color?x[xe].value=ne.clone():typeof ne=="number"?x[xe].value=ne:ne instanceof Array?x[xe].value=[]:console.error("Error copying shader uniforms from ShaderLib: unknown type for uniform")}return x}const yi={clone:Vi};class Wi extends Me{constructor(x=50,ne=1,xe=.1,Ve=2e3,Le=!1){super(),this.projectionMatrix=new m.Matrix4,this.projectionMatrixInverse=new m.Matrix4,this.matrixWorldInverse=new m.Matrix4,this.fov=x,this.aspect=ne,this.near=xe,this.far=Ve;var yt=this.position.z;this.right=yt*Math.tan(Math.PI/180*x),this.left=-this.right,this.top=this.right/this.aspect,this.bottom=-this.top,this.ortho=!!Le,this.updateProjectionMatrix()}lookAt(x){this.matrix.lookAt(this.position,x,this.up),this.rotationAutoUpdate&&(this.useQuaternion===!1&&this.rotation instanceof m.Vector3?this.rotation.setEulerFromRotationMatrix(this.matrix,this.eulerOrder):console.error("Unimplemented math operation."))}updateProjectionMatrix(){this.ortho?this.projectionMatrix.makeOrthographic(this.left,this.right,this.top,this.bottom,this.near,this.far):this.projectionMatrix.makePerspective(this.fov,this.aspect,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)}}class tn{constructor(x,ne=1,xe=1e3){this.name="",this.color=new V.Color(x),this.near=ne,this.far=xe}clone(){return new tn(this.color.getHex(),this.near,this.far)}}class on{constructor(){this.sprite={vertices:null,faces:null,vertexBuffer:null,elementBuffer:null,program:null,attributes:{},uniforms:null}}init(x){this.gl=x.context,this.renderer=x,this.precision=x.getPrecision(),this.sprite.vertices=new Float32Array(16),this.sprite.faces=new Uint16Array(6);var ne=0;this.sprite.vertices[ne++]=-1,this.sprite.vertices[ne++]=-1,this.sprite.vertices[ne++]=0,this.sprite.vertices[ne++]=0,this.sprite.vertices[ne++]=1,this.sprite.vertices[ne++]=-1,this.sprite.vertices[ne++]=1,this.sprite.vertices[ne++]=0,this.sprite.vertices[ne++]=1,this.sprite.vertices[ne++]=1,this.sprite.vertices[ne++]=1,this.sprite.vertices[ne++]=1,this.sprite.vertices[ne++]=-1,this.sprite.vertices[ne++]=1,this.sprite.vertices[ne++]=0,this.sprite.vertices[ne++]=1,ne=0,this.sprite.faces[ne++]=0,this.sprite.faces[ne++]=1,this.sprite.faces[ne++]=2,this.sprite.faces[ne++]=0,this.sprite.faces[ne++]=2,this.sprite.faces[ne++]=3,this.sprite.vertexBuffer=this.gl.createBuffer(),this.sprite.elementBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.sprite.vertexBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.sprite.vertices,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.sprite.elementBuffer),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.sprite.faces,this.gl.STATIC_DRAW),this.sprite.program=this.createProgram(Yr.sprite,this.precision||1),this.sprite.attributes={};const xe={};this.sprite.attributes.position=this.gl.getAttribLocation(this.sprite.program,"position"),this.sprite.attributes.uv=this.gl.getAttribLocation(this.sprite.program,"uv"),xe.uvOffset=this.gl.getUniformLocation(this.sprite.program,"uvOffset"),xe.uvScale=this.gl.getUniformLocation(this.sprite.program,"uvScale"),xe.rotation=this.gl.getUniformLocation(this.sprite.program,"rotation"),xe.scale=this.gl.getUniformLocation(this.sprite.program,"scale"),xe.alignment=this.gl.getUniformLocation(this.sprite.program,"alignment"),xe.color=this.gl.getUniformLocation(this.sprite.program,"color"),xe.map=this.gl.getUniformLocation(this.sprite.program,"map"),xe.opacity=this.gl.getUniformLocation(this.sprite.program,"opacity"),xe.useScreenCoordinates=this.gl.getUniformLocation(this.sprite.program,"useScreenCoordinates"),xe.screenPosition=this.gl.getUniformLocation(this.sprite.program,"screenPosition"),xe.modelViewMatrix=this.gl.getUniformLocation(this.sprite.program,"modelViewMatrix"),xe.projectionMatrix=this.gl.getUniformLocation(this.sprite.program,"projectionMatrix"),xe.fogNear=this.gl.getUniformLocation(this.sprite.program,"fogNear"),xe.fogFar=this.gl.getUniformLocation(this.sprite.program,"fogFar"),xe.fogColor=this.gl.getUniformLocation(this.sprite.program,"fogColor"),xe.alphaTest=this.gl.getUniformLocation(this.sprite.program,"alphaTest"),this.sprite.uniforms=xe}render(x,ne,xe,Ve,Le){var yt,lt,mt,Mt,Pt,Lt,gr,Yt,Er,Cr;if(!this.gl)throw new Error("WebGLRenderer not initialized");let Ur=[];(yt=x?.__webglSprites)===null||yt===void 0||yt.forEach(E=>{(Le&&E.material.depthTest==0||!Le&&E.material.depthTest)&&Ur.push(E)});let _r=Ur.length;if(!_r)return;const Lr=this.sprite.attributes,wr=this.sprite.uniforms;if(!wr)throw new Error("Uniforms not defined");var Mi=.5*xe,Qt=.5*Ve;this.gl.useProgram(this.sprite.program),this.gl.enableVertexAttribArray(Lr.position),this.gl.enableVertexAttribArray(Lr.uv),this.gl.disable(this.gl.CULL_FACE),this.gl.enable(this.gl.BLEND),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.sprite.vertexBuffer),this.gl.vertexAttribPointer(Lr.position,2,this.gl.FLOAT,!1,16,0),this.gl.vertexAttribPointer(Lr.uv,2,this.gl.FLOAT,!1,16,8),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.sprite.elementBuffer),this.gl.uniformMatrix4fv(wr.projectionMatrix,!1,ne.projectionMatrix.elements),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.uniform1i(wr.map,0);var ri,ae=x.fog;let i,s,l;ae?(this.gl.uniform3f(wr.fogColor,ae.color.r,ae.color.g,ae.color.b),this.gl.uniform1f(wr.fogNear,ae.near),this.gl.uniform1f(wr.fogFar,ae.far)):(this.gl.uniform1f(wr.fogNear,0),this.gl.uniform1f(wr.fogFar,0));let h=[];for(ri=0;ri<_r;ri++)i=Ur[ri],s=i.material,s&&(s.depthTest!=0||Le)&&i.visible&&s.opacity!==0&&(s.useScreenCoordinates?i.z=-i.position.z:(i._modelViewMatrix.multiplyMatrices(ne.matrixWorldInverse,i.matrixWorld),i.z=-i._modelViewMatrix.elements[14]));for(Ur.sort(ur),ri=0;ri<_r;ri++)if(i=Ur[ri],s=i.material,s&&i.visible&&s.opacity!==0&&s.map&&s.map.image&&s.map.image.width){this.gl.uniform1f(wr?.alphaTest||null,s.alphaTest);var A=s.map.image.width,g=s.map.image.height;h[0]=A*this.renderer.devicePixelRatio/xe,h[1]=g*this.renderer.devicePixelRatio/Ve,s.useScreenCoordinates===!0?(this.gl.uniform1i(wr.useScreenCoordinates,1),this.gl.uniform3f(wr.screenPosition,(i.position.x*this.renderer.devicePixelRatio-Mi)/Mi,(Qt-i.position.y*this.renderer.devicePixelRatio)/Qt,Math.max(0,Math.min(1,i.position.z)))):(this.gl.uniform1i(wr.useScreenCoordinates,0),this.gl.uniformMatrix4fv(wr.modelViewMatrix,!1,i._modelViewMatrix.elements)),l=1/(s.scaleByViewport?Ve:1),h[0]*=l*i.scale.x,h[1]*=l*i.scale.y;let E=(lt=s?.alignment)===null||lt===void 0?void 0:lt.x,M=(mt=s?.alignment)===null||mt===void 0?void 0:mt.y;s.screenOffset&&(E=(E||0)+2*s.screenOffset.x/A,M=(M||0)+2*s.screenOffset.y/g),this.gl.uniform2f(wr.uvScale,((Mt=s?.uvScale)===null||Mt===void 0?void 0:Mt.x)||1,((Pt=s?.uvScale)===null||Pt===void 0?void 0:Pt.y)||1),this.gl.uniform2f(wr.uvOffset,((Lt=s?.uvOffset)===null||Lt===void 0?void 0:Lt.x)||0,((gr=s?.uvOffset)===null||gr===void 0?void 0:gr.y)||0),this.gl.uniform2f(wr.alignment,E||0,M||0),this.gl.uniform1f(wr.opacity,s.opacity),this.gl.uniform3f(wr.color,((Yt=s?.color)===null||Yt===void 0?void 0:Yt.r)||0,((Er=s?.color)===null||Er===void 0?void 0:Er.g)||0,((Cr=s?.color)===null||Cr===void 0?void 0:Cr.b)||0),this.gl.uniform1f(wr.rotation,i.rotation),this.gl.uniform2fv(wr.scale,h),this.renderer.setDepthTest(s.depthTest),this.renderer.setDepthWrite(s.depthWrite),this.renderer.setTexture(s.map,0),this.gl.drawElements(this.gl.TRIANGLES,6,this.gl.UNSIGNED_SHORT,0)}this.gl.enable(this.gl.CULL_FACE)}createProgram(x,ne){if(!this.gl)throw new Error("WebGL Rendering context not found");var xe=this.gl.createProgram();if(!xe)throw new Error("Error creating webgl program");var Ve=this.gl.createShader(this.gl.FRAGMENT_SHADER),Le=this.gl.createShader(this.gl.VERTEX_SHADER);if(!Ve)throw new Error("Unable to create fragment shader SpritePlugin.createProgram");if(!Le)throw new Error("Unable to create vertex shader SpritePlugin.createProgram");var yt="precision "+ne+` float;
`;if(this.gl.shaderSource(Ve,yt+x.fragmentShader),this.gl.shaderSource(Le,yt+x.vertexShader),this.gl.compileShader(Ve),this.gl.compileShader(Le),!this.gl.getShaderParameter(Ve,this.gl.COMPILE_STATUS)||!this.gl.getShaderParameter(Le,this.gl.COMPILE_STATUS))throw new Error(`Error compiling shader: 
      ${this.gl.getShaderInfoLog(Ve)} 
      ${this.gl.getShaderInfoLog(Le)}`);return this.gl.attachShader(xe,Ve),this.gl.attachShader(xe,Le),this.gl.linkProgram(xe),this.gl.getProgramParameter(xe,this.gl.LINK_STATUS)||console.error("Could not initialize shader"),xe}}function ur(Bt,x){return Bt.z!==x.z?x.z-Bt.z:x.id-Bt.id}var Gr=null,Kr=null;class qi{constructor(x){this.context=null,this.devicePixelRatio=1,this.sortObjects=!0,this.autoUpdateObjects=!0,this.autoUpdateScene=!0,this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}},this._offscreen=null,this._bitmap=null,this._programs=[],this._programs_counter=0,this._webglversion=1,this._currentProgram=null,this._currentMaterialId=-1,this._currentGeometryGroupHash=null,this._currentCamera=null,this._geometryGroupCounter=0,this._oldDoubleSided=-1,this._oldFlipSided=-1,this._oldDepthTest=-1,this._oldDepthWrite=-1,this._oldPolygonOffset=null,this._oldLineWidth=null,this._viewportWidth=0,this._viewportHeight=0,this._currentWidth=0,this._currentHeight=0,this._enabledAttributes={},this._vector3=new m.Vector3,this._worldInverse=new m.Matrix4,this._projInverse=new m.Matrix4,this._textureMatrix=new m.Matrix4,this._fullProjModelMatrix=new m.Matrix4,this._fullProjModelMatrixInv=new m.Matrix4,this._direction=new m.Vector3,this._lightsNeedUpdate=!0,this._lights={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}},this.sprites=new on,this._screenshader=null,this._AOshader=null,this._blurshader=null,this._vertexattribpos=null,this._aovertexattribpos=null,this._blurvertexattribpos=null,this._screenQuadVBO=null,this._fb=null,this._targetTexture=null,this._depthTexture=null,this._shadingTexture=null,this._scratchTexture=null,this._upscale=null,this._AOstrength=1,this._AOradius=5,this.SHADE_TEXTURE=3,x=x||{},this.row=x.row,this.col=x.col,this.rows=x.rows,this.cols=x.cols,this._canvas=x.canvas!==void 0?x.canvas:document.createElement("canvas"),this._precision=x.precision!==void 0?x.precision:"highp",this._alpha=x.alpha===void 0||x.alpha,this._premultipliedAlpha=x.premultipliedAlpha===void 0||x.premultipliedAlpha,this._antialias=x.antialias!==void 0&&x.antialias,this._upscale=x.upscale!==void 0?x.upscale:this._antialias,this._preserveDrawingBuffer=x.preserveDrawingBuffer!==void 0&&x.preserveDrawingBuffer,this._clearColor=x.clearColor!==void 0?new V.Color(x.clearColor):new V.Color(0),this._clearAlpha=x.clearAlpha!==void 0?x.clearAlpha:0,this._outlineMaterial=new xr(x.outline),this._outlineSphereImposterMaterial=new Rr(x.outline),this._outlineStickImposterMaterial=new wi(x.outline),this._outlineEnabled=!!x.outline,this._AOEnabled=!!x.ambientOcclusion,x.ambientOcclusion&&x.ambientOcclusion.strength!==void 0&&(this._AOstrength=parseFloat(x.ambientOcclusion.strength)),this._AOstrength==0&&(this._AOEnabled=!1),x.ambientOcclusion&&x.ambientOcclusion.radius!==void 0&&(this._AOradius=parseFloat(x.ambientOcclusion.radius)),this.domElement=this._canvas,this._canvas.id=x.id,x.containerWidth!=0&&x.containerHeight!=0&&(this.initGL(),this.setDefaultGLState(),this.context=this._gl,this.isWebGL1()?this._extInstanced=this._gl.getExtension("ANGLE_instanced_arrays"):this._extInstanced={vertexAttribDivisorANGLE:this._gl.vertexAttribDivisor.bind(this._gl),drawElementsInstancedANGLE:this._gl.drawElementsInstanced.bind(this._gl)},this._extFragDepth=this._gl.getExtension("EXT_frag_depth"),this._extFloatLinear=this._gl.getExtension("OES_texture_float_linear"),this._extColorBufferFloat=this._gl.getExtension("EXT_color_buffer_float"),this.sprites.init(this))}supportedExtensions(){return{supportsAIA:!!this._extInstanced,supportsImposters:!!this._extFragDepth||!this.isWebGL1(),regen:!1}}getContext(){return this._gl}getCanvas(){return this._canvas}isLost(){return this._gl==null||this._gl.isContextLost()}getPrecision(){return this._precision}setClearColorHex(x,ne){this._clearColor.setHex(x),this._clearAlpha=ne,this.isLost()||this._gl.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearAlpha)}enableOutline(x){this._outlineMaterial=new xr(x),this._outlineSphereImposterMaterial=new Rr(x),this._outlineStickImposterMaterial=new wi(x),this._outlineEnabled=!0}disableOutline(){this._outlineEnabled=!1}enableAmbientOcclusion(x){x&&(x.strength&&(this._AOstrength=x.strength),x.scale&&(this._AOradius=x.scale)),this._AOEnabled=this._AOstrength>0}disableAmbientOcclusion(){this._AOEnabled=!1}setViewport(){if(this._offscreen&&(this._offscreen.width=this._canvas.width,this._offscreen.height=this._canvas.height),this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null&&!this.isLost()){var x=this._gl.drawingBufferWidth/this.cols,ne=this._gl.drawingBufferHeight/this.rows;this._viewportWidth=x,this._viewportHeight=ne,this._gl.enable(this._gl.SCISSOR_TEST),this._gl.scissor(x*this.col,ne*this.row,x,ne),this._gl.viewport(x*this.col,ne*this.row,x,ne)}}setSize(x,ne){this.devicePixelRatio=window.devicePixelRatio!==void 0?window.devicePixelRatio:1,this._upscale&&this.devicePixelRatio<2&&(this.devicePixelRatio=2),this._canvas.width=x*this.devicePixelRatio,this._canvas.height=ne*this.devicePixelRatio,this._canvas.style.width=x+"px",this._canvas.style.height=ne+"px",this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null?(this.isLost()||(this._viewportWidth=this._gl.drawingBufferWidth/this.cols,this._viewportHeight=this._gl.drawingBufferHeight/this.rows),this.setViewport()):(this._viewportWidth=this._canvas.width,this._viewportHeight=this._canvas.height,this.isLost()||this._gl.viewport(0,0,this._gl.drawingBufferWidth,this._gl.drawingBufferHeight)),this.initFrameBuffer()}clear(x,ne,xe){var Ve=0;(x===void 0||x)&&(Ve|=this._gl.COLOR_BUFFER_BIT),(ne===void 0||ne)&&(Ve|=this._gl.DEPTH_BUFFER_BIT),(xe===void 0||xe)&&(Ve|=this._gl.STENCIL_BUFFER_BIT),this._gl.clear(Ve)}setMaterialFaces(x,ne){var xe=x.side===u,Ve=x.side===D;x.imposter||(Ve=ne?!Ve:Ve),this._oldDoubleSided!==xe&&(xe?this._gl.disable(this._gl.CULL_FACE):this._gl.enable(this._gl.CULL_FACE),this._oldDoubleSided=xe),this._oldFlipSided!==Ve&&(Ve?this._gl.frontFace(this._gl.CW):this._gl.frontFace(this._gl.CCW),this._oldFlipSided=Ve),this._gl.cullFace(this._gl.BACK)}setDepthTest(x){this._oldDepthTest!==x&&(x?this._gl.enable(this._gl.DEPTH_TEST):this._gl.disable(this._gl.DEPTH_TEST),this._oldDepthTest=x)}setDepthWrite(x){this._oldDepthWrite!==x&&(this._gl.depthMask(x),this._oldDepthWrite=x)}setBlending(x){x?(this._gl.enable(this._gl.BLEND),this._gl.blendEquationSeparate(this._gl.FUNC_ADD,this._gl.FUNC_ADD),this._gl.blendFuncSeparate(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA)):this._gl.disable(this._gl.BLEND)}initMaterial(x,ne,xe,Ve){var Le,yt;if(x.addEventListener("dispose",this.onMaterialDispose.bind(this)),yt=x.shaderID){var lt=Yr[yt];x.vertexShader=lt.vertexShader,x.fragmentShader=lt.fragmentShader,x.uniforms=yi.clone(lt.uniforms),x.shaded&&x.makeShaded(this.SHADE_TEXTURE)}Le={wireframe:x.wireframe,fragdepth:x.imposter,volumetric:x.volumetric,shaded:x.shaded},x.program=this.buildProgram(x.fragmentShader,x.vertexShader,x.uniforms,Le)}renderBuffer(x,ne,xe,Ve,Le,yt){var lt,mt;if(Ve.visible&&(lt=this.setProgram(x,ne,xe,Ve,yt,this))){mt=lt.attributes;var Mt,Pt,Lt=!1,gr=Ve.wireframe?1:0,Yt=16777215*Le.id+2*lt.id+gr;if(Yt!==this._currentGeometryGroupHash&&(this._currentGeometryGroupHash=Yt,Lt=!0),Lt&&(this.disableAttributes(),mt.position>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,Le.__webglVertexBuffer),this.enableAttribute(mt.position),this._gl.vertexAttribPointer(mt.position,3,this._gl.FLOAT,!1,0,0)),mt.color>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,Le.__webglColorBuffer),this.enableAttribute(mt.color),this._gl.vertexAttribPointer(mt.color,3,this._gl.FLOAT,!1,0,0)),mt.normal>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,Le.__webglNormalBuffer),this.enableAttribute(mt.normal),this._gl.vertexAttribPointer(mt.normal,3,this._gl.FLOAT,!1,0,0)),mt.offset>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,Le.__webglOffsetBuffer),this.enableAttribute(mt.offset),this._gl.vertexAttribPointer(mt.offset,3,this._gl.FLOAT,!1,0,0)),mt.radius>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,Le.__webglRadiusBuffer),this.enableAttribute(mt.radius),this._gl.vertexAttribPointer(mt.radius,1,this._gl.FLOAT,!1,0,0))),yt instanceof Oe){if(Ve.shaderID==="instanced"){var Er=Ve.sphere.geometryGroups[0];Lt&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,Le.__webglVertexBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,Er.vertexArray,this._gl.STATIC_DRAW),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,Le.__webglNormalBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,Er.normalArray,this._gl.STATIC_DRAW),this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,Le.__webglFaceBuffer),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,Er.faceArray,this._gl.STATIC_DRAW)),Mt=Er.faceidx,this._extInstanced.vertexAttribDivisorANGLE(mt.offset,1),this._extInstanced.vertexAttribDivisorANGLE(mt.radius,1),this._extInstanced.vertexAttribDivisorANGLE(mt.color,1),this._extInstanced.drawElementsInstancedANGLE(this._gl.TRIANGLES,Mt,this._gl.UNSIGNED_SHORT,0,Le.radiusArray.length),this._extInstanced.vertexAttribDivisorANGLE(mt.offset,0),this._extInstanced.vertexAttribDivisorANGLE(mt.radius,0),this._extInstanced.vertexAttribDivisorANGLE(mt.color,0)}else Ve.wireframe?(Pt=Le.lineidx,this.setLineWidth(Ve.wireframeLinewidth),Lt&&this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,Le.__webglLineBuffer),this._gl.drawElements(this._gl.LINES,Pt,this._gl.UNSIGNED_SHORT,0)):(Mt=Le.faceidx,Lt&&this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,Le.__webglFaceBuffer),this._gl.drawElements(this._gl.TRIANGLES,Mt,this._gl.UNSIGNED_SHORT,0));this.info.render.calls++,this.info.render.vertices+=Mt,this.info.render.faces+=Mt/3}else yt instanceof Se&&(Pt=Le.vertices,this.setLineWidth(Ve.linewidth),this._gl.drawArrays(this._gl.LINES,0,Pt),this.info.render.calls++)}}clearShading(){this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this.clear(!1,!0,!1),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._depthTexture,0)}setShading(x,ne,xe){let Ve=x.__lights,Le=x.fog,yt=[];for(let Mt=0,Pt=x.__webglObjects.length;Mt<Pt;Mt++){let Lt=x.__webglObjects[Mt];Lt.render&&Lt[xe]&&yt.push(Lt)}if(yt.length==0)return;this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,null,0),this.renderObjects(x.__webglObjects,!0,xe+"Depth",ne,Ve,Le,!1),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._scratchTexture,0),this.clear(!1,!0,!1),this._gl.useProgram(this._AOshader),this._currentProgram=this._AOshader,this.setDepthTest(-1),this.setDepthWrite(-1);let lt=this._AOshader.uniforms;this._gl.uniform1f(lt.total_strength,this._AOstrength),this._gl.uniform1f(lt.radius,this._AOradius),this._fullProjModelMatrix=new m.Matrix4,this._fullProjModelMatrixInv=new m.Matrix4;let mt=yt[0].object;this._fullProjModelMatrix.multiplyMatrices(ne.projectionMatrix,mt._modelViewMatrix),this._fullProjModelMatrixInv.getInverse(this._fullProjModelMatrix),this._gl.uniformMatrix4fv(lt.projectionMatrix,!1,this._fullProjModelMatrix.elements),this._gl.uniformMatrix4fv(lt.projinv,!1,this._fullProjModelMatrixInv.elements),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.enableVertexAttribArray(this._aovertexattribpos),this._gl.vertexAttribPointer(this._aovertexattribpos,2,this._gl.FLOAT,!1,0,0),this._gl.activeTexture(this._gl.TEXTURE0),this._gl.bindTexture(this._gl.TEXTURE_2D,this._shadingTexture),this._gl.drawArrays(this._gl.TRIANGLES,0,6),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this.clear(!1,!0,!1),this._gl.useProgram(this._blurshader),this._currentProgram=this._blurshader,this.setDepthTest(-1),this.setDepthWrite(-1),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.enableVertexAttribArray(this._blurvertexattribpos),this._gl.vertexAttribPointer(this._blurvertexattribpos,2,this._gl.FLOAT,!1,0,0),this._gl.activeTexture(this._gl.TEXTURE0),this._gl.bindTexture(this._gl.TEXTURE_2D,this._scratchTexture),this._gl.drawArrays(this._gl.TRIANGLES,0,6),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,this._targetTexture,0),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._depthTexture,0)}render(x,ne){if(ne instanceof Wi==0)return void console.error("Renderer.render: camera is not an instance of Camera.");var xe,Ve,Le,yt,lt,mt=x.__lights,Mt=x.fog;if(this._currentMaterialId=-1,this._lightsNeedUpdate=!0,this.autoUpdateScene&&x.updateMatrixWorld(),ne.parent===void 0&&ne.updateMatrixWorld(),ne.matrixWorldInverse.getInverse(ne.matrixWorld),this.isLost())return;this.autoUpdateObjects&&this.initWebGLObjects(x),this.info.render.calls=0,this.info.render.vertices=0,this.info.render.faces=0,this.info.render.points=0,this._currentWidth=this._viewportWidth,this._currentHeight=this._viewportHeight,this.setViewport(),this.setFrameBuffer(),this._gl.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearAlpha),this.clear(!0,!0,!0),lt=x.__webglObjects;let Pt=!1,Lt=this._AOEnabled;for(xe=0,Ve=lt.length;xe<Ve;xe++)yt=(Le=lt[xe]).object,Le.render=!1,yt.visible&&(this.setupMatrices(yt,ne),this.unrollBufferMaterial(Le),Le.render=!0,Le.volumetric&&(Pt=!0),Le.hasAO&&(Lt=!0));if(this.setBlending(!1),Lt&&this.setShading(x,ne,"opaque"),this.renderObjects(x.__webglObjects,!0,"opaque",ne,mt,Mt,!1),Lt&&this.clearShading(),this.renderSprites(x,ne,!1),this.renderObjects(x.__webglObjects,!0,"transparentDepth",ne,mt,Mt,!0),this.renderObjects(x.__webglObjects,!1,"transparent",ne,mt,Mt,!0),Pt&&this._fb&&(this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,null,0),this.renderObjects(x.__webglObjects,!1,"volumetric",ne,mt,Mt,!0)),this.renderFrameBuffertoScreen(),this.setDepthTest(!0),this.setDepthWrite(!0),this.renderSprites(x,ne,!0),this._bitmap){const gr=this._offscreen.transferToImageBitmap();this._bitmap.transferFromImageBitmap(gr),gr.close()}}setFrameBuffer(){if(this.isWebGL1()||!this._fb)return;let x=this._viewportWidth,ne=this._viewportHeight;this._gl.enable(this._gl.SCISSOR_TEST),this._gl.scissor(0,0,x,ne),this._gl.viewport(0,0,x,ne),this._gl.bindTexture(this._gl.TEXTURE_2D,this._targetTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.RGBA,x,ne,0,this._gl.RGBA,this._gl.UNSIGNED_BYTE,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.LINEAR),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.LINEAR),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.bindTexture(this._gl.TEXTURE_2D,this._depthTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.DEPTH_COMPONENT32F,x,ne,0,this._gl.DEPTH_COMPONENT,this._gl.FLOAT,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._shadingTexture&&(this._gl.deleteTexture(this._shadingTexture),this._shadingTexture=this._gl.createTexture(),this._gl.bindTexture(this._gl.TEXTURE_2D,this._shadingTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.DEPTH_COMPONENT32F,x,ne,0,this._gl.DEPTH_COMPONENT,this._gl.FLOAT,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.deleteTexture(this._scratchTexture),this._scratchTexture=this._gl.createTexture(),this._gl.bindTexture(this._gl.TEXTURE_2D,this._scratchTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.DEPTH_COMPONENT32F,x,ne,0,this._gl.DEPTH_COMPONENT,this._gl.FLOAT,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE)),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,this._fb),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,this._targetTexture,0),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this._gl.clearDepth(1),this._gl.clear(this._gl.DEPTH_BUFFER_BIT),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._depthTexture,0)}initFrameBuffer(){if(this.isWebGL1())return;let x=this._viewportWidth,ne=this._viewportHeight;this._gl.enable(this._gl.SCISSOR_TEST),this._gl.scissor(0,0,x,ne),this._gl.viewport(0,0,x,ne),this._targetTexture=this._gl.createTexture(),this._depthTexture=this._gl.createTexture(),this._shadingTexture=this._gl.createTexture(),this._scratchTexture=this._gl.createTexture(),this._fb=this._gl.createFramebuffer();var xe=this._antialias?Yr.screenaa:Yr.screen;this._screenshader=this.buildProgram(xe.fragmentShader,xe.vertexShader,xe.uniforms,{}),this._vertexattribpos=this._gl.getAttribLocation(this._screenshader,"vertexPosition"),this._screenQuadVBO=this._gl.createBuffer(),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array([1,1,-1,1,-1,-1,-1,-1,1,-1,1,1]),this._gl.STATIC_DRAW);let Ve=Yr.ssao;this._AOshader=this.buildProgram(Ve.fragmentShader,Ve.vertexShader,Ve.uniforms,{}),this._aovertexattribpos=this._gl.getAttribLocation(this._AOshader,"vertexPosition");let Le=Yr.blur;this._blurshader=this.buildProgram(Le.fragmentShader,Le.vertexShader,Le.uniforms,{}),this._blurvertexattribpos=this._gl.getAttribLocation(this._blurshader,"vertexPosition")}renderFrameBuffertoScreen(){this.isWebGL1()||this._fb===null||(this.setViewport(),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null),this._gl.clear(this._gl.COLOR_BUFFER_BIT|this._gl.DEPTH_BUFFER_BIT),this._gl.frontFace(this._gl.CCW),this._gl.cullFace(this._gl.BACK),this._gl.useProgram(this._screenshader),this._currentProgram=this._screenshader,this.setDepthTest(-1),this.setDepthWrite(-1),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.enableVertexAttribArray(this._vertexattribpos),this._gl.vertexAttribPointer(this._vertexattribpos,2,this._gl.FLOAT,!1,0,0),this._gl.activeTexture(this._gl.TEXTURE0),this._gl.bindTexture(this._gl.TEXTURE_2D,this._targetTexture),this._gl.drawArrays(this._gl.TRIANGLES,0,6))}initWebGLObjects(x){if(x.__webglObjects||(x.__webglObjects=[],x.__webglObjectsImmediate=[],x.__webglSprites=[],x.__webglFlares=[]),x.__objectsAdded.length){for(;x.__objectsAdded.length;)this.addObject(x.__objectsAdded[0],x),x.__objectsAdded.splice(0,1);this._currentGeometryGroupHash=-1}for(;x.__objectsRemoved.length;)this.removeObject(x.__objectsRemoved[0],x),x.__objectsRemoved.splice(0,1);for(var ne=0,xe=x.__webglObjects.length;ne<xe;ne++)this.updateObject(x.__webglObjects[ne].object)}getYRatio(){return this.rows!==void 0&&this.row!==void 0?this.rows:1}getXRatio(){return this.cols!==void 0&&this.col!==void 0?this.cols:1}getAspect(x,ne){x!=null&&ne!=null||(x=this._canvas.width,ne=this._canvas.height);var xe=x/ne;return this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null&&(xe=x/this.cols/(ne/this.rows)),xe}setTexture(x,ne,xe){if(x.needsUpdate){x.__webglInit||(x.__webglInit=!0,x.addEventListener("dispose",this.onTextureDispose.bind(this)),x.__webglTexture=this._gl.createTexture(),this.info.memory.textures++),this._gl.activeTexture(this._gl.TEXTURE0+ne);var Ve=xe?this._gl.TEXTURE_3D:this._gl.TEXTURE_2D;this._gl.bindTexture(Ve,x.__webglTexture),this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL,x.flipY),this._gl.pixelStorei(this._gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,x.premultiplyAlpha),this._gl.pixelStorei(this._gl.UNPACK_ALIGNMENT,x.unpackAlignment),this._gl.pixelStorei(this._gl.PACK_ALIGNMENT,x.unpackAlignment);var Le=this.paramToGL(x.format),yt=this.paramToGL(x.type);if(xe)this.setTextureParameters(this._gl.TEXTURE_3D,x),this._gl.texImage3D(this._gl.TEXTURE_3D,0,this._gl.R32F,x.image.size.z,x.image.size.y,x.image.size.x,0,this._gl.RED,this._gl.FLOAT,x.image.data);else{var lt=x.image,mt=lt.width,Mt=lt.height;mt===void 0&&(mt=lt.length,Le==this._gl.RGBA&&(mt/=4),Mt=1),this.setTextureParameters(this._gl.TEXTURE_2D,x),this.isWebGL1()?this._gl.texImage2D(this._gl.TEXTURE_2D,0,Le,Le,yt,x.image):this._gl.texImage2D(this._gl.TEXTURE_2D,0,Le,mt,Mt,0,Le,yt,x.image)}x.needsUpdate=!1,x.onUpdate&&x.onUpdate()}else this._gl.activeTexture(this._gl.TEXTURE0+ne),xe?this._gl.bindTexture(this._gl.TEXTURE_3D,x.__webglTexture):this._gl.bindTexture(this._gl.TEXTURE_2D,x.__webglTexture)}supportsVolumetric(){return!this.isWebGL1()}enableAttribute(x){this._enabledAttributes[x]||(this._gl.enableVertexAttribArray(x),this._enabledAttributes[x]=!0)}disableAttributes(){for(let x in this._enabledAttributes)this._enabledAttributes[x]&&(this._gl.disableVertexAttribArray(x),this._enabledAttributes[x]=!1)}setPolygonOffset(x,ne,xe){this._oldPolygonOffset!==x&&(x?this._gl.enable(this._gl.POLYGON_OFFSET_FILL):this._gl.disable(this._gl.POLYGON_OFFSET_FILL))}setLineWidth(x){x!==this._oldLineWidth&&(this._gl.lineWidth(x),this._oldLineWidth=x)}deallocateGeometry(x){if(x.__webglInit=void 0,x.__webglVertexBuffer!==void 0&&this._gl.deleteBuffer(x.__webglVertexBuffer),x.__webglColorBuffer!==void 0&&this._gl.deleteBuffer(x.__webglColorBuffer),x.geometryGroups!==void 0)for(var ne=0,xe=x.groups;ne<xe;ne++){var Ve=x.geometryGroups[ne];Ve.__webglVertexBuffer!==void 0&&this._gl.deleteBuffer(Ve.__webglVertexBuffer),Ve.__webglColorBuffer!==void 0&&this._gl.deleteBuffer(Ve.__webglColorBuffer),Ve.__webglNormalBuffer!==void 0&&this._gl.deleteBuffer(Ve.__webglNormalBuffer),Ve.__webglFaceBuffer!==void 0&&this._gl.deleteBuffer(Ve.__webglFaceBuffer),Ve.__webglLineBuffer!==void 0&&this._gl.deleteBuffer(Ve.__webglLineBuffer)}}deallocateMaterial(x){var ne=x.program;if(ne!==void 0){var xe,Ve,Le;x.program=void 0;var yt=!1;for(xe=0,Ve=this._programs.length;xe<Ve;xe++)if((Le=this._programs[xe]).program===ne){Le.usedTimes--,Le.usedTimes===0&&(yt=!0);break}if(yt===!0){var lt=[];for(xe=0,Ve=this._programs.length;xe<Ve;xe++)(Le=this._programs[xe]).program!==ne&&lt.push(Le);this._programs=lt,this._gl.deleteProgram(ne),this.info.memory.programs--}}}deallocateTexture(x){if(x.image&&x.image.__webglTextureCube)this._gl.deleteTexture(x.image.__webglTextureCube);else{if(!x.__webglInit)return;x.__webglInit=!1,this._gl.deleteTexture(x.__webglTexture)}}onGeometryDispose(x){var ne=x.target;ne.removeEventListener("dispose",this.onGeometryDispose),this.deallocateGeometry(ne),this.info.memory.geometries--}onTextureDispose(x){var ne=x.target;ne.removeEventListener("dispose",this.onTextureDispose),this.deallocateTexture(ne),this.info.memory.textures--}onMaterialDispose(x){var ne=x.target;ne.removeEventListener("dispose",this.onMaterialDispose),this.deallocateMaterial(ne)}getShader(x,ne){var xe;return this.isWebGL1()||ne.startsWith("#version")||(ne=ne.replace(/gl_FragDepthEXT/g,"gl_FragDepth"),ne=`#version 300 es
`+(ne=(ne=(ne=(ne=(ne=x=="fragment"?ne.replace(/varying/g,"in"):ne.replace(/varying/g,"out")).replace(/attribute/g,"in")).replace(/texture2D/g,"texture")).replace(/\/\/DEFINEFRAGCOLOR/g,"out vec4 glFragColor;")).replace(/gl_FragColor/g,"glFragColor"))),x==="fragment"?xe=this._gl.createShader(this._gl.FRAGMENT_SHADER):x==="vertex"&&(xe=this._gl.createShader(this._gl.VERTEX_SHADER)),xe==null?null:(this._gl.shaderSource(xe,ne),this._gl.compileShader(xe),this._gl.getShaderParameter(xe,this._gl.COMPILE_STATUS)?xe:(console.error(this._gl.getShaderInfoLog(xe)),console.error("could not initialize shader"),null))}buildProgram(x,ne,xe,Ve){var Le,yt,lt,mt,Mt=[];for(Le in Mt.push(x),Mt.push(ne),Ve)Mt.push(Le),Mt.push(Ve[Le]);for(mt=Mt.join(),Le=0,yt=this._programs.length;Le<yt;Le++){var Pt=this._programs[Le];if(Pt.code===mt)return Pt.usedTimes++,Pt.program}if(this.isWebGL1()&&Ve.volumetric)throw new Error("Volumetric rendering requires webgl2 which is not supported by your hardware.");if((lt=this._gl.createProgram())==null)return null;var Lt,gr,Yt,Er="precision "+this._precision+" float;",Cr=[Ve.volumetric?"#version 300 es":"",Er].join(`
`),Ur=[Ve.volumetric?"#version 300 es":"",Ve.fragdepth&&this.isWebGL1()?"#extension GL_EXT_frag_depth: enable":"",Ve.shaded?"#define SHADED 1":"",Ve.wireframe?"#define WIREFRAME 1":"",Er].join(`
`),_r=this.getShader("fragment",Ur+x),Lr=this.getShader("vertex",Cr+ne);for(gr in Lr!=null&&this._gl.attachShader(lt,Lr),_r!=null&&this._gl.attachShader(lt,_r),this._gl.linkProgram(lt),this._gl.getProgramParameter(lt,this._gl.LINK_STATUS)||console.error("Could not initialize shader"),lt.uniforms={},lt.attributes={},Lt=["viewMatrix","modelViewMatrix","projectionMatrix","normalMatrix","vWidth","vHeight"],xe)Lt.push(gr);for(Yt=0;Yt<Lt.length;Yt++){var wr=Lt[Yt];lt.uniforms[wr]=this._gl.getUniformLocation(lt,wr)}for(Lt=["position","normal","color","lineDistance","offset","radius"],Yt=0;Yt<Lt.length;Yt++){var Mi=Lt[Yt];lt.attributes[Mi]=this._gl.getAttribLocation(lt,Mi)}return lt.id=this._programs_counter++,this._programs.push({program:lt,code:mt,usedTimes:1}),this.info.memory.programs=this._programs.length,lt}setProgram(x,ne,xe,Ve,Le,yt){if(Ve.needsUpdate&&(Ve.program&&this.deallocateMaterial(Ve),this.initMaterial(Ve,ne,xe,Le),Ve.needsUpdate=!1),Ve.program==null)return null;var lt=!1,mt=Ve.program,Mt=mt.uniforms,Pt=Ve.uniforms;if(mt!=this._currentProgram&&(this._gl.useProgram(mt),this._currentProgram=mt,lt=!0),Ve.id!=this._currentMaterialId&&(this._currentMaterialId=Ve.id,lt=!0),x!=this._currentCamera&&(this._currentCamera=x,lt=!0),Mt.projectionMatrix&&this._gl.uniformMatrix4fv(Mt.projectionMatrix,!1,x.projectionMatrix.elements),Mt.modelViewMatrix&&this._gl.uniformMatrix4fv(Mt.modelViewMatrix,!1,Le._modelViewMatrix.elements),Mt.normalMatrix&&this._gl.uniformMatrix3fv(Mt.normalMatrix,!1,Le._normalMatrix.elements),Mt.projinv&&(this._projInverse.getInverse(x.projectionMatrix),this._gl.uniformMatrix4fv(Mt.projinv,!1,this._projInverse.elements)),Mt.viewMatrix&&this._gl.uniformMatrix4fv(Mt.viewMatrix,!1,x.matrixWorldInverse.elements),Mt.vWidth&&this._gl.uniform1f(Mt.vWidth,this._viewportWidth),Mt.vHeight&&this._gl.uniform1f(Mt.vHeight,this._viewportHeight),lt){if(Pt.fogColor.value=xe.color,Pt.fogNear.value=xe.near,Pt.fogFar.value=xe.far,Ve.shaderID.startsWith("lambert")||Ve.shaderID==="instanced"||Ve.shaderID.endsWith("imposter"))this._lightsNeedUpdate&&(this.setupLights(mt,ne),this._lightsNeedUpdate=!1),Pt.directionalLightColor.value=this._lights.directional.colors,Pt.directionalLightDirection.value=this._lights.directional.positions;else if(Ve.shaderID.endsWith("outline"))Pt.outlineColor.value=Ve.outlineColor,Pt.outlineWidth.value=Ve.outlineWidth,Pt.outlinePushback.value=Ve.outlinePushback,Pt.outlineMaxPixels.value=Ve.outlineMaxPixels*this.devicePixelRatio;else if(Ve.shaderID==="volumetric"){Le._modelViewMatrix.getScale(this._direction),this._worldInverse.getInverse(Le._modelViewMatrix),this._projInverse.getInverse(x.projectionMatrix),this._textureMatrix.multiplyMatrices(Le.material.texmatrix,this._worldInverse),this._gl.uniformMatrix4fv(Mt.textmat,!1,this._textureMatrix.elements),this._gl.uniformMatrix4fv(Mt.projinv,!1,this._projInverse.elements);let Lt=Math.min(Math.min(this._direction.x,this._direction.y),this._direction.z);Pt.step.value=Le.material.unit*Lt,Pt.maxdepth.value=Le.material.maxdepth*Lt,Pt.transfermax.value=Le.material.transfermax,Pt.transfermin.value=Le.material.transfermin,Pt.subsamples.value=Le.material.subsamples,yt.setTexture(Le.material.transferfn,4,!1),yt.setTexture(Le.material.map,3,!0),this._gl.activeTexture(this._gl.TEXTURE5),this._gl.bindTexture(this._gl.TEXTURE_2D,this._depthTexture)}Pt.opacity.value=Ve.opacity,this.loadMaterialUniforms(Mt,Pt)}return Pt.shading&&(Pt.shading.value==3?(this._gl.activeTexture(this._gl.TEXTURE0+this.SHADE_TEXTURE),this._gl.bindTexture(this._gl.TEXTURE_2D,this._shadingTexture)):console.error("Invalid shading textures.")),mt}loadMaterialUniforms(x,ne){var xe,Ve,Le,yt;for(xe in ne)x[xe]&&(Ve=ne[xe].type,Le=ne[xe].value,yt=x[xe],Ve==="f"?this._gl.uniform1f(yt,Le):Ve==="i"?this._gl.uniform1i(yt,Le):Ve==="fv"?this._gl.uniform3fv(yt,Le):Ve==="c"?this._gl.uniform3f(yt,Le.r,Le.g,Le.b):Ve==="f4"&&this._gl.uniform4f(yt,Le[0],Le[1],Le[2],Le[3]))}addObject(x,ne){var xe,Ve,Le,yt;if(!x.__webglInit&&(x.__webglInit=!0,x._modelViewMatrix=new m.Matrix4,x._normalMatrix=new m.Matrix3,x.geometry!==void 0&&x.geometry.__webglInit===void 0&&(x.geometry.__webglInit=!0,x.geometry.addEventListener("dispose",this.onGeometryDispose.bind(this))),x instanceof Oe||x instanceof Se))for(xe=0,Ve=(Le=x.geometry).geometryGroups.length;xe<Ve;xe++)(yt=Le.geometryGroups[xe]).id=this._geometryGroupCounter++,yt.__webglVertexBuffer||(x instanceof Oe?(this.createMeshBuffers(yt),Le.elementsNeedUpdate=!0,Le.normalsNeedUpdate=!0):x instanceof Se&&this.createLineBuffers(yt),Le.verticesNeedUpdate=!0,Le.colorsNeedUpdate=!0);if(!x.__webglActive){if(x instanceof Oe||x instanceof Se)for(xe=0,Ve=(Le=x.geometry).geometryGroups.length;xe<Ve;xe++)yt=Le.geometryGroups[xe],this.addBuffer(ne.__webglObjects,yt,x);else x instanceof dt&&ne.__webglSprites.push(x);x.__webglActive=!0}}updateObject(x){var ne,xe=x.geometry;if(x instanceof Oe||x instanceof Se){for(var Ve=0,Le=xe.geometryGroups.length;Ve<Le;Ve++)ne=xe.geometryGroups[Ve],(xe.verticesNeedUpdate||xe.elementsNeedUpdate||xe.colorsNeedUpdate||xe.normalsNeedUpdate)&&this.setBuffers(ne,this._gl.STATIC_DRAW);xe.verticesNeedUpdate=!1,xe.elementsNeedUpdate=!1,xe.normalsNeedUpdate=!1,xe.colorsNeedUpdate=!1,xe.buffersNeedUpdate=!1}}removeObject(x,ne){x instanceof Oe||x instanceof Se?this.removeInstances(ne.__webglObjects,x):x instanceof dt&&this.removeInstancesDirect(ne.__webglSprites,x),x.__webglActive=!1}removeInstances(x,ne){for(var xe=x.length-1;xe>=0;--xe)x[xe].object===ne&&x.splice(xe,1)}removeInstancesDirect(x,ne){for(var xe=x.length-1;xe>=0;--xe)x[xe]===ne&&x.splice(xe,1)}unrollBufferMaterial(x){var ne=x.object.material;if(ne.volumetric)x.opaque=null,x.transparent=null,x.volumetric=ne;else if(ne.transparent){if(x.opaque=null,x.volumetric=null,x.transparent=ne,!ne.wireframe){let xe=ne.clone();xe.opacity=0,x.transparentDepth=xe}}else{if(x.opaque=ne,x.transparent=null,x.volumetric=null,!ne.wireframe){let xe=ne.clone();xe.opacity=0,x.opaqueDepth=xe}ne.hasAO&&(x.hasAO=!0),(this._AOEnabled||x.hasAO)&&(x.opaqueShaded=ne.clone(),x.opaqueShaded.shaded=!0)}}setBuffers(x,ne){var xe=x.vertexArray,Ve=x.colorArray;if(x.__webglOffsetBuffer!==void 0?(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,x.__webglOffsetBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,xe,ne)):(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,x.__webglVertexBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,xe,ne)),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,x.__webglColorBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,Ve,ne),x.normalArray&&x.__webglNormalBuffer!==void 0){var Le=x.normalArray;this._gl.bindBuffer(this._gl.ARRAY_BUFFER,x.__webglNormalBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,Le,ne)}if(x.radiusArray&&x.__webglRadiusBuffer!==void 0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,x.__webglRadiusBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,x.radiusArray,ne)),x.faceArray&&x.__webglFaceBuffer!==void 0){var yt=x.faceArray;this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,x.__webglFaceBuffer),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,yt,ne)}if(x.lineArray&&x.__webglLineBuffer!==void 0){var lt=x.lineArray;this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,x.__webglLineBuffer),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,lt,ne)}}createMeshBuffers(x){x.radiusArray&&(x.__webglRadiusBuffer=this._gl.createBuffer()),x.useOffset&&(x.__webglOffsetBuffer=this._gl.createBuffer()),x.__webglVertexBuffer=this._gl.createBuffer(),x.__webglNormalBuffer=this._gl.createBuffer(),x.__webglColorBuffer=this._gl.createBuffer(),x.__webglFaceBuffer=this._gl.createBuffer(),x.__webglLineBuffer=this._gl.createBuffer(),this.info.memory.geometries++}createLineBuffers(x){x.__webglVertexBuffer=this._gl.createBuffer(),x.__webglColorBuffer=this._gl.createBuffer(),this.info.memory.geometries++}addBuffer(x,ne,xe){x.push({buffer:ne,object:xe,opaque:null,transparent:null})}setupMatrices(x,ne){x._modelViewMatrix.multiplyMatrices(ne.matrixWorldInverse,x.matrixWorld),x._normalMatrix.getInverse(x._modelViewMatrix),x._normalMatrix.transpose()}filterFallback(x){return this._gl.LINEAR}setTextureParameters(x,ne){x==this._gl.TEXTURE_2D?(this._gl.texParameteri(x,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(x,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(x,this._gl.TEXTURE_MAG_FILTER,this.filterFallback(ne.magFilter)),this._gl.texParameteri(x,this._gl.TEXTURE_MIN_FILTER,this.filterFallback(ne.minFilter))):(this._gl.texParameteri(x,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(x,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(x,this._gl.TEXTURE_WRAP_R,this._gl.CLAMP_TO_EDGE),this._extColorBufferFloat&&this._extFloatLinear?(this._gl.texParameteri(x,this._gl.TEXTURE_MAG_FILTER,this._gl.LINEAR),this._gl.texParameteri(x,this._gl.TEXTURE_MIN_FILTER,this._gl.LINEAR)):(this._gl.texParameteri(x,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(x,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST)))}paramToGL(x){return x===T?this._gl.UNSIGNED_BYTE:x===Q?this._gl.RGBA:x===k?this._gl.NEAREST:0}setupLights(x,ne){var xe,Ve,Le,yt,lt,mt=this._lights,Mt=mt.directional.colors,Pt=mt.directional.positions,Lt=0,gr=0;for(xe=0,Ve=ne.length;xe<Ve;xe++)if(yt=(Le=ne[xe]).color,lt=Le.intensity,Le instanceof I){if(this._direction.getPositionFromMatrix(Le.matrixWorld),this._vector3.getPositionFromMatrix(Le.target.matrixWorld),this._direction.sub(this._vector3),this._direction.normalize(),this._direction.x===0&&this._direction.y===0&&this._direction.z===0)continue;Pt[gr]=this._direction.x,Pt[gr+1]=this._direction.y,Pt[gr+2]=this._direction.z,Mt[gr]=yt.r*lt,Mt[gr+1]=yt.g*lt,Mt[gr+2]=yt.b*lt,gr+=3,Lt++}mt.ambient[0]=0,mt.ambient[1]=0,mt.ambient[2]=0,mt.directional.length=Lt}initGL(){try{if(!OffscreenCanvas||this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null){if(!(this._gl=this._canvas.getContext("webgl2",{alpha:this._alpha,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer}))&&!(this._gl=this._canvas.getContext("experimental-webgl",{alpha:this._alpha,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer}))&&!(this._gl=this._canvas.getContext("webgl",{alpha:this._alpha,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer})))throw"Error creating WebGL context."}else(Kr==null||Kr.isContextLost())&&(Gr=new OffscreenCanvas(this._canvas.width,this._canvas.height),Kr=Gr.getContext("webgl2",{alpha:!0,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer})),this._offscreen=Gr,this._gl=Kr,this._bitmap=this._canvas.getContext("bitmaprenderer",{alpha:!0});var x=this._gl.getParameter(this._gl.VERSION);this._webglversion=parseInt(x[6])}catch(ne){console.error(ne)}}isWebGL1(){return this._webglversion==1}setDefaultGLState(){this._gl.clearDepth(1),this._gl.clearStencil(0),this._gl.enable(this._gl.DEPTH_TEST),this._gl.depthFunc(this._gl.LEQUAL),this._gl.frontFace(this._gl.CCW),this._gl.cullFace(this._gl.BACK),this._gl.enable(this._gl.CULL_FACE),this._gl.enable(this._gl.BLEND),this._gl.blendEquation(this._gl.FUNC_ADD),this._gl.blendFunc(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA),this._gl.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearAlpha)}renderObjects(x,ne,xe,Ve,Le,yt,lt){var mt,Mt,Pt,Lt,gr,Yt,Er;ne?(gr=x.length-1,Yt=-1,Er=-1):(gr=0,Yt=x.length,Er=1);for(var Cr=gr;Cr!==Yt;Cr+=Er)if((mt=x[Cr]).render){if(Mt=mt.object,Pt=mt.buffer,Lt=mt[xe],(mt.hasAO||this._AOEnabled)&&mt[xe+"Shaded"]&&(Lt=mt[xe+"Shaded"]),!Lt)continue;this.setBlending(lt),this.setDepthTest(Lt.depthTest),this.setDepthWrite(Lt.depthWrite),this.setPolygonOffset(Lt.polygonOffset,Lt.polygonOffsetFactor,Lt.polygonOffsetUnits);var Ur=Mt._modelViewMatrix.isReflected();if(this.setMaterialFaces(Lt,Ur),this.renderBuffer(Ve,Le,yt,Lt,Pt,Mt),(this._outlineEnabled||Lt.outline)&&!Lt.wireframe&&Lt.shaderID!=="basic"&&Lt.opacity!==0){let _r=this._outlineMaterial;Lt.shaderID=="sphereimposter"?_r=this._outlineSphereImposterMaterial:Lt.shaderID=="stickimposter"&&(_r=this._outlineStickImposterMaterial),this.renderBuffer(Ve,Le,yt,_r,Pt,Mt)}}}renderSprites(x,ne,xe){this._currentGeometryGroupHash=-1,this._currentProgram=null,this._currentCamera=null,this._oldDepthWrite=-1,this._oldDepthTest=-1,this._oldDoubleSided=-1,this._currentMaterialId=-1,this._oldFlipSided=-1,this._lightsNeedUpdate=!0,this.sprites.render(x,ne,this._currentWidth,this._currentHeight,xe),this._currentGeometryGroupHash=-1,this._currentProgram=null,this._currentCamera=null,this._oldDepthWrite=-1,this._oldDepthTest=-1,this._oldDoubleSided=-1,this._currentMaterialId=-1,this._oldFlipSided=-1}}},392:(r,n,a)=>{a.r(n),a.d(n,{assignBonds:()=>u});var c=a(408);const p=[{x:0,y:0,z:1},{x:0,y:1,z:-1},{x:0,y:1,z:0},{x:0,y:1,z:1},{x:1,y:-1,z:-1},{x:1,y:-1,z:0},{x:1,y:-1,z:1},{x:1,y:0,z:-1},{x:1,y:0,z:0},{x:1,y:0,z:1},{x:1,y:1,z:-1},{x:1,y:1,z:0},{x:1,y:1,z:1}],D=4.95;function u(v,m){for(let w=0,k=v.length;w<k;w++)v[w].index||(v[w].index=w);const _={x:{y:{z:[]}}};for(let w=0;w<v.length;w++){const k=v[w],F=Math.floor(k.x/D),T=Math.floor(k.y/D),z=Math.floor(k.z/D);_[F]||(_[F]={}),_[F][T]||(_[F][T]={}),_[F][T][z]||(_[F][T][z]=[]),_[F][T][z].push(k)}function C(w,k){for(let F=0;F<w.length;F++){const T=w[F];for(let z=0;z<k.length;z++){const Q=k[z];if((0,c.areConnected)(T,Q,m)){const J=T.bonds.indexOf(Q.index),K=Q.bonds.indexOf(T.index);J===-1&&K===-1?(T.bonds.push(Q.index),T.bondOrder.push(1),Q.bonds.push(T.index),Q.bondOrder.push(1)):J===-1?(T.bonds.push(Q.index),T.bondOrder.push(Q.bondOrder[K])):K===-1&&(Q.bonds.push(T.index),Q.bondOrder.push(T.bondOrder[J]))}}}}for(let w in _){const k=parseInt(w);for(let F in _[k]){const T=parseInt(F);for(let z in _[k][T]){const Q=parseInt(z),J=_[k][T][Q];for(let K=0;K<J.length;K++){const b=J[K];for(let N=K+1;N<J.length;N++){const V=J[N];(0,c.areConnected)(b,V,m)&&b.bonds.indexOf(V.index)==-1&&(b.bonds.push(V.index),b.bondOrder.push(1),V.bonds.push(b.index),V.bondOrder.push(1))}}for(let K=0;K<p.length;K++){const b=p[K];_[k+b.x]&&_[k+b.x][T+b.y]&&_[k+b.x][T+b.y][Q+b.z]&&C(J,_[k+b.x][T+b.y][Q+b.z])}}}}}},407:r=>{var n=(function(){for(var a,c=[],p=0;p<256;p++){a=p;for(var D=0;D<8;D++)a=1&a?3988292384^a>>>1:a>>>1;c[p]=a}return c})();r.exports=function(a,c,p,D){var u=n,v=D+p;a^=-1;for(var m=D;m<v;m++)a=a>>>8^u[255&(a^c[m])];return-1^a}},408:(r,n,a)=>{a.r(n),a.d(n,{areConnected:()=>D});var c=a(40);const p=new Set(["Na","K","Ca","Mg","Mn","Sr"]);function D(u,v,m){if(m&&m.unboundCations&&(p.has(u.elem)||p.has(v.elem)))return!1;let _=(0,c.bondLength)(u.elem)+(0,c.bondLength)(v.elem);_+=.25,_*=_;let C=u.x-v.x;if(C*=C,C>_)return!1;let w=u.y-v.y;if(w*=w,w>_)return!1;let k=u.z-v.z;if(k*=k,k>_)return!1;const F=C+w+k;return!(isNaN(F)||F<.5||F>_||u.altLoc!==v.altLoc&&u.altLoc.trim()!==""&&v.altLoc.trim()!=="")}},471:function(r,n){(function(a){function c(pe,Se,Oe){for(var dt=(pe.byteLength,0),nt=Oe.length;nt>dt;dt++){var zt=Oe.charCodeAt(dt);if(128>zt)pe.setUint8(Se++,zt>>>0&127);else if(2048>zt)pe.setUint8(Se++,zt>>>6&31|192),pe.setUint8(Se++,zt>>>0&63|128);else if(65536>zt)pe.setUint8(Se++,zt>>>12&15|224),pe.setUint8(Se++,zt>>>6&63|128),pe.setUint8(Se++,zt>>>0&63|128);else{if(!(1114112>zt))throw new Error("bad codepoint "+zt);pe.setUint8(Se++,zt>>>18&7|240),pe.setUint8(Se++,zt>>>12&63|128),pe.setUint8(Se++,zt>>>6&63|128),pe.setUint8(Se++,zt>>>0&63|128)}}}function p(pe){for(var Se=0,Oe=0,dt=pe.length;dt>Oe;Oe++){var nt=pe.charCodeAt(Oe);if(128>nt)Se+=1;else if(2048>nt)Se+=2;else if(65536>nt)Se+=3;else{if(!(1114112>nt))throw new Error("bad codepoint "+nt);Se+=4}}return Se}function D(pe,Se,Oe){var dt=typeof pe;if(dt==="string"){if(32>(nt=p(pe)))return Se.setUint8(Oe,160|nt),c(Se,Oe+1,pe),1+nt;if(256>nt)return Se.setUint8(Oe,217),Se.setUint8(Oe+1,nt),c(Se,Oe+2,pe),2+nt;if(65536>nt)return Se.setUint8(Oe,218),Se.setUint16(Oe+1,nt),c(Se,Oe+3,pe),3+nt;if(4294967296>nt)return Se.setUint8(Oe,219),Se.setUint32(Oe+1,nt),c(Se,Oe+5,pe),5+nt}if(pe instanceof Uint8Array){var nt=pe.byteLength,zt=new Uint8Array(Se.buffer);if(256>nt)return Se.setUint8(Oe,196),Se.setUint8(Oe+1,nt),zt.set(pe,Oe+2),2+nt;if(65536>nt)return Se.setUint8(Oe,197),Se.setUint16(Oe+1,nt),zt.set(pe,Oe+3),3+nt;if(4294967296>nt)return Se.setUint8(Oe,198),Se.setUint32(Oe+1,nt),zt.set(pe,Oe+5),5+nt}if(dt==="number"){if(!isFinite(pe))throw new Error("Number not finite: "+pe);if(Math.floor(pe)!==pe)return Se.setUint8(Oe,203),Se.setFloat64(Oe+1,pe),9;if(pe>=0){if(128>pe)return Se.setUint8(Oe,pe),1;if(256>pe)return Se.setUint8(Oe,204),Se.setUint8(Oe+1,pe),2;if(65536>pe)return Se.setUint8(Oe,205),Se.setUint16(Oe+1,pe),3;if(4294967296>pe)return Se.setUint8(Oe,206),Se.setUint32(Oe+1,pe),5;throw new Error("Number too big 0x"+pe.toString(16))}if(pe>=-32)return Se.setInt8(Oe,pe),1;if(pe>=-128)return Se.setUint8(Oe,208),Se.setInt8(Oe+1,pe),2;if(pe>=-32768)return Se.setUint8(Oe,209),Se.setInt16(Oe+1,pe),3;if(pe>=-2147483648)return Se.setUint8(Oe,210),Se.setInt32(Oe+1,pe),5;throw new Error("Number too small -0x"+(-pe).toString(16).substr(1))}if(pe===null)return Se.setUint8(Oe,192),1;if(dt==="boolean")return Se.setUint8(Oe,pe?195:194),1;if(dt==="object"){var ht=0,Ot=Array.isArray(pe);if(Ot)nt=pe.length;else{var Ut=Object.keys(pe);nt=Ut.length}if(16>nt?(Se.setUint8(Oe,nt|(Ot?144:128)),ht=1):65536>nt?(Se.setUint8(Oe,Ot?220:222),Se.setUint16(Oe+1,nt),ht=3):4294967296>nt&&(Se.setUint8(Oe,Ot?221:223),Se.setUint32(Oe+1,nt),ht=5),Ot)for(var It=0;nt>It;It++)ht+=D(pe[It],Se,Oe+ht);else for(It=0;nt>It;It++){var mr=Ut[It];ht+=D(mr,Se,Oe+ht),ht+=D(pe[mr],Se,Oe+ht)}return ht}throw new Error("Unknown type "+dt)}function u(pe){var Se=typeof pe;if(Se==="string"){if(32>(Oe=p(pe)))return 1+Oe;if(256>Oe)return 2+Oe;if(65536>Oe)return 3+Oe;if(4294967296>Oe)return 5+Oe}if(pe instanceof Uint8Array){if(256>(Oe=pe.byteLength))return 2+Oe;if(65536>Oe)return 3+Oe;if(4294967296>Oe)return 5+Oe}if(Se==="number"){if(Math.floor(pe)!==pe)return 9;if(pe>=0){if(128>pe)return 1;if(256>pe)return 2;if(65536>pe)return 3;if(4294967296>pe)return 5;throw new Error("Number too big 0x"+pe.toString(16))}if(pe>=-32)return 1;if(pe>=-128)return 2;if(pe>=-32768)return 3;if(pe>=-2147483648)return 5;throw new Error("Number too small -0x"+pe.toString(16).substr(1))}if(Se==="boolean"||pe===null)return 1;if(Se==="object"){var Oe,dt=0;if(Array.isArray(pe)){Oe=pe.length;for(var nt=0;Oe>nt;nt++)dt+=u(pe[nt])}else{var zt=Object.keys(pe);for(Oe=zt.length,nt=0;Oe>nt;nt++){var ht=zt[nt];dt+=u(ht)+u(pe[ht])}}if(16>Oe)return 1+dt;if(65536>Oe)return 3+dt;if(4294967296>Oe)return 5+dt;throw new Error("Array or object too long 0x"+Oe.toString(16))}throw new Error("Unknown type "+Se)}function v(pe){var Se=new ArrayBuffer(u(pe));return D(pe,new DataView(Se),0),new Uint8Array(Se)}function m(pe,Se,Oe){return Se?new pe(Se.buffer,Se.byteOffset,Se.byteLength/(Oe||1)):void 0}function _(pe){return m(DataView,pe)}function C(pe){return m(Uint8Array,pe)}function w(pe){return m(Int8Array,pe)}function k(pe){return m(Int32Array,pe,4)}function F(pe){return m(Float32Array,pe,4)}function T(pe,Se){var Oe=pe.length/2;Se||(Se=new Int16Array(Oe));for(var dt=0,nt=0;Oe>dt;++dt,nt+=2)Se[dt]=pe[nt]<<8^pe[nt+1];return Se}function z(pe,Se){var Oe=pe.length;Se||(Se=new Uint8Array(2*Oe));for(var dt=_(Se),nt=0;Oe>nt;++nt)dt.setInt16(2*nt,pe[nt]);return C(Se)}function Q(pe,Se){var Oe=pe.length/4;Se||(Se=new Int32Array(Oe));for(var dt=0,nt=0;Oe>dt;++dt,nt+=4)Se[dt]=pe[nt]<<24^pe[nt+1]<<16^pe[nt+2]<<8^pe[nt+3];return Se}function J(pe,Se){var Oe=pe.length;Se||(Se=new Uint8Array(4*Oe));for(var dt=_(Se),nt=0;Oe>nt;++nt)dt.setInt32(4*nt,pe[nt]);return C(Se)}function K(pe,Se){var Oe=pe.length;Se||(Se=new Float32Array(Oe/4));for(var dt=_(Se),nt=_(pe),zt=0,ht=0,Ot=Oe/4;Ot>zt;++zt,ht+=4)dt.setFloat32(ht,nt.getFloat32(ht),!0);return Se}function b(pe,Se,Oe){var dt=pe.length,nt=1/Se;Oe||(Oe=new Float32Array(dt));for(var zt=0;dt>zt;++zt)Oe[zt]=pe[zt]*nt;return Oe}function N(pe,Se,Oe){var dt=pe.length;Oe||(Oe=new Int32Array(dt));for(var nt=0;dt>nt;++nt)Oe[nt]=Math.round(pe[nt]*Se);return Oe}function V(pe,Se){var Oe,dt;if(!Se){var nt=0;for(Oe=0,dt=pe.length;dt>Oe;Oe+=2)nt+=pe[Oe+1];Se=new pe.constructor(nt)}var zt=0;for(Oe=0,dt=pe.length;dt>Oe;Oe+=2)for(var ht=pe[Oe],Ot=pe[Oe+1],Ut=0;Ot>Ut;++Ut)Se[zt]=ht,++zt;return Se}function U(pe){if(pe.length===0)return new Int32Array;var Se,Oe,dt=2;for(Se=1,Oe=pe.length;Oe>Se;++Se)pe[Se-1]!==pe[Se]&&(dt+=2);var nt=new Int32Array(dt),zt=0,ht=1;for(Se=1,Oe=pe.length;Oe>Se;++Se)pe[Se-1]!==pe[Se]?(nt[zt]=pe[Se-1],nt[zt+1]=ht,ht=1,zt+=2):++ht;return nt[zt]=pe[pe.length-1],nt[zt+1]=ht,nt}function Z(pe,Se){var Oe=pe.length;Se||(Se=new pe.constructor(Oe)),Oe&&(Se[0]=pe[0]);for(var dt=1;Oe>dt;++dt)Se[dt]=pe[dt]+Se[dt-1];return Se}function L(pe,Se){var Oe=pe.length;Se||(Se=new pe.constructor(Oe)),Se[0]=pe[0];for(var dt=1;Oe>dt;++dt)Se[dt]=pe[dt]-pe[dt-1];return Se}function ee(pe,Se){var Oe,dt,nt=pe instanceof Int8Array?127:32767,zt=-nt-1,ht=pe.length;if(!Se){var Ot=0;for(Oe=0;ht>Oe;++Oe)pe[Oe]<nt&&pe[Oe]>zt&&++Ot;Se=new Int32Array(Ot)}for(Oe=0,dt=0;ht>Oe;){for(var Ut=0;pe[Oe]===nt||pe[Oe]===zt;)Ut+=pe[Oe],++Oe;Ut+=pe[Oe],++Oe,Se[dt]=Ut,++dt}return Se}function Ee(pe,Se){var Oe,dt=32767,nt=-dt-1,zt=pe.length,ht=0;for(Oe=0;zt>Oe;++Oe)(It=pe[Oe])===0?++ht:It>0?(ht+=Math.ceil(It/dt),It%dt===0&&(ht+=1)):(ht+=Math.ceil(It/nt),It%nt===0&&(ht+=1));var Ot=new Int16Array(ht),Ut=0;for(Oe=0;zt>Oe;++Oe){var It;if((It=pe[Oe])>=0)for(;It>=dt;)Ot[Ut]=dt,++Ut,It-=dt;else for(;nt>=It;)Ot[Ut]=nt,++Ut,It-=nt;Ot[Ut]=It,++Ut}return Ot}function he(pe,Se){return Z(V(pe),Se)}function ge(pe){return U(L(pe))}function me(pe,Se,Oe){return b(V(pe,k(Oe)),Se,Oe)}function Me(pe,Se){return U(N(pe,Se))}function ue(pe,Se,Oe){return b(Z(pe,k(Oe)),Se,Oe)}function I(pe,Se,Oe){return L(N(pe,Se),Oe)}function ce(pe,Se,Oe){return b(ee(pe,k(Oe)),Se,Oe)}function se(pe,Se,Oe){var dt=ee(pe,k(Oe));return ue(dt,Se,F(dt))}function X(pe,Se,Oe){return Ee(I(pe,Se))}function Re(pe){var Se=_(pe),Oe=Se.getInt32(0),dt=Se.getInt32(4),nt=pe.subarray(8,12);return[Oe,pe=pe.subarray(12),dt,nt]}function fe(pe,Se,Oe,dt){var nt=new ArrayBuffer(12+dt.byteLength),zt=new Uint8Array(nt),ht=new DataView(nt);return ht.setInt32(0,pe),ht.setInt32(4,Se),Oe&&zt.set(Oe,8),zt.set(dt,12),zt}function De(pe){return fe(2,pe.length,void 0,C(pe))}function We(pe){return fe(4,pe.length,void 0,J(pe))}function oe(pe,Se){return fe(5,pe.length/Se,J([Se]),C(pe))}function Ae(pe){return fe(6,pe.length,void 0,J(U(pe)))}function He(pe){return fe(8,pe.length,void 0,J(ge(pe)))}function Ue(pe,Se){return fe(9,pe.length,J([Se]),J(Me(pe,Se)))}function Ie(pe,Se){return fe(10,pe.length,J([Se]),z(X(pe,Se)))}function rt(pe){var Se={};return xr.forEach(function(Oe){pe[Oe]!==void 0&&(Se[Oe]=pe[Oe])}),pe.bondAtomList&&(Se.bondAtomList=We(pe.bondAtomList)),pe.bondOrderList&&(Se.bondOrderList=De(pe.bondOrderList)),Se.xCoordList=Ie(pe.xCoordList,1e3),Se.yCoordList=Ie(pe.yCoordList,1e3),Se.zCoordList=Ie(pe.zCoordList,1e3),pe.bFactorList&&(Se.bFactorList=Ie(pe.bFactorList,100)),pe.atomIdList&&(Se.atomIdList=He(pe.atomIdList)),pe.altLocList&&(Se.altLocList=Ae(pe.altLocList)),pe.occupancyList&&(Se.occupancyList=Ue(pe.occupancyList,100)),Se.groupIdList=He(pe.groupIdList),Se.groupTypeList=We(pe.groupTypeList),pe.secStructList&&(Se.secStructList=De(pe.secStructList)),pe.insCodeList&&(Se.insCodeList=Ae(pe.insCodeList)),pe.sequenceIndexList&&(Se.sequenceIndexList=He(pe.sequenceIndexList)),Se.chainIdList=oe(pe.chainIdList,4),pe.chainNameList&&(Se.chainNameList=oe(pe.chainNameList,4)),Se}function st(pe){function Se(Ut){for(var It={},mr=0;Ut>mr;mr++)It[zt()]=zt();return It}function Oe(Ut){var It=pe.subarray(ht,ht+Ut);return ht+=Ut,It}function dt(Ut){var It=pe.subarray(ht,ht+Ut);ht+=Ut;var mr=65535;if(Ut>mr){for(var li=[],Ei=0;Ei<It.length;Ei+=mr)li.push(String.fromCharCode.apply(null,It.subarray(Ei,Ei+mr)));return li.join("")}return String.fromCharCode.apply(null,It)}function nt(Ut){for(var It=new Array(Ut),mr=0;Ut>mr;mr++)It[mr]=zt();return It}function zt(){var Ut,It,mr=pe[ht];if(!(128&mr))return ht++,mr;if((240&mr)==128)return ht++,Se(It=15&mr);if((240&mr)==144)return ht++,nt(It=15&mr);if((224&mr)==160)return ht++,dt(It=31&mr);if(!(224&~mr))return Ut=Ot.getInt8(ht),ht++,Ut;switch(mr){case 192:return ht++,null;case 194:return ht++,!1;case 195:return ht++,!0;case 196:return It=Ot.getUint8(ht+1),ht+=2,Oe(It);case 197:return It=Ot.getUint16(ht+1),ht+=3,Oe(It);case 198:return It=Ot.getUint32(ht+1),ht+=5,Oe(It);case 202:return Ut=Ot.getFloat32(ht+1),ht+=5,Ut;case 203:return Ut=Ot.getFloat64(ht+1),ht+=9,Ut;case 204:return Ut=pe[ht+1],ht+=2,Ut;case 205:return Ut=Ot.getUint16(ht+1),ht+=3,Ut;case 206:return Ut=Ot.getUint32(ht+1),ht+=5,Ut;case 208:return Ut=Ot.getInt8(ht+1),ht+=2,Ut;case 209:return Ut=Ot.getInt16(ht+1),ht+=3,Ut;case 210:return Ut=Ot.getInt32(ht+1),ht+=5,Ut;case 217:return It=Ot.getUint8(ht+1),ht+=2,dt(It);case 218:return It=Ot.getUint16(ht+1),ht+=3,dt(It);case 219:return It=Ot.getUint32(ht+1),ht+=5,dt(It);case 220:return It=Ot.getUint16(ht+1),ht+=3,nt(It);case 221:return It=Ot.getUint32(ht+1),ht+=5,nt(It);case 222:return It=Ot.getUint16(ht+1),ht+=3,Se(It);case 223:return It=Ot.getUint32(ht+1),ht+=5,Se(It)}throw new Error("Unknown type 0x"+mr.toString(16))}var ht=0,Ot=new DataView(pe.buffer);return zt()}function at(pe,Se,Oe,dt){switch(pe){case 1:return K(Se);case 2:return w(Se);case 3:return T(Se);case 4:return Q(Se);case 5:return C(Se);case 6:return V(Q(Se),new Uint8Array(Oe));case 7:return V(Q(Se));case 8:return he(Q(Se));case 9:return me(Q(Se),Q(dt)[0]);case 10:return se(T(Se),Q(dt)[0]);case 11:return b(T(Se),Q(dt)[0]);case 12:return ce(T(Se),Q(dt)[0]);case 13:return ce(w(Se),Q(dt)[0]);case 14:return ee(T(Se));case 15:return ee(w(Se))}}function Ft(pe,Se){var Oe=(Se=Se||{}).ignoreFields,dt={};return Rr.forEach(function(nt){var zt=!!Oe&&Oe.indexOf(nt)!==-1,ht=pe[nt];zt||ht===void 0||(ht instanceof Uint8Array?dt[nt]=at.apply(null,Re(ht)):dt[nt]=ht)}),dt}function Et(pe){return String.fromCharCode.apply(null,pe).replace(/\0/g,"")}function or(pe,Se,Oe){var dt,nt,zt,ht,Ot,Ut,It=(Oe=Oe||{}).firstModelOnly,mr=Se.onModel,li=Se.onChain,Ei=Se.onGroup,ui=Se.onAtom,gi=Se.onBond,jr=0,Or=0,Dr=0,rr=0,vi=0,bi=-1,Ki=pe.chainNameList,Ci=pe.secStructList,Ni=pe.insCodeList,Ti=pe.sequenceIndexList,pi=pe.atomIdList,Br=pe.bFactorList,Yr=pe.altLocList,Vi=pe.occupancyList,yi=pe.bondAtomList,Wi=pe.bondOrderList;for(dt=0,nt=pe.chainsPerModel.length;nt>dt&&!(It&&jr>0);++dt){var tn=pe.chainsPerModel[jr];for(mr&&mr({chainCount:tn,modelIndex:jr}),zt=0;tn>zt;++zt){var on=pe.groupsPerChain[Or];if(li){var ur=Et(pe.chainIdList.subarray(4*Or,4*Or+4)),Gr=null;Ki&&(Gr=Et(Ki.subarray(4*Or,4*Or+4))),li({groupCount:on,chainIndex:Or,modelIndex:jr,chainId:ur,chainName:Gr})}for(ht=0;on>ht;++ht){var Kr=pe.groupList[pe.groupTypeList[Dr]],qi=Kr.atomNameList.length;if(Ei){var Bt=null;Ci&&(Bt=Ci[Dr]);var x=null;pe.insCodeList&&(x=String.fromCharCode(Ni[Dr]));var ne=null;Ti&&(ne=Ti[Dr]),Ei({atomCount:qi,groupIndex:Dr,chainIndex:Or,modelIndex:jr,groupId:pe.groupIdList[Dr],groupType:pe.groupTypeList[Dr],groupName:Kr.groupName,singleLetterCode:Kr.singleLetterCode,chemCompType:Kr.chemCompType,secStruct:Bt,insCode:x,sequenceIndex:ne})}for(Ot=0;qi>Ot;++Ot){if(ui){var xe=null;pi&&(xe=pi[rr]);var Ve=null;Br&&(Ve=Br[rr]);var Le=null;Yr&&(Le=String.fromCharCode(Yr[rr]));var yt=null;Vi&&(yt=Vi[rr]),ui({atomIndex:rr,groupIndex:Dr,chainIndex:Or,modelIndex:jr,atomId:xe,element:Kr.elementList[Ot],atomName:Kr.atomNameList[Ot],formalCharge:Kr.formalChargeList[Ot],xCoord:pe.xCoordList[rr],yCoord:pe.yCoordList[rr],zCoord:pe.zCoordList[rr],bFactor:Ve,altLoc:Le,occupancy:yt})}rr+=1}if(gi){var lt=Kr.bondAtomList;for(Ot=0,Ut=Kr.bondOrderList.length;Ut>Ot;++Ot)gi({atomIndex1:rr-qi+lt[2*Ot],atomIndex2:rr-qi+lt[2*Ot+1],bondOrder:Kr.bondOrderList[Ot]})}Dr+=1}Or+=1}if(vi=bi+1,bi=rr-1,gi&&yi)for(Ot=0,Ut=yi.length;Ut>Ot;Ot+=2){var mt=yi[Ot],Mt=yi[Ot+1];(mt>=vi&&bi>=mt||Mt>=vi&&bi>=Mt)&&gi({atomIndex1:mt,atomIndex2:Mt,bondOrder:Wi?Wi[Ot/2]:null})}jr+=1}}function ar(pe){return v(rt(pe))}function kr(pe,Se){return pe instanceof ArrayBuffer&&(pe=new Uint8Array(pe)),Ft(pe instanceof Uint8Array?st(pe):pe,Se)}function Ar(pe,Se,Oe,dt){function nt(){try{var ht=kr(zt.response);Oe(ht)}catch(Ot){dt(Ot)}}var zt=new XMLHttpRequest;zt.addEventListener("load",nt,!0),zt.addEventListener("error",dt,!0),zt.responseType="arraybuffer",zt.open("GET",Se+pe.toUpperCase()),zt.send()}function pr(pe,Se,Oe){Ar(pe,wi,Se,Oe)}function vr(pe,Se,Oe){Ar(pe,Hi,Se,Oe)}var xr=["mmtfVersion","mmtfProducer","unitCell","spaceGroup","structureId","title","depositionDate","releaseDate","experimentalMethods","resolution","rFree","rWork","bioAssemblyList","ncsOperatorList","entityList","groupList","numBonds","numAtoms","numGroups","numChains","numModels","groupsPerChain","chainsPerModel"],fi=["xCoordList","yCoordList","zCoordList","groupIdList","groupTypeList","chainIdList","bFactorList","atomIdList","altLocList","occupancyList","secStructList","insCodeList","sequenceIndexList","chainNameList","bondAtomList","bondOrderList"],Rr=xr.concat(fi),Ir="v1.0.1",Di="//mmtf.rcsb.org/v1.0/",wi=Di+"full/",Hi=Di+"reduced/";a.encode=ar,a.decode=kr,a.traverse=or,a.fetch=pr,a.fetchReduced=vr,a.version=Ir,a.fetchUrl=wi,a.fetchReducedUrl=Hi,a.encodeMsgpack=v,a.encodeMmtf=rt,a.decodeMsgpack=st,a.decodeMmtf=Ft})(n)},529:(r,n,a)=>{a.r(n),a.d(n,{Matrix3:()=>z,Matrix4:()=>F,Quaternion:()=>c,Ray:()=>Q,Vector2:()=>p,Vector3:()=>T,clamp:()=>D,conversionMatrix3:()=>J,degToRad:()=>v});class c{constructor(b,N,V,U){this.x=b||0,this.y=N||0,this.z=V||0,this.w=U!==void 0?U:1}set(b,N,V,U){return this.x=b,this.y=N,this.z=V,this.w=U,this}copy(b){return this.x=b.x,this.y=b.y,this.z=b.z,this.w=b.w,this}conjugate(){return this.x*=-1,this.y*=-1,this.z*=-1,this}inverse(){return this.conjugate().normalize()}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}lengthxyz(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}normalize(){let b=this.length();return b===0?(this.x=0,this.y=0,this.z=0,this.w=1):(b=1/b,this.x*=b,this.y*=b,this.z*=b,this.w*=b),this}multiply(b){return this.multiplyQuaternions(this,b)}multiplyScalar(b){return this.x*=b,this.y*=b,this.z*=b,this.w*=b,this}multiplyQuaternions(b,N){const V=b.x,U=b.y,Z=b.z,L=b.w,ee=N.x,Ee=N.y,he=N.z,ge=N.w;return this.x=V*ge+L*ee+U*he-Z*Ee,this.y=U*ge+L*Ee+Z*ee-V*he,this.z=Z*ge+L*he+V*Ee-U*ee,this.w=L*ge-V*ee-U*Ee-Z*he,this}sub(b){return this.x-=b.x,this.y-=b.y,this.z-=b.z,this.w-=b.w,this}clone(){return new c(this.x,this.y,this.z,this.w)}setFromEuler(b){const N=Math.cos(b.x/2),V=Math.cos(b.y/2),U=Math.cos(b.z/2),Z=Math.sin(b.x/2),L=Math.sin(b.y/2),ee=Math.sin(b.z/2);return this.x=Z*V*U+N*L*ee,this.y=N*L*U-Z*V*ee,this.z=N*V*ee+Z*L*U,this.w=N*V*U-Z*L*ee,this}}class p{constructor(b,N){this.x=b||0,this.y=N||0}set(b,N){return this.x=b,this.y=N,this}subVectors(b,N){return this.x=b.x-N.x,this.y=b.y-N.y,this}copy(b){return this.x=b.x,this.y=b.y,this}clone(){return new p(this.x,this.y)}}function D(K,b,N){return Math.min(Math.max(K,b),N)}const u=Math.PI/180;function v(K){return K*u}var m,_,C,w,k;class F{constructor(b=1,N=0,V=0,U=0,Z=0,L=1,ee=0,Ee=0,he=0,ge=0,me=1,Me=0,ue=0,I=0,ce=0,se=1){b!==void 0&&typeof b!="number"?this.elements=new Float32Array(b):(this.elements=new Float32Array(16),this.elements[0]=b,this.elements[4]=N,this.elements[8]=V,this.elements[12]=U,this.elements[1]=Z,this.elements[5]=L,this.elements[9]=ee,this.elements[13]=Ee,this.elements[2]=he,this.elements[6]=ge,this.elements[10]=me,this.elements[14]=Me,this.elements[3]=ue,this.elements[7]=I,this.elements[11]=ce,this.elements[15]=se)}makeScale(b,N,V){throw new Error("Method not implemented.")}set(b,N,V,U,Z,L,ee,Ee,he,ge,me,Me,ue,I,ce,se){const X=this.elements;return X[0]=b,X[4]=N,X[8]=V,X[12]=U,X[1]=Z,X[5]=L,X[9]=ee,X[13]=Ee,X[2]=he,X[6]=ge,X[10]=me,X[14]=Me,X[3]=ue,X[7]=I,X[11]=ce,X[15]=se,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}copy(b){const N=b.elements;return this.set(N[0],N[4],N[8],N[12],N[1],N[5],N[9],N[13],N[2],N[6],N[10],N[14],N[3],N[7],N[11],N[15]),this}matrix3FromTopLeft(){const b=this.elements;return new z(b[0],b[4],b[8],b[1],b[5],b[9],b[2],b[6],b[10])}setRotationFromEuler(b,N){const V=this.elements,{x:U,y:Z,z:L}=b,ee=Math.cos(U),Ee=Math.sin(U),he=Math.cos(Z),ge=Math.sin(Z),me=Math.cos(L),Me=Math.sin(L);if(N===void 0||N==="XYZ"){const ue=ee*me,I=ee*Me,ce=Ee*me,se=Ee*Me;V[0]=he*me,V[4]=-he*Me,V[8]=ge,V[1]=I+ce*ge,V[5]=ue-se*ge,V[9]=-Ee*he,V[2]=se-ue*ge,V[6]=ce+I*ge,V[10]=ee*he}else console.error(`Error with matrix4 setRotationFromEuler. Order: ${N}`);return this}setRotationFromQuaternion(b){const N=this.elements,{x:V,y:U,z:Z,w:L}=b,ee=V+V,Ee=U+U,he=Z+Z,ge=V*ee,me=V*Ee,Me=V*he,ue=U*Ee,I=U*he,ce=Z*he,se=L*ee,X=L*Ee,Re=L*he;return N[0]=1-(ue+ce),N[4]=me-Re,N[8]=Me+X,N[1]=me+Re,N[5]=1-(ge+ce),N[9]=I-se,N[2]=Me-X,N[6]=I+se,N[10]=1-(ge+ue),this}multiplyMatrices(b,N){const V=b.elements,U=N.elements,Z=this.elements,L=V[0],ee=V[4],Ee=V[8],he=V[12],ge=V[1],me=V[5],Me=V[9],ue=V[13],I=V[2],ce=V[6],se=V[10],X=V[14],Re=V[3],fe=V[7],De=V[11],We=V[15],oe=U[0],Ae=U[4],He=U[8],Ue=U[12],Ie=U[1],rt=U[5],st=U[9],at=U[13],Ft=U[2],Et=U[6],or=U[10],ar=U[14],kr=U[3],Ar=U[7],pr=U[11],vr=U[15];return Z[0]=L*oe+ee*Ie+Ee*Ft+he*kr,Z[4]=L*Ae+ee*rt+Ee*Et+he*Ar,Z[8]=L*He+ee*st+Ee*or+he*pr,Z[12]=L*Ue+ee*at+Ee*ar+he*vr,Z[1]=ge*oe+me*Ie+Me*Ft+ue*kr,Z[5]=ge*Ae+me*rt+Me*Et+ue*Ar,Z[9]=ge*He+me*st+Me*or+ue*pr,Z[13]=ge*Ue+me*at+Me*ar+ue*vr,Z[2]=I*oe+ce*Ie+se*Ft+X*kr,Z[6]=I*Ae+ce*rt+se*Et+X*Ar,Z[10]=I*He+ce*st+se*or+X*pr,Z[14]=I*Ue+ce*at+se*ar+X*vr,Z[3]=Re*oe+fe*Ie+De*Ft+We*kr,Z[7]=Re*Ae+fe*rt+De*Et+We*Ar,Z[11]=Re*He+fe*st+De*or+We*pr,Z[15]=Re*Ue+fe*at+De*ar+We*vr,this}multiplyScalar(b){const N=this.elements;return N[0]*=b,N[4]*=b,N[8]*=b,N[12]*=b,N[1]*=b,N[5]*=b,N[9]*=b,N[13]*=b,N[2]*=b,N[6]*=b,N[10]*=b,N[14]*=b,N[3]*=b,N[7]*=b,N[11]*=b,N[15]*=b,this}makeTranslation(b,N,V){return this.set(1,0,0,b,0,1,0,N,0,0,1,V,0,0,0,1),this}snap(b){const N=Math.pow(10,4),V=this.elements;for(let U=0;U<16;U++){const Z=Math.round(V[U]);Z===Math.round(V[U]*N)/N&&(V[U]=Z)}return this}transpose(){const b=this.elements;let N;return N=b[1],b[1]=b[4],b[4]=N,N=b[2],b[2]=b[8],b[8]=N,N=b[6],b[6]=b[9],b[9]=N,N=b[3],b[3]=b[12],b[12]=N,N=b[7],b[7]=b[13],b[13]=N,N=b[11],b[11]=b[14],b[14]=N,this}setPosition(b){const N=this.elements;return N[12]=b.x,N[13]=b.y,N[14]=b.z,this}translate(b){const N=this.elements;return N[12]+=b.x,N[13]+=b.y,N[14]+=b.z,this}getInverse(b,N){const V=this.elements,U=b.elements,Z=U[0],L=U[4],ee=U[8],Ee=U[12],he=U[1],ge=U[5],me=U[9],Me=U[13],ue=U[2],I=U[6],ce=U[10],se=U[14],X=U[3],Re=U[7],fe=U[11],De=U[15];V[0]=me*se*Re-Me*ce*Re+Me*I*fe-ge*se*fe-me*I*De+ge*ce*De,V[4]=Ee*ce*Re-ee*se*Re-Ee*I*fe+L*se*fe+ee*I*De-L*ce*De,V[8]=ee*Me*Re-Ee*me*Re+Ee*ge*fe-L*Me*fe-ee*ge*De+L*me*De,V[12]=Ee*me*I-ee*Me*I-Ee*ge*ce+L*Me*ce+ee*ge*se-L*me*se,V[1]=Me*ce*X-me*se*X-Me*ue*fe+he*se*fe+me*ue*De-he*ce*De,V[5]=ee*se*X-Ee*ce*X+Ee*ue*fe-Z*se*fe-ee*ue*De+Z*ce*De,V[9]=Ee*me*X-ee*Me*X-Ee*he*fe+Z*Me*fe+ee*he*De-Z*me*De,V[13]=ee*Me*ue-Ee*me*ue+Ee*he*ce-Z*Me*ce-ee*he*se+Z*me*se,V[2]=ge*se*X-Me*I*X+Me*ue*Re-he*se*Re-ge*ue*De+he*I*De,V[6]=Ee*I*X-L*se*X-Ee*ue*Re+Z*se*Re+L*ue*De-Z*I*De,V[10]=L*Me*X-Ee*ge*X+Ee*he*Re-Z*Me*Re-L*he*De+Z*ge*De,V[14]=Ee*ge*ue-L*Me*ue-Ee*he*I+Z*Me*I+L*he*se-Z*ge*se,V[3]=me*I*X-ge*ce*X-me*ue*Re+he*ce*Re+ge*ue*fe-he*I*fe,V[7]=L*ce*X-ee*I*X+ee*ue*Re-Z*ce*Re-L*ue*fe+Z*I*fe,V[11]=ee*ge*X-L*me*X-ee*he*Re+Z*me*Re+L*he*fe-Z*ge*fe,V[15]=L*me*ue-ee*ge*ue+ee*he*I-Z*me*I-L*he*ce+Z*ge*ce;const We=Z*V[0]+he*V[4]+ue*V[8]+X*V[12];if(We===0){const oe="Matrix4.getInverse(): can't invert matrix, determinant is 0";if(N)throw new Error(oe);return console.warn(oe),this.identity(),this}return this.multiplyScalar(1/We),this}isReflected(){const b=this.elements,N=b[0],V=b[4],U=b[8],Z=b[1],L=b[5],ee=b[9],Ee=b[2],he=b[6],ge=b[10];return N*L*ge+Z*he*U+Ee*V*ee-Ee*L*U-Z*V*ge-N*he*ee<0}scale(b){const N=this.elements,{x:V}=b,{y:U}=b,{z:Z}=b;return N[0]*=V,N[4]*=U,N[8]*=Z,N[1]*=V,N[5]*=U,N[9]*=Z,N[2]*=V,N[6]*=U,N[10]*=Z,N[3]*=V,N[7]*=U,N[11]*=Z,this}getMaxScaleOnAxis(){const b=this.elements,N=b[0]*b[0]+b[1]*b[1]+b[2]*b[2],V=b[4]*b[4]+b[5]*b[5]+b[6]*b[6],U=b[8]*b[8]+b[9]*b[9]+b[10]*b[10];return Math.sqrt(Math.max(N,Math.max(V,U)))}makeFrustum(b,N,V,U,Z,L){const ee=this.elements,Ee=2*Z/(N-b),he=2*Z/(U-V),ge=(N+b)/(N-b),me=(U+V)/(U-V),Me=-(L+Z)/(L-Z),ue=-2*L*Z/(L-Z);return ee[0]=Ee,ee[4]=0,ee[8]=ge,ee[12]=0,ee[1]=0,ee[5]=he,ee[9]=me,ee[13]=0,ee[2]=0,ee[6]=0,ee[10]=Me,ee[14]=ue,ee[3]=0,ee[7]=0,ee[11]=-1,ee[15]=0,this}makePerspective(b,N,V,U){const Z=V*Math.tan(v(.5*b)),L=-Z,ee=L*N,Ee=Z*N;return this.makeFrustum(ee,Ee,L,Z,V,U)}makeOrthographic(b,N,V,U,Z,L){const ee=this.elements,Ee=1/(N-b),he=1/(V-U),ge=1/(L-Z),me=(N+b)*Ee,Me=(V+U)*he,ue=(L+Z)*ge;return ee[0]=2*Ee,ee[4]=0,ee[8]=0,ee[12]=-me,ee[1]=0,ee[5]=2*he,ee[9]=0,ee[13]=-Me,ee[2]=0,ee[6]=0,ee[10]=-2*ge,ee[14]=-ue,ee[3]=0,ee[7]=0,ee[11]=0,ee[15]=1,this}isEqual(b){const N=b.elements,V=this.elements;return V[0]===N[0]&&V[4]===N[4]&&V[8]===N[8]&&V[12]===N[12]&&V[1]===N[1]&&V[5]===N[5]&&V[9]===N[9]&&V[13]===N[13]&&V[2]===N[2]&&V[6]===N[6]&&V[10]===N[10]&&V[14]===N[14]&&V[3]===N[3]&&V[7]===N[7]&&V[11]===N[11]&&V[15]===N[15]}clone(){const b=this.elements;return new F(b[0],b[4],b[8],b[12],b[1],b[5],b[9],b[13],b[2],b[6],b[10],b[14],b[3],b[7],b[11],b[15])}isIdentity(){const b=this.elements;return b[0]===1&&b[4]===0&&b[8]===0&&b[12]===0&&b[1]===0&&b[5]===1&&b[9]===0&&b[13]===0&&b[2]===0&&b[6]===0&&b[10]===1&&b[14]===0&&b[3]===0&&b[7]===0&&b[11]===0&&b[15]===1}isNearlyIdentity(b){return this.clone().snap(b).isIdentity()}getScale(b){const N=this.elements;return b=b||new T,C.set(N[0],N[1],N[2]),w.set(N[4],N[5],N[6]),k.set(N[8],N[9],N[10]),b.x=C.length(),b.y=w.length(),b.z=k.length(),b}lookAt(b,N,V){const U=this.elements;return k.subVectors(b,N).normalize(),k.length()===0&&(k.z=1),C.crossVectors(V,k).normalize(),C.length()===0&&(k.x+=1e-4,C.crossVectors(V,k).normalize()),w.crossVectors(k,C),U[0]=C.x,U[4]=w.x,U[8]=k.x,U[1]=C.y,U[5]=w.y,U[9]=k.y,U[2]=C.z,U[6]=w.z,U[10]=k.z,this}compose(b,N,V){const U=this.elements;return m.identity(),m.setRotationFromQuaternion(N),_.makeScale(V.x,V.y,V.z),this.multiplyMatrices(m,_),U[12]=b.x,U[13]=b.y,U[14]=b.z,this}}m=new F,_=new F;class T{constructor(b,N,V){this.x=b||0,this.y=N||0,this.z=V||0,this.atomid=void 0}set(b,N,V){return this.x=b,this.y=N,this.z=V,this}copy(b){return this.x=b.x,this.y=b.y,this.z=b.z,this}add(b){return this.x+=b.x,this.y+=b.y,this.z+=b.z,this}addVectors(b,N){return this.x=b.x+N.x,this.y=b.y+N.y,this.z=b.z+N.z,this}multiplyVectors(b,N){return this.x=b.x*N.x,this.y=b.y*N.y,this.z=b.z*N.z,this}sub(b){return this.x-=b.x,this.y-=b.y,this.z-=b.z,this}subVectors(b,N){return this.x=b.x-N.x,this.y=b.y-N.y,this.z=b.z-N.z,this}multiplyScalar(b){return this.x*=b,this.y*=b,this.z*=b,this}divideScalar(b){return b!==0?(this.x/=b,this.y/=b,this.z/=b):(this.x=0,this.y=0,this.z=0),this}max(b){return this.x=Math.max(this.x,b.x),this.y=Math.max(this.y,b.y),this.z=Math.max(this.z,b.z),this}min(b){return this.x=Math.min(this.x,b.x),this.y=Math.min(this.y,b.y),this.z=Math.min(this.z,b.z),this}distanceTo(b){return Math.sqrt(this.distanceToSquared(b))}distanceToSquared(b){const N=this.x-b.x,V=this.y-b.y,U=this.z-b.z;return N*N+V*V+U*U}applyMatrix3(b){const{x:N}=this,{y:V}=this,{z:U}=this,Z=b.elements;return this.x=Z[0]*N+Z[3]*V+Z[6]*U,this.y=Z[1]*N+Z[4]*V+Z[7]*U,this.z=Z[2]*N+Z[5]*V+Z[8]*U,this}applyMatrix4(b){const{x:N}=this,{y:V}=this,{z:U}=this,Z=b.elements;return this.x=Z[0]*N+Z[4]*V+Z[8]*U+Z[12],this.y=Z[1]*N+Z[5]*V+Z[9]*U+Z[13],this.z=Z[2]*N+Z[6]*V+Z[10]*U+Z[14],this}applyProjection(b){const{x:N}=this,{y:V}=this,{z:U}=this,Z=b.elements,L=Z[3]*N+Z[7]*V+Z[11]*U+Z[15];return this.x=(Z[0]*N+Z[4]*V+Z[8]*U+Z[12])/L,this.y=(Z[1]*N+Z[5]*V+Z[9]*U+Z[13])/L,this.z=(Z[2]*N+Z[6]*V+Z[10]*U+Z[14])/L,this}applyQuaternion(b){const{x:N}=this,{y:V}=this,{z:U}=this,Z=b.x,L=b.y,ee=b.z,Ee=b.w,he={};he.x=2*(V*ee-U*L),he.y=2*(U*Z-N*ee),he.z=2*(N*L-V*Z);const ge={};return ge.x=he.y*ee-he.z*L,ge.y=he.z*Z-he.x*ee,ge.z=he.x*L-he.y*Z,this.x=N+Ee*he.x+ge.x,this.y=V+Ee*he.y+ge.y,this.z=U+Ee*he.z+ge.z,this}negate(){return this.multiplyScalar(-1)}dot(b){return this.x*b.x+this.y*b.y+this.z*b.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}normalize(){return this.divideScalar(this.length())}cross(b){const{x:N}=this,{y:V}=this,{z:U}=this;return this.x=V*b.z-U*b.y,this.y=U*b.x-N*b.z,this.z=N*b.y-V*b.x,this}crossVectors(b,N){return this.x=b.y*N.z-b.z*N.y,this.y=b.z*N.x-b.x*N.z,this.z=b.x*N.y-b.y*N.x,this}equals(b){return this.x==b.x&&this.y==b.y&&this.z==b.z}getPositionFromMatrix(b){return this.x=b.elements[12],this.y=b.elements[13],this.z=b.elements[14],this}setEulerFromRotationMatrix(b,N){const V=b.elements,U=V[0],Z=V[4],L=V[8],ee=V[5],Ee=V[9],he=V[6],ge=V[10];return N===void 0||N==="XYZ"?(this.y=Math.asin(D(L,-1,1)),Math.abs(L)<.99999?(this.x=Math.atan2(-Ee,ge),this.z=Math.atan2(-Z,U)):(this.x=Math.atan2(he,ee),this.z=0)):console.error(`Error with vector's setEulerFromRotationMatrix: Unknown order: ${N}`),this}rotateAboutVector(b,N){b.normalize();const V=Math.cos(N),U=Math.sin(N),Z=this.clone().multiplyScalar(V),L=b.clone().cross(this).multiplyScalar(U),ee=b.clone().multiplyScalar(b.clone().dot(this)).multiplyScalar(1-V),Ee=Z.add(L).add(ee);return this.x=Ee.x,this.y=Ee.y,this.z=Ee.z,this}setFromMatrixPosition(b){const N=b.elements;return this.x=N[12],this.y=N[13],this.z=N[14],this}transformDirection(b){const{x:N}=this,{y:V}=this,{z:U}=this,Z=b.elements;return this.x=Z[0]*N+Z[4]*V+Z[8]*U,this.y=Z[1]*N+Z[5]*V+Z[9]*U,this.z=Z[2]*N+Z[6]*V+Z[10]*U,this.normalize()}clone(){return new T(this.x,this.y,this.z)}unproject(b){const N=m;return N.multiplyMatrices(b.matrixWorld,N.getInverse(b.projectionMatrix)),this.applyMatrix4(N)}}C=new T,w=new T,k=new T;class z{constructor(b=1,N=0,V=0,U=0,Z=1,L=0,ee=0,Ee=0,he=1){this.elements=new Float32Array(9),this.set(b,N,V,U,Z,L,ee,Ee,he)}set(b,N,V,U,Z,L,ee,Ee,he){const ge=this.elements;return ge[0]=b,ge[3]=N,ge[6]=V,ge[1]=U,ge[4]=Z,ge[7]=L,ge[2]=ee,ge[5]=Ee,ge[8]=he,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(b){const N=b.elements;this.set(N[0],N[3],N[6],N[1],N[4],N[7],N[2],N[5],N[8])}multiplyScalar(b){const N=this.elements;return N[0]*=b,N[3]*=b,N[6]*=b,N[1]*=b,N[4]*=b,N[7]*=b,N[2]*=b,N[5]*=b,N[8]*=b,this}getInverse3(b){const N=b.elements,V=this.elements;V[0]=N[4]*N[8]-N[5]*N[7],V[3]=N[6]*N[5]-N[3]*N[8],V[6]=N[3]*N[7]-N[6]*N[4],V[1]=N[7]*N[2]-N[1]*N[8],V[4]=N[0]*N[8]-N[6]*N[2],V[7]=N[1]*N[6]-N[0]*N[7],V[2]=N[1]*N[5]-N[2]*N[4],V[5]=N[2]*N[3]-N[0]*N[5],V[8]=N[0]*N[4]-N[1]*N[3];const U=N[0]*V[0]+N[3]*V[1]+N[6]*V[2];return this.multiplyScalar(1/U),this}getInverse(b,N){const V=b.elements,U=this.elements;U[0]=V[10]*V[5]-V[6]*V[9],U[1]=-V[10]*V[1]+V[2]*V[9],U[2]=V[6]*V[1]-V[2]*V[5],U[3]=-V[10]*V[4]+V[6]*V[8],U[4]=V[10]*V[0]-V[2]*V[8],U[5]=-V[6]*V[0]+V[2]*V[4],U[6]=V[9]*V[4]-V[5]*V[8],U[7]=-V[9]*V[0]+V[1]*V[8],U[8]=V[5]*V[0]-V[1]*V[4];const Z=V[0]*U[0]+V[1]*U[3]+V[2]*U[6];if(Z===0){const L="Matrix3.getInverse(): can't invert matrix, determinant is 0";if(N)throw new Error(L);return console.warn(L),this.identity(),this}return this.multiplyScalar(1/Z),this}getDeterminant(){const b=this.elements;return b[0]*b[4]*b[8]+b[1]*b[5]*b[6]+b[2]*b[3]*b[7]-b[2]*b[4]*b[6]-b[1]*b[3]*b[8]-b[0]*b[5]*b[7]}transpose(){let b;const N=this.elements;return b=N[1],N[1]=N[3],N[3]=b,b=N[2],N[2]=N[6],N[6]=b,b=N[5],N[5]=N[7],N[7]=b,this}clone(){const b=this.elements;return new z(b[0],b[3],b[6],b[1],b[4],b[7],b[2],b[5],b[8])}getMatrix4(){const b=this.elements;return new F(b[0],b[3],b[6],0,b[1],b[4],b[7],0,b[2],b[5],b[8],0)}}class Q{constructor(b,N){this.origin=b!==void 0?b:new T,this.direction=N!==void 0?N:new T}set(b,N){return this.origin.copy(b),this.direction.copy(N),this}copy(b){return this.origin.copy(b.origin),this.direction.copy(b.direction),this}at(b,N){return(N||new T).copy(this.direction).multiplyScalar(b).add(this.origin)}recast(b){const N=C;return this.origin.copy(this.at(b,N)),this}closestPointToPoint(b,N){const V=N||new T;V.subVectors(b,this.origin);const U=V.dot(this.direction);return V.copy(this.direction).multiplyScalar(U).add(this.origin)}distanceToPoint(b){const N=C,V=N.subVectors(b,this.origin).dot(this.direction);return N.copy(this.direction).multiplyScalar(V).add(this.origin),N.distanceTo(b)}isIntersectionCylinder(){}isIntersectionSphere(b){return this.distanceToPoint(b.center)<=b.radius}isIntersectionPlane(b){return b.normal.dot(this.direction)!==0||b.distanceToPoint(this.origin)===0}distanceToPlane(b){const N=b.normal.dot(this.direction);return N===0?b.distanceToPoint(this.origin)===0?0:void 0:-(this.origin.dot(b.normal)+b.constant)/N}intersectPlane(b,N){const V=this.distanceToPlane(b);if(V!==void 0)return this.at(V,N)}applyMatrix4(b){return this.direction.add(this.origin).applyMatrix4(b),this.origin.applyMatrix4(b),this.direction.sub(this.origin),this}clone(){return new Q().copy(this)}}function J(K,b,N,V,U,Z){V=V*Math.PI/180,U=U*Math.PI/180,Z=Z*Math.PI/180;const L=me=>me*me,ee=Math.cos(V),Ee=Math.cos(U),he=Math.cos(Z),ge=Math.sin(Z);return new z(K,b*he,N*Ee,0,b*ge,N*(ee-Ee*he)/ge,0,0,N*Math.sqrt(1-L(ee)-L(Ee)-L(he)+2*ee*Ee*he)/ge)}},546:(r,n,a)=>{a.r(n),a.d(n,{CustomLinear:()=>C,Gradient:()=>k,GradientType:()=>p,ROYGB:()=>m,RWB:()=>v,Sinebow:()=>_,builtinGradients:()=>w,getGradient:()=>u,normalizeValue:()=>D});var c=a(222);class p{}function D(F,T,z){return T>=F?(z<F&&(z=F),z>T&&(z=T),{lo:F,hi:T,val:z}):(z>F&&(z=F),z<T&&(z=T),{lo:T,hi:F,val:z=F-z+T})}function u(F){if(F instanceof p)return F;if(F.gradient!==void 0&&w[F.gradient]){let T=F.min===void 0?-1:F.min,z=F.max===void 0?1:F.max;return F.mid===void 0?F.colors===void 0?new w[F.gradient](T,z):new w[F.gradient](T,z,F.colors):new w[F.gradient](T,z,F.mid)}if(typeof F.gradient=="string"&&F.gradient.startsWith("linear_")){let T=F.gradient.split("_");T.shift();let z=F.min===void 0?-1:F.min,Q=F.max===void 0?1:F.max;return new C(z,Q,T)}return F}class v extends p{constructor(T,z,Q){super(),this.gradient="RWB",this.mult=1,this.mid=Q,this.min=T,this.max=z,z===void 0&&Array.isArray(T)&&T.length>=2?(this.max=T[1],this.min=T[0]):T&&z&&!Array.isArray(T)&&(this.min=T,this.max=z)}range(){return this.min!==void 0&&this.max!==void 0?[this.min,this.max]:null}valueToHex(T,z){var Q,J;if(T=this.mult*T,z?(Q=z[0],J=z[1]):(Q=this.min,J=this.max),T===void 0)return 16777215;var K=D(Q,J,T);Q=K.lo;var b,N=((J=K.hi)+Q)/2;return(T=K.val)<(N=z&&z[2]!==void 0?z[2]:this.mid!==void 0?this.mid:(Q+J)/2)?16711680+256*(b=Math.floor(255*Math.sqrt((T-Q)/(N-Q))))+b:T>N?65536*(b=Math.floor(255*Math.sqrt(1-(T-N)/(J-N))))+256*b+255:16777215}}class m extends p{constructor(T,z){super(),this.gradient="ROYGB",this.mult=1,this.min=T,this.max=z,z===void 0&&Array.isArray(T)&&T.length>=2?(this.max=T[1],this.min=T[0]):T&&z&&!Array.isArray(T)&&(this.min=T,this.max=z)}valueToHex(T,z){var Q,J;if(T=this.mult*T,z?(Q=z[0],J=z[1]):(Q=this.min,J=this.max),T===void 0)return 16777215;var K=D(Q,J,T),b=((Q=K.lo)+(J=K.hi))/2,N=(Q+b)/2,V=(b+J)/2;return(T=K.val)<N?16711680+256*Math.floor(255*Math.sqrt((T-Q)/(N-Q)))+0:T<b?65536*Math.floor(255*Math.sqrt(1-(T-N)/(b-N)))+65280+0:T<V?65280+1*Math.floor(255*Math.sqrt((T-b)/(V-b))):0+256*Math.floor(255*Math.sqrt(1-(T-V)/(J-V)))+255}range(){return this.min!==void 0&&this.max!==void 0?[this.min,this.max]:null}}class _ extends p{constructor(T,z){super(),this.gradient="Sinebow",this.mult=1,this.min=T,this.max=z,z===void 0&&Array.isArray(T)&&T.length>=2&&(this.max=T[1],this.min=T[0]),z<T&&(this.mult=-1,this.min*=-1,this.max*=-1)}valueToHex(T,z){var Q,J;if(T=this.mult*T,z?(Q=z[0],J=z[1]):(Q=this.min,J=this.max),T===void 0)return 16777215;var K=k.normalizeValue(Q,J,T);Q=K.lo,J=K.hi;var b=((T=K.val)-Q)/(J-Q)*5/6+.5,N=Math.sin(Math.PI*b);N*=255*N;var V=Math.sin(Math.PI*(b+1/3));V*=255*V;var U=Math.sin(Math.PI*(b+2/3));return U*=255*U,65536*Math.floor(N)+256*Math.floor(U)+1*Math.floor(V)}range(){return this.min!==void 0&&this.max!==void 0?[this.min,this.max]:null}}class C extends p{constructor(T,z,Q){var J;if(super(),this.gradient="linear",this.colors=new Array,Array.isArray(T)&&T.length>=2?(this.max=T[1],this.min=T[0],J=z):(this.min=T,this.max=z,J=Q),J)for(let K of J)this.colors.push(c.CC.color(K));else this.colors.push(c.CC.color(0))}range(){return this.min!==void 0&&this.max!==void 0?[this.min,this.max]:null}valueToHex(T,z){var Q,J;if(z?(Q=z[0],J=z[1]):(Q=this.min,J=this.max),T===void 0)return 16777215;var K=D(Q,J,T);Q=K.lo,J=K.hi,T=K.val;let b=this.colors.length,N=(J-Q)/b,V=Math.min(Math.floor((T-Q)/N),b-1),U=Math.min(V+1,b-1),Z=(T-Q-V*N)/N,L=this.colors[V],ee=this.colors[U];return new c.Color(L.r+Z*(ee.r-L.r),L.g+Z*(ee.g-L.g),L.b+Z*(ee.b-L.b)).getHex()}}const w={rwb:v,RWB:v,roygb:m,ROYGB:m,sinebow:_,linear:C};class k extends p{valueToHex(T,z){return 0}range(){return null}}k.RWB=v,k.ROYGB=m,k.Sinebow=_,k.CustomLinear=C,k.builtinGradients=w,k.normalizeValue=D,k.getGradient=u},663:(r,n,a)=>{var c=a(981),p=a(701),D=a(407),u=a(165),v=a(358),m=-2,_=12,C=30;function w(U){return(U>>>24&255)+(U>>>8&65280)+((65280&U)<<8)+((255&U)<<24)}function k(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new c.Buf16(320),this.work=new c.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function F(U){var Z;return U&&U.state?(Z=U.state,U.total_in=U.total_out=Z.total=0,U.msg="",Z.wrap&&(U.adler=1&Z.wrap),Z.mode=1,Z.last=0,Z.havedict=0,Z.dmax=32768,Z.head=null,Z.hold=0,Z.bits=0,Z.lencode=Z.lendyn=new c.Buf32(852),Z.distcode=Z.distdyn=new c.Buf32(592),Z.sane=1,Z.back=-1,0):m}function T(U){var Z;return U&&U.state?((Z=U.state).wsize=0,Z.whave=0,Z.wnext=0,F(U)):m}function z(U,Z){var L,ee;return U&&U.state?(ee=U.state,Z<0?(L=0,Z=-Z):(L=1+(Z>>4),Z<48&&(Z&=15)),Z&&(Z<8||Z>15)?m:(ee.window!==null&&ee.wbits!==Z&&(ee.window=null),ee.wrap=L,ee.wbits=Z,T(U))):m}function Q(U,Z){var L,ee;return U?(ee=new k,U.state=ee,ee.window=null,(L=z(U,Z))!==0&&(U.state=null),L):m}var J,K,b=!0;function N(U){if(b){var Z;for(J=new c.Buf32(512),K=new c.Buf32(32),Z=0;Z<144;)U.lens[Z++]=8;for(;Z<256;)U.lens[Z++]=9;for(;Z<280;)U.lens[Z++]=7;for(;Z<288;)U.lens[Z++]=8;for(v(1,U.lens,0,288,J,0,U.work,{bits:9}),Z=0;Z<32;)U.lens[Z++]=5;v(2,U.lens,0,32,K,0,U.work,{bits:5}),b=!1}U.lencode=J,U.lenbits=9,U.distcode=K,U.distbits=5}function V(U,Z,L,ee){var Ee,he=U.state;return he.window===null&&(he.wsize=1<<he.wbits,he.wnext=0,he.whave=0,he.window=new c.Buf8(he.wsize)),ee>=he.wsize?(c.arraySet(he.window,Z,L-he.wsize,he.wsize,0),he.wnext=0,he.whave=he.wsize):((Ee=he.wsize-he.wnext)>ee&&(Ee=ee),c.arraySet(he.window,Z,L-ee,Ee,he.wnext),(ee-=Ee)?(c.arraySet(he.window,Z,L-ee,ee,0),he.wnext=ee,he.whave=he.wsize):(he.wnext+=Ee,he.wnext===he.wsize&&(he.wnext=0),he.whave<he.wsize&&(he.whave+=Ee))),0}n.inflateReset=T,n.inflateReset2=z,n.inflateResetKeep=F,n.inflateInit=function(U){return Q(U,15)},n.inflateInit2=Q,n.inflate=function(U,Z){var L,ee,Ee,he,ge,me,Me,ue,I,ce,se,X,Re,fe,De,We,oe,Ae,He,Ue,Ie,rt,st,at,Ft=0,Et=new c.Buf8(4),or=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!U||!U.state||!U.output||!U.input&&U.avail_in!==0)return m;(L=U.state).mode===_&&(L.mode=13),ge=U.next_out,Ee=U.output,Me=U.avail_out,he=U.next_in,ee=U.input,me=U.avail_in,ue=L.hold,I=L.bits,ce=me,se=Me,rt=0;e:for(;;)switch(L.mode){case 1:if(L.wrap===0){L.mode=13;break}for(;I<16;){if(me===0)break e;me--,ue+=ee[he++]<<I,I+=8}if(2&L.wrap&&ue===35615){L.check=0,Et[0]=255&ue,Et[1]=ue>>>8&255,L.check=D(L.check,Et,2,0),ue=0,I=0,L.mode=2;break}if(L.flags=0,L.head&&(L.head.done=!1),!(1&L.wrap)||(((255&ue)<<8)+(ue>>8))%31){U.msg="incorrect header check",L.mode=C;break}if((15&ue)!=8){U.msg="unknown compression method",L.mode=C;break}if(I-=4,Ie=8+(15&(ue>>>=4)),L.wbits===0)L.wbits=Ie;else if(Ie>L.wbits){U.msg="invalid window size",L.mode=C;break}L.dmax=1<<Ie,U.adler=L.check=1,L.mode=512&ue?10:_,ue=0,I=0;break;case 2:for(;I<16;){if(me===0)break e;me--,ue+=ee[he++]<<I,I+=8}if(L.flags=ue,(255&L.flags)!=8){U.msg="unknown compression method",L.mode=C;break}if(57344&L.flags){U.msg="unknown header flags set",L.mode=C;break}L.head&&(L.head.text=ue>>8&1),512&L.flags&&(Et[0]=255&ue,Et[1]=ue>>>8&255,L.check=D(L.check,Et,2,0)),ue=0,I=0,L.mode=3;case 3:for(;I<32;){if(me===0)break e;me--,ue+=ee[he++]<<I,I+=8}L.head&&(L.head.time=ue),512&L.flags&&(Et[0]=255&ue,Et[1]=ue>>>8&255,Et[2]=ue>>>16&255,Et[3]=ue>>>24&255,L.check=D(L.check,Et,4,0)),ue=0,I=0,L.mode=4;case 4:for(;I<16;){if(me===0)break e;me--,ue+=ee[he++]<<I,I+=8}L.head&&(L.head.xflags=255&ue,L.head.os=ue>>8),512&L.flags&&(Et[0]=255&ue,Et[1]=ue>>>8&255,L.check=D(L.check,Et,2,0)),ue=0,I=0,L.mode=5;case 5:if(1024&L.flags){for(;I<16;){if(me===0)break e;me--,ue+=ee[he++]<<I,I+=8}L.length=ue,L.head&&(L.head.extra_len=ue),512&L.flags&&(Et[0]=255&ue,Et[1]=ue>>>8&255,L.check=D(L.check,Et,2,0)),ue=0,I=0}else L.head&&(L.head.extra=null);L.mode=6;case 6:if(1024&L.flags&&((X=L.length)>me&&(X=me),X&&(L.head&&(Ie=L.head.extra_len-L.length,L.head.extra||(L.head.extra=new Array(L.head.extra_len)),c.arraySet(L.head.extra,ee,he,X,Ie)),512&L.flags&&(L.check=D(L.check,ee,X,he)),me-=X,he+=X,L.length-=X),L.length))break e;L.length=0,L.mode=7;case 7:if(2048&L.flags){if(me===0)break e;X=0;do Ie=ee[he+X++],L.head&&Ie&&L.length<65536&&(L.head.name+=String.fromCharCode(Ie));while(Ie&&X<me);if(512&L.flags&&(L.check=D(L.check,ee,X,he)),me-=X,he+=X,Ie)break e}else L.head&&(L.head.name=null);L.length=0,L.mode=8;case 8:if(4096&L.flags){if(me===0)break e;X=0;do Ie=ee[he+X++],L.head&&Ie&&L.length<65536&&(L.head.comment+=String.fromCharCode(Ie));while(Ie&&X<me);if(512&L.flags&&(L.check=D(L.check,ee,X,he)),me-=X,he+=X,Ie)break e}else L.head&&(L.head.comment=null);L.mode=9;case 9:if(512&L.flags){for(;I<16;){if(me===0)break e;me--,ue+=ee[he++]<<I,I+=8}if(ue!==(65535&L.check)){U.msg="header crc mismatch",L.mode=C;break}ue=0,I=0}L.head&&(L.head.hcrc=L.flags>>9&1,L.head.done=!0),U.adler=L.check=0,L.mode=_;break;case 10:for(;I<32;){if(me===0)break e;me--,ue+=ee[he++]<<I,I+=8}U.adler=L.check=w(ue),ue=0,I=0,L.mode=11;case 11:if(L.havedict===0)return U.next_out=ge,U.avail_out=Me,U.next_in=he,U.avail_in=me,L.hold=ue,L.bits=I,2;U.adler=L.check=1,L.mode=_;case _:if(Z===5||Z===6)break e;case 13:if(L.last){ue>>>=7&I,I-=7&I,L.mode=27;break}for(;I<3;){if(me===0)break e;me--,ue+=ee[he++]<<I,I+=8}switch(L.last=1&ue,I-=1,3&(ue>>>=1)){case 0:L.mode=14;break;case 1:if(N(L),L.mode=20,Z===6){ue>>>=2,I-=2;break e}break;case 2:L.mode=17;break;case 3:U.msg="invalid block type",L.mode=C}ue>>>=2,I-=2;break;case 14:for(ue>>>=7&I,I-=7&I;I<32;){if(me===0)break e;me--,ue+=ee[he++]<<I,I+=8}if((65535&ue)!=(ue>>>16^65535)){U.msg="invalid stored block lengths",L.mode=C;break}if(L.length=65535&ue,ue=0,I=0,L.mode=15,Z===6)break e;case 15:L.mode=16;case 16:if(X=L.length){if(X>me&&(X=me),X>Me&&(X=Me),X===0)break e;c.arraySet(Ee,ee,he,X,ge),me-=X,he+=X,Me-=X,ge+=X,L.length-=X;break}L.mode=_;break;case 17:for(;I<14;){if(me===0)break e;me--,ue+=ee[he++]<<I,I+=8}if(L.nlen=257+(31&ue),ue>>>=5,I-=5,L.ndist=1+(31&ue),ue>>>=5,I-=5,L.ncode=4+(15&ue),ue>>>=4,I-=4,L.nlen>286||L.ndist>30){U.msg="too many length or distance symbols",L.mode=C;break}L.have=0,L.mode=18;case 18:for(;L.have<L.ncode;){for(;I<3;){if(me===0)break e;me--,ue+=ee[he++]<<I,I+=8}L.lens[or[L.have++]]=7&ue,ue>>>=3,I-=3}for(;L.have<19;)L.lens[or[L.have++]]=0;if(L.lencode=L.lendyn,L.lenbits=7,st={bits:L.lenbits},rt=v(0,L.lens,0,19,L.lencode,0,L.work,st),L.lenbits=st.bits,rt){U.msg="invalid code lengths set",L.mode=C;break}L.have=0,L.mode=19;case 19:for(;L.have<L.nlen+L.ndist;){for(;We=(Ft=L.lencode[ue&(1<<L.lenbits)-1])>>>16&255,oe=65535&Ft,!((De=Ft>>>24)<=I);){if(me===0)break e;me--,ue+=ee[he++]<<I,I+=8}if(oe<16)ue>>>=De,I-=De,L.lens[L.have++]=oe;else{if(oe===16){for(at=De+2;I<at;){if(me===0)break e;me--,ue+=ee[he++]<<I,I+=8}if(ue>>>=De,I-=De,L.have===0){U.msg="invalid bit length repeat",L.mode=C;break}Ie=L.lens[L.have-1],X=3+(3&ue),ue>>>=2,I-=2}else if(oe===17){for(at=De+3;I<at;){if(me===0)break e;me--,ue+=ee[he++]<<I,I+=8}I-=De,Ie=0,X=3+(7&(ue>>>=De)),ue>>>=3,I-=3}else{for(at=De+7;I<at;){if(me===0)break e;me--,ue+=ee[he++]<<I,I+=8}I-=De,Ie=0,X=11+(127&(ue>>>=De)),ue>>>=7,I-=7}if(L.have+X>L.nlen+L.ndist){U.msg="invalid bit length repeat",L.mode=C;break}for(;X--;)L.lens[L.have++]=Ie}}if(L.mode===C)break;if(L.lens[256]===0){U.msg="invalid code -- missing end-of-block",L.mode=C;break}if(L.lenbits=9,st={bits:L.lenbits},rt=v(1,L.lens,0,L.nlen,L.lencode,0,L.work,st),L.lenbits=st.bits,rt){U.msg="invalid literal/lengths set",L.mode=C;break}if(L.distbits=6,L.distcode=L.distdyn,st={bits:L.distbits},rt=v(2,L.lens,L.nlen,L.ndist,L.distcode,0,L.work,st),L.distbits=st.bits,rt){U.msg="invalid distances set",L.mode=C;break}if(L.mode=20,Z===6)break e;case 20:L.mode=21;case 21:if(me>=6&&Me>=258){U.next_out=ge,U.avail_out=Me,U.next_in=he,U.avail_in=me,L.hold=ue,L.bits=I,u(U,se),ge=U.next_out,Ee=U.output,Me=U.avail_out,he=U.next_in,ee=U.input,me=U.avail_in,ue=L.hold,I=L.bits,L.mode===_&&(L.back=-1);break}for(L.back=0;We=(Ft=L.lencode[ue&(1<<L.lenbits)-1])>>>16&255,oe=65535&Ft,!((De=Ft>>>24)<=I);){if(me===0)break e;me--,ue+=ee[he++]<<I,I+=8}if(We&&!(240&We)){for(Ae=De,He=We,Ue=oe;We=(Ft=L.lencode[Ue+((ue&(1<<Ae+He)-1)>>Ae)])>>>16&255,oe=65535&Ft,!(Ae+(De=Ft>>>24)<=I);){if(me===0)break e;me--,ue+=ee[he++]<<I,I+=8}ue>>>=Ae,I-=Ae,L.back+=Ae}if(ue>>>=De,I-=De,L.back+=De,L.length=oe,We===0){L.mode=26;break}if(32&We){L.back=-1,L.mode=_;break}if(64&We){U.msg="invalid literal/length code",L.mode=C;break}L.extra=15&We,L.mode=22;case 22:if(L.extra){for(at=L.extra;I<at;){if(me===0)break e;me--,ue+=ee[he++]<<I,I+=8}L.length+=ue&(1<<L.extra)-1,ue>>>=L.extra,I-=L.extra,L.back+=L.extra}L.was=L.length,L.mode=23;case 23:for(;We=(Ft=L.distcode[ue&(1<<L.distbits)-1])>>>16&255,oe=65535&Ft,!((De=Ft>>>24)<=I);){if(me===0)break e;me--,ue+=ee[he++]<<I,I+=8}if(!(240&We)){for(Ae=De,He=We,Ue=oe;We=(Ft=L.distcode[Ue+((ue&(1<<Ae+He)-1)>>Ae)])>>>16&255,oe=65535&Ft,!(Ae+(De=Ft>>>24)<=I);){if(me===0)break e;me--,ue+=ee[he++]<<I,I+=8}ue>>>=Ae,I-=Ae,L.back+=Ae}if(ue>>>=De,I-=De,L.back+=De,64&We){U.msg="invalid distance code",L.mode=C;break}L.offset=oe,L.extra=15&We,L.mode=24;case 24:if(L.extra){for(at=L.extra;I<at;){if(me===0)break e;me--,ue+=ee[he++]<<I,I+=8}L.offset+=ue&(1<<L.extra)-1,ue>>>=L.extra,I-=L.extra,L.back+=L.extra}if(L.offset>L.dmax){U.msg="invalid distance too far back",L.mode=C;break}L.mode=25;case 25:if(Me===0)break e;if(X=se-Me,L.offset>X){if((X=L.offset-X)>L.whave&&L.sane){U.msg="invalid distance too far back",L.mode=C;break}X>L.wnext?(X-=L.wnext,Re=L.wsize-X):Re=L.wnext-X,X>L.length&&(X=L.length),fe=L.window}else fe=Ee,Re=ge-L.offset,X=L.length;X>Me&&(X=Me),Me-=X,L.length-=X;do Ee[ge++]=fe[Re++];while(--X);L.length===0&&(L.mode=21);break;case 26:if(Me===0)break e;Ee[ge++]=L.length,Me--,L.mode=21;break;case 27:if(L.wrap){for(;I<32;){if(me===0)break e;me--,ue|=ee[he++]<<I,I+=8}if(se-=Me,U.total_out+=se,L.total+=se,se&&(U.adler=L.check=L.flags?D(L.check,Ee,se,ge-se):p(L.check,Ee,se,ge-se)),se=Me,(L.flags?ue:w(ue))!==L.check){U.msg="incorrect data check",L.mode=C;break}ue=0,I=0}L.mode=28;case 28:if(L.wrap&&L.flags){for(;I<32;){if(me===0)break e;me--,ue+=ee[he++]<<I,I+=8}if(ue!==(4294967295&L.total)){U.msg="incorrect length check",L.mode=C;break}ue=0,I=0}L.mode=29;case 29:rt=1;break e;case C:rt=-3;break e;case 31:return-4;default:return m}return U.next_out=ge,U.avail_out=Me,U.next_in=he,U.avail_in=me,L.hold=ue,L.bits=I,(L.wsize||se!==U.avail_out&&L.mode<C&&(L.mode<27||Z!==4))&&V(U,U.output,U.next_out,se-U.avail_out)?(L.mode=31,-4):(ce-=U.avail_in,se-=U.avail_out,U.total_in+=ce,U.total_out+=se,L.total+=se,L.wrap&&se&&(U.adler=L.check=L.flags?D(L.check,Ee,se,U.next_out-se):p(L.check,Ee,se,U.next_out-se)),U.data_type=L.bits+(L.last?64:0)+(L.mode===_?128:0)+(L.mode===20||L.mode===15?256:0),(ce===0&&se===0||Z===4)&&rt===0&&(rt=-5),rt)},n.inflateEnd=function(U){if(!U||!U.state)return m;var Z=U.state;return Z.window&&(Z.window=null),U.state=null,0},n.inflateGetHeader=function(U,Z){var L;return U&&U.state&&2&(L=U.state).wrap?(L.head=Z,Z.done=!1,0):m},n.inflateSetDictionary=function(U,Z){var L,ee=Z.length;return U&&U.state?(L=U.state).wrap!==0&&L.mode!==11?m:L.mode===11&&p(1,Z,ee,0)!==L.check?-3:V(U,Z,ee,ee)?(L.mode=31,-4):(L.havedict=1,0):m},n.inflateInfo="pako inflate (from Nodeca project)"},670:r=>{r.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},681:r=>{r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},697:(r,n,a)=>{var c=a(981);function p(oe){for(var Ae=oe.length;--Ae>=0;)oe[Ae]=0}var D=256,u=286,v=30,m=15,_=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],C=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],w=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],k=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],F=new Array(576);p(F);var T=new Array(60);p(T);var z=new Array(512);p(z);var Q=new Array(256);p(Q);var J=new Array(29);p(J);var K,b,N,V=new Array(v);function U(oe,Ae,He,Ue,Ie){this.static_tree=oe,this.extra_bits=Ae,this.extra_base=He,this.elems=Ue,this.max_length=Ie,this.has_stree=oe&&oe.length}function Z(oe,Ae){this.dyn_tree=oe,this.max_code=0,this.stat_desc=Ae}function L(oe){return oe<256?z[oe]:z[256+(oe>>>7)]}function ee(oe,Ae){oe.pending_buf[oe.pending++]=255&Ae,oe.pending_buf[oe.pending++]=Ae>>>8&255}function Ee(oe,Ae,He){oe.bi_valid>16-He?(oe.bi_buf|=Ae<<oe.bi_valid&65535,ee(oe,oe.bi_buf),oe.bi_buf=Ae>>16-oe.bi_valid,oe.bi_valid+=He-16):(oe.bi_buf|=Ae<<oe.bi_valid&65535,oe.bi_valid+=He)}function he(oe,Ae,He){Ee(oe,He[2*Ae],He[2*Ae+1])}function ge(oe,Ae){var He=0;do He|=1&oe,oe>>>=1,He<<=1;while(--Ae>0);return He>>>1}function me(oe,Ae,He){var Ue,Ie,rt=new Array(16),st=0;for(Ue=1;Ue<=m;Ue++)rt[Ue]=st=st+He[Ue-1]<<1;for(Ie=0;Ie<=Ae;Ie++){var at=oe[2*Ie+1];at!==0&&(oe[2*Ie]=ge(rt[at]++,at))}}function Me(oe){var Ae;for(Ae=0;Ae<u;Ae++)oe.dyn_ltree[2*Ae]=0;for(Ae=0;Ae<v;Ae++)oe.dyn_dtree[2*Ae]=0;for(Ae=0;Ae<19;Ae++)oe.bl_tree[2*Ae]=0;oe.dyn_ltree[512]=1,oe.opt_len=oe.static_len=0,oe.last_lit=oe.matches=0}function ue(oe){oe.bi_valid>8?ee(oe,oe.bi_buf):oe.bi_valid>0&&(oe.pending_buf[oe.pending++]=oe.bi_buf),oe.bi_buf=0,oe.bi_valid=0}function I(oe,Ae,He,Ue){var Ie=2*Ae,rt=2*He;return oe[Ie]<oe[rt]||oe[Ie]===oe[rt]&&Ue[Ae]<=Ue[He]}function ce(oe,Ae,He){for(var Ue=oe.heap[He],Ie=He<<1;Ie<=oe.heap_len&&(Ie<oe.heap_len&&I(Ae,oe.heap[Ie+1],oe.heap[Ie],oe.depth)&&Ie++,!I(Ae,Ue,oe.heap[Ie],oe.depth));)oe.heap[He]=oe.heap[Ie],He=Ie,Ie<<=1;oe.heap[He]=Ue}function se(oe,Ae,He){var Ue,Ie,rt,st,at=0;if(oe.last_lit!==0)do Ue=oe.pending_buf[oe.d_buf+2*at]<<8|oe.pending_buf[oe.d_buf+2*at+1],Ie=oe.pending_buf[oe.l_buf+at],at++,Ue===0?he(oe,Ie,Ae):(he(oe,(rt=Q[Ie])+D+1,Ae),(st=_[rt])!==0&&Ee(oe,Ie-=J[rt],st),he(oe,rt=L(--Ue),He),(st=C[rt])!==0&&Ee(oe,Ue-=V[rt],st));while(at<oe.last_lit);he(oe,256,Ae)}function X(oe,Ae){var He,Ue,Ie,rt=Ae.dyn_tree,st=Ae.stat_desc.static_tree,at=Ae.stat_desc.has_stree,Ft=Ae.stat_desc.elems,Et=-1;for(oe.heap_len=0,oe.heap_max=573,He=0;He<Ft;He++)rt[2*He]!==0?(oe.heap[++oe.heap_len]=Et=He,oe.depth[He]=0):rt[2*He+1]=0;for(;oe.heap_len<2;)rt[2*(Ie=oe.heap[++oe.heap_len]=Et<2?++Et:0)]=1,oe.depth[Ie]=0,oe.opt_len--,at&&(oe.static_len-=st[2*Ie+1]);for(Ae.max_code=Et,He=oe.heap_len>>1;He>=1;He--)ce(oe,rt,He);Ie=Ft;do He=oe.heap[1],oe.heap[1]=oe.heap[oe.heap_len--],ce(oe,rt,1),Ue=oe.heap[1],oe.heap[--oe.heap_max]=He,oe.heap[--oe.heap_max]=Ue,rt[2*Ie]=rt[2*He]+rt[2*Ue],oe.depth[Ie]=(oe.depth[He]>=oe.depth[Ue]?oe.depth[He]:oe.depth[Ue])+1,rt[2*He+1]=rt[2*Ue+1]=Ie,oe.heap[1]=Ie++,ce(oe,rt,1);while(oe.heap_len>=2);oe.heap[--oe.heap_max]=oe.heap[1],(function(or,ar){var kr,Ar,pr,vr,xr,fi,Rr=ar.dyn_tree,Ir=ar.max_code,Di=ar.stat_desc.static_tree,wi=ar.stat_desc.has_stree,Hi=ar.stat_desc.extra_bits,pe=ar.stat_desc.extra_base,Se=ar.stat_desc.max_length,Oe=0;for(vr=0;vr<=m;vr++)or.bl_count[vr]=0;for(Rr[2*or.heap[or.heap_max]+1]=0,kr=or.heap_max+1;kr<573;kr++)(vr=Rr[2*Rr[2*(Ar=or.heap[kr])+1]+1]+1)>Se&&(vr=Se,Oe++),Rr[2*Ar+1]=vr,Ar>Ir||(or.bl_count[vr]++,xr=0,Ar>=pe&&(xr=Hi[Ar-pe]),fi=Rr[2*Ar],or.opt_len+=fi*(vr+xr),wi&&(or.static_len+=fi*(Di[2*Ar+1]+xr)));if(Oe!==0){do{for(vr=Se-1;or.bl_count[vr]===0;)vr--;or.bl_count[vr]--,or.bl_count[vr+1]+=2,or.bl_count[Se]--,Oe-=2}while(Oe>0);for(vr=Se;vr!==0;vr--)for(Ar=or.bl_count[vr];Ar!==0;)(pr=or.heap[--kr])>Ir||(Rr[2*pr+1]!==vr&&(or.opt_len+=(vr-Rr[2*pr+1])*Rr[2*pr],Rr[2*pr+1]=vr),Ar--)}})(oe,Ae),me(rt,Et,oe.bl_count)}function Re(oe,Ae,He){var Ue,Ie,rt=-1,st=Ae[1],at=0,Ft=7,Et=4;for(st===0&&(Ft=138,Et=3),Ae[2*(He+1)+1]=65535,Ue=0;Ue<=He;Ue++)Ie=st,st=Ae[2*(Ue+1)+1],++at<Ft&&Ie===st||(at<Et?oe.bl_tree[2*Ie]+=at:Ie!==0?(Ie!==rt&&oe.bl_tree[2*Ie]++,oe.bl_tree[32]++):at<=10?oe.bl_tree[34]++:oe.bl_tree[36]++,at=0,rt=Ie,st===0?(Ft=138,Et=3):Ie===st?(Ft=6,Et=3):(Ft=7,Et=4))}function fe(oe,Ae,He){var Ue,Ie,rt=-1,st=Ae[1],at=0,Ft=7,Et=4;for(st===0&&(Ft=138,Et=3),Ue=0;Ue<=He;Ue++)if(Ie=st,st=Ae[2*(Ue+1)+1],!(++at<Ft&&Ie===st)){if(at<Et)do he(oe,Ie,oe.bl_tree);while(--at!==0);else Ie!==0?(Ie!==rt&&(he(oe,Ie,oe.bl_tree),at--),he(oe,16,oe.bl_tree),Ee(oe,at-3,2)):at<=10?(he(oe,17,oe.bl_tree),Ee(oe,at-3,3)):(he(oe,18,oe.bl_tree),Ee(oe,at-11,7));at=0,rt=Ie,st===0?(Ft=138,Et=3):Ie===st?(Ft=6,Et=3):(Ft=7,Et=4)}}p(V);var De=!1;function We(oe,Ae,He,Ue){Ee(oe,0+(Ue?1:0),3),(function(Ie,rt,st,at){ue(Ie),ee(Ie,st),ee(Ie,~st),c.arraySet(Ie.pending_buf,Ie.window,rt,st,Ie.pending),Ie.pending+=st})(oe,Ae,He)}n._tr_init=function(oe){De||((function(){var Ae,He,Ue,Ie,rt,st=new Array(16);for(Ue=0,Ie=0;Ie<28;Ie++)for(J[Ie]=Ue,Ae=0;Ae<1<<_[Ie];Ae++)Q[Ue++]=Ie;for(Q[Ue-1]=Ie,rt=0,Ie=0;Ie<16;Ie++)for(V[Ie]=rt,Ae=0;Ae<1<<C[Ie];Ae++)z[rt++]=Ie;for(rt>>=7;Ie<v;Ie++)for(V[Ie]=rt<<7,Ae=0;Ae<1<<C[Ie]-7;Ae++)z[256+rt++]=Ie;for(He=0;He<=m;He++)st[He]=0;for(Ae=0;Ae<=143;)F[2*Ae+1]=8,Ae++,st[8]++;for(;Ae<=255;)F[2*Ae+1]=9,Ae++,st[9]++;for(;Ae<=279;)F[2*Ae+1]=7,Ae++,st[7]++;for(;Ae<=287;)F[2*Ae+1]=8,Ae++,st[8]++;for(me(F,287,st),Ae=0;Ae<v;Ae++)T[2*Ae+1]=5,T[2*Ae]=ge(Ae,5);K=new U(F,_,257,u,m),b=new U(T,C,0,v,m),N=new U(new Array(0),w,0,19,7)})(),De=!0),oe.l_desc=new Z(oe.dyn_ltree,K),oe.d_desc=new Z(oe.dyn_dtree,b),oe.bl_desc=new Z(oe.bl_tree,N),oe.bi_buf=0,oe.bi_valid=0,Me(oe)},n._tr_stored_block=We,n._tr_flush_block=function(oe,Ae,He,Ue){var Ie,rt,st=0;oe.level>0?(oe.strm.data_type===2&&(oe.strm.data_type=(function(at){var Ft,Et=4093624447;for(Ft=0;Ft<=31;Ft++,Et>>>=1)if(1&Et&&at.dyn_ltree[2*Ft]!==0)return 0;if(at.dyn_ltree[18]!==0||at.dyn_ltree[20]!==0||at.dyn_ltree[26]!==0)return 1;for(Ft=32;Ft<D;Ft++)if(at.dyn_ltree[2*Ft]!==0)return 1;return 0})(oe)),X(oe,oe.l_desc),X(oe,oe.d_desc),st=(function(at){var Ft;for(Re(at,at.dyn_ltree,at.l_desc.max_code),Re(at,at.dyn_dtree,at.d_desc.max_code),X(at,at.bl_desc),Ft=18;Ft>=3&&at.bl_tree[2*k[Ft]+1]===0;Ft--);return at.opt_len+=3*(Ft+1)+5+5+4,Ft})(oe),Ie=oe.opt_len+3+7>>>3,(rt=oe.static_len+3+7>>>3)<=Ie&&(Ie=rt)):Ie=rt=He+5,He+4<=Ie&&Ae!==-1?We(oe,Ae,He,Ue):oe.strategy===4||rt===Ie?(Ee(oe,2+(Ue?1:0),3),se(oe,F,T)):(Ee(oe,4+(Ue?1:0),3),(function(at,Ft,Et,or){var ar;for(Ee(at,Ft-257,5),Ee(at,Et-1,5),Ee(at,or-4,4),ar=0;ar<or;ar++)Ee(at,at.bl_tree[2*k[ar]+1],3);fe(at,at.dyn_ltree,Ft-1),fe(at,at.dyn_dtree,Et-1)})(oe,oe.l_desc.max_code+1,oe.d_desc.max_code+1,st+1),se(oe,oe.dyn_ltree,oe.dyn_dtree)),Me(oe),Ue&&ue(oe)},n._tr_tally=function(oe,Ae,He){return oe.pending_buf[oe.d_buf+2*oe.last_lit]=Ae>>>8&255,oe.pending_buf[oe.d_buf+2*oe.last_lit+1]=255&Ae,oe.pending_buf[oe.l_buf+oe.last_lit]=255&He,oe.last_lit++,Ae===0?oe.dyn_ltree[2*He]++:(oe.matches++,Ae--,oe.dyn_ltree[2*(Q[He]+D+1)]++,oe.dyn_dtree[2*L(Ae)]++),oe.last_lit===oe.lit_bufsize-1},n._tr_align=function(oe){Ee(oe,2,3),he(oe,256,F),(function(Ae){Ae.bi_valid===16?(ee(Ae,Ae.bi_buf),Ae.bi_buf=0,Ae.bi_valid=0):Ae.bi_valid>=8&&(Ae.pending_buf[Ae.pending++]=255&Ae.bi_buf,Ae.bi_buf>>=8,Ae.bi_valid-=8)})(oe)}},701:r=>{r.exports=function(n,a,c,p){for(var D=65535&n,u=n>>>16&65535,v=0;c!==0;){c-=v=c>2e3?2e3:c;do u=u+(D=D+a[p++]|0)|0;while(--v);D%=65521,u%=65521}return D|u<<16}},746:r=>{r.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},788:(r,n,a)=>{var c={};(0,a(981).assign)(c,a(71),a(3),a(681)),r.exports=c},797:(r,n,a)=>{a.r(n),a.d(n,{VASP:()=>D});var c=a(378),p=a(392);function D(u,v={}){var m=[[]],_={};const C=v.assignBonds===void 0||v.assignBonds;var w=u.replace(/^\s+/,"").split(/\r?\n/);if(w.length<3)return m;if(!w[1].match(/\d+/))return console.log("Warning: second line of the vasp structure file must be a number"),m;if(_.length=parseFloat(w[1]),_.length<0)return console.log("Warning: Vasp implementation for negative lattice lengths is not yet available"),m;_.xVec=new Float32Array(w[2].replace(/^\s+/,"").split(/\s+/)),_.yVec=new Float32Array(w[3].replace(/^\s+/,"").split(/\s+/)),_.zVec=new Float32Array(w[4].replace(/^\s+/,"").split(/\s+/));var k=new c.Matrix3(_.xVec[0],_.xVec[1],_.xVec[2],_.yVec[0],_.yVec[1],_.yVec[2],_.zVec[0],_.zVec[1],_.zVec[2]);k.multiplyScalar(_.length),m.modelData=[{symmetries:[],cryst:{matrix:k}}];var F=w[5].trim().split(/\s+/),T=new Int16Array(w[6].trim().split(/\s+/)),z=w[7].trim(),Q=!1;if(z.match(/S/)&&(Q=!0,z=w[8].trim()),z.toLowerCase()[0]=="c")z="cartesian";else{if(z.toLowerCase()[0]!="d")return console.log("Warning: Unknown vasp mode in POSCAR file: mode must be either C(artesian) or D(irect)"),m;z="direct"}if(F.length!=T.length)return console.log("Warning: declaration of atomary species wrong:"),console.log(F),console.log(T),m;Q?w.splice(0,9):w.splice(0,8);for(var J=0,K=0,b=F.length;K<b;K++){for(var N=F[K],V=0,U=T[K];V<U;V++){var Z=new Float32Array(w[J+V].trim().split(/\s+/)),L={};L.elem=N,z=="cartesian"?(L.x=_.length*Z[0],L.y=_.length*Z[1],L.z=_.length*Z[2]):(L.x=_.length*(Z[0]*_.xVec[0]+Z[1]*_.yVec[0]+Z[2]*_.zVec[0]),L.y=_.length*(Z[0]*_.xVec[1]+Z[1]*_.yVec[1]+Z[2]*_.zVec[1]),L.z=_.length*(Z[0]*_.xVec[2]+Z[1]*_.yVec[2]+Z[2]*_.zVec[2])),L.bonds=[],L.bondOrder=[],m[0].push(L)}J+=T[K]}if(C)for(let ee=0;ee<m.length;ee++)(0,p.assignBonds)(m[ee],v);return m}},834:r=>{r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},848:(r,n,a)=>{a.r(n),a.d(n,{VolumeData:()=>m});var c=a(864),p=a(529),D=a(797),u=a(865),v=a(75);class m{constructor(C,w,k){if(this.unit={x:1,y:1,z:1},this.origin={x:0,y:0,z:0},this.size={x:0,y:0,z:0},this.data=new Float32Array([]),this.matrix=null,this.inversematrix=null,this.isbinary=new Set(["ccp4","CCP4"]),this.getCoordinates=function(J){var K=J/(this.size.y*this.size.z),b=J%(this.size.y*this.size.z),N=J%this.size.z;return K*=this.unit.x,b*=this.unit.y,N*=this.unit.z,{x:K+=this.origin.x,y:b+=this.origin.y,z:N+=this.origin.z}},this.vasp=function(J){var K=J.replace(/^\s+/,"").split(/[\n\r]/),b=(0,D.VASP)(J)[0].length;if(b==0)return console.warn("No good formating of CHG or CHGCAR file, not atomic information provided in the file."),void(this.data=[]);var N,V=1.889725992,U=parseFloat(K[1]);N=K[2].replace(/^\s+/,"").split(/\s+/);var Z=new p.Vector3(parseFloat(N[0]),parseFloat(N[1]),parseFloat(N[2])).multiplyScalar(U*V);N=K[3].replace(/^\s+/,"").split(/\s+/);var L=new p.Vector3(parseFloat(N[0]),parseFloat(N[1]),parseFloat(N[2])).multiplyScalar(U*V);N=K[4].replace(/^\s+/,"").split(/\s+/);var ee=new p.Vector3(parseFloat(N[0]),parseFloat(N[1]),parseFloat(N[2])).multiplyScalar(U*V),Ee=Z.x*(L.y*ee.z-ee.y*L.z)-L.x*(Z.y*ee.z-ee.y*Z.z)+ee.x*(Z.y*L.z-L.y*Z.z),he=1/(Ee=Math.abs(Ee)/Math.pow(V,3));K.splice(0,8+b+1);var ge=K[0].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),me=Math.abs(parseFloat(ge[0])),Me=Math.abs(parseFloat(ge[1])),ue=Math.abs(parseFloat(ge[2])),I=this.origin=new p.Vector3(0,0,0);this.size={x:me,y:Me,z:ue},this.unit=new p.Vector3(Z.x,L.y,ee.z),Z=Z.multiplyScalar(1/(V*me)),L=L.multiplyScalar(1/(V*Me)),ee=ee.multiplyScalar(1/(V*ue)),Z.y==0&&Z.z==0&&L.x==0&&L.z==0&&ee.x==0&&ee.y==0||(this.matrix=new p.Matrix4(Z.x,L.x,ee.x,0,Z.y,L.y,ee.y,0,Z.z,L.z,ee.z,0,0,0,0,1),this.matrix=this.matrix.multiplyMatrices(this.matrix,new p.Matrix4().makeTranslation(I.x,I.y,I.z)),this.origin=new p.Vector3(0,0,0),this.unit=new p.Vector3(1,1,1)),K.splice(0,1);var ce=K.join(" "),se=(ce=ce.replace(/^\s+/,"")).split(/[\s\r]+/);se.splice(me*Me*ue+1);for(var X=Float32Array.from(se,parseFloat),Re=0;Re<X.length;Re++)X[Re]=X[Re]*he*.036749309;this.data=X},this.dx=function(J){var K,b=J.split(/[\n\r]+/),N=/gridpositions\s+counts\s+(\d+)\s+(\d+)\s+(\d+)/,V=/^origin\s+(\S+)\s+(\S+)\s+(\S+)/,U=/^delta\s+(\S+)\s+(\S+)\s+(\S+)/,Z=/data follows/,L=0;for(L=0;L<b.length;L++){var ee=b[L];if(K=N.exec(ee)){var Ee=parseInt(K[1]),he=parseInt(K[2]),ge=parseInt(K[3]);this.size={x:Ee,y:he,z:ge}}else if(K=U.exec(ee)){var me=parseFloat(K[1]);if(parseFloat(K[2])==0&&parseFloat(K[3])==0||console.warn("Non-orthogonal delta matrix not currently supported in dx format"),ee=b[L+=1],(K=U.exec(ee))==null)return void console.error("Parse error in dx delta matrix");var Me=parseFloat(K[2]);if(parseFloat(K[1])==0&&parseFloat(K[3])==0||console.warn("Non-orthogonal delta matrix not currently supported in dx format"),ee=b[L+=1],(K=U.exec(ee))==null)return void console.error("Parse error in dx delta matrix");var ue=parseFloat(K[3]);parseFloat(K[1])==0&&parseFloat(K[2])==0||console.warn("Non-orthogonal delta matrix not currently supported in dx format"),this.unit=new p.Vector3(me,Me,ue)}else if(K=V.exec(ee)){var I=parseFloat(K[1]),ce=parseFloat(K[2]),se=parseFloat(K[3]);this.origin=new p.Vector3(I,ce,se)}else if(K=Z.exec(ee))break}if(L+=1,this.size&&this.origin&&this.unit&&this.size){var X=b.splice(L).join(" ").split(/[\s\r]+/);this.data=Float32Array.from(X,parseFloat)}else console.error("Error parsing dx format")},w=w.toLowerCase(),/\.gz$/.test(w)){w=w.replace(/\.gz$/,"");try{this[w]&&this.isbinary.has(w)?(typeof C=="string"&&(C=(0,c.base64ToArray)(C)),C=(0,v.inflate)(C)):C=new TextDecoder("utf-8").decode((0,v.inflate)(C))}catch(J){console.error(J)}}if(this[w]&&(this.isbinary.has(w)&&typeof C=="string"&&(C=(0,c.base64ToArray)(C)),this[w](C)),k){if(k.negate)for(let J=0,K=this.data.length;J<K;J++)this.data[J]=-this.data[J];if(k.normalize){var F=0;for(let J=0,K=this.data.length;J<K;J++)F+=this.data[J];var T=F/this.data.length;F=0;for(let J=0,K=this.data.length;J<K;J++){var z=this.data[J]-T;F+=z*z}var Q=F/this.data.length;for(let J=0,K=this.data.length;J<K;J++)this.data[J]=(this.data[J]-T)/Q}}}getIndex(C,w,k){if(this.matrix){this.inversematrix==null&&(this.inversematrix=new p.Matrix4().getInverse(this.matrix));var F=new p.Vector3(C,w,k);C=(F=F.applyMatrix4(this.inversematrix)).x,w=F.y,k=F.z}else C-=this.origin.x,w-=this.origin.y,k-=this.origin.z,C/=this.unit.x,w/=this.unit.y,k/=this.unit.z;return C=Math.round(C),w=Math.round(w),k=Math.round(k),C<0||C>=this.size.x||w<0||w>=this.size.y||k<0||k>=this.size.z?-1:C*this.size.y*this.size.z+w*this.size.z+k}getVal(C,w,k){let F=this.getIndex(C,w,k);return F<0?0:this.data[F]}cube(C){var w=C.split(/\r?\n/);if(!(w.length<6)){var k=(0,u.CUBE)(C,{}).modelData[0].cryst,F=w[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),T=parseFloat(F[0]),z=Math.abs(T);this.origin=k.origin,this.size=k.size,this.unit=k.unit,this.matrix=k.matrix4;var Q=6;T<0&&Q++;var J=w.splice(z+Q).join(" "),K=(J=J.replace(/^\s+/,"")).split(/[\s\r]+/);this.data=Float32Array.from(K,parseFloat)}}ccp4(C){var w={};C=new Int8Array(C);var k=new Int32Array(C.buffer,0,56),F=new Float32Array(C.buffer,0,56),T=new DataView(C.buffer);if(w.MAP=String.fromCharCode(T.getUint8(208),T.getUint8(209),T.getUint8(210),T.getUint8(211)),w.MACHST=[T.getUint8(212),T.getUint8(213)],w.MACHST[0]===17&&w.MACHST[1]===17)for(var z=C.byteLength,Q=0;Q<z;Q+=4)T.setFloat32(Q,T.getFloat32(Q),!0);w.NX=k[0],w.NY=k[1],w.NZ=k[2],w.MODE=k[3],w.NXSTART=k[4],w.NYSTART=k[5],w.NZSTART=k[6],w.MX=k[7],w.MY=k[8],w.MZ=k[9],w.xlen=F[10],w.ylen=F[11],w.zlen=F[12],w.alpha=F[13],w.beta=F[14],w.gamma=F[15],w.MAPC=k[16],w.MAPR=k[17],w.MAPS=k[18],w.DMIN=F[19],w.DMAX=F[20],w.DMEAN=F[21],w.ISPG=k[22],w.NSYMBT=k[23],w.LSKFLG=k[24],w.originX=F[49],w.originY=F[50],w.originZ=F[51],w.ARMS=F[54];var J=w,K=[J.xlen,0,0],b=[J.ylen*Math.cos(Math.PI/180*J.gamma),J.ylen*Math.sin(Math.PI/180*J.gamma),0],N=[J.zlen*Math.cos(Math.PI/180*J.beta),J.zlen*(Math.cos(Math.PI/180*J.alpha)-Math.cos(Math.PI/180*J.gamma)*Math.cos(Math.PI/180*J.beta))/Math.sin(Math.PI/180*J.gamma),0];N[2]=Math.sqrt(J.zlen*J.zlen*Math.sin(Math.PI/180*J.beta)*Math.sin(Math.PI/180*J.beta)-N[1]*N[1]);var V=[0,K,b,N],U=[0,J.MX,J.MY,J.MZ],Z=[0,J.MAPC,J.MAPR,J.MAPS];this.matrix=new p.Matrix4,this.matrix.set(V[Z[1]][0]/U[Z[1]],V[Z[2]][0]/U[Z[2]],V[Z[3]][0]/U[Z[3]],0,V[Z[1]][1]/U[Z[1]],V[Z[2]][1]/U[Z[2]],V[Z[3]][1]/U[Z[3]],0,V[Z[1]][2]/U[Z[1]],V[Z[2]][2]/U[Z[2]],V[Z[3]][2]/U[Z[3]],0,0,0,0,1),this.matrix=this.matrix.multiplyMatrices(this.matrix,new p.Matrix4().makeTranslation(J.NXSTART+J.originX,J.NYSTART+J.originY,J.NZSTART+J.originZ)),this.origin=new p.Vector3(0,0,0),this.unit=new p.Vector3(1,1,1),this.size={x:w.NX,y:w.NY,z:w.NZ},this.dimensionorder=[w.MAPC,w.MAPR,w.MAPS];var L=new Float32Array(C.buffer,1024+w.NSYMBT),ee=w.NX,Ee=w.NY,he=w.NZ;this.data=new Float32Array(ee*Ee*he);for(let ge=0;ge<ee;ge++)for(let me=0;me<Ee;me++)for(let Me=0;Me<he;Me++)this.data[(ge*Ee+me)*he+Me]=L[(Me*Ee+me)*ee+ge]}}},864:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{PausableTimer:()=>PausableTimer,adjustVolumeStyle:()=>adjustVolumeStyle,base64ToArray:()=>base64ToArray,deepCopy:()=>deepCopy,download:()=>download,extend:()=>extend,get:()=>get,getAtomProperty:()=>getAtomProperty,getColorFromStyle:()=>getColorFromStyle,getElement:()=>getElement,getExtent:()=>getExtent,getPropertyRange:()=>getPropertyRange,getbin:()=>getbin,inflateString:()=>inflateString,isEmptyObject:()=>isEmptyObject,isNumeric:()=>isNumeric,makeFunction:()=>makeFunction,mergeGeos:()=>mergeGeos,specStringToObject:()=>specStringToObject});var _Gradient__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(546),_VolumeData__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(848),_colors__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(222),pako__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(75);function extend(r,n){for(var a in n)n.hasOwnProperty(a)&&n[a]!==void 0&&(r[a]=n[a]);return r}function deepCopy(r){let n,a,c;if(r==null)return{};if(typeof r!="object"||r===null)return r;for(c in n=Array.isArray(r)?[]:{},r)a=r[c],n[c]=deepCopy(a);return n}function isNumeric(r){var n=typeof r;return(n==="number"||n==="string")&&!isNaN(r-parseFloat(r))}function isEmptyObject(r){return Object.keys(r).length===0}function makeFunction(callback){return callback&&typeof callback=="string"&&(callback=eval("("+callback+")")),callback&&typeof callback!="function"?(console.warn("Invalid callback provided."),()=>{}):callback}function adjustVolumeStyle(r){r&&(!r.volformat||r.voldata instanceof _VolumeData__WEBPACK_IMPORTED_MODULE_1__.VolumeData||(r.voldata=new _VolumeData__WEBPACK_IMPORTED_MODULE_1__.VolumeData(r.voldata,r.volformat)),r.volscheme&&(r.volscheme=_Gradient__WEBPACK_IMPORTED_MODULE_0__.Gradient.getGradient(r.volscheme)))}function getExtent(r,n){var a,c,p,D,u,v,m,_,C,w,k=!n;if(a=c=p=9999,D=u=v=-9999,m=_=C=w=0,r.length===0)return[[0,0,0],[0,0,0],[0,0,0]];for(var F=0;F<r.length;F++){var T=r[F];if(T!==void 0&&isFinite(T.x)&&isFinite(T.y)&&isFinite(T.z)&&(w++,m+=T.x,_+=T.y,C+=T.z,a=a<T.x?a:T.x,c=c<T.y?c:T.y,p=p<T.z?p:T.z,D=D>T.x?D:T.x,u=u>T.y?u:T.y,v=v>T.z?v:T.z,T.symmetries&&k))for(var z=0;z<T.symmetries.length;z++)w++,m+=T.symmetries[z].x,_+=T.symmetries[z].y,C+=T.symmetries[z].z,a=a<T.symmetries[z].x?a:T.symmetries[z].x,c=c<T.symmetries[z].y?c:T.symmetries[z].y,p=p<T.symmetries[z].z?p:T.symmetries[z].z,D=D>T.symmetries[z].x?D:T.symmetries[z].x,u=u>T.symmetries[z].y?u:T.symmetries[z].y,v=v>T.symmetries[z].z?v:T.symmetries[z].z}return[[a,c,p],[D,u,v],[m/w,_/w,C/w]]}function getPropertyRange(r,n){for(var a=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,p=0,D=r.length;p<D;p++){var u=getAtomProperty(r[p],n);u!=null&&(u<a&&(a=u),u>c&&(c=u))}return isFinite(a)||isFinite(c)?isFinite(a)?isFinite(c)||(c=a):a=c:a=c=0,[a,c]}class PausableTimer{constructor(n,a,c){this.total_time_run=0,this.fn=n,this.arg=c,this.countdown=a,this.start_time=new Date().getTime(),this.ident=setTimeout(n,a,c)}cancel(){clearTimeout(this.ident)}pause(){clearTimeout(this.ident),this.total_time_run=new Date().getTime()-this.start_time}resume(){this.ident=setTimeout(this.fn,Math.max(0,this.countdown-this.total_time_run),this.arg)}}function base64ToArray(r){for(var n=window.atob(r),a=n.length,c=new Uint8Array(a),p=0;p<a;p++)c[p]=n.charCodeAt(p);return c}function getAtomProperty(r,n){var a=null;return r.properties&&r.properties[n]!==void 0?a=r.properties[n]:r[n]!==void 0&&(a=r[n]),a}function mergeGeos(r,n){var a=n.geometry;a!==void 0&&r.geometryGroups.push(a.geometryGroups[0])}function specStringToObject(r){if(typeof r=="object"||r===void 0||r==null)return r;try{return JSON.parse(r)}catch{}var n=function(k){return isNumeric(k)?Math.floor(parseFloat(k))==parseInt(k)||k.indexOf(".")>=0?parseFloat(k):parseInt(k):k==="true"||k!=="false"&&k},a={};if((r=r.replace(/%7E/g,"~"))==="all")return a;for(var c=r.split(";"),p=0;p<c.length;p++){var D=c[p].split(":"),u=D[0],v={},m=D[1];if(m)if((m=m.replace(/~/g,"=")).indexOf("=")!==-1)for(var _=m.split(","),C=0;C<_.length;C++){var w=_[C].split("=",2);v[w[0]]=n(w[1])}else v=m.indexOf(",")!==-1?m.split(","):n(m);a[u]=v}return a}function checkStatus(r){if(!r.ok)throw new Error(`HTTP ${r.status} - ${r.statusText}`);return r}function get(r,n){var a=fetch(r).then(checkStatus).then(c=>c.text());return n?a.then(n):a}function getbin(r,n,a,c){var p;return p=a=="POST"?fetch(r,{method:"POST",body:c}).then(D=>checkStatus(D)).then(D=>D.arrayBuffer()):fetch(r).then(D=>checkStatus(D)).then(D=>D.arrayBuffer()),n?p.then(n):p}function download(r,n,a,c){var p="",D="",u="",v=null,m=n.addModel();if(r.indexOf(":")<0&&(r=r.length==4?"pdb:"+r:isNaN(r)?"url:"+r:"cid:"+r),r.substring(0,5)=="mmtf:"&&(console.warn("WARNING: MMTF now deprecated.  Reverting to bcif."),r="bcif:"+r.slice(5)),r.substring(0,5)==="bcif:")r=r.substring(5).toUpperCase(),u="https://models.rcsb.org/"+r+".bcif.gz",a&&a.noComputeSecondaryStructure===void 0&&(a.noComputeSecondaryStructure=!0),v=new Promise(function(C){getbin(u).then(function(w){m.addMolData(w,"bcif.gz",a),n.zoomTo(),n.render(),C(m)},function(){console.error("fetch of "+u+" failed.")})});else{if(r.substring(0,4)==="pdb:"){if(p="bcif",a&&a.format&&(p=a.format),a&&a.noComputeSecondaryStructure===void 0&&(a.noComputeSecondaryStructure=!0),!(r=r.substring(4).toUpperCase()).match(/^[1-9][A-Za-z0-9]{3}$/))return void alert("Wrong PDB ID");p=="bcif"?u="https://models.rcsb.org/"+r.toUpperCase()+".bcif.gz":(D=a&&a.pdbUri?a.pdbUri:"https://files.rcsb.org/view/",u=D+r+"."+p)}else if(r.substring(0,4)=="cid:"){if(p="sdf",!(r=r.substring(4)).match(/^[0-9]+$/))return void alert("Wrong Compound ID");u="https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+r+"/SDF?record_type=3d"}else r.substring(0,4)=="url:"&&(u=r.substring(4),p=u);var _=function(C){m.addMolData(C,p,a),n.zoomTo(),n.render()};v=new Promise(function(C){p=="bcif"?getbin(u).then(function(w){_(w),C(m)}).catch(function(){D=a&&a.pdbUri?a.pdbUri:"https://files.rcsb.org/view/",u=D+r+".pdb",p="pdb",console.warn("falling back to pdb format"),get(u).then(function(w){_(w),C(m)}).catch(function(w){_(""),C(m),console.error("fetch of "+u+" failed: "+w.statusText)})}):get(u).then(function(w){_(w),C(m)}).catch(function(w){_(""),C(m),console.error("fetch of "+u+" failed: "+w.statusText)})})}return c?(v.then(function(C){c(C)}),m):v}function getColorFromStyle(r,n){let a=n.colorscheme;if(_colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[a]!==void 0)a=_colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[a];else if(typeof a=="string"&&a.endsWith("Carbon")){let D=a.substring(0,a.lastIndexOf("Carbon")).toLowerCase();if(_colors__WEBPACK_IMPORTED_MODULE_2__.htmlColors[D]!==void 0){let u=Object.assign({},_colors__WEBPACK_IMPORTED_MODULE_2__.elementColors.defaultColors);u.C=_colors__WEBPACK_IMPORTED_MODULE_2__.htmlColors[D],_colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[a]={prop:"elem",map:u},a=_colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[a]}}let c=r.color;if(n.color!==void 0&&n.color!="spectrum"&&(c=n.color),a!==void 0){let D,u;if(_colors__WEBPACK_IMPORTED_MODULE_2__.elementColors[a]!==void 0)a=_colors__WEBPACK_IMPORTED_MODULE_2__.elementColors[a],a[r[a.prop]]!==void 0&&(c=a.map[r[a.prop]]);else if(a[r[a.prop]]!==void 0)c=a.map[r[a.prop]];else if(a.prop!==void 0&&a.gradient!==void 0){D=a.prop;var p=a.gradient;p instanceof _Gradient__WEBPACK_IMPORTED_MODULE_0__.GradientType||(p=(0,_Gradient__WEBPACK_IMPORTED_MODULE_0__.getGradient)(a));let v=p.range()||[-1,1];u=getAtomProperty(r,D),u!=null&&(c=p.valueToHex(u,v))}else a.prop!==void 0&&a.map!==void 0?(D=a.prop,u=getAtomProperty(r,D),a.map[u]!==void 0&&(c=a.map[u])):n.colorscheme[r.elem]!==void 0?c=n.colorscheme[r.elem]:console.warn("Could not interpret colorscheme "+a)}else n.colorfunc!==void 0&&(c=n.colorfunc(r));return _colors__WEBPACK_IMPORTED_MODULE_2__.CC.color(c)}function getElement(r){let n=r;return typeof r=="string"?n=document.querySelector("#"+r):typeof r=="object"&&r.get&&(n=r.get(0)),n}function inflateString(r,n=!0){let a;return a=typeof r=="string"?new TextEncoder().encode(r):new Uint8Array(r),(0,pako__WEBPACK_IMPORTED_MODULE_3__.inflate)(a,{to:n?"string":null})}},865:(r,n,a)=>{a.r(n),a.d(n,{CUBE:()=>u});var c=a(378),p=a(392);const D={1:"H",2:"He",3:"Li",4:"Be",5:"B",6:"C",7:"N",8:"O",9:"F",10:"Ne",11:"Na",12:"Mg",13:"Al",14:"Si",15:"P",16:"S",17:"Cl",18:"Ar",19:"K",20:"Ca",21:"Sc",22:"Ti",23:"V",24:"Cr",25:"Mn",26:"Fe",27:"Co",28:"Ni",29:"Cu",30:"Zn",31:"Ga",32:"Ge",33:"As",34:"Se",35:"Br",36:"Kr",37:"Rb",38:"Sr",39:"Y",40:"Zr",41:"Nb",42:"Mo",43:"Tc",44:"Ru",45:"Rh",46:"Pd",47:"Ag",48:"Cd",49:"In",50:"Sn",51:"Sb",52:"Te",53:"I",54:"Xe",55:"Cs",56:"Ba",71:"Lu",72:"Hf",73:"Ta",74:"W",75:"Re",76:"Os",77:"Ir",78:"Pt",79:"Au",80:"Hg",81:"Tl",82:"Pb",83:"Bi",84:"Po",85:"At",86:"Rn",87:"Fr",88:"Ra",104:"Rf",105:"Db",106:"Sg",107:"Bh",108:"Hs",109:"Mt",110:"Ds",111:"Rg",112:"Cn",113:"Nh",114:"Fl",115:"Mc",116:"Lv",117:"Ts",118:"Og",57:"La",58:"Ce",59:"Pr",60:"Nd",61:"Pm",62:"Sm",63:"Eu",64:"Gd",65:"Tb",66:"Dy",67:"Ho",68:"Er",69:"Tm",70:"Yb",89:"Ac",90:"Th",91:"Pa",92:"U",93:"Np",94:"Pu",95:"Am",96:"Cm",97:"Bk",98:"Cf",99:"Es",100:"Fm",101:"Md",102:"No"};function u(v,m){m=m||{};const _=[[]];let C=v.split(/\r?\n/);const w=m.assignBonds===void 0||m.assignBonds;if(C.length<6)return _;let k=C[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const F=Math.abs(parseFloat(k[0]));let T={origin:void 0,size:void 0,unit:void 0,matrix4:void 0,matrix:void 0};const z=T.origin=new c.Vector3(parseFloat(k[1]),parseFloat(k[2]),parseFloat(k[3]));k=C[3].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),k=C[3].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const Q=k[0]>0?.529177:1;z.multiplyScalar(Q);const J=Math.abs(k[0]),K=new c.Vector3(parseFloat(k[1]),parseFloat(k[2]),parseFloat(k[3])).multiplyScalar(Q);k=C[4].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const b=Math.abs(k[0]),N=new c.Vector3(parseFloat(k[1]),parseFloat(k[2]),parseFloat(k[3])).multiplyScalar(Q);k=C[5].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const V=Math.abs(k[0]),U=new c.Vector3(parseFloat(k[1]),parseFloat(k[2]),parseFloat(k[3])).multiplyScalar(Q);if(T.size={x:J,y:b,z:V},T.unit=new c.Vector3(K.x,N.y,U.z),K.y!=0||K.z!=0||N.x!=0||N.z!=0||U.x!=0||U.y!=0){T.matrix4=new c.Matrix4(K.x,N.x,U.x,0,K.y,N.y,U.y,0,K.z,N.z,U.z,0,0,0,0,1);let ge=new c.Matrix4().makeTranslation(z.x,z.y,z.z);T.matrix4=T.matrix4.multiplyMatrices(ge,T.matrix4),T.matrix=T.matrix4.matrix3FromTopLeft(),T.origin=new c.Vector3(0,0,0),T.unit=new c.Vector3(1,1,1)}_.modelData=[{cryst:T}],C=C.splice(6,F);for(var Z=_[_.length-1].length,L=Z+C.length,ee=Z;ee<L;++ee){var Ee={};Ee.serial=ee;var he=C[ee-Z].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");Ee.elem=D[he[0]],Ee.x=parseFloat(he[2])*Q,Ee.y=parseFloat(he[3])*Q,Ee.z=parseFloat(he[4])*Q,Ee.hetflag=!0,Ee.bonds=[],Ee.bondOrder=[],Ee.properties={},_[_.length-1].push(Ee)}if(w)for(let ge=0;ge<_.length;ge++)(0,p.assignBonds)(_[ge],m);return _}},972:(r,n,a)=>{var c=a(981),p=!0,D=!0;try{String.fromCharCode.apply(null,[0])}catch{p=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{D=!1}for(var u=new c.Buf8(256),v=0;v<256;v++)u[v]=v>=252?6:v>=248?5:v>=240?4:v>=224?3:v>=192?2:1;function m(_,C){if(C<65534&&(_.subarray&&D||!_.subarray&&p))return String.fromCharCode.apply(null,c.shrinkBuf(_,C));for(var w="",k=0;k<C;k++)w+=String.fromCharCode(_[k]);return w}u[254]=u[254]=1,n.string2buf=function(_){var C,w,k,F,T,z=_.length,Q=0;for(F=0;F<z;F++)(64512&(w=_.charCodeAt(F)))==55296&&F+1<z&&(64512&(k=_.charCodeAt(F+1)))==56320&&(w=65536+(w-55296<<10)+(k-56320),F++),Q+=w<128?1:w<2048?2:w<65536?3:4;for(C=new c.Buf8(Q),T=0,F=0;T<Q;F++)(64512&(w=_.charCodeAt(F)))==55296&&F+1<z&&(64512&(k=_.charCodeAt(F+1)))==56320&&(w=65536+(w-55296<<10)+(k-56320),F++),w<128?C[T++]=w:w<2048?(C[T++]=192|w>>>6,C[T++]=128|63&w):w<65536?(C[T++]=224|w>>>12,C[T++]=128|w>>>6&63,C[T++]=128|63&w):(C[T++]=240|w>>>18,C[T++]=128|w>>>12&63,C[T++]=128|w>>>6&63,C[T++]=128|63&w);return C},n.buf2binstring=function(_){return m(_,_.length)},n.binstring2buf=function(_){for(var C=new c.Buf8(_.length),w=0,k=C.length;w<k;w++)C[w]=_.charCodeAt(w);return C},n.buf2string=function(_,C){var w,k,F,T,z=C||_.length,Q=new Array(2*z);for(k=0,w=0;w<z;)if((F=_[w++])<128)Q[k++]=F;else if((T=u[F])>4)Q[k++]=65533,w+=T-1;else{for(F&=T===2?31:T===3?15:7;T>1&&w<z;)F=F<<6|63&_[w++],T--;T>1?Q[k++]=65533:F<65536?Q[k++]=F:(F-=65536,Q[k++]=55296|F>>10&1023,Q[k++]=56320|1023&F)}return m(Q,k)},n.utf8border=function(_,C){var w;for((C=C||_.length)>_.length&&(C=_.length),w=C-1;w>=0&&(192&_[w])==128;)w--;return w<0||w===0?C:w+u[_[w]]>C?w:C}},981:(r,n)=>{var a=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function c(u,v){return Object.prototype.hasOwnProperty.call(u,v)}n.assign=function(u){for(var v=Array.prototype.slice.call(arguments,1);v.length;){var m=v.shift();if(m){if(typeof m!="object")throw new TypeError(m+"must be non-object");for(var _ in m)c(m,_)&&(u[_]=m[_])}}return u},n.shrinkBuf=function(u,v){return u.length===v?u:u.subarray?u.subarray(0,v):(u.length=v,u)};var p={arraySet:function(u,v,m,_,C){if(v.subarray&&u.subarray)u.set(v.subarray(m,m+_),C);else for(var w=0;w<_;w++)u[C+w]=v[m+w]},flattenChunks:function(u){var v,m,_,C,w,k;for(_=0,v=0,m=u.length;v<m;v++)_+=u[v].length;for(k=new Uint8Array(_),C=0,v=0,m=u.length;v<m;v++)w=u[v],k.set(w,C),C+=w.length;return k}},D={arraySet:function(u,v,m,_,C){for(var w=0;w<_;w++)u[C+w]=v[m+w]},flattenChunks:function(u){return[].concat.apply([],u)}};n.setTyped=function(u){u?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,p)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,D))},n.setTyped(a)}},__webpack_module_cache__={};function __webpack_require__(r){var n=__webpack_module_cache__[r];if(n!==void 0)return n.exports;var a=__webpack_module_cache__[r]={exports:{}};return __webpack_modules__[r].call(a.exports,a,a.exports,__webpack_require__),a.exports}__webpack_require__.d=(r,n)=>{for(var a in n)__webpack_require__.o(n,a)&&!__webpack_require__.o(r,a)&&Object.defineProperty(r,a,{enumerable:!0,get:n[a]})},__webpack_require__.o=(r,n)=>Object.prototype.hasOwnProperty.call(r,n),__webpack_require__.r=r=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},__webpack_require__(16),__webpack_require__(185);var __webpack_exports__=__webpack_require__(307);return __webpack_exports__})(),module.exports=factory()})(_3DmolMin)),_3DmolMin.exports}require_3DmolMin();const covalentRadii={H:.31,He:.28,Li:1.28,Be:.96,B:.84,C:.76,N:.71,O:.66,F:.57,Ne:.58,Na:1.66,Mg:1.41,Al:1.21,Si:1.11,P:1.07,S:1.05,Cl:1.02,Ar:1.06,K:2.03,Ca:1.76,Sc:1.7,Ti:1.6,V:1.53,Cr:1.39,Mn:1.61,Fe:1.52,Co:1.5,Ni:1.24,Cu:1.32,Zn:1.22,Ga:1.22,Ge:1.2,As:1.19,Se:1.2,Br:1.2,Kr:1.16,Rb:2.2,Sr:1.95,Y:1.9,Zr:1.75,Nb:1.64,Mo:1.54,Tc:1.47,Ru:1.46,Rh:1.42,Pd:1.39,Ag:1.45,Cd:1.44,In:1.42,Sn:1.39,Sb:1.39,Te:1.38,I:1.39,Xe:1.4,Cs:2.44,Ba:2.15,La:2.07,Ce:2.04,Pr:2.03,Nd:2.01,Pm:1.99,Sm:1.98,Eu:1.98,Gd:1.96,Tb:1.94,Dy:1.92,Ho:1.92,Er:1.89,Tm:1.9,Yb:1.87,Lu:1.75,Hf:1.87,Ta:1.7,W:1.62,Re:1.51,Os:1.44,Ir:1.41,Pt:1.36,Au:1.36,Hg:1.32,Tl:1.45,Pb:1.46,Bi:1.48,Po:1.4,At:1.5,Rn:1.5,Fr:2.6,Ra:2.21,Ac:2.15,Th:2.06,Pa:2,U:1.96,Np:1.9,Pu:1.87,Am:1.8,Cm:1.69},$3Dmol$1=window.$3Dmol;function mod(r,n){return(r%n+n)%n}function setCustomBondLengths(){function r(n,a){$3Dmol$1.setBondLength(n,a)}Object.keys(covalentRadii).forEach(n=>{r(n,1.05*covalentRadii[n])})}const Visualizer3dmol=reactExports.forwardRef(({viewerParams:r,cifText:n},a)=>{const c=reactExports.useRef(null),p=reactExports.useRef(null),D=reactExports.useRef("gldiv-"+(Math.random()+1).toString(36).substring(7));reactExports.useEffect(()=>{setCustomBondLengths()},[]);const u=()=>{if(p.current=c.current.addModel(),n){let _=$3Dmol$1.Parsers.CIF(n),C=_[0],w=_.modelData[0].cryst;p.current.setCrystData(w.a,w.b,w.c,w.alpha,w.beta,w.gamma);let k=p.current.modelData.cryst.matrix,F=new $3Dmol$1.Matrix3().getInverse3(k),T=[],z=[];C.forEach(K=>{let b=new $3Dmol$1.Vector3(K.x,K.y,K.z);if(r.packedCell){let N=b.clone().applyMatrix3(F);b=new $3Dmol$1.Vector3(mod(N.x,1),mod(N.y,1),mod(N.z,1)).applyMatrix3(k)}z.push({elem:K.elem,x:b.x,y:b.y,z:b.z})});let Q=.03,J=r.supercell;for(let K=-1;K<J[0]+1;K++)for(let b=-1;b<J[1]+1;b++)for(let N=-1;N<J[2]+1;N++){let V=new $3Dmol$1.Vector3(K,b,N);if(V.applyMatrix3(k),K==-1||K==J[0]||b==-1||b==J[1]||N==-1||N==J[2])if(r.packedCell)z.forEach(U=>{let Z=new $3Dmol$1.Vector3(U.x,U.y,U.z);Z.add(V);let L=Z.clone().applyMatrix3(F);L.x>-Q&&L.x<J[0]+Q&&L.y>-Q&&L.y<J[1]+Q&&L.z>-Q&&L.z<J[2]+Q&&T.push({elem:U.elem,x:Z.x,y:Z.y,z:Z.z})});else continue;else z.forEach(U=>{T.push({elem:U.elem,x:U.x+V.x,y:U.y+V.y,z:U.z+V.z})})}p.current.addAtoms(T)}},v=()=>{c.current.removeAllModels(),u();let _={sphere:{scale:.3,colorscheme:"Jmol"}};r.vdwRadius&&(_.sphere.scale=1),r.bonds&&(_.stick={radius:.15,colorscheme:"Jmol"}),c.current.setStyle(_),c.current.addUnitCell(p.current),p.current.assignBonds(),c.current.removeAllLabels(),r.atomLabels&&p.current.atoms.forEach(C=>{c.current.addLabel(C.elem,{position:{x:C.x,y:C.y,z:C.z},fontColor:"black",bold:!0,fontSize:18,showBackground:!1,backgroundOpacity:1,inFront:!0},null,!0)}),c.current.zoomTo(),c.current.zoom(1.4),c.current.render()},m=(_,C)=>{_=="camera"&&(C=="x"&&c.current.setView([0,0,0,0,-.5,-.5,-.5,.5]),C=="y"&&c.current.setView([0,0,0,0,.5,.5,.5,.5]),C=="z"&&c.current.setView([0,0,0,0,0,0,0,1]),c.current.zoomTo(),c.current.zoom(1.4))};return reactExports.useImperativeHandle(a,()=>({handleEvent:m})),reactExports.useEffect(()=>{let _={backgroundColor:"white",orthographic:!0};c.current=$3Dmol$1.createViewer(D.current,_),v()},[]),reactExports.useEffect(()=>{c.current&&v()},[r,n]),jsxRuntimeExports.jsx("div",{id:D.current,className:"gldiv",children:"No data!"})});Visualizer3dmol.displayName="Visualizer3dmol";const StructureWindow=({mouseEnabled:r,setMouseEnabledState:n,visualizerRef:a,viewerParams:c,cifText:p})=>{let D="structure-window";r||(D+=" disable-mouse");let u="Click to interact",v="mouse-disabled-note";return r&&(v="mouse-disabled-note on"),jsxRuntimeExports.jsxs("div",{className:"structure-window-outer",children:[jsxRuntimeExports.jsx("div",{className:"structure-window-click-handler",onClick:()=>n(!0),children:jsxRuntimeExports.jsx("div",{className:D,children:jsxRuntimeExports.jsx(Visualizer3dmol,{ref:a,viewerParams:c,cifText:p})})}),jsxRuntimeExports.jsx("div",{className:v,onClick:()=>n(!r),children:u})]})},StructureVisualizer=r=>{const[n,a]=reactExports.useState({supercell:r.initSupercell||[2,2,2],bonds:!0,packedCell:!0,atomLabels:!1,vdwRadius:!1}),[c,p]=reactExports.useState(!1),D=reactExports.useRef(null),u=reactExports.useRef(null);reactExports.useEffect(()=>{const C=w=>{u&&!u.current.contains(w.target)&&p(!1)};return document.addEventListener("mousedown",C),()=>{document.removeEventListener("mousedown",C)}},[]);const v=C=>{p(C)},m=(C,w)=>{a(k=>({...k,[C]:w}))},_=(C,w)=>{D.current.handleEvent(C,w)};return jsxRuntimeExports.jsxs("div",{ref:u,className:"structure-visualizer",children:[jsxRuntimeExports.jsx(StructureWindow,{visualizerRef:D,viewerParams:n,cifText:r.cifText,mouseEnabled:c,setMouseEnabledState:v}),jsxRuntimeExports.jsx(ControlBox,{viewerParams:n,onViewerParamChange:m,onViewerEvent:_})]})};function DownloadIcon({size:r=14,className:n=""}){return jsxRuntimeExports.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:r,height:r,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[jsxRuntimeExports.jsx("path",{d:"M12 15V3"}),jsxRuntimeExports.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),jsxRuntimeExports.jsx("path",{d:"m7 10 5 5 5-5"})]})}function NextIcon({size:r=14,className:n=""}){return jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:r,hegiht:r,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:jsxRuntimeExports.jsx("path",{d:"m9 18 6-6-6-6"})})}function PreviousIcon({size:r=14,className:n=""}){return jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:r,hegiht:r,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:jsxRuntimeExports.jsx("path",{d:"m15 18-6-6 6-6"})})}function FirstIcon({size:r=14,className:n=""}){return jsxRuntimeExports.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:r,hegiht:r,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[jsxRuntimeExports.jsx("path",{d:"m17 18-6-6 6-6"}),jsxRuntimeExports.jsx("path",{d:"M7 6v12"})]})}function LastIcon({size:r=14,className:n=""}){return jsxRuntimeExports.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:r,hegiht:r,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[jsxRuntimeExports.jsx("path",{d:"m7 18 6-6-6-6"}),jsxRuntimeExports.jsx("path",{d:"M17 6v12"})]})}var ARRAY_TYPE=typeof Float32Array<"u"?Float32Array:Array;function create$1(){var r=new ARRAY_TYPE(9);return ARRAY_TYPE!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function fromValues$1(r,n,a,c,p,D,u,v,m){var _=new ARRAY_TYPE(9);return _[0]=r,_[1]=n,_[2]=a,_[3]=c,_[4]=p,_[5]=D,_[6]=u,_[7]=v,_[8]=m,_}function invert(r,n){var a=n[0],c=n[1],p=n[2],D=n[3],u=n[4],v=n[5],m=n[6],_=n[7],C=n[8],w=C*u-v*_,k=-C*D+v*m,F=_*D-u*m,T=a*w+c*k+p*F;return T?(T=1/T,r[0]=w*T,r[1]=(-C*c+p*_)*T,r[2]=(v*c-p*u)*T,r[3]=k*T,r[4]=(C*a-p*m)*T,r[5]=(-v*a+p*D)*T,r[6]=F*T,r[7]=(-_*a+c*m)*T,r[8]=(u*a-c*D)*T,r):null}function create(){var r=new ARRAY_TYPE(3);return ARRAY_TYPE!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function length(r){var n=r[0],a=r[1],c=r[2];return Math.sqrt(n*n+a*a+c*c)}function fromValues(r,n,a){var c=new ARRAY_TYPE(3);return c[0]=r,c[1]=n,c[2]=a,c}function dot(r,n){return r[0]*n[0]+r[1]*n[1]+r[2]*n[2]}function transformMat3(r,n,a){var c=n[0],p=n[1],D=n[2];return r[0]=c*a[0]+p*a[3]+D*a[6],r[1]=c*a[1]+p*a[4]+D*a[7],r[2]=c*a[2]+p*a[5]+D*a[8],r}(function(){var r=create();return function(n,a,c,p,D,u){var v,m;for(a||(a=3),c||(c=0),p?m=Math.min(p*a+c,n.length):m=n.length,v=c;v<m;v+=a)r[0]=n[v],r[1]=n[v+1],r[2]=n[v+2],D(r,r,u),n[v]=r[0],n[v+1]=r[1],n[v+2]=r[2];return n}})();function vecLength(r){return length(r)}function radToDeg$1(r){return r*180/Math.PI}function cartesianToFractional(r,n){const a=n[0],c=n[1],p=n[2],D=fromValues$1(a[0],a[1],a[2],c[0],c[1],c[2],p[0],p[1],p[2]),u=create$1();if(!invert(u,D))throw new Error("Singular lattice matrix");return r.map(v=>{const m=fromValues(v.x,v.y,v.z),_=create();return transformMat3(_,m,u),{element:v.element,x:_[0],y:_[1],z:_[2]}})}function latticeMatrixToCIFParams(r){const n=fromValues(...r[0]),a=fromValues(...r[1]),c=fromValues(...r[2]),p=vecLength(n),D=vecLength(a),u=vecLength(c),v=Math.min(1,Math.max(-1,dot(a,c)/(D*u))),m=Math.min(1,Math.max(-1,dot(n,c)/(p*u))),_=Math.min(1,Math.max(-1,dot(n,a)/(p*D))),C=radToDeg$1(Math.acos(v)),w=radToDeg$1(Math.acos(m)),k=radToDeg$1(Math.acos(_));return{a:p,b:D,c:u,alpha:C,beta:w,gamma:k}}function generateCIFfromMatrix(r){const{lattice:n,sites:a}=r,c=cartesianToFractional(a,n),{a:p,b:D,c:u,alpha:v,beta:m,gamma:_}=latticeMatrixToCIFParams(n);let C=`data_generated_structure
_symmetry_space_group_name_H-M   'P 1'
_cell_length_a   ${p.toFixed(6)}
_cell_length_b   ${D.toFixed(6)}
_cell_length_c   ${u.toFixed(6)}
_cell_angle_alpha   ${v.toFixed(6)}
_cell_angle_beta    ${m.toFixed(6)}
_cell_angle_gamma   ${_.toFixed(6)}

loop_
_atom_site_label
_atom_site_type_symbol
_atom_site_fract_x
_atom_site_fract_y
_atom_site_fract_z
`;return c.forEach((w,k)=>{C+=`${w.element}${k+1} ${w.element} ${w.x.toFixed(6)} ${w.y.toFixed(6)} ${w.z.toFixed(6)}
`}),C}function generateXYZ(r){const{lattice:n,sites:a}=r,c=a.length,p=n.flat().map(u=>u.toFixed(6)).join(" ");let D=`${c}
`;return D+=`Lattice="${p}" Properties=species:S:1:pos:R:3
`,a.forEach(u=>{D+=`${u.element} ${u.x.toFixed(6)} ${u.y.toFixed(6)} ${u.z.toFixed(6)}
`}),D}function generatePOSCAR(r){const{lattice:n,sites:a}=r,c=[...new Set(a.map(v=>v.element))],p=c.map(v=>a.filter(m=>m.element===v).length),D=n.map(v=>v.map(m=>m.toFixed(6)).join(" ")).join(`
`),u=c.flatMap(v=>a.filter(m=>m.element===v).map(m=>`${m.x.toFixed(6)} ${m.y.toFixed(6)} ${m.z.toFixed(6)}`));return["Generated structure from OPTIMADE CLIENT","1.0",D,c.join(" "),p.join(" "),"Cartesian",...u].join(`
`)}function generateXSF(r){const{lattice:n,sites:a}=r;let c=`CRYSTAL
PRIMVEC
`;return n.forEach(p=>{c+=p.map(D=>D.toFixed(6)).join(" ")+`
`}),c+=`PRIMCOORD
${a.length} 1
`,a.forEach(p=>{c+=`${p.element} ${p.x.toFixed(6)} ${p.y.toFixed(6)} ${p.z.toFixed(6)}
`}),c}const defaultFormats=[{format:"json",label:"JSON"},{format:"cif",label:"CIF"},{format:"xyz",label:"XYZ"},{format:"xsf",label:"XSF"},{format:"poscar",label:"VASP"}];function downloadFile(r,n){const a=new Blob([r],{type:"text/plain"}),c=URL.createObjectURL(a),p=document.createElement("a");p.href=c,p.download=n,document.body.appendChild(p),p.click(),document.body.removeChild(p),URL.revokeObjectURL(c)}function StructureDownload({OptimadeStructure:r,download_formats:n}){const[a,c]=reactExports.useState(!1),p=reactExports.useRef(null),D=n||defaultFormats,u=r.attributes.lattice_vectors,v=r?.attributes?.cartesian_site_positions||[],m=r.attributes.species_at_sites,_=v.map((k,F)=>({element:m[F],x:k[0],y:k[1],z:k[2]})),C={lattice:u,sites:_},w=k=>{let F="",T="structure";k==="cif"?(F=generateCIFfromMatrix(C),T+=".cif"):k==="xyz"?(F=generateXYZ(C),T+=".xyz"):k==="poscar"?(F=generatePOSCAR(C),T+=".vasp"):k==="xsf"?(F=generateXSF(C),T+=".xsf"):k==="json"&&(F=JSON.stringify(r,null,2),T+=".json"),F&&downloadFile(F,T),c(!1)};return reactExports.useEffect(()=>{const k=F=>{p.current&&!p.current.contains(F.target)&&c(!1)};return document.addEventListener("mousedown",k),()=>document.removeEventListener("mousedown",k)},[]),jsxRuntimeExports.jsxs("div",{className:"relative inline-block",ref:p,children:[jsxRuntimeExports.jsx("div",{onClick:()=>c(k=>!k),className:`${baseButtonStyle} ${textSmall} py-2! px-2!`,title:"Download",children:jsxRuntimeExports.jsx(DownloadIcon,{})}),a&&jsxRuntimeExports.jsx("div",{className:"absolute right-0 mt-0.5 bg-white rounded-sm shadow-sm ring-1 ring-slate-500 z-100",children:jsxRuntimeExports.jsx("ul",{children:D.map(({format:k,label:F})=>jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("button",{onClick:()=>w(k),className:`${textSmall} w-full text-left px-3 py-1.25 text-slate-700 hover:bg-gray-100 hover:cursor-pointer`,children:F})},k))})})]})}function StructureViewerWithDownload({OptimadeStructure:r}){const n=r.attributes.lattice_vectors,a=r?.attributes?.cartesian_site_positions||null,c=r.attributes.species_at_sites;let p=[];a&&(p=a.map((v,m)=>({element:c[m],x:v[0],y:v[1],z:v[2]})));const D={lattice:n,sites:p},u=reactExports.useMemo(()=>generateCIFfromMatrix(D),[D]);return a?jsxRuntimeExports.jsxs("div",{className:"relative min-h-[450px] ",children:[jsxRuntimeExports.jsx("div",{className:"w-full h-[450px]",children:jsxRuntimeExports.jsx(StructureVisualizer,{cifText:u},u)}),jsxRuntimeExports.jsx("div",{className:"absolute top-2 right-2 z-10",children:jsxRuntimeExports.jsx(StructureDownload,{OptimadeStructure:r})})]}):jsxRuntimeExports.jsx("div",{className:`${containerStyle} min-h-[450px] flex items-center justify-center`,children:jsxRuntimeExports.jsxs("div",{className:textError,children:[jsxRuntimeExports.jsx("p",{children:"Unexpected or malformed data format found. "}),jsxRuntimeExports.jsx("p",{children:"--"}),jsxRuntimeExports.jsx("p",{children:"Crystal structure rendering skipped..."})]})})}function QEInputButton({cifText:r}){const n="https://qeinputgenerator.materialscloud.io",a=async()=>{if(!r){alert("No CIF data available");return}const c=window.open("","_blank");try{const p=new FormData;p.append("fileformat","cif-ase"),p.append("structurefile",new Blob([r],{type:"text/plain;charset=utf-8"}),"structure.cif");const D=await fetch(`${n}/compute/upload_structure/`,{method:"POST",body:p});if(!D.ok)throw new Error(`Upload failed: ${D.statusText}`);const u=await D.json();u.redirect?c.location=`${n}${u.redirect}`:(c.close(),alert("Unexpected response from server"))}catch(p){console.error(p),c.close(),alert("Failed to upload structure.")}};return jsxRuntimeExports.jsx("button",{onClick:a,disabled:!r,title:"Use the chosen structure in the QE Input Generator Tool",className:`${baseButtonStyle} ${textNormal}`,children:"Use in QE Input Generator"})}function ResultViewer({selectedResult:r}){console.log("selectedResult",r);const n=r?.attributes?.lattice_vectors??[],a=r?.attributes?.cartesian_site_positions??[],c=r?.attributes?.species_at_sites??[],p=a.map((v,m)=>({element:c[m],x:v[0],y:v[1],z:v[2]})),D=reactExports.useMemo(()=>({lattice:n,sites:p}),[n,p]),u=reactExports.useMemo(()=>generateCIFfromMatrix(D),[D]);return jsxRuntimeExports.jsxs("div",{className:"w-full flex flex-col",children:[r&&jsxRuntimeExports.jsxs("div",{className:"@container w-full flex flex-col md:flex-row gap-2 md:gap-4",children:[jsxRuntimeExports.jsx("div",{className:"w-full md:w-1/2",children:jsxRuntimeExports.jsx(StructureViewerWithDownload,{OptimadeStructure:r,cifText:u})}),jsxRuntimeExports.jsx("div",{className:containerStyleHalf,children:jsxRuntimeExports.jsx(JsonView,{data:r,compactTopLevel:!0,shouldExpandNode:v=>v<2,style:{backgroundColor:""}})})]}),jsxRuntimeExports.jsx("div",{className:"mt-2 md:mt-4 flex justify-center",children:jsxRuntimeExports.jsx(QEInputButton,{cifText:u})})]})}function ResultsDropdown({results:r,resultsLoading:n,selectedResult:a,setSelectedResult:c}){const p=D=>{const u=r?.data?.find(v=>String(v.id)===D.target.value);u&&c(u)};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select a result"}),jsxRuntimeExports.jsx("select",{className:`${slateDropdown} w-full`,value:a?.id||"",onChange:p,disabled:n||!r?.data?.length,children:r?.data?.length?r.data.map(D=>jsxRuntimeExports.jsx("option",{value:D.id,children:`${D.attributes?.chemical_formula_descriptive||D.attributes?.chemical_formula_hill||"Unknown"} (${D.id})`},D.id)):jsxRuntimeExports.jsx("option",{value:"",children:"No results for current query"})})]})}const tableTitleclassName="font-semibold border-b [&>th]:px-2",tableRowclassName="border-b border-slate-300 *:py-0.5 *:pl-2 pr-8 *:break-words";function OptimadeProviderInfo({queryUrl:r}){const[n,a]=reactExports.useState(null),[c,p]=reactExports.useState([]),[D,u]=reactExports.useState(!1),[v,m]=reactExports.useState(!1),_=reactExports.useRef(null),[C,w]=reactExports.useState("0px");return reactExports.useEffect(()=>{if(!r)return;u(!0),a(null),p([]);async function k(){try{const{customProps:F,error:T}=await getInfo({providerUrl:r});T&&p([T]),F&&a(F)}catch(F){p([F])}finally{u(!1)}}k()},[r]),reactExports.useEffect(()=>{_.current&&w(v?`${_.current.scrollHeight}px`:"0px")},[v,n,c,D]),!r||c.length>0&&!D?null:jsxRuntimeExports.jsxs("div",{className:containerStyleDropdown,children:[jsxRuntimeExports.jsxs("button",{onClick:()=>m(!v),className:"w-full flex justify-between p-3 bg-slate-100 hover:bg-slate-200 hover:cursor-pointer transition",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold",children:"Custom attributes in selected database"}),jsxRuntimeExports.jsx("span",{children:v?"":""})]}),jsxRuntimeExports.jsx("div",{ref:_,style:{maxHeight:C},className:"transition-[max-height] duration-300 ease-in-out",children:jsxRuntimeExports.jsxs("div",{className:"pt-2 max-h-96 overflow-y-auto",children:[D&&jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center py-4",children:[jsxRuntimeExports.jsx("div",{className:"w-5 h-5 border-2 border-t-2 border-gray-400 border-t-blue-500 rounded-full animate-spin mr-2"}),jsxRuntimeExports.jsx("span",{className:"text-gray-500",children:"Loading provider info"})]}),n&&!D&&jsxRuntimeExports.jsx("div",{className:"",children:jsxRuntimeExports.jsxs("table",{className:"w-full table-fixed text-left border-collapse",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{className:tableTitleclassName,children:[jsxRuntimeExports.jsx("th",{children:"Field"}),jsxRuntimeExports.jsx("th",{children:"Description"}),jsxRuntimeExports.jsx("th",{children:"Unit"})]})}),jsxRuntimeExports.jsx("tbody",{children:Object.entries(n).map(([k,F])=>jsxRuntimeExports.jsxs("tr",{className:tableRowclassName,children:[jsxRuntimeExports.jsx("td",{children:k}),jsxRuntimeExports.jsx("td",{children:F.description||"-"}),jsxRuntimeExports.jsx("td",{children:F.unit||"-"})]},k))})]})})]})})]})}const buttonClassName="px-3 py-1 bg-gray-200 rounded hover:bg-gray-300 hover:cursor-pointer disabled:bg-gray-200 disabled:opacity-50 disabled:cursor-default";function PaginationHandler({currentPage:r,totalPages:n,resultsLoading:a,metaData:c,onPageChange:p}){if(!n||n<1)return null;const D=c?.data_returned||"N/A",u=r>1;let v=!1;return(c?.more_data_available===!0||r<n)&&(v=!0),jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap justify-center items-center gap-1",children:[jsxRuntimeExports.jsx("span",{className:"text-slate-700 text-sm text-center w-full md:w-auto",children:`Filtered results: ${D} of ${c.data_available} | Showing page ${r} of ${n}`}),jsxRuntimeExports.jsx("button",{onClick:()=>p(1),disabled:r===1||a,className:buttonClassName,children:jsxRuntimeExports.jsx(FirstIcon,{})}),jsxRuntimeExports.jsx("button",{onClick:()=>p(r-1),disabled:!u||a,className:buttonClassName,children:jsxRuntimeExports.jsx(PreviousIcon,{})}),jsxRuntimeExports.jsx("button",{onClick:()=>p(r+1),disabled:!v||a,className:buttonClassName,children:jsxRuntimeExports.jsx(NextIcon,{})}),jsxRuntimeExports.jsx("button",{onClick:()=>p(n),disabled:r===n||a,className:buttonClassName,children:jsxRuntimeExports.jsx(LastIcon,{})})]})}const LayoutGroupContext=reactExports.createContext({});function useConstant(r){const n=reactExports.useRef(null);return n.current===null&&(n.current=r()),n.current}const isBrowser=typeof window<"u",useIsomorphicLayoutEffect=isBrowser?reactExports.useLayoutEffect:reactExports.useEffect,PresenceContext=reactExports.createContext(null);function addUniqueItem(r,n){r.indexOf(n)===-1&&r.push(n)}function removeItem(r,n){const a=r.indexOf(n);a>-1&&r.splice(a,1)}const clamp=(r,n,a)=>a>n?n:a<r?r:a;let invariant=()=>{};const MotionGlobalConfig={},isNumericalString=r=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(r);function isObject(r){return typeof r=="object"&&r!==null}const isZeroValueString=r=>/^0[^.\s]+$/u.test(r);function memo(r){let n;return()=>(n===void 0&&(n=r()),n)}const noop=r=>r,combineFunctions=(r,n)=>a=>n(r(a)),pipe=(...r)=>r.reduce(combineFunctions),progress=(r,n,a)=>{const c=n-r;return c===0?1:(a-r)/c};class SubscriptionManager{constructor(){this.subscriptions=[]}add(n){return addUniqueItem(this.subscriptions,n),()=>removeItem(this.subscriptions,n)}notify(n,a,c){const p=this.subscriptions.length;if(p)if(p===1)this.subscriptions[0](n,a,c);else for(let D=0;D<p;D++){const u=this.subscriptions[D];u&&u(n,a,c)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const secondsToMilliseconds=r=>r*1e3,millisecondsToSeconds=r=>r/1e3;function velocityPerSecond(r,n){return n?r*(1e3/n):0}const calcBezier=(r,n,a)=>(((1-3*a+3*n)*r+(3*a-6*n))*r+3*n)*r,subdivisionPrecision=1e-7,subdivisionMaxIterations=12;function binarySubdivide(r,n,a,c,p){let D,u,v=0;do u=n+(a-n)/2,D=calcBezier(u,c,p)-r,D>0?a=u:n=u;while(Math.abs(D)>subdivisionPrecision&&++v<subdivisionMaxIterations);return u}function cubicBezier(r,n,a,c){if(r===n&&a===c)return noop;const p=D=>binarySubdivide(D,0,1,r,a);return D=>D===0||D===1?D:calcBezier(p(D),n,c)}const mirrorEasing=r=>n=>n<=.5?r(2*n)/2:(2-r(2*(1-n)))/2,reverseEasing=r=>n=>1-r(1-n),backOut=cubicBezier(.33,1.53,.69,.99),backIn=reverseEasing(backOut),backInOut=mirrorEasing(backIn),anticipate=r=>(r*=2)<1?.5*backIn(r):.5*(2-Math.pow(2,-10*(r-1))),circIn=r=>1-Math.sin(Math.acos(r)),circOut=reverseEasing(circIn),circInOut=mirrorEasing(circIn),easeIn=cubicBezier(.42,0,1,1),easeOut=cubicBezier(0,0,.58,1),easeInOut=cubicBezier(.42,0,.58,1),isEasingArray=r=>Array.isArray(r)&&typeof r[0]!="number",isBezierDefinition=r=>Array.isArray(r)&&typeof r[0]=="number",easingLookup={linear:noop,easeIn,easeInOut,easeOut,circIn,circInOut,circOut,backIn,backInOut,backOut,anticipate},isValidEasing=r=>typeof r=="string",easingDefinitionToFunction=r=>{if(isBezierDefinition(r)){invariant(r.length===4);const[n,a,c,p]=r;return cubicBezier(n,a,c,p)}else if(isValidEasing(r))return easingLookup[r];return r},stepsOrder=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function createRenderStep(r,n){let a=new Set,c=new Set,p=!1,D=!1;const u=new WeakSet;let v={delta:0,timestamp:0,isProcessing:!1};function m(C){u.has(C)&&(_.schedule(C),r()),C(v)}const _={schedule:(C,w=!1,k=!1)=>{const T=k&&p?a:c;return w&&u.add(C),T.has(C)||T.add(C),C},cancel:C=>{c.delete(C),u.delete(C)},process:C=>{if(v=C,p){D=!0;return}p=!0,[a,c]=[c,a],a.forEach(m),a.clear(),p=!1,D&&(D=!1,_.process(C))}};return _}const maxElapsed=40;function createRenderBatcher(r,n){let a=!1,c=!0;const p={delta:0,timestamp:0,isProcessing:!1},D=()=>a=!0,u=stepsOrder.reduce((b,N)=>(b[N]=createRenderStep(D),b),{}),{setup:v,read:m,resolveKeyframes:_,preUpdate:C,update:w,preRender:k,render:F,postRender:T}=u,z=()=>{const b=MotionGlobalConfig.useManualTiming?p.timestamp:performance.now();a=!1,MotionGlobalConfig.useManualTiming||(p.delta=c?1e3/60:Math.max(Math.min(b-p.timestamp,maxElapsed),1)),p.timestamp=b,p.isProcessing=!0,v.process(p),m.process(p),_.process(p),C.process(p),w.process(p),k.process(p),F.process(p),T.process(p),p.isProcessing=!1,a&&n&&(c=!1,r(z))},Q=()=>{a=!0,c=!0,p.isProcessing||r(z)};return{schedule:stepsOrder.reduce((b,N)=>{const V=u[N];return b[N]=(U,Z=!1,L=!1)=>(a||Q(),V.schedule(U,Z,L)),b},{}),cancel:b=>{for(let N=0;N<stepsOrder.length;N++)u[stepsOrder[N]].cancel(b)},state:p,steps:u}}const{schedule:frame,cancel:cancelFrame,state:frameData,steps:frameSteps}=createRenderBatcher(typeof requestAnimationFrame<"u"?requestAnimationFrame:noop,!0);let now;function clearTime(){now=void 0}const time={now:()=>(now===void 0&&time.set(frameData.isProcessing||MotionGlobalConfig.useManualTiming?frameData.timestamp:performance.now()),now),set:r=>{now=r,queueMicrotask(clearTime)}},checkStringStartsWith=r=>n=>typeof n=="string"&&n.startsWith(r),isCSSVariableName=checkStringStartsWith("--"),startsAsVariableToken=checkStringStartsWith("var(--"),isCSSVariableToken=r=>startsAsVariableToken(r)?singleCssVariableRegex.test(r.split("/*")[0].trim()):!1,singleCssVariableRegex=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,number={test:r=>typeof r=="number",parse:parseFloat,transform:r=>r},alpha={...number,transform:r=>clamp(0,1,r)},scale={...number,default:1},sanitize=r=>Math.round(r*1e5)/1e5,floatRegex=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function isNullish(r){return r==null}const singleColorRegex=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,isColorString=(r,n)=>a=>!!(typeof a=="string"&&singleColorRegex.test(a)&&a.startsWith(r)||n&&!isNullish(a)&&Object.prototype.hasOwnProperty.call(a,n)),splitColor=(r,n,a)=>c=>{if(typeof c!="string")return c;const[p,D,u,v]=c.match(floatRegex);return{[r]:parseFloat(p),[n]:parseFloat(D),[a]:parseFloat(u),alpha:v!==void 0?parseFloat(v):1}},clampRgbUnit=r=>clamp(0,255,r),rgbUnit={...number,transform:r=>Math.round(clampRgbUnit(r))},rgba={test:isColorString("rgb","red"),parse:splitColor("red","green","blue"),transform:({red:r,green:n,blue:a,alpha:c=1})=>"rgba("+rgbUnit.transform(r)+", "+rgbUnit.transform(n)+", "+rgbUnit.transform(a)+", "+sanitize(alpha.transform(c))+")"};function parseHex(r){let n="",a="",c="",p="";return r.length>5?(n=r.substring(1,3),a=r.substring(3,5),c=r.substring(5,7),p=r.substring(7,9)):(n=r.substring(1,2),a=r.substring(2,3),c=r.substring(3,4),p=r.substring(4,5),n+=n,a+=a,c+=c,p+=p),{red:parseInt(n,16),green:parseInt(a,16),blue:parseInt(c,16),alpha:p?parseInt(p,16)/255:1}}const hex={test:isColorString("#"),parse:parseHex,transform:rgba.transform},createUnitType=r=>({test:n=>typeof n=="string"&&n.endsWith(r)&&n.split(" ").length===1,parse:parseFloat,transform:n=>`${n}${r}`}),degrees=createUnitType("deg"),percent=createUnitType("%"),px=createUnitType("px"),vh=createUnitType("vh"),vw=createUnitType("vw"),progressPercentage={...percent,parse:r=>percent.parse(r)/100,transform:r=>percent.transform(r*100)},hsla={test:isColorString("hsl","hue"),parse:splitColor("hue","saturation","lightness"),transform:({hue:r,saturation:n,lightness:a,alpha:c=1})=>"hsla("+Math.round(r)+", "+percent.transform(sanitize(n))+", "+percent.transform(sanitize(a))+", "+sanitize(alpha.transform(c))+")"},color={test:r=>rgba.test(r)||hex.test(r)||hsla.test(r),parse:r=>rgba.test(r)?rgba.parse(r):hsla.test(r)?hsla.parse(r):hex.parse(r),transform:r=>typeof r=="string"?r:r.hasOwnProperty("red")?rgba.transform(r):hsla.transform(r),getAnimatableNone:r=>{const n=color.parse(r);return n.alpha=0,color.transform(n)}},colorRegex=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function test(r){return isNaN(r)&&typeof r=="string"&&(r.match(floatRegex)?.length||0)+(r.match(colorRegex)?.length||0)>0}const NUMBER_TOKEN="number",COLOR_TOKEN="color",VAR_TOKEN="var",VAR_FUNCTION_TOKEN="var(",SPLIT_TOKEN="${}",complexRegex=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function analyseComplexValue(r){const n=r.toString(),a=[],c={color:[],number:[],var:[]},p=[];let D=0;const v=n.replace(complexRegex,m=>(color.test(m)?(c.color.push(D),p.push(COLOR_TOKEN),a.push(color.parse(m))):m.startsWith(VAR_FUNCTION_TOKEN)?(c.var.push(D),p.push(VAR_TOKEN),a.push(m)):(c.number.push(D),p.push(NUMBER_TOKEN),a.push(parseFloat(m))),++D,SPLIT_TOKEN)).split(SPLIT_TOKEN);return{values:a,split:v,indexes:c,types:p}}function parseComplexValue(r){return analyseComplexValue(r).values}function createTransformer(r){const{split:n,types:a}=analyseComplexValue(r),c=n.length;return p=>{let D="";for(let u=0;u<c;u++)if(D+=n[u],p[u]!==void 0){const v=a[u];v===NUMBER_TOKEN?D+=sanitize(p[u]):v===COLOR_TOKEN?D+=color.transform(p[u]):D+=p[u]}return D}}const convertNumbersToZero=r=>typeof r=="number"?0:color.test(r)?color.getAnimatableNone(r):r;function getAnimatableNone$1(r){const n=parseComplexValue(r);return createTransformer(r)(n.map(convertNumbersToZero))}const complex={test,parse:parseComplexValue,createTransformer,getAnimatableNone:getAnimatableNone$1};function hueToRgb(r,n,a){return a<0&&(a+=1),a>1&&(a-=1),a<1/6?r+(n-r)*6*a:a<1/2?n:a<2/3?r+(n-r)*(2/3-a)*6:r}function hslaToRgba({hue:r,saturation:n,lightness:a,alpha:c}){r/=360,n/=100,a/=100;let p=0,D=0,u=0;if(!n)p=D=u=a;else{const v=a<.5?a*(1+n):a+n-a*n,m=2*a-v;p=hueToRgb(m,v,r+1/3),D=hueToRgb(m,v,r),u=hueToRgb(m,v,r-1/3)}return{red:Math.round(p*255),green:Math.round(D*255),blue:Math.round(u*255),alpha:c}}function mixImmediate(r,n){return a=>a>0?n:r}const mixNumber$1=(r,n,a)=>r+(n-r)*a,mixLinearColor=(r,n,a)=>{const c=r*r,p=a*(n*n-c)+c;return p<0?0:Math.sqrt(p)},colorTypes=[hex,rgba,hsla],getColorType=r=>colorTypes.find(n=>n.test(r));function asRGBA(r){const n=getColorType(r);if(!n)return!1;let a=n.parse(r);return n===hsla&&(a=hslaToRgba(a)),a}const mixColor=(r,n)=>{const a=asRGBA(r),c=asRGBA(n);if(!a||!c)return mixImmediate(r,n);const p={...a};return D=>(p.red=mixLinearColor(a.red,c.red,D),p.green=mixLinearColor(a.green,c.green,D),p.blue=mixLinearColor(a.blue,c.blue,D),p.alpha=mixNumber$1(a.alpha,c.alpha,D),rgba.transform(p))},invisibleValues=new Set(["none","hidden"]);function mixVisibility(r,n){return invisibleValues.has(r)?a=>a<=0?r:n:a=>a>=1?n:r}function mixNumber(r,n){return a=>mixNumber$1(r,n,a)}function getMixer(r){return typeof r=="number"?mixNumber:typeof r=="string"?isCSSVariableToken(r)?mixImmediate:color.test(r)?mixColor:mixComplex:Array.isArray(r)?mixArray:typeof r=="object"?color.test(r)?mixColor:mixObject:mixImmediate}function mixArray(r,n){const a=[...r],c=a.length,p=r.map((D,u)=>getMixer(D)(D,n[u]));return D=>{for(let u=0;u<c;u++)a[u]=p[u](D);return a}}function mixObject(r,n){const a={...r,...n},c={};for(const p in a)r[p]!==void 0&&n[p]!==void 0&&(c[p]=getMixer(r[p])(r[p],n[p]));return p=>{for(const D in c)a[D]=c[D](p);return a}}function matchOrder(r,n){const a=[],c={color:0,var:0,number:0};for(let p=0;p<n.values.length;p++){const D=n.types[p],u=r.indexes[D][c[D]],v=r.values[u]??0;a[p]=v,c[D]++}return a}const mixComplex=(r,n)=>{const a=complex.createTransformer(n),c=analyseComplexValue(r),p=analyseComplexValue(n);return c.indexes.var.length===p.indexes.var.length&&c.indexes.color.length===p.indexes.color.length&&c.indexes.number.length>=p.indexes.number.length?invisibleValues.has(r)&&!p.values.length||invisibleValues.has(n)&&!c.values.length?mixVisibility(r,n):pipe(mixArray(matchOrder(c,p),p.values),a):mixImmediate(r,n)};function mix(r,n,a){return typeof r=="number"&&typeof n=="number"&&typeof a=="number"?mixNumber$1(r,n,a):getMixer(r)(r,n)}const frameloopDriver=r=>{const n=({timestamp:a})=>r(a);return{start:(a=!0)=>frame.update(n,a),stop:()=>cancelFrame(n),now:()=>frameData.isProcessing?frameData.timestamp:time.now()}},generateLinearEasing=(r,n,a=10)=>{let c="";const p=Math.max(Math.round(n/a),2);for(let D=0;D<p;D++)c+=Math.round(r(D/(p-1))*1e4)/1e4+", ";return`linear(${c.substring(0,c.length-2)})`},maxGeneratorDuration=2e4;function calcGeneratorDuration(r){let n=0;const a=50;let c=r.next(n);for(;!c.done&&n<maxGeneratorDuration;)n+=a,c=r.next(n);return n>=maxGeneratorDuration?1/0:n}function createGeneratorEasing(r,n=100,a){const c=a({...r,keyframes:[0,n]}),p=Math.min(calcGeneratorDuration(c),maxGeneratorDuration);return{type:"keyframes",ease:D=>c.next(p*D).value/n,duration:millisecondsToSeconds(p)}}const velocitySampleDuration=5;function calcGeneratorVelocity(r,n,a){const c=Math.max(n-velocitySampleDuration,0);return velocityPerSecond(a-r(c),n-c)}const springDefaults={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},safeMin=.001;function findSpring({duration:r=springDefaults.duration,bounce:n=springDefaults.bounce,velocity:a=springDefaults.velocity,mass:c=springDefaults.mass}){let p,D,u=1-n;u=clamp(springDefaults.minDamping,springDefaults.maxDamping,u),r=clamp(springDefaults.minDuration,springDefaults.maxDuration,millisecondsToSeconds(r)),u<1?(p=_=>{const C=_*u,w=C*r,k=C-a,F=calcAngularFreq(_,u),T=Math.exp(-w);return safeMin-k/F*T},D=_=>{const w=_*u*r,k=w*a+a,F=Math.pow(u,2)*Math.pow(_,2)*r,T=Math.exp(-w),z=calcAngularFreq(Math.pow(_,2),u);return(-p(_)+safeMin>0?-1:1)*((k-F)*T)/z}):(p=_=>{const C=Math.exp(-_*r),w=(_-a)*r+1;return-safeMin+C*w},D=_=>{const C=Math.exp(-_*r),w=(a-_)*(r*r);return C*w});const v=5/r,m=approximateRoot(p,D,v);if(r=secondsToMilliseconds(r),isNaN(m))return{stiffness:springDefaults.stiffness,damping:springDefaults.damping,duration:r};{const _=Math.pow(m,2)*c;return{stiffness:_,damping:u*2*Math.sqrt(c*_),duration:r}}}const rootIterations=12;function approximateRoot(r,n,a){let c=a;for(let p=1;p<rootIterations;p++)c=c-r(c)/n(c);return c}function calcAngularFreq(r,n){return r*Math.sqrt(1-n*n)}const durationKeys=["duration","bounce"],physicsKeys=["stiffness","damping","mass"];function isSpringType(r,n){return n.some(a=>r[a]!==void 0)}function getSpringOptions(r){let n={velocity:springDefaults.velocity,stiffness:springDefaults.stiffness,damping:springDefaults.damping,mass:springDefaults.mass,isResolvedFromDuration:!1,...r};if(!isSpringType(r,physicsKeys)&&isSpringType(r,durationKeys))if(r.visualDuration){const a=r.visualDuration,c=2*Math.PI/(a*1.2),p=c*c,D=2*clamp(.05,1,1-(r.bounce||0))*Math.sqrt(p);n={...n,mass:springDefaults.mass,stiffness:p,damping:D}}else{const a=findSpring(r);n={...n,...a,mass:springDefaults.mass},n.isResolvedFromDuration=!0}return n}function spring(r=springDefaults.visualDuration,n=springDefaults.bounce){const a=typeof r!="object"?{visualDuration:r,keyframes:[0,1],bounce:n}:r;let{restSpeed:c,restDelta:p}=a;const D=a.keyframes[0],u=a.keyframes[a.keyframes.length-1],v={done:!1,value:D},{stiffness:m,damping:_,mass:C,duration:w,velocity:k,isResolvedFromDuration:F}=getSpringOptions({...a,velocity:-millisecondsToSeconds(a.velocity||0)}),T=k||0,z=_/(2*Math.sqrt(m*C)),Q=u-D,J=millisecondsToSeconds(Math.sqrt(m/C)),K=Math.abs(Q)<5;c||(c=K?springDefaults.restSpeed.granular:springDefaults.restSpeed.default),p||(p=K?springDefaults.restDelta.granular:springDefaults.restDelta.default);let b;if(z<1){const V=calcAngularFreq(J,z);b=U=>{const Z=Math.exp(-z*J*U);return u-Z*((T+z*J*Q)/V*Math.sin(V*U)+Q*Math.cos(V*U))}}else if(z===1)b=V=>u-Math.exp(-J*V)*(Q+(T+J*Q)*V);else{const V=J*Math.sqrt(z*z-1);b=U=>{const Z=Math.exp(-z*J*U),L=Math.min(V*U,300);return u-Z*((T+z*J*Q)*Math.sinh(L)+V*Q*Math.cosh(L))/V}}const N={calculatedDuration:F&&w||null,next:V=>{const U=b(V);if(F)v.done=V>=w;else{let Z=V===0?T:0;z<1&&(Z=V===0?secondsToMilliseconds(T):calcGeneratorVelocity(b,V,U));const L=Math.abs(Z)<=c,ee=Math.abs(u-U)<=p;v.done=L&&ee}return v.value=v.done?u:U,v},toString:()=>{const V=Math.min(calcGeneratorDuration(N),maxGeneratorDuration),U=generateLinearEasing(Z=>N.next(V*Z).value,V,30);return V+"ms "+U},toTransition:()=>{}};return N}spring.applyToOptions=r=>{const n=createGeneratorEasing(r,100,spring);return r.ease=n.ease,r.duration=secondsToMilliseconds(n.duration),r.type="keyframes",r};function inertia({keyframes:r,velocity:n=0,power:a=.8,timeConstant:c=325,bounceDamping:p=10,bounceStiffness:D=500,modifyTarget:u,min:v,max:m,restDelta:_=.5,restSpeed:C}){const w=r[0],k={done:!1,value:w},F=L=>v!==void 0&&L<v||m!==void 0&&L>m,T=L=>v===void 0?m:m===void 0||Math.abs(v-L)<Math.abs(m-L)?v:m;let z=a*n;const Q=w+z,J=u===void 0?Q:u(Q);J!==Q&&(z=J-w);const K=L=>-z*Math.exp(-L/c),b=L=>J+K(L),N=L=>{const ee=K(L),Ee=b(L);k.done=Math.abs(ee)<=_,k.value=k.done?J:Ee};let V,U;const Z=L=>{F(k.value)&&(V=L,U=spring({keyframes:[k.value,T(k.value)],velocity:calcGeneratorVelocity(b,L,k.value),damping:p,stiffness:D,restDelta:_,restSpeed:C}))};return Z(0),{calculatedDuration:null,next:L=>{let ee=!1;return!U&&V===void 0&&(ee=!0,N(L),Z(L)),V!==void 0&&L>=V?U.next(L-V):(!ee&&N(L),k)}}}function createMixers(r,n,a){const c=[],p=a||MotionGlobalConfig.mix||mix,D=r.length-1;for(let u=0;u<D;u++){let v=p(r[u],r[u+1]);if(n){const m=Array.isArray(n)?n[u]||noop:n;v=pipe(m,v)}c.push(v)}return c}function interpolate(r,n,{clamp:a=!0,ease:c,mixer:p}={}){const D=r.length;if(invariant(D===n.length),D===1)return()=>n[0];if(D===2&&n[0]===n[1])return()=>n[1];const u=r[0]===r[1];r[0]>r[D-1]&&(r=[...r].reverse(),n=[...n].reverse());const v=createMixers(n,c,p),m=v.length,_=C=>{if(u&&C<r[0])return n[0];let w=0;if(m>1)for(;w<r.length-2&&!(C<r[w+1]);w++);const k=progress(r[w],r[w+1],C);return v[w](k)};return a?C=>_(clamp(r[0],r[D-1],C)):_}function fillOffset(r,n){const a=r[r.length-1];for(let c=1;c<=n;c++){const p=progress(0,n,c);r.push(mixNumber$1(a,1,p))}}function defaultOffset(r){const n=[0];return fillOffset(n,r.length-1),n}function convertOffsetToTimes(r,n){return r.map(a=>a*n)}function defaultEasing(r,n){return r.map(()=>n||easeInOut).splice(0,r.length-1)}function keyframes({duration:r=300,keyframes:n,times:a,ease:c="easeInOut"}){const p=isEasingArray(c)?c.map(easingDefinitionToFunction):easingDefinitionToFunction(c),D={done:!1,value:n[0]},u=convertOffsetToTimes(a&&a.length===n.length?a:defaultOffset(n),r),v=interpolate(u,n,{ease:Array.isArray(p)?p:defaultEasing(n,p)});return{calculatedDuration:r,next:m=>(D.value=v(m),D.done=m>=r,D)}}const isNotNull$1=r=>r!==null;function getFinalKeyframe$1(r,{repeat:n,repeatType:a="loop"},c,p=1){const D=r.filter(isNotNull$1),v=p<0||n&&a!=="loop"&&n%2===1?0:D.length-1;return!v||c===void 0?D[v]:c}const transitionTypeMap={decay:inertia,inertia,tween:keyframes,keyframes,spring};function replaceTransitionType(r){typeof r.type=="string"&&(r.type=transitionTypeMap[r.type])}class WithPromise{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(n=>{this.resolve=n})}notifyFinished(){this.resolve()}then(n,a){return this.finished.then(n,a)}}const percentToProgress=r=>r/100;class JSAnimation extends WithPromise{constructor(n){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:a}=this.options;a&&a.updatedAt!==time.now()&&this.tick(time.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=n,this.initAnimation(),this.play(),n.autoplay===!1&&this.pause()}initAnimation(){const{options:n}=this;replaceTransitionType(n);const{type:a=keyframes,repeat:c=0,repeatDelay:p=0,repeatType:D,velocity:u=0}=n;let{keyframes:v}=n;const m=a||keyframes;m!==keyframes&&typeof v[0]!="number"&&(this.mixKeyframes=pipe(percentToProgress,mix(v[0],v[1])),v=[0,100]);const _=m({...n,keyframes:v});D==="mirror"&&(this.mirroredGenerator=m({...n,keyframes:[...v].reverse(),velocity:-u})),_.calculatedDuration===null&&(_.calculatedDuration=calcGeneratorDuration(_));const{calculatedDuration:C}=_;this.calculatedDuration=C,this.resolvedDuration=C+p,this.totalDuration=this.resolvedDuration*(c+1)-p,this.generator=_}updateTime(n){const a=Math.round(n-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=a}tick(n,a=!1){const{generator:c,totalDuration:p,mixKeyframes:D,mirroredGenerator:u,resolvedDuration:v,calculatedDuration:m}=this;if(this.startTime===null)return c.next(0);const{delay:_=0,keyframes:C,repeat:w,repeatType:k,repeatDelay:F,type:T,onUpdate:z,finalKeyframe:Q}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,n):this.speed<0&&(this.startTime=Math.min(n-p/this.speed,this.startTime)),a?this.currentTime=n:this.updateTime(n);const J=this.currentTime-_*(this.playbackSpeed>=0?1:-1),K=this.playbackSpeed>=0?J<0:J>p;this.currentTime=Math.max(J,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=p);let b=this.currentTime,N=c;if(w){const L=Math.min(this.currentTime,p)/v;let ee=Math.floor(L),Ee=L%1;!Ee&&L>=1&&(Ee=1),Ee===1&&ee--,ee=Math.min(ee,w+1),!!(ee%2)&&(k==="reverse"?(Ee=1-Ee,F&&(Ee-=F/v)):k==="mirror"&&(N=u)),b=clamp(0,1,Ee)*v}const V=K?{done:!1,value:C[0]}:N.next(b);D&&(V.value=D(V.value));let{done:U}=V;!K&&m!==null&&(U=this.playbackSpeed>=0?this.currentTime>=p:this.currentTime<=0);const Z=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&U);return Z&&T!==inertia&&(V.value=getFinalKeyframe$1(C,this.options,Q,this.speed)),z&&z(V.value),Z&&this.finish(),V}then(n,a){return this.finished.then(n,a)}get duration(){return millisecondsToSeconds(this.calculatedDuration)}get iterationDuration(){const{delay:n=0}=this.options||{};return this.duration+millisecondsToSeconds(n)}get time(){return millisecondsToSeconds(this.currentTime)}set time(n){n=secondsToMilliseconds(n),this.currentTime=n,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=n:this.driver&&(this.startTime=this.driver.now()-n/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(n){this.updateTime(time.now());const a=this.playbackSpeed!==n;this.playbackSpeed=n,a&&(this.time=millisecondsToSeconds(this.currentTime))}play(){if(this.isStopped)return;const{driver:n=frameloopDriver,startTime:a}=this.options;this.driver||(this.driver=n(p=>this.tick(p))),this.options.onPlay?.();const c=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=c):this.holdTime!==null?this.startTime=c-this.holdTime:this.startTime||(this.startTime=a??c),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(time.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(n){return this.startTime=0,this.tick(n,!0)}attachTimeline(n){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),n.observe(this)}}function fillWildcards(r){for(let n=1;n<r.length;n++)r[n]??(r[n]=r[n-1])}const radToDeg=r=>r*180/Math.PI,rotate=r=>{const n=radToDeg(Math.atan2(r[1],r[0]));return rebaseAngle(n)},matrix2dParsers={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:r=>(Math.abs(r[0])+Math.abs(r[3]))/2,rotate,rotateZ:rotate,skewX:r=>radToDeg(Math.atan(r[1])),skewY:r=>radToDeg(Math.atan(r[2])),skew:r=>(Math.abs(r[1])+Math.abs(r[2]))/2},rebaseAngle=r=>(r=r%360,r<0&&(r+=360),r),rotateZ=rotate,scaleX=r=>Math.sqrt(r[0]*r[0]+r[1]*r[1]),scaleY=r=>Math.sqrt(r[4]*r[4]+r[5]*r[5]),matrix3dParsers={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX,scaleY,scale:r=>(scaleX(r)+scaleY(r))/2,rotateX:r=>rebaseAngle(radToDeg(Math.atan2(r[6],r[5]))),rotateY:r=>rebaseAngle(radToDeg(Math.atan2(-r[2],r[0]))),rotateZ,rotate:rotateZ,skewX:r=>radToDeg(Math.atan(r[4])),skewY:r=>radToDeg(Math.atan(r[1])),skew:r=>(Math.abs(r[1])+Math.abs(r[4]))/2};function defaultTransformValue(r){return r.includes("scale")?1:0}function parseValueFromTransform(r,n){if(!r||r==="none")return defaultTransformValue(n);const a=r.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let c,p;if(a)c=matrix3dParsers,p=a;else{const v=r.match(/^matrix\(([-\d.e\s,]+)\)$/u);c=matrix2dParsers,p=v}if(!p)return defaultTransformValue(n);const D=c[n],u=p[1].split(",").map(convertTransformToNumber);return typeof D=="function"?D(u):u[D]}const readTransformValue=(r,n)=>{const{transform:a="none"}=getComputedStyle(r);return parseValueFromTransform(a,n)};function convertTransformToNumber(r){return parseFloat(r.trim())}const transformPropOrder=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],transformProps=new Set(transformPropOrder),isNumOrPxType=r=>r===number||r===px,transformKeys=new Set(["x","y","z"]),nonTranslationalTransformKeys=transformPropOrder.filter(r=>!transformKeys.has(r));function removeNonTranslationalTransform(r){const n=[];return nonTranslationalTransformKeys.forEach(a=>{const c=r.getValue(a);c!==void 0&&(n.push([a,c.get()]),c.set(a.startsWith("scale")?1:0))}),n}const positionalValues={width:({x:r},{paddingLeft:n="0",paddingRight:a="0"})=>r.max-r.min-parseFloat(n)-parseFloat(a),height:({y:r},{paddingTop:n="0",paddingBottom:a="0"})=>r.max-r.min-parseFloat(n)-parseFloat(a),top:(r,{top:n})=>parseFloat(n),left:(r,{left:n})=>parseFloat(n),bottom:({y:r},{top:n})=>parseFloat(n)+(r.max-r.min),right:({x:r},{left:n})=>parseFloat(n)+(r.max-r.min),x:(r,{transform:n})=>parseValueFromTransform(n,"x"),y:(r,{transform:n})=>parseValueFromTransform(n,"y")};positionalValues.translateX=positionalValues.x;positionalValues.translateY=positionalValues.y;const toResolve=new Set;let isScheduled=!1,anyNeedsMeasurement=!1,isForced=!1;function measureAllKeyframes(){if(anyNeedsMeasurement){const r=Array.from(toResolve).filter(c=>c.needsMeasurement),n=new Set(r.map(c=>c.element)),a=new Map;n.forEach(c=>{const p=removeNonTranslationalTransform(c);p.length&&(a.set(c,p),c.render())}),r.forEach(c=>c.measureInitialState()),n.forEach(c=>{c.render();const p=a.get(c);p&&p.forEach(([D,u])=>{c.getValue(D)?.set(u)})}),r.forEach(c=>c.measureEndState()),r.forEach(c=>{c.suspendedScrollY!==void 0&&window.scrollTo(0,c.suspendedScrollY)})}anyNeedsMeasurement=!1,isScheduled=!1,toResolve.forEach(r=>r.complete(isForced)),toResolve.clear()}function readAllKeyframes(){toResolve.forEach(r=>{r.readKeyframes(),r.needsMeasurement&&(anyNeedsMeasurement=!0)})}function flushKeyframeResolvers(){isForced=!0,readAllKeyframes(),measureAllKeyframes(),isForced=!1}class KeyframeResolver{constructor(n,a,c,p,D,u=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...n],this.onComplete=a,this.name=c,this.motionValue=p,this.element=D,this.isAsync=u}scheduleResolve(){this.state="scheduled",this.isAsync?(toResolve.add(this),isScheduled||(isScheduled=!0,frame.read(readAllKeyframes),frame.resolveKeyframes(measureAllKeyframes))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:n,name:a,element:c,motionValue:p}=this;if(n[0]===null){const D=p?.get(),u=n[n.length-1];if(D!==void 0)n[0]=D;else if(c&&a){const v=c.readValue(a,u);v!=null&&(n[0]=v)}n[0]===void 0&&(n[0]=u),p&&D===void 0&&p.set(n[0])}fillWildcards(n)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(n=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,n),toResolve.delete(this)}cancel(){this.state==="scheduled"&&(toResolve.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const isCSSVar=r=>r.startsWith("--");function setStyle(r,n,a){isCSSVar(n)?r.style.setProperty(n,a):r.style[n]=a}const supportsScrollTimeline=memo(()=>window.ScrollTimeline!==void 0),supportsFlags={};function memoSupports(r,n){const a=memo(r);return()=>supportsFlags[n]??a()}const supportsLinearEasing=memoSupports(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),cubicBezierAsString=([r,n,a,c])=>`cubic-bezier(${r}, ${n}, ${a}, ${c})`,supportedWaapiEasing={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:cubicBezierAsString([0,.65,.55,1]),circOut:cubicBezierAsString([.55,0,1,.45]),backIn:cubicBezierAsString([.31,.01,.66,-.59]),backOut:cubicBezierAsString([.33,1.53,.69,.99])};function mapEasingToNativeEasing(r,n){if(r)return typeof r=="function"?supportsLinearEasing()?generateLinearEasing(r,n):"ease-out":isBezierDefinition(r)?cubicBezierAsString(r):Array.isArray(r)?r.map(a=>mapEasingToNativeEasing(a,n)||supportedWaapiEasing.easeOut):supportedWaapiEasing[r]}function startWaapiAnimation(r,n,a,{delay:c=0,duration:p=300,repeat:D=0,repeatType:u="loop",ease:v="easeOut",times:m}={},_=void 0){const C={[n]:a};m&&(C.offset=m);const w=mapEasingToNativeEasing(v,p);Array.isArray(w)&&(C.easing=w);const k={delay:c,duration:p,easing:Array.isArray(w)?"linear":w,fill:"both",iterations:D+1,direction:u==="reverse"?"alternate":"normal"};return _&&(k.pseudoElement=_),r.animate(C,k)}function isGenerator(r){return typeof r=="function"&&"applyToOptions"in r}function applyGeneratorOptions({type:r,...n}){return isGenerator(r)&&supportsLinearEasing()?r.applyToOptions(n):(n.duration??(n.duration=300),n.ease??(n.ease="easeOut"),n)}class NativeAnimation extends WithPromise{constructor(n){if(super(),this.finishedTime=null,this.isStopped=!1,!n)return;const{element:a,name:c,keyframes:p,pseudoElement:D,allowFlatten:u=!1,finalKeyframe:v,onComplete:m}=n;this.isPseudoElement=!!D,this.allowFlatten=u,this.options=n,invariant(typeof n.type!="string");const _=applyGeneratorOptions(n);this.animation=startWaapiAnimation(a,c,p,_,D),_.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!D){const C=getFinalKeyframe$1(p,this.options,v,this.speed);this.updateMotionValue?this.updateMotionValue(C):setStyle(a,c,C),this.animation.cancel()}m?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:n}=this;n==="idle"||n==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const n=this.animation.effect?.getComputedTiming?.().duration||0;return millisecondsToSeconds(Number(n))}get iterationDuration(){const{delay:n=0}=this.options||{};return this.duration+millisecondsToSeconds(n)}get time(){return millisecondsToSeconds(Number(this.animation.currentTime)||0)}set time(n){this.finishedTime=null,this.animation.currentTime=secondsToMilliseconds(n)}get speed(){return this.animation.playbackRate}set speed(n){n<0&&(this.finishedTime=null),this.animation.playbackRate=n}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(n){this.animation.startTime=n}attachTimeline({timeline:n,observe:a}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,n&&supportsScrollTimeline()?(this.animation.timeline=n,noop):a(this)}}const unsupportedEasingFunctions={anticipate,backInOut,circInOut};function isUnsupportedEase(r){return r in unsupportedEasingFunctions}function replaceStringEasing(r){typeof r.ease=="string"&&isUnsupportedEase(r.ease)&&(r.ease=unsupportedEasingFunctions[r.ease])}const sampleDelta=10;class NativeAnimationExtended extends NativeAnimation{constructor(n){replaceStringEasing(n),replaceTransitionType(n),super(n),n.startTime&&(this.startTime=n.startTime),this.options=n}updateMotionValue(n){const{motionValue:a,onUpdate:c,onComplete:p,element:D,...u}=this.options;if(!a)return;if(n!==void 0){a.set(n);return}const v=new JSAnimation({...u,autoplay:!1}),m=secondsToMilliseconds(this.finishedTime??this.time);a.setWithVelocity(v.sample(m-sampleDelta).value,v.sample(m).value,sampleDelta),v.stop()}}const isAnimatable=(r,n)=>n==="zIndex"?!1:!!(typeof r=="number"||Array.isArray(r)||typeof r=="string"&&(complex.test(r)||r==="0")&&!r.startsWith("url("));function hasKeyframesChanged(r){const n=r[0];if(r.length===1)return!0;for(let a=0;a<r.length;a++)if(r[a]!==n)return!0}function canAnimate(r,n,a,c){const p=r[0];if(p===null)return!1;if(n==="display"||n==="visibility")return!0;const D=r[r.length-1],u=isAnimatable(p,n),v=isAnimatable(D,n);return!u||!v?!1:hasKeyframesChanged(r)||(a==="spring"||isGenerator(a))&&c}function makeAnimationInstant(r){r.duration=0,r.type="keyframes"}const acceleratedValues=new Set(["opacity","clipPath","filter","transform"]),supportsWaapi=memo(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function supportsBrowserAnimation(r){const{motionValue:n,name:a,repeatDelay:c,repeatType:p,damping:D,type:u}=r;if(!(n?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:m,transformTemplate:_}=n.owner.getProps();return supportsWaapi()&&a&&acceleratedValues.has(a)&&(a!=="transform"||!_)&&!m&&!c&&p!=="mirror"&&D!==0&&u!=="inertia"}const MAX_RESOLVE_DELAY=40;class AsyncMotionValueAnimation extends WithPromise{constructor({autoplay:n=!0,delay:a=0,type:c="keyframes",repeat:p=0,repeatDelay:D=0,repeatType:u="loop",keyframes:v,name:m,motionValue:_,element:C,...w}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=time.now();const k={autoplay:n,delay:a,type:c,repeat:p,repeatDelay:D,repeatType:u,name:m,motionValue:_,element:C,...w},F=C?.KeyframeResolver||KeyframeResolver;this.keyframeResolver=new F(v,(T,z,Q)=>this.onKeyframesResolved(T,z,k,!Q),m,_,C),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(n,a,c,p){this.keyframeResolver=void 0;const{name:D,type:u,velocity:v,delay:m,isHandoff:_,onUpdate:C}=c;this.resolvedAt=time.now(),canAnimate(n,D,u,v)||((MotionGlobalConfig.instantAnimations||!m)&&C?.(getFinalKeyframe$1(n,c,a)),n[0]=n[n.length-1],makeAnimationInstant(c),c.repeat=0);const k={startTime:p?this.resolvedAt?this.resolvedAt-this.createdAt>MAX_RESOLVE_DELAY?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:a,...c,keyframes:n},F=!_&&supportsBrowserAnimation(k)?new NativeAnimationExtended({...k,element:k.motionValue.owner.current}):new JSAnimation(k);F.finished.then(()=>this.notifyFinished()).catch(noop),this.pendingTimeline&&(this.stopTimeline=F.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=F}get finished(){return this._animation?this.animation.finished:this._finished}then(n,a){return this.finished.finally(n).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),flushKeyframeResolvers()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(n){this.animation.time=n}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(n){this.animation.speed=n}get startTime(){return this.animation.startTime}attachTimeline(n){return this._animation?this.stopTimeline=this.animation.attachTimeline(n):this.pendingTimeline=n,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const splitCSSVariableRegex=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function parseCSSVariable(r){const n=splitCSSVariableRegex.exec(r);if(!n)return[,];const[,a,c,p]=n;return[`--${a??c}`,p]}function getVariableValue(r,n,a=1){const[c,p]=parseCSSVariable(r);if(!c)return;const D=window.getComputedStyle(n).getPropertyValue(c);if(D){const u=D.trim();return isNumericalString(u)?parseFloat(u):u}return isCSSVariableToken(p)?getVariableValue(p,n,a+1):p}function getValueTransition(r,n){return r?.[n]??r?.default??r}const positionalKeys=new Set(["width","height","top","left","right","bottom",...transformPropOrder]),auto={test:r=>r==="auto",parse:r=>r},testValueType=r=>n=>n.test(r),dimensionValueTypes=[number,px,percent,degrees,vw,vh,auto],findDimensionValueType=r=>dimensionValueTypes.find(testValueType(r));function isNone(r){return typeof r=="number"?r===0:r!==null?r==="none"||r==="0"||isZeroValueString(r):!0}const maxDefaults=new Set(["brightness","contrast","saturate","opacity"]);function applyDefaultFilter(r){const[n,a]=r.slice(0,-1).split("(");if(n==="drop-shadow")return r;const[c]=a.match(floatRegex)||[];if(!c)return r;const p=a.replace(c,"");let D=maxDefaults.has(n)?1:0;return c!==a&&(D*=100),n+"("+D+p+")"}const functionRegex=/\b([a-z-]*)\(.*?\)/gu,filter={...complex,getAnimatableNone:r=>{const n=r.match(functionRegex);return n?n.map(applyDefaultFilter).join(" "):r}},int={...number,transform:Math.round},transformValueTypes={rotate:degrees,rotateX:degrees,rotateY:degrees,rotateZ:degrees,scale,scaleX:scale,scaleY:scale,scaleZ:scale,skew:degrees,skewX:degrees,skewY:degrees,distance:px,translateX:px,translateY:px,translateZ:px,x:px,y:px,z:px,perspective:px,transformPerspective:px,opacity:alpha,originX:progressPercentage,originY:progressPercentage,originZ:px},numberValueTypes={borderWidth:px,borderTopWidth:px,borderRightWidth:px,borderBottomWidth:px,borderLeftWidth:px,borderRadius:px,radius:px,borderTopLeftRadius:px,borderTopRightRadius:px,borderBottomRightRadius:px,borderBottomLeftRadius:px,width:px,maxWidth:px,height:px,maxHeight:px,top:px,right:px,bottom:px,left:px,padding:px,paddingTop:px,paddingRight:px,paddingBottom:px,paddingLeft:px,margin:px,marginTop:px,marginRight:px,marginBottom:px,marginLeft:px,backgroundPositionX:px,backgroundPositionY:px,...transformValueTypes,zIndex:int,fillOpacity:alpha,strokeOpacity:alpha,numOctaves:int},defaultValueTypes={...numberValueTypes,color,backgroundColor:color,outlineColor:color,fill:color,stroke:color,borderColor:color,borderTopColor:color,borderRightColor:color,borderBottomColor:color,borderLeftColor:color,filter,WebkitFilter:filter},getDefaultValueType=r=>defaultValueTypes[r];function getAnimatableNone(r,n){let a=getDefaultValueType(r);return a!==filter&&(a=complex),a.getAnimatableNone?a.getAnimatableNone(n):void 0}const invalidTemplates=new Set(["auto","none","0"]);function makeNoneKeyframesAnimatable(r,n,a){let c=0,p;for(;c<r.length&&!p;){const D=r[c];typeof D=="string"&&!invalidTemplates.has(D)&&analyseComplexValue(D).values.length&&(p=r[c]),c++}if(p&&a)for(const D of n)r[D]=getAnimatableNone(a,p)}class DOMKeyframesResolver extends KeyframeResolver{constructor(n,a,c,p,D){super(n,a,c,p,D,!0)}readKeyframes(){const{unresolvedKeyframes:n,element:a,name:c}=this;if(!a||!a.current)return;super.readKeyframes();for(let m=0;m<n.length;m++){let _=n[m];if(typeof _=="string"&&(_=_.trim(),isCSSVariableToken(_))){const C=getVariableValue(_,a.current);C!==void 0&&(n[m]=C),m===n.length-1&&(this.finalKeyframe=_)}}if(this.resolveNoneKeyframes(),!positionalKeys.has(c)||n.length!==2)return;const[p,D]=n,u=findDimensionValueType(p),v=findDimensionValueType(D);if(u!==v)if(isNumOrPxType(u)&&isNumOrPxType(v))for(let m=0;m<n.length;m++){const _=n[m];typeof _=="string"&&(n[m]=parseFloat(_))}else positionalValues[c]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:n,name:a}=this,c=[];for(let p=0;p<n.length;p++)(n[p]===null||isNone(n[p]))&&c.push(p);c.length&&makeNoneKeyframesAnimatable(n,c,a)}measureInitialState(){const{element:n,unresolvedKeyframes:a,name:c}=this;if(!n||!n.current)return;c==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=positionalValues[c](n.measureViewportBox(),window.getComputedStyle(n.current)),a[0]=this.measuredOrigin;const p=a[a.length-1];p!==void 0&&n.getValue(c,p).jump(p,!1)}measureEndState(){const{element:n,name:a,unresolvedKeyframes:c}=this;if(!n||!n.current)return;const p=n.getValue(a);p&&p.jump(this.measuredOrigin,!1);const D=c.length-1,u=c[D];c[D]=positionalValues[a](n.measureViewportBox(),window.getComputedStyle(n.current)),u!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=u),this.removedTransforms?.length&&this.removedTransforms.forEach(([v,m])=>{n.getValue(v).set(m)}),this.resolveNoneKeyframes()}}function resolveElements(r,n,a){if(r instanceof EventTarget)return[r];if(typeof r=="string"){let c=document;const p=a?.[r]??c.querySelectorAll(r);return p?Array.from(p):[]}return Array.from(r)}const getValueAsType=(r,n)=>n&&typeof r=="number"?n.transform(r):r;function isHTMLElement(r){return isObject(r)&&"offsetHeight"in r}const MAX_VELOCITY_DELTA=30,isFloat=r=>!isNaN(parseFloat(r));class MotionValue{constructor(n,a={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=c=>{const p=time.now();if(this.updatedAt!==p&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(c),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const D of this.dependents)D.dirty()},this.hasAnimated=!1,this.setCurrent(n),this.owner=a.owner}setCurrent(n){this.current=n,this.updatedAt=time.now(),this.canTrackVelocity===null&&n!==void 0&&(this.canTrackVelocity=isFloat(this.current))}setPrevFrameValue(n=this.current){this.prevFrameValue=n,this.prevUpdatedAt=this.updatedAt}onChange(n){return this.on("change",n)}on(n,a){this.events[n]||(this.events[n]=new SubscriptionManager);const c=this.events[n].add(a);return n==="change"?()=>{c(),frame.read(()=>{this.events.change.getSize()||this.stop()})}:c}clearListeners(){for(const n in this.events)this.events[n].clear()}attach(n,a){this.passiveEffect=n,this.stopPassiveEffect=a}set(n){this.passiveEffect?this.passiveEffect(n,this.updateAndNotify):this.updateAndNotify(n)}setWithVelocity(n,a,c){this.set(a),this.prev=void 0,this.prevFrameValue=n,this.prevUpdatedAt=this.updatedAt-c}jump(n,a=!0){this.updateAndNotify(n),this.prev=n,this.prevUpdatedAt=this.prevFrameValue=void 0,a&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(n){this.dependents||(this.dependents=new Set),this.dependents.add(n)}removeDependent(n){this.dependents&&this.dependents.delete(n)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const n=time.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||n-this.updatedAt>MAX_VELOCITY_DELTA)return 0;const a=Math.min(this.updatedAt-this.prevUpdatedAt,MAX_VELOCITY_DELTA);return velocityPerSecond(parseFloat(this.current)-parseFloat(this.prevFrameValue),a)}start(n){return this.stop(),new Promise(a=>{this.hasAnimated=!0,this.animation=n(a),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function motionValue(r,n){return new MotionValue(r,n)}const{schedule:microtask}=createRenderBatcher(queueMicrotask,!1),isDragging={x:!1,y:!1};function isDragActive(){return isDragging.x||isDragging.y}function setDragLock(r){return r==="x"||r==="y"?isDragging[r]?null:(isDragging[r]=!0,()=>{isDragging[r]=!1}):isDragging.x||isDragging.y?null:(isDragging.x=isDragging.y=!0,()=>{isDragging.x=isDragging.y=!1})}function setupGesture(r,n){const a=resolveElements(r),c=new AbortController,p={passive:!0,...n,signal:c.signal};return[a,p,()=>c.abort()]}function isValidHover(r){return!(r.pointerType==="touch"||isDragActive())}function hover(r,n,a={}){const[c,p,D]=setupGesture(r,a),u=v=>{if(!isValidHover(v))return;const{target:m}=v,_=n(m,v);if(typeof _!="function"||!m)return;const C=w=>{isValidHover(w)&&(_(w),m.removeEventListener("pointerleave",C))};m.addEventListener("pointerleave",C,p)};return c.forEach(v=>{v.addEventListener("pointerenter",u,p)}),D}const isNodeOrChild=(r,n)=>n?r===n?!0:isNodeOrChild(r,n.parentElement):!1,isPrimaryPointer=r=>r.pointerType==="mouse"?typeof r.button!="number"||r.button<=0:r.isPrimary!==!1,focusableElements=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function isElementKeyboardAccessible(r){return focusableElements.has(r.tagName)||r.tabIndex!==-1}const isPressing=new WeakSet;function filterEvents(r){return n=>{n.key==="Enter"&&r(n)}}function firePointerEvent(r,n){r.dispatchEvent(new PointerEvent("pointer"+n,{isPrimary:!0,bubbles:!0}))}const enableKeyboardPress=(r,n)=>{const a=r.currentTarget;if(!a)return;const c=filterEvents(()=>{if(isPressing.has(a))return;firePointerEvent(a,"down");const p=filterEvents(()=>{firePointerEvent(a,"up")}),D=()=>firePointerEvent(a,"cancel");a.addEventListener("keyup",p,n),a.addEventListener("blur",D,n)});a.addEventListener("keydown",c,n),a.addEventListener("blur",()=>a.removeEventListener("keydown",c),n)};function isValidPressEvent(r){return isPrimaryPointer(r)&&!isDragActive()}function press(r,n,a={}){const[c,p,D]=setupGesture(r,a),u=v=>{const m=v.currentTarget;if(!isValidPressEvent(v))return;isPressing.add(m);const _=n(m,v),C=(F,T)=>{window.removeEventListener("pointerup",w),window.removeEventListener("pointercancel",k),isPressing.has(m)&&isPressing.delete(m),isValidPressEvent(F)&&typeof _=="function"&&_(F,{success:T})},w=F=>{C(F,m===window||m===document||a.useGlobalTarget||isNodeOrChild(m,F.target))},k=F=>{C(F,!1)};window.addEventListener("pointerup",w,p),window.addEventListener("pointercancel",k,p)};return c.forEach(v=>{(a.useGlobalTarget?window:v).addEventListener("pointerdown",u,p),isHTMLElement(v)&&(v.addEventListener("focus",_=>enableKeyboardPress(_,p)),!isElementKeyboardAccessible(v)&&!v.hasAttribute("tabindex")&&(v.tabIndex=0))}),D}function isSVGElement(r){return isObject(r)&&"ownerSVGElement"in r}function isSVGSVGElement(r){return isSVGElement(r)&&r.tagName==="svg"}const isMotionValue=r=>!!(r&&r.getVelocity),valueTypes=[...dimensionValueTypes,color,complex],findValueType=r=>valueTypes.find(testValueType(r)),MotionConfigContext=reactExports.createContext({transformPagePoint:r=>r,isStatic:!1,reducedMotion:"never"});function setRef(r,n){if(typeof r=="function")return r(n);r!=null&&(r.current=n)}function composeRefs(...r){return n=>{let a=!1;const c=r.map(p=>{const D=setRef(p,n);return!a&&typeof D=="function"&&(a=!0),D});if(a)return()=>{for(let p=0;p<c.length;p++){const D=c[p];typeof D=="function"?D():setRef(r[p],null)}}}}function useComposedRefs(...r){return reactExports.useCallback(composeRefs(...r),r)}class PopChildMeasure extends reactExports.Component{getSnapshotBeforeUpdate(n){const a=this.props.childRef.current;if(a&&n.isPresent&&!this.props.isPresent){const c=a.offsetParent,p=isHTMLElement(c)&&c.offsetWidth||0,D=this.props.sizeRef.current;D.height=a.offsetHeight||0,D.width=a.offsetWidth||0,D.top=a.offsetTop,D.left=a.offsetLeft,D.right=p-D.width-D.left}return null}componentDidUpdate(){}render(){return this.props.children}}function PopChild({children:r,isPresent:n,anchorX:a,root:c}){const p=reactExports.useId(),D=reactExports.useRef(null),u=reactExports.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:v}=reactExports.useContext(MotionConfigContext),m=useComposedRefs(D,r?.ref);return reactExports.useInsertionEffect(()=>{const{width:_,height:C,top:w,left:k,right:F}=u.current;if(n||!D.current||!_||!C)return;const T=a==="left"?`left: ${k}`:`right: ${F}`;D.current.dataset.motionPopId=p;const z=document.createElement("style");v&&(z.nonce=v);const Q=c??document.head;return Q.appendChild(z),z.sheet&&z.sheet.insertRule(`
          [data-motion-pop-id="${p}"] {
            position: absolute !important;
            width: ${_}px !important;
            height: ${C}px !important;
            ${T}px !important;
            top: ${w}px !important;
          }
        `),()=>{Q.contains(z)&&Q.removeChild(z)}},[n]),jsxRuntimeExports.jsx(PopChildMeasure,{isPresent:n,childRef:D,sizeRef:u,children:reactExports.cloneElement(r,{ref:m})})}const PresenceChild=({children:r,initial:n,isPresent:a,onExitComplete:c,custom:p,presenceAffectsLayout:D,mode:u,anchorX:v,root:m})=>{const _=useConstant(newChildrenMap),C=reactExports.useId();let w=!0,k=reactExports.useMemo(()=>(w=!1,{id:C,initial:n,isPresent:a,custom:p,onExitComplete:F=>{_.set(F,!0);for(const T of _.values())if(!T)return;c&&c()},register:F=>(_.set(F,!1),()=>_.delete(F))}),[a,_,c]);return D&&w&&(k={...k}),reactExports.useMemo(()=>{_.forEach((F,T)=>_.set(T,!1))},[a]),reactExports.useEffect(()=>{!a&&!_.size&&c&&c()},[a]),u==="popLayout"&&(r=jsxRuntimeExports.jsx(PopChild,{isPresent:a,anchorX:v,root:m,children:r})),jsxRuntimeExports.jsx(PresenceContext.Provider,{value:k,children:r})};function newChildrenMap(){return new Map}function usePresence(r=!0){const n=reactExports.useContext(PresenceContext);if(n===null)return[!0,null];const{isPresent:a,onExitComplete:c,register:p}=n,D=reactExports.useId();reactExports.useEffect(()=>{if(r)return p(D)},[r]);const u=reactExports.useCallback(()=>r&&c&&c(D),[D,c,r]);return!a&&c?[!1,u]:[!0]}const getChildKey=r=>r.key||"";function onlyElements(r){const n=[];return reactExports.Children.forEach(r,a=>{reactExports.isValidElement(a)&&n.push(a)}),n}const AnimatePresence=({children:r,custom:n,initial:a=!0,onExitComplete:c,presenceAffectsLayout:p=!0,mode:D="sync",propagate:u=!1,anchorX:v="left",root:m})=>{const[_,C]=usePresence(u),w=reactExports.useMemo(()=>onlyElements(r),[r]),k=u&&!_?[]:w.map(getChildKey),F=reactExports.useRef(!0),T=reactExports.useRef(w),z=useConstant(()=>new Map),[Q,J]=reactExports.useState(w),[K,b]=reactExports.useState(w);useIsomorphicLayoutEffect(()=>{F.current=!1,T.current=w;for(let U=0;U<K.length;U++){const Z=getChildKey(K[U]);k.includes(Z)?z.delete(Z):z.get(Z)!==!0&&z.set(Z,!1)}},[K,k.length,k.join("-")]);const N=[];if(w!==Q){let U=[...w];for(let Z=0;Z<K.length;Z++){const L=K[Z],ee=getChildKey(L);k.includes(ee)||(U.splice(Z,0,L),N.push(L))}return D==="wait"&&N.length&&(U=N),b(onlyElements(U)),J(w),null}const{forceRender:V}=reactExports.useContext(LayoutGroupContext);return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:K.map(U=>{const Z=getChildKey(U),L=u&&!_?!1:w===K||k.includes(Z),ee=()=>{if(z.has(Z))z.set(Z,!0);else return;let Ee=!0;z.forEach(he=>{he||(Ee=!1)}),Ee&&(V?.(),b(T.current),u&&C?.(),c&&c())};return jsxRuntimeExports.jsx(PresenceChild,{isPresent:L,initial:!F.current||a?void 0:!1,custom:n,presenceAffectsLayout:p,mode:D,root:m,onExitComplete:L?void 0:ee,anchorX:v,children:U},Z)})})},LazyContext=reactExports.createContext({strict:!1}),featureProps={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},featureDefinitions={};for(const r in featureProps)featureDefinitions[r]={isEnabled:n=>featureProps[r].some(a=>!!n[a])};function loadFeatures(r){for(const n in r)featureDefinitions[n]={...featureDefinitions[n],...r[n]}}const validMotionProps=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function isValidMotionProp(r){return r.startsWith("while")||r.startsWith("drag")&&r!=="draggable"||r.startsWith("layout")||r.startsWith("onTap")||r.startsWith("onPan")||r.startsWith("onLayout")||validMotionProps.has(r)}let shouldForward=r=>!isValidMotionProp(r);function loadExternalIsValidProp(r){typeof r=="function"&&(shouldForward=n=>n.startsWith("on")?!isValidMotionProp(n):r(n))}try{loadExternalIsValidProp(require("@emotion/is-prop-valid").default)}catch{}function filterProps(r,n,a){const c={};for(const p in r)p==="values"&&typeof r.values=="object"||(shouldForward(p)||a===!0&&isValidMotionProp(p)||!n&&!isValidMotionProp(p)||r.draggable&&p.startsWith("onDrag"))&&(c[p]=r[p]);return c}const MotionContext=reactExports.createContext({});function isAnimationControls(r){return r!==null&&typeof r=="object"&&typeof r.start=="function"}function isVariantLabel(r){return typeof r=="string"||Array.isArray(r)}const variantPriorityOrder=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],variantProps=["initial",...variantPriorityOrder];function isControllingVariants(r){return isAnimationControls(r.animate)||variantProps.some(n=>isVariantLabel(r[n]))}function isVariantNode(r){return!!(isControllingVariants(r)||r.variants)}function getCurrentTreeVariants(r,n){if(isControllingVariants(r)){const{initial:a,animate:c}=r;return{initial:a===!1||isVariantLabel(a)?a:void 0,animate:isVariantLabel(c)?c:void 0}}return r.inherit!==!1?n:{}}function useCreateMotionContext(r){const{initial:n,animate:a}=getCurrentTreeVariants(r,reactExports.useContext(MotionContext));return reactExports.useMemo(()=>({initial:n,animate:a}),[variantLabelsAsDependency(n),variantLabelsAsDependency(a)])}function variantLabelsAsDependency(r){return Array.isArray(r)?r.join(" "):r}const scaleCorrectors={};function addScaleCorrector(r){for(const n in r)scaleCorrectors[n]=r[n],isCSSVariableName(n)&&(scaleCorrectors[n].isCSSVariable=!0)}function isForcedMotionValue(r,{layout:n,layoutId:a}){return transformProps.has(r)||r.startsWith("origin")||(n||a!==void 0)&&(!!scaleCorrectors[r]||r==="opacity")}const translateAlias={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},numTransforms=transformPropOrder.length;function buildTransform(r,n,a){let c="",p=!0;for(let D=0;D<numTransforms;D++){const u=transformPropOrder[D],v=r[u];if(v===void 0)continue;let m=!0;if(typeof v=="number"?m=v===(u.startsWith("scale")?1:0):m=parseFloat(v)===0,!m||a){const _=getValueAsType(v,numberValueTypes[u]);if(!m){p=!1;const C=translateAlias[u]||u;c+=`${C}(${_}) `}a&&(n[u]=_)}}return c=c.trim(),a?c=a(n,p?"":c):p&&(c="none"),c}function buildHTMLStyles(r,n,a){const{style:c,vars:p,transformOrigin:D}=r;let u=!1,v=!1;for(const m in n){const _=n[m];if(transformProps.has(m)){u=!0;continue}else if(isCSSVariableName(m)){p[m]=_;continue}else{const C=getValueAsType(_,numberValueTypes[m]);m.startsWith("origin")?(v=!0,D[m]=C):c[m]=C}}if(n.transform||(u||a?c.transform=buildTransform(n,r.transform,a):c.transform&&(c.transform="none")),v){const{originX:m="50%",originY:_="50%",originZ:C=0}=D;c.transformOrigin=`${m} ${_} ${C}`}}const createHtmlRenderState=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function copyRawValuesOnly(r,n,a){for(const c in n)!isMotionValue(n[c])&&!isForcedMotionValue(c,a)&&(r[c]=n[c])}function useInitialMotionValues({transformTemplate:r},n){return reactExports.useMemo(()=>{const a=createHtmlRenderState();return buildHTMLStyles(a,n,r),Object.assign({},a.vars,a.style)},[n])}function useStyle(r,n){const a=r.style||{},c={};return copyRawValuesOnly(c,a,r),Object.assign(c,useInitialMotionValues(r,n)),c}function useHTMLProps(r,n){const a={},c=useStyle(r,n);return r.drag&&r.dragListener!==!1&&(a.draggable=!1,c.userSelect=c.WebkitUserSelect=c.WebkitTouchCallout="none",c.touchAction=r.drag===!0?"none":`pan-${r.drag==="x"?"y":"x"}`),r.tabIndex===void 0&&(r.onTap||r.onTapStart||r.whileTap)&&(a.tabIndex=0),a.style=c,a}const dashKeys={offset:"stroke-dashoffset",array:"stroke-dasharray"},camelKeys={offset:"strokeDashoffset",array:"strokeDasharray"};function buildSVGPath(r,n,a=1,c=0,p=!0){r.pathLength=1;const D=p?dashKeys:camelKeys;r[D.offset]=px.transform(-c);const u=px.transform(n),v=px.transform(a);r[D.array]=`${u} ${v}`}function buildSVGAttrs(r,{attrX:n,attrY:a,attrScale:c,pathLength:p,pathSpacing:D=1,pathOffset:u=0,...v},m,_,C){if(buildHTMLStyles(r,v,_),m){r.style.viewBox&&(r.attrs.viewBox=r.style.viewBox);return}r.attrs=r.style,r.style={};const{attrs:w,style:k}=r;w.transform&&(k.transform=w.transform,delete w.transform),(k.transform||w.transformOrigin)&&(k.transformOrigin=w.transformOrigin??"50% 50%",delete w.transformOrigin),k.transform&&(k.transformBox=C?.transformBox??"fill-box",delete w.transformBox),n!==void 0&&(w.x=n),a!==void 0&&(w.y=a),c!==void 0&&(w.scale=c),p!==void 0&&buildSVGPath(w,p,D,u,!1)}const createSvgRenderState=()=>({...createHtmlRenderState(),attrs:{}}),isSVGTag=r=>typeof r=="string"&&r.toLowerCase()==="svg";function useSVGProps(r,n,a,c){const p=reactExports.useMemo(()=>{const D=createSvgRenderState();return buildSVGAttrs(D,n,isSVGTag(c),r.transformTemplate,r.style),{...D.attrs,style:{...D.style}}},[n]);if(r.style){const D={};copyRawValuesOnly(D,r.style,r),p.style={...D,...p.style}}return p}const lowercaseSVGElements=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function isSVGComponent(r){return typeof r!="string"||r.includes("-")?!1:!!(lowercaseSVGElements.indexOf(r)>-1||/[A-Z]/u.test(r))}function useRender(r,n,a,{latestValues:c},p,D=!1){const v=(isSVGComponent(r)?useSVGProps:useHTMLProps)(n,c,p,r),m=filterProps(n,typeof r=="string",D),_=r!==reactExports.Fragment?{...m,...v,ref:a}:{},{children:C}=n,w=reactExports.useMemo(()=>isMotionValue(C)?C.get():C,[C]);return reactExports.createElement(r,{..._,children:w})}function getValueState(r){const n=[{},{}];return r?.values.forEach((a,c)=>{n[0][c]=a.get(),n[1][c]=a.getVelocity()}),n}function resolveVariantFromProps(r,n,a,c){if(typeof n=="function"){const[p,D]=getValueState(c);n=n(a!==void 0?a:r.custom,p,D)}if(typeof n=="string"&&(n=r.variants&&r.variants[n]),typeof n=="function"){const[p,D]=getValueState(c);n=n(a!==void 0?a:r.custom,p,D)}return n}function resolveMotionValue(r){return isMotionValue(r)?r.get():r}function makeState({scrapeMotionValuesFromProps:r,createRenderState:n},a,c,p){return{latestValues:makeLatestValues(a,c,p,r),renderState:n()}}function makeLatestValues(r,n,a,c){const p={},D=c(r,{});for(const k in D)p[k]=resolveMotionValue(D[k]);let{initial:u,animate:v}=r;const m=isControllingVariants(r),_=isVariantNode(r);n&&_&&!m&&r.inherit!==!1&&(u===void 0&&(u=n.initial),v===void 0&&(v=n.animate));let C=a?a.initial===!1:!1;C=C||u===!1;const w=C?v:u;if(w&&typeof w!="boolean"&&!isAnimationControls(w)){const k=Array.isArray(w)?w:[w];for(let F=0;F<k.length;F++){const T=resolveVariantFromProps(r,k[F]);if(T){const{transitionEnd:z,transition:Q,...J}=T;for(const K in J){let b=J[K];if(Array.isArray(b)){const N=C?b.length-1:0;b=b[N]}b!==null&&(p[K]=b)}for(const K in z)p[K]=z[K]}}}return p}const makeUseVisualState=r=>(n,a)=>{const c=reactExports.useContext(MotionContext),p=reactExports.useContext(PresenceContext),D=()=>makeState(r,n,c,p);return a?D():useConstant(D)};function scrapeMotionValuesFromProps$1(r,n,a){const{style:c}=r,p={};for(const D in c)(isMotionValue(c[D])||n.style&&isMotionValue(n.style[D])||isForcedMotionValue(D,r)||a?.getValue(D)?.liveStyle!==void 0)&&(p[D]=c[D]);return p}const useHTMLVisualState=makeUseVisualState({scrapeMotionValuesFromProps:scrapeMotionValuesFromProps$1,createRenderState:createHtmlRenderState});function scrapeMotionValuesFromProps(r,n,a){const c=scrapeMotionValuesFromProps$1(r,n,a);for(const p in r)if(isMotionValue(r[p])||isMotionValue(n[p])){const D=transformPropOrder.indexOf(p)!==-1?"attr"+p.charAt(0).toUpperCase()+p.substring(1):p;c[D]=r[p]}return c}const useSVGVisualState=makeUseVisualState({scrapeMotionValuesFromProps,createRenderState:createSvgRenderState}),motionComponentSymbol=Symbol.for("motionComponentSymbol");function isRefObject(r){return r&&typeof r=="object"&&Object.prototype.hasOwnProperty.call(r,"current")}function useMotionRef(r,n,a){return reactExports.useCallback(c=>{c&&r.onMount&&r.onMount(c),n&&(c?n.mount(c):n.unmount()),a&&(typeof a=="function"?a(c):isRefObject(a)&&(a.current=c))},[n])}const camelToDash=r=>r.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),optimizedAppearDataId="framerAppearId",optimizedAppearDataAttribute="data-"+camelToDash(optimizedAppearDataId),SwitchLayoutGroupContext=reactExports.createContext({});function useVisualElement(r,n,a,c,p){const{visualElement:D}=reactExports.useContext(MotionContext),u=reactExports.useContext(LazyContext),v=reactExports.useContext(PresenceContext),m=reactExports.useContext(MotionConfigContext).reducedMotion,_=reactExports.useRef(null);c=c||u.renderer,!_.current&&c&&(_.current=c(r,{visualState:n,parent:D,props:a,presenceContext:v,blockInitialAnimation:v?v.initial===!1:!1,reducedMotionConfig:m}));const C=_.current,w=reactExports.useContext(SwitchLayoutGroupContext);C&&!C.projection&&p&&(C.type==="html"||C.type==="svg")&&createProjectionNode$1(_.current,a,p,w);const k=reactExports.useRef(!1);reactExports.useInsertionEffect(()=>{C&&k.current&&C.update(a,v)});const F=a[optimizedAppearDataAttribute],T=reactExports.useRef(!!F&&!window.MotionHandoffIsComplete?.(F)&&window.MotionHasOptimisedAnimation?.(F));return useIsomorphicLayoutEffect(()=>{C&&(k.current=!0,window.MotionIsMounted=!0,C.updateFeatures(),C.scheduleRenderMicrotask(),T.current&&C.animationState&&C.animationState.animateChanges())}),reactExports.useEffect(()=>{C&&(!T.current&&C.animationState&&C.animationState.animateChanges(),T.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(F)}),T.current=!1),C.enteringChildren=void 0)}),C}function createProjectionNode$1(r,n,a,c){const{layoutId:p,layout:D,drag:u,dragConstraints:v,layoutScroll:m,layoutRoot:_,layoutCrossfade:C}=n;r.projection=new a(r.latestValues,n["data-framer-portal-id"]?void 0:getClosestProjectingNode(r.parent)),r.projection.setOptions({layoutId:p,layout:D,alwaysMeasureLayout:!!u||v&&isRefObject(v),visualElement:r,animationType:typeof D=="string"?D:"both",initialPromotionConfig:c,crossfade:C,layoutScroll:m,layoutRoot:_})}function getClosestProjectingNode(r){if(r)return r.options.allowProjection!==!1?r.projection:getClosestProjectingNode(r.parent)}function createMotionComponent(r,{forwardMotionProps:n=!1}={},a,c){a&&loadFeatures(a);const p=isSVGComponent(r)?useSVGVisualState:useHTMLVisualState;function D(v,m){let _;const C={...reactExports.useContext(MotionConfigContext),...v,layoutId:useLayoutId(v)},{isStatic:w}=C,k=useCreateMotionContext(v),F=p(v,w);if(!w&&isBrowser){useStrictMode();const T=getProjectionFunctionality(C);_=T.MeasureLayout,k.visualElement=useVisualElement(r,F,C,c,T.ProjectionNode)}return jsxRuntimeExports.jsxs(MotionContext.Provider,{value:k,children:[_&&k.visualElement?jsxRuntimeExports.jsx(_,{visualElement:k.visualElement,...C}):null,useRender(r,v,useMotionRef(F,k.visualElement,m),F,w,n)]})}D.displayName=`motion.${typeof r=="string"?r:`create(${r.displayName??r.name??""})`}`;const u=reactExports.forwardRef(D);return u[motionComponentSymbol]=r,u}function useLayoutId({layoutId:r}){const n=reactExports.useContext(LayoutGroupContext).id;return n&&r!==void 0?n+"-"+r:r}function useStrictMode(r,n){reactExports.useContext(LazyContext).strict}function getProjectionFunctionality(r){const{drag:n,layout:a}=featureDefinitions;if(!n&&!a)return{};const c={...n,...a};return{MeasureLayout:n?.isEnabled(r)||a?.isEnabled(r)?c.MeasureLayout:void 0,ProjectionNode:c.ProjectionNode}}function createMotionProxy(r,n){if(typeof Proxy>"u")return createMotionComponent;const a=new Map,c=(D,u)=>createMotionComponent(D,u,r,n),p=(D,u)=>c(D,u);return new Proxy(p,{get:(D,u)=>u==="create"?c:(a.has(u)||a.set(u,createMotionComponent(u,void 0,r,n)),a.get(u))})}function convertBoundingBoxToBox({top:r,left:n,right:a,bottom:c}){return{x:{min:n,max:a},y:{min:r,max:c}}}function convertBoxToBoundingBox({x:r,y:n}){return{top:n.min,right:r.max,bottom:n.max,left:r.min}}function transformBoxPoints(r,n){if(!n)return r;const a=n({x:r.left,y:r.top}),c=n({x:r.right,y:r.bottom});return{top:a.y,left:a.x,bottom:c.y,right:c.x}}function isIdentityScale(r){return r===void 0||r===1}function hasScale({scale:r,scaleX:n,scaleY:a}){return!isIdentityScale(r)||!isIdentityScale(n)||!isIdentityScale(a)}function hasTransform(r){return hasScale(r)||has2DTranslate(r)||r.z||r.rotate||r.rotateX||r.rotateY||r.skewX||r.skewY}function has2DTranslate(r){return is2DTranslate(r.x)||is2DTranslate(r.y)}function is2DTranslate(r){return r&&r!=="0%"}function scalePoint(r,n,a){const c=r-a,p=n*c;return a+p}function applyPointDelta(r,n,a,c,p){return p!==void 0&&(r=scalePoint(r,p,c)),scalePoint(r,a,c)+n}function applyAxisDelta(r,n=0,a=1,c,p){r.min=applyPointDelta(r.min,n,a,c,p),r.max=applyPointDelta(r.max,n,a,c,p)}function applyBoxDelta(r,{x:n,y:a}){applyAxisDelta(r.x,n.translate,n.scale,n.originPoint),applyAxisDelta(r.y,a.translate,a.scale,a.originPoint)}const TREE_SCALE_SNAP_MIN=.999999999999,TREE_SCALE_SNAP_MAX=1.0000000000001;function applyTreeDeltas(r,n,a,c=!1){const p=a.length;if(!p)return;n.x=n.y=1;let D,u;for(let v=0;v<p;v++){D=a[v],u=D.projectionDelta;const{visualElement:m}=D.options;m&&m.props.style&&m.props.style.display==="contents"||(c&&D.options.layoutScroll&&D.scroll&&D!==D.root&&transformBox(r,{x:-D.scroll.offset.x,y:-D.scroll.offset.y}),u&&(n.x*=u.x.scale,n.y*=u.y.scale,applyBoxDelta(r,u)),c&&hasTransform(D.latestValues)&&transformBox(r,D.latestValues))}n.x<TREE_SCALE_SNAP_MAX&&n.x>TREE_SCALE_SNAP_MIN&&(n.x=1),n.y<TREE_SCALE_SNAP_MAX&&n.y>TREE_SCALE_SNAP_MIN&&(n.y=1)}function translateAxis(r,n){r.min=r.min+n,r.max=r.max+n}function transformAxis(r,n,a,c,p=.5){const D=mixNumber$1(r.min,r.max,p);applyAxisDelta(r,n,a,D,c)}function transformBox(r,n){transformAxis(r.x,n.x,n.scaleX,n.scale,n.originX),transformAxis(r.y,n.y,n.scaleY,n.scale,n.originY)}function measureViewportBox(r,n){return convertBoundingBoxToBox(transformBoxPoints(r.getBoundingClientRect(),n))}function measurePageBox(r,n,a){const c=measureViewportBox(r,a),{scroll:p}=n;return p&&(translateAxis(c.x,p.offset.x),translateAxis(c.y,p.offset.y)),c}const createAxisDelta=()=>({translate:0,scale:1,origin:0,originPoint:0}),createDelta=()=>({x:createAxisDelta(),y:createAxisDelta()}),createAxis=()=>({min:0,max:0}),createBox=()=>({x:createAxis(),y:createAxis()}),prefersReducedMotion={current:null},hasReducedMotionListener={current:!1};function initPrefersReducedMotion(){if(hasReducedMotionListener.current=!0,!!isBrowser)if(window.matchMedia){const r=window.matchMedia("(prefers-reduced-motion)"),n=()=>prefersReducedMotion.current=r.matches;r.addEventListener("change",n),n()}else prefersReducedMotion.current=!1}const visualElementStore=new WeakMap;function updateMotionValuesFromProps(r,n,a){for(const c in n){const p=n[c],D=a[c];if(isMotionValue(p))r.addValue(c,p);else if(isMotionValue(D))r.addValue(c,motionValue(p,{owner:r}));else if(D!==p)if(r.hasValue(c)){const u=r.getValue(c);u.liveStyle===!0?u.jump(p):u.hasAnimated||u.set(p)}else{const u=r.getStaticValue(c);r.addValue(c,motionValue(u!==void 0?u:p,{owner:r}))}}for(const c in a)n[c]===void 0&&r.removeValue(c);return n}const propEventHandlers=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class VisualElement{scrapeMotionValuesFromProps(n,a,c){return{}}constructor({parent:n,props:a,presenceContext:c,reducedMotionConfig:p,blockInitialAnimation:D,visualState:u},v={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=KeyframeResolver,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const k=time.now();this.renderScheduledAt<k&&(this.renderScheduledAt=k,frame.render(this.render,!1,!0))};const{latestValues:m,renderState:_}=u;this.latestValues=m,this.baseTarget={...m},this.initialValues=a.initial?{...m}:{},this.renderState=_,this.parent=n,this.props=a,this.presenceContext=c,this.depth=n?n.depth+1:0,this.reducedMotionConfig=p,this.options=v,this.blockInitialAnimation=!!D,this.isControllingVariants=isControllingVariants(a),this.isVariantNode=isVariantNode(a),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(n&&n.current);const{willChange:C,...w}=this.scrapeMotionValuesFromProps(a,{},this);for(const k in w){const F=w[k];m[k]!==void 0&&isMotionValue(F)&&F.set(m[k])}}mount(n){this.current=n,visualElementStore.set(n,this),this.projection&&!this.projection.instance&&this.projection.mount(n),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((a,c)=>this.bindToMotionValue(c,a)),hasReducedMotionListener.current||initPrefersReducedMotion(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:prefersReducedMotion.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),cancelFrame(this.notifyUpdate),cancelFrame(this.render),this.valueSubscriptions.forEach(n=>n()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const n in this.events)this.events[n].clear();for(const n in this.features){const a=this.features[n];a&&(a.unmount(),a.isMounted=!1)}this.current=null}addChild(n){this.children.add(n),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(n)}removeChild(n){this.children.delete(n),this.enteringChildren&&this.enteringChildren.delete(n)}bindToMotionValue(n,a){this.valueSubscriptions.has(n)&&this.valueSubscriptions.get(n)();const c=transformProps.has(n);c&&this.onBindTransform&&this.onBindTransform();const p=a.on("change",u=>{this.latestValues[n]=u,this.props.onUpdate&&frame.preRender(this.notifyUpdate),c&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let D;window.MotionCheckAppearSync&&(D=window.MotionCheckAppearSync(this,n,a)),this.valueSubscriptions.set(n,()=>{p(),D&&D(),a.owner&&a.stop()})}sortNodePosition(n){return!this.current||!this.sortInstanceNodePosition||this.type!==n.type?0:this.sortInstanceNodePosition(this.current,n.current)}updateFeatures(){let n="animation";for(n in featureDefinitions){const a=featureDefinitions[n];if(!a)continue;const{isEnabled:c,Feature:p}=a;if(!this.features[n]&&p&&c(this.props)&&(this.features[n]=new p(this)),this.features[n]){const D=this.features[n];D.isMounted?D.update():(D.mount(),D.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):createBox()}getStaticValue(n){return this.latestValues[n]}setStaticValue(n,a){this.latestValues[n]=a}update(n,a){(n.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=n,this.prevPresenceContext=this.presenceContext,this.presenceContext=a;for(let c=0;c<propEventHandlers.length;c++){const p=propEventHandlers[c];this.propEventSubscriptions[p]&&(this.propEventSubscriptions[p](),delete this.propEventSubscriptions[p]);const D="on"+p,u=n[D];u&&(this.propEventSubscriptions[p]=this.on(p,u))}this.prevMotionValues=updateMotionValuesFromProps(this,this.scrapeMotionValuesFromProps(n,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(n){return this.props.variants?this.props.variants[n]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(n){const a=this.getClosestVariantNode();if(a)return a.variantChildren&&a.variantChildren.add(n),()=>a.variantChildren.delete(n)}addValue(n,a){const c=this.values.get(n);a!==c&&(c&&this.removeValue(n),this.bindToMotionValue(n,a),this.values.set(n,a),this.latestValues[n]=a.get())}removeValue(n){this.values.delete(n);const a=this.valueSubscriptions.get(n);a&&(a(),this.valueSubscriptions.delete(n)),delete this.latestValues[n],this.removeValueFromRenderState(n,this.renderState)}hasValue(n){return this.values.has(n)}getValue(n,a){if(this.props.values&&this.props.values[n])return this.props.values[n];let c=this.values.get(n);return c===void 0&&a!==void 0&&(c=motionValue(a===null?void 0:a,{owner:this}),this.addValue(n,c)),c}readValue(n,a){let c=this.latestValues[n]!==void 0||!this.current?this.latestValues[n]:this.getBaseTargetFromProps(this.props,n)??this.readValueFromInstance(this.current,n,this.options);return c!=null&&(typeof c=="string"&&(isNumericalString(c)||isZeroValueString(c))?c=parseFloat(c):!findValueType(c)&&complex.test(a)&&(c=getAnimatableNone(n,a)),this.setBaseTarget(n,isMotionValue(c)?c.get():c)),isMotionValue(c)?c.get():c}setBaseTarget(n,a){this.baseTarget[n]=a}getBaseTarget(n){const{initial:a}=this.props;let c;if(typeof a=="string"||typeof a=="object"){const D=resolveVariantFromProps(this.props,a,this.presenceContext?.custom);D&&(c=D[n])}if(a&&c!==void 0)return c;const p=this.getBaseTargetFromProps(this.props,n);return p!==void 0&&!isMotionValue(p)?p:this.initialValues[n]!==void 0&&c===void 0?void 0:this.baseTarget[n]}on(n,a){return this.events[n]||(this.events[n]=new SubscriptionManager),this.events[n].add(a)}notify(n,...a){this.events[n]&&this.events[n].notify(...a)}scheduleRenderMicrotask(){microtask.render(this.render)}}class DOMVisualElement extends VisualElement{constructor(){super(...arguments),this.KeyframeResolver=DOMKeyframesResolver}sortInstanceNodePosition(n,a){return n.compareDocumentPosition(a)&2?1:-1}getBaseTargetFromProps(n,a){return n.style?n.style[a]:void 0}removeValueFromRenderState(n,{vars:a,style:c}){delete a[n],delete c[n]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:n}=this.props;isMotionValue(n)&&(this.childSubscription=n.on("change",a=>{this.current&&(this.current.textContent=`${a}`)}))}}function renderHTML(r,{style:n,vars:a},c,p){const D=r.style;let u;for(u in n)D[u]=n[u];p?.applyProjectionStyles(D,c);for(u in a)D.setProperty(u,a[u])}function getComputedStyle$1(r){return window.getComputedStyle(r)}class HTMLVisualElement extends DOMVisualElement{constructor(){super(...arguments),this.type="html",this.renderInstance=renderHTML}readValueFromInstance(n,a){if(transformProps.has(a))return this.projection?.isProjecting?defaultTransformValue(a):readTransformValue(n,a);{const c=getComputedStyle$1(n),p=(isCSSVariableName(a)?c.getPropertyValue(a):c[a])||0;return typeof p=="string"?p.trim():p}}measureInstanceViewportBox(n,{transformPagePoint:a}){return measureViewportBox(n,a)}build(n,a,c){buildHTMLStyles(n,a,c.transformTemplate)}scrapeMotionValuesFromProps(n,a,c){return scrapeMotionValuesFromProps$1(n,a,c)}}const camelCaseAttributes=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function renderSVG(r,n,a,c){renderHTML(r,n,void 0,c);for(const p in n.attrs)r.setAttribute(camelCaseAttributes.has(p)?p:camelToDash(p),n.attrs[p])}class SVGVisualElement extends DOMVisualElement{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=createBox}getBaseTargetFromProps(n,a){return n[a]}readValueFromInstance(n,a){if(transformProps.has(a)){const c=getDefaultValueType(a);return c&&c.default||0}return a=camelCaseAttributes.has(a)?a:camelToDash(a),n.getAttribute(a)}scrapeMotionValuesFromProps(n,a,c){return scrapeMotionValuesFromProps(n,a,c)}build(n,a,c){buildSVGAttrs(n,a,this.isSVGTag,c.transformTemplate,c.style)}renderInstance(n,a,c,p){renderSVG(n,a,c,p)}mount(n){this.isSVGTag=isSVGTag(n.tagName),super.mount(n)}}const createDomVisualElement=(r,n)=>isSVGComponent(r)?new SVGVisualElement(n):new HTMLVisualElement(n,{allowProjection:r!==reactExports.Fragment});function resolveVariant(r,n,a){const c=r.getProps();return resolveVariantFromProps(c,n,a!==void 0?a:c.custom,r)}const isKeyframesTarget=r=>Array.isArray(r);function setMotionValue(r,n,a){r.hasValue(n)?r.getValue(n).set(a):r.addValue(n,motionValue(a))}function resolveFinalValueInKeyframes(r){return isKeyframesTarget(r)?r[r.length-1]||0:r}function setTarget(r,n){const a=resolveVariant(r,n);let{transitionEnd:c={},transition:p={},...D}=a||{};D={...D,...c};for(const u in D){const v=resolveFinalValueInKeyframes(D[u]);setMotionValue(r,u,v)}}function isWillChangeMotionValue(r){return!!(isMotionValue(r)&&r.add)}function addValueToWillChange(r,n){const a=r.getValue("willChange");if(isWillChangeMotionValue(a))return a.add(n);if(!a&&MotionGlobalConfig.WillChange){const c=new MotionGlobalConfig.WillChange("auto");r.addValue("willChange",c),c.add(n)}}function getOptimisedAppearId(r){return r.props[optimizedAppearDataAttribute]}const isNotNull=r=>r!==null;function getFinalKeyframe(r,{repeat:n,repeatType:a="loop"},c){const p=r.filter(isNotNull),D=n&&a!=="loop"&&n%2===1?0:p.length-1;return p[D]}const underDampedSpring={type:"spring",stiffness:500,damping:25,restSpeed:10},criticallyDampedSpring=r=>({type:"spring",stiffness:550,damping:r===0?2*Math.sqrt(550):30,restSpeed:10}),keyframesTransition={type:"keyframes",duration:.8},ease={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},getDefaultTransition=(r,{keyframes:n})=>n.length>2?keyframesTransition:transformProps.has(r)?r.startsWith("scale")?criticallyDampedSpring(n[1]):underDampedSpring:ease;function isTransitionDefined({when:r,delay:n,delayChildren:a,staggerChildren:c,staggerDirection:p,repeat:D,repeatType:u,repeatDelay:v,from:m,elapsed:_,...C}){return!!Object.keys(C).length}const animateMotionValue=(r,n,a,c={},p,D)=>u=>{const v=getValueTransition(c,r)||{},m=v.delay||c.delay||0;let{elapsed:_=0}=c;_=_-secondsToMilliseconds(m);const C={keyframes:Array.isArray(a)?a:[null,a],ease:"easeOut",velocity:n.getVelocity(),...v,delay:-_,onUpdate:k=>{n.set(k),v.onUpdate&&v.onUpdate(k)},onComplete:()=>{u(),v.onComplete&&v.onComplete()},name:r,motionValue:n,element:D?void 0:p};isTransitionDefined(v)||Object.assign(C,getDefaultTransition(r,C)),C.duration&&(C.duration=secondsToMilliseconds(C.duration)),C.repeatDelay&&(C.repeatDelay=secondsToMilliseconds(C.repeatDelay)),C.from!==void 0&&(C.keyframes[0]=C.from);let w=!1;if((C.type===!1||C.duration===0&&!C.repeatDelay)&&(makeAnimationInstant(C),C.delay===0&&(w=!0)),(MotionGlobalConfig.instantAnimations||MotionGlobalConfig.skipAnimations)&&(w=!0,makeAnimationInstant(C),C.delay=0),C.allowFlatten=!v.type&&!v.ease,w&&!D&&n.get()!==void 0){const k=getFinalKeyframe(C.keyframes,v);if(k!==void 0){frame.update(()=>{C.onUpdate(k),C.onComplete()});return}}return v.isSync?new JSAnimation(C):new AsyncMotionValueAnimation(C)};function shouldBlockAnimation({protectedKeys:r,needsAnimating:n},a){const c=r.hasOwnProperty(a)&&n[a]!==!0;return n[a]=!1,c}function animateTarget(r,n,{delay:a=0,transitionOverride:c,type:p}={}){let{transition:D=r.getDefaultTransition(),transitionEnd:u,...v}=n;c&&(D=c);const m=[],_=p&&r.animationState&&r.animationState.getState()[p];for(const C in v){const w=r.getValue(C,r.latestValues[C]??null),k=v[C];if(k===void 0||_&&shouldBlockAnimation(_,C))continue;const F={delay:a,...getValueTransition(D||{},C)},T=w.get();if(T!==void 0&&!w.isAnimating&&!Array.isArray(k)&&k===T&&!F.velocity)continue;let z=!1;if(window.MotionHandoffAnimation){const J=getOptimisedAppearId(r);if(J){const K=window.MotionHandoffAnimation(J,C,frame);K!==null&&(F.startTime=K,z=!0)}}addValueToWillChange(r,C),w.start(animateMotionValue(C,w,k,r.shouldReduceMotion&&positionalKeys.has(C)?{type:!1}:F,r,z));const Q=w.animation;Q&&m.push(Q)}return u&&Promise.all(m).then(()=>{frame.update(()=>{u&&setTarget(r,u)})}),m}function calcChildStagger(r,n,a,c=0,p=1){const D=Array.from(r).sort((_,C)=>_.sortNodePosition(C)).indexOf(n),u=r.size,v=(u-1)*c;return typeof a=="function"?a(D,u):p===1?D*c:v-D*c}function animateVariant(r,n,a={}){const c=resolveVariant(r,n,a.type==="exit"?r.presenceContext?.custom:void 0);let{transition:p=r.getDefaultTransition()||{}}=c||{};a.transitionOverride&&(p=a.transitionOverride);const D=c?()=>Promise.all(animateTarget(r,c,a)):()=>Promise.resolve(),u=r.variantChildren&&r.variantChildren.size?(m=0)=>{const{delayChildren:_=0,staggerChildren:C,staggerDirection:w}=p;return animateChildren(r,n,m,_,C,w,a)}:()=>Promise.resolve(),{when:v}=p;if(v){const[m,_]=v==="beforeChildren"?[D,u]:[u,D];return m().then(()=>_())}else return Promise.all([D(),u(a.delay)])}function animateChildren(r,n,a=0,c=0,p=0,D=1,u){const v=[];for(const m of r.variantChildren)m.notify("AnimationStart",n),v.push(animateVariant(m,n,{...u,delay:a+(typeof c=="function"?0:c)+calcChildStagger(r.variantChildren,m,c,p,D)}).then(()=>m.notify("AnimationComplete",n)));return Promise.all(v)}function animateVisualElement(r,n,a={}){r.notify("AnimationStart",n);let c;if(Array.isArray(n)){const p=n.map(D=>animateVariant(r,D,a));c=Promise.all(p)}else if(typeof n=="string")c=animateVariant(r,n,a);else{const p=typeof n=="function"?resolveVariant(r,n,a.custom):n;c=Promise.all(animateTarget(r,p,a))}return c.then(()=>{r.notify("AnimationComplete",n)})}function shallowCompare(r,n){if(!Array.isArray(n))return!1;const a=n.length;if(a!==r.length)return!1;for(let c=0;c<a;c++)if(n[c]!==r[c])return!1;return!0}const numVariantProps=variantProps.length;function getVariantContext(r){if(!r)return;if(!r.isControllingVariants){const a=r.parent?getVariantContext(r.parent)||{}:{};return r.props.initial!==void 0&&(a.initial=r.props.initial),a}const n={};for(let a=0;a<numVariantProps;a++){const c=variantProps[a],p=r.props[c];(isVariantLabel(p)||p===!1)&&(n[c]=p)}return n}const reversePriorityOrder=[...variantPriorityOrder].reverse(),numAnimationTypes=variantPriorityOrder.length;function animateList(r){return n=>Promise.all(n.map(({animation:a,options:c})=>animateVisualElement(r,a,c)))}function createAnimationState(r){let n=animateList(r),a=createState(),c=!0;const p=m=>(_,C)=>{const w=resolveVariant(r,C,m==="exit"?r.presenceContext?.custom:void 0);if(w){const{transition:k,transitionEnd:F,...T}=w;_={..._,...T,...F}}return _};function D(m){n=m(r)}function u(m){const{props:_}=r,C=getVariantContext(r.parent)||{},w=[],k=new Set;let F={},T=1/0;for(let Q=0;Q<numAnimationTypes;Q++){const J=reversePriorityOrder[Q],K=a[J],b=_[J]!==void 0?_[J]:C[J],N=isVariantLabel(b),V=J===m?K.isActive:null;V===!1&&(T=Q);let U=b===C[J]&&b!==_[J]&&N;if(U&&c&&r.manuallyAnimateOnMount&&(U=!1),K.protectedKeys={...F},!K.isActive&&V===null||!b&&!K.prevProp||isAnimationControls(b)||typeof b=="boolean")continue;const Z=checkVariantsDidChange(K.prevProp,b);let L=Z||J===m&&K.isActive&&!U&&N||Q>T&&N,ee=!1;const Ee=Array.isArray(b)?b:[b];let he=Ee.reduce(p(J),{});V===!1&&(he={});const{prevResolvedValues:ge={}}=K,me={...ge,...he},Me=ce=>{L=!0,k.has(ce)&&(ee=!0,k.delete(ce)),K.needsAnimating[ce]=!0;const se=r.getValue(ce);se&&(se.liveStyle=!1)};for(const ce in me){const se=he[ce],X=ge[ce];if(F.hasOwnProperty(ce))continue;let Re=!1;isKeyframesTarget(se)&&isKeyframesTarget(X)?Re=!shallowCompare(se,X):Re=se!==X,Re?se!=null?Me(ce):k.add(ce):se!==void 0&&k.has(ce)?Me(ce):K.protectedKeys[ce]=!0}K.prevProp=b,K.prevResolvedValues=he,K.isActive&&(F={...F,...he}),c&&r.blockInitialAnimation&&(L=!1);const ue=U&&Z;L&&(!ue||ee)&&w.push(...Ee.map(ce=>{const se={type:J};if(typeof ce=="string"&&c&&!ue&&r.manuallyAnimateOnMount&&r.parent){const{parent:X}=r,Re=resolveVariant(X,ce);if(X.enteringChildren&&Re){const{delayChildren:fe}=Re.transition||{};se.delay=calcChildStagger(X.enteringChildren,r,fe)}}return{animation:ce,options:se}}))}if(k.size){const Q={};if(typeof _.initial!="boolean"){const J=resolveVariant(r,Array.isArray(_.initial)?_.initial[0]:_.initial);J&&J.transition&&(Q.transition=J.transition)}k.forEach(J=>{const K=r.getBaseTarget(J),b=r.getValue(J);b&&(b.liveStyle=!0),Q[J]=K??null}),w.push({animation:Q})}let z=!!w.length;return c&&(_.initial===!1||_.initial===_.animate)&&!r.manuallyAnimateOnMount&&(z=!1),c=!1,z?n(w):Promise.resolve()}function v(m,_){if(a[m].isActive===_)return Promise.resolve();r.variantChildren?.forEach(w=>w.animationState?.setActive(m,_)),a[m].isActive=_;const C=u(m);for(const w in a)a[w].protectedKeys={};return C}return{animateChanges:u,setActive:v,setAnimateFunction:D,getState:()=>a,reset:()=>{a=createState()}}}function checkVariantsDidChange(r,n){return typeof n=="string"?n!==r:Array.isArray(n)?!shallowCompare(n,r):!1}function createTypeState(r=!1){return{isActive:r,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function createState(){return{animate:createTypeState(!0),whileInView:createTypeState(),whileHover:createTypeState(),whileTap:createTypeState(),whileDrag:createTypeState(),whileFocus:createTypeState(),exit:createTypeState()}}class Feature{constructor(n){this.isMounted=!1,this.node=n}update(){}}class AnimationFeature extends Feature{constructor(n){super(n),n.animationState||(n.animationState=createAnimationState(n))}updateAnimationControlsSubscription(){const{animate:n}=this.node.getProps();isAnimationControls(n)&&(this.unmountControls=n.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:n}=this.node.getProps(),{animate:a}=this.node.prevProps||{};n!==a&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let id$1=0;class ExitAnimationFeature extends Feature{constructor(){super(...arguments),this.id=id$1++}update(){if(!this.node.presenceContext)return;const{isPresent:n,onExitComplete:a}=this.node.presenceContext,{isPresent:c}=this.node.prevPresenceContext||{};if(!this.node.animationState||n===c)return;const p=this.node.animationState.setActive("exit",!n);a&&!n&&p.then(()=>{a(this.id)})}mount(){const{register:n,onExitComplete:a}=this.node.presenceContext||{};a&&a(this.id),n&&(this.unmount=n(this.id))}unmount(){}}const animations={animation:{Feature:AnimationFeature},exit:{Feature:ExitAnimationFeature}};function addDomEvent(r,n,a,c={passive:!0}){return r.addEventListener(n,a,c),()=>r.removeEventListener(n,a)}function extractEventInfo(r){return{point:{x:r.pageX,y:r.pageY}}}const addPointerInfo=r=>n=>isPrimaryPointer(n)&&r(n,extractEventInfo(n));function addPointerEvent(r,n,a,c){return addDomEvent(r,n,addPointerInfo(a),c)}const SCALE_PRECISION=1e-4,SCALE_MIN=1-SCALE_PRECISION,SCALE_MAX=1+SCALE_PRECISION,TRANSLATE_PRECISION=.01,TRANSLATE_MIN=0-TRANSLATE_PRECISION,TRANSLATE_MAX=0+TRANSLATE_PRECISION;function calcLength(r){return r.max-r.min}function isNear(r,n,a){return Math.abs(r-n)<=a}function calcAxisDelta(r,n,a,c=.5){r.origin=c,r.originPoint=mixNumber$1(n.min,n.max,r.origin),r.scale=calcLength(a)/calcLength(n),r.translate=mixNumber$1(a.min,a.max,r.origin)-r.originPoint,(r.scale>=SCALE_MIN&&r.scale<=SCALE_MAX||isNaN(r.scale))&&(r.scale=1),(r.translate>=TRANSLATE_MIN&&r.translate<=TRANSLATE_MAX||isNaN(r.translate))&&(r.translate=0)}function calcBoxDelta(r,n,a,c){calcAxisDelta(r.x,n.x,a.x,c?c.originX:void 0),calcAxisDelta(r.y,n.y,a.y,c?c.originY:void 0)}function calcRelativeAxis(r,n,a){r.min=a.min+n.min,r.max=r.min+calcLength(n)}function calcRelativeBox(r,n,a){calcRelativeAxis(r.x,n.x,a.x),calcRelativeAxis(r.y,n.y,a.y)}function calcRelativeAxisPosition(r,n,a){r.min=n.min-a.min,r.max=r.min+calcLength(n)}function calcRelativePosition(r,n,a){calcRelativeAxisPosition(r.x,n.x,a.x),calcRelativeAxisPosition(r.y,n.y,a.y)}function eachAxis(r){return[r("x"),r("y")]}const getContextWindow=({current:r})=>r?r.ownerDocument.defaultView:null,distance=(r,n)=>Math.abs(r-n);function distance2D(r,n){const a=distance(r.x,n.x),c=distance(r.y,n.y);return Math.sqrt(a**2+c**2)}class PanSession{constructor(n,a,{transformPagePoint:c,contextWindow:p=window,dragSnapToOrigin:D=!1,distanceThreshold:u=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const k=getPanInfo(this.lastMoveEventInfo,this.history),F=this.startEvent!==null,T=distance2D(k.offset,{x:0,y:0})>=this.distanceThreshold;if(!F&&!T)return;const{point:z}=k,{timestamp:Q}=frameData;this.history.push({...z,timestamp:Q});const{onStart:J,onMove:K}=this.handlers;F||(J&&J(this.lastMoveEvent,k),this.startEvent=this.lastMoveEvent),K&&K(this.lastMoveEvent,k)},this.handlePointerMove=(k,F)=>{this.lastMoveEvent=k,this.lastMoveEventInfo=transformPoint(F,this.transformPagePoint),frame.update(this.updatePoint,!0)},this.handlePointerUp=(k,F)=>{this.end();const{onEnd:T,onSessionEnd:z,resumeAnimation:Q}=this.handlers;if(this.dragSnapToOrigin&&Q&&Q(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const J=getPanInfo(k.type==="pointercancel"?this.lastMoveEventInfo:transformPoint(F,this.transformPagePoint),this.history);this.startEvent&&T&&T(k,J),z&&z(k,J)},!isPrimaryPointer(n))return;this.dragSnapToOrigin=D,this.handlers=a,this.transformPagePoint=c,this.distanceThreshold=u,this.contextWindow=p||window;const v=extractEventInfo(n),m=transformPoint(v,this.transformPagePoint),{point:_}=m,{timestamp:C}=frameData;this.history=[{..._,timestamp:C}];const{onSessionStart:w}=a;w&&w(n,getPanInfo(m,this.history)),this.removeListeners=pipe(addPointerEvent(this.contextWindow,"pointermove",this.handlePointerMove),addPointerEvent(this.contextWindow,"pointerup",this.handlePointerUp),addPointerEvent(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(n){this.handlers=n}end(){this.removeListeners&&this.removeListeners(),cancelFrame(this.updatePoint)}}function transformPoint(r,n){return n?{point:n(r.point)}:r}function subtractPoint(r,n){return{x:r.x-n.x,y:r.y-n.y}}function getPanInfo({point:r},n){return{point:r,delta:subtractPoint(r,lastDevicePoint(n)),offset:subtractPoint(r,startDevicePoint(n)),velocity:getVelocity(n,.1)}}function startDevicePoint(r){return r[0]}function lastDevicePoint(r){return r[r.length-1]}function getVelocity(r,n){if(r.length<2)return{x:0,y:0};let a=r.length-1,c=null;const p=lastDevicePoint(r);for(;a>=0&&(c=r[a],!(p.timestamp-c.timestamp>secondsToMilliseconds(n)));)a--;if(!c)return{x:0,y:0};const D=millisecondsToSeconds(p.timestamp-c.timestamp);if(D===0)return{x:0,y:0};const u={x:(p.x-c.x)/D,y:(p.y-c.y)/D};return u.x===1/0&&(u.x=0),u.y===1/0&&(u.y=0),u}function applyConstraints(r,{min:n,max:a},c){return n!==void 0&&r<n?r=c?mixNumber$1(n,r,c.min):Math.max(r,n):a!==void 0&&r>a&&(r=c?mixNumber$1(a,r,c.max):Math.min(r,a)),r}function calcRelativeAxisConstraints(r,n,a){return{min:n!==void 0?r.min+n:void 0,max:a!==void 0?r.max+a-(r.max-r.min):void 0}}function calcRelativeConstraints(r,{top:n,left:a,bottom:c,right:p}){return{x:calcRelativeAxisConstraints(r.x,a,p),y:calcRelativeAxisConstraints(r.y,n,c)}}function calcViewportAxisConstraints(r,n){let a=n.min-r.min,c=n.max-r.max;return n.max-n.min<r.max-r.min&&([a,c]=[c,a]),{min:a,max:c}}function calcViewportConstraints(r,n){return{x:calcViewportAxisConstraints(r.x,n.x),y:calcViewportAxisConstraints(r.y,n.y)}}function calcOrigin(r,n){let a=.5;const c=calcLength(r),p=calcLength(n);return p>c?a=progress(n.min,n.max-c,r.min):c>p&&(a=progress(r.min,r.max-p,n.min)),clamp(0,1,a)}function rebaseAxisConstraints(r,n){const a={};return n.min!==void 0&&(a.min=n.min-r.min),n.max!==void 0&&(a.max=n.max-r.min),a}const defaultElastic=.35;function resolveDragElastic(r=defaultElastic){return r===!1?r=0:r===!0&&(r=defaultElastic),{x:resolveAxisElastic(r,"left","right"),y:resolveAxisElastic(r,"top","bottom")}}function resolveAxisElastic(r,n,a){return{min:resolvePointElastic(r,n),max:resolvePointElastic(r,a)}}function resolvePointElastic(r,n){return typeof r=="number"?r:r[n]||0}const elementDragControls=new WeakMap;class VisualElementDragControls{constructor(n){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=createBox(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=n}start(n,{snapToCursor:a=!1,distanceThreshold:c}={}){const{presenceContext:p}=this.visualElement;if(p&&p.isPresent===!1)return;const D=w=>{const{dragSnapToOrigin:k}=this.getProps();k?this.pauseAnimation():this.stopAnimation(),a&&this.snapToCursor(extractEventInfo(w).point)},u=(w,k)=>{const{drag:F,dragPropagation:T,onDragStart:z}=this.getProps();if(F&&!T&&(this.openDragLock&&this.openDragLock(),this.openDragLock=setDragLock(F),!this.openDragLock))return;this.latestPointerEvent=w,this.latestPanInfo=k,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),eachAxis(J=>{let K=this.getAxisMotionValue(J).get()||0;if(percent.test(K)){const{projection:b}=this.visualElement;if(b&&b.layout){const N=b.layout.layoutBox[J];N&&(K=calcLength(N)*(parseFloat(K)/100))}}this.originPoint[J]=K}),z&&frame.postRender(()=>z(w,k)),addValueToWillChange(this.visualElement,"transform");const{animationState:Q}=this.visualElement;Q&&Q.setActive("whileDrag",!0)},v=(w,k)=>{this.latestPointerEvent=w,this.latestPanInfo=k;const{dragPropagation:F,dragDirectionLock:T,onDirectionLock:z,onDrag:Q}=this.getProps();if(!F&&!this.openDragLock)return;const{offset:J}=k;if(T&&this.currentDirection===null){this.currentDirection=getCurrentDirection(J),this.currentDirection!==null&&z&&z(this.currentDirection);return}this.updateAxis("x",k.point,J),this.updateAxis("y",k.point,J),this.visualElement.render(),Q&&Q(w,k)},m=(w,k)=>{this.latestPointerEvent=w,this.latestPanInfo=k,this.stop(w,k),this.latestPointerEvent=null,this.latestPanInfo=null},_=()=>eachAxis(w=>this.getAnimationState(w)==="paused"&&this.getAxisMotionValue(w).animation?.play()),{dragSnapToOrigin:C}=this.getProps();this.panSession=new PanSession(n,{onSessionStart:D,onStart:u,onMove:v,onSessionEnd:m,resumeAnimation:_},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:C,distanceThreshold:c,contextWindow:getContextWindow(this.visualElement)})}stop(n,a){const c=n||this.latestPointerEvent,p=a||this.latestPanInfo,D=this.isDragging;if(this.cancel(),!D||!p||!c)return;const{velocity:u}=p;this.startAnimation(u);const{onDragEnd:v}=this.getProps();v&&frame.postRender(()=>v(c,p))}cancel(){this.isDragging=!1;const{projection:n,animationState:a}=this.visualElement;n&&(n.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:c}=this.getProps();!c&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),a&&a.setActive("whileDrag",!1)}updateAxis(n,a,c){const{drag:p}=this.getProps();if(!c||!shouldDrag(n,p,this.currentDirection))return;const D=this.getAxisMotionValue(n);let u=this.originPoint[n]+c[n];this.constraints&&this.constraints[n]&&(u=applyConstraints(u,this.constraints[n],this.elastic[n])),D.set(u)}resolveConstraints(){const{dragConstraints:n,dragElastic:a}=this.getProps(),c=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,p=this.constraints;n&&isRefObject(n)?this.constraints||(this.constraints=this.resolveRefConstraints()):n&&c?this.constraints=calcRelativeConstraints(c.layoutBox,n):this.constraints=!1,this.elastic=resolveDragElastic(a),p!==this.constraints&&c&&this.constraints&&!this.hasMutatedConstraints&&eachAxis(D=>{this.constraints!==!1&&this.getAxisMotionValue(D)&&(this.constraints[D]=rebaseAxisConstraints(c.layoutBox[D],this.constraints[D]))})}resolveRefConstraints(){const{dragConstraints:n,onMeasureDragConstraints:a}=this.getProps();if(!n||!isRefObject(n))return!1;const c=n.current,{projection:p}=this.visualElement;if(!p||!p.layout)return!1;const D=measurePageBox(c,p.root,this.visualElement.getTransformPagePoint());let u=calcViewportConstraints(p.layout.layoutBox,D);if(a){const v=a(convertBoxToBoundingBox(u));this.hasMutatedConstraints=!!v,v&&(u=convertBoundingBoxToBox(v))}return u}startAnimation(n){const{drag:a,dragMomentum:c,dragElastic:p,dragTransition:D,dragSnapToOrigin:u,onDragTransitionEnd:v}=this.getProps(),m=this.constraints||{},_=eachAxis(C=>{if(!shouldDrag(C,a,this.currentDirection))return;let w=m&&m[C]||{};u&&(w={min:0,max:0});const k=p?200:1e6,F=p?40:1e7,T={type:"inertia",velocity:c?n[C]:0,bounceStiffness:k,bounceDamping:F,timeConstant:750,restDelta:1,restSpeed:10,...D,...w};return this.startAxisValueAnimation(C,T)});return Promise.all(_).then(v)}startAxisValueAnimation(n,a){const c=this.getAxisMotionValue(n);return addValueToWillChange(this.visualElement,n),c.start(animateMotionValue(n,c,0,a,this.visualElement,!1))}stopAnimation(){eachAxis(n=>this.getAxisMotionValue(n).stop())}pauseAnimation(){eachAxis(n=>this.getAxisMotionValue(n).animation?.pause())}getAnimationState(n){return this.getAxisMotionValue(n).animation?.state}getAxisMotionValue(n){const a=`_drag${n.toUpperCase()}`,c=this.visualElement.getProps(),p=c[a];return p||this.visualElement.getValue(n,(c.initial?c.initial[n]:void 0)||0)}snapToCursor(n){eachAxis(a=>{const{drag:c}=this.getProps();if(!shouldDrag(a,c,this.currentDirection))return;const{projection:p}=this.visualElement,D=this.getAxisMotionValue(a);if(p&&p.layout){const{min:u,max:v}=p.layout.layoutBox[a];D.set(n[a]-mixNumber$1(u,v,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:n,dragConstraints:a}=this.getProps(),{projection:c}=this.visualElement;if(!isRefObject(a)||!c||!this.constraints)return;this.stopAnimation();const p={x:0,y:0};eachAxis(u=>{const v=this.getAxisMotionValue(u);if(v&&this.constraints!==!1){const m=v.get();p[u]=calcOrigin({min:m,max:m},this.constraints[u])}});const{transformTemplate:D}=this.visualElement.getProps();this.visualElement.current.style.transform=D?D({},""):"none",c.root&&c.root.updateScroll(),c.updateLayout(),this.resolveConstraints(),eachAxis(u=>{if(!shouldDrag(u,n,null))return;const v=this.getAxisMotionValue(u),{min:m,max:_}=this.constraints[u];v.set(mixNumber$1(m,_,p[u]))})}addListeners(){if(!this.visualElement.current)return;elementDragControls.set(this.visualElement,this);const n=this.visualElement.current,a=addPointerEvent(n,"pointerdown",m=>{const{drag:_,dragListener:C=!0}=this.getProps();_&&C&&this.start(m)}),c=()=>{const{dragConstraints:m}=this.getProps();isRefObject(m)&&m.current&&(this.constraints=this.resolveRefConstraints())},{projection:p}=this.visualElement,D=p.addEventListener("measure",c);p&&!p.layout&&(p.root&&p.root.updateScroll(),p.updateLayout()),frame.read(c);const u=addDomEvent(window,"resize",()=>this.scalePositionWithinConstraints()),v=p.addEventListener("didUpdate",(({delta:m,hasLayoutChanged:_})=>{this.isDragging&&_&&(eachAxis(C=>{const w=this.getAxisMotionValue(C);w&&(this.originPoint[C]+=m[C].translate,w.set(w.get()+m[C].translate))}),this.visualElement.render())}));return()=>{u(),a(),D(),v&&v()}}getProps(){const n=this.visualElement.getProps(),{drag:a=!1,dragDirectionLock:c=!1,dragPropagation:p=!1,dragConstraints:D=!1,dragElastic:u=defaultElastic,dragMomentum:v=!0}=n;return{...n,drag:a,dragDirectionLock:c,dragPropagation:p,dragConstraints:D,dragElastic:u,dragMomentum:v}}}function shouldDrag(r,n,a){return(n===!0||n===r)&&(a===null||a===r)}function getCurrentDirection(r,n=10){let a=null;return Math.abs(r.y)>n?a="y":Math.abs(r.x)>n&&(a="x"),a}class DragGesture extends Feature{constructor(n){super(n),this.removeGroupControls=noop,this.removeListeners=noop,this.controls=new VisualElementDragControls(n)}mount(){const{dragControls:n}=this.node.getProps();n&&(this.removeGroupControls=n.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||noop}unmount(){this.removeGroupControls(),this.removeListeners()}}const asyncHandler=r=>(n,a)=>{r&&frame.postRender(()=>r(n,a))};class PanGesture extends Feature{constructor(){super(...arguments),this.removePointerDownListener=noop}onPointerDown(n){this.session=new PanSession(n,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:getContextWindow(this.node)})}createPanHandlers(){const{onPanSessionStart:n,onPanStart:a,onPan:c,onPanEnd:p}=this.node.getProps();return{onSessionStart:asyncHandler(n),onStart:asyncHandler(a),onMove:c,onEnd:(D,u)=>{delete this.session,p&&frame.postRender(()=>p(D,u))}}}mount(){this.removePointerDownListener=addPointerEvent(this.node.current,"pointerdown",n=>this.onPointerDown(n))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const globalProjectionState={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function pixelsToPercent(r,n){return n.max===n.min?0:r/(n.max-n.min)*100}const correctBorderRadius={correct:(r,n)=>{if(!n.target)return r;if(typeof r=="string")if(px.test(r))r=parseFloat(r);else return r;const a=pixelsToPercent(r,n.target.x),c=pixelsToPercent(r,n.target.y);return`${a}% ${c}%`}},correctBoxShadow={correct:(r,{treeScale:n,projectionDelta:a})=>{const c=r,p=complex.parse(r);if(p.length>5)return c;const D=complex.createTransformer(r),u=typeof p[0]!="number"?1:0,v=a.x.scale*n.x,m=a.y.scale*n.y;p[0+u]/=v,p[1+u]/=m;const _=mixNumber$1(v,m,.5);return typeof p[2+u]=="number"&&(p[2+u]/=_),typeof p[3+u]=="number"&&(p[3+u]/=_),D(p)}};let hasTakenAnySnapshot=!1;class MeasureLayoutWithContext extends reactExports.Component{componentDidMount(){const{visualElement:n,layoutGroup:a,switchLayoutGroup:c,layoutId:p}=this.props,{projection:D}=n;addScaleCorrector(defaultScaleCorrectors),D&&(a.group&&a.group.add(D),c&&c.register&&p&&c.register(D),hasTakenAnySnapshot&&D.root.didUpdate(),D.addEventListener("animationComplete",()=>{this.safeToRemove()}),D.setOptions({...D.options,onExitComplete:()=>this.safeToRemove()})),globalProjectionState.hasEverUpdated=!0}getSnapshotBeforeUpdate(n){const{layoutDependency:a,visualElement:c,drag:p,isPresent:D}=this.props,{projection:u}=c;return u&&(u.isPresent=D,hasTakenAnySnapshot=!0,p||n.layoutDependency!==a||a===void 0||n.isPresent!==D?u.willUpdate():this.safeToRemove(),n.isPresent!==D&&(D?u.promote():u.relegate()||frame.postRender(()=>{const v=u.getStack();(!v||!v.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:n}=this.props.visualElement;n&&(n.root.didUpdate(),microtask.postRender(()=>{!n.currentAnimation&&n.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:n,layoutGroup:a,switchLayoutGroup:c}=this.props,{projection:p}=n;hasTakenAnySnapshot=!0,p&&(p.scheduleCheckAfterUnmount(),a&&a.group&&a.group.remove(p),c&&c.deregister&&c.deregister(p))}safeToRemove(){const{safeToRemove:n}=this.props;n&&n()}render(){return null}}function MeasureLayout(r){const[n,a]=usePresence(),c=reactExports.useContext(LayoutGroupContext);return jsxRuntimeExports.jsx(MeasureLayoutWithContext,{...r,layoutGroup:c,switchLayoutGroup:reactExports.useContext(SwitchLayoutGroupContext),isPresent:n,safeToRemove:a})}const defaultScaleCorrectors={borderRadius:{...correctBorderRadius,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:correctBorderRadius,borderTopRightRadius:correctBorderRadius,borderBottomLeftRadius:correctBorderRadius,borderBottomRightRadius:correctBorderRadius,boxShadow:correctBoxShadow};function animateSingleValue(r,n,a){const c=isMotionValue(r)?r:motionValue(r);return c.start(animateMotionValue("",c,n,a)),c.animation}const compareByDepth=(r,n)=>r.depth-n.depth;class FlatTree{constructor(){this.children=[],this.isDirty=!1}add(n){addUniqueItem(this.children,n),this.isDirty=!0}remove(n){removeItem(this.children,n),this.isDirty=!0}forEach(n){this.isDirty&&this.children.sort(compareByDepth),this.isDirty=!1,this.children.forEach(n)}}function delay(r,n){const a=time.now(),c=({timestamp:p})=>{const D=p-a;D>=n&&(cancelFrame(c),r(D-n))};return frame.setup(c,!0),()=>cancelFrame(c)}const borders=["TopLeft","TopRight","BottomLeft","BottomRight"],numBorders=borders.length,asNumber=r=>typeof r=="string"?parseFloat(r):r,isPx=r=>typeof r=="number"||px.test(r);function mixValues(r,n,a,c,p,D){p?(r.opacity=mixNumber$1(0,a.opacity??1,easeCrossfadeIn(c)),r.opacityExit=mixNumber$1(n.opacity??1,0,easeCrossfadeOut(c))):D&&(r.opacity=mixNumber$1(n.opacity??1,a.opacity??1,c));for(let u=0;u<numBorders;u++){const v=`border${borders[u]}Radius`;let m=getRadius(n,v),_=getRadius(a,v);if(m===void 0&&_===void 0)continue;m||(m=0),_||(_=0),m===0||_===0||isPx(m)===isPx(_)?(r[v]=Math.max(mixNumber$1(asNumber(m),asNumber(_),c),0),(percent.test(_)||percent.test(m))&&(r[v]+="%")):r[v]=_}(n.rotate||a.rotate)&&(r.rotate=mixNumber$1(n.rotate||0,a.rotate||0,c))}function getRadius(r,n){return r[n]!==void 0?r[n]:r.borderRadius}const easeCrossfadeIn=compress(0,.5,circOut),easeCrossfadeOut=compress(.5,.95,noop);function compress(r,n,a){return c=>c<r?0:c>n?1:a(progress(r,n,c))}function copyAxisInto(r,n){r.min=n.min,r.max=n.max}function copyBoxInto(r,n){copyAxisInto(r.x,n.x),copyAxisInto(r.y,n.y)}function copyAxisDeltaInto(r,n){r.translate=n.translate,r.scale=n.scale,r.originPoint=n.originPoint,r.origin=n.origin}function removePointDelta(r,n,a,c,p){return r-=n,r=scalePoint(r,1/a,c),p!==void 0&&(r=scalePoint(r,1/p,c)),r}function removeAxisDelta(r,n=0,a=1,c=.5,p,D=r,u=r){if(percent.test(n)&&(n=parseFloat(n),n=mixNumber$1(u.min,u.max,n/100)-u.min),typeof n!="number")return;let v=mixNumber$1(D.min,D.max,c);r===D&&(v-=n),r.min=removePointDelta(r.min,n,a,v,p),r.max=removePointDelta(r.max,n,a,v,p)}function removeAxisTransforms(r,n,[a,c,p],D,u){removeAxisDelta(r,n[a],n[c],n[p],n.scale,D,u)}const xKeys=["x","scaleX","originX"],yKeys=["y","scaleY","originY"];function removeBoxTransforms(r,n,a,c){removeAxisTransforms(r.x,n,xKeys,a?a.x:void 0,c?c.x:void 0),removeAxisTransforms(r.y,n,yKeys,a?a.y:void 0,c?c.y:void 0)}function isAxisDeltaZero(r){return r.translate===0&&r.scale===1}function isDeltaZero(r){return isAxisDeltaZero(r.x)&&isAxisDeltaZero(r.y)}function axisEquals(r,n){return r.min===n.min&&r.max===n.max}function boxEquals(r,n){return axisEquals(r.x,n.x)&&axisEquals(r.y,n.y)}function axisEqualsRounded(r,n){return Math.round(r.min)===Math.round(n.min)&&Math.round(r.max)===Math.round(n.max)}function boxEqualsRounded(r,n){return axisEqualsRounded(r.x,n.x)&&axisEqualsRounded(r.y,n.y)}function aspectRatio(r){return calcLength(r.x)/calcLength(r.y)}function axisDeltaEquals(r,n){return r.translate===n.translate&&r.scale===n.scale&&r.originPoint===n.originPoint}class NodeStack{constructor(){this.members=[]}add(n){addUniqueItem(this.members,n),n.scheduleRender()}remove(n){if(removeItem(this.members,n),n===this.prevLead&&(this.prevLead=void 0),n===this.lead){const a=this.members[this.members.length-1];a&&this.promote(a)}}relegate(n){const a=this.members.findIndex(p=>n===p);if(a===0)return!1;let c;for(let p=a;p>=0;p--){const D=this.members[p];if(D.isPresent!==!1){c=D;break}}return c?(this.promote(c),!0):!1}promote(n,a){const c=this.lead;if(n!==c&&(this.prevLead=c,this.lead=n,n.show(),c)){c.instance&&c.scheduleRender(),n.scheduleRender(),n.resumeFrom=c,a&&(n.resumeFrom.preserveOpacity=!0),c.snapshot&&(n.snapshot=c.snapshot,n.snapshot.latestValues=c.animationValues||c.latestValues),n.root&&n.root.isUpdating&&(n.isLayoutDirty=!0);const{crossfade:p}=n.options;p===!1&&c.hide()}}exitAnimationComplete(){this.members.forEach(n=>{const{options:a,resumingFrom:c}=n;a.onExitComplete&&a.onExitComplete(),c&&c.options.onExitComplete&&c.options.onExitComplete()})}scheduleRender(){this.members.forEach(n=>{n.instance&&n.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function buildProjectionTransform(r,n,a){let c="";const p=r.x.translate/n.x,D=r.y.translate/n.y,u=a?.z||0;if((p||D||u)&&(c=`translate3d(${p}px, ${D}px, ${u}px) `),(n.x!==1||n.y!==1)&&(c+=`scale(${1/n.x}, ${1/n.y}) `),a){const{transformPerspective:_,rotate:C,rotateX:w,rotateY:k,skewX:F,skewY:T}=a;_&&(c=`perspective(${_}px) ${c}`),C&&(c+=`rotate(${C}deg) `),w&&(c+=`rotateX(${w}deg) `),k&&(c+=`rotateY(${k}deg) `),F&&(c+=`skewX(${F}deg) `),T&&(c+=`skewY(${T}deg) `)}const v=r.x.scale*n.x,m=r.y.scale*n.y;return(v!==1||m!==1)&&(c+=`scale(${v}, ${m})`),c||"none"}const transformAxes=["","X","Y","Z"],animationTarget=1e3;let id=0;function resetDistortingTransform(r,n,a,c){const{latestValues:p}=n;p[r]&&(a[r]=p[r],n.setStaticValue(r,0),c&&(c[r]=0))}function cancelTreeOptimisedTransformAnimations(r){if(r.hasCheckedOptimisedAppear=!0,r.root===r)return;const{visualElement:n}=r.options;if(!n)return;const a=getOptimisedAppearId(n);if(window.MotionHasOptimisedAnimation(a,"transform")){const{layout:p,layoutId:D}=r.options;window.MotionCancelOptimisedAnimation(a,"transform",frame,!(p||D))}const{parent:c}=r;c&&!c.hasCheckedOptimisedAppear&&cancelTreeOptimisedTransformAnimations(c)}function createProjectionNode({attachResizeListener:r,defaultParent:n,measureScroll:a,checkIsScrollRoot:c,resetTransform:p}){return class{constructor(u={},v=n?.()){this.id=id++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(propagateDirtyNodes),this.nodes.forEach(resolveTargetDelta),this.nodes.forEach(calcProjection),this.nodes.forEach(cleanDirtyNodes)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=u,this.root=v?v.root||v:this,this.path=v?[...v.path,v]:[],this.parent=v,this.depth=v?v.depth+1:0;for(let m=0;m<this.path.length;m++)this.path[m].shouldResetTransform=!0;this.root===this&&(this.nodes=new FlatTree)}addEventListener(u,v){return this.eventHandlers.has(u)||this.eventHandlers.set(u,new SubscriptionManager),this.eventHandlers.get(u).add(v)}notifyListeners(u,...v){const m=this.eventHandlers.get(u);m&&m.notify(...v)}hasListeners(u){return this.eventHandlers.has(u)}mount(u){if(this.instance)return;this.isSVG=isSVGElement(u)&&!isSVGSVGElement(u),this.instance=u;const{layoutId:v,layout:m,visualElement:_}=this.options;if(_&&!_.current&&_.mount(u),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(m||v)&&(this.isLayoutDirty=!0),r){let C,w=0;const k=()=>this.root.updateBlockedByResize=!1;frame.read(()=>{w=window.innerWidth}),r(u,()=>{const F=window.innerWidth;F!==w&&(w=F,this.root.updateBlockedByResize=!0,C&&C(),C=delay(k,250),globalProjectionState.hasAnimatedSinceResize&&(globalProjectionState.hasAnimatedSinceResize=!1,this.nodes.forEach(finishAnimation)))})}v&&this.root.registerSharedNode(v,this),this.options.animate!==!1&&_&&(v||m)&&this.addEventListener("didUpdate",({delta:C,hasLayoutChanged:w,hasRelativeLayoutChanged:k,layout:F})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const T=this.options.transition||_.getDefaultTransition()||defaultLayoutTransition,{onLayoutAnimationStart:z,onLayoutAnimationComplete:Q}=_.getProps(),J=!this.targetLayout||!boxEqualsRounded(this.targetLayout,F),K=!w&&k;if(this.options.layoutRoot||this.resumeFrom||K||w&&(J||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const b={...getValueTransition(T,"layout"),onPlay:z,onComplete:Q};(_.shouldReduceMotion||this.options.layoutRoot)&&(b.delay=0,b.type=!1),this.startAnimation(b),this.setAnimationOrigin(C,K)}else w||finishAnimation(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=F})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const u=this.getStack();u&&u.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),cancelFrame(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(resetSkewAndRotation),this.animationId++)}getTransformTemplate(){const{visualElement:u}=this.options;return u&&u.getProps().transformTemplate}willUpdate(u=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&cancelTreeOptimisedTransformAnimations(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let C=0;C<this.path.length;C++){const w=this.path[C];w.shouldResetTransform=!0,w.updateScroll("snapshot"),w.options.layoutRoot&&w.willUpdate(!1)}const{layoutId:v,layout:m}=this.options;if(v===void 0&&!m)return;const _=this.getTransformTemplate();this.prevTransformTemplateValue=_?_(this.latestValues,""):void 0,this.updateSnapshot(),u&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(clearMeasurements);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(clearIsLayoutDirty);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(resetTransformStyle),this.nodes.forEach(updateLayout),this.nodes.forEach(notifyLayoutUpdate)):this.nodes.forEach(clearIsLayoutDirty),this.clearAllSnapshots();const v=time.now();frameData.delta=clamp(0,1e3/60,v-frameData.timestamp),frameData.timestamp=v,frameData.isProcessing=!0,frameSteps.update.process(frameData),frameSteps.preRender.process(frameData),frameSteps.render.process(frameData),frameData.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,microtask.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(clearSnapshot),this.sharedNodes.forEach(removeLeadSnapshots)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,frame.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){frame.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!calcLength(this.snapshot.measuredBox.x)&&!calcLength(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let m=0;m<this.path.length;m++)this.path[m].updateScroll();const u=this.layout;this.layout=this.measure(!1),this.layoutCorrected=createBox(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:v}=this.options;v&&v.notify("LayoutMeasure",this.layout.layoutBox,u?u.layoutBox:void 0)}updateScroll(u="measure"){let v=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===u&&(v=!1),v&&this.instance){const m=c(this.instance);this.scroll={animationId:this.root.animationId,phase:u,isRoot:m,offset:a(this.instance),wasRoot:this.scroll?this.scroll.isRoot:m}}}resetTransform(){if(!p)return;const u=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,v=this.projectionDelta&&!isDeltaZero(this.projectionDelta),m=this.getTransformTemplate(),_=m?m(this.latestValues,""):void 0,C=_!==this.prevTransformTemplateValue;u&&this.instance&&(v||hasTransform(this.latestValues)||C)&&(p(this.instance,_),this.shouldResetTransform=!1,this.scheduleRender())}measure(u=!0){const v=this.measurePageBox();let m=this.removeElementScroll(v);return u&&(m=this.removeTransform(m)),roundBox(m),{animationId:this.root.animationId,measuredBox:v,layoutBox:m,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:u}=this.options;if(!u)return createBox();const v=u.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(checkNodeWasScrollRoot))){const{scroll:_}=this.root;_&&(translateAxis(v.x,_.offset.x),translateAxis(v.y,_.offset.y))}return v}removeElementScroll(u){const v=createBox();if(copyBoxInto(v,u),this.scroll?.wasRoot)return v;for(let m=0;m<this.path.length;m++){const _=this.path[m],{scroll:C,options:w}=_;_!==this.root&&C&&w.layoutScroll&&(C.wasRoot&&copyBoxInto(v,u),translateAxis(v.x,C.offset.x),translateAxis(v.y,C.offset.y))}return v}applyTransform(u,v=!1){const m=createBox();copyBoxInto(m,u);for(let _=0;_<this.path.length;_++){const C=this.path[_];!v&&C.options.layoutScroll&&C.scroll&&C!==C.root&&transformBox(m,{x:-C.scroll.offset.x,y:-C.scroll.offset.y}),hasTransform(C.latestValues)&&transformBox(m,C.latestValues)}return hasTransform(this.latestValues)&&transformBox(m,this.latestValues),m}removeTransform(u){const v=createBox();copyBoxInto(v,u);for(let m=0;m<this.path.length;m++){const _=this.path[m];if(!_.instance||!hasTransform(_.latestValues))continue;hasScale(_.latestValues)&&_.updateSnapshot();const C=createBox(),w=_.measurePageBox();copyBoxInto(C,w),removeBoxTransforms(v,_.latestValues,_.snapshot?_.snapshot.layoutBox:void 0,C)}return hasTransform(this.latestValues)&&removeBoxTransforms(v,this.latestValues),v}setTargetDelta(u){this.targetDelta=u,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(u){this.options={...this.options,...u,crossfade:u.crossfade!==void 0?u.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==frameData.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(u=!1){const v=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=v.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=v.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=v.isSharedProjectionDirty);const m=!!this.resumingFrom||this!==v;if(!(u||m&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:C,layoutId:w}=this.options;if(!(!this.layout||!(C||w))){if(this.resolvedRelativeTargetAt=frameData.timestamp,!this.targetDelta&&!this.relativeTarget){const k=this.getClosestProjectingParent();k&&k.layout&&this.animationProgress!==1?(this.relativeParent=k,this.forceRelativeParentToResolveTarget(),this.relativeTarget=createBox(),this.relativeTargetOrigin=createBox(),calcRelativePosition(this.relativeTargetOrigin,this.layout.layoutBox,k.layout.layoutBox),copyBoxInto(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=createBox(),this.targetWithTransforms=createBox()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),calcRelativeBox(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):copyBoxInto(this.target,this.layout.layoutBox),applyBoxDelta(this.target,this.targetDelta)):copyBoxInto(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const k=this.getClosestProjectingParent();k&&!!k.resumingFrom==!!this.resumingFrom&&!k.options.layoutScroll&&k.target&&this.animationProgress!==1?(this.relativeParent=k,this.forceRelativeParentToResolveTarget(),this.relativeTarget=createBox(),this.relativeTargetOrigin=createBox(),calcRelativePosition(this.relativeTargetOrigin,this.target,k.target),copyBoxInto(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||hasScale(this.parent.latestValues)||has2DTranslate(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){const u=this.getLead(),v=!!this.resumingFrom||this!==u;let m=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(m=!1),v&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(m=!1),this.resolvedRelativeTargetAt===frameData.timestamp&&(m=!1),m)return;const{layout:_,layoutId:C}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(_||C))return;copyBoxInto(this.layoutCorrected,this.layout.layoutBox);const w=this.treeScale.x,k=this.treeScale.y;applyTreeDeltas(this.layoutCorrected,this.treeScale,this.path,v),u.layout&&!u.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(u.target=u.layout.layoutBox,u.targetWithTransforms=createBox());const{target:F}=u;if(!F){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(copyAxisDeltaInto(this.prevProjectionDelta.x,this.projectionDelta.x),copyAxisDeltaInto(this.prevProjectionDelta.y,this.projectionDelta.y)),calcBoxDelta(this.projectionDelta,this.layoutCorrected,F,this.latestValues),(this.treeScale.x!==w||this.treeScale.y!==k||!axisDeltaEquals(this.projectionDelta.x,this.prevProjectionDelta.x)||!axisDeltaEquals(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",F))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(u=!0){if(this.options.visualElement?.scheduleRender(),u){const v=this.getStack();v&&v.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=createDelta(),this.projectionDelta=createDelta(),this.projectionDeltaWithTransform=createDelta()}setAnimationOrigin(u,v=!1){const m=this.snapshot,_=m?m.latestValues:{},C={...this.latestValues},w=createDelta();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!v;const k=createBox(),F=m?m.source:void 0,T=this.layout?this.layout.source:void 0,z=F!==T,Q=this.getStack(),J=!Q||Q.members.length<=1,K=!!(z&&!J&&this.options.crossfade===!0&&!this.path.some(hasOpacityCrossfade));this.animationProgress=0;let b;this.mixTargetDelta=N=>{const V=N/1e3;mixAxisDelta(w.x,u.x,V),mixAxisDelta(w.y,u.y,V),this.setTargetDelta(w),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(calcRelativePosition(k,this.layout.layoutBox,this.relativeParent.layout.layoutBox),mixBox(this.relativeTarget,this.relativeTargetOrigin,k,V),b&&boxEquals(this.relativeTarget,b)&&(this.isProjectionDirty=!1),b||(b=createBox()),copyBoxInto(b,this.relativeTarget)),z&&(this.animationValues=C,mixValues(C,_,this.latestValues,V,K,J)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=V},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(u){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(cancelFrame(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=frame.update(()=>{globalProjectionState.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=motionValue(0)),this.currentAnimation=animateSingleValue(this.motionValue,[0,1e3],{...u,velocity:0,isSync:!0,onUpdate:v=>{this.mixTargetDelta(v),u.onUpdate&&u.onUpdate(v)},onStop:()=>{},onComplete:()=>{u.onComplete&&u.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const u=this.getStack();u&&u.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(animationTarget),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const u=this.getLead();let{targetWithTransforms:v,target:m,layout:_,latestValues:C}=u;if(!(!v||!m||!_)){if(this!==u&&this.layout&&_&&shouldAnimatePositionOnly(this.options.animationType,this.layout.layoutBox,_.layoutBox)){m=this.target||createBox();const w=calcLength(this.layout.layoutBox.x);m.x.min=u.target.x.min,m.x.max=m.x.min+w;const k=calcLength(this.layout.layoutBox.y);m.y.min=u.target.y.min,m.y.max=m.y.min+k}copyBoxInto(v,m),transformBox(v,C),calcBoxDelta(this.projectionDeltaWithTransform,this.layoutCorrected,v,C)}}registerSharedNode(u,v){this.sharedNodes.has(u)||this.sharedNodes.set(u,new NodeStack),this.sharedNodes.get(u).add(v);const _=v.options.initialPromotionConfig;v.promote({transition:_?_.transition:void 0,preserveFollowOpacity:_&&_.shouldPreserveFollowOpacity?_.shouldPreserveFollowOpacity(v):void 0})}isLead(){const u=this.getStack();return u?u.lead===this:!0}getLead(){const{layoutId:u}=this.options;return u?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:u}=this.options;return u?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:u}=this.options;if(u)return this.root.sharedNodes.get(u)}promote({needsReset:u,transition:v,preserveFollowOpacity:m}={}){const _=this.getStack();_&&_.promote(this,m),u&&(this.projectionDelta=void 0,this.needsReset=!0),v&&this.setOptions({transition:v})}relegate(){const u=this.getStack();return u?u.relegate(this):!1}resetSkewAndRotation(){const{visualElement:u}=this.options;if(!u)return;let v=!1;const{latestValues:m}=u;if((m.z||m.rotate||m.rotateX||m.rotateY||m.rotateZ||m.skewX||m.skewY)&&(v=!0),!v)return;const _={};m.z&&resetDistortingTransform("z",u,_,this.animationValues);for(let C=0;C<transformAxes.length;C++)resetDistortingTransform(`rotate${transformAxes[C]}`,u,_,this.animationValues),resetDistortingTransform(`skew${transformAxes[C]}`,u,_,this.animationValues);u.render();for(const C in _)u.setStaticValue(C,_[C]),this.animationValues&&(this.animationValues[C]=_[C]);u.scheduleRender()}applyProjectionStyles(u,v){if(!this.instance||this.isSVG)return;if(!this.isVisible){u.visibility="hidden";return}const m=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,u.visibility="",u.opacity="",u.pointerEvents=resolveMotionValue(v?.pointerEvents)||"",u.transform=m?m(this.latestValues,""):"none";return}const _=this.getLead();if(!this.projectionDelta||!this.layout||!_.target){this.options.layoutId&&(u.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,u.pointerEvents=resolveMotionValue(v?.pointerEvents)||""),this.hasProjected&&!hasTransform(this.latestValues)&&(u.transform=m?m({},""):"none",this.hasProjected=!1);return}u.visibility="";const C=_.animationValues||_.latestValues;this.applyTransformsToTarget();let w=buildProjectionTransform(this.projectionDeltaWithTransform,this.treeScale,C);m&&(w=m(C,w)),u.transform=w;const{x:k,y:F}=this.projectionDelta;u.transformOrigin=`${k.origin*100}% ${F.origin*100}% 0`,_.animationValues?u.opacity=_===this?C.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:C.opacityExit:u.opacity=_===this?C.opacity!==void 0?C.opacity:"":C.opacityExit!==void 0?C.opacityExit:0;for(const T in scaleCorrectors){if(C[T]===void 0)continue;const{correct:z,applyTo:Q,isCSSVariable:J}=scaleCorrectors[T],K=w==="none"?C[T]:z(C[T],_);if(Q){const b=Q.length;for(let N=0;N<b;N++)u[Q[N]]=K}else J?this.options.visualElement.renderState.vars[T]=K:u[T]=K}this.options.layoutId&&(u.pointerEvents=_===this?resolveMotionValue(v?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(u=>u.currentAnimation?.stop()),this.root.nodes.forEach(clearMeasurements),this.root.sharedNodes.clear()}}}function updateLayout(r){r.updateLayout()}function notifyLayoutUpdate(r){const n=r.resumeFrom?.snapshot||r.snapshot;if(r.isLead()&&r.layout&&n&&r.hasListeners("didUpdate")){const{layoutBox:a,measuredBox:c}=r.layout,{animationType:p}=r.options,D=n.source!==r.layout.source;p==="size"?eachAxis(C=>{const w=D?n.measuredBox[C]:n.layoutBox[C],k=calcLength(w);w.min=a[C].min,w.max=w.min+k}):shouldAnimatePositionOnly(p,n.layoutBox,a)&&eachAxis(C=>{const w=D?n.measuredBox[C]:n.layoutBox[C],k=calcLength(a[C]);w.max=w.min+k,r.relativeTarget&&!r.currentAnimation&&(r.isProjectionDirty=!0,r.relativeTarget[C].max=r.relativeTarget[C].min+k)});const u=createDelta();calcBoxDelta(u,a,n.layoutBox);const v=createDelta();D?calcBoxDelta(v,r.applyTransform(c,!0),n.measuredBox):calcBoxDelta(v,a,n.layoutBox);const m=!isDeltaZero(u);let _=!1;if(!r.resumeFrom){const C=r.getClosestProjectingParent();if(C&&!C.resumeFrom){const{snapshot:w,layout:k}=C;if(w&&k){const F=createBox();calcRelativePosition(F,n.layoutBox,w.layoutBox);const T=createBox();calcRelativePosition(T,a,k.layoutBox),boxEqualsRounded(F,T)||(_=!0),C.options.layoutRoot&&(r.relativeTarget=T,r.relativeTargetOrigin=F,r.relativeParent=C)}}}r.notifyListeners("didUpdate",{layout:a,snapshot:n,delta:v,layoutDelta:u,hasLayoutChanged:m,hasRelativeLayoutChanged:_})}else if(r.isLead()){const{onExitComplete:a}=r.options;a&&a()}r.options.transition=void 0}function propagateDirtyNodes(r){r.parent&&(r.isProjecting()||(r.isProjectionDirty=r.parent.isProjectionDirty),r.isSharedProjectionDirty||(r.isSharedProjectionDirty=!!(r.isProjectionDirty||r.parent.isProjectionDirty||r.parent.isSharedProjectionDirty)),r.isTransformDirty||(r.isTransformDirty=r.parent.isTransformDirty))}function cleanDirtyNodes(r){r.isProjectionDirty=r.isSharedProjectionDirty=r.isTransformDirty=!1}function clearSnapshot(r){r.clearSnapshot()}function clearMeasurements(r){r.clearMeasurements()}function clearIsLayoutDirty(r){r.isLayoutDirty=!1}function resetTransformStyle(r){const{visualElement:n}=r.options;n&&n.getProps().onBeforeLayoutMeasure&&n.notify("BeforeLayoutMeasure"),r.resetTransform()}function finishAnimation(r){r.finishAnimation(),r.targetDelta=r.relativeTarget=r.target=void 0,r.isProjectionDirty=!0}function resolveTargetDelta(r){r.resolveTargetDelta()}function calcProjection(r){r.calcProjection()}function resetSkewAndRotation(r){r.resetSkewAndRotation()}function removeLeadSnapshots(r){r.removeLeadSnapshot()}function mixAxisDelta(r,n,a){r.translate=mixNumber$1(n.translate,0,a),r.scale=mixNumber$1(n.scale,1,a),r.origin=n.origin,r.originPoint=n.originPoint}function mixAxis(r,n,a,c){r.min=mixNumber$1(n.min,a.min,c),r.max=mixNumber$1(n.max,a.max,c)}function mixBox(r,n,a,c){mixAxis(r.x,n.x,a.x,c),mixAxis(r.y,n.y,a.y,c)}function hasOpacityCrossfade(r){return r.animationValues&&r.animationValues.opacityExit!==void 0}const defaultLayoutTransition={duration:.45,ease:[.4,0,.1,1]},userAgentContains=r=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(r),roundPoint=userAgentContains("applewebkit/")&&!userAgentContains("chrome/")?Math.round:noop;function roundAxis(r){r.min=roundPoint(r.min),r.max=roundPoint(r.max)}function roundBox(r){roundAxis(r.x),roundAxis(r.y)}function shouldAnimatePositionOnly(r,n,a){return r==="position"||r==="preserve-aspect"&&!isNear(aspectRatio(n),aspectRatio(a),.2)}function checkNodeWasScrollRoot(r){return r!==r.root&&r.scroll?.wasRoot}const DocumentProjectionNode=createProjectionNode({attachResizeListener:(r,n)=>addDomEvent(r,"resize",n),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),rootProjectionNode={current:void 0},HTMLProjectionNode=createProjectionNode({measureScroll:r=>({x:r.scrollLeft,y:r.scrollTop}),defaultParent:()=>{if(!rootProjectionNode.current){const r=new DocumentProjectionNode({});r.mount(window),r.setOptions({layoutScroll:!0}),rootProjectionNode.current=r}return rootProjectionNode.current},resetTransform:(r,n)=>{r.style.transform=n!==void 0?n:"none"},checkIsScrollRoot:r=>window.getComputedStyle(r).position==="fixed"}),drag={pan:{Feature:PanGesture},drag:{Feature:DragGesture,ProjectionNode:HTMLProjectionNode,MeasureLayout}};function handleHoverEvent(r,n,a){const{props:c}=r;r.animationState&&c.whileHover&&r.animationState.setActive("whileHover",a==="Start");const p="onHover"+a,D=c[p];D&&frame.postRender(()=>D(n,extractEventInfo(n)))}class HoverGesture extends Feature{mount(){const{current:n}=this.node;n&&(this.unmount=hover(n,(a,c)=>(handleHoverEvent(this.node,c,"Start"),p=>handleHoverEvent(this.node,p,"End"))))}unmount(){}}class FocusGesture extends Feature{constructor(){super(...arguments),this.isActive=!1}onFocus(){let n=!1;try{n=this.node.current.matches(":focus-visible")}catch{n=!0}!n||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=pipe(addDomEvent(this.node.current,"focus",()=>this.onFocus()),addDomEvent(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function handlePressEvent(r,n,a){const{props:c}=r;if(r.current instanceof HTMLButtonElement&&r.current.disabled)return;r.animationState&&c.whileTap&&r.animationState.setActive("whileTap",a==="Start");const p="onTap"+(a==="End"?"":a),D=c[p];D&&frame.postRender(()=>D(n,extractEventInfo(n)))}class PressGesture extends Feature{mount(){const{current:n}=this.node;n&&(this.unmount=press(n,(a,c)=>(handlePressEvent(this.node,c,"Start"),(p,{success:D})=>handlePressEvent(this.node,p,D?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const observerCallbacks=new WeakMap,observers=new WeakMap,fireObserverCallback=r=>{const n=observerCallbacks.get(r.target);n&&n(r)},fireAllObserverCallbacks=r=>{r.forEach(fireObserverCallback)};function initIntersectionObserver({root:r,...n}){const a=r||document;observers.has(a)||observers.set(a,{});const c=observers.get(a),p=JSON.stringify(n);return c[p]||(c[p]=new IntersectionObserver(fireAllObserverCallbacks,{root:r,...n})),c[p]}function observeIntersection(r,n,a){const c=initIntersectionObserver(n);return observerCallbacks.set(r,a),c.observe(r),()=>{observerCallbacks.delete(r),c.unobserve(r)}}const thresholdNames={some:0,all:1};class InViewFeature extends Feature{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:n={}}=this.node.getProps(),{root:a,margin:c,amount:p="some",once:D}=n,u={root:a?a.current:void 0,rootMargin:c,threshold:typeof p=="number"?p:thresholdNames[p]},v=m=>{const{isIntersecting:_}=m;if(this.isInView===_||(this.isInView=_,D&&!_&&this.hasEnteredView))return;_&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",_);const{onViewportEnter:C,onViewportLeave:w}=this.node.getProps(),k=_?C:w;k&&k(m)};return observeIntersection(this.node.current,u,v)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:n,prevProps:a}=this.node;["amount","margin","root"].some(hasViewportOptionChanged(n,a))&&this.startObserver()}unmount(){}}function hasViewportOptionChanged({viewport:r={}},{viewport:n={}}={}){return a=>r[a]!==n[a]}const gestureAnimations={inView:{Feature:InViewFeature},tap:{Feature:PressGesture},focus:{Feature:FocusGesture},hover:{Feature:HoverGesture}},layout={layout:{ProjectionNode:HTMLProjectionNode,MeasureLayout}},featureBundle={...animations,...gestureAnimations,...drag,...layout},motion=createMotionProxy(featureBundle,createDomVisualElement);function OptimadeNoResults({queryUrl:r,currentFilter:n}){const a=`${r}/structures?filter=${encodeURIComponent(n)}`,c=`${r}/structures?filter=${decodeURIComponent(n)}`;return jsxRuntimeExports.jsxs("div",{className:`${warningContainerStyle} ${textSmall}`,children:[jsxRuntimeExports.jsx("strong",{className:"font-semibold",children:"Warning: "}),"No results returned for this query. Try to relax the filters.",jsxRuntimeExports.jsxs("p",{className:"pt-2",children:["Attempted Query:"," ",jsxRuntimeExports.jsx("a",{href:a,target:"_blank",rel:"noopener noreferrer",className:`${textHyperlink} break-all`,children:c})]})]})}var dist={},Navbar={};const mcloud_logo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGIAAABPCAYAAAAQlxDmAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH4QgeDQk2h9q0aQAADmpJREFUeNrtXXuYU9W1/61zkgzDc2ByMuM45GR4fDyGZHiM16uFXm2V6idWKWpLa6Gg9oHaa1Xwtra0Kn0/KKKoxVKxLVKq9T7Ui9ZPvNZXZQAzmaBYYJLMMDBJEMSBYSY5Z90/Mthz9jxIhuRMBrP+y87JPnvt317PvfYOUKACFahABSpQz0SDefDbAFupe9SIU5/ldkeiOhZrKwCRQwpWw5FsK50tMc1hovMATAagArAJjx4mpn0gfQcTvZXU+IWZTfGWAhBnSIGxzlqWaBmAawCM6EcXDEIdM/8mkXBsqm1pOVEAIu2ZAwVU50IQ3QbGeVns+igYj9mIfzY1HD9YAKIP8o8tm0ayvg6MOWmy0Anw8S4Vla7EfECM770Tia27DtAKQBiobhbsjphyLwh3ALD38ti7BLykE79qk7TX2k8Wx42qhgFpd+XIkiQVVUPCJwmYDeAiAEN66W8HSbTU2xitLwABoK6iwumwJ/7cNWkitRGwWSfp0ZpQ698zNvKVI8foUtH1TLgJwLQeHjlOoEXecPQvH2sgGsaWnqdL0tMAzhW+0pjwoI7E92eEjh7NitpzO68kojUAqrrZJcL9vlDsWwToHzsggu4xUzWSXwUwWvhqD4GWesPR17P9zncnOUd0nqQfAri1+2Twz73h+IqPFRDBcaPdmmZ7A0CF8NWT8gksyXVgFnA75zHRHwCMEmTjDl84/quPBRBBRRmuDcXLAGYJDv8vfeHoCqvUw9uqMkMCngegmFQi8/yaSPx/rJwTaSCA0IrxQE8g1ISjd1qpo6eHY7tYlz4F0PuGZpmIngiMdY0/q4EIVLnmgrBIkMstvnB0QHRzTVNrA0j/HIAOQ/MwlviBsxaIf0yYUMQ6PySoxD2dnfYlA+WtAIAvFP8/ZtwlNF/mdyvXnJVAnEgeWwpgnFFLEWhpPuR/fJHYWjBeMQkqYdUWQD6rgKibBTtYv0vw3R/MhYvaT69Fl3XcACBpaJ40xWONVFgGhD2mXEUg1dDULhH9CHlE1c2xvQQ8ZlosjNvOLtVEWGxmkDd6G6OtyDPSZP45zInA8+s9pZPPCiACqms+AfNMQMj8O+QhTd8ffw/gOnPATWuD1XAMWiCCHqXcr7p+wcDmbi/WZTkfgWCAQDRUEOdLtDblLb9HuWzQRdZ+1XkjgdaitxQ0owng+b5IfEe+gFA3C3ZHXHkEwJI+HnvWnnQsnnLgwOG8lwi/R1lMoPXofR8AIIwF0StvV5X+S74A4Tis/PE0IADAFQlb5zN1s3rdM8kPIOrdo0YTo6eo9CSAhNA2VNKlhzkP0vEB1TUfjGt7+OrDHtr+1R53ZdWbouwDodwFwk8MTUdZ58V7muLPVldD1tqUmwCsgSFQIuYfMOTXBgwFCcOYtTVG95qB1ySdFnubovuCHqVcY34IoKsNv2odQcM8VaHQybwDom7c6FEOzbYbxtQ289d8kfhvTGCpyloAtyB/6YRMGF8dih36iLeKiqEOW+JdEMYaY4yaSGxN3qimf0yYUFSvKrc4NNvbEPYXNMn2Qjf0mZ9HflO9EQQAqG1pOQEiMQWyut6j/Cmglk4ZUCC2AHK9qtzcnvhgH4C1ADziMzLr54htOqE8z4HobXzndNMojOsYUkO96tp0JqnzfqumYKUyQZOxEcCFp3HMX+hUYvNqd6QM9S5PSYnM9u0AJghPHgawB2ArE4CUmnSa2m0umL/qi8TXf2TMq1xzWeetp5mz40y03BeKPkwA5xwIv8e5kJjWAxiWrqgD+G8QO8D0RQCVwjBWy8Oj/1EdROeA6CG3cxaIngVQZo7t8BQDbxNjIghfQvfyzt5oa7Fd+/zEve8fyxkQ9W7nTSB6uAe19iEBaxm8G6DbANSm2eV+bzg2cSD3IwwB6Po0H08Q8w9ZojAxbuBU/ZRIO9kmXV6zrzWadRvhV13LQPRI99/RE0mdJ3vDsbt94fgfNUpcCkIgzZTC7oEGIbUipWDaIIA+743E7/GFYo95w7E5BFoAoFl4biYl9Vd2TihXsgpEwO26lMD3C1LUDsJSXzj6RWPF9YzQ0aPFNm02A7/tIYgTRXIaD9DeuWB1p6ajEHRJn+0NR582NnrD0b+QRLXixhKASXJC+9O2NFQapaeOysaBeDvAY8wRJ33GF46+0acUjS9zIaF/koDxXW/8NwCXC2JxnS8S+/NAgcCAVK8qOwiYbmhuIcIDrEMHiEH42+l4TeWqnFuEwO+jwogzB0J1/hWgS0ySIOEyX2PslX4y/SIBF/+zjcOJhGPqQG2ZBjyurzPzQ8ZhSkxzpkWiGUf7wWo4tDblP4XFxkzSBX2VjJ5WJfhV1wIBBBBwS39A6PqtbtPw1a7cU1cbqUX2zh8MBAg7xzormPmn5kHS+v6AAADVQXTKJ3BdyhU39Mj6Q32pYOl0AZvE/GPBv/4vbzi24UyYr26O7QVhjSC+3/RXOSdZDYRNovsAjDQ0HWGZvndG/MVibUzSV2B2QmY09FEV0icQU9zOy5kw0dDUYZPt/56NCWhLFt0DYL+hqYiY1luZiW1QnRcDWGpeELwiXZezL6oJtb4JYKOpb+p9/7tPIHSiJWZh4N9NbTwYzsYkXNjc3E6g5YIBmROwqJZoG2DTQauF5h17wvGsbeEypPtgrgq5oLf9716B2OUpKSHgSlPeSJYezuZkdJ1J2CoYkV8FFWV4roFwupVlAGqM606X9GXZPEFUE25tZIE/1qVFGQFhY9snYD6545/WGPVne0JkDbcaDTeASn0or8wlCEGPUs6EewUD/ej0xsNv5cA33mh+TY+HcXoHgonmCB3+by4mpbo5thfgHwmG+/agR5meKyC01MaUsRz/YLEtuTwX7yoq5udhlrLauoqKoenbCOZaM5K0PVcT06YN+YVguGWNsToXhjvgcV4kbokyeGUmCbpMaPKe+IcA3jM02e0OzZeBsaYy0yqS9YZcAXFhc3M7MYve2EUB1bkwm++pmwU7p/bTjQC/6QvHNyCXRGgQYqmyTLymUpOIdRQdzuVYvZH4MwQ8JXCwut49anS23mGPK8sBqjYm8HSWb8x10pEYMfNn3ZkJECUmkT5w4ChyTEmS7wRgTHO4AEdWDLf/3DGVBHxbaH5keuRQELknYe64JBMgjAc3UFlZ6cj1aGeEDoXAdI8g1t/MRu0T2aS1AIxu8QHHEP6OFTGLDioSnJGODIy1uZ5nCJ0cbcWgix0j1wjGTZJ16ZdnYrgDVa653TKiTN/pMqQ5JzJnrcFMx9IHQkLI5O9LPNmKQU/cu7eDddwIw54vA7MDbueN/emv0eMZwjqvE6bmpZpI9HELU1qTBI+0Mf04gk2rEhLkmVaNuqYp9jeIhptoVX8M9zE+fgdO7YV0mSJodJtVvHSVZprcVclG76UNhAS8ISBziYUrCJzUvgXAeNbaReRYlUkfuzzlHgIEO0Brfc2tAav4cLyvXCDYpsaezoX0IRHSNnOkjU8HqlxllknFgfebGXSv2Wzha37VmbZkytDXADBGsS2OIfr3rVxQpPMXBB5eyijF4Yu07gewy5h+0nW+wUomEs7orwHabZxbAtals8cdcDvngfmz5sXEd1hloIHUdRMMWigEc09lBETXwB8XOrm1pzxJrqh2BxJE+s0wFWvR+QG3s88F8XplZTGnLj8xG+hQfLOVC6mzXfqGEI8dOhyO/TVjIIba9A0Ajhiayh2OTktF2xuKvwzQJsFw/9g/vszV229GyB3fhekYMXUSNEuLnv3njqkE8d1CSPDri837E+kBkUqE8WpBTG5vcLs+YSVTNujLARh971Ipqa/rcQI8ZeczsELIMaz2hg+/Y5mjAUhklzfAvAUbldvxYB/OUd/UlRltNNkKwqadY50VVjE2NRw/yIyVArML/KpydzcvifUnYawjYjRxu3SflQun3uNaCcalQlR3V1837qQVrQbcrkuZeKsJOEIgaZM/PXPvoZgVzG0DbKUeZScYXoGFTSRhI2u6B6lz26VCOuGamnD0KctAUJWbAfHEFL/oDcfn9lWYnHbaIKAqqxi4W2jeq8t8RepIrAV6V3UtIPCTmcRTvnDsPKvUUYOq3NvDHB0kiWac7kx52qWO08KxldT9mO4ESaPtfo/zC5bYCu3ktsyceH7JinEFPUp5QFWe6QGEYwyel87B/rSBIECXhscWA3ha+GokMT1RryrP1ruds3LJsE5DMkxxSCU5BUBRhterzts1xjsQy0iBDyDhyppwfGea85sZbQHkKapyPwPLeunwVZ3wqGaTn8um/Xi9srJ4mNyxRbzBAKlc/+tInbkQtyBPSExz+1u11xv/kzxltcT6lwB8WYgTTlGzJNG8TIot+p9adruuZ+J16P3SWwbwLoAgg0NE1P8yFcYwMK4yHiTsopc7E/Zra1ta4inX1bmQmP4gSHqSga0S+B0m0s9AHEtAPAnATMEtFem5zoR98akx5RwIoOuCxKR8P4iuwgCQRnLVjNChkNmgOx8n0JcHYDgxZrrTF4n+PtNjWxnZiJ6oev+RiC8Sv1pims3AM7D2wMkxEYQUQ5LVtxq3MGiFYwiPr4lEH+8PCGcsESLtrjpHTeqJRQCuAKgWOb79qyeJqFedvwfo+hxPfitALxLrm+OR+Nbe0hYDBoTJgR83elRRQp7IRFUskZN0HtlvE0GkADyJgMtgPn3zcqecvLp2/5EPAKDerVwLwmZB0g8y8ByBw2Dq32FJiTsBOgpdaiLmxmlN0f39XfmWA5Gb1IGyBIwN3VYn85sgUgBcYOKJsJ3bpYtrWluP5ztvg+6vbQKq8iQDC9J4tE3WMCNV0pn/JA02IDoS9kXEON0VEkfA0vzBAsKglIhTeZ2AqixDKqg03oPRAcYTxLTK2xTdN5h4GtT/unUqzwOgPEncnuhwNOXrfwgVqEAFKlCBCtRf+n97Y2CaOfCNbwAAAABJRU5ErkJggg==",mcloud_logo$1=Object.freeze(Object.defineProperty({__proto__:null,default:mcloud_logo},Symbol.toStringTag,{value:"Module"})),require$$1=getAugmentedNamespace(mcloud_logo$1);var hasRequiredNavbar;function requireNavbar(){if(hasRequiredNavbar)return Navbar;hasRequiredNavbar=1,Object.defineProperty(Navbar,"__esModule",{value:!0}),Navbar.default=void 0;var r=c(require$$1),n=a(requireReact());function a(m,_){if(typeof WeakMap=="function")var C=new WeakMap,w=new WeakMap;return(a=function(k,F){if(!F&&k&&k.__esModule)return k;var T,z,Q={__proto__:null,default:k};if(k===null||typeof k!="object"&&typeof k!="function")return Q;if(T=F?w:C){if(T.has(k))return T.get(k);T.set(k,Q)}for(const J in k)J!=="default"&&{}.hasOwnProperty.call(k,J)&&((z=(T=Object.defineProperty)&&Object.getOwnPropertyDescriptor(k,J))&&(z.get||z.set)?T(Q,J,z):Q[J]=k[J]);return Q})(m,_)}function c(m){return m&&m.__esModule?m:{default:m}}const p={learn:{name:"LEARN",link:"https://www.materialscloud.org/learn"},work:{name:"WORK",link:"https://www.materialscloud.org/work"},discover:{name:"DISCOVER",link:"https://www.materialscloud.org/discover"},explore:{name:"EXPLORE",link:"https://www.materialscloud.org/explore"},archive:{name:"ARCHIVE",link:"https://www.materialscloud.org/archive"}},D={policies:{name:"Policies",link:"https://www.materialscloud.org/policies"},dmp:{name:"Data Management Plan",link:"https://www.materialscloud.org/dmp"},terms:{name:"Terms of Use",link:"https://www.materialscloud.org/termssummary"},infrastructure:{name:"Infrastructure",link:"https://www.materialscloud.org/infrastructure"},team:{name:"Team & Contact",link:"https://www.materialscloud.org/team"},partners:{name:"Partners",link:"https://www.materialscloud.org/home#partners"},restapi:{name:"Connect your REST API",link:"https://www.materialscloud.org/explore/connect"}},u=m=>{let{activeSection:_}=m;const[C,w]=(0,n.useState)(!1),k=(0,n.useRef)(null);(0,n.useEffect)(()=>{function z(Q){k.current&&!k.current.contains(Q.target)&&w(!1)}return document.addEventListener("mousedown",z),()=>document.removeEventListener("mousedown",z)},[]);const F=()=>w(z=>!z),T="dropdown-content"+(C?" dropdown-open":"");return n.default.createElement("div",{ref:k,className:"more-dropdown"},n.default.createElement("span",{className:"more-btn",onClick:F},"More ",n.default.createElement("i",{className:"fa fa-caret-down"})),n.default.createElement("div",{className:T},Object.keys(D).map((z,Q)=>{const{link:J,name:K}=D[z],b=z===_?"active":"";return n.default.createElement("a",{key:Q,className:b,href:J},K)})))},v=m=>{let{activeSection:_}=m;return n.default.createElement("div",{className:"mc-navbar"},n.default.createElement("a",{className:"mc-navbrand",href:"https://www.materialscloud.org/home"},n.default.createElement("img",{src:r.default,loading:"lazy",height:"50",alt:"MC logo"})),Object.keys(p).map((C,w)=>{let k="mc-navlink";return C===_&&(k+=" active"),n.default.createElement("a",{key:w,className:k,href:p[C].link},p[C].name)}),n.default.createElement(u,{activeSection:_}))};return Navbar.default=v,Navbar}var Breadcrumbs={},hasRequiredBreadcrumbs;function requireBreadcrumbs(){if(hasRequiredBreadcrumbs)return Breadcrumbs;hasRequiredBreadcrumbs=1,Object.defineProperty(Breadcrumbs,"__esModule",{value:!0}),Breadcrumbs.default=void 0;var r=n(requireReact());function n(c){return c&&c.__esModule?c:{default:c}}const a=c=>{let{breadcrumbsPath:p}=c;return r.default.createElement("ul",{className:"mc-breadcrumb"},p.map((D,u)=>r.default.createElement("li",{key:u},r.default.createElement("a",{href:D.link},D.name))))};return Breadcrumbs.default=a,Breadcrumbs}var hasRequiredDist;function requireDist(){if(hasRequiredDist)return dist;hasRequiredDist=1,Object.defineProperty(dist,"__esModule",{value:!0}),dist.default=void 0;var r=c(requireReact()),n=c(requireNavbar()),a=c(requireBreadcrumbs());function c(D){return D&&D.__esModule?D:{default:D}}const p=D=>{let{activeSection:u,breadcrumbsPath:v}=D;return r.default.createElement("div",null,r.default.createElement(n.default,{activeSection:u}),r.default.createElement(a.default,{breadcrumbsPath:v}))};return dist.default=p,dist}var distExports=requireDist();const MaterialsCloudHeader=getDefaultExportFromCjs(distExports);function OptimadeChildInfo({child:r}){if(!r)return;const{name:n,description:a,homepage:c,base_url:p,...D}=r;return jsxRuntimeExports.jsxs("div",{className:`${containerStyle} ${textTiny} h-35 overflow-auto`,children:[jsxRuntimeExports.jsx("h3",{className:`${textNormal} pb-1.5`,children:n}),a&&jsxRuntimeExports.jsx("p",{className:"pb-1",children:a}),c&&jsxRuntimeExports.jsxs("p",{children:["Homepage:"," ",jsxRuntimeExports.jsx("a",{href:c,target:"_blank",rel:"noopener noreferrer",className:textHyperlink,children:c})]}),p&&jsxRuntimeExports.jsxs("p",{children:["Base url:"," ",jsxRuntimeExports.jsx("a",{href:p,target:"_blank",rel:"noopener noreferrer",className:textHyperlink,children:p})]})]})}function OptimadeParentInfo({provider:r,providers:n}){if(!r||!n)return null;const a=n.find(m=>m.attributes?.base_url===r.attributes?.base_url);if(!a)return null;const{name:c,description:p,homepage:D,base_url:u,...v}=a.attributes??{};return jsxRuntimeExports.jsxs("div",{className:`${containerStyle} h-35 overflow-auto ${textTiny}`,children:[jsxRuntimeExports.jsx("h3",{className:`${textNormal} pb-1.5`,children:c}),p&&jsxRuntimeExports.jsx("p",{className:"pb-1",children:p}),D&&jsxRuntimeExports.jsxs("p",{children:["Homepage:"," ",jsxRuntimeExports.jsx("a",{href:D,target:"_blank",rel:"noopener noreferrer",className:textHyperlink,children:D})]}),u&&jsxRuntimeExports.jsxs("p",{children:["Index metadb:"," ",jsxRuntimeExports.jsx("a",{href:`${u}/links`,target:"_blank",rel:"noopener noreferrer",className:textHyperlink,children:`${u}/links`})]})]})}function OptimadeClient({hideProviderList:r=["exmpl","matcloud"]}){const[n,a]=reactExports.useState([]),[c,p]=reactExports.useState(""),[D,u]=reactExports.useState(null),[v,m]=reactExports.useState(null),[_,C]=reactExports.useState(""),[w,k]=reactExports.useState(1),[F,T]=reactExports.useState(null),[z,Q]=reactExports.useState(null),[J,K]=reactExports.useState(!1),[b,N]=reactExports.useState(1),[V,U]=reactExports.useState({data_returned:0,data_available:0});reactExports.useEffect(()=>{(async()=>{try{const ee=await getProvidersList(void 0,r);a(ee.data)}catch(ee){console.error("Error fetching providers:",ee)}})()},[]);const Z=reactExports.useCallback(async()=>{if(c){K(!0);try{const L=await getStructures({providerUrl:c,filter:_,page:w});Q(L);const ee=L?.meta??{data_returned:0,data_available:0};U(ee),N(ee.data_returned!=null&&!isNaN(ee.data_returned)?Math.max(1,Math.ceil(ee.data_returned/20)):"N/A"),T(L?.data[0]||null)}catch(L){console.error("Error fetching structures:",L),T(null)}finally{K(!1)}}},[c,_,w]);return reactExports.useEffect(()=>{Z()},[Z]),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(MaterialsCloudHeader,{className:"header",activeSection:"work",breadcrumbsPath:[{name:"Work",link:"https://www.materialscloud.org/work"},{name:"OPTIMADE-Client",link:null}]}),jsxRuntimeExports.jsx("div",{className:"min-h-screen max-w-5xl mx-auto bg-white mb-4 shadow-md rounded-xs",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center w-full px-2 md:px-4 py-2",children:[jsxRuntimeExports.jsx(OptimadeHeader,{}),jsxRuntimeExports.jsx("div",{className:"p-2 w-full",children:jsxRuntimeExports.jsx(OptimadeFAQs,{})}),jsxRuntimeExports.jsx("div",{className:"pt-4 p-2",children:jsxRuntimeExports.jsx(DatabaseSelector,{providers:n,onChildChange:u,onProviderChange:m,onQueryUrlChange:L=>{L!==c&&(p(L),k(1))}})}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col md:flex-row w-full max-w-5xl px-2 md:px-4 py-2 gap-4",children:[jsxRuntimeExports.jsx("div",{className:"md:w-1/2 w-full",children:jsxRuntimeExports.jsx(OptimadeParentInfo,{provider:v,providers:n})}),jsxRuntimeExports.jsx("div",{className:"md:w-1/2 w-full",children:jsxRuntimeExports.jsx(OptimadeChildInfo,{child:D})})]}),jsxRuntimeExports.jsx("div",{className:"p-2 w-full",children:jsxRuntimeExports.jsx("div",{style:{display:c?"block":"none"},children:jsxRuntimeExports.jsx(AnimatePresence,{children:jsxRuntimeExports.jsx(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},transition:{duration:.3,ease:"easeInOut"},className:containerStyle,children:jsxRuntimeExports.jsx(OptimadeFilters,{queryUrl:c,onSubmit:L=>{C(L),k(1)}})},"filters")})})}),jsxRuntimeExports.jsx("div",{className:"p-2 w-full",children:jsxRuntimeExports.jsx(OptimadeProviderInfo,{queryUrl:c})}),c&&jsxRuntimeExports.jsxs("div",{className:"px-2 md:px-4 w-full",children:[J&&jsxRuntimeExports.jsx("div",{className:"flex justify-center items-center h-[610px]",children:jsxRuntimeExports.jsx("div",{className:"w-16 h-16 border-4 border-gray-300 border-t-blue-500 rounded-full animate-spin"})}),jsxRuntimeExports.jsx("div",{className:"border-b border-slate-300 py-2"}),!J&&!F&&_&&jsxRuntimeExports.jsx("div",{className:"p-2",children:jsxRuntimeExports.jsx(OptimadeNoResults,{queryUrl:c,currentFilter:_})}),!J&&z&&F&&jsxRuntimeExports.jsxs("div",{className:"py-1 md:py-2 ",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col md:flex-row items-stretch md:items-end gap-4",children:[jsxRuntimeExports.jsx("div",{className:"flex-1",children:jsxRuntimeExports.jsx(ResultsDropdown,{results:z,resultsLoading:J,selectedResult:F,setSelectedResult:T})}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(PaginationHandler,{currentPage:w,totalPages:b,resultsLoading:J,metaData:V,onPageChange:k})})]}),jsxRuntimeExports.jsx("div",{className:"py-4",children:jsxRuntimeExports.jsx(ResultViewer,{selectedResult:F})})]})]})]})})]})}const badProviders=["exmpl","aiida","aflow","ccdc","cod","ccpnc","httk","matcloud","mpds","mpod","optimake","optimade","pcod","psdi"];function App(){return jsxRuntimeExports.jsx(OptimadeClient,{hideProviderList:badProviders})}clientExports.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(reactExports.StrictMode,{children:jsxRuntimeExports.jsx(App,{})}));
