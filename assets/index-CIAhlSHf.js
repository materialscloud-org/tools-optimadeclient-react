(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))c(d);new MutationObserver(d=>{for(const R of d)if(R.type==="childList")for(const u of R.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&c(u)}).observe(document,{childList:!0,subtree:!0});function a(d){const R={};return d.integrity&&(R.integrity=d.integrity),d.referrerPolicy&&(R.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?R.credentials="include":d.crossOrigin==="anonymous"?R.credentials="omit":R.credentials="same-origin",R}function c(d){if(d.ep)return;d.ep=!0;const R=a(d);fetch(d.href,R)}})();var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function getAugmentedNamespace(r){if(Object.prototype.hasOwnProperty.call(r,"__esModule"))return r;var n=r.default;if(typeof n=="function"){var a=function c(){var d=!1;try{d=this instanceof c}catch{}return d?Reflect.construct(n,arguments,this.constructor):n.apply(this,arguments)};a.prototype=n.prototype}else a={};return Object.defineProperty(a,"__esModule",{value:!0}),Object.keys(r).forEach(function(c){var d=Object.getOwnPropertyDescriptor(r,c);Object.defineProperty(a,c,d.get?d:{enumerable:!0,get:function(){return r[c]}})}),a}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};var hasRequiredReact_production_min;function requireReact_production_min(){if(hasRequiredReact_production_min)return react_production_min;hasRequiredReact_production_min=1;var r=Symbol.for("react.element"),n=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),c=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),R=Symbol.for("react.provider"),u=Symbol.for("react.context"),v=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),b=Symbol.for("react.memo"),T=Symbol.for("react.lazy"),x=Symbol.iterator;function k(fe){return fe===null||typeof fe!="object"?null:(fe=x&&fe[x]||fe["@@iterator"],typeof fe=="function"?fe:null)}var F={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,z={};function Q(fe,De,We){this.props=fe,this.context=De,this.refs=z,this.updater=We||F}Q.prototype.isReactComponent={},Q.prototype.setState=function(fe,De){if(typeof fe!="object"&&typeof fe!="function"&&fe!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,fe,De,"setState")},Q.prototype.forceUpdate=function(fe){this.updater.enqueueForceUpdate(this,fe,"forceUpdate")};function J(){}J.prototype=Q.prototype;function q(fe,De,We){this.props=fe,this.context=De,this.refs=z,this.updater=We||F}var w=q.prototype=new J;w.constructor=q,C(w,Q.prototype),w.isPureReactComponent=!0;var N=Array.isArray,V=Object.prototype.hasOwnProperty,H={current:null},Y={key:!0,ref:!0,__self:!0,__source:!0};function O(fe,De,We){var oe,Ee={},He=null,Ue=null;if(De!=null)for(oe in De.ref!==void 0&&(Ue=De.ref),De.key!==void 0&&(He=""+De.key),De)V.call(De,oe)&&!Y.hasOwnProperty(oe)&&(Ee[oe]=De[oe]);var Ie=arguments.length-2;if(Ie===1)Ee.children=We;else if(1<Ie){for(var rt=Array(Ie),st=0;st<Ie;st++)rt[st]=arguments[st+2];Ee.children=rt}if(fe&&fe.defaultProps)for(oe in Ie=fe.defaultProps,Ie)Ee[oe]===void 0&&(Ee[oe]=Ie[oe]);return{$$typeof:r,type:fe,key:He,ref:Ue,props:Ee,_owner:H.current}}function ee(fe,De){return{$$typeof:r,type:fe.type,key:De,ref:fe.ref,props:fe.props,_owner:fe._owner}}function Ae(fe){return typeof fe=="object"&&fe!==null&&fe.$$typeof===r}function ce(fe){var De={"=":"=0",":":"=2"};return"$"+fe.replace(/[=:]/g,function(We){return De[We]})}var ge=/\/+/g;function me(fe,De){return typeof fe=="object"&&fe!==null&&fe.key!=null?ce(""+fe.key):De.toString(36)}function Me(fe,De,We,oe,Ee){var He=typeof fe;(He==="undefined"||He==="boolean")&&(fe=null);var Ue=!1;if(fe===null)Ue=!0;else switch(He){case"string":case"number":Ue=!0;break;case"object":switch(fe.$$typeof){case r:case n:Ue=!0}}if(Ue)return Ue=fe,Ee=Ee(Ue),fe=oe===""?"."+me(Ue,0):oe,N(Ee)?(We="",fe!=null&&(We=fe.replace(ge,"$&/")+"/"),Me(Ee,De,We,"",function(st){return st})):Ee!=null&&(Ae(Ee)&&(Ee=ee(Ee,We+(!Ee.key||Ue&&Ue.key===Ee.key?"":(""+Ee.key).replace(ge,"$&/")+"/")+fe)),De.push(Ee)),1;if(Ue=0,oe=oe===""?".":oe+":",N(fe))for(var Ie=0;Ie<fe.length;Ie++){He=fe[Ie];var rt=oe+me(He,Ie);Ue+=Me(He,De,We,rt,Ee)}else if(rt=k(fe),typeof rt=="function")for(fe=rt.call(fe),Ie=0;!(He=fe.next()).done;)He=He.value,rt=oe+me(He,Ie++),Ue+=Me(He,De,We,rt,Ee);else if(He==="object")throw De=String(fe),Error("Objects are not valid as a React child (found: "+(De==="[object Object]"?"object with keys {"+Object.keys(fe).join(", ")+"}":De)+"). If you meant to render a collection of children, use an array instead.");return Ue}function ue(fe,De,We){if(fe==null)return fe;var oe=[],Ee=0;return Me(fe,oe,"","",function(He){return De.call(We,He,Ee++)}),oe}function I(fe){if(fe._status===-1){var De=fe._result;De=De(),De.then(function(We){(fe._status===0||fe._status===-1)&&(fe._status=1,fe._result=We)},function(We){(fe._status===0||fe._status===-1)&&(fe._status=2,fe._result=We)}),fe._status===-1&&(fe._status=0,fe._result=De)}if(fe._status===1)return fe._result.default;throw fe._result}var he={current:null},se={transition:null},K={ReactCurrentDispatcher:he,ReactCurrentBatchConfig:se,ReactCurrentOwner:H};function Re(){throw Error("act(...) is not supported in production builds of React.")}return react_production_min.Children={map:ue,forEach:function(fe,De,We){ue(fe,function(){De.apply(this,arguments)},We)},count:function(fe){var De=0;return ue(fe,function(){De++}),De},toArray:function(fe){return ue(fe,function(De){return De})||[]},only:function(fe){if(!Ae(fe))throw Error("React.Children.only expected to receive a single React element child.");return fe}},react_production_min.Component=Q,react_production_min.Fragment=a,react_production_min.Profiler=d,react_production_min.PureComponent=q,react_production_min.StrictMode=c,react_production_min.Suspense=m,react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=K,react_production_min.act=Re,react_production_min.cloneElement=function(fe,De,We){if(fe==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+fe+".");var oe=C({},fe.props),Ee=fe.key,He=fe.ref,Ue=fe._owner;if(De!=null){if(De.ref!==void 0&&(He=De.ref,Ue=H.current),De.key!==void 0&&(Ee=""+De.key),fe.type&&fe.type.defaultProps)var Ie=fe.type.defaultProps;for(rt in De)V.call(De,rt)&&!Y.hasOwnProperty(rt)&&(oe[rt]=De[rt]===void 0&&Ie!==void 0?Ie[rt]:De[rt])}var rt=arguments.length-2;if(rt===1)oe.children=We;else if(1<rt){Ie=Array(rt);for(var st=0;st<rt;st++)Ie[st]=arguments[st+2];oe.children=Ie}return{$$typeof:r,type:fe.type,key:Ee,ref:He,props:oe,_owner:Ue}},react_production_min.createContext=function(fe){return fe={$$typeof:u,_currentValue:fe,_currentValue2:fe,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},fe.Provider={$$typeof:R,_context:fe},fe.Consumer=fe},react_production_min.createElement=O,react_production_min.createFactory=function(fe){var De=O.bind(null,fe);return De.type=fe,De},react_production_min.createRef=function(){return{current:null}},react_production_min.forwardRef=function(fe){return{$$typeof:v,render:fe}},react_production_min.isValidElement=Ae,react_production_min.lazy=function(fe){return{$$typeof:T,_payload:{_status:-1,_result:fe},_init:I}},react_production_min.memo=function(fe,De){return{$$typeof:b,type:fe,compare:De===void 0?null:De}},react_production_min.startTransition=function(fe){var De=se.transition;se.transition={};try{fe()}finally{se.transition=De}},react_production_min.unstable_act=Re,react_production_min.useCallback=function(fe,De){return he.current.useCallback(fe,De)},react_production_min.useContext=function(fe){return he.current.useContext(fe)},react_production_min.useDebugValue=function(){},react_production_min.useDeferredValue=function(fe){return he.current.useDeferredValue(fe)},react_production_min.useEffect=function(fe,De){return he.current.useEffect(fe,De)},react_production_min.useId=function(){return he.current.useId()},react_production_min.useImperativeHandle=function(fe,De,We){return he.current.useImperativeHandle(fe,De,We)},react_production_min.useInsertionEffect=function(fe,De){return he.current.useInsertionEffect(fe,De)},react_production_min.useLayoutEffect=function(fe,De){return he.current.useLayoutEffect(fe,De)},react_production_min.useMemo=function(fe,De){return he.current.useMemo(fe,De)},react_production_min.useReducer=function(fe,De,We){return he.current.useReducer(fe,De,We)},react_production_min.useRef=function(fe){return he.current.useRef(fe)},react_production_min.useState=function(fe){return he.current.useState(fe)},react_production_min.useSyncExternalStore=function(fe,De,We){return he.current.useSyncExternalStore(fe,De,We)},react_production_min.useTransition=function(){return he.current.useTransition()},react_production_min.version="18.3.1",react_production_min}var hasRequiredReact;function requireReact(){return hasRequiredReact||(hasRequiredReact=1,react.exports=requireReact_production_min()),react.exports}var hasRequiredReactJsxRuntime_production_min;function requireReactJsxRuntime_production_min(){if(hasRequiredReactJsxRuntime_production_min)return reactJsxRuntime_production_min;hasRequiredReactJsxRuntime_production_min=1;var r=requireReact(),n=Symbol.for("react.element"),a=Symbol.for("react.fragment"),c=Object.prototype.hasOwnProperty,d=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,R={key:!0,ref:!0,__self:!0,__source:!0};function u(v,m,b){var T,x={},k=null,F=null;b!==void 0&&(k=""+b),m.key!==void 0&&(k=""+m.key),m.ref!==void 0&&(F=m.ref);for(T in m)c.call(m,T)&&!R.hasOwnProperty(T)&&(x[T]=m[T]);if(v&&v.defaultProps)for(T in m=v.defaultProps,m)x[T]===void 0&&(x[T]=m[T]);return{$$typeof:n,type:v,key:k,ref:F,props:x,_owner:d.current}}return reactJsxRuntime_production_min.Fragment=a,reactJsxRuntime_production_min.jsx=u,reactJsxRuntime_production_min.jsxs=u,reactJsxRuntime_production_min}var hasRequiredJsxRuntime;function requireJsxRuntime(){return hasRequiredJsxRuntime||(hasRequiredJsxRuntime=1,jsxRuntime.exports=requireReactJsxRuntime_production_min()),jsxRuntime.exports}var jsxRuntimeExports=requireJsxRuntime(),reactExports=requireReact(),client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};var hasRequiredScheduler_production_min;function requireScheduler_production_min(){return hasRequiredScheduler_production_min||(hasRequiredScheduler_production_min=1,(function(r){function n(se,K){var Re=se.length;se.push(K);e:for(;0<Re;){var fe=Re-1>>>1,De=se[fe];if(0<d(De,K))se[fe]=K,se[Re]=De,Re=fe;else break e}}function a(se){return se.length===0?null:se[0]}function c(se){if(se.length===0)return null;var K=se[0],Re=se.pop();if(Re!==K){se[0]=Re;e:for(var fe=0,De=se.length,We=De>>>1;fe<We;){var oe=2*(fe+1)-1,Ee=se[oe],He=oe+1,Ue=se[He];if(0>d(Ee,Re))He<De&&0>d(Ue,Ee)?(se[fe]=Ue,se[He]=Re,fe=He):(se[fe]=Ee,se[oe]=Re,fe=oe);else if(He<De&&0>d(Ue,Re))se[fe]=Ue,se[He]=Re,fe=He;else break e}}return K}function d(se,K){var Re=se.sortIndex-K.sortIndex;return Re!==0?Re:se.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var R=performance;r.unstable_now=function(){return R.now()}}else{var u=Date,v=u.now();r.unstable_now=function(){return u.now()-v}}var m=[],b=[],T=1,x=null,k=3,F=!1,C=!1,z=!1,Q=typeof setTimeout=="function"?setTimeout:null,J=typeof clearTimeout=="function"?clearTimeout:null,q=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(se){for(var K=a(b);K!==null;){if(K.callback===null)c(b);else if(K.startTime<=se)c(b),K.sortIndex=K.expirationTime,n(m,K);else break;K=a(b)}}function N(se){if(z=!1,w(se),!C)if(a(m)!==null)C=!0,I(V);else{var K=a(b);K!==null&&he(N,K.startTime-se)}}function V(se,K){C=!1,z&&(z=!1,J(O),O=-1),F=!0;var Re=k;try{for(w(K),x=a(m);x!==null&&(!(x.expirationTime>K)||se&&!ce());){var fe=x.callback;if(typeof fe=="function"){x.callback=null,k=x.priorityLevel;var De=fe(x.expirationTime<=K);K=r.unstable_now(),typeof De=="function"?x.callback=De:x===a(m)&&c(m),w(K)}else c(m);x=a(m)}if(x!==null)var We=!0;else{var oe=a(b);oe!==null&&he(N,oe.startTime-K),We=!1}return We}finally{x=null,k=Re,F=!1}}var H=!1,Y=null,O=-1,ee=5,Ae=-1;function ce(){return!(r.unstable_now()-Ae<ee)}function ge(){if(Y!==null){var se=r.unstable_now();Ae=se;var K=!0;try{K=Y(!0,se)}finally{K?me():(H=!1,Y=null)}}else H=!1}var me;if(typeof q=="function")me=function(){q(ge)};else if(typeof MessageChannel<"u"){var Me=new MessageChannel,ue=Me.port2;Me.port1.onmessage=ge,me=function(){ue.postMessage(null)}}else me=function(){Q(ge,0)};function I(se){Y=se,H||(H=!0,me())}function he(se,K){O=Q(function(){se(r.unstable_now())},K)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(se){se.callback=null},r.unstable_continueExecution=function(){C||F||(C=!0,I(V))},r.unstable_forceFrameRate=function(se){0>se||125<se?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ee=0<se?Math.floor(1e3/se):5},r.unstable_getCurrentPriorityLevel=function(){return k},r.unstable_getFirstCallbackNode=function(){return a(m)},r.unstable_next=function(se){switch(k){case 1:case 2:case 3:var K=3;break;default:K=k}var Re=k;k=K;try{return se()}finally{k=Re}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(se,K){switch(se){case 1:case 2:case 3:case 4:case 5:break;default:se=3}var Re=k;k=se;try{return K()}finally{k=Re}},r.unstable_scheduleCallback=function(se,K,Re){var fe=r.unstable_now();switch(typeof Re=="object"&&Re!==null?(Re=Re.delay,Re=typeof Re=="number"&&0<Re?fe+Re:fe):Re=fe,se){case 1:var De=-1;break;case 2:De=250;break;case 5:De=1073741823;break;case 4:De=1e4;break;default:De=5e3}return De=Re+De,se={id:T++,callback:K,priorityLevel:se,startTime:Re,expirationTime:De,sortIndex:-1},Re>fe?(se.sortIndex=Re,n(b,se),a(m)===null&&se===a(b)&&(z?(J(O),O=-1):z=!0,he(N,Re-fe))):(se.sortIndex=De,n(m,se),C||F||(C=!0,I(V))),se},r.unstable_shouldYield=ce,r.unstable_wrapCallback=function(se){var K=k;return function(){var Re=k;k=K;try{return se.apply(this,arguments)}finally{k=Re}}}})(scheduler_production_min)),scheduler_production_min}var hasRequiredScheduler;function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler.exports=requireScheduler_production_min()),scheduler.exports}var hasRequiredReactDom_production_min;function requireReactDom_production_min(){if(hasRequiredReactDom_production_min)return reactDom_production_min;hasRequiredReactDom_production_min=1;var r=requireReact(),n=requireScheduler();function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,o=1;o<arguments.length;o++)t+="&args[]="+encodeURIComponent(arguments[o]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var c=new Set,d={};function R(e,t){u(e,t),u(e+"Capture",t)}function u(e,t){for(d[e]=t,e=0;e<t.length;e++)c.add(t[e])}var v=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),m=Object.prototype.hasOwnProperty,b=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,T={},x={};function k(e){return m.call(x,e)?!0:m.call(T,e)?!1:b.test(e)?x[e]=!0:(T[e]=!0,!1)}function F(e,t,o,f){if(o!==null&&o.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return f?!1:o!==null?!o.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function C(e,t,o,f){if(t===null||typeof t>"u"||F(e,t,o,f))return!0;if(f)return!1;if(o!==null)switch(o.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function z(e,t,o,f,D,B,ie){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=f,this.attributeNamespace=D,this.mustUseProperty=o,this.propertyName=e,this.type=t,this.sanitizeURL=B,this.removeEmptyString=ie}var Q={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Q[e]=new z(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Q[t]=new z(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){Q[e]=new z(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Q[e]=new z(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Q[e]=new z(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){Q[e]=new z(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){Q[e]=new z(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){Q[e]=new z(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){Q[e]=new z(e,5,!1,e.toLowerCase(),null,!1,!1)});var J=/[\-:]([a-z])/g;function q(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(J,q);Q[t]=new z(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(J,q);Q[t]=new z(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(J,q);Q[t]=new z(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){Q[e]=new z(e,1,!1,e.toLowerCase(),null,!1,!1)}),Q.xlinkHref=new z("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){Q[e]=new z(e,1,!1,e.toLowerCase(),null,!0,!0)});function w(e,t,o,f){var D=Q.hasOwnProperty(t)?Q[t]:null;(D!==null?D.type!==0:f||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(C(t,o,D,f)&&(o=null),f||D===null?k(t)&&(o===null?e.removeAttribute(t):e.setAttribute(t,""+o)):D.mustUseProperty?e[D.propertyName]=o===null?D.type===3?!1:"":o:(t=D.attributeName,f=D.attributeNamespace,o===null?e.removeAttribute(t):(D=D.type,o=D===3||D===4&&o===!0?"":""+o,f?e.setAttributeNS(f,t,o):e.setAttribute(t,o))))}var N=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,V=Symbol.for("react.element"),H=Symbol.for("react.portal"),Y=Symbol.for("react.fragment"),O=Symbol.for("react.strict_mode"),ee=Symbol.for("react.profiler"),Ae=Symbol.for("react.provider"),ce=Symbol.for("react.context"),ge=Symbol.for("react.forward_ref"),me=Symbol.for("react.suspense"),Me=Symbol.for("react.suspense_list"),ue=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),he=Symbol.for("react.offscreen"),se=Symbol.iterator;function K(e){return e===null||typeof e!="object"?null:(e=se&&e[se]||e["@@iterator"],typeof e=="function"?e:null)}var Re=Object.assign,fe;function De(e){if(fe===void 0)try{throw Error()}catch(o){var t=o.stack.trim().match(/\n( *(at )?)/);fe=t&&t[1]||""}return`
`+fe+e}var We=!1;function oe(e,t){if(!e||We)return"";We=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(Ye){var f=Ye}Reflect.construct(e,[],t)}else{try{t.call()}catch(Ye){f=Ye}e.call(t.prototype)}else{try{throw Error()}catch(Ye){f=Ye}e()}}catch(Ye){if(Ye&&f&&typeof Ye.stack=="string"){for(var D=Ye.stack.split(`
`),B=f.stack.split(`
`),ie=D.length-1,Ce=B.length-1;1<=ie&&0<=Ce&&D[ie]!==B[Ce];)Ce--;for(;1<=ie&&0<=Ce;ie--,Ce--)if(D[ie]!==B[Ce]){if(ie!==1||Ce!==1)do if(ie--,Ce--,0>Ce||D[ie]!==B[Ce]){var Fe=`
`+D[ie].replace(" at new "," at ");return e.displayName&&Fe.includes("<anonymous>")&&(Fe=Fe.replace("<anonymous>",e.displayName)),Fe}while(1<=ie&&0<=Ce);break}}}finally{We=!1,Error.prepareStackTrace=o}return(e=e?e.displayName||e.name:"")?De(e):""}function Ee(e){switch(e.tag){case 5:return De(e.type);case 16:return De("Lazy");case 13:return De("Suspense");case 19:return De("SuspenseList");case 0:case 2:case 15:return e=oe(e.type,!1),e;case 11:return e=oe(e.type.render,!1),e;case 1:return e=oe(e.type,!0),e;default:return""}}function He(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Y:return"Fragment";case H:return"Portal";case ee:return"Profiler";case O:return"StrictMode";case me:return"Suspense";case Me:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case ce:return(e.displayName||"Context")+".Consumer";case Ae:return(e._context.displayName||"Context")+".Provider";case ge:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case ue:return t=e.displayName||null,t!==null?t:He(e.type)||"Memo";case I:t=e._payload,e=e._init;try{return He(e(t))}catch{}}return null}function Ue(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return He(t);case 8:return t===O?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Ie(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function rt(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function st(e){var t=rt(e)?"checked":"value",o=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),f=""+e[t];if(!e.hasOwnProperty(t)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var D=o.get,B=o.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return D.call(this)},set:function(ie){f=""+ie,B.call(this,ie)}}),Object.defineProperty(e,t,{enumerable:o.enumerable}),{getValue:function(){return f},setValue:function(ie){f=""+ie},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function at(e){e._valueTracker||(e._valueTracker=st(e))}function Ft(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var o=t.getValue(),f="";return e&&(f=rt(e)?e.checked?"true":"false":e.value),e=f,e!==o?(t.setValue(e),!0):!1}function At(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function or(e,t){var o=t.checked;return Re({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:o??e._wrapperState.initialChecked})}function ar(e,t){var o=t.defaultValue==null?"":t.defaultValue,f=t.checked!=null?t.checked:t.defaultChecked;o=Ie(t.value!=null?t.value:o),e._wrapperState={initialChecked:f,initialValue:o,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function kr(e,t){t=t.checked,t!=null&&w(e,"checked",t,!1)}function Er(e,t){kr(e,t);var o=Ie(t.value),f=t.type;if(o!=null)f==="number"?(o===0&&e.value===""||e.value!=o)&&(e.value=""+o):e.value!==""+o&&(e.value=""+o);else if(f==="submit"||f==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?vr(e,t.type,o):t.hasOwnProperty("defaultValue")&&vr(e,t.type,Ie(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function pr(e,t,o){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var f=t.type;if(!(f!=="submit"&&f!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,o||t===e.value||(e.value=t),e.defaultValue=t}o=e.name,o!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,o!==""&&(e.name=o)}function vr(e,t,o){(t!=="number"||At(e.ownerDocument)!==e)&&(o==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+o&&(e.defaultValue=""+o))}var xr=Array.isArray;function fi(e,t,o,f){if(e=e.options,t){t={};for(var D=0;D<o.length;D++)t["$"+o[D]]=!0;for(o=0;o<e.length;o++)D=t.hasOwnProperty("$"+e[o].value),e[o].selected!==D&&(e[o].selected=D),D&&f&&(e[o].defaultSelected=!0)}else{for(o=""+Ie(o),t=null,D=0;D<e.length;D++){if(e[D].value===o){e[D].selected=!0,f&&(e[D].defaultSelected=!0);return}t!==null||e[D].disabled||(t=e[D])}t!==null&&(t.selected=!0)}}function Rr(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(a(91));return Re({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Ir(e,t){var o=t.value;if(o==null){if(o=t.children,t=t.defaultValue,o!=null){if(t!=null)throw Error(a(92));if(xr(o)){if(1<o.length)throw Error(a(93));o=o[0]}t=o}t==null&&(t=""),o=t}e._wrapperState={initialValue:Ie(o)}}function Di(e,t){var o=Ie(t.value),f=Ie(t.defaultValue);o!=null&&(o=""+o,o!==e.value&&(e.value=o),t.defaultValue==null&&e.defaultValue!==o&&(e.defaultValue=o)),f!=null&&(e.defaultValue=""+f)}function wi(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Hi(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function pe(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Hi(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Se,Le=(function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,o,f,D){MSApp.execUnsafeLocalFunction(function(){return e(t,o,f,D)})}:e})(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Se=Se||document.createElement("div"),Se.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Se.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function dt(e,t){if(t){var o=e.firstChild;if(o&&o===e.lastChild&&o.nodeType===3){o.nodeValue=t;return}}e.textContent=t}var nt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},zt=["Webkit","ms","Moz","O"];Object.keys(nt).forEach(function(e){zt.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),nt[t]=nt[e]})});function ht(e,t,o){return t==null||typeof t=="boolean"||t===""?"":o||typeof t!="number"||t===0||nt.hasOwnProperty(e)&&nt[e]?(""+t).trim():t+"px"}function Lt(e,t){e=e.style;for(var o in t)if(t.hasOwnProperty(o)){var f=o.indexOf("--")===0,D=ht(o,t[o],f);o==="float"&&(o="cssFloat"),f?e.setProperty(o,D):e[o]=D}}var Ut=Re({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function It(e,t){if(t){if(Ut[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(a(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(a(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(t.style!=null&&typeof t.style!="object")throw Error(a(62))}}function mr(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var li=null;function Ai(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var ui=null,gi=null,jr=null;function Lr(e){if(e=Is(e)){if(typeof ui!="function")throw Error(a(280));var t=e.stateNode;t&&(t=ro(t),ui(e.stateNode,e.type,t))}}function Dr(e){gi?jr?jr.push(e):jr=[e]:gi=e}function rr(){if(gi){var e=gi,t=jr;if(jr=gi=null,Lr(e),t)for(e=0;e<t.length;e++)Lr(t[e])}}function vi(e,t){return e(t)}function bi(){}var $i=!1;function Ci(e,t,o){if($i)return e(t,o);$i=!0;try{return vi(e,t,o)}finally{$i=!1,(gi!==null||jr!==null)&&(bi(),rr())}}function Ni(e,t){var o=e.stateNode;if(o===null)return null;var f=ro(o);if(f===null)return null;o=f[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(e=e.type,f=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!f;break e;default:e=!1}if(e)return null;if(o&&typeof o!="function")throw Error(a(231,t,typeof o));return o}var Ti=!1;if(v)try{var pi={};Object.defineProperty(pi,"passive",{get:function(){Ti=!0}}),window.addEventListener("test",pi,pi),window.removeEventListener("test",pi,pi)}catch{Ti=!1}function Br(e,t,o,f,D,B,ie,Ce,Fe){var Ye=Array.prototype.slice.call(arguments,3);try{t.apply(o,Ye)}catch(xt){this.onError(xt)}}var Zr=!1,Vi=null,yi=!1,Wi=null,tn={onError:function(e){Zr=!0,Vi=e}};function on(e,t,o,f,D,B,ie,Ce,Fe){Zr=!1,Vi=null,Br.apply(tn,arguments)}function ur(e,t,o,f,D,B,ie,Ce,Fe){if(on.apply(this,arguments),Zr){if(Zr){var Ye=Vi;Zr=!1,Vi=null}else throw Error(a(198));yi||(yi=!0,Wi=Ye)}}function Gr(e){var t=e,o=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(o=t.return),e=t.return;while(e)}return t.tag===3?o:null}function $r(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function qi(e){if(Gr(e)!==e)throw Error(a(188))}function Bt(e){var t=e.alternate;if(!t){if(t=Gr(e),t===null)throw Error(a(188));return t!==e?null:e}for(var o=e,f=t;;){var D=o.return;if(D===null)break;var B=D.alternate;if(B===null){if(f=D.return,f!==null){o=f;continue}break}if(D.child===B.child){for(B=D.child;B;){if(B===o)return qi(D),e;if(B===f)return qi(D),t;B=B.sibling}throw Error(a(188))}if(o.return!==f.return)o=D,f=B;else{for(var ie=!1,Ce=D.child;Ce;){if(Ce===o){ie=!0,o=D,f=B;break}if(Ce===f){ie=!0,f=D,o=B;break}Ce=Ce.sibling}if(!ie){for(Ce=B.child;Ce;){if(Ce===o){ie=!0,o=B,f=D;break}if(Ce===f){ie=!0,f=B,o=D;break}Ce=Ce.sibling}if(!ie)throw Error(a(189))}}if(o.alternate!==f)throw Error(a(190))}if(o.tag!==3)throw Error(a(188));return o.stateNode.current===o?e:t}function _(e){return e=Bt(e),e!==null?ne(e):null}function ne(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=ne(e);if(t!==null)return t;e=e.sibling}return null}var xe=n.unstable_scheduleCallback,Ve=n.unstable_cancelCallback,Oe=n.unstable_shouldYield,yt=n.unstable_requestPaint,lt=n.unstable_now,mt=n.unstable_getCurrentPriorityLevel,Mt=n.unstable_ImmediatePriority,Pt=n.unstable_UserBlockingPriority,Ot=n.unstable_NormalPriority,gr=n.unstable_LowPriority,Zt=n.unstable_IdlePriority,Ar=null,Cr=null;function Ur(e){if(Cr&&typeof Cr.onCommitFiberRoot=="function")try{Cr.onCommitFiberRoot(Ar,e,void 0,(e.current.flags&128)===128)}catch{}}var _r=Math.clz32?Math.clz32:Mi,Or=Math.log,wr=Math.LN2;function Mi(e){return e>>>=0,e===0?32:31-(Or(e)/wr|0)|0}var Qt=64,ri=4194304;function ae(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function i(e,t){var o=e.pendingLanes;if(o===0)return 0;var f=0,D=e.suspendedLanes,B=e.pingedLanes,ie=o&268435455;if(ie!==0){var Ce=ie&~D;Ce!==0?f=ae(Ce):(B&=ie,B!==0&&(f=ae(B)))}else ie=o&~D,ie!==0?f=ae(ie):B!==0&&(f=ae(B));if(f===0)return 0;if(t!==0&&t!==f&&(t&D)===0&&(D=f&-f,B=t&-t,D>=B||D===16&&(B&4194240)!==0))return t;if((f&4)!==0&&(f|=o&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=f;0<t;)o=31-_r(t),D=1<<o,f|=e[o],t&=~D;return f}function s(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function l(e,t){for(var o=e.suspendedLanes,f=e.pingedLanes,D=e.expirationTimes,B=e.pendingLanes;0<B;){var ie=31-_r(B),Ce=1<<ie,Fe=D[ie];Fe===-1?((Ce&o)===0||(Ce&f)!==0)&&(D[ie]=s(Ce,t)):Fe<=t&&(e.expiredLanes|=Ce),B&=~Ce}}function h(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function E(){var e=Qt;return Qt<<=1,(Qt&4194240)===0&&(Qt=64),e}function g(e){for(var t=[],o=0;31>o;o++)t.push(e);return t}function A(e,t,o){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-_r(t),e[t]=o}function M(e,t){var o=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var f=e.eventTimes;for(e=e.expirationTimes;0<o;){var D=31-_r(o),B=1<<D;t[D]=0,f[D]=-1,e[D]=-1,o&=~B}}function S(e,t){var o=e.entangledLanes|=t;for(e=e.entanglements;o;){var f=31-_r(o),D=1<<f;D&t|e[f]&t&&(e[f]|=t),o&=~D}}var P=0;function L(e){return e&=-e,1<e?4<e?(e&268435455)!==0?16:536870912:4:1}var X,U,j,W,G,Z=!1,te=[],re=null,de=null,le=null,ye=new Map,Pe=new Map,Te=[],ke="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function we(e,t){switch(e){case"focusin":case"focusout":re=null;break;case"dragenter":case"dragleave":de=null;break;case"mouseover":case"mouseout":le=null;break;case"pointerover":case"pointerout":ye.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pe.delete(t.pointerId)}}function Ge(e,t,o,f,D,B){return e===null||e.nativeEvent!==B?(e={blockedOn:t,domEventName:o,eventSystemFlags:f,nativeEvent:B,targetContainers:[D]},t!==null&&(t=Is(t),t!==null&&U(t)),e):(e.eventSystemFlags|=f,t=e.targetContainers,D!==null&&t.indexOf(D)===-1&&t.push(D),e)}function Je(e,t,o,f,D){switch(t){case"focusin":return re=Ge(re,e,t,o,f,D),!0;case"dragenter":return de=Ge(de,e,t,o,f,D),!0;case"mouseover":return le=Ge(le,e,t,o,f,D),!0;case"pointerover":var B=D.pointerId;return ye.set(B,Ge(ye.get(B)||null,e,t,o,f,D)),!0;case"gotpointercapture":return B=D.pointerId,Pe.set(B,Ge(Pe.get(B)||null,e,t,o,f,D)),!0}return!1}function tt(e){var t=$n(e.target);if(t!==null){var o=Gr(t);if(o!==null){if(t=o.tag,t===13){if(t=$r(o),t!==null){e.blockedOn=t,G(e.priority,function(){j(o)});return}}else if(t===3&&o.stateNode.current.memoizedState.isDehydrated){e.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ze(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var o=it(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(o===null){o=e.nativeEvent;var f=new o.constructor(o.type,o);li=f,o.target.dispatchEvent(f),li=null}else return t=Is(o),t!==null&&U(t),e.blockedOn=o,!1;t.shift()}return!0}function ut(e,t,o){Ze(e)&&o.delete(t)}function ft(){Z=!1,re!==null&&Ze(re)&&(re=null),de!==null&&Ze(de)&&(de=null),le!==null&&Ze(le)&&(le=null),ye.forEach(ut),Pe.forEach(ut)}function Qe(e,t){e.blockedOn===t&&(e.blockedOn=null,Z||(Z=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,ft)))}function pt(e){function t(D){return Qe(D,e)}if(0<te.length){Qe(te[0],e);for(var o=1;o<te.length;o++){var f=te[o];f.blockedOn===e&&(f.blockedOn=null)}}for(re!==null&&Qe(re,e),de!==null&&Qe(de,e),le!==null&&Qe(le,e),ye.forEach(t),Pe.forEach(t),o=0;o<Te.length;o++)f=Te[o],f.blockedOn===e&&(f.blockedOn=null);for(;0<Te.length&&(o=Te[0],o.blockedOn===null);)tt(o),o.blockedOn===null&&Te.shift()}var Be=N.ReactCurrentBatchConfig,et=!0;function St(e,t,o,f){var D=P,B=Be.transition;Be.transition=null;try{P=1,wt(e,t,o,f)}finally{P=D,Be.transition=B}}function ot(e,t,o,f){var D=P,B=Be.transition;Be.transition=null;try{P=4,wt(e,t,o,f)}finally{P=D,Be.transition=B}}function wt(e,t,o,f){if(et){var D=it(e,t,o,f);if(D===null)Zo(e,t,f,Et,o),we(e,f);else if(Je(D,e,t,o,f))f.stopPropagation();else if(we(e,f),t&4&&-1<ke.indexOf(e)){for(;D!==null;){var B=Is(D);if(B!==null&&X(B),B=it(e,t,o,f),B===null&&Zo(e,t,f,Et,o),B===D)break;D=B}D!==null&&f.stopPropagation()}else Zo(e,t,f,null,o)}}var Et=null;function it(e,t,o,f){if(Et=null,e=Ai(f),e=$n(e),e!==null)if(t=Gr(e),t===null)e=null;else if(o=t.tag,o===13){if(e=$r(t),e!==null)return e;e=null}else if(o===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Et=e,null}function Rt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(mt()){case Mt:return 1;case Pt:return 4;case Ot:case gr:return 16;case Zt:return 536870912;default:return 16}default:return 16}}var Ht=null,kt=null,ct=null;function Jt(){if(ct)return ct;var e,t=kt,o=t.length,f,D="value"in Ht?Ht.value:Ht.textContent,B=D.length;for(e=0;e<o&&t[e]===D[e];e++);var ie=o-e;for(f=1;f<=ie&&t[o-f]===D[B-f];f++);return ct=D.slice(e,1<f?1-f:void 0)}function Nt(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function qt(){return!0}function Vt(){return!1}function Kt(e){function t(o,f,D,B,ie){this._reactName=o,this._targetInst=D,this.type=f,this.nativeEvent=B,this.target=ie,this.currentTarget=null;for(var Ce in e)e.hasOwnProperty(Ce)&&(o=e[Ce],this[Ce]=o?o(B):B[Ce]);return this.isDefaultPrevented=(B.defaultPrevented!=null?B.defaultPrevented:B.returnValue===!1)?qt:Vt,this.isPropagationStopped=Vt,this}return Re(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=qt)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=qt)},persist:function(){},isPersistent:qt}),t}var yr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Fr=Kt(yr),Tr=Re({},yr,{view:0,detail:0}),ii=Kt(Tr),Wr,br,Xr,ci=Re({},Tr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ke,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Xr&&(Xr&&e.type==="mousemove"?(Wr=e.screenX-Xr.screenX,br=e.screenY-Xr.screenY):br=Wr=0,Xr=e),Wr)},movementY:function(e){return"movementY"in e?e.movementY:br}}),ni=Kt(ci),hi=Re({},ci,{dataTransfer:0}),zi=Kt(hi),xi=Re({},Tr,{relatedTarget:0}),Ii=Kt(xi),Hr=Re({},yr,{animationName:0,elapsedTime:0,pseudoElement:0}),Kr=Kt(Hr),qr=Re({},yr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),ei=Kt(qr),p=Re({},yr,{data:0}),$=Kt(p),y={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},be={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_e={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ve(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=_e[e])?!!t[e]:!1}function Ke(){return ve}var ze=Re({},Tr,{key:function(e){if(e.key){var t=y[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Nt(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?be[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ke,charCode:function(e){return e.type==="keypress"?Nt(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Nt(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),gt=Kt(ze),Ne=Re({},ci,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$e=Kt(Ne),dr=Re({},Tr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ke}),Wt=Kt(dr),_t=Re({},yr,{propertyName:0,elapsedTime:0,pseudoElement:0}),si=Kt(_t),Mr=Re({},ci,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),er=Kt(Mr),zr=[9,13,27,32],lr=v&&"CompositionEvent"in window,Ct=null;v&&"documentMode"in document&&(Ct=document.documentMode);var sr=v&&"TextEvent"in window&&!Ct,Pr=v&&(!lr||Ct&&8<Ct&&11>=Ct),Dt=" ",Sr=!1;function cr(e,t){switch(e){case"keyup":return zr.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function tr(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var fr=!1;function Li(e,t){switch(e){case"compositionend":return tr(t);case"keypress":return t.which!==32?null:(Sr=!0,Dt);case"textInput":return e=t.data,e===Dt&&Sr?null:e;default:return null}}function Wn(e,t){if(fr)return e==="compositionend"||!lr&&cr(e,t)?(e=Jt(),ct=kt=Ht=null,fr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Pr&&t.locale!=="ko"?null:t.data;default:return null}}var os={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Xn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!os[e.type]:t==="textarea"}function Kn(e,t,o,f){Dr(f),t=Js(t,"onChange"),0<t.length&&(o=new Fr("onChange","change",null,o,f),e.push({event:o,listeners:t}))}var Cs=null,Ts=null;function lc(e){El(e,0)}function qs(e){var t=hs(e);if(Ft(t))return e}function uc(e,t){if(e==="change")return t}var al=!1;if(v){var Uo;if(v){var Go="oninput"in document;if(!Go){var ll=document.createElement("div");ll.setAttribute("oninput","return;"),Go=typeof ll.oninput=="function"}Uo=Go}else Uo=!1;al=Uo&&(!document.documentMode||9<document.documentMode)}function ul(){Cs&&(Cs.detachEvent("onpropertychange",cl),Ts=Cs=null)}function cl(e){if(e.propertyName==="value"&&qs(Ts)){var t=[];Kn(t,Ts,e,Ai(e)),Ci(lc,t)}}function cc(e,t,o){e==="focusin"?(ul(),Cs=t,Ts=o,Cs.attachEvent("onpropertychange",cl)):e==="focusout"&&ul()}function hc(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return qs(Ts)}function dc(e,t){if(e==="click")return qs(t)}function fc(e,t){if(e==="input"||e==="change")return qs(t)}function pc(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var fn=typeof Object.is=="function"?Object.is:pc;function Ms(e,t){if(fn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var o=Object.keys(e),f=Object.keys(t);if(o.length!==f.length)return!1;for(f=0;f<o.length;f++){var D=o[f];if(!m.call(t,D)||!fn(e[D],t[D]))return!1}return!0}function hl(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function dl(e,t){var o=hl(e);e=0;for(var f;o;){if(o.nodeType===3){if(f=e+o.textContent.length,e<=t&&f>=t)return{node:o,offset:t-e};e=f}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=hl(o)}}function fl(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?fl(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function pl(){for(var e=window,t=At();t instanceof e.HTMLIFrameElement;){try{var o=typeof t.contentWindow.location.href=="string"}catch{o=!1}if(o)e=t.contentWindow;else break;t=At(e.document)}return t}function Ho(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function mc(e){var t=pl(),o=e.focusedElem,f=e.selectionRange;if(t!==o&&o&&o.ownerDocument&&fl(o.ownerDocument.documentElement,o)){if(f!==null&&Ho(o)){if(t=f.start,e=f.end,e===void 0&&(e=t),"selectionStart"in o)o.selectionStart=t,o.selectionEnd=Math.min(e,o.value.length);else if(e=(t=o.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var D=o.textContent.length,B=Math.min(f.start,D);f=f.end===void 0?B:Math.min(f.end,D),!e.extend&&B>f&&(D=f,f=B,B=D),D=dl(o,B);var ie=dl(o,f);D&&ie&&(e.rangeCount!==1||e.anchorNode!==D.node||e.anchorOffset!==D.offset||e.focusNode!==ie.node||e.focusOffset!==ie.offset)&&(t=t.createRange(),t.setStart(D.node,D.offset),e.removeAllRanges(),B>f?(e.addRange(t),e.extend(ie.node,ie.offset)):(t.setEnd(ie.node,ie.offset),e.addRange(t)))}}for(t=[],e=o;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<t.length;o++)e=t[o],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var gc=v&&"documentMode"in document&&11>=document.documentMode,as=null,Wo=null,ks=null,Xo=!1;function ml(e,t,o){var f=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Xo||as==null||as!==At(f)||(f=as,"selectionStart"in f&&Ho(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),ks&&Ms(ks,f)||(ks=f,f=Js(Wo,"onSelect"),0<f.length&&(t=new Fr("onSelect","select",null,t,o),e.push({event:t,listeners:f}),t.target=as)))}function Ys(e,t){var o={};return o[e.toLowerCase()]=t.toLowerCase(),o["Webkit"+e]="webkit"+t,o["Moz"+e]="moz"+t,o}var ls={animationend:Ys("Animation","AnimationEnd"),animationiteration:Ys("Animation","AnimationIteration"),animationstart:Ys("Animation","AnimationStart"),transitionend:Ys("Transition","TransitionEnd")},Ko={},gl={};v&&(gl=document.createElement("div").style,"AnimationEvent"in window||(delete ls.animationend.animation,delete ls.animationiteration.animation,delete ls.animationstart.animation),"TransitionEvent"in window||delete ls.transitionend.transition);function Zs(e){if(Ko[e])return Ko[e];if(!ls[e])return e;var t=ls[e],o;for(o in t)if(t.hasOwnProperty(o)&&o in gl)return Ko[e]=t[o];return e}var vl=Zs("animationend"),yl=Zs("animationiteration"),xl=Zs("animationstart"),_l=Zs("transitionend"),wl=new Map,bl="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pn(e,t){wl.set(e,t),R(t,[e])}for(var $o=0;$o<bl.length;$o++){var qo=bl[$o],vc=qo.toLowerCase(),yc=qo[0].toUpperCase()+qo.slice(1);Pn(vc,"on"+yc)}Pn(vl,"onAnimationEnd"),Pn(yl,"onAnimationIteration"),Pn(xl,"onAnimationStart"),Pn("dblclick","onDoubleClick"),Pn("focusin","onFocus"),Pn("focusout","onBlur"),Pn(_l,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),R("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),R("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),R("onBeforeInput",["compositionend","keypress","textInput","paste"]),R("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),R("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),R("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),xc=new Set("cancel close invalid load scroll toggle".split(" ").concat(Rs));function Sl(e,t,o){var f=e.type||"unknown-event";e.currentTarget=o,ur(f,t,void 0,e),e.currentTarget=null}function El(e,t){t=(t&4)!==0;for(var o=0;o<e.length;o++){var f=e[o],D=f.event;f=f.listeners;e:{var B=void 0;if(t)for(var ie=f.length-1;0<=ie;ie--){var Ce=f[ie],Fe=Ce.instance,Ye=Ce.currentTarget;if(Ce=Ce.listener,Fe!==B&&D.isPropagationStopped())break e;Sl(D,Ce,Ye),B=Fe}else for(ie=0;ie<f.length;ie++){if(Ce=f[ie],Fe=Ce.instance,Ye=Ce.currentTarget,Ce=Ce.listener,Fe!==B&&D.isPropagationStopped())break e;Sl(D,Ce,Ye),B=Fe}}}if(yi)throw e=Wi,yi=!1,Wi=null,e}function Qr(e,t){var o=t[ia];o===void 0&&(o=t[ia]=new Set);var f=e+"__bubble";o.has(f)||(Al(t,e,2,!1),o.add(f))}function Yo(e,t,o){var f=0;t&&(f|=4),Al(o,e,f,t)}var Qs="_reactListening"+Math.random().toString(36).slice(2);function Ps(e){if(!e[Qs]){e[Qs]=!0,c.forEach(function(o){o!=="selectionchange"&&(xc.has(o)||Yo(o,!1,e),Yo(o,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Qs]||(t[Qs]=!0,Yo("selectionchange",!1,t))}}function Al(e,t,o,f){switch(Rt(t)){case 1:var D=St;break;case 4:D=ot;break;default:D=wt}o=D.bind(null,t,o,e),D=void 0,!Ti||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(D=!0),f?D!==void 0?e.addEventListener(t,o,{capture:!0,passive:D}):e.addEventListener(t,o,!0):D!==void 0?e.addEventListener(t,o,{passive:D}):e.addEventListener(t,o,!1)}function Zo(e,t,o,f,D){var B=f;if((t&1)===0&&(t&2)===0&&f!==null)e:for(;;){if(f===null)return;var ie=f.tag;if(ie===3||ie===4){var Ce=f.stateNode.containerInfo;if(Ce===D||Ce.nodeType===8&&Ce.parentNode===D)break;if(ie===4)for(ie=f.return;ie!==null;){var Fe=ie.tag;if((Fe===3||Fe===4)&&(Fe=ie.stateNode.containerInfo,Fe===D||Fe.nodeType===8&&Fe.parentNode===D))return;ie=ie.return}for(;Ce!==null;){if(ie=$n(Ce),ie===null)return;if(Fe=ie.tag,Fe===5||Fe===6){f=B=ie;continue e}Ce=Ce.parentNode}}f=f.return}Ci(function(){var Ye=B,xt=Ai(o),bt=[];e:{var vt=wl.get(e);if(vt!==void 0){var jt=Fr,Xt=e;switch(e){case"keypress":if(Nt(o)===0)break e;case"keydown":case"keyup":jt=gt;break;case"focusin":Xt="focus",jt=Ii;break;case"focusout":Xt="blur",jt=Ii;break;case"beforeblur":case"afterblur":jt=Ii;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":jt=ni;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":jt=zi;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":jt=Wt;break;case vl:case yl:case xl:jt=Kr;break;case _l:jt=si;break;case"scroll":jt=ii;break;case"wheel":jt=er;break;case"copy":case"cut":case"paste":jt=ei;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":jt=$e}var $t=(t&4)!==0,mi=!$t&&e==="scroll",Xe=$t?vt!==null?vt+"Capture":null:vt;$t=[];for(var je=Ye,qe;je!==null;){qe=je;var Tt=qe.stateNode;if(qe.tag===5&&Tt!==null&&(qe=Tt,Xe!==null&&(Tt=Ni(je,Xe),Tt!=null&&$t.push(Ds(je,Tt,qe)))),mi)break;je=je.return}0<$t.length&&(vt=new jt(vt,Xt,null,o,xt),bt.push({event:vt,listeners:$t}))}}if((t&7)===0){e:{if(vt=e==="mouseover"||e==="pointerover",jt=e==="mouseout"||e==="pointerout",vt&&o!==li&&(Xt=o.relatedTarget||o.fromElement)&&($n(Xt)||Xt[Sn]))break e;if((jt||vt)&&(vt=xt.window===xt?xt:(vt=xt.ownerDocument)?vt.defaultView||vt.parentWindow:window,jt?(Xt=o.relatedTarget||o.toElement,jt=Ye,Xt=Xt?$n(Xt):null,Xt!==null&&(mi=Gr(Xt),Xt!==mi||Xt.tag!==5&&Xt.tag!==6)&&(Xt=null)):(jt=null,Xt=Ye),jt!==Xt)){if($t=ni,Tt="onMouseLeave",Xe="onMouseEnter",je="mouse",(e==="pointerout"||e==="pointerover")&&($t=$e,Tt="onPointerLeave",Xe="onPointerEnter",je="pointer"),mi=jt==null?vt:hs(jt),qe=Xt==null?vt:hs(Xt),vt=new $t(Tt,je+"leave",jt,o,xt),vt.target=mi,vt.relatedTarget=qe,Tt=null,$n(xt)===Ye&&($t=new $t(Xe,je+"enter",Xt,o,xt),$t.target=qe,$t.relatedTarget=mi,Tt=$t),mi=Tt,jt&&Xt)t:{for($t=jt,Xe=Xt,je=0,qe=$t;qe;qe=us(qe))je++;for(qe=0,Tt=Xe;Tt;Tt=us(Tt))qe++;for(;0<je-qe;)$t=us($t),je--;for(;0<qe-je;)Xe=us(Xe),qe--;for(;je--;){if($t===Xe||Xe!==null&&$t===Xe.alternate)break t;$t=us($t),Xe=us(Xe)}$t=null}else $t=null;jt!==null&&Cl(bt,vt,jt,$t,!1),Xt!==null&&mi!==null&&Cl(bt,mi,Xt,$t,!0)}}e:{if(vt=Ye?hs(Ye):window,jt=vt.nodeName&&vt.nodeName.toLowerCase(),jt==="select"||jt==="input"&&vt.type==="file")var Yt=uc;else if(Xn(vt))if(al)Yt=fc;else{Yt=hc;var ir=cc}else(jt=vt.nodeName)&&jt.toLowerCase()==="input"&&(vt.type==="checkbox"||vt.type==="radio")&&(Yt=dc);if(Yt&&(Yt=Yt(e,Ye))){Kn(bt,Yt,o,xt);break e}ir&&ir(e,vt,Ye),e==="focusout"&&(ir=vt._wrapperState)&&ir.controlled&&vt.type==="number"&&vr(vt,"number",vt.value)}switch(ir=Ye?hs(Ye):window,e){case"focusin":(Xn(ir)||ir.contentEditable==="true")&&(as=ir,Wo=Ye,ks=null);break;case"focusout":ks=Wo=as=null;break;case"mousedown":Xo=!0;break;case"contextmenu":case"mouseup":case"dragend":Xo=!1,ml(bt,o,xt);break;case"selectionchange":if(gc)break;case"keydown":case"keyup":ml(bt,o,xt)}var nr;if(lr)e:{switch(e){case"compositionstart":var hr="onCompositionStart";break e;case"compositionend":hr="onCompositionEnd";break e;case"compositionupdate":hr="onCompositionUpdate";break e}hr=void 0}else fr?cr(e,o)&&(hr="onCompositionEnd"):e==="keydown"&&o.keyCode===229&&(hr="onCompositionStart");hr&&(Pr&&o.locale!=="ko"&&(fr||hr!=="onCompositionStart"?hr==="onCompositionEnd"&&fr&&(nr=Jt()):(Ht=xt,kt="value"in Ht?Ht.value:Ht.textContent,fr=!0)),ir=Js(Ye,hr),0<ir.length&&(hr=new $(hr,e,null,o,xt),bt.push({event:hr,listeners:ir}),nr?hr.data=nr:(nr=tr(o),nr!==null&&(hr.data=nr)))),(nr=sr?Li(e,o):Wn(e,o))&&(Ye=Js(Ye,"onBeforeInput"),0<Ye.length&&(xt=new $("onBeforeInput","beforeinput",null,o,xt),bt.push({event:xt,listeners:Ye}),xt.data=nr))}El(bt,t)})}function Ds(e,t,o){return{instance:e,listener:t,currentTarget:o}}function Js(e,t){for(var o=t+"Capture",f=[];e!==null;){var D=e,B=D.stateNode;D.tag===5&&B!==null&&(D=B,B=Ni(e,o),B!=null&&f.unshift(Ds(e,B,D)),B=Ni(e,t),B!=null&&f.push(Ds(e,B,D))),e=e.return}return f}function us(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Cl(e,t,o,f,D){for(var B=t._reactName,ie=[];o!==null&&o!==f;){var Ce=o,Fe=Ce.alternate,Ye=Ce.stateNode;if(Fe!==null&&Fe===f)break;Ce.tag===5&&Ye!==null&&(Ce=Ye,D?(Fe=Ni(o,B),Fe!=null&&ie.unshift(Ds(o,Fe,Ce))):D||(Fe=Ni(o,B),Fe!=null&&ie.push(Ds(o,Fe,Ce)))),o=o.return}ie.length!==0&&e.push({event:t,listeners:ie})}var _c=/\r\n?/g,wc=/\u0000|\uFFFD/g;function Tl(e){return(typeof e=="string"?e:""+e).replace(_c,`
`).replace(wc,"")}function eo(e,t,o){if(t=Tl(t),Tl(e)!==t&&o)throw Error(a(425))}function to(){}var Qo=null,Jo=null;function ea(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var ta=typeof setTimeout=="function"?setTimeout:void 0,bc=typeof clearTimeout=="function"?clearTimeout:void 0,Ml=typeof Promise=="function"?Promise:void 0,Sc=typeof queueMicrotask=="function"?queueMicrotask:typeof Ml<"u"?function(e){return Ml.resolve(null).then(e).catch(Ec)}:ta;function Ec(e){setTimeout(function(){throw e})}function ra(e,t){var o=t,f=0;do{var D=o.nextSibling;if(e.removeChild(o),D&&D.nodeType===8)if(o=D.data,o==="/$"){if(f===0){e.removeChild(D),pt(t);return}f--}else o!=="$"&&o!=="$?"&&o!=="$!"||f++;o=D}while(o);pt(t)}function Dn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function kl(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var o=e.data;if(o==="$"||o==="$!"||o==="$?"){if(t===0)return e;t--}else o==="/$"&&t++}e=e.previousSibling}return null}var cs=Math.random().toString(36).slice(2),xn="__reactFiber$"+cs,zs="__reactProps$"+cs,Sn="__reactContainer$"+cs,ia="__reactEvents$"+cs,Ac="__reactListeners$"+cs,Cc="__reactHandles$"+cs;function $n(e){var t=e[xn];if(t)return t;for(var o=e.parentNode;o;){if(t=o[Sn]||o[xn]){if(o=t.alternate,t.child!==null||o!==null&&o.child!==null)for(e=kl(e);e!==null;){if(o=e[xn])return o;e=kl(e)}return t}e=o,o=e.parentNode}return null}function Is(e){return e=e[xn]||e[Sn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function hs(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(a(33))}function ro(e){return e[zs]||null}var na=[],ds=-1;function zn(e){return{current:e}}function Jr(e){0>ds||(e.current=na[ds],na[ds]=null,ds--)}function Yr(e,t){ds++,na[ds]=e.current,e.current=t}var In={},ji=zn(In),Yi=zn(!1),qn=In;function fs(e,t){var o=e.type.contextTypes;if(!o)return In;var f=e.stateNode;if(f&&f.__reactInternalMemoizedUnmaskedChildContext===t)return f.__reactInternalMemoizedMaskedChildContext;var D={},B;for(B in o)D[B]=t[B];return f&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=D),D}function Zi(e){return e=e.childContextTypes,e!=null}function io(){Jr(Yi),Jr(ji)}function Rl(e,t,o){if(ji.current!==In)throw Error(a(168));Yr(ji,t),Yr(Yi,o)}function Pl(e,t,o){var f=e.stateNode;if(t=t.childContextTypes,typeof f.getChildContext!="function")return o;f=f.getChildContext();for(var D in f)if(!(D in t))throw Error(a(108,Ue(e)||"Unknown",D));return Re({},o,f)}function no(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||In,qn=ji.current,Yr(ji,e),Yr(Yi,Yi.current),!0}function Dl(e,t,o){var f=e.stateNode;if(!f)throw Error(a(169));o?(e=Pl(e,t,qn),f.__reactInternalMemoizedMergedChildContext=e,Jr(Yi),Jr(ji),Yr(ji,e)):Jr(Yi),Yr(Yi,o)}var En=null,so=!1,sa=!1;function zl(e){En===null?En=[e]:En.push(e)}function Tc(e){so=!0,zl(e)}function Ln(){if(!sa&&En!==null){sa=!0;var e=0,t=P;try{var o=En;for(P=1;e<o.length;e++){var f=o[e];do f=f(!0);while(f!==null)}En=null,so=!1}catch(D){throw En!==null&&(En=En.slice(e+1)),xe(Mt,Ln),D}finally{P=t,sa=!1}}return null}var ps=[],ms=0,oo=null,ao=0,an=[],ln=0,Yn=null,An=1,Cn="";function Zn(e,t){ps[ms++]=ao,ps[ms++]=oo,oo=e,ao=t}function Il(e,t,o){an[ln++]=An,an[ln++]=Cn,an[ln++]=Yn,Yn=e;var f=An;e=Cn;var D=32-_r(f)-1;f&=~(1<<D),o+=1;var B=32-_r(t)+D;if(30<B){var ie=D-D%5;B=(f&(1<<ie)-1).toString(32),f>>=ie,D-=ie,An=1<<32-_r(t)+D|o<<D|f,Cn=B+e}else An=1<<B|o<<D|f,Cn=e}function oa(e){e.return!==null&&(Zn(e,1),Il(e,1,0))}function aa(e){for(;e===oo;)oo=ps[--ms],ps[ms]=null,ao=ps[--ms],ps[ms]=null;for(;e===Yn;)Yn=an[--ln],an[ln]=null,Cn=an[--ln],an[ln]=null,An=an[--ln],an[ln]=null}var rn=null,nn=null,ti=!1,pn=null;function Ll(e,t){var o=dn(5,null,null,0);o.elementType="DELETED",o.stateNode=t,o.return=e,t=e.deletions,t===null?(e.deletions=[o],e.flags|=16):t.push(o)}function Ol(e,t){switch(e.tag){case 5:var o=e.type;return t=t.nodeType!==1||o.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,rn=e,nn=Dn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,rn=e,nn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(o=Yn!==null?{id:An,overflow:Cn}:null,e.memoizedState={dehydrated:t,treeContext:o,retryLane:1073741824},o=dn(18,null,null,0),o.stateNode=t,o.return=e,e.child=o,rn=e,nn=null,!0):!1;default:return!1}}function la(e){return(e.mode&1)!==0&&(e.flags&128)===0}function ua(e){if(ti){var t=nn;if(t){var o=t;if(!Ol(e,t)){if(la(e))throw Error(a(418));t=Dn(o.nextSibling);var f=rn;t&&Ol(e,t)?Ll(f,o):(e.flags=e.flags&-4097|2,ti=!1,rn=e)}}else{if(la(e))throw Error(a(418));e.flags=e.flags&-4097|2,ti=!1,rn=e}}}function Fl(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;rn=e}function lo(e){if(e!==rn)return!1;if(!ti)return Fl(e),ti=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!ea(e.type,e.memoizedProps)),t&&(t=nn)){if(la(e))throw Nl(),Error(a(418));for(;t;)Ll(e,t),t=Dn(t.nextSibling)}if(Fl(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var o=e.data;if(o==="/$"){if(t===0){nn=Dn(e.nextSibling);break e}t--}else o!=="$"&&o!=="$!"&&o!=="$?"||t++}e=e.nextSibling}nn=null}}else nn=rn?Dn(e.stateNode.nextSibling):null;return!0}function Nl(){for(var e=nn;e;)e=Dn(e.nextSibling)}function gs(){nn=rn=null,ti=!1}function ca(e){pn===null?pn=[e]:pn.push(e)}var Mc=N.ReactCurrentBatchConfig;function Ls(e,t,o){if(e=o.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(o._owner){if(o=o._owner,o){if(o.tag!==1)throw Error(a(309));var f=o.stateNode}if(!f)throw Error(a(147,e));var D=f,B=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===B?t.ref:(t=function(ie){var Ce=D.refs;ie===null?delete Ce[B]:Ce[B]=ie},t._stringRef=B,t)}if(typeof e!="string")throw Error(a(284));if(!o._owner)throw Error(a(290,e))}return e}function uo(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Vl(e){var t=e._init;return t(e._payload)}function jl(e){function t(Xe,je){if(e){var qe=Xe.deletions;qe===null?(Xe.deletions=[je],Xe.flags|=16):qe.push(je)}}function o(Xe,je){if(!e)return null;for(;je!==null;)t(Xe,je),je=je.sibling;return null}function f(Xe,je){for(Xe=new Map;je!==null;)je.key!==null?Xe.set(je.key,je):Xe.set(je.index,je),je=je.sibling;return Xe}function D(Xe,je){return Xe=Gn(Xe,je),Xe.index=0,Xe.sibling=null,Xe}function B(Xe,je,qe){return Xe.index=qe,e?(qe=Xe.alternate,qe!==null?(qe=qe.index,qe<je?(Xe.flags|=2,je):qe):(Xe.flags|=2,je)):(Xe.flags|=1048576,je)}function ie(Xe){return e&&Xe.alternate===null&&(Xe.flags|=2),Xe}function Ce(Xe,je,qe,Tt){return je===null||je.tag!==6?(je=tl(qe,Xe.mode,Tt),je.return=Xe,je):(je=D(je,qe),je.return=Xe,je)}function Fe(Xe,je,qe,Tt){var Yt=qe.type;return Yt===Y?xt(Xe,je,qe.props.children,Tt,qe.key):je!==null&&(je.elementType===Yt||typeof Yt=="object"&&Yt!==null&&Yt.$$typeof===I&&Vl(Yt)===je.type)?(Tt=D(je,qe.props),Tt.ref=Ls(Xe,je,qe),Tt.return=Xe,Tt):(Tt=Io(qe.type,qe.key,qe.props,null,Xe.mode,Tt),Tt.ref=Ls(Xe,je,qe),Tt.return=Xe,Tt)}function Ye(Xe,je,qe,Tt){return je===null||je.tag!==4||je.stateNode.containerInfo!==qe.containerInfo||je.stateNode.implementation!==qe.implementation?(je=rl(qe,Xe.mode,Tt),je.return=Xe,je):(je=D(je,qe.children||[]),je.return=Xe,je)}function xt(Xe,je,qe,Tt,Yt){return je===null||je.tag!==7?(je=ss(qe,Xe.mode,Tt,Yt),je.return=Xe,je):(je=D(je,qe),je.return=Xe,je)}function bt(Xe,je,qe){if(typeof je=="string"&&je!==""||typeof je=="number")return je=tl(""+je,Xe.mode,qe),je.return=Xe,je;if(typeof je=="object"&&je!==null){switch(je.$$typeof){case V:return qe=Io(je.type,je.key,je.props,null,Xe.mode,qe),qe.ref=Ls(Xe,null,je),qe.return=Xe,qe;case H:return je=rl(je,Xe.mode,qe),je.return=Xe,je;case I:var Tt=je._init;return bt(Xe,Tt(je._payload),qe)}if(xr(je)||K(je))return je=ss(je,Xe.mode,qe,null),je.return=Xe,je;uo(Xe,je)}return null}function vt(Xe,je,qe,Tt){var Yt=je!==null?je.key:null;if(typeof qe=="string"&&qe!==""||typeof qe=="number")return Yt!==null?null:Ce(Xe,je,""+qe,Tt);if(typeof qe=="object"&&qe!==null){switch(qe.$$typeof){case V:return qe.key===Yt?Fe(Xe,je,qe,Tt):null;case H:return qe.key===Yt?Ye(Xe,je,qe,Tt):null;case I:return Yt=qe._init,vt(Xe,je,Yt(qe._payload),Tt)}if(xr(qe)||K(qe))return Yt!==null?null:xt(Xe,je,qe,Tt,null);uo(Xe,qe)}return null}function jt(Xe,je,qe,Tt,Yt){if(typeof Tt=="string"&&Tt!==""||typeof Tt=="number")return Xe=Xe.get(qe)||null,Ce(je,Xe,""+Tt,Yt);if(typeof Tt=="object"&&Tt!==null){switch(Tt.$$typeof){case V:return Xe=Xe.get(Tt.key===null?qe:Tt.key)||null,Fe(je,Xe,Tt,Yt);case H:return Xe=Xe.get(Tt.key===null?qe:Tt.key)||null,Ye(je,Xe,Tt,Yt);case I:var ir=Tt._init;return jt(Xe,je,qe,ir(Tt._payload),Yt)}if(xr(Tt)||K(Tt))return Xe=Xe.get(qe)||null,xt(je,Xe,Tt,Yt,null);uo(je,Tt)}return null}function Xt(Xe,je,qe,Tt){for(var Yt=null,ir=null,nr=je,hr=je=0,Pi=null;nr!==null&&hr<qe.length;hr++){nr.index>hr?(Pi=nr,nr=null):Pi=nr.sibling;var Vr=vt(Xe,nr,qe[hr],Tt);if(Vr===null){nr===null&&(nr=Pi);break}e&&nr&&Vr.alternate===null&&t(Xe,nr),je=B(Vr,je,hr),ir===null?Yt=Vr:ir.sibling=Vr,ir=Vr,nr=Pi}if(hr===qe.length)return o(Xe,nr),ti&&Zn(Xe,hr),Yt;if(nr===null){for(;hr<qe.length;hr++)nr=bt(Xe,qe[hr],Tt),nr!==null&&(je=B(nr,je,hr),ir===null?Yt=nr:ir.sibling=nr,ir=nr);return ti&&Zn(Xe,hr),Yt}for(nr=f(Xe,nr);hr<qe.length;hr++)Pi=jt(nr,Xe,hr,qe[hr],Tt),Pi!==null&&(e&&Pi.alternate!==null&&nr.delete(Pi.key===null?hr:Pi.key),je=B(Pi,je,hr),ir===null?Yt=Pi:ir.sibling=Pi,ir=Pi);return e&&nr.forEach(function(Hn){return t(Xe,Hn)}),ti&&Zn(Xe,hr),Yt}function $t(Xe,je,qe,Tt){var Yt=K(qe);if(typeof Yt!="function")throw Error(a(150));if(qe=Yt.call(qe),qe==null)throw Error(a(151));for(var ir=Yt=null,nr=je,hr=je=0,Pi=null,Vr=qe.next();nr!==null&&!Vr.done;hr++,Vr=qe.next()){nr.index>hr?(Pi=nr,nr=null):Pi=nr.sibling;var Hn=vt(Xe,nr,Vr.value,Tt);if(Hn===null){nr===null&&(nr=Pi);break}e&&nr&&Hn.alternate===null&&t(Xe,nr),je=B(Hn,je,hr),ir===null?Yt=Hn:ir.sibling=Hn,ir=Hn,nr=Pi}if(Vr.done)return o(Xe,nr),ti&&Zn(Xe,hr),Yt;if(nr===null){for(;!Vr.done;hr++,Vr=qe.next())Vr=bt(Xe,Vr.value,Tt),Vr!==null&&(je=B(Vr,je,hr),ir===null?Yt=Vr:ir.sibling=Vr,ir=Vr);return ti&&Zn(Xe,hr),Yt}for(nr=f(Xe,nr);!Vr.done;hr++,Vr=qe.next())Vr=jt(nr,Xe,hr,Vr.value,Tt),Vr!==null&&(e&&Vr.alternate!==null&&nr.delete(Vr.key===null?hr:Vr.key),je=B(Vr,je,hr),ir===null?Yt=Vr:ir.sibling=Vr,ir=Vr);return e&&nr.forEach(function(ah){return t(Xe,ah)}),ti&&Zn(Xe,hr),Yt}function mi(Xe,je,qe,Tt){if(typeof qe=="object"&&qe!==null&&qe.type===Y&&qe.key===null&&(qe=qe.props.children),typeof qe=="object"&&qe!==null){switch(qe.$$typeof){case V:e:{for(var Yt=qe.key,ir=je;ir!==null;){if(ir.key===Yt){if(Yt=qe.type,Yt===Y){if(ir.tag===7){o(Xe,ir.sibling),je=D(ir,qe.props.children),je.return=Xe,Xe=je;break e}}else if(ir.elementType===Yt||typeof Yt=="object"&&Yt!==null&&Yt.$$typeof===I&&Vl(Yt)===ir.type){o(Xe,ir.sibling),je=D(ir,qe.props),je.ref=Ls(Xe,ir,qe),je.return=Xe,Xe=je;break e}o(Xe,ir);break}else t(Xe,ir);ir=ir.sibling}qe.type===Y?(je=ss(qe.props.children,Xe.mode,Tt,qe.key),je.return=Xe,Xe=je):(Tt=Io(qe.type,qe.key,qe.props,null,Xe.mode,Tt),Tt.ref=Ls(Xe,je,qe),Tt.return=Xe,Xe=Tt)}return ie(Xe);case H:e:{for(ir=qe.key;je!==null;){if(je.key===ir)if(je.tag===4&&je.stateNode.containerInfo===qe.containerInfo&&je.stateNode.implementation===qe.implementation){o(Xe,je.sibling),je=D(je,qe.children||[]),je.return=Xe,Xe=je;break e}else{o(Xe,je);break}else t(Xe,je);je=je.sibling}je=rl(qe,Xe.mode,Tt),je.return=Xe,Xe=je}return ie(Xe);case I:return ir=qe._init,mi(Xe,je,ir(qe._payload),Tt)}if(xr(qe))return Xt(Xe,je,qe,Tt);if(K(qe))return $t(Xe,je,qe,Tt);uo(Xe,qe)}return typeof qe=="string"&&qe!==""||typeof qe=="number"?(qe=""+qe,je!==null&&je.tag===6?(o(Xe,je.sibling),je=D(je,qe),je.return=Xe,Xe=je):(o(Xe,je),je=tl(qe,Xe.mode,Tt),je.return=Xe,Xe=je),ie(Xe)):o(Xe,je)}return mi}var vs=jl(!0),Bl=jl(!1),co=zn(null),ho=null,ys=null,ha=null;function da(){ha=ys=ho=null}function fa(e){var t=co.current;Jr(co),e._currentValue=t}function pa(e,t,o){for(;e!==null;){var f=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,f!==null&&(f.childLanes|=t)):f!==null&&(f.childLanes&t)!==t&&(f.childLanes|=t),e===o)break;e=e.return}}function xs(e,t){ho=e,ha=ys=null,e=e.dependencies,e!==null&&e.firstContext!==null&&((e.lanes&t)!==0&&(Qi=!0),e.firstContext=null)}function un(e){var t=e._currentValue;if(ha!==e)if(e={context:e,memoizedValue:t,next:null},ys===null){if(ho===null)throw Error(a(308));ys=e,ho.dependencies={lanes:0,firstContext:e}}else ys=ys.next=e;return t}var Qn=null;function ma(e){Qn===null?Qn=[e]:Qn.push(e)}function Ul(e,t,o,f){var D=t.interleaved;return D===null?(o.next=o,ma(t)):(o.next=D.next,D.next=o),t.interleaved=o,Tn(e,f)}function Tn(e,t){e.lanes|=t;var o=e.alternate;for(o!==null&&(o.lanes|=t),o=e,e=e.return;e!==null;)e.childLanes|=t,o=e.alternate,o!==null&&(o.childLanes|=t),o=e,e=e.return;return o.tag===3?o.stateNode:null}var On=!1;function ga(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Gl(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Mn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Fn(e,t,o){var f=e.updateQueue;if(f===null)return null;if(f=f.shared,(Nr&2)!==0){var D=f.pending;return D===null?t.next=t:(t.next=D.next,D.next=t),f.pending=t,Tn(e,o)}return D=f.interleaved,D===null?(t.next=t,ma(f)):(t.next=D.next,D.next=t),f.interleaved=t,Tn(e,o)}function fo(e,t,o){if(t=t.updateQueue,t!==null&&(t=t.shared,(o&4194240)!==0)){var f=t.lanes;f&=e.pendingLanes,o|=f,t.lanes=o,S(e,o)}}function Hl(e,t){var o=e.updateQueue,f=e.alternate;if(f!==null&&(f=f.updateQueue,o===f)){var D=null,B=null;if(o=o.firstBaseUpdate,o!==null){do{var ie={eventTime:o.eventTime,lane:o.lane,tag:o.tag,payload:o.payload,callback:o.callback,next:null};B===null?D=B=ie:B=B.next=ie,o=o.next}while(o!==null);B===null?D=B=t:B=B.next=t}else D=B=t;o={baseState:f.baseState,firstBaseUpdate:D,lastBaseUpdate:B,shared:f.shared,effects:f.effects},e.updateQueue=o;return}e=o.lastBaseUpdate,e===null?o.firstBaseUpdate=t:e.next=t,o.lastBaseUpdate=t}function po(e,t,o,f){var D=e.updateQueue;On=!1;var B=D.firstBaseUpdate,ie=D.lastBaseUpdate,Ce=D.shared.pending;if(Ce!==null){D.shared.pending=null;var Fe=Ce,Ye=Fe.next;Fe.next=null,ie===null?B=Ye:ie.next=Ye,ie=Fe;var xt=e.alternate;xt!==null&&(xt=xt.updateQueue,Ce=xt.lastBaseUpdate,Ce!==ie&&(Ce===null?xt.firstBaseUpdate=Ye:Ce.next=Ye,xt.lastBaseUpdate=Fe))}if(B!==null){var bt=D.baseState;ie=0,xt=Ye=Fe=null,Ce=B;do{var vt=Ce.lane,jt=Ce.eventTime;if((f&vt)===vt){xt!==null&&(xt=xt.next={eventTime:jt,lane:0,tag:Ce.tag,payload:Ce.payload,callback:Ce.callback,next:null});e:{var Xt=e,$t=Ce;switch(vt=t,jt=o,$t.tag){case 1:if(Xt=$t.payload,typeof Xt=="function"){bt=Xt.call(jt,bt,vt);break e}bt=Xt;break e;case 3:Xt.flags=Xt.flags&-65537|128;case 0:if(Xt=$t.payload,vt=typeof Xt=="function"?Xt.call(jt,bt,vt):Xt,vt==null)break e;bt=Re({},bt,vt);break e;case 2:On=!0}}Ce.callback!==null&&Ce.lane!==0&&(e.flags|=64,vt=D.effects,vt===null?D.effects=[Ce]:vt.push(Ce))}else jt={eventTime:jt,lane:vt,tag:Ce.tag,payload:Ce.payload,callback:Ce.callback,next:null},xt===null?(Ye=xt=jt,Fe=bt):xt=xt.next=jt,ie|=vt;if(Ce=Ce.next,Ce===null){if(Ce=D.shared.pending,Ce===null)break;vt=Ce,Ce=vt.next,vt.next=null,D.lastBaseUpdate=vt,D.shared.pending=null}}while(!0);if(xt===null&&(Fe=bt),D.baseState=Fe,D.firstBaseUpdate=Ye,D.lastBaseUpdate=xt,t=D.shared.interleaved,t!==null){D=t;do ie|=D.lane,D=D.next;while(D!==t)}else B===null&&(D.shared.lanes=0);ts|=ie,e.lanes=ie,e.memoizedState=bt}}function Wl(e,t,o){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var f=e[t],D=f.callback;if(D!==null){if(f.callback=null,f=o,typeof D!="function")throw Error(a(191,D));D.call(f)}}}var Os={},_n=zn(Os),Fs=zn(Os),Ns=zn(Os);function Jn(e){if(e===Os)throw Error(a(174));return e}function va(e,t){switch(Yr(Ns,t),Yr(Fs,e),Yr(_n,Os),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:pe(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=pe(t,e)}Jr(_n),Yr(_n,t)}function _s(){Jr(_n),Jr(Fs),Jr(Ns)}function Xl(e){Jn(Ns.current);var t=Jn(_n.current),o=pe(t,e.type);t!==o&&(Yr(Fs,e),Yr(_n,o))}function ya(e){Fs.current===e&&(Jr(_n),Jr(Fs))}var oi=zn(0);function mo(e){for(var t=e;t!==null;){if(t.tag===13){var o=t.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||o.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var xa=[];function _a(){for(var e=0;e<xa.length;e++)xa[e]._workInProgressVersionPrimary=null;xa.length=0}var go=N.ReactCurrentDispatcher,wa=N.ReactCurrentBatchConfig,es=0,ai=null,Si=null,ki=null,vo=!1,Vs=!1,js=0,kc=0;function Bi(){throw Error(a(321))}function ba(e,t){if(t===null)return!1;for(var o=0;o<t.length&&o<e.length;o++)if(!fn(e[o],t[o]))return!1;return!0}function Sa(e,t,o,f,D,B){if(es=B,ai=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,go.current=e===null||e.memoizedState===null?zc:Ic,e=o(f,D),Vs){B=0;do{if(Vs=!1,js=0,25<=B)throw Error(a(301));B+=1,ki=Si=null,t.updateQueue=null,go.current=Lc,e=o(f,D)}while(Vs)}if(go.current=_o,t=Si!==null&&Si.next!==null,es=0,ki=Si=ai=null,vo=!1,t)throw Error(a(300));return e}function Ea(){var e=js!==0;return js=0,e}function wn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ki===null?ai.memoizedState=ki=e:ki=ki.next=e,ki}function cn(){if(Si===null){var e=ai.alternate;e=e!==null?e.memoizedState:null}else e=Si.next;var t=ki===null?ai.memoizedState:ki.next;if(t!==null)ki=t,Si=e;else{if(e===null)throw Error(a(310));Si=e,e={memoizedState:Si.memoizedState,baseState:Si.baseState,baseQueue:Si.baseQueue,queue:Si.queue,next:null},ki===null?ai.memoizedState=ki=e:ki=ki.next=e}return ki}function Bs(e,t){return typeof t=="function"?t(e):t}function Aa(e){var t=cn(),o=t.queue;if(o===null)throw Error(a(311));o.lastRenderedReducer=e;var f=Si,D=f.baseQueue,B=o.pending;if(B!==null){if(D!==null){var ie=D.next;D.next=B.next,B.next=ie}f.baseQueue=D=B,o.pending=null}if(D!==null){B=D.next,f=f.baseState;var Ce=ie=null,Fe=null,Ye=B;do{var xt=Ye.lane;if((es&xt)===xt)Fe!==null&&(Fe=Fe.next={lane:0,action:Ye.action,hasEagerState:Ye.hasEagerState,eagerState:Ye.eagerState,next:null}),f=Ye.hasEagerState?Ye.eagerState:e(f,Ye.action);else{var bt={lane:xt,action:Ye.action,hasEagerState:Ye.hasEagerState,eagerState:Ye.eagerState,next:null};Fe===null?(Ce=Fe=bt,ie=f):Fe=Fe.next=bt,ai.lanes|=xt,ts|=xt}Ye=Ye.next}while(Ye!==null&&Ye!==B);Fe===null?ie=f:Fe.next=Ce,fn(f,t.memoizedState)||(Qi=!0),t.memoizedState=f,t.baseState=ie,t.baseQueue=Fe,o.lastRenderedState=f}if(e=o.interleaved,e!==null){D=e;do B=D.lane,ai.lanes|=B,ts|=B,D=D.next;while(D!==e)}else D===null&&(o.lanes=0);return[t.memoizedState,o.dispatch]}function Ca(e){var t=cn(),o=t.queue;if(o===null)throw Error(a(311));o.lastRenderedReducer=e;var f=o.dispatch,D=o.pending,B=t.memoizedState;if(D!==null){o.pending=null;var ie=D=D.next;do B=e(B,ie.action),ie=ie.next;while(ie!==D);fn(B,t.memoizedState)||(Qi=!0),t.memoizedState=B,t.baseQueue===null&&(t.baseState=B),o.lastRenderedState=B}return[B,f]}function Kl(){}function $l(e,t){var o=ai,f=cn(),D=t(),B=!fn(f.memoizedState,D);if(B&&(f.memoizedState=D,Qi=!0),f=f.queue,Ta(Zl.bind(null,o,f,e),[e]),f.getSnapshot!==t||B||ki!==null&&ki.memoizedState.tag&1){if(o.flags|=2048,Us(9,Yl.bind(null,o,f,D,t),void 0,null),Ri===null)throw Error(a(349));(es&30)!==0||ql(o,t,D)}return D}function ql(e,t,o){e.flags|=16384,e={getSnapshot:t,value:o},t=ai.updateQueue,t===null?(t={lastEffect:null,stores:null},ai.updateQueue=t,t.stores=[e]):(o=t.stores,o===null?t.stores=[e]:o.push(e))}function Yl(e,t,o,f){t.value=o,t.getSnapshot=f,Ql(t)&&Jl(e)}function Zl(e,t,o){return o(function(){Ql(t)&&Jl(e)})}function Ql(e){var t=e.getSnapshot;e=e.value;try{var o=t();return!fn(e,o)}catch{return!0}}function Jl(e){var t=Tn(e,1);t!==null&&yn(t,e,1,-1)}function eu(e){var t=wn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Bs,lastRenderedState:e},t.queue=e,e=e.dispatch=Dc.bind(null,ai,e),[t.memoizedState,e]}function Us(e,t,o,f){return e={tag:e,create:t,destroy:o,deps:f,next:null},t=ai.updateQueue,t===null?(t={lastEffect:null,stores:null},ai.updateQueue=t,t.lastEffect=e.next=e):(o=t.lastEffect,o===null?t.lastEffect=e.next=e:(f=o.next,o.next=e,e.next=f,t.lastEffect=e)),e}function tu(){return cn().memoizedState}function yo(e,t,o,f){var D=wn();ai.flags|=e,D.memoizedState=Us(1|t,o,void 0,f===void 0?null:f)}function xo(e,t,o,f){var D=cn();f=f===void 0?null:f;var B=void 0;if(Si!==null){var ie=Si.memoizedState;if(B=ie.destroy,f!==null&&ba(f,ie.deps)){D.memoizedState=Us(t,o,B,f);return}}ai.flags|=e,D.memoizedState=Us(1|t,o,B,f)}function ru(e,t){return yo(8390656,8,e,t)}function Ta(e,t){return xo(2048,8,e,t)}function iu(e,t){return xo(4,2,e,t)}function nu(e,t){return xo(4,4,e,t)}function su(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function ou(e,t,o){return o=o!=null?o.concat([e]):null,xo(4,4,su.bind(null,t,e),o)}function Ma(){}function au(e,t){var o=cn();t=t===void 0?null:t;var f=o.memoizedState;return f!==null&&t!==null&&ba(t,f[1])?f[0]:(o.memoizedState=[e,t],e)}function lu(e,t){var o=cn();t=t===void 0?null:t;var f=o.memoizedState;return f!==null&&t!==null&&ba(t,f[1])?f[0]:(e=e(),o.memoizedState=[e,t],e)}function uu(e,t,o){return(es&21)===0?(e.baseState&&(e.baseState=!1,Qi=!0),e.memoizedState=o):(fn(o,t)||(o=E(),ai.lanes|=o,ts|=o,e.baseState=!0),t)}function Rc(e,t){var o=P;P=o!==0&&4>o?o:4,e(!0);var f=wa.transition;wa.transition={};try{e(!1),t()}finally{P=o,wa.transition=f}}function cu(){return cn().memoizedState}function Pc(e,t,o){var f=Bn(e);if(o={lane:f,action:o,hasEagerState:!1,eagerState:null,next:null},hu(e))du(t,o);else if(o=Ul(e,t,o,f),o!==null){var D=Ki();yn(o,e,f,D),fu(o,t,f)}}function Dc(e,t,o){var f=Bn(e),D={lane:f,action:o,hasEagerState:!1,eagerState:null,next:null};if(hu(e))du(t,D);else{var B=e.alternate;if(e.lanes===0&&(B===null||B.lanes===0)&&(B=t.lastRenderedReducer,B!==null))try{var ie=t.lastRenderedState,Ce=B(ie,o);if(D.hasEagerState=!0,D.eagerState=Ce,fn(Ce,ie)){var Fe=t.interleaved;Fe===null?(D.next=D,ma(t)):(D.next=Fe.next,Fe.next=D),t.interleaved=D;return}}catch{}o=Ul(e,t,D,f),o!==null&&(D=Ki(),yn(o,e,f,D),fu(o,t,f))}}function hu(e){var t=e.alternate;return e===ai||t!==null&&t===ai}function du(e,t){Vs=vo=!0;var o=e.pending;o===null?t.next=t:(t.next=o.next,o.next=t),e.pending=t}function fu(e,t,o){if((o&4194240)!==0){var f=t.lanes;f&=e.pendingLanes,o|=f,t.lanes=o,S(e,o)}}var _o={readContext:un,useCallback:Bi,useContext:Bi,useEffect:Bi,useImperativeHandle:Bi,useInsertionEffect:Bi,useLayoutEffect:Bi,useMemo:Bi,useReducer:Bi,useRef:Bi,useState:Bi,useDebugValue:Bi,useDeferredValue:Bi,useTransition:Bi,useMutableSource:Bi,useSyncExternalStore:Bi,useId:Bi,unstable_isNewReconciler:!1},zc={readContext:un,useCallback:function(e,t){return wn().memoizedState=[e,t===void 0?null:t],e},useContext:un,useEffect:ru,useImperativeHandle:function(e,t,o){return o=o!=null?o.concat([e]):null,yo(4194308,4,su.bind(null,t,e),o)},useLayoutEffect:function(e,t){return yo(4194308,4,e,t)},useInsertionEffect:function(e,t){return yo(4,2,e,t)},useMemo:function(e,t){var o=wn();return t=t===void 0?null:t,e=e(),o.memoizedState=[e,t],e},useReducer:function(e,t,o){var f=wn();return t=o!==void 0?o(t):t,f.memoizedState=f.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},f.queue=e,e=e.dispatch=Pc.bind(null,ai,e),[f.memoizedState,e]},useRef:function(e){var t=wn();return e={current:e},t.memoizedState=e},useState:eu,useDebugValue:Ma,useDeferredValue:function(e){return wn().memoizedState=e},useTransition:function(){var e=eu(!1),t=e[0];return e=Rc.bind(null,e[1]),wn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,o){var f=ai,D=wn();if(ti){if(o===void 0)throw Error(a(407));o=o()}else{if(o=t(),Ri===null)throw Error(a(349));(es&30)!==0||ql(f,t,o)}D.memoizedState=o;var B={value:o,getSnapshot:t};return D.queue=B,ru(Zl.bind(null,f,B,e),[e]),f.flags|=2048,Us(9,Yl.bind(null,f,B,o,t),void 0,null),o},useId:function(){var e=wn(),t=Ri.identifierPrefix;if(ti){var o=Cn,f=An;o=(f&~(1<<32-_r(f)-1)).toString(32)+o,t=":"+t+"R"+o,o=js++,0<o&&(t+="H"+o.toString(32)),t+=":"}else o=kc++,t=":"+t+"r"+o.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Ic={readContext:un,useCallback:au,useContext:un,useEffect:Ta,useImperativeHandle:ou,useInsertionEffect:iu,useLayoutEffect:nu,useMemo:lu,useReducer:Aa,useRef:tu,useState:function(){return Aa(Bs)},useDebugValue:Ma,useDeferredValue:function(e){var t=cn();return uu(t,Si.memoizedState,e)},useTransition:function(){var e=Aa(Bs)[0],t=cn().memoizedState;return[e,t]},useMutableSource:Kl,useSyncExternalStore:$l,useId:cu,unstable_isNewReconciler:!1},Lc={readContext:un,useCallback:au,useContext:un,useEffect:Ta,useImperativeHandle:ou,useInsertionEffect:iu,useLayoutEffect:nu,useMemo:lu,useReducer:Ca,useRef:tu,useState:function(){return Ca(Bs)},useDebugValue:Ma,useDeferredValue:function(e){var t=cn();return Si===null?t.memoizedState=e:uu(t,Si.memoizedState,e)},useTransition:function(){var e=Ca(Bs)[0],t=cn().memoizedState;return[e,t]},useMutableSource:Kl,useSyncExternalStore:$l,useId:cu,unstable_isNewReconciler:!1};function mn(e,t){if(e&&e.defaultProps){t=Re({},t),e=e.defaultProps;for(var o in e)t[o]===void 0&&(t[o]=e[o]);return t}return t}function ka(e,t,o,f){t=e.memoizedState,o=o(f,t),o=o==null?t:Re({},t,o),e.memoizedState=o,e.lanes===0&&(e.updateQueue.baseState=o)}var wo={isMounted:function(e){return(e=e._reactInternals)?Gr(e)===e:!1},enqueueSetState:function(e,t,o){e=e._reactInternals;var f=Ki(),D=Bn(e),B=Mn(f,D);B.payload=t,o!=null&&(B.callback=o),t=Fn(e,B,D),t!==null&&(yn(t,e,D,f),fo(t,e,D))},enqueueReplaceState:function(e,t,o){e=e._reactInternals;var f=Ki(),D=Bn(e),B=Mn(f,D);B.tag=1,B.payload=t,o!=null&&(B.callback=o),t=Fn(e,B,D),t!==null&&(yn(t,e,D,f),fo(t,e,D))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var o=Ki(),f=Bn(e),D=Mn(o,f);D.tag=2,t!=null&&(D.callback=t),t=Fn(e,D,f),t!==null&&(yn(t,e,f,o),fo(t,e,f))}};function pu(e,t,o,f,D,B,ie){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(f,B,ie):t.prototype&&t.prototype.isPureReactComponent?!Ms(o,f)||!Ms(D,B):!0}function mu(e,t,o){var f=!1,D=In,B=t.contextType;return typeof B=="object"&&B!==null?B=un(B):(D=Zi(t)?qn:ji.current,f=t.contextTypes,B=(f=f!=null)?fs(e,D):In),t=new t(o,B),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=wo,e.stateNode=t,t._reactInternals=e,f&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=D,e.__reactInternalMemoizedMaskedChildContext=B),t}function gu(e,t,o,f){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(o,f),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(o,f),t.state!==e&&wo.enqueueReplaceState(t,t.state,null)}function Ra(e,t,o,f){var D=e.stateNode;D.props=o,D.state=e.memoizedState,D.refs={},ga(e);var B=t.contextType;typeof B=="object"&&B!==null?D.context=un(B):(B=Zi(t)?qn:ji.current,D.context=fs(e,B)),D.state=e.memoizedState,B=t.getDerivedStateFromProps,typeof B=="function"&&(ka(e,t,B,o),D.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof D.getSnapshotBeforeUpdate=="function"||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(t=D.state,typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount(),t!==D.state&&wo.enqueueReplaceState(D,D.state,null),po(e,o,D,f),D.state=e.memoizedState),typeof D.componentDidMount=="function"&&(e.flags|=4194308)}function ws(e,t){try{var o="",f=t;do o+=Ee(f),f=f.return;while(f);var D=o}catch(B){D=`
Error generating stack: `+B.message+`
`+B.stack}return{value:e,source:t,stack:D,digest:null}}function Pa(e,t,o){return{value:e,source:null,stack:o??null,digest:t??null}}function Da(e,t){try{console.error(t.value)}catch(o){setTimeout(function(){throw o})}}var Oc=typeof WeakMap=="function"?WeakMap:Map;function vu(e,t,o){o=Mn(-1,o),o.tag=3,o.payload={element:null};var f=t.value;return o.callback=function(){Mo||(Mo=!0,Ka=f),Da(e,t)},o}function yu(e,t,o){o=Mn(-1,o),o.tag=3;var f=e.type.getDerivedStateFromError;if(typeof f=="function"){var D=t.value;o.payload=function(){return f(D)},o.callback=function(){Da(e,t)}}var B=e.stateNode;return B!==null&&typeof B.componentDidCatch=="function"&&(o.callback=function(){Da(e,t),typeof f!="function"&&(Vn===null?Vn=new Set([this]):Vn.add(this));var ie=t.stack;this.componentDidCatch(t.value,{componentStack:ie!==null?ie:""})}),o}function xu(e,t,o){var f=e.pingCache;if(f===null){f=e.pingCache=new Oc;var D=new Set;f.set(t,D)}else D=f.get(t),D===void 0&&(D=new Set,f.set(t,D));D.has(o)||(D.add(o),e=Yc.bind(null,e,t,o),t.then(e,e))}function _u(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function wu(e,t,o,f,D){return(e.mode&1)===0?(e===t?e.flags|=65536:(e.flags|=128,o.flags|=131072,o.flags&=-52805,o.tag===1&&(o.alternate===null?o.tag=17:(t=Mn(-1,1),t.tag=2,Fn(o,t,1))),o.lanes|=1),e):(e.flags|=65536,e.lanes=D,e)}var Fc=N.ReactCurrentOwner,Qi=!1;function Xi(e,t,o,f){t.child=e===null?Bl(t,null,o,f):vs(t,e.child,o,f)}function bu(e,t,o,f,D){o=o.render;var B=t.ref;return xs(t,D),f=Sa(e,t,o,f,B,D),o=Ea(),e!==null&&!Qi?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~D,kn(e,t,D)):(ti&&o&&oa(t),t.flags|=1,Xi(e,t,f,D),t.child)}function Su(e,t,o,f,D){if(e===null){var B=o.type;return typeof B=="function"&&!el(B)&&B.defaultProps===void 0&&o.compare===null&&o.defaultProps===void 0?(t.tag=15,t.type=B,Eu(e,t,B,f,D)):(e=Io(o.type,null,f,t,t.mode,D),e.ref=t.ref,e.return=t,t.child=e)}if(B=e.child,(e.lanes&D)===0){var ie=B.memoizedProps;if(o=o.compare,o=o!==null?o:Ms,o(ie,f)&&e.ref===t.ref)return kn(e,t,D)}return t.flags|=1,e=Gn(B,f),e.ref=t.ref,e.return=t,t.child=e}function Eu(e,t,o,f,D){if(e!==null){var B=e.memoizedProps;if(Ms(B,f)&&e.ref===t.ref)if(Qi=!1,t.pendingProps=f=B,(e.lanes&D)!==0)(e.flags&131072)!==0&&(Qi=!0);else return t.lanes=e.lanes,kn(e,t,D)}return za(e,t,o,f,D)}function Au(e,t,o){var f=t.pendingProps,D=f.children,B=e!==null?e.memoizedState:null;if(f.mode==="hidden")if((t.mode&1)===0)t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Yr(Ss,sn),sn|=o;else{if((o&1073741824)===0)return e=B!==null?B.baseLanes|o:o,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Yr(Ss,sn),sn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},f=B!==null?B.baseLanes:o,Yr(Ss,sn),sn|=f}else B!==null?(f=B.baseLanes|o,t.memoizedState=null):f=o,Yr(Ss,sn),sn|=f;return Xi(e,t,D,o),t.child}function Cu(e,t){var o=t.ref;(e===null&&o!==null||e!==null&&e.ref!==o)&&(t.flags|=512,t.flags|=2097152)}function za(e,t,o,f,D){var B=Zi(o)?qn:ji.current;return B=fs(t,B),xs(t,D),o=Sa(e,t,o,f,B,D),f=Ea(),e!==null&&!Qi?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~D,kn(e,t,D)):(ti&&f&&oa(t),t.flags|=1,Xi(e,t,o,D),t.child)}function Tu(e,t,o,f,D){if(Zi(o)){var B=!0;no(t)}else B=!1;if(xs(t,D),t.stateNode===null)So(e,t),mu(t,o,f),Ra(t,o,f,D),f=!0;else if(e===null){var ie=t.stateNode,Ce=t.memoizedProps;ie.props=Ce;var Fe=ie.context,Ye=o.contextType;typeof Ye=="object"&&Ye!==null?Ye=un(Ye):(Ye=Zi(o)?qn:ji.current,Ye=fs(t,Ye));var xt=o.getDerivedStateFromProps,bt=typeof xt=="function"||typeof ie.getSnapshotBeforeUpdate=="function";bt||typeof ie.UNSAFE_componentWillReceiveProps!="function"&&typeof ie.componentWillReceiveProps!="function"||(Ce!==f||Fe!==Ye)&&gu(t,ie,f,Ye),On=!1;var vt=t.memoizedState;ie.state=vt,po(t,f,ie,D),Fe=t.memoizedState,Ce!==f||vt!==Fe||Yi.current||On?(typeof xt=="function"&&(ka(t,o,xt,f),Fe=t.memoizedState),(Ce=On||pu(t,o,Ce,f,vt,Fe,Ye))?(bt||typeof ie.UNSAFE_componentWillMount!="function"&&typeof ie.componentWillMount!="function"||(typeof ie.componentWillMount=="function"&&ie.componentWillMount(),typeof ie.UNSAFE_componentWillMount=="function"&&ie.UNSAFE_componentWillMount()),typeof ie.componentDidMount=="function"&&(t.flags|=4194308)):(typeof ie.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=f,t.memoizedState=Fe),ie.props=f,ie.state=Fe,ie.context=Ye,f=Ce):(typeof ie.componentDidMount=="function"&&(t.flags|=4194308),f=!1)}else{ie=t.stateNode,Gl(e,t),Ce=t.memoizedProps,Ye=t.type===t.elementType?Ce:mn(t.type,Ce),ie.props=Ye,bt=t.pendingProps,vt=ie.context,Fe=o.contextType,typeof Fe=="object"&&Fe!==null?Fe=un(Fe):(Fe=Zi(o)?qn:ji.current,Fe=fs(t,Fe));var jt=o.getDerivedStateFromProps;(xt=typeof jt=="function"||typeof ie.getSnapshotBeforeUpdate=="function")||typeof ie.UNSAFE_componentWillReceiveProps!="function"&&typeof ie.componentWillReceiveProps!="function"||(Ce!==bt||vt!==Fe)&&gu(t,ie,f,Fe),On=!1,vt=t.memoizedState,ie.state=vt,po(t,f,ie,D);var Xt=t.memoizedState;Ce!==bt||vt!==Xt||Yi.current||On?(typeof jt=="function"&&(ka(t,o,jt,f),Xt=t.memoizedState),(Ye=On||pu(t,o,Ye,f,vt,Xt,Fe)||!1)?(xt||typeof ie.UNSAFE_componentWillUpdate!="function"&&typeof ie.componentWillUpdate!="function"||(typeof ie.componentWillUpdate=="function"&&ie.componentWillUpdate(f,Xt,Fe),typeof ie.UNSAFE_componentWillUpdate=="function"&&ie.UNSAFE_componentWillUpdate(f,Xt,Fe)),typeof ie.componentDidUpdate=="function"&&(t.flags|=4),typeof ie.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof ie.componentDidUpdate!="function"||Ce===e.memoizedProps&&vt===e.memoizedState||(t.flags|=4),typeof ie.getSnapshotBeforeUpdate!="function"||Ce===e.memoizedProps&&vt===e.memoizedState||(t.flags|=1024),t.memoizedProps=f,t.memoizedState=Xt),ie.props=f,ie.state=Xt,ie.context=Fe,f=Ye):(typeof ie.componentDidUpdate!="function"||Ce===e.memoizedProps&&vt===e.memoizedState||(t.flags|=4),typeof ie.getSnapshotBeforeUpdate!="function"||Ce===e.memoizedProps&&vt===e.memoizedState||(t.flags|=1024),f=!1)}return Ia(e,t,o,f,B,D)}function Ia(e,t,o,f,D,B){Cu(e,t);var ie=(t.flags&128)!==0;if(!f&&!ie)return D&&Dl(t,o,!1),kn(e,t,B);f=t.stateNode,Fc.current=t;var Ce=ie&&typeof o.getDerivedStateFromError!="function"?null:f.render();return t.flags|=1,e!==null&&ie?(t.child=vs(t,e.child,null,B),t.child=vs(t,null,Ce,B)):Xi(e,t,Ce,B),t.memoizedState=f.state,D&&Dl(t,o,!0),t.child}function Mu(e){var t=e.stateNode;t.pendingContext?Rl(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Rl(e,t.context,!1),va(e,t.containerInfo)}function ku(e,t,o,f,D){return gs(),ca(D),t.flags|=256,Xi(e,t,o,f),t.child}var La={dehydrated:null,treeContext:null,retryLane:0};function Oa(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ru(e,t,o){var f=t.pendingProps,D=oi.current,B=!1,ie=(t.flags&128)!==0,Ce;if((Ce=ie)||(Ce=e!==null&&e.memoizedState===null?!1:(D&2)!==0),Ce?(B=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(D|=1),Yr(oi,D&1),e===null)return ua(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?((t.mode&1)===0?t.lanes=1:e.data==="$!"?t.lanes=8:t.lanes=1073741824,null):(ie=f.children,e=f.fallback,B?(f=t.mode,B=t.child,ie={mode:"hidden",children:ie},(f&1)===0&&B!==null?(B.childLanes=0,B.pendingProps=ie):B=Lo(ie,f,0,null),e=ss(e,f,o,null),B.return=t,e.return=t,B.sibling=e,t.child=B,t.child.memoizedState=Oa(o),t.memoizedState=La,e):Fa(t,ie));if(D=e.memoizedState,D!==null&&(Ce=D.dehydrated,Ce!==null))return Nc(e,t,ie,f,Ce,D,o);if(B){B=f.fallback,ie=t.mode,D=e.child,Ce=D.sibling;var Fe={mode:"hidden",children:f.children};return(ie&1)===0&&t.child!==D?(f=t.child,f.childLanes=0,f.pendingProps=Fe,t.deletions=null):(f=Gn(D,Fe),f.subtreeFlags=D.subtreeFlags&14680064),Ce!==null?B=Gn(Ce,B):(B=ss(B,ie,o,null),B.flags|=2),B.return=t,f.return=t,f.sibling=B,t.child=f,f=B,B=t.child,ie=e.child.memoizedState,ie=ie===null?Oa(o):{baseLanes:ie.baseLanes|o,cachePool:null,transitions:ie.transitions},B.memoizedState=ie,B.childLanes=e.childLanes&~o,t.memoizedState=La,f}return B=e.child,e=B.sibling,f=Gn(B,{mode:"visible",children:f.children}),(t.mode&1)===0&&(f.lanes=o),f.return=t,f.sibling=null,e!==null&&(o=t.deletions,o===null?(t.deletions=[e],t.flags|=16):o.push(e)),t.child=f,t.memoizedState=null,f}function Fa(e,t){return t=Lo({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function bo(e,t,o,f){return f!==null&&ca(f),vs(t,e.child,null,o),e=Fa(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Nc(e,t,o,f,D,B,ie){if(o)return t.flags&256?(t.flags&=-257,f=Pa(Error(a(422))),bo(e,t,ie,f)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(B=f.fallback,D=t.mode,f=Lo({mode:"visible",children:f.children},D,0,null),B=ss(B,D,ie,null),B.flags|=2,f.return=t,B.return=t,f.sibling=B,t.child=f,(t.mode&1)!==0&&vs(t,e.child,null,ie),t.child.memoizedState=Oa(ie),t.memoizedState=La,B);if((t.mode&1)===0)return bo(e,t,ie,null);if(D.data==="$!"){if(f=D.nextSibling&&D.nextSibling.dataset,f)var Ce=f.dgst;return f=Ce,B=Error(a(419)),f=Pa(B,f,void 0),bo(e,t,ie,f)}if(Ce=(ie&e.childLanes)!==0,Qi||Ce){if(f=Ri,f!==null){switch(ie&-ie){case 4:D=2;break;case 16:D=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:D=32;break;case 536870912:D=268435456;break;default:D=0}D=(D&(f.suspendedLanes|ie))!==0?0:D,D!==0&&D!==B.retryLane&&(B.retryLane=D,Tn(e,D),yn(f,e,D,-1))}return Ja(),f=Pa(Error(a(421))),bo(e,t,ie,f)}return D.data==="$?"?(t.flags|=128,t.child=e.child,t=Zc.bind(null,e),D._reactRetry=t,null):(e=B.treeContext,nn=Dn(D.nextSibling),rn=t,ti=!0,pn=null,e!==null&&(an[ln++]=An,an[ln++]=Cn,an[ln++]=Yn,An=e.id,Cn=e.overflow,Yn=t),t=Fa(t,f.children),t.flags|=4096,t)}function Pu(e,t,o){e.lanes|=t;var f=e.alternate;f!==null&&(f.lanes|=t),pa(e.return,t,o)}function Na(e,t,o,f,D){var B=e.memoizedState;B===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:f,tail:o,tailMode:D}:(B.isBackwards=t,B.rendering=null,B.renderingStartTime=0,B.last=f,B.tail=o,B.tailMode=D)}function Du(e,t,o){var f=t.pendingProps,D=f.revealOrder,B=f.tail;if(Xi(e,t,f.children,o),f=oi.current,(f&2)!==0)f=f&1|2,t.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Pu(e,o,t);else if(e.tag===19)Pu(e,o,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}f&=1}if(Yr(oi,f),(t.mode&1)===0)t.memoizedState=null;else switch(D){case"forwards":for(o=t.child,D=null;o!==null;)e=o.alternate,e!==null&&mo(e)===null&&(D=o),o=o.sibling;o=D,o===null?(D=t.child,t.child=null):(D=o.sibling,o.sibling=null),Na(t,!1,D,o,B);break;case"backwards":for(o=null,D=t.child,t.child=null;D!==null;){if(e=D.alternate,e!==null&&mo(e)===null){t.child=D;break}e=D.sibling,D.sibling=o,o=D,D=e}Na(t,!0,o,null,B);break;case"together":Na(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function So(e,t){(t.mode&1)===0&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function kn(e,t,o){if(e!==null&&(t.dependencies=e.dependencies),ts|=t.lanes,(o&t.childLanes)===0)return null;if(e!==null&&t.child!==e.child)throw Error(a(153));if(t.child!==null){for(e=t.child,o=Gn(e,e.pendingProps),t.child=o,o.return=t;e.sibling!==null;)e=e.sibling,o=o.sibling=Gn(e,e.pendingProps),o.return=t;o.sibling=null}return t.child}function Vc(e,t,o){switch(t.tag){case 3:Mu(t),gs();break;case 5:Xl(t);break;case 1:Zi(t.type)&&no(t);break;case 4:va(t,t.stateNode.containerInfo);break;case 10:var f=t.type._context,D=t.memoizedProps.value;Yr(co,f._currentValue),f._currentValue=D;break;case 13:if(f=t.memoizedState,f!==null)return f.dehydrated!==null?(Yr(oi,oi.current&1),t.flags|=128,null):(o&t.child.childLanes)!==0?Ru(e,t,o):(Yr(oi,oi.current&1),e=kn(e,t,o),e!==null?e.sibling:null);Yr(oi,oi.current&1);break;case 19:if(f=(o&t.childLanes)!==0,(e.flags&128)!==0){if(f)return Du(e,t,o);t.flags|=128}if(D=t.memoizedState,D!==null&&(D.rendering=null,D.tail=null,D.lastEffect=null),Yr(oi,oi.current),f)break;return null;case 22:case 23:return t.lanes=0,Au(e,t,o)}return kn(e,t,o)}var zu,Va,Iu,Lu;zu=function(e,t){for(var o=t.child;o!==null;){if(o.tag===5||o.tag===6)e.appendChild(o.stateNode);else if(o.tag!==4&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===t)break;for(;o.sibling===null;){if(o.return===null||o.return===t)return;o=o.return}o.sibling.return=o.return,o=o.sibling}},Va=function(){},Iu=function(e,t,o,f){var D=e.memoizedProps;if(D!==f){e=t.stateNode,Jn(_n.current);var B=null;switch(o){case"input":D=or(e,D),f=or(e,f),B=[];break;case"select":D=Re({},D,{value:void 0}),f=Re({},f,{value:void 0}),B=[];break;case"textarea":D=Rr(e,D),f=Rr(e,f),B=[];break;default:typeof D.onClick!="function"&&typeof f.onClick=="function"&&(e.onclick=to)}It(o,f);var ie;o=null;for(Ye in D)if(!f.hasOwnProperty(Ye)&&D.hasOwnProperty(Ye)&&D[Ye]!=null)if(Ye==="style"){var Ce=D[Ye];for(ie in Ce)Ce.hasOwnProperty(ie)&&(o||(o={}),o[ie]="")}else Ye!=="dangerouslySetInnerHTML"&&Ye!=="children"&&Ye!=="suppressContentEditableWarning"&&Ye!=="suppressHydrationWarning"&&Ye!=="autoFocus"&&(d.hasOwnProperty(Ye)?B||(B=[]):(B=B||[]).push(Ye,null));for(Ye in f){var Fe=f[Ye];if(Ce=D?.[Ye],f.hasOwnProperty(Ye)&&Fe!==Ce&&(Fe!=null||Ce!=null))if(Ye==="style")if(Ce){for(ie in Ce)!Ce.hasOwnProperty(ie)||Fe&&Fe.hasOwnProperty(ie)||(o||(o={}),o[ie]="");for(ie in Fe)Fe.hasOwnProperty(ie)&&Ce[ie]!==Fe[ie]&&(o||(o={}),o[ie]=Fe[ie])}else o||(B||(B=[]),B.push(Ye,o)),o=Fe;else Ye==="dangerouslySetInnerHTML"?(Fe=Fe?Fe.__html:void 0,Ce=Ce?Ce.__html:void 0,Fe!=null&&Ce!==Fe&&(B=B||[]).push(Ye,Fe)):Ye==="children"?typeof Fe!="string"&&typeof Fe!="number"||(B=B||[]).push(Ye,""+Fe):Ye!=="suppressContentEditableWarning"&&Ye!=="suppressHydrationWarning"&&(d.hasOwnProperty(Ye)?(Fe!=null&&Ye==="onScroll"&&Qr("scroll",e),B||Ce===Fe||(B=[])):(B=B||[]).push(Ye,Fe))}o&&(B=B||[]).push("style",o);var Ye=B;(t.updateQueue=Ye)&&(t.flags|=4)}},Lu=function(e,t,o,f){o!==f&&(t.flags|=4)};function Gs(e,t){if(!ti)switch(e.tailMode){case"hidden":t=e.tail;for(var o=null;t!==null;)t.alternate!==null&&(o=t),t=t.sibling;o===null?e.tail=null:o.sibling=null;break;case"collapsed":o=e.tail;for(var f=null;o!==null;)o.alternate!==null&&(f=o),o=o.sibling;f===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:f.sibling=null}}function Ui(e){var t=e.alternate!==null&&e.alternate.child===e.child,o=0,f=0;if(t)for(var D=e.child;D!==null;)o|=D.lanes|D.childLanes,f|=D.subtreeFlags&14680064,f|=D.flags&14680064,D.return=e,D=D.sibling;else for(D=e.child;D!==null;)o|=D.lanes|D.childLanes,f|=D.subtreeFlags,f|=D.flags,D.return=e,D=D.sibling;return e.subtreeFlags|=f,e.childLanes=o,t}function jc(e,t,o){var f=t.pendingProps;switch(aa(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ui(t),null;case 1:return Zi(t.type)&&io(),Ui(t),null;case 3:return f=t.stateNode,_s(),Jr(Yi),Jr(ji),_a(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(e===null||e.child===null)&&(lo(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,pn!==null&&(Ya(pn),pn=null))),Va(e,t),Ui(t),null;case 5:ya(t);var D=Jn(Ns.current);if(o=t.type,e!==null&&t.stateNode!=null)Iu(e,t,o,f,D),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!f){if(t.stateNode===null)throw Error(a(166));return Ui(t),null}if(e=Jn(_n.current),lo(t)){f=t.stateNode,o=t.type;var B=t.memoizedProps;switch(f[xn]=t,f[zs]=B,e=(t.mode&1)!==0,o){case"dialog":Qr("cancel",f),Qr("close",f);break;case"iframe":case"object":case"embed":Qr("load",f);break;case"video":case"audio":for(D=0;D<Rs.length;D++)Qr(Rs[D],f);break;case"source":Qr("error",f);break;case"img":case"image":case"link":Qr("error",f),Qr("load",f);break;case"details":Qr("toggle",f);break;case"input":ar(f,B),Qr("invalid",f);break;case"select":f._wrapperState={wasMultiple:!!B.multiple},Qr("invalid",f);break;case"textarea":Ir(f,B),Qr("invalid",f)}It(o,B),D=null;for(var ie in B)if(B.hasOwnProperty(ie)){var Ce=B[ie];ie==="children"?typeof Ce=="string"?f.textContent!==Ce&&(B.suppressHydrationWarning!==!0&&eo(f.textContent,Ce,e),D=["children",Ce]):typeof Ce=="number"&&f.textContent!==""+Ce&&(B.suppressHydrationWarning!==!0&&eo(f.textContent,Ce,e),D=["children",""+Ce]):d.hasOwnProperty(ie)&&Ce!=null&&ie==="onScroll"&&Qr("scroll",f)}switch(o){case"input":at(f),pr(f,B,!0);break;case"textarea":at(f),wi(f);break;case"select":case"option":break;default:typeof B.onClick=="function"&&(f.onclick=to)}f=D,t.updateQueue=f,f!==null&&(t.flags|=4)}else{ie=D.nodeType===9?D:D.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Hi(o)),e==="http://www.w3.org/1999/xhtml"?o==="script"?(e=ie.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof f.is=="string"?e=ie.createElement(o,{is:f.is}):(e=ie.createElement(o),o==="select"&&(ie=e,f.multiple?ie.multiple=!0:f.size&&(ie.size=f.size))):e=ie.createElementNS(e,o),e[xn]=t,e[zs]=f,zu(e,t,!1,!1),t.stateNode=e;e:{switch(ie=mr(o,f),o){case"dialog":Qr("cancel",e),Qr("close",e),D=f;break;case"iframe":case"object":case"embed":Qr("load",e),D=f;break;case"video":case"audio":for(D=0;D<Rs.length;D++)Qr(Rs[D],e);D=f;break;case"source":Qr("error",e),D=f;break;case"img":case"image":case"link":Qr("error",e),Qr("load",e),D=f;break;case"details":Qr("toggle",e),D=f;break;case"input":ar(e,f),D=or(e,f),Qr("invalid",e);break;case"option":D=f;break;case"select":e._wrapperState={wasMultiple:!!f.multiple},D=Re({},f,{value:void 0}),Qr("invalid",e);break;case"textarea":Ir(e,f),D=Rr(e,f),Qr("invalid",e);break;default:D=f}It(o,D),Ce=D;for(B in Ce)if(Ce.hasOwnProperty(B)){var Fe=Ce[B];B==="style"?Lt(e,Fe):B==="dangerouslySetInnerHTML"?(Fe=Fe?Fe.__html:void 0,Fe!=null&&Le(e,Fe)):B==="children"?typeof Fe=="string"?(o!=="textarea"||Fe!=="")&&dt(e,Fe):typeof Fe=="number"&&dt(e,""+Fe):B!=="suppressContentEditableWarning"&&B!=="suppressHydrationWarning"&&B!=="autoFocus"&&(d.hasOwnProperty(B)?Fe!=null&&B==="onScroll"&&Qr("scroll",e):Fe!=null&&w(e,B,Fe,ie))}switch(o){case"input":at(e),pr(e,f,!1);break;case"textarea":at(e),wi(e);break;case"option":f.value!=null&&e.setAttribute("value",""+Ie(f.value));break;case"select":e.multiple=!!f.multiple,B=f.value,B!=null?fi(e,!!f.multiple,B,!1):f.defaultValue!=null&&fi(e,!!f.multiple,f.defaultValue,!0);break;default:typeof D.onClick=="function"&&(e.onclick=to)}switch(o){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}}f&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Ui(t),null;case 6:if(e&&t.stateNode!=null)Lu(e,t,e.memoizedProps,f);else{if(typeof f!="string"&&t.stateNode===null)throw Error(a(166));if(o=Jn(Ns.current),Jn(_n.current),lo(t)){if(f=t.stateNode,o=t.memoizedProps,f[xn]=t,(B=f.nodeValue!==o)&&(e=rn,e!==null))switch(e.tag){case 3:eo(f.nodeValue,o,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&eo(f.nodeValue,o,(e.mode&1)!==0)}B&&(t.flags|=4)}else f=(o.nodeType===9?o:o.ownerDocument).createTextNode(f),f[xn]=t,t.stateNode=f}return Ui(t),null;case 13:if(Jr(oi),f=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(ti&&nn!==null&&(t.mode&1)!==0&&(t.flags&128)===0)Nl(),gs(),t.flags|=98560,B=!1;else if(B=lo(t),f!==null&&f.dehydrated!==null){if(e===null){if(!B)throw Error(a(318));if(B=t.memoizedState,B=B!==null?B.dehydrated:null,!B)throw Error(a(317));B[xn]=t}else gs(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;Ui(t),B=!1}else pn!==null&&(Ya(pn),pn=null),B=!0;if(!B)return t.flags&65536?t:null}return(t.flags&128)!==0?(t.lanes=o,t):(f=f!==null,f!==(e!==null&&e.memoizedState!==null)&&f&&(t.child.flags|=8192,(t.mode&1)!==0&&(e===null||(oi.current&1)!==0?Ei===0&&(Ei=3):Ja())),t.updateQueue!==null&&(t.flags|=4),Ui(t),null);case 4:return _s(),Va(e,t),e===null&&Ps(t.stateNode.containerInfo),Ui(t),null;case 10:return fa(t.type._context),Ui(t),null;case 17:return Zi(t.type)&&io(),Ui(t),null;case 19:if(Jr(oi),B=t.memoizedState,B===null)return Ui(t),null;if(f=(t.flags&128)!==0,ie=B.rendering,ie===null)if(f)Gs(B,!1);else{if(Ei!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(ie=mo(e),ie!==null){for(t.flags|=128,Gs(B,!1),f=ie.updateQueue,f!==null&&(t.updateQueue=f,t.flags|=4),t.subtreeFlags=0,f=o,o=t.child;o!==null;)B=o,e=f,B.flags&=14680066,ie=B.alternate,ie===null?(B.childLanes=0,B.lanes=e,B.child=null,B.subtreeFlags=0,B.memoizedProps=null,B.memoizedState=null,B.updateQueue=null,B.dependencies=null,B.stateNode=null):(B.childLanes=ie.childLanes,B.lanes=ie.lanes,B.child=ie.child,B.subtreeFlags=0,B.deletions=null,B.memoizedProps=ie.memoizedProps,B.memoizedState=ie.memoizedState,B.updateQueue=ie.updateQueue,B.type=ie.type,e=ie.dependencies,B.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),o=o.sibling;return Yr(oi,oi.current&1|2),t.child}e=e.sibling}B.tail!==null&&lt()>Es&&(t.flags|=128,f=!0,Gs(B,!1),t.lanes=4194304)}else{if(!f)if(e=mo(ie),e!==null){if(t.flags|=128,f=!0,o=e.updateQueue,o!==null&&(t.updateQueue=o,t.flags|=4),Gs(B,!0),B.tail===null&&B.tailMode==="hidden"&&!ie.alternate&&!ti)return Ui(t),null}else 2*lt()-B.renderingStartTime>Es&&o!==1073741824&&(t.flags|=128,f=!0,Gs(B,!1),t.lanes=4194304);B.isBackwards?(ie.sibling=t.child,t.child=ie):(o=B.last,o!==null?o.sibling=ie:t.child=ie,B.last=ie)}return B.tail!==null?(t=B.tail,B.rendering=t,B.tail=t.sibling,B.renderingStartTime=lt(),t.sibling=null,o=oi.current,Yr(oi,f?o&1|2:o&1),t):(Ui(t),null);case 22:case 23:return Qa(),f=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==f&&(t.flags|=8192),f&&(t.mode&1)!==0?(sn&1073741824)!==0&&(Ui(t),t.subtreeFlags&6&&(t.flags|=8192)):Ui(t),null;case 24:return null;case 25:return null}throw Error(a(156,t.tag))}function Bc(e,t){switch(aa(t),t.tag){case 1:return Zi(t.type)&&io(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return _s(),Jr(Yi),Jr(ji),_a(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 5:return ya(t),null;case 13:if(Jr(oi),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(a(340));gs()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Jr(oi),null;case 4:return _s(),null;case 10:return fa(t.type._context),null;case 22:case 23:return Qa(),null;case 24:return null;default:return null}}var Eo=!1,Gi=!1,Uc=typeof WeakSet=="function"?WeakSet:Set,Gt=null;function bs(e,t){var o=e.ref;if(o!==null)if(typeof o=="function")try{o(null)}catch(f){di(e,t,f)}else o.current=null}function ja(e,t,o){try{o()}catch(f){di(e,t,f)}}var Ou=!1;function Gc(e,t){if(Qo=et,e=pl(),Ho(e)){if("selectionStart"in e)var o={start:e.selectionStart,end:e.selectionEnd};else e:{o=(o=e.ownerDocument)&&o.defaultView||window;var f=o.getSelection&&o.getSelection();if(f&&f.rangeCount!==0){o=f.anchorNode;var D=f.anchorOffset,B=f.focusNode;f=f.focusOffset;try{o.nodeType,B.nodeType}catch{o=null;break e}var ie=0,Ce=-1,Fe=-1,Ye=0,xt=0,bt=e,vt=null;t:for(;;){for(var jt;bt!==o||D!==0&&bt.nodeType!==3||(Ce=ie+D),bt!==B||f!==0&&bt.nodeType!==3||(Fe=ie+f),bt.nodeType===3&&(ie+=bt.nodeValue.length),(jt=bt.firstChild)!==null;)vt=bt,bt=jt;for(;;){if(bt===e)break t;if(vt===o&&++Ye===D&&(Ce=ie),vt===B&&++xt===f&&(Fe=ie),(jt=bt.nextSibling)!==null)break;bt=vt,vt=bt.parentNode}bt=jt}o=Ce===-1||Fe===-1?null:{start:Ce,end:Fe}}else o=null}o=o||{start:0,end:0}}else o=null;for(Jo={focusedElem:e,selectionRange:o},et=!1,Gt=t;Gt!==null;)if(t=Gt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Gt=e;else for(;Gt!==null;){t=Gt;try{var Xt=t.alternate;if((t.flags&1024)!==0)switch(t.tag){case 0:case 11:case 15:break;case 1:if(Xt!==null){var $t=Xt.memoizedProps,mi=Xt.memoizedState,Xe=t.stateNode,je=Xe.getSnapshotBeforeUpdate(t.elementType===t.type?$t:mn(t.type,$t),mi);Xe.__reactInternalSnapshotBeforeUpdate=je}break;case 3:var qe=t.stateNode.containerInfo;qe.nodeType===1?qe.textContent="":qe.nodeType===9&&qe.documentElement&&qe.removeChild(qe.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(a(163))}}catch(Tt){di(t,t.return,Tt)}if(e=t.sibling,e!==null){e.return=t.return,Gt=e;break}Gt=t.return}return Xt=Ou,Ou=!1,Xt}function Hs(e,t,o){var f=t.updateQueue;if(f=f!==null?f.lastEffect:null,f!==null){var D=f=f.next;do{if((D.tag&e)===e){var B=D.destroy;D.destroy=void 0,B!==void 0&&ja(t,o,B)}D=D.next}while(D!==f)}}function Ao(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var o=t=t.next;do{if((o.tag&e)===e){var f=o.create;o.destroy=f()}o=o.next}while(o!==t)}}function Ba(e){var t=e.ref;if(t!==null){var o=e.stateNode;e.tag,e=o,typeof t=="function"?t(e):t.current=e}}function Fu(e){var t=e.alternate;t!==null&&(e.alternate=null,Fu(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[xn],delete t[zs],delete t[ia],delete t[Ac],delete t[Cc])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Nu(e){return e.tag===5||e.tag===3||e.tag===4}function Vu(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Nu(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Ua(e,t,o){var f=e.tag;if(f===5||f===6)e=e.stateNode,t?o.nodeType===8?o.parentNode.insertBefore(e,t):o.insertBefore(e,t):(o.nodeType===8?(t=o.parentNode,t.insertBefore(e,o)):(t=o,t.appendChild(e)),o=o._reactRootContainer,o!=null||t.onclick!==null||(t.onclick=to));else if(f!==4&&(e=e.child,e!==null))for(Ua(e,t,o),e=e.sibling;e!==null;)Ua(e,t,o),e=e.sibling}function Ga(e,t,o){var f=e.tag;if(f===5||f===6)e=e.stateNode,t?o.insertBefore(e,t):o.appendChild(e);else if(f!==4&&(e=e.child,e!==null))for(Ga(e,t,o),e=e.sibling;e!==null;)Ga(e,t,o),e=e.sibling}var Oi=null,gn=!1;function Nn(e,t,o){for(o=o.child;o!==null;)ju(e,t,o),o=o.sibling}function ju(e,t,o){if(Cr&&typeof Cr.onCommitFiberUnmount=="function")try{Cr.onCommitFiberUnmount(Ar,o)}catch{}switch(o.tag){case 5:Gi||bs(o,t);case 6:var f=Oi,D=gn;Oi=null,Nn(e,t,o),Oi=f,gn=D,Oi!==null&&(gn?(e=Oi,o=o.stateNode,e.nodeType===8?e.parentNode.removeChild(o):e.removeChild(o)):Oi.removeChild(o.stateNode));break;case 18:Oi!==null&&(gn?(e=Oi,o=o.stateNode,e.nodeType===8?ra(e.parentNode,o):e.nodeType===1&&ra(e,o),pt(e)):ra(Oi,o.stateNode));break;case 4:f=Oi,D=gn,Oi=o.stateNode.containerInfo,gn=!0,Nn(e,t,o),Oi=f,gn=D;break;case 0:case 11:case 14:case 15:if(!Gi&&(f=o.updateQueue,f!==null&&(f=f.lastEffect,f!==null))){D=f=f.next;do{var B=D,ie=B.destroy;B=B.tag,ie!==void 0&&((B&2)!==0||(B&4)!==0)&&ja(o,t,ie),D=D.next}while(D!==f)}Nn(e,t,o);break;case 1:if(!Gi&&(bs(o,t),f=o.stateNode,typeof f.componentWillUnmount=="function"))try{f.props=o.memoizedProps,f.state=o.memoizedState,f.componentWillUnmount()}catch(Ce){di(o,t,Ce)}Nn(e,t,o);break;case 21:Nn(e,t,o);break;case 22:o.mode&1?(Gi=(f=Gi)||o.memoizedState!==null,Nn(e,t,o),Gi=f):Nn(e,t,o);break;default:Nn(e,t,o)}}function Bu(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var o=e.stateNode;o===null&&(o=e.stateNode=new Uc),t.forEach(function(f){var D=Qc.bind(null,e,f);o.has(f)||(o.add(f),f.then(D,D))})}}function vn(e,t){var o=t.deletions;if(o!==null)for(var f=0;f<o.length;f++){var D=o[f];try{var B=e,ie=t,Ce=ie;e:for(;Ce!==null;){switch(Ce.tag){case 5:Oi=Ce.stateNode,gn=!1;break e;case 3:Oi=Ce.stateNode.containerInfo,gn=!0;break e;case 4:Oi=Ce.stateNode.containerInfo,gn=!0;break e}Ce=Ce.return}if(Oi===null)throw Error(a(160));ju(B,ie,D),Oi=null,gn=!1;var Fe=D.alternate;Fe!==null&&(Fe.return=null),D.return=null}catch(Ye){di(D,t,Ye)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Uu(t,e),t=t.sibling}function Uu(e,t){var o=e.alternate,f=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(vn(t,e),bn(e),f&4){try{Hs(3,e,e.return),Ao(3,e)}catch($t){di(e,e.return,$t)}try{Hs(5,e,e.return)}catch($t){di(e,e.return,$t)}}break;case 1:vn(t,e),bn(e),f&512&&o!==null&&bs(o,o.return);break;case 5:if(vn(t,e),bn(e),f&512&&o!==null&&bs(o,o.return),e.flags&32){var D=e.stateNode;try{dt(D,"")}catch($t){di(e,e.return,$t)}}if(f&4&&(D=e.stateNode,D!=null)){var B=e.memoizedProps,ie=o!==null?o.memoizedProps:B,Ce=e.type,Fe=e.updateQueue;if(e.updateQueue=null,Fe!==null)try{Ce==="input"&&B.type==="radio"&&B.name!=null&&kr(D,B),mr(Ce,ie);var Ye=mr(Ce,B);for(ie=0;ie<Fe.length;ie+=2){var xt=Fe[ie],bt=Fe[ie+1];xt==="style"?Lt(D,bt):xt==="dangerouslySetInnerHTML"?Le(D,bt):xt==="children"?dt(D,bt):w(D,xt,bt,Ye)}switch(Ce){case"input":Er(D,B);break;case"textarea":Di(D,B);break;case"select":var vt=D._wrapperState.wasMultiple;D._wrapperState.wasMultiple=!!B.multiple;var jt=B.value;jt!=null?fi(D,!!B.multiple,jt,!1):vt!==!!B.multiple&&(B.defaultValue!=null?fi(D,!!B.multiple,B.defaultValue,!0):fi(D,!!B.multiple,B.multiple?[]:"",!1))}D[zs]=B}catch($t){di(e,e.return,$t)}}break;case 6:if(vn(t,e),bn(e),f&4){if(e.stateNode===null)throw Error(a(162));D=e.stateNode,B=e.memoizedProps;try{D.nodeValue=B}catch($t){di(e,e.return,$t)}}break;case 3:if(vn(t,e),bn(e),f&4&&o!==null&&o.memoizedState.isDehydrated)try{pt(t.containerInfo)}catch($t){di(e,e.return,$t)}break;case 4:vn(t,e),bn(e);break;case 13:vn(t,e),bn(e),D=e.child,D.flags&8192&&(B=D.memoizedState!==null,D.stateNode.isHidden=B,!B||D.alternate!==null&&D.alternate.memoizedState!==null||(Xa=lt())),f&4&&Bu(e);break;case 22:if(xt=o!==null&&o.memoizedState!==null,e.mode&1?(Gi=(Ye=Gi)||xt,vn(t,e),Gi=Ye):vn(t,e),bn(e),f&8192){if(Ye=e.memoizedState!==null,(e.stateNode.isHidden=Ye)&&!xt&&(e.mode&1)!==0)for(Gt=e,xt=e.child;xt!==null;){for(bt=Gt=xt;Gt!==null;){switch(vt=Gt,jt=vt.child,vt.tag){case 0:case 11:case 14:case 15:Hs(4,vt,vt.return);break;case 1:bs(vt,vt.return);var Xt=vt.stateNode;if(typeof Xt.componentWillUnmount=="function"){f=vt,o=vt.return;try{t=f,Xt.props=t.memoizedProps,Xt.state=t.memoizedState,Xt.componentWillUnmount()}catch($t){di(f,o,$t)}}break;case 5:bs(vt,vt.return);break;case 22:if(vt.memoizedState!==null){Wu(bt);continue}}jt!==null?(jt.return=vt,Gt=jt):Wu(bt)}xt=xt.sibling}e:for(xt=null,bt=e;;){if(bt.tag===5){if(xt===null){xt=bt;try{D=bt.stateNode,Ye?(B=D.style,typeof B.setProperty=="function"?B.setProperty("display","none","important"):B.display="none"):(Ce=bt.stateNode,Fe=bt.memoizedProps.style,ie=Fe!=null&&Fe.hasOwnProperty("display")?Fe.display:null,Ce.style.display=ht("display",ie))}catch($t){di(e,e.return,$t)}}}else if(bt.tag===6){if(xt===null)try{bt.stateNode.nodeValue=Ye?"":bt.memoizedProps}catch($t){di(e,e.return,$t)}}else if((bt.tag!==22&&bt.tag!==23||bt.memoizedState===null||bt===e)&&bt.child!==null){bt.child.return=bt,bt=bt.child;continue}if(bt===e)break e;for(;bt.sibling===null;){if(bt.return===null||bt.return===e)break e;xt===bt&&(xt=null),bt=bt.return}xt===bt&&(xt=null),bt.sibling.return=bt.return,bt=bt.sibling}}break;case 19:vn(t,e),bn(e),f&4&&Bu(e);break;case 21:break;default:vn(t,e),bn(e)}}function bn(e){var t=e.flags;if(t&2){try{e:{for(var o=e.return;o!==null;){if(Nu(o)){var f=o;break e}o=o.return}throw Error(a(160))}switch(f.tag){case 5:var D=f.stateNode;f.flags&32&&(dt(D,""),f.flags&=-33);var B=Vu(e);Ga(e,B,D);break;case 3:case 4:var ie=f.stateNode.containerInfo,Ce=Vu(e);Ua(e,Ce,ie);break;default:throw Error(a(161))}}catch(Fe){di(e,e.return,Fe)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Hc(e,t,o){Gt=e,Gu(e)}function Gu(e,t,o){for(var f=(e.mode&1)!==0;Gt!==null;){var D=Gt,B=D.child;if(D.tag===22&&f){var ie=D.memoizedState!==null||Eo;if(!ie){var Ce=D.alternate,Fe=Ce!==null&&Ce.memoizedState!==null||Gi;Ce=Eo;var Ye=Gi;if(Eo=ie,(Gi=Fe)&&!Ye)for(Gt=D;Gt!==null;)ie=Gt,Fe=ie.child,ie.tag===22&&ie.memoizedState!==null?Xu(D):Fe!==null?(Fe.return=ie,Gt=Fe):Xu(D);for(;B!==null;)Gt=B,Gu(B),B=B.sibling;Gt=D,Eo=Ce,Gi=Ye}Hu(e)}else(D.subtreeFlags&8772)!==0&&B!==null?(B.return=D,Gt=B):Hu(e)}}function Hu(e){for(;Gt!==null;){var t=Gt;if((t.flags&8772)!==0){var o=t.alternate;try{if((t.flags&8772)!==0)switch(t.tag){case 0:case 11:case 15:Gi||Ao(5,t);break;case 1:var f=t.stateNode;if(t.flags&4&&!Gi)if(o===null)f.componentDidMount();else{var D=t.elementType===t.type?o.memoizedProps:mn(t.type,o.memoizedProps);f.componentDidUpdate(D,o.memoizedState,f.__reactInternalSnapshotBeforeUpdate)}var B=t.updateQueue;B!==null&&Wl(t,B,f);break;case 3:var ie=t.updateQueue;if(ie!==null){if(o=null,t.child!==null)switch(t.child.tag){case 5:o=t.child.stateNode;break;case 1:o=t.child.stateNode}Wl(t,ie,o)}break;case 5:var Ce=t.stateNode;if(o===null&&t.flags&4){o=Ce;var Fe=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":Fe.autoFocus&&o.focus();break;case"img":Fe.src&&(o.src=Fe.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var Ye=t.alternate;if(Ye!==null){var xt=Ye.memoizedState;if(xt!==null){var bt=xt.dehydrated;bt!==null&&pt(bt)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(a(163))}Gi||t.flags&512&&Ba(t)}catch(vt){di(t,t.return,vt)}}if(t===e){Gt=null;break}if(o=t.sibling,o!==null){o.return=t.return,Gt=o;break}Gt=t.return}}function Wu(e){for(;Gt!==null;){var t=Gt;if(t===e){Gt=null;break}var o=t.sibling;if(o!==null){o.return=t.return,Gt=o;break}Gt=t.return}}function Xu(e){for(;Gt!==null;){var t=Gt;try{switch(t.tag){case 0:case 11:case 15:var o=t.return;try{Ao(4,t)}catch(Fe){di(t,o,Fe)}break;case 1:var f=t.stateNode;if(typeof f.componentDidMount=="function"){var D=t.return;try{f.componentDidMount()}catch(Fe){di(t,D,Fe)}}var B=t.return;try{Ba(t)}catch(Fe){di(t,B,Fe)}break;case 5:var ie=t.return;try{Ba(t)}catch(Fe){di(t,ie,Fe)}}}catch(Fe){di(t,t.return,Fe)}if(t===e){Gt=null;break}var Ce=t.sibling;if(Ce!==null){Ce.return=t.return,Gt=Ce;break}Gt=t.return}}var Wc=Math.ceil,Co=N.ReactCurrentDispatcher,Ha=N.ReactCurrentOwner,hn=N.ReactCurrentBatchConfig,Nr=0,Ri=null,_i=null,Fi=0,sn=0,Ss=zn(0),Ei=0,Ws=null,ts=0,To=0,Wa=0,Xs=null,Ji=null,Xa=0,Es=1/0,Rn=null,Mo=!1,Ka=null,Vn=null,ko=!1,jn=null,Ro=0,Ks=0,$a=null,Po=-1,Do=0;function Ki(){return(Nr&6)!==0?lt():Po!==-1?Po:Po=lt()}function Bn(e){return(e.mode&1)===0?1:(Nr&2)!==0&&Fi!==0?Fi&-Fi:Mc.transition!==null?(Do===0&&(Do=E()),Do):(e=P,e!==0||(e=window.event,e=e===void 0?16:Rt(e.type)),e)}function yn(e,t,o,f){if(50<Ks)throw Ks=0,$a=null,Error(a(185));A(e,o,f),((Nr&2)===0||e!==Ri)&&(e===Ri&&((Nr&2)===0&&(To|=o),Ei===4&&Un(e,Fi)),en(e,f),o===1&&Nr===0&&(t.mode&1)===0&&(Es=lt()+500,so&&Ln()))}function en(e,t){var o=e.callbackNode;l(e,t);var f=i(e,e===Ri?Fi:0);if(f===0)o!==null&&Ve(o),e.callbackNode=null,e.callbackPriority=0;else if(t=f&-f,e.callbackPriority!==t){if(o!=null&&Ve(o),t===1)e.tag===0?Tc($u.bind(null,e)):zl($u.bind(null,e)),Sc(function(){(Nr&6)===0&&Ln()}),o=null;else{switch(L(f)){case 1:o=Mt;break;case 4:o=Pt;break;case 16:o=Ot;break;case 536870912:o=Zt;break;default:o=Ot}o=rc(o,Ku.bind(null,e))}e.callbackPriority=t,e.callbackNode=o}}function Ku(e,t){if(Po=-1,Do=0,(Nr&6)!==0)throw Error(a(327));var o=e.callbackNode;if(As()&&e.callbackNode!==o)return null;var f=i(e,e===Ri?Fi:0);if(f===0)return null;if((f&30)!==0||(f&e.expiredLanes)!==0||t)t=zo(e,f);else{t=f;var D=Nr;Nr|=2;var B=Yu();(Ri!==e||Fi!==t)&&(Rn=null,Es=lt()+500,is(e,t));do try{$c();break}catch(Ce){qu(e,Ce)}while(!0);da(),Co.current=B,Nr=D,_i!==null?t=0:(Ri=null,Fi=0,t=Ei)}if(t!==0){if(t===2&&(D=h(e),D!==0&&(f=D,t=qa(e,D))),t===1)throw o=Ws,is(e,0),Un(e,f),en(e,lt()),o;if(t===6)Un(e,f);else{if(D=e.current.alternate,(f&30)===0&&!Xc(D)&&(t=zo(e,f),t===2&&(B=h(e),B!==0&&(f=B,t=qa(e,B))),t===1))throw o=Ws,is(e,0),Un(e,f),en(e,lt()),o;switch(e.finishedWork=D,e.finishedLanes=f,t){case 0:case 1:throw Error(a(345));case 2:ns(e,Ji,Rn);break;case 3:if(Un(e,f),(f&130023424)===f&&(t=Xa+500-lt(),10<t)){if(i(e,0)!==0)break;if(D=e.suspendedLanes,(D&f)!==f){Ki(),e.pingedLanes|=e.suspendedLanes&D;break}e.timeoutHandle=ta(ns.bind(null,e,Ji,Rn),t);break}ns(e,Ji,Rn);break;case 4:if(Un(e,f),(f&4194240)===f)break;for(t=e.eventTimes,D=-1;0<f;){var ie=31-_r(f);B=1<<ie,ie=t[ie],ie>D&&(D=ie),f&=~B}if(f=D,f=lt()-f,f=(120>f?120:480>f?480:1080>f?1080:1920>f?1920:3e3>f?3e3:4320>f?4320:1960*Wc(f/1960))-f,10<f){e.timeoutHandle=ta(ns.bind(null,e,Ji,Rn),f);break}ns(e,Ji,Rn);break;case 5:ns(e,Ji,Rn);break;default:throw Error(a(329))}}}return en(e,lt()),e.callbackNode===o?Ku.bind(null,e):null}function qa(e,t){var o=Xs;return e.current.memoizedState.isDehydrated&&(is(e,t).flags|=256),e=zo(e,t),e!==2&&(t=Ji,Ji=o,t!==null&&Ya(t)),e}function Ya(e){Ji===null?Ji=e:Ji.push.apply(Ji,e)}function Xc(e){for(var t=e;;){if(t.flags&16384){var o=t.updateQueue;if(o!==null&&(o=o.stores,o!==null))for(var f=0;f<o.length;f++){var D=o[f],B=D.getSnapshot;D=D.value;try{if(!fn(B(),D))return!1}catch{return!1}}}if(o=t.child,t.subtreeFlags&16384&&o!==null)o.return=t,t=o;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Un(e,t){for(t&=~Wa,t&=~To,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var o=31-_r(t),f=1<<o;e[o]=-1,t&=~f}}function $u(e){if((Nr&6)!==0)throw Error(a(327));As();var t=i(e,0);if((t&1)===0)return en(e,lt()),null;var o=zo(e,t);if(e.tag!==0&&o===2){var f=h(e);f!==0&&(t=f,o=qa(e,f))}if(o===1)throw o=Ws,is(e,0),Un(e,t),en(e,lt()),o;if(o===6)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ns(e,Ji,Rn),en(e,lt()),null}function Za(e,t){var o=Nr;Nr|=1;try{return e(t)}finally{Nr=o,Nr===0&&(Es=lt()+500,so&&Ln())}}function rs(e){jn!==null&&jn.tag===0&&(Nr&6)===0&&As();var t=Nr;Nr|=1;var o=hn.transition,f=P;try{if(hn.transition=null,P=1,e)return e()}finally{P=f,hn.transition=o,Nr=t,(Nr&6)===0&&Ln()}}function Qa(){sn=Ss.current,Jr(Ss)}function is(e,t){e.finishedWork=null,e.finishedLanes=0;var o=e.timeoutHandle;if(o!==-1&&(e.timeoutHandle=-1,bc(o)),_i!==null)for(o=_i.return;o!==null;){var f=o;switch(aa(f),f.tag){case 1:f=f.type.childContextTypes,f!=null&&io();break;case 3:_s(),Jr(Yi),Jr(ji),_a();break;case 5:ya(f);break;case 4:_s();break;case 13:Jr(oi);break;case 19:Jr(oi);break;case 10:fa(f.type._context);break;case 22:case 23:Qa()}o=o.return}if(Ri=e,_i=e=Gn(e.current,null),Fi=sn=t,Ei=0,Ws=null,Wa=To=ts=0,Ji=Xs=null,Qn!==null){for(t=0;t<Qn.length;t++)if(o=Qn[t],f=o.interleaved,f!==null){o.interleaved=null;var D=f.next,B=o.pending;if(B!==null){var ie=B.next;B.next=D,f.next=ie}o.pending=f}Qn=null}return e}function qu(e,t){do{var o=_i;try{if(da(),go.current=_o,vo){for(var f=ai.memoizedState;f!==null;){var D=f.queue;D!==null&&(D.pending=null),f=f.next}vo=!1}if(es=0,ki=Si=ai=null,Vs=!1,js=0,Ha.current=null,o===null||o.return===null){Ei=1,Ws=t,_i=null;break}e:{var B=e,ie=o.return,Ce=o,Fe=t;if(t=Fi,Ce.flags|=32768,Fe!==null&&typeof Fe=="object"&&typeof Fe.then=="function"){var Ye=Fe,xt=Ce,bt=xt.tag;if((xt.mode&1)===0&&(bt===0||bt===11||bt===15)){var vt=xt.alternate;vt?(xt.updateQueue=vt.updateQueue,xt.memoizedState=vt.memoizedState,xt.lanes=vt.lanes):(xt.updateQueue=null,xt.memoizedState=null)}var jt=_u(ie);if(jt!==null){jt.flags&=-257,wu(jt,ie,Ce,B,t),jt.mode&1&&xu(B,Ye,t),t=jt,Fe=Ye;var Xt=t.updateQueue;if(Xt===null){var $t=new Set;$t.add(Fe),t.updateQueue=$t}else Xt.add(Fe);break e}else{if((t&1)===0){xu(B,Ye,t),Ja();break e}Fe=Error(a(426))}}else if(ti&&Ce.mode&1){var mi=_u(ie);if(mi!==null){(mi.flags&65536)===0&&(mi.flags|=256),wu(mi,ie,Ce,B,t),ca(ws(Fe,Ce));break e}}B=Fe=ws(Fe,Ce),Ei!==4&&(Ei=2),Xs===null?Xs=[B]:Xs.push(B),B=ie;do{switch(B.tag){case 3:B.flags|=65536,t&=-t,B.lanes|=t;var Xe=vu(B,Fe,t);Hl(B,Xe);break e;case 1:Ce=Fe;var je=B.type,qe=B.stateNode;if((B.flags&128)===0&&(typeof je.getDerivedStateFromError=="function"||qe!==null&&typeof qe.componentDidCatch=="function"&&(Vn===null||!Vn.has(qe)))){B.flags|=65536,t&=-t,B.lanes|=t;var Tt=yu(B,Ce,t);Hl(B,Tt);break e}}B=B.return}while(B!==null)}Qu(o)}catch(Yt){t=Yt,_i===o&&o!==null&&(_i=o=o.return);continue}break}while(!0)}function Yu(){var e=Co.current;return Co.current=_o,e===null?_o:e}function Ja(){(Ei===0||Ei===3||Ei===2)&&(Ei=4),Ri===null||(ts&268435455)===0&&(To&268435455)===0||Un(Ri,Fi)}function zo(e,t){var o=Nr;Nr|=2;var f=Yu();(Ri!==e||Fi!==t)&&(Rn=null,is(e,t));do try{Kc();break}catch(D){qu(e,D)}while(!0);if(da(),Nr=o,Co.current=f,_i!==null)throw Error(a(261));return Ri=null,Fi=0,Ei}function Kc(){for(;_i!==null;)Zu(_i)}function $c(){for(;_i!==null&&!Oe();)Zu(_i)}function Zu(e){var t=tc(e.alternate,e,sn);e.memoizedProps=e.pendingProps,t===null?Qu(e):_i=t,Ha.current=null}function Qu(e){var t=e;do{var o=t.alternate;if(e=t.return,(t.flags&32768)===0){if(o=jc(o,t,sn),o!==null){_i=o;return}}else{if(o=Bc(o,t),o!==null){o.flags&=32767,_i=o;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ei=6,_i=null;return}}if(t=t.sibling,t!==null){_i=t;return}_i=t=e}while(t!==null);Ei===0&&(Ei=5)}function ns(e,t,o){var f=P,D=hn.transition;try{hn.transition=null,P=1,qc(e,t,o,f)}finally{hn.transition=D,P=f}return null}function qc(e,t,o,f){do As();while(jn!==null);if((Nr&6)!==0)throw Error(a(327));o=e.finishedWork;var D=e.finishedLanes;if(o===null)return null;if(e.finishedWork=null,e.finishedLanes=0,o===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var B=o.lanes|o.childLanes;if(M(e,B),e===Ri&&(_i=Ri=null,Fi=0),(o.subtreeFlags&2064)===0&&(o.flags&2064)===0||ko||(ko=!0,rc(Ot,function(){return As(),null})),B=(o.flags&15990)!==0,(o.subtreeFlags&15990)!==0||B){B=hn.transition,hn.transition=null;var ie=P;P=1;var Ce=Nr;Nr|=4,Ha.current=null,Gc(e,o),Uu(o,e),mc(Jo),et=!!Qo,Jo=Qo=null,e.current=o,Hc(o),yt(),Nr=Ce,P=ie,hn.transition=B}else e.current=o;if(ko&&(ko=!1,jn=e,Ro=D),B=e.pendingLanes,B===0&&(Vn=null),Ur(o.stateNode),en(e,lt()),t!==null)for(f=e.onRecoverableError,o=0;o<t.length;o++)D=t[o],f(D.value,{componentStack:D.stack,digest:D.digest});if(Mo)throw Mo=!1,e=Ka,Ka=null,e;return(Ro&1)!==0&&e.tag!==0&&As(),B=e.pendingLanes,(B&1)!==0?e===$a?Ks++:(Ks=0,$a=e):Ks=0,Ln(),null}function As(){if(jn!==null){var e=L(Ro),t=hn.transition,o=P;try{if(hn.transition=null,P=16>e?16:e,jn===null)var f=!1;else{if(e=jn,jn=null,Ro=0,(Nr&6)!==0)throw Error(a(331));var D=Nr;for(Nr|=4,Gt=e.current;Gt!==null;){var B=Gt,ie=B.child;if((Gt.flags&16)!==0){var Ce=B.deletions;if(Ce!==null){for(var Fe=0;Fe<Ce.length;Fe++){var Ye=Ce[Fe];for(Gt=Ye;Gt!==null;){var xt=Gt;switch(xt.tag){case 0:case 11:case 15:Hs(8,xt,B)}var bt=xt.child;if(bt!==null)bt.return=xt,Gt=bt;else for(;Gt!==null;){xt=Gt;var vt=xt.sibling,jt=xt.return;if(Fu(xt),xt===Ye){Gt=null;break}if(vt!==null){vt.return=jt,Gt=vt;break}Gt=jt}}}var Xt=B.alternate;if(Xt!==null){var $t=Xt.child;if($t!==null){Xt.child=null;do{var mi=$t.sibling;$t.sibling=null,$t=mi}while($t!==null)}}Gt=B}}if((B.subtreeFlags&2064)!==0&&ie!==null)ie.return=B,Gt=ie;else e:for(;Gt!==null;){if(B=Gt,(B.flags&2048)!==0)switch(B.tag){case 0:case 11:case 15:Hs(9,B,B.return)}var Xe=B.sibling;if(Xe!==null){Xe.return=B.return,Gt=Xe;break e}Gt=B.return}}var je=e.current;for(Gt=je;Gt!==null;){ie=Gt;var qe=ie.child;if((ie.subtreeFlags&2064)!==0&&qe!==null)qe.return=ie,Gt=qe;else e:for(ie=je;Gt!==null;){if(Ce=Gt,(Ce.flags&2048)!==0)try{switch(Ce.tag){case 0:case 11:case 15:Ao(9,Ce)}}catch(Yt){di(Ce,Ce.return,Yt)}if(Ce===ie){Gt=null;break e}var Tt=Ce.sibling;if(Tt!==null){Tt.return=Ce.return,Gt=Tt;break e}Gt=Ce.return}}if(Nr=D,Ln(),Cr&&typeof Cr.onPostCommitFiberRoot=="function")try{Cr.onPostCommitFiberRoot(Ar,e)}catch{}f=!0}return f}finally{P=o,hn.transition=t}}return!1}function Ju(e,t,o){t=ws(o,t),t=vu(e,t,1),e=Fn(e,t,1),t=Ki(),e!==null&&(A(e,1,t),en(e,t))}function di(e,t,o){if(e.tag===3)Ju(e,e,o);else for(;t!==null;){if(t.tag===3){Ju(t,e,o);break}else if(t.tag===1){var f=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(Vn===null||!Vn.has(f))){e=ws(o,e),e=yu(t,e,1),t=Fn(t,e,1),e=Ki(),t!==null&&(A(t,1,e),en(t,e));break}}t=t.return}}function Yc(e,t,o){var f=e.pingCache;f!==null&&f.delete(t),t=Ki(),e.pingedLanes|=e.suspendedLanes&o,Ri===e&&(Fi&o)===o&&(Ei===4||Ei===3&&(Fi&130023424)===Fi&&500>lt()-Xa?is(e,0):Wa|=o),en(e,t)}function ec(e,t){t===0&&((e.mode&1)===0?t=1:(t=ri,ri<<=1,(ri&130023424)===0&&(ri=4194304)));var o=Ki();e=Tn(e,t),e!==null&&(A(e,t,o),en(e,o))}function Zc(e){var t=e.memoizedState,o=0;t!==null&&(o=t.retryLane),ec(e,o)}function Qc(e,t){var o=0;switch(e.tag){case 13:var f=e.stateNode,D=e.memoizedState;D!==null&&(o=D.retryLane);break;case 19:f=e.stateNode;break;default:throw Error(a(314))}f!==null&&f.delete(t),ec(e,o)}var tc;tc=function(e,t,o){if(e!==null)if(e.memoizedProps!==t.pendingProps||Yi.current)Qi=!0;else{if((e.lanes&o)===0&&(t.flags&128)===0)return Qi=!1,Vc(e,t,o);Qi=(e.flags&131072)!==0}else Qi=!1,ti&&(t.flags&1048576)!==0&&Il(t,ao,t.index);switch(t.lanes=0,t.tag){case 2:var f=t.type;So(e,t),e=t.pendingProps;var D=fs(t,ji.current);xs(t,o),D=Sa(null,t,f,e,D,o);var B=Ea();return t.flags|=1,typeof D=="object"&&D!==null&&typeof D.render=="function"&&D.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Zi(f)?(B=!0,no(t)):B=!1,t.memoizedState=D.state!==null&&D.state!==void 0?D.state:null,ga(t),D.updater=wo,t.stateNode=D,D._reactInternals=t,Ra(t,f,e,o),t=Ia(null,t,f,!0,B,o)):(t.tag=0,ti&&B&&oa(t),Xi(null,t,D,o),t=t.child),t;case 16:f=t.elementType;e:{switch(So(e,t),e=t.pendingProps,D=f._init,f=D(f._payload),t.type=f,D=t.tag=eh(f),e=mn(f,e),D){case 0:t=za(null,t,f,e,o);break e;case 1:t=Tu(null,t,f,e,o);break e;case 11:t=bu(null,t,f,e,o);break e;case 14:t=Su(null,t,f,mn(f.type,e),o);break e}throw Error(a(306,f,""))}return t;case 0:return f=t.type,D=t.pendingProps,D=t.elementType===f?D:mn(f,D),za(e,t,f,D,o);case 1:return f=t.type,D=t.pendingProps,D=t.elementType===f?D:mn(f,D),Tu(e,t,f,D,o);case 3:e:{if(Mu(t),e===null)throw Error(a(387));f=t.pendingProps,B=t.memoizedState,D=B.element,Gl(e,t),po(t,f,null,o);var ie=t.memoizedState;if(f=ie.element,B.isDehydrated)if(B={element:f,isDehydrated:!1,cache:ie.cache,pendingSuspenseBoundaries:ie.pendingSuspenseBoundaries,transitions:ie.transitions},t.updateQueue.baseState=B,t.memoizedState=B,t.flags&256){D=ws(Error(a(423)),t),t=ku(e,t,f,o,D);break e}else if(f!==D){D=ws(Error(a(424)),t),t=ku(e,t,f,o,D);break e}else for(nn=Dn(t.stateNode.containerInfo.firstChild),rn=t,ti=!0,pn=null,o=Bl(t,null,f,o),t.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(gs(),f===D){t=kn(e,t,o);break e}Xi(e,t,f,o)}t=t.child}return t;case 5:return Xl(t),e===null&&ua(t),f=t.type,D=t.pendingProps,B=e!==null?e.memoizedProps:null,ie=D.children,ea(f,D)?ie=null:B!==null&&ea(f,B)&&(t.flags|=32),Cu(e,t),Xi(e,t,ie,o),t.child;case 6:return e===null&&ua(t),null;case 13:return Ru(e,t,o);case 4:return va(t,t.stateNode.containerInfo),f=t.pendingProps,e===null?t.child=vs(t,null,f,o):Xi(e,t,f,o),t.child;case 11:return f=t.type,D=t.pendingProps,D=t.elementType===f?D:mn(f,D),bu(e,t,f,D,o);case 7:return Xi(e,t,t.pendingProps,o),t.child;case 8:return Xi(e,t,t.pendingProps.children,o),t.child;case 12:return Xi(e,t,t.pendingProps.children,o),t.child;case 10:e:{if(f=t.type._context,D=t.pendingProps,B=t.memoizedProps,ie=D.value,Yr(co,f._currentValue),f._currentValue=ie,B!==null)if(fn(B.value,ie)){if(B.children===D.children&&!Yi.current){t=kn(e,t,o);break e}}else for(B=t.child,B!==null&&(B.return=t);B!==null;){var Ce=B.dependencies;if(Ce!==null){ie=B.child;for(var Fe=Ce.firstContext;Fe!==null;){if(Fe.context===f){if(B.tag===1){Fe=Mn(-1,o&-o),Fe.tag=2;var Ye=B.updateQueue;if(Ye!==null){Ye=Ye.shared;var xt=Ye.pending;xt===null?Fe.next=Fe:(Fe.next=xt.next,xt.next=Fe),Ye.pending=Fe}}B.lanes|=o,Fe=B.alternate,Fe!==null&&(Fe.lanes|=o),pa(B.return,o,t),Ce.lanes|=o;break}Fe=Fe.next}}else if(B.tag===10)ie=B.type===t.type?null:B.child;else if(B.tag===18){if(ie=B.return,ie===null)throw Error(a(341));ie.lanes|=o,Ce=ie.alternate,Ce!==null&&(Ce.lanes|=o),pa(ie,o,t),ie=B.sibling}else ie=B.child;if(ie!==null)ie.return=B;else for(ie=B;ie!==null;){if(ie===t){ie=null;break}if(B=ie.sibling,B!==null){B.return=ie.return,ie=B;break}ie=ie.return}B=ie}Xi(e,t,D.children,o),t=t.child}return t;case 9:return D=t.type,f=t.pendingProps.children,xs(t,o),D=un(D),f=f(D),t.flags|=1,Xi(e,t,f,o),t.child;case 14:return f=t.type,D=mn(f,t.pendingProps),D=mn(f.type,D),Su(e,t,f,D,o);case 15:return Eu(e,t,t.type,t.pendingProps,o);case 17:return f=t.type,D=t.pendingProps,D=t.elementType===f?D:mn(f,D),So(e,t),t.tag=1,Zi(f)?(e=!0,no(t)):e=!1,xs(t,o),mu(t,f,D),Ra(t,f,D,o),Ia(null,t,f,!0,e,o);case 19:return Du(e,t,o);case 22:return Au(e,t,o)}throw Error(a(156,t.tag))};function rc(e,t){return xe(e,t)}function Jc(e,t,o,f){this.tag=e,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function dn(e,t,o,f){return new Jc(e,t,o,f)}function el(e){return e=e.prototype,!(!e||!e.isReactComponent)}function eh(e){if(typeof e=="function")return el(e)?1:0;if(e!=null){if(e=e.$$typeof,e===ge)return 11;if(e===ue)return 14}return 2}function Gn(e,t){var o=e.alternate;return o===null?(o=dn(e.tag,t,e.key,e.mode),o.elementType=e.elementType,o.type=e.type,o.stateNode=e.stateNode,o.alternate=e,e.alternate=o):(o.pendingProps=t,o.type=e.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=e.flags&14680064,o.childLanes=e.childLanes,o.lanes=e.lanes,o.child=e.child,o.memoizedProps=e.memoizedProps,o.memoizedState=e.memoizedState,o.updateQueue=e.updateQueue,t=e.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},o.sibling=e.sibling,o.index=e.index,o.ref=e.ref,o}function Io(e,t,o,f,D,B){var ie=2;if(f=e,typeof e=="function")el(e)&&(ie=1);else if(typeof e=="string")ie=5;else e:switch(e){case Y:return ss(o.children,D,B,t);case O:ie=8,D|=8;break;case ee:return e=dn(12,o,t,D|2),e.elementType=ee,e.lanes=B,e;case me:return e=dn(13,o,t,D),e.elementType=me,e.lanes=B,e;case Me:return e=dn(19,o,t,D),e.elementType=Me,e.lanes=B,e;case he:return Lo(o,D,B,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Ae:ie=10;break e;case ce:ie=9;break e;case ge:ie=11;break e;case ue:ie=14;break e;case I:ie=16,f=null;break e}throw Error(a(130,e==null?e:typeof e,""))}return t=dn(ie,o,t,D),t.elementType=e,t.type=f,t.lanes=B,t}function ss(e,t,o,f){return e=dn(7,e,f,t),e.lanes=o,e}function Lo(e,t,o,f){return e=dn(22,e,f,t),e.elementType=he,e.lanes=o,e.stateNode={isHidden:!1},e}function tl(e,t,o){return e=dn(6,e,null,t),e.lanes=o,e}function rl(e,t,o){return t=dn(4,e.children!==null?e.children:[],e.key,t),t.lanes=o,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function th(e,t,o,f,D){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=g(0),this.expirationTimes=g(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=g(0),this.identifierPrefix=f,this.onRecoverableError=D,this.mutableSourceEagerHydrationData=null}function il(e,t,o,f,D,B,ie,Ce,Fe){return e=new th(e,t,o,Ce,Fe),t===1?(t=1,B===!0&&(t|=8)):t=0,B=dn(3,null,null,t),e.current=B,B.stateNode=e,B.memoizedState={element:f,isDehydrated:o,cache:null,transitions:null,pendingSuspenseBoundaries:null},ga(B),e}function rh(e,t,o){var f=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:H,key:f==null?null:""+f,children:e,containerInfo:t,implementation:o}}function ic(e){if(!e)return In;e=e._reactInternals;e:{if(Gr(e)!==e||e.tag!==1)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Zi(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(a(171))}if(e.tag===1){var o=e.type;if(Zi(o))return Pl(e,o,t)}return t}function nc(e,t,o,f,D,B,ie,Ce,Fe){return e=il(o,f,!0,e,D,B,ie,Ce,Fe),e.context=ic(null),o=e.current,f=Ki(),D=Bn(o),B=Mn(f,D),B.callback=t??null,Fn(o,B,D),e.current.lanes=D,A(e,D,f),en(e,f),e}function Oo(e,t,o,f){var D=t.current,B=Ki(),ie=Bn(D);return o=ic(o),t.context===null?t.context=o:t.pendingContext=o,t=Mn(B,ie),t.payload={element:e},f=f===void 0?null:f,f!==null&&(t.callback=f),e=Fn(D,t,ie),e!==null&&(yn(e,D,ie,B),fo(e,D,ie)),ie}function Fo(e){return e=e.current,e.child?(e.child.tag===5,e.child.stateNode):null}function sc(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var o=e.retryLane;e.retryLane=o!==0&&o<t?o:t}}function nl(e,t){sc(e,t),(e=e.alternate)&&sc(e,t)}function ih(){return null}var oc=typeof reportError=="function"?reportError:function(e){console.error(e)};function sl(e){this._internalRoot=e}No.prototype.render=sl.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(a(409));Oo(e,t,null,null)},No.prototype.unmount=sl.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;rs(function(){Oo(null,e,null,null)}),t[Sn]=null}};function No(e){this._internalRoot=e}No.prototype.unstable_scheduleHydration=function(e){if(e){var t=W();e={blockedOn:null,target:e,priority:t};for(var o=0;o<Te.length&&t!==0&&t<Te[o].priority;o++);Te.splice(o,0,e),o===0&&tt(e)}};function ol(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Vo(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function ac(){}function nh(e,t,o,f,D){if(D){if(typeof f=="function"){var B=f;f=function(){var Ye=Fo(ie);B.call(Ye)}}var ie=nc(t,f,e,0,null,!1,!1,"",ac);return e._reactRootContainer=ie,e[Sn]=ie.current,Ps(e.nodeType===8?e.parentNode:e),rs(),ie}for(;D=e.lastChild;)e.removeChild(D);if(typeof f=="function"){var Ce=f;f=function(){var Ye=Fo(Fe);Ce.call(Ye)}}var Fe=il(e,0,!1,null,null,!1,!1,"",ac);return e._reactRootContainer=Fe,e[Sn]=Fe.current,Ps(e.nodeType===8?e.parentNode:e),rs(function(){Oo(t,Fe,o,f)}),Fe}function jo(e,t,o,f,D){var B=o._reactRootContainer;if(B){var ie=B;if(typeof D=="function"){var Ce=D;D=function(){var Fe=Fo(ie);Ce.call(Fe)}}Oo(t,ie,e,D)}else ie=nh(o,t,e,D,f);return Fo(ie)}X=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var o=ae(t.pendingLanes);o!==0&&(S(t,o|1),en(t,lt()),(Nr&6)===0&&(Es=lt()+500,Ln()))}break;case 13:rs(function(){var f=Tn(e,1);if(f!==null){var D=Ki();yn(f,e,1,D)}}),nl(e,1)}},U=function(e){if(e.tag===13){var t=Tn(e,134217728);if(t!==null){var o=Ki();yn(t,e,134217728,o)}nl(e,134217728)}},j=function(e){if(e.tag===13){var t=Bn(e),o=Tn(e,t);if(o!==null){var f=Ki();yn(o,e,t,f)}nl(e,t)}},W=function(){return P},G=function(e,t){var o=P;try{return P=e,t()}finally{P=o}},ui=function(e,t,o){switch(t){case"input":if(Er(e,o),t=o.name,o.type==="radio"&&t!=null){for(o=e;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<o.length;t++){var f=o[t];if(f!==e&&f.form===e.form){var D=ro(f);if(!D)throw Error(a(90));Ft(f),Er(f,D)}}}break;case"textarea":Di(e,o);break;case"select":t=o.value,t!=null&&fi(e,!!o.multiple,t,!1)}},vi=Za,bi=rs;var sh={usingClientEntryPoint:!1,Events:[Is,hs,ro,Dr,rr,Za]},$s={findFiberByHostInstance:$n,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},oh={bundleType:$s.bundleType,version:$s.version,rendererPackageName:$s.rendererPackageName,rendererConfig:$s.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:N.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=_(e),e===null?null:e.stateNode},findFiberByHostInstance:$s.findFiberByHostInstance||ih,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Bo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Bo.isDisabled&&Bo.supportsFiber)try{Ar=Bo.inject(oh),Cr=Bo}catch{}}return reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sh,reactDom_production_min.createPortal=function(e,t){var o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ol(t))throw Error(a(200));return rh(e,t,null,o)},reactDom_production_min.createRoot=function(e,t){if(!ol(e))throw Error(a(299));var o=!1,f="",D=oc;return t!=null&&(t.unstable_strictMode===!0&&(o=!0),t.identifierPrefix!==void 0&&(f=t.identifierPrefix),t.onRecoverableError!==void 0&&(D=t.onRecoverableError)),t=il(e,1,!1,null,null,o,!1,f,D),e[Sn]=t.current,Ps(e.nodeType===8?e.parentNode:e),new sl(t)},reactDom_production_min.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(a(188)):(e=Object.keys(e).join(","),Error(a(268,e)));return e=_(t),e=e===null?null:e.stateNode,e},reactDom_production_min.flushSync=function(e){return rs(e)},reactDom_production_min.hydrate=function(e,t,o){if(!Vo(t))throw Error(a(200));return jo(null,e,t,!0,o)},reactDom_production_min.hydrateRoot=function(e,t,o){if(!ol(e))throw Error(a(405));var f=o!=null&&o.hydratedSources||null,D=!1,B="",ie=oc;if(o!=null&&(o.unstable_strictMode===!0&&(D=!0),o.identifierPrefix!==void 0&&(B=o.identifierPrefix),o.onRecoverableError!==void 0&&(ie=o.onRecoverableError)),t=nc(t,null,e,1,o??null,D,!1,B,ie),e[Sn]=t.current,Ps(e),f)for(e=0;e<f.length;e++)o=f[e],D=o._getVersion,D=D(o._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[o,D]:t.mutableSourceEagerHydrationData.push(o,D);return new No(t)},reactDom_production_min.render=function(e,t,o){if(!Vo(t))throw Error(a(200));return jo(null,e,t,!1,o)},reactDom_production_min.unmountComponentAtNode=function(e){if(!Vo(e))throw Error(a(40));return e._reactRootContainer?(rs(function(){jo(null,null,e,!1,function(){e._reactRootContainer=null,e[Sn]=null})}),!0):!1},reactDom_production_min.unstable_batchedUpdates=Za,reactDom_production_min.unstable_renderSubtreeIntoContainer=function(e,t,o,f){if(!Vo(o))throw Error(a(200));if(e==null||e._reactInternals===void 0)throw Error(a(38));return jo(e,t,o,!1,f)},reactDom_production_min.version="18.3.1-next-f1338f8080-20240426",reactDom_production_min}var hasRequiredReactDom;function requireReactDom(){if(hasRequiredReactDom)return reactDom.exports;hasRequiredReactDom=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(n){console.error(n)}}return r(),reactDom.exports=requireReactDom_production_min(),reactDom.exports}var hasRequiredClient;function requireClient(){if(hasRequiredClient)return client;hasRequiredClient=1;var r=requireReactDom();return client.createRoot=r.createRoot,client.hydrateRoot=r.hydrateRoot,client}var clientExports=requireClient();const corsProxies=[{name:"cors-optimade-science",urlRule:r=>{const n=r.match(/^https?:\/\/(.+)$/);if(!n)throw new Error("Invalid URL for proxy");const[,a]=n;return`https://cors.optimade.science/https/${a}`}},{name:"cors-anywhere",urlRule:r=>`https://cors-anywhere.com/${r}`},{name:"allorigins",urlRule:r=>`https://api.allorigins.win/raw?url=${encodeURIComponent(r)}`}],elements=[{num:1,sym:"H",row:1,col:1,group:"group1"},{num:2,sym:"He",row:1,col:18,group:"group18"},{num:3,sym:"Li",row:2,col:1,group:"group1"},{num:4,sym:"Be",row:2,col:2,group:"group2"},{num:5,sym:"B",row:2,col:13,group:"metalloid"},{num:6,sym:"C",row:2,col:14,group:"mainGroup"},{num:7,sym:"N",row:2,col:15,group:"mainGroup"},{num:8,sym:"O",row:2,col:16,group:"mainGroup"},{num:9,sym:"F",row:2,col:17,group:"group17"},{num:10,sym:"Ne",row:2,col:18,group:"group18"},{num:11,sym:"Na",row:3,col:1,group:"group1"},{num:12,sym:"Mg",row:3,col:2,group:"group2"},{num:13,sym:"Al",row:3,col:13,group:"postTransition"},{num:14,sym:"Si",row:3,col:14,group:"metalloid"},{num:15,sym:"P",row:3,col:15,group:"mainGroup"},{num:16,sym:"S",row:3,col:16,group:"mainGroup"},{num:17,sym:"Cl",row:3,col:17,group:"group17"},{num:18,sym:"Ar",row:3,col:18,group:"group18"},{num:19,sym:"K",row:4,col:1,group:"group1"},{num:20,sym:"Ca",row:4,col:2,group:"group2"},{num:21,sym:"Sc",row:4,col:3,group:"transition"},{num:22,sym:"Ti",row:4,col:4,group:"transition"},{num:23,sym:"V",row:4,col:5,group:"transition"},{num:24,sym:"Cr",row:4,col:6,group:"transition"},{num:25,sym:"Mn",row:4,col:7,group:"transition"},{num:26,sym:"Fe",row:4,col:8,group:"transition"},{num:27,sym:"Co",row:4,col:9,group:"transition"},{num:28,sym:"Ni",row:4,col:10,group:"transition"},{num:29,sym:"Cu",row:4,col:11,group:"transition"},{num:30,sym:"Zn",row:4,col:12,group:"transition"},{num:31,sym:"Ga",row:4,col:13,group:"postTransition"},{num:32,sym:"Ge",row:4,col:14,group:"metalloid"},{num:33,sym:"As",row:4,col:15,group:"metalloid"},{num:34,sym:"Se",row:4,col:16,group:"mainGroup"},{num:35,sym:"Br",row:4,col:17,group:"group17"},{num:36,sym:"Kr",row:4,col:18,group:"group18"},{num:37,sym:"Rb",row:5,col:1,group:"group1"},{num:38,sym:"Sr",row:5,col:2,group:"group2"},{num:39,sym:"Y",row:5,col:3,group:"transition"},{num:40,sym:"Zr",row:5,col:4,group:"transition"},{num:41,sym:"Nb",row:5,col:5,group:"transition"},{num:42,sym:"Mo",row:5,col:6,group:"transition"},{num:43,sym:"Tc",row:5,col:7,group:"transition"},{num:44,sym:"Ru",row:5,col:8,group:"transition"},{num:45,sym:"Rh",row:5,col:9,group:"transition"},{num:46,sym:"Pd",row:5,col:10,group:"transition"},{num:47,sym:"Ag",row:5,col:11,group:"transition"},{num:48,sym:"Cd",row:5,col:12,group:"transition"},{num:49,sym:"In",row:5,col:13,group:"postTransition"},{num:50,sym:"Sn",row:5,col:14,group:"postTransition"},{num:51,sym:"Sb",row:5,col:15,group:"metalloid"},{num:52,sym:"Te",row:5,col:16,group:"metalloid"},{num:53,sym:"I",row:5,col:17,group:"group17"},{num:54,sym:"Xe",row:5,col:18,group:"group18"},{num:55,sym:"Cs",row:6,col:1,group:"group1"},{num:56,sym:"Ba",row:6,col:2,group:"group2"},{num:72,sym:"Hf",row:6,col:4,group:"transition"},{num:73,sym:"Ta",row:6,col:5,group:"transition"},{num:74,sym:"W",row:6,col:6,group:"transition"},{num:75,sym:"Re",row:6,col:7,group:"transition"},{num:76,sym:"Os",row:6,col:8,group:"transition"},{num:77,sym:"Ir",row:6,col:9,group:"transition"},{num:78,sym:"Pt",row:6,col:10,group:"transition"},{num:79,sym:"Au",row:6,col:11,group:"transition"},{num:80,sym:"Hg",row:6,col:12,group:"transition"},{num:81,sym:"Tl",row:6,col:13,group:"postTransition"},{num:82,sym:"Pb",row:6,col:14,group:"postTransition"},{num:83,sym:"Bi",row:6,col:15,group:"postTransition"},{num:84,sym:"Po",row:6,col:16,group:"postTransition"},{num:85,sym:"At",row:6,col:17,group:"group17"},{num:86,sym:"Rn",row:6,col:18,group:"group18"},{num:87,sym:"Fr",row:7,col:1,group:"group1"},{num:88,sym:"Ra",row:7,col:2,group:"group2"},{num:104,sym:"Rf",row:7,col:4,group:"transition"},{num:105,sym:"Db",row:7,col:5,group:"transition"},{num:106,sym:"Sg",row:7,col:6,group:"transition"},{num:107,sym:"Bh",row:7,col:7,group:"transition"},{num:108,sym:"Hs",row:7,col:8,group:"transition"},{num:109,sym:"Mt",row:7,col:9,group:"bg-lime-200"},{num:110,sym:"Ds",row:7,col:10,group:"bg-lime-200"},{num:111,sym:"Rg",row:7,col:11,group:"bg-lime-200"},{num:112,sym:"Cn",row:7,col:12,group:"bg-lime-200"},{num:113,sym:"Nh",row:7,col:13,group:"bg-lime-200"},{num:114,sym:"Fl",row:7,col:14,group:"bg-lime-200"},{num:115,sym:"Mc",row:7,col:15,group:"bg-lime-200"},{num:116,sym:"Lv",row:7,col:16,group:"bg-lime-200"},{num:117,sym:"Ts",row:7,col:17,group:"bg-lime-200"},{num:118,sym:"Og",row:7,col:18,group:"bg-lime-200"},{num:57,sym:"La",row:12,col:3,group:"lanthanide"},{num:58,sym:"Ce",row:12,col:4,group:"lanthanide"},{num:59,sym:"Pr",row:12,col:5,group:"lanthanide"},{num:60,sym:"Nd",row:12,col:6,group:"lanthanide"},{num:61,sym:"Pm",row:12,col:7,group:"lanthanide"},{num:62,sym:"Sm",row:12,col:8,group:"lanthanide"},{num:63,sym:"Eu",row:12,col:9,group:"lanthanide"},{num:64,sym:"Gd",row:12,col:10,group:"lanthanide"},{num:65,sym:"Tb",row:12,col:11,group:"lanthanide"},{num:66,sym:"Dy",row:12,col:12,group:"lanthanide"},{num:67,sym:"Ho",row:12,col:13,group:"lanthanide"},{num:68,sym:"Er",row:12,col:14,group:"lanthanide"},{num:69,sym:"Tm",row:12,col:15,group:"lanthanide"},{num:70,sym:"Yb",row:12,col:16,group:"lanthanide"},{num:71,sym:"Lu",row:12,col:17,group:"lanthanide"},{num:89,sym:"Ac",row:13,col:3,group:"actinide"},{num:90,sym:"Th",row:13,col:4,group:"actinide"},{num:91,sym:"Pa",row:13,col:5,group:"actinide"},{num:92,sym:"U",row:13,col:6,group:"actinide"},{num:93,sym:"Np",row:13,col:7,group:"actinide"},{num:94,sym:"Pu",row:13,col:8,group:"actinide"},{num:95,sym:"Am",row:13,col:9,group:"actinide"},{num:96,sym:"Cm",row:13,col:10,group:"actinide"},{num:97,sym:"Bk",row:13,col:11,group:"actinide"},{num:98,sym:"Cf",row:13,col:12,group:"actinide"},{num:99,sym:"Es",row:13,col:13,group:"actinide"},{num:100,sym:"Fm",row:13,col:14,group:"actinide"},{num:101,sym:"Md",row:13,col:15,group:"actinide"},{num:102,sym:"No",row:13,col:16,group:"actinide"},{num:103,sym:"Lr",row:13,col:17,group:"actinide"}];async function getProvidersList(r="https://raw.githubusercontent.com/Materials-Consortia/providers/refs/heads/master/src/links/v1/providers.json",n=[]){async function a(R){const u=await fetch(R);if(!u.ok)throw new Error(`HTTP error! status: ${u.status}`);return await u.json()}let c;try{c=await a(r)}catch(R){console.warn("Remote fetch failed, falling back to cachedProviders.json:",R);try{c=await a("cachedProviders.json")}catch(u){throw console.error("Both remote and local fetches failed:",u),u}}const d=c.data.filter(R=>!n.includes(R.id));return{...c,data:d}}async function getProviderLinks(r){const n=c=>(c.data||[]).filter(d=>d.attributes?.link_type==="child"),a=[{name:"direct",url:`${r}/v1/links`},...corsProxies.map(c=>({name:c.name,url:c.urlRule(`${r}/v1/links`)}))];for(const{url:c,name:d}of a)try{const R=await fetch(c);if(!R.ok)continue;const u=await R.json();return{children:n(u),error:null}}catch{continue}return{children:[],error:new Error("All fetch attempts failed")}}async function getInfo({providerUrl:r}){const n=[{name:"direct",url:`${r}/v1/info/structures`},...corsProxies.map(a=>({name:a.name,url:a.urlRule(`${r}/v1/info/structures`)}))];for(const{url:a,name:c}of n)try{const d=await fetch(a);if(!d.ok)continue;const R=await d.json();return{customProps:Object.fromEntries(Object.entries(R.data.properties||{}).filter(([v])=>v.startsWith("_"))),error:null,allProps:R.data.properties}}catch{continue}return{customProps:{},error:new Error("All fetch attempts failed")}}async function getStructures({providerUrl:r,filter:n="",page:a=1,pageSize:c=20}){if(!r)throw new Error("Provider URL is required");let d=[];try{const{customProps:x,error:k,allProps:F}=await getInfo({providerUrl:r});k&&console.warn("Could not fetch custom fields:",k),F&&(d=Object.keys(F))}catch(x){console.warn("Error fetching custom fields:",x)}const R=["cartesian_site_positions","species_at_sites","lattice_vectors","chemical_formula_descriptive","chemical_formula_hill"],u=Array.from(new Set([...R,...d])),v=(a-1)*c,m=n?`?filter=${encodeURIComponent(n)}&page_offset=${v}`:`?page_offset=${v}`,b=`${r}/v1/structures${m}&response_fields=${u.join(",")}`,T=[{name:"direct",url:b},...corsProxies.map(x=>({name:x.name,url:x.urlRule(b)}))];for(const{url:x}of T)try{const k=await fetch(x);if(!k.ok)continue;return await k.json()}catch{continue}throw new Error("All fetch attempts failed for getStructures")}function OptimadeHeader(){return jsxRuntimeExports.jsx("div",{className:"flex justify-center",children:jsxRuntimeExports.jsx("img",{src:"/optimade_logo-min.png",alt:"OptimadeLogo",className:"h-18 sm:h-24 md:h-32 w-auto object-contain"})})}var lodash_debounce,hasRequiredLodash_debounce;function requireLodash_debounce(){if(hasRequiredLodash_debounce)return lodash_debounce;hasRequiredLodash_debounce=1;var r="Expected a function",n=NaN,a="[object Symbol]",c=/^\s+|\s+$/g,d=/^[-+]0x[0-9a-f]+$/i,R=/^0b[01]+$/i,u=/^0o[0-7]+$/i,v=parseInt,m=typeof commonjsGlobal=="object"&&commonjsGlobal&&commonjsGlobal.Object===Object&&commonjsGlobal,b=typeof self=="object"&&self&&self.Object===Object&&self,T=m||b||Function("return this")(),x=Object.prototype,k=x.toString,F=Math.max,C=Math.min,z=function(){return T.Date.now()};function Q(V,H,Y){var O,ee,Ae,ce,ge,me,Me=0,ue=!1,I=!1,he=!0;if(typeof V!="function")throw new TypeError(r);H=N(H)||0,J(Y)&&(ue=!!Y.leading,I="maxWait"in Y,Ae=I?F(N(Y.maxWait)||0,H):Ae,he="trailing"in Y?!!Y.trailing:he);function se(Ue){var Ie=O,rt=ee;return O=ee=void 0,Me=Ue,ce=V.apply(rt,Ie),ce}function K(Ue){return Me=Ue,ge=setTimeout(De,H),ue?se(Ue):ce}function Re(Ue){var Ie=Ue-me,rt=Ue-Me,st=H-Ie;return I?C(st,Ae-rt):st}function fe(Ue){var Ie=Ue-me,rt=Ue-Me;return me===void 0||Ie>=H||Ie<0||I&&rt>=Ae}function De(){var Ue=z();if(fe(Ue))return We(Ue);ge=setTimeout(De,Re(Ue))}function We(Ue){return ge=void 0,he&&O?se(Ue):(O=ee=void 0,ce)}function oe(){ge!==void 0&&clearTimeout(ge),Me=0,O=me=ee=ge=void 0}function Ee(){return ge===void 0?ce:We(z())}function He(){var Ue=z(),Ie=fe(Ue);if(O=arguments,ee=this,me=Ue,Ie){if(ge===void 0)return K(me);if(I)return ge=setTimeout(De,H),se(me)}return ge===void 0&&(ge=setTimeout(De,H)),ce}return He.cancel=oe,He.flush=Ee,He}function J(V){var H=typeof V;return!!V&&(H=="object"||H=="function")}function q(V){return!!V&&typeof V=="object"}function w(V){return typeof V=="symbol"||q(V)&&k.call(V)==a}function N(V){if(typeof V=="number")return V;if(w(V))return n;if(J(V)){var H=typeof V.valueOf=="function"?V.valueOf():V;V=J(H)?H+"":H}if(typeof V!="string")return V===0?V:+V;V=V.replace(c,"");var Y=R.test(V);return Y||u.test(V)?v(V.slice(2),Y?2:8):d.test(V)?n:+V}return lodash_debounce=Q,lodash_debounce}var lodash_debounceExports=requireLodash_debounce();const debounce=getDefaultExportFromCjs(lodash_debounceExports),slateDropdown=`min-w-[325]
  w-full border-2 border-slate-300
  bg-slate-200 py-1 px-3 rounded shadow hover:cursor-pointer
  hover:bg-slate-300 disabled:cursor-not-allowed
  disabled:bg-gray-100 text-sm md:text-base
`;function DatabaseSelector({providers:r,onQueryUrlChange:n,onChildChange:a,onProviderChange:c}){const[d,R]=reactExports.useState(""),[u,v]=reactExports.useState([]),[m,b]=reactExports.useState(null),[T,x]=reactExports.useState(""),[k,F]=reactExports.useState(!1),C=debounce(z=>x(z),700);return reactExports.useEffect(()=>{if(!d){v([]),b(null),n(""),a?.(null);return}if(d==="__custom__"){v([]),b(null),n(T||""),a?.(null);return}async function z(){try{F(!0);const{children:Q}=await getProviderLinks(d),J=Q.map(q=>({id:q.id,...q.attributes??{}}));v(J),J.length===1?(b(J[0]),n(J[0].base_url),a?.(J[0])):(b(null),n(""),a?.(null))}catch(Q){console.error(Q),v([]),b(null),n(""),a?.(null)}finally{F(!1)}}z()},[d]),reactExports.useEffect(()=>{d==="__custom__"?(n(T||""),a?.(null)):m&&(n(m.base_url),a?.(m))},[T,m,d]),reactExports.useEffect(()=>{if(d==="__custom__"||!d)c?.(null);else{const z=r.find(Q=>Q.attributes?.base_url===d);c?.(z||null)}},[d,r,c]),jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-start space-y-2 max-w-md",children:[jsxRuntimeExports.jsxs("select",{className:slateDropdown,value:d,onChange:z=>R(z.target.value),children:[jsxRuntimeExports.jsx("option",{value:"",disabled:!0,children:"Select a provider"}),r.map(z=>jsxRuntimeExports.jsx("option",{value:z.attributes?.base_url||"",children:`${z.id}: ${z.attributes?.name}`},z.attributes?.id??z.id??z.attributes?.base_url)),jsxRuntimeExports.jsx("option",{value:"__custom__",children:"Custom endpoint"})]}),d==="__custom__"?jsxRuntimeExports.jsx("input",{type:"text",placeholder:"Enter custom URL",className:"w-[calc(100%-4px)] mx-auto ring-[1px] ring-slate-300 rounded-sm px-2 py-1",onChange:z=>C(z.target.value)}):jsxRuntimeExports.jsx("select",{className:slateDropdown,value:m?.id||"",onChange:z=>{const Q=u.find(J=>J.id===z.target.value);b(Q||null)},disabled:k,children:k?jsxRuntimeExports.jsx("option",{children:"Loading"}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("option",{value:"",disabled:!0,children:"Select a subdatabase"}),u.map(z=>jsxRuntimeExports.jsx("option",{value:z.id,children:`${z.id}: ${z.name}`},z.id))]})})]})}function HelpIcon({popover:r,size:n=24,color:a="currentColor",strokeWidthBorder:c=2,strokeWidth:d=2.5,placement:R="top",popoutBgColor:u="bg-gray-800",popoutTextColor:v="text-white",popoutStyleOverrides:m=""}){let b="";switch(R){case"top":b="bottom-full left-1/2 transform -translate-x-1/2 mb-2";break;case"bottom":b="top-full left-1/2 transform -translate-x-1/2 mt-2";break;case"left":b="right-full top-1/2 transform -translate-y-1/2 mr-2";break;case"right":b="left-full top-1/2 transform -translate-y-1/2 ml-2";break;default:b="bottom-full left-1/2 transform -translate-x-1/2 mb-2"}return jsxRuntimeExports.jsxs("span",{className:"relative inline-block group",children:[jsxRuntimeExports.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:a,strokeWidth:c,strokeLinecap:"round",strokeLinejoin:"round",children:[jsxRuntimeExports.jsx("circle",{cx:"12",cy:"12",r:"10"}),jsxRuntimeExports.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",strokeWidth:d}),jsxRuntimeExports.jsx("path",{d:"M12 17h.01",strokeWidth:d})]}),r&&jsxRuntimeExports.jsx("span",{className:`absolute ${b} w-max max-w-xs rounded-sm ${u} ${v} text-xs p-1
          text-center opacity-0 group-hover:opacity-100 transition-opacity z-50 pointer-events-none ${m}`,children:r})]})}const defaultColors={group1:"bg-[#d7bbbb]",group2:"bg-[#d7cdbb]",group17:"bg-[#d7d9c2]",group18:"bg-[#d0d5ee]",transition:"bg-[#c4d0d8]",lanthanide:"bg-[#e5cbee]",actinide:"bg-[#aebcee]",metalloid:"bg-[#cdd9c2]",postTransition:"bg-[#c2c8d9]",mainGroup:"bg-[#d9c2ce]",default:"bg-gray-200"};function PTable({providerUrl:r=null,selected:n={},onSelectionChange:a,colors:c=defaultColors,selectedClassName:d="bg-green-400 border border-green-700 text-white scale-105",deselectedClassName:R="bg-red-400 border border-red-700 text-white scale-105",defaultBorderClassName:u="border border-slate-700",hoverClassName:v="transform transition-transform duration-100 hover:scale-105 hover:z-10 hover:cursor-pointer"}){const[m,b]=reactExports.useState(elements),[T,x]=reactExports.useState(null),[k,F]=reactExports.useState(null);reactExports.useEffect(()=>{(async()=>{try{const J=await fetch("./cachedPTable.json");if(!J.ok)throw new Error("Failed to load cached PTable");const q=J.headers.get("last-modified");if(q){const V=new Date(q).toLocaleDateString();F(V)}const w=await J.json(),N={};w.forEach(V=>{N[V.providerUrl]=V.ptable}),x(N)}catch(J){console.error("Failed to load cached PTable:",J)}})()},[]),reactExports.useEffect(()=>{if(!r||!T)return;const Q=T[r]||{},J=elements.map(q=>({...q,present:q.sym in Q?Q[q.sym]:void 0}));b(J)},[r,T]);const C=Q=>{if(!a)return;const J=((n[Q]??0)+1)%3;a({[Q]:J})},z=Q=>{const J=n[Q.sym]??0,q=c[Q.group]??c.default;if(J===1)return d;if(J===2)return R;const w=Q.present===!1?"opacity-30":"";return`${q} ${u} ${w}`};return jsxRuntimeExports.jsx("div",{className:"w-full max-w-full mx-auto px-0 md:px-2",children:jsxRuntimeExports.jsxs("div",{className:"@container",children:[jsxRuntimeExports.jsx("div",{className:"flex justify-end pb-2 pr-1.5",children:jsxRuntimeExports.jsx(HelpIcon,{popover:`All OPTIMADE provider databases have been prefiltered, with unavailable structures greyed out. Last updated: ${k}.`,placement:"left",color:"rgb(40,40,40)"})}),jsxRuntimeExports.jsx("div",{className:"grid @gap-0.5 @sm:gap-1 w-full",style:{gridTemplateColumns:"repeat(18, minmax(0, 1fr))"},children:m.map(Q=>jsxRuntimeExports.jsx("div",{style:{gridColumn:Q.col,gridRow:Q.row},className:"relative w-full",children:jsxRuntimeExports.jsx("div",{className:"w-full aspect-square",children:jsxRuntimeExports.jsxs("button",{onClick:()=>C(Q.sym),className:`flex flex-col justify-center items-center w-full h-full rounded-sm ${v} ${z(Q)}`,children:[jsxRuntimeExports.jsx("span",{className:"text-[0px] opacity-0 @sm:text-[0.3rem] @sm:opacity-100 @md:text-[0.5rem] @lg:text-[0.7rem] text-gray-700 leading-tight",children:Q.num}),jsxRuntimeExports.jsx("span",{className:"text-[0.55rem] font-medium leading-none",style:{fontSize:"clamp(0.55rem, 2.5vw, 1.25rem)"},children:Q.sym})]})})},Q.sym))})]})})}const textNormal=" text-sm md:text-base",textLarge=" text-base md:text-lg",textHyperlink=" text-blue-500 hover:underline hover:text-blue-600",textSmall=" text-xs md:text-sm",textTiny=" text-[13px] md:text-[13px]",textError=" text-center text-red-500",baseButtonStyle=`px-2 py-1 md:px-3 md:py-1.5 rounded
 bg-blue-600 text-white 
 hover:bg-blue-700 hover:cursor-pointer
`,baseContainer="w-full border border-slate-500 rounded-sm bg-slate-50 shadow-sm ",containerStyle=baseContainer+" p-2",containerStyleDropdown=baseContainer+" overflow-hidden text-[11px] md:text-[13px]",containerStyleHalf=baseContainer+` p-2 md:w-1/2  min-h-48 md:h-[450px] h-[200px] text-[11px] md:text-[13px]
   overflow-auto`,warningContainerStyle="w-full rounded-sm bg-yellow-100 border border-yellow-400 text-yellow-800 p-3 text-center";function QueryTextBox({value:r,onChange:n,placeholder:a="Enter OPTIMADE filter",onSubmit:c,loading:d=!1}){return jsxRuntimeExports.jsx("div",{className:textNormal,children:jsxRuntimeExports.jsxs("form",{onSubmit:R=>{R.preventDefault(),c?.()},className:"flex gap-2",children:[jsxRuntimeExports.jsx("input",{type:"text",value:r,onChange:R=>n(R.target.value),placeholder:a,className:`${containerStyle} border-gray-300! bg-white focus:outline-none focus:ring-1 focus:ring-blue-500 `}),jsxRuntimeExports.jsx("button",{type:"submit",disabled:d,className:`${baseButtonStyle} disabled:opacity-50`,children:d?"Loading":"Submit"})]})})}var lib={},Range={},utils={},types={},hasRequiredTypes;function requireTypes(){if(hasRequiredTypes)return types;hasRequiredTypes=1,Object.defineProperty(types,"__esModule",{value:!0}),types.Direction=void 0;var r;return(function(n){n.Right="to right",n.Left="to left",n.Down="to bottom",n.Up="to top"})(r||(types.Direction=r={})),types}var hasRequiredUtils;function requireUtils(){return hasRequiredUtils||(hasRequiredUtils=1,(function(r){var n=utils&&utils.__spreadArray||function(ge,me,Me){if(Me||arguments.length===2)for(var ue=0,I=me.length,he;ue<I;ue++)(he||!(ue in me))&&(he||(he=Array.prototype.slice.call(me,0,ue)),he[ue]=me[ue]);return ge.concat(he||Array.prototype.slice.call(me))};Object.defineProperty(r,"__esModule",{value:!0}),r.isIOS=r.useThumbOverlap=r.assertUnreachable=r.voidFn=r.getTrackBackground=r.replaceAt=r.schd=r.translate=r.getClosestThumbIndex=r.translateThumbs=r.getPaddingAndBorder=r.getMargin=r.checkInitialOverlap=r.checkValuesAgainstBoundaries=r.checkBoundaries=r.isVertical=r.relativeValue=r.normalizeValue=r.isStepDivisible=r.isTouchEvent=r.getStepDecimals=void 0;var a=requireReact(),c=requireTypes(),d=function(ge){var me=ge.toString().split(".")[1];return me?me.length:0};r.getStepDecimals=d;function R(ge){return ge.touches&&ge.touches.length||ge.changedTouches&&ge.changedTouches.length}r.isTouchEvent=R;function u(ge,me,Me){var ue=(me-ge)/Me,I=8,he=Number(ue.toFixed(I));return parseInt(he.toString(),10)===he}r.isStepDivisible=u;function v(ge,me,Me,ue,I,he,se){var K=1e11;if(ge=Math.round(ge*K)/K,!he){var Re=se[me-1],fe=se[me+1];if(Re&&Re>ge)return Re;if(fe&&fe<ge)return fe}if(ge>ue)return ue;if(ge<Me)return Me;var De=Math.floor(ge*K-Me*K)%Math.floor(I*K),We=Math.floor(ge*K-Math.abs(De)),oe=De===0?ge:We/K,Ee=Math.abs(De/K)<I/2?oe:oe+I,He=(0,r.getStepDecimals)(I);return parseFloat(Ee.toFixed(He))}r.normalizeValue=v;function m(ge,me,Me){return(ge-me)/(Me-me)}r.relativeValue=m;function b(ge){return ge===c.Direction.Up||ge===c.Direction.Down}r.isVertical=b;function T(ge,me,Me){if(me>=Me)throw new RangeError("min (".concat(me,") is equal/bigger than max (").concat(Me,")"));if(ge<me)throw new RangeError("value (".concat(ge,") is smaller than min (").concat(me,")"));if(ge>Me)throw new RangeError("value (".concat(ge,") is bigger than max (").concat(Me,")"))}r.checkBoundaries=T;function x(ge,me,Me){return ge<me?me:ge>Me?Me:ge}r.checkValuesAgainstBoundaries=x;function k(ge){if(!(ge.length<2)&&!ge.slice(1).every(function(me,Me){return ge[Me]<=me}))throw new RangeError("values={[".concat(ge,"]} needs to be sorted when allowOverlap={false}"))}r.checkInitialOverlap=k;function F(ge){var me=window.getComputedStyle(ge);return{top:parseInt(me["margin-top"],10),bottom:parseInt(me["margin-bottom"],10),left:parseInt(me["margin-left"],10),right:parseInt(me["margin-right"],10)}}r.getMargin=F;function C(ge){var me=window.getComputedStyle(ge);return{top:parseInt(me["padding-top"],10)+parseInt(me["border-top-width"],10),bottom:parseInt(me["padding-bottom"],10)+parseInt(me["border-bottom-width"],10),left:parseInt(me["padding-left"],10)+parseInt(me["border-left-width"],10),right:parseInt(me["padding-right"],10)+parseInt(me["border-right-width"],10)}}r.getPaddingAndBorder=C;function z(ge,me,Me){var ue=Me?-1:1;ge.forEach(function(I,he){return J(I,ue*me[he].x,me[he].y)})}r.translateThumbs=z;function Q(ge,me,Me,ue){for(var I=0,he=Ae(ge[0],me,Me,ue),se=1;se<ge.length;se++){var K=Ae(ge[se],me,Me,ue);K<he&&(he=K,I=se)}return I}r.getClosestThumbIndex=Q;function J(ge,me,Me){ge.style.transform="translate(".concat(me,"px, ").concat(Me,"px)")}r.translate=J;var q=function(ge){var me=[],Me=null,ue=function(){for(var I=[],he=0;he<arguments.length;he++)I[he]=arguments[he];me=I,!Me&&(Me=requestAnimationFrame(function(){Me=null,ge.apply(void 0,me)}))};return ue};r.schd=q;function w(ge,me,Me){var ue=ge.slice(0);return ue[me]=Me,ue}r.replaceAt=w;function N(ge){var me=ge.values,Me=ge.colors,ue=ge.min,I=ge.max,he=ge.direction,se=he===void 0?c.Direction.Right:he,K=ge.rtl,Re=K===void 0?!1:K;Re&&se===c.Direction.Right?se=c.Direction.Left:Re&&c.Direction.Left&&(se=c.Direction.Right);var fe=me.slice(0).sort(function(We,oe){return We-oe}).map(function(We){return(We-ue)/(I-ue)*100}),De=fe.reduce(function(We,oe,Ee){return"".concat(We,", ").concat(Me[Ee]," ").concat(oe,"%, ").concat(Me[Ee+1]," ").concat(oe,"%")},"");return"linear-gradient(".concat(se,", ").concat(Me[0]," 0%").concat(De,", ").concat(Me[Me.length-1]," 100%)")}r.getTrackBackground=N;function V(){}r.voidFn=V;function H(ge){throw new Error("Didn't expect to get here")}r.assertUnreachable=H;var Y=function(ge,me,Me,ue,I){I===void 0&&(I=function(se){return se});var he=Math.ceil(n([ge],Array.from(ge.children),!0).reduce(function(se,K){var Re=Math.ceil(K.getBoundingClientRect().width);if(K.innerText&&K.innerText.includes(Me)&&K.childElementCount===0){var fe=K.cloneNode(!0);fe.innerHTML=I(me.toFixed(ue)),fe.style.visibility="hidden",document.body.appendChild(fe),Re=Math.ceil(fe.getBoundingClientRect().width),document.body.removeChild(fe)}return Re>se?Re:se},ge.getBoundingClientRect().width));return he},O=function(ge,me,Me,ue,I,he,se){se===void 0&&(se=function(fe){return fe});var K=[],Re=function(fe){var De=Y(Me[fe],ue[fe],I,he,se),We=me[fe].x;me.forEach(function(oe,Ee){var He=oe.x,Ue=Y(Me[Ee],ue[Ee],I,he,se);fe!==Ee&&(We>=He&&We<=He+Ue||We+De>=He&&We+De<=He+Ue)&&(K.includes(Ee)||(K.push(fe),K.push(Ee),K=n(n([],K,!0),[fe,Ee],!1),Re(Ee)))})};return Re(ge),Array.from(new Set(K.sort()))},ee=function(ge,me,Me,ue,I,he){ue===void 0&&(ue=.1),I===void 0&&(I=" - "),he===void 0&&(he=function(Ee){return Ee});var se=(0,r.getStepDecimals)(ue),K=(0,a.useState)({}),Re=K[0],fe=K[1],De=(0,a.useState)(he(me[Me].toFixed(se))),We=De[0],oe=De[1];return(0,a.useEffect)(function(){if(ge){var Ee=ge.getThumbs();if(Ee.length<1)return;var He={},Ue=ge.getOffsets(),Ie=O(Me,Ue,Ee,me,I,se,he),rt=he(me[Me].toFixed(se));if(Ie.length){var st=Ie.reduce(function(ar,kr,Er,pr){return ar.length?n(n([],ar,!0),[Ue[pr[Er]].x],!1):[Ue[pr[Er]].x]},[]);if(Math.min.apply(Math,st)===Ue[Me].x){var at=[];Ie.forEach(function(ar){at.push(me[ar].toFixed(se))}),rt=Array.from(new Set(at.sort(function(ar,kr){return parseFloat(ar)-parseFloat(kr)}))).map(he).join(I);var Ft=Math.min.apply(Math,st),At=Math.max.apply(Math,st),or=Ee[Ie[st.indexOf(At)]].getBoundingClientRect().width;He.left="".concat(Math.abs(Ft-(At+or))/2,"px"),He.transform="translate(-50%, 0)"}else He.visibility="hidden"}oe(rt),fe(He)}},[ge,me]),[We,Re]};r.useThumbOverlap=ee;function Ae(ge,me,Me,ue){var I=ge.getBoundingClientRect(),he=I.left,se=I.top,K=I.width,Re=I.height;return b(ue)?Math.abs(Me-(se+Re/2)):Math.abs(me-(he+K/2))}var ce=function(){var ge,me=((ge=navigator.userAgentData)===null||ge===void 0?void 0:ge.platform)||navigator.platform;return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(me)||navigator.userAgent.includes("Mac")&&"ontouchend"in document};r.isIOS=ce})(utils)),utils}var hasRequiredRange;function requireRange(){if(hasRequiredRange)return Range;hasRequiredRange=1;var r=Range&&Range.__extends||(function(){var x=function(k,F){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(C,z){C.__proto__=z}||function(C,z){for(var Q in z)Object.prototype.hasOwnProperty.call(z,Q)&&(C[Q]=z[Q])},x(k,F)};return function(k,F){if(typeof F!="function"&&F!==null)throw new TypeError("Class extends value "+String(F)+" is not a constructor or null");x(k,F);function C(){this.constructor=k}k.prototype=F===null?Object.create(F):(C.prototype=F.prototype,new C)}})(),n=Range&&Range.__createBinding||(Object.create?(function(x,k,F,C){C===void 0&&(C=F);var z=Object.getOwnPropertyDescriptor(k,F);(!z||("get"in z?!k.__esModule:z.writable||z.configurable))&&(z={enumerable:!0,get:function(){return k[F]}}),Object.defineProperty(x,C,z)}):(function(x,k,F,C){C===void 0&&(C=F),x[C]=k[F]})),a=Range&&Range.__setModuleDefault||(Object.create?(function(x,k){Object.defineProperty(x,"default",{enumerable:!0,value:k})}):function(x,k){x.default=k}),c=Range&&Range.__importStar||function(x){if(x&&x.__esModule)return x;var k={};if(x!=null)for(var F in x)F!=="default"&&Object.prototype.hasOwnProperty.call(x,F)&&n(k,x,F);return a(k,x),k},d=Range&&Range.__spreadArray||function(x,k,F){if(F||arguments.length===2)for(var C=0,z=k.length,Q;C<z;C++)(Q||!(C in k))&&(Q||(Q=Array.prototype.slice.call(k,0,C)),Q[C]=k[C]);return x.concat(Q||Array.prototype.slice.call(k))};Object.defineProperty(Range,"__esModule",{value:!0});var R=c(requireReact()),u=requireUtils(),v=requireTypes(),m=["ArrowRight","ArrowUp","k","PageUp"],b=["ArrowLeft","ArrowDown","j","PageDown"],T=(function(x){r(k,x);function k(F){var C=x.call(this,F)||this;if(C.trackRef=R.createRef(),C.thumbRefs=[],C.state={draggedTrackPos:[-1,-1],draggedThumbIndex:-1,thumbZIndexes:new Array(C.props.values.length).fill(0).map(function(z,Q){return Q}),isChanged:!1,markOffsets:[]},C.getOffsets=function(){var z=C.props,Q=z.direction,J=z.values,q=z.min,w=z.max,N=C.trackRef.current;if(!N)return console.warn("No track element found."),[];var V=N.getBoundingClientRect(),H=(0,u.getPaddingAndBorder)(N);return C.getThumbs().map(function(Y,O){var ee={x:0,y:0},Ae=Y.getBoundingClientRect(),ce=(0,u.getMargin)(Y);switch(Q){case v.Direction.Right:return ee.x=(ce.left+H.left)*-1,ee.y=((Ae.height-V.height)/2+H.top)*-1,ee.x+=V.width*(0,u.relativeValue)(J[O],q,w)-Ae.width/2,ee;case v.Direction.Left:return ee.x=(ce.right+H.right)*-1,ee.y=((Ae.height-V.height)/2+H.top)*-1,ee.x+=V.width-V.width*(0,u.relativeValue)(J[O],q,w)-Ae.width/2,ee;case v.Direction.Up:return ee.x=((Ae.width-V.width)/2+ce.left+H.left)*-1,ee.y=-H.left,ee.y+=V.height-V.height*(0,u.relativeValue)(J[O],q,w)-Ae.height/2,ee;case v.Direction.Down:return ee.x=((Ae.width-V.width)/2+ce.left+H.left)*-1,ee.y=-H.left,ee.y+=V.height*(0,u.relativeValue)(J[O],q,w)-Ae.height/2,ee;default:return(0,u.assertUnreachable)(Q)}})},C.getThumbs=function(){return C.trackRef&&C.trackRef.current?Array.from(C.trackRef.current.children).filter(function(z){return z.hasAttribute("aria-valuenow")}):(console.warn("No thumbs found in the track container. Did you forget to pass & spread the `props` param in renderTrack?"),[])},C.getTargetIndex=function(z){return C.getThumbs().findIndex(function(Q){return Q===z.target||Q.contains(z.target)})},C.addTouchEvents=function(z){document.addEventListener("touchmove",C.schdOnTouchMove,{passive:!1}),document.addEventListener("touchend",C.schdOnEnd,{passive:!1}),document.addEventListener("touchcancel",C.schdOnEnd,{passive:!1})},C.addMouseEvents=function(z){document.addEventListener("mousemove",C.schdOnMouseMove),document.addEventListener("mouseup",C.schdOnEnd)},C.onMouseDownTrack=function(z){var Q;if(!(z.button!==0||(0,u.isIOS)()))if(z.persist(),z.preventDefault(),C.addMouseEvents(z.nativeEvent),C.props.values.length>1&&C.props.draggableTrack){if(C.thumbRefs.some(function(q){var w;return(w=q.current)===null||w===void 0?void 0:w.contains(z.target)}))return;C.setState({draggedTrackPos:[z.clientX,z.clientY]},function(){return C.onMove(z.clientX,z.clientY)})}else{var J=(0,u.getClosestThumbIndex)(C.thumbRefs.map(function(q){return q.current}),z.clientX,z.clientY,C.props.direction);(Q=C.thumbRefs[J].current)===null||Q===void 0||Q.focus(),C.setState({draggedThumbIndex:J},function(){return C.onMove(z.clientX,z.clientY)})}},C.onResize=function(){(0,u.translateThumbs)(C.getThumbs(),C.getOffsets(),C.props.rtl),C.calculateMarkOffsets()},C.onTouchStartTrack=function(z){var Q;if(z.persist(),C.addTouchEvents(z.nativeEvent),C.props.values.length>1&&C.props.draggableTrack){if(C.thumbRefs.some(function(q){var w;return(w=q.current)===null||w===void 0?void 0:w.contains(z.target)}))return;C.setState({draggedTrackPos:[z.touches[0].clientX,z.touches[0].clientY]},function(){return C.onMove(z.touches[0].clientX,z.touches[0].clientY)})}else{var J=(0,u.getClosestThumbIndex)(C.thumbRefs.map(function(q){return q.current}),z.touches[0].clientX,z.touches[0].clientY,C.props.direction);(Q=C.thumbRefs[J].current)===null||Q===void 0||Q.focus(),C.setState({draggedThumbIndex:J},function(){return C.onMove(z.touches[0].clientX,z.touches[0].clientY)})}},C.onMouseOrTouchStart=function(z){if(!C.props.disabled){var Q=(0,u.isTouchEvent)(z);if(!(!Q&&z.button!==0)){var J=C.getTargetIndex(z);J!==-1&&(Q?C.addTouchEvents(z):C.addMouseEvents(z),C.setState({draggedThumbIndex:J,thumbZIndexes:C.state.thumbZIndexes.map(function(q,w){return w===J?Math.max.apply(Math,C.state.thumbZIndexes):q<=C.state.thumbZIndexes[J]?q:q-1})}))}}},C.onMouseMove=function(z){z.preventDefault(),C.onMove(z.clientX,z.clientY)},C.onTouchMove=function(z){z.preventDefault(),C.onMove(z.touches[0].clientX,z.touches[0].clientY)},C.onKeyDown=function(z){var Q=C.props,J=Q.values,q=Q.onChange,w=Q.step,N=Q.rtl,V=Q.direction,H=C.state.isChanged,Y=C.getTargetIndex(z.nativeEvent),O=N||V===v.Direction.Left||V===v.Direction.Down?-1:1;Y!==-1&&(m.includes(z.key)?(z.preventDefault(),C.setState({draggedThumbIndex:Y,isChanged:!0}),q((0,u.replaceAt)(J,Y,C.normalizeValue(J[Y]+O*(z.key==="PageUp"?w*10:w),Y)))):b.includes(z.key)?(z.preventDefault(),C.setState({draggedThumbIndex:Y,isChanged:!0}),q((0,u.replaceAt)(J,Y,C.normalizeValue(J[Y]-O*(z.key==="PageDown"?w*10:w),Y)))):z.key==="Tab"?C.setState({draggedThumbIndex:-1},function(){H&&C.fireOnFinalChange()}):H&&C.fireOnFinalChange())},C.onKeyUp=function(z){var Q=C.state.isChanged;C.setState({draggedThumbIndex:-1},function(){Q&&C.fireOnFinalChange()})},C.onMove=function(z,Q){var J=C.state,q=J.draggedThumbIndex,w=J.draggedTrackPos,N=C.props,V=N.direction,H=N.min,Y=N.max,O=N.onChange,ee=N.values,Ae=N.step,ce=N.rtl;if(q===-1&&w[0]===-1&&w[1]===-1)return null;var ge=C.trackRef.current;if(!ge)return null;var me=ge.getBoundingClientRect(),Me=(0,u.isVertical)(V)?me.height:me.width;if(w[0]!==-1&&w[1]!==-1){var ue=z-w[0],I=Q-w[1],he=0;switch(V){case v.Direction.Right:case v.Direction.Left:he=ue/Me*(Y-H);break;case v.Direction.Down:case v.Direction.Up:he=I/Me*(Y-H);break;default:(0,u.assertUnreachable)(V)}if(ce&&(he*=-1),Math.abs(he)>=Ae/2){for(var se=0;se<C.thumbRefs.length;se++){if(ee[se]===Y&&Math.sign(he)===1||ee[se]===H&&Math.sign(he)===-1)return;var K=ee[se]+he;K>Y?he=Y-ee[se]:K<H&&(he=H-ee[se])}for(var Re=ee.slice(0),se=0;se<C.thumbRefs.length;se++)Re=(0,u.replaceAt)(Re,se,C.normalizeValue(ee[se]+he,se));C.setState({draggedTrackPos:[z,Q]}),O(Re)}}else{var fe=0;switch(V){case v.Direction.Right:fe=(z-me.left)/Me*(Y-H)+H;break;case v.Direction.Left:fe=(Me-(z-me.left))/Me*(Y-H)+H;break;case v.Direction.Down:fe=(Q-me.top)/Me*(Y-H)+H;break;case v.Direction.Up:fe=(Me-(Q-me.top))/Me*(Y-H)+H;break;default:(0,u.assertUnreachable)(V)}ce&&(fe=Y+H-fe),Math.abs(ee[q]-fe)>=Ae/2&&O((0,u.replaceAt)(ee,q,C.normalizeValue(fe,q)))}},C.normalizeValue=function(z,Q){var J=C.props,q=J.min,w=J.max,N=J.step,V=J.allowOverlap,H=J.values;return(0,u.normalizeValue)(z,Q,q,w,N,V,H)},C.onEnd=function(z){if(z.preventDefault(),document.removeEventListener("mousemove",C.schdOnMouseMove),document.removeEventListener("touchmove",C.schdOnTouchMove),document.removeEventListener("mouseup",C.schdOnEnd),document.removeEventListener("touchend",C.schdOnEnd),document.removeEventListener("touchcancel",C.schdOnEnd),C.state.draggedThumbIndex===-1&&C.state.draggedTrackPos[0]===-1&&C.state.draggedTrackPos[1]===-1)return null;C.setState({draggedThumbIndex:-1,draggedTrackPos:[-1,-1]},function(){C.fireOnFinalChange()})},C.fireOnFinalChange=function(){C.setState({isChanged:!1});var z=C.props,Q=z.onFinalChange,J=z.values;Q&&Q(J)},C.updateMarkRefs=function(z){if(!z.renderMark){C.numOfMarks=void 0,C.markRefs=void 0;return}C.numOfMarks=(z.max-z.min)/C.props.step,C.markRefs=[];for(var Q=0;Q<C.numOfMarks+1;Q++)C.markRefs[Q]=R.createRef()},C.calculateMarkOffsets=function(){if(!(!C.props.renderMark||!C.trackRef||!C.numOfMarks||!C.markRefs||C.trackRef.current===null)){for(var z=window.getComputedStyle(C.trackRef.current),Q=parseInt(z.width,10),J=parseInt(z.height,10),q=parseInt(z.paddingLeft,10),w=parseInt(z.paddingTop,10),N=[],V=0;V<C.numOfMarks+1;V++){var H=9999,Y=9999;if(C.markRefs[V].current){var O=C.markRefs[V].current.getBoundingClientRect();H=O.height,Y=O.width}C.props.direction===v.Direction.Left||C.props.direction===v.Direction.Right?N.push([Math.round(Q/C.numOfMarks*V+q-Y/2),-Math.round((H-J)/2)]):N.push([Math.round(J/C.numOfMarks*V+w-H/2),-Math.round((Y-Q)/2)])}C.setState({markOffsets:N})}},F.step===0)throw new Error('"step" property should be a positive number');return C.schdOnMouseMove=(0,u.schd)(C.onMouseMove),C.schdOnTouchMove=(0,u.schd)(C.onTouchMove),C.schdOnEnd=(0,u.schd)(C.onEnd),C.thumbRefs=F.values.map(function(){return R.createRef()}),C.updateMarkRefs(F),C}return k.prototype.componentDidMount=function(){var F=this,C=this.props,z=C.values,Q=C.min,J=C.step;this.resizeObserver=window.ResizeObserver?new window.ResizeObserver(this.onResize):{observe:function(){return window.addEventListener("resize",F.onResize)},unobserve:function(){return window.removeEventListener("resize",F.onResize)}},document.addEventListener("touchstart",this.onMouseOrTouchStart,{passive:!1}),document.addEventListener("mousedown",this.onMouseOrTouchStart,{passive:!1}),!this.props.allowOverlap&&(0,u.checkInitialOverlap)(this.props.values),this.props.values.forEach(function(q){return(0,u.checkBoundaries)(q,F.props.min,F.props.max)}),this.resizeObserver.observe(this.trackRef.current),(0,u.translateThumbs)(this.getThumbs(),this.getOffsets(),this.props.rtl),this.calculateMarkOffsets(),z.forEach(function(q){(0,u.isStepDivisible)(Q,q,J)||console.warn("The `values` property is in conflict with the current `step`, `min`, and `max` properties. Please provide values that are accessible using the min, max, and step values.")})},k.prototype.componentDidUpdate=function(F,C){var z=this.props,Q=z.max,J=z.min,q=z.step,w=z.values,N=z.rtl;(F.max!==Q||F.min!==J||F.step!==q)&&this.updateMarkRefs(this.props),(0,u.translateThumbs)(this.getThumbs(),this.getOffsets(),N),(F.max!==Q||F.min!==J||F.step!==q||C.markOffsets.length!==this.state.markOffsets.length)&&(this.calculateMarkOffsets(),w.forEach(function(V){(0,u.isStepDivisible)(J,V,q)||console.warn("The `values` property is in conflict with the current `step`, `min`, and `max` properties. Please provide values that are accessible using the min, max, and step values.")}))},k.prototype.componentWillUnmount=function(){var F={passive:!1};document.removeEventListener("mousedown",this.onMouseOrTouchStart,F),document.removeEventListener("mousemove",this.schdOnMouseMove),document.removeEventListener("touchmove",this.schdOnTouchMove),document.removeEventListener("touchstart",this.onMouseOrTouchStart),document.removeEventListener("mouseup",this.schdOnEnd),document.removeEventListener("touchend",this.schdOnEnd),this.resizeObserver.unobserve(this.trackRef.current)},k.prototype.render=function(){var F=this,C=this.props,z=C.label,Q=C.labelledBy,J=C.renderTrack,q=C.renderThumb,w=C.renderMark,N=w===void 0?function(){return null}:w,V=C.values,H=C.min,Y=C.max,O=C.allowOverlap,ee=C.disabled,Ae=this.state,ce=Ae.draggedThumbIndex,ge=Ae.thumbZIndexes,me=Ae.markOffsets;return J({props:{style:{transform:"scale(1)",cursor:ce>-1?"grabbing":this.props.draggableTrack?(0,u.isVertical)(this.props.direction)?"ns-resize":"ew-resize":V.length===1&&!ee?"pointer":"inherit"},onMouseDown:ee?u.voidFn:this.onMouseDownTrack,onTouchStart:ee?u.voidFn:this.onTouchStartTrack,ref:this.trackRef},isDragged:this.state.draggedThumbIndex>-1,disabled:ee,children:d(d([],me.map(function(Me,ue,I){return N({props:{style:F.props.direction===v.Direction.Left||F.props.direction===v.Direction.Right?{position:"absolute",left:"".concat(Me[0],"px"),marginTop:"".concat(Me[1],"px")}:{position:"absolute",top:"".concat(Me[0],"px"),marginLeft:"".concat(Me[1],"px")},key:"mark".concat(ue),ref:F.markRefs[ue]},index:ue})}),!0),V.map(function(Me,ue){var I=F.state.draggedThumbIndex===ue;return q({index:ue,value:Me,isDragged:I,props:{style:{position:"absolute",zIndex:ge[ue],cursor:ee?"inherit":I?"grabbing":"grab",userSelect:"none",touchAction:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none"},key:ue,tabIndex:ee?void 0:0,"aria-valuemax":O?Y:V[ue+1]||Y,"aria-valuemin":O?H:V[ue-1]||H,"aria-valuenow":Me,draggable:!1,ref:F.thumbRefs[ue],"aria-label":z,"aria-labelledby":Q,role:"slider",onKeyDown:ee?u.voidFn:F.onKeyDown,onKeyUp:ee?u.voidFn:F.onKeyUp}})}),!0)})},k.defaultProps={label:"Accessibility label",labelledBy:null,step:1,direction:v.Direction.Right,rtl:!1,disabled:!1,allowOverlap:!1,draggableTrack:!1,min:0,max:100},k})(R.Component);return Range.default=T,Range}var hasRequiredLib;function requireLib(){return hasRequiredLib||(hasRequiredLib=1,(function(r){var n=lib&&lib.__importDefault||function(R){return R&&R.__esModule?R:{default:R}};Object.defineProperty(r,"__esModule",{value:!0}),r.checkValuesAgainstBoundaries=r.relativeValue=r.useThumbOverlap=r.Direction=r.getTrackBackground=r.Range=void 0;var a=n(requireRange());r.Range=a.default;var c=requireUtils();Object.defineProperty(r,"getTrackBackground",{enumerable:!0,get:function(){return c.getTrackBackground}}),Object.defineProperty(r,"useThumbOverlap",{enumerable:!0,get:function(){return c.useThumbOverlap}}),Object.defineProperty(r,"relativeValue",{enumerable:!0,get:function(){return c.relativeValue}}),Object.defineProperty(r,"checkValuesAgainstBoundaries",{enumerable:!0,get:function(){return c.checkValuesAgainstBoundaries}});var d=requireTypes();Object.defineProperty(r,"Direction",{enumerable:!0,get:function(){return d.Direction}})})(lib)),lib}var libExports=requireLib();const inputOverride=`w-12 text-center bg-transparent border-none outline-none p-0
             [&::-webkit-inner-spin-button]:appearance-none
             [&::-webkit-outer-spin-button]:appearance-none
             [-moz-appearance:textfield]`,sliderBgStyle="flex-1 h-2 bg-gray-300 rounded relative",sliderFgStyle="absolute h-2 bg-blue-500 rounded",sliderThumbStyle="w-4.5 h-4.5 bg-slate-100 border-2 border-slate-400 rounded-full transition-transform transform origin-center hover:scale-125";function RangeSlider({title:r,value:n,onChange:a,min:c,max:d}){const[R,u]=reactExports.useState(n.map(String));reactExports.useEffect(()=>{u(n.map(String))},[n]);const v=(b,T)=>{u(k=>{const F=[...k];return F[b]=T,F});const x=parseFloat(T);if(!isNaN(x)){let k=[...n];b===0?k[0]=Math.min(Math.max(x,c),n[1]):k[1]=Math.max(Math.min(x,d),n[0]),a(k)}},m=b=>{const T=parseFloat(R[b]);isNaN(T)&&u(x=>{const k=[...x];return k[b]=String(n[b]),k})};return jsxRuntimeExports.jsxs("div",{className:`${textNormal} p-2  pt-4`,children:[jsxRuntimeExports.jsx("label",{className:"block",children:r}),jsxRuntimeExports.jsxs("div",{className:"flex space-x-2.5 items-center",children:[jsxRuntimeExports.jsx("input",{type:"number",value:R[0],placeholder:c,min:c,max:n[1],onChange:b=>v(0,b.target.value),onBlur:()=>m(0),className:inputOverride}),jsxRuntimeExports.jsx(libExports.Range,{step:1,min:c,max:d,values:n,onChange:a,renderTrack:({props:b,children:T})=>jsxRuntimeExports.jsxs("div",{...b,className:sliderBgStyle,children:[jsxRuntimeExports.jsx("div",{className:sliderFgStyle,style:{left:`${(n[0]-c)/(d-c)*100}%`,width:`${(n[1]-n[0])/(d-c)*100}%`}}),T]}),renderThumb:({props:b})=>jsxRuntimeExports.jsx("div",{...b,className:"relative w-5 h-5 flex items-center",children:jsxRuntimeExports.jsx("div",{className:sliderThumbStyle})})}),jsxRuntimeExports.jsx("input",{type:"number",value:R[1],placeholder:d,min:n[0],max:d,onChange:b=>v(1,b.target.value),onBlur:()=>m(1),className:`${inputOverride} ${textSmall}`})]})]})}function buildQueryString(r,n,a,c,d){const R=[],u=[],v=[];for(const[m,b]of Object.entries(a))b===1&&u.push(m),b===2&&v.push(m);return v.length&&R.push(`NOT elements HAS ANY ${v.map(m=>`"${m}"`).join(", ")}`),u.length&&R.push(`elements HAS ALL ${u.map(m=>`"${m}"`).join(", ")}`),c[0]!==r[0]&&R.push(`nelements>=${c[0]}`),c[1]!==r[1]&&R.push(`nelements<=${c[1]}`),d[0]!==n[0]&&R.push(`nsites>=${d[0]}`),d[1]!==n[1]&&R.push(`nsites<=${d[1]}`),R.join(" AND ")}function OptimadeFilters({queryUrl:r,initialFilter:n,onSubmit:a}){const[c,d]=reactExports.useState([1,118]),[R,u]=reactExports.useState([1,1e3]),[v,m]=reactExports.useState({}),[b,T]=reactExports.useState(!1),[x,k]=reactExports.useState(n||""),F=buildQueryString([1,118],[1,1e3],v,c,R),C=b?x:F,z=()=>{a(C)},Q=()=>{T(J=>!J),b||(k(F),m({}),d([1,118]),u([1,1e3]))};return reactExports.useEffect(()=>{n&&k(n)},[n]),jsxRuntimeExports.jsxs("div",{className:"pb-4 space-y-2",children:[jsxRuntimeExports.jsxs("div",{className:b?"opacity-50 pointer-events-none":"",children:[jsxRuntimeExports.jsx(PTable,{providerUrl:r,selected:v,onSelectionChange:J=>m(q=>({...q,...J}))}),jsxRuntimeExports.jsx(RangeSlider,{title:"Number of elements",value:c,onChange:d,min:1,max:118}),jsxRuntimeExports.jsx(RangeSlider,{title:"Number of sites",value:R,onChange:u,min:0,max:1e3})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2",children:[jsxRuntimeExports.jsx("input",{id:"manual-mode-toggle",type:"checkbox",checked:b,onChange:Q,className:"hover:cursor-pointer h-4 w-4"}),jsxRuntimeExports.jsx("label",{htmlFor:"manual-mode-toggle",className:`${textSmall} text-gray-700 select-none`,children:"Unlock custom query"})]}),jsxRuntimeExports.jsx(QueryTextBox,{value:C,onChange:b?k:()=>{},onSubmit:z})]})}const sectionclassName="space-y-2";function OptimadeFAQs(){const[r,n]=reactExports.useState(!1);return jsxRuntimeExports.jsxs("div",{className:`${containerStyle} ${textSmall} [&>p]:pl-4 [&>section>p]:pl-1`,children:[jsxRuntimeExports.jsxs("section",{className:sectionclassName,children:[jsxRuntimeExports.jsxs("p",{children:["The Materials Cloud OPTIMADE Client is a tool to search through databases exposing an"," ",jsxRuntimeExports.jsx("a",{href:"https://www.optimade.org/",target:"_blank",className:textHyperlink,rel:"noopener noreferrer",children:"OPTIMADE RESTful API"}),". All providers are retrieved from the"," ",jsxRuntimeExports.jsx("a",{href:"https://providers.optimade.org/",target:"_blank",className:textHyperlink,rel:"noopener noreferrer",children:"official OPTIMADE consortium's list"}),"."]}),jsxRuntimeExports.jsxs("button",{className:`flex items-center px-2 mt-2 mb-1 ${textHyperlink} hover:cursor-pointer`,onClick:()=>n(!r),children:[jsxRuntimeExports.jsx("span",{className:textHyperlink,children:r?"Hide additional Info":"More info"}),jsxRuntimeExports.jsx("svg",{className:`w-4 h-4 transition-transform duration-200 ${r?"rotate-90":"rotate-0"}`,fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})})]})]}),r&&jsxRuntimeExports.jsxs("section",{className:sectionclassName,children:[jsxRuntimeExports.jsx("h1",{className:textLarge,children:"Frequently asked questions"}),jsxRuntimeExports.jsx("h4",{className:textNormal,children:"Why is a given provider not shown in the client?"}),jsxRuntimeExports.jsxs("p",{children:["This webapp has filtered some providers for various reasons; some do not support open queries and others have no link to a meta-database. To check the validity of a particular provider visit"," ",jsxRuntimeExports.jsx("a",{href:"https://optimade.org/providers-dashboard/",target:"_blank",className:textHyperlink,rel:"noopener noreferrer",children:"the providers dashboard"}),". Querying of missing providers should still be possible through the 'Custom endpoint' method."]}),jsxRuntimeExports.jsx("h4",{className:textNormal,children:"Why does the structure visualiser not work for some structures?"}),jsxRuntimeExports.jsx("p",{children:"The visualiser is fairly primitive and the OPTIMADE specification is very broad. For complex structure data (assemblies, unknown positions, or partial occupancies), the JSON response is still fetched but the visualisation often fails."}),jsxRuntimeExports.jsxs("p",{className:"italic",children:["An earlier version of this tool was developed by Casper Welzel Andersen. See the source code"," ",jsxRuntimeExports.jsx("a",{href:"https://github.com/CasperWA/voila-optimade-client",target:"_blank",className:textHyperlink,rel:"noopener noreferrer",children:"here."})]})]})]})}const isBoolean=r=>typeof r=="boolean"||r instanceof Boolean,isNumber=r=>typeof r=="number"||r instanceof Number,isBigInt=r=>typeof r=="bigint"||r instanceof BigInt,isDate=r=>!!r&&r instanceof Date,isString=r=>typeof r=="string"||r instanceof String,isArray=r=>Array.isArray(r),isObject$1=r=>typeof r=="object"&&r!==null,isFunction=r=>!!r&&r instanceof Object&&typeof r=="function";function quoteString(r,n){return n===void 0&&(n=!1),!r||n?`"${r}"`:r}function quoteStringValue(r,n,a){return a?JSON.stringify(r):n?`"${r}"`:r}function ExpandableObject(r){let{field:n,value:a,data:c,lastElement:d,openBracket:R,closeBracket:u,level:v,style:m,shouldExpandNode:b,clickToExpandNode:T,outerRef:x,beforeExpandChange:k}=r;const F=reactExports.useRef(!1),[C,z]=reactExports.useState(()=>b(v,a,n)),Q=reactExports.useRef(null);reactExports.useEffect(()=>{F.current?z(b(v,a,n)):F.current=!0},[b]);const J=reactExports.useId();if(c.length===0)return EmptyObject({field:n,openBracket:R,closeBracket:u,lastElement:d,style:m});const q=C?m.collapseIcon:m.expandIcon,w=C?m.ariaLables.collapseJson:m.ariaLables.expandJson,N=v+1,V=c.length-1,H=ee=>{C!==ee&&(!k||k({level:v,value:a,field:n,newExpandValue:ee}))&&z(ee)},Y=ee=>{if(ee.key==="ArrowRight"||ee.key==="ArrowLeft")ee.preventDefault(),H(ee.key==="ArrowRight");else if(ee.key==="ArrowUp"||ee.key==="ArrowDown"){ee.preventDefault();const Ae=ee.key==="ArrowUp"?-1:1;if(!x.current)return;const ce=x.current.querySelectorAll("[role=button]");let ge=-1;for(let Me=0;Me<ce.length;Me++)if(ce[Me].tabIndex===0){ge=Me;break}if(ge<0)return;const me=(ge+Ae+ce.length)%ce.length;ce[ge].tabIndex=-1,ce[me].tabIndex=0,ce[me].focus()}},O=()=>{var ee;H(!C);const Ae=Q.current;if(!Ae)return;const ce=(ee=x.current)===null||ee===void 0?void 0:ee.querySelector('[role=button][tabindex="0"]');ce&&(ce.tabIndex=-1),Ae.tabIndex=0,Ae.focus()};return reactExports.createElement("div",{className:m.basicChildStyle,role:"treeitem","aria-expanded":C,"aria-selected":void 0},reactExports.createElement("span",{className:q,onClick:O,onKeyDown:Y,role:"button","aria-label":w,"aria-expanded":C,"aria-controls":C?J:void 0,ref:Q,tabIndex:v===0?0:-1}),(n||n==="")&&(T?reactExports.createElement("span",{className:m.clickableLabel,onClick:O,onKeyDown:Y},quoteString(n,m.quotesForFieldNames),":"):reactExports.createElement("span",{className:m.label},quoteString(n,m.quotesForFieldNames),":")),reactExports.createElement("span",{className:m.punctuation},R),C?reactExports.createElement("ul",{id:J,role:"group",className:m.childFieldsContainer},c.map((ee,Ae)=>reactExports.createElement(DataRender,{key:ee[0]||Ae,field:ee[0],value:ee[1],style:m,lastElement:Ae===V,level:N,shouldExpandNode:b,clickToExpandNode:T,beforeExpandChange:k,outerRef:x}))):reactExports.createElement("span",{className:m.collapsedContent,onClick:O,onKeyDown:Y}),reactExports.createElement("span",{className:m.punctuation},u),!d&&reactExports.createElement("span",{className:m.punctuation},","))}function EmptyObject(r){let{field:n,openBracket:a,closeBracket:c,lastElement:d,style:R}=r;return reactExports.createElement("div",{className:R.basicChildStyle,role:"treeitem","aria-selected":void 0},(n||n==="")&&reactExports.createElement("span",{className:R.label},quoteString(n,R.quotesForFieldNames),":"),reactExports.createElement("span",{className:R.punctuation},a),reactExports.createElement("span",{className:R.punctuation},c),!d&&reactExports.createElement("span",{className:R.punctuation},","))}function JsonObject(r){let{field:n,value:a,style:c,lastElement:d,shouldExpandNode:R,clickToExpandNode:u,level:v,outerRef:m,beforeExpandChange:b}=r;return ExpandableObject({field:n,value:a,lastElement:d||!1,level:v,openBracket:"{",closeBracket:"}",style:c,shouldExpandNode:R,clickToExpandNode:u,data:Object.keys(a).map(T=>[T,a[T]]),outerRef:m,beforeExpandChange:b})}function JsonArray(r){let{field:n,value:a,style:c,lastElement:d,level:R,shouldExpandNode:u,clickToExpandNode:v,outerRef:m,beforeExpandChange:b}=r;return ExpandableObject({field:n,value:a,lastElement:d||!1,level:R,openBracket:"[",closeBracket:"]",style:c,shouldExpandNode:u,clickToExpandNode:v,data:a.map(T=>[void 0,T]),outerRef:m,beforeExpandChange:b})}function JsonPrimitiveValue(r){let{field:n,value:a,style:c,lastElement:d}=r,R,u=c.otherValue;return a===null?(R="null",u=c.nullValue):a===void 0?(R="undefined",u=c.undefinedValue):isString(a)?(R=quoteStringValue(a,!c.noQuotesForStringValues,c.stringifyStringValues),u=c.stringValue):isBoolean(a)?(R=a?"true":"false",u=c.booleanValue):isNumber(a)?(R=a.toString(),u=c.numberValue):isBigInt(a)?(R=`${a.toString()}n`,u=c.numberValue):isDate(a)?R=a.toISOString():isFunction(a)?R="function() { }":R=a.toString(),reactExports.createElement("div",{className:c.basicChildStyle,role:"treeitem","aria-selected":void 0},(n||n==="")&&reactExports.createElement("span",{className:c.label},quoteString(n,c.quotesForFieldNames),":"),reactExports.createElement("span",{className:u},R),!d&&reactExports.createElement("span",{className:c.punctuation},","))}function DataRender(r){const n=r.value;return isArray(n)?reactExports.createElement(JsonArray,Object.assign({},r)):isObject$1(n)&&!isDate(n)&&!isFunction(n)?reactExports.createElement(JsonObject,Object.assign({},r)):reactExports.createElement(JsonPrimitiveValue,Object.assign({},r))}var styles={"container-light":"_2IvMF _GzYRV","basic-element-style":"_2bkNM","child-fields-container":"_1BXBN","label-light":"_1MGIk","clickable-label-light":"_2YKJg _1MGIk _1MFti","punctuation-light":"_3uHL6 _3eOF8","value-null-light":"_2T6PJ","value-undefined-light":"_1Gho6","value-string-light":"_vGjyY","value-number-light":"_1bQdo","value-boolean-light":"_3zQKs","value-other-light":"_1xvuR","collapse-icon-light":"_oLqym _f10Tu _1MFti _1LId0","expand-icon-light":"_2AXVT _f10Tu _1MFti _1UmXx","collapsed-content-light":"_2KJWg _1pNG9 _1MFti"};const defaultAriaLables={collapseJson:"collapse JSON",expandJson:"expand JSON"},defaultStyles={container:styles["container-light"],basicChildStyle:styles["basic-element-style"],childFieldsContainer:styles["child-fields-container"],label:styles["label-light"],clickableLabel:styles["clickable-label-light"],nullValue:styles["value-null-light"],undefinedValue:styles["value-undefined-light"],stringValue:styles["value-string-light"],booleanValue:styles["value-boolean-light"],numberValue:styles["value-number-light"],otherValue:styles["value-other-light"],punctuation:styles["punctuation-light"],collapseIcon:styles["collapse-icon-light"],expandIcon:styles["expand-icon-light"],collapsedContent:styles["collapsed-content-light"],noQuotesForStringValues:!1,quotesForFieldNames:!1,ariaLables:defaultAriaLables,stringifyStringValues:!1},allExpanded=()=>!0,JsonView=r=>{let{data:n,style:a=defaultStyles,shouldExpandNode:c=allExpanded,clickToExpandNode:d=!1,beforeExpandChange:R,compactTopLevel:u,...v}=r;const m=reactExports.useRef(null);return reactExports.createElement("div",Object.assign({"aria-label":"JSON view"},v,{className:a.container,ref:m,role:"tree"}),u&&isObject$1(n)?Object.entries(n).map(b=>{let[T,x]=b;return reactExports.createElement(DataRender,{key:T,field:T,value:x,style:{...defaultStyles,...a},lastElement:!0,level:1,shouldExpandNode:c,clickToExpandNode:d,beforeExpandChange:R,outerRef:m})}):reactExports.createElement(DataRender,{value:n,style:{...defaultStyles,...a},lastElement:!0,level:0,shouldExpandNode:c,clickToExpandNode:d,outerRef:m,beforeExpandChange:R}))},ControlBox=({viewerParams:r,onViewerParamChange:n,onViewerEvent:a})=>{const c=(u,v)=>{let m=r.supercell;m[u]=parseInt(v),n("supercell",m)},d=u=>{n(u,!r[u])},R=u=>{a("camera",u)};return jsxRuntimeExports.jsxs("div",{className:"control-box",children:[jsxRuntimeExports.jsxs("div",{className:"control-box-row",children:[jsxRuntimeExports.jsxs("div",{className:"supercell-container",children:[jsxRuntimeExports.jsx("label",{children:"Supercell: "}),jsxRuntimeExports.jsx("div",{style:{display:"flex"},children:[0,1,2].map(u=>jsxRuntimeExports.jsx("input",{className:"supercell-input",type:"number",min:"1",max:"99",value:r.supercell[u],onChange:v=>c(u,v.target.value)},u))})]}),jsxRuntimeExports.jsxs("div",{className:"camera-controls",children:[jsxRuntimeExports.jsx("label",{children:"Camera: "}),jsxRuntimeExports.jsx("button",{className:"camera-button",onClick:()=>R("x"),children:"x"}),jsxRuntimeExports.jsx("button",{className:"camera-button",onClick:()=>R("y"),children:"y"}),jsxRuntimeExports.jsx("button",{className:"camera-button",onClick:()=>R("z"),children:"z"})]})]}),jsxRuntimeExports.jsxs("div",{className:"control-box-row",style:{display:"flex"},children:[jsxRuntimeExports.jsxs("label",{className:"option-checkbox",children:[jsxRuntimeExports.jsx("input",{className:"control-box-input",type:"checkbox",checked:r.bonds,onChange:()=>d("bonds")}),jsxRuntimeExports.jsx("span",{children:"Bonds"})]}),jsxRuntimeExports.jsxs("label",{className:"option-checkbox",children:[jsxRuntimeExports.jsx("input",{className:"control-box-input",type:"checkbox",checked:r.packedCell,onChange:()=>d("packedCell")}),jsxRuntimeExports.jsx("span",{children:"Packed cell"})]}),jsxRuntimeExports.jsxs("label",{className:"option-checkbox",children:[jsxRuntimeExports.jsx("input",{className:"control-box-input",type:"checkbox",checked:r.atomLabels,onChange:()=>d("atomLabels")}),jsxRuntimeExports.jsx("span",{children:"Atom labels"})]}),jsxRuntimeExports.jsxs("label",{className:"option-checkbox",children:[jsxRuntimeExports.jsx("input",{className:"control-box-input",type:"checkbox",checked:r.spaceFilling,onChange:()=>d("vdwRadius")}),jsxRuntimeExports.jsx("span",{children:"vdW radius"})]})]})]})};var _3DmolMin={exports:{}};var hasRequired_3DmolMin;function require_3DmolMin(){return hasRequired_3DmolMin||(hasRequired_3DmolMin=1,(function(module,exports$1){var factory;factory=()=>(()=>{var __webpack_modules__={3:(r,n,a)=>{var c=a(663),d=a(981),R=a(972),u=a(681),v=a(834),m=a(746),b=a(670),T=Object.prototype.toString;function x(F){if(!(this instanceof x))return new x(F);this.options=d.assign({chunkSize:16384,windowBits:0,to:""},F||{});var C=this.options;C.raw&&C.windowBits>=0&&C.windowBits<16&&(C.windowBits=-C.windowBits,C.windowBits===0&&(C.windowBits=-15)),!(C.windowBits>=0&&C.windowBits<16)||F&&F.windowBits||(C.windowBits+=32),C.windowBits>15&&C.windowBits<48&&(15&C.windowBits||(C.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new m,this.strm.avail_out=0;var z=c.inflateInit2(this.strm,C.windowBits);if(z!==u.Z_OK)throw new Error(v[z]);if(this.header=new b,c.inflateGetHeader(this.strm,this.header),C.dictionary&&(typeof C.dictionary=="string"?C.dictionary=R.string2buf(C.dictionary):T.call(C.dictionary)==="[object ArrayBuffer]"&&(C.dictionary=new Uint8Array(C.dictionary)),C.raw&&(z=c.inflateSetDictionary(this.strm,C.dictionary))!==u.Z_OK))throw new Error(v[z])}function k(F,C){var z=new x(C);if(z.push(F,!0),z.err)throw z.msg||v[z.err];return z.result}x.prototype.push=function(F,C){var z,Q,J,q,w,N=this.strm,V=this.options.chunkSize,H=this.options.dictionary,Y=!1;if(this.ended)return!1;Q=C===~~C?C:C===!0?u.Z_FINISH:u.Z_NO_FLUSH,typeof F=="string"?N.input=R.binstring2buf(F):T.call(F)==="[object ArrayBuffer]"?N.input=new Uint8Array(F):N.input=F,N.next_in=0,N.avail_in=N.input.length;do{if(N.avail_out===0&&(N.output=new d.Buf8(V),N.next_out=0,N.avail_out=V),(z=c.inflate(N,u.Z_NO_FLUSH))===u.Z_NEED_DICT&&H&&(z=c.inflateSetDictionary(this.strm,H)),z===u.Z_BUF_ERROR&&Y===!0&&(z=u.Z_OK,Y=!1),z!==u.Z_STREAM_END&&z!==u.Z_OK)return this.onEnd(z),this.ended=!0,!1;N.next_out&&(N.avail_out!==0&&z!==u.Z_STREAM_END&&(N.avail_in!==0||Q!==u.Z_FINISH&&Q!==u.Z_SYNC_FLUSH)||(this.options.to==="string"?(J=R.utf8border(N.output,N.next_out),q=N.next_out-J,w=R.buf2string(N.output,J),N.next_out=q,N.avail_out=V-q,q&&d.arraySet(N.output,N.output,J,q,0),this.onData(w)):this.onData(d.shrinkBuf(N.output,N.next_out)))),N.avail_in===0&&N.avail_out===0&&(Y=!0)}while((N.avail_in>0||N.avail_out===0)&&z!==u.Z_STREAM_END);return z===u.Z_STREAM_END&&(Q=u.Z_FINISH),Q===u.Z_FINISH?(z=c.inflateEnd(this.strm),this.onEnd(z),this.ended=!0,z===u.Z_OK):Q!==u.Z_SYNC_FLUSH||(this.onEnd(u.Z_OK),N.avail_out=0,!0)},x.prototype.onData=function(F){this.chunks.push(F)},x.prototype.onEnd=function(F){F===u.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=d.flattenChunks(this.chunks)),this.chunks=[],this.err=F,this.msg=this.strm.msg},n.Inflate=x,n.inflate=k,n.inflateRaw=function(F,C){return(C=C||{}).raw=!0,k(F,C)},n.ungzip=k},16:(r,n,a)=>{a.r(n),a.d(n,{CAP:()=>c,CC:()=>b.CC,CONTEXTS_PER_VIEWPORT:()=>Ot,Color:()=>b.Color,CustomLinear:()=>T.CustomLinear,Cylinder:()=>v.Cylinder,GLDraw:()=>d,GLModel:()=>ur,GLShape:()=>Oe,GLViewer:()=>Zt,GLVolumetricRender:()=>Pt,Gradient:()=>T.Gradient,GradientType:()=>T.GradientType,Label:()=>Mt,LabelCount:()=>lt,MarchingCube:()=>_,MarchingCubeInitializer:()=>Bt,Matrix3:()=>m.Matrix3,Matrix4:()=>m.Matrix4,Parsers:()=>It,PausableTimer:()=>x.PausableTimer,PointGrid:()=>ne,ProteinSurface:()=>xe,Quaternion:()=>m.Quaternion,ROYGB:()=>T.ROYGB,RWB:()=>T.RWB,Ray:()=>m.Ray,Sinebow:()=>T.Sinebow,Sphere:()=>v.Sphere,SurfaceType:()=>Gr,Triangle:()=>v.Triangle,Vector2:()=>m.Vector2,Vector3:()=>m.Vector3,VolumeData:()=>Ve.VolumeData,adjustVolumeStyle:()=>x.adjustVolumeStyle,applyPartialCharges:()=>ri,autoinit:()=>_r,autoload:()=>Mi,base64ToArray:()=>x.base64ToArray,bondLength:()=>Ie.bondLength,builtinColorSchemes:()=>b.builtinColorSchemes,builtinGradients:()=>T.builtinGradients,chains:()=>b.chains,clamp:()=>m.clamp,conversionMatrix3:()=>m.conversionMatrix3,createStereoViewer:()=>Ur,createViewer:()=>Ar,createViewerGrid:()=>Cr,deepCopy:()=>x.deepCopy,degToRad:()=>m.degToRad,download:()=>x.download,drawCartoon:()=>ge,elementColors:()=>b.elementColors,extend:()=>x.extend,get:()=>x.get,getAtomProperty:()=>x.getAtomProperty,getColorFromStyle:()=>x.getColorFromStyle,getElement:()=>x.getElement,getExtent:()=>x.getExtent,getGradient:()=>T.getGradient,getPropertyRange:()=>x.getPropertyRange,getbin:()=>x.getbin,htmlColors:()=>b.htmlColors,inflateString:()=>x.inflateString,isEmptyObject:()=>x.isEmptyObject,isNumeric:()=>x.isNumeric,makeFunction:()=>x.makeFunction,mergeGeos:()=>x.mergeGeos,normalizeValue:()=>T.normalizeValue,partialCharges:()=>Qt,processing_autoinit:()=>Or,residues:()=>b.residues,setBondLength:()=>Ie.setBondLength,setSyncSurface:()=>qi,specStringToObject:()=>x.specStringToObject,splitMesh:()=>yt,ssColors:()=>b.ssColors,subdivide_spline:()=>k,syncSurface:()=>$r,viewers:()=>wr});var c,d,R=a(111),u=a(378),v=a(99),m=a(529),b=a(222);(function(ae){ae[ae.NONE=0]="NONE",ae[ae.FLAT=1]="FLAT",ae[ae.ROUND=2]="ROUND"})(c||(c={})),(function(ae){function i(h,E,g){var A,M,S,P,L,X=Math.hypot(h,E);X<1e-4?(M=0,S=1):(M=-h/X,S=E/X),E=-M*h+S*E,(A=Math.hypot(E,g))<1e-4?(P=0,L=1):(P=g/A,L=E/A);var U=new Float32Array(9);return U[0]=S,U[1]=M,U[2]=0,U[3]=-M*L,U[4]=S*L,U[5]=P,U[6]=M*P,U[7]=-S*P,U[8]=L,U}var s=new class{constructor(){this.cache={};let h,E=[],g=Math.pow(2,4),A=2,M=Math.pow(2,A),S=g/M;for(E[0]=new m.Vector3(-1,0,0),E[S]=new m.Vector3(0,0,1),E[2*S]=new m.Vector3(1,0,0),E[3*S]=new m.Vector3(0,0,-1),A=3;A<=4;A++){for(M=Math.pow(2,A-1),S=g/M,h=0;h<M-1;h++)E[S/2+h*S]=E[h*S].clone().add(E[(h+1)*S]).normalize();h=M-1,E[S/2+h*S]=E[h*S].clone().add(E[0]).normalize()}this.basisVectors=E}getVerticesForRadius(h,E,g){if(this.cache!==void 0&&this.cache[h]!==void 0&&this.cache[h][E+g]!==void 0)return this.cache[h][E+g];for(var A,M=this.basisVectors.length,S=[],P=[],L=0;L<M;L++)S.push(this.basisVectors[L].clone().multiplyScalar(h)),S.push(this.basisVectors[L].clone().multiplyScalar(h)),A=this.basisVectors[L].clone().normalize(),P.push(A),P.push(A);var X,U,j=[],W=10,G=M,Z=2*Math.PI,te=Math.PI,re=!1,de=!1;for(U=0;U<=W;U++){re=U===0||U===W,de=U===5;var le=[],ye=[];for(X=0;X<=G;X++)if(de){var Pe=X<G?2*X:0;ye.push(Pe+1),le.push(Pe)}else{var Te=X/G,ke=U/W;if(re&&X!==0)re&&le.push(S.length-1);else if(X<G){var we=new m.Vector3;we.x=-h*Math.cos(0+Te*Z)*Math.sin(0+ke*te),we.y=E==1?0:h*Math.cos(0+ke*te),we.z=h*Math.sin(0+Te*Z)*Math.sin(0+ke*te),Math.abs(we.x)<1e-5&&(we.x=0),Math.abs(we.y)<1e-5&&(we.y=0),Math.abs(we.z)<1e-5&&(we.z=0),E==c.FLAT?(A=new m.Vector3(0,Math.cos(0+ke*te),0)).normalize():(A=new m.Vector3(we.x,we.y,we.z)).normalize(),S.push(we),P.push(A),le.push(S.length-1)}else le.push(S.length-G)}de&&j.push(ye),j.push(le)}var Ge={vertices:S,normals:P,verticesRows:j,w:G,h:W};return h in this.cache||(this.cache[h]={}),this.cache[h][E+g]=Ge,Ge}};ae.drawCylinder=function(h,E,g,A,M,S=0,P=0){if(!E||!g)return;let L=function(_e){if(typeof _e=="string"){let ve=_e;return ve.toLowerCase()=="flat"?c.FLAT:ve.toLowerCase()=="round"?c.ROUND:c.NONE}return _e};S=L(S);var X=(P=L(P))||S;M=M||{r:0,g:0,b:0};var U,j,W,G,Z,te,re=i(g.x-E.x,g.y-E.y,g.z-E.z),de=s.getVerticesForRadius(A,P,"to"),le=de.w,ye=de.h,Pe=X?ye*le+2:2*le,Te=h.updateGeoGroup(Pe),ke=de.vertices,we=de.normals,Ge=de.verticesRows,Je=Ge[ye/2],tt=Ge[ye/2+1],Ze=Te.vertices,ut=Te.vertexArray,ft=Te.normalArray,Qe=Te.colorArray,pt=Te.faceArray;for(W=0;W<le;++W){var Be=2*W;G=re[0]*ke[Be].x+re[3]*ke[Be].y+re[6]*ke[Be].z,Z=re[1]*ke[Be].x+re[4]*ke[Be].y+re[7]*ke[Be].z,te=re[5]*ke[Be].y+re[8]*ke[Be].z,U=3*(Ze+Be),j=Te.faceidx,ut[U]=G+E.x,ut[U+1]=Z+E.y,ut[U+2]=te+E.z,ut[U+3]=G+g.x,ut[U+4]=Z+g.y,ut[U+5]=te+g.z,ft[U]=G,ft[U+3]=G,ft[U+1]=Z,ft[U+4]=Z,ft[U+2]=te,ft[U+5]=te,Qe[U]=M.r,Qe[U+3]=M.r,Qe[U+1]=M.g,Qe[U+4]=M.g,Qe[U+2]=M.b,Qe[U+5]=M.b,pt[j]=tt[W]+Ze,pt[j+1]=tt[W+1]+Ze,pt[j+2]=Je[W]+Ze,pt[j+3]=Je[W]+Ze,pt[j+4]=tt[W+1]+Ze,pt[j+5]=Je[W+1]+Ze,Te.faceidx+=6}if(X){var et,St,ot,wt,Et,it,Rt,Ht,kt,ct,Jt,Nt,qt,Vt,Kt,yr,Fr,Tr,ii,Wr,br,Xr,ci,ni,hi,zi,xi,Ii,Hr,Kr,qr,ei,p=S?ye+1:ye/2+1;for(Z=P?0:ye/2;Z<p;Z++)if(Z!==ye/2){var $=Z<=ye/2?g:E,y=s.getVerticesForRadius(A,P,"to"),be=s.getVerticesForRadius(A,S,"from");for($===g?(ke=y.vertices,we=y.normals,Ge=y.verticesRows):$==E&&(ke=be.vertices,we=be.normals,Ge=be.verticesRows),G=0;G<le;G++)j=Te.faceidx,Hr=3*((et=Ge[Z][G+1])+Ze),Kr=3*((St=Ge[Z][G])+Ze),qr=3*((ot=Ge[Z+1][G])+Ze),ei=3*((wt=Ge[Z+1][G+1])+Ze),Et=re[0]*ke[et].x+re[3]*ke[et].y+re[6]*ke[et].z,it=re[0]*ke[St].x+re[3]*ke[St].y+re[6]*ke[St].z,Rt=re[0]*ke[ot].x+re[3]*ke[ot].y+re[6]*ke[ot].z,Ht=re[0]*ke[wt].x+re[3]*ke[wt].y+re[6]*ke[wt].z,kt=re[1]*ke[et].x+re[4]*ke[et].y+re[7]*ke[et].z,ct=re[1]*ke[St].x+re[4]*ke[St].y+re[7]*ke[St].z,Jt=re[1]*ke[ot].x+re[4]*ke[ot].y+re[7]*ke[ot].z,Nt=re[1]*ke[wt].x+re[4]*ke[wt].y+re[7]*ke[wt].z,qt=re[5]*ke[et].y+re[8]*ke[et].z,Vt=re[5]*ke[St].y+re[8]*ke[St].z,Kt=re[5]*ke[ot].y+re[8]*ke[ot].z,yr=re[5]*ke[wt].y+re[8]*ke[wt].z,ut[Hr]=Et+$.x,ut[Kr]=it+$.x,ut[qr]=Rt+$.x,ut[ei]=Ht+$.x,ut[Hr+1]=kt+$.y,ut[Kr+1]=ct+$.y,ut[qr+1]=Jt+$.y,ut[ei+1]=Nt+$.y,ut[Hr+2]=qt+$.z,ut[Kr+2]=Vt+$.z,ut[qr+2]=Kt+$.z,ut[ei+2]=yr+$.z,Qe[Hr]=M.r,Qe[Kr]=M.r,Qe[qr]=M.r,Qe[ei]=M.r,Qe[Hr+1]=M.g,Qe[Kr+1]=M.g,Qe[qr+1]=M.g,Qe[ei+1]=M.g,Qe[Hr+2]=M.b,Qe[Kr+2]=M.b,Qe[qr+2]=M.b,Qe[ei+2]=M.b,Fr=re[0]*we[et].x+re[3]*we[et].y+re[6]*we[et].z,Tr=re[0]*we[St].x+re[3]*we[St].y+re[6]*we[St].z,ii=re[0]*we[ot].x+re[3]*we[ot].y+re[6]*we[ot].z,Wr=re[0]*we[wt].x+re[3]*we[wt].y+re[6]*we[wt].z,br=re[1]*we[et].x+re[4]*we[et].y+re[7]*we[et].z,Xr=re[1]*we[St].x+re[4]*we[St].y+re[7]*we[St].z,ci=re[1]*we[ot].x+re[4]*we[ot].y+re[7]*we[ot].z,ni=re[1]*we[wt].x+re[4]*we[wt].y+re[7]*we[wt].z,hi=re[5]*we[et].y+re[8]*we[et].z,zi=re[5]*we[St].y+re[8]*we[St].z,xi=re[5]*we[ot].y+re[8]*we[ot].z,Ii=re[5]*we[wt].y+re[8]*we[wt].z,Z===0?(ft[Hr]=Fr,ft[qr]=ii,ft[ei]=Wr,ft[Hr+1]=br,ft[qr+1]=ci,ft[ei+1]=ni,ft[Hr+2]=hi,ft[qr+2]=xi,ft[ei+2]=Ii,pt[j]=et+Ze,pt[j+1]=ot+Ze,pt[j+2]=wt+Ze,Te.faceidx+=3):Z===p-1?(ft[Hr]=Fr,ft[Kr]=Tr,ft[qr]=ii,ft[Hr+1]=br,ft[Kr+1]=Xr,ft[qr+1]=ci,ft[Hr+2]=hi,ft[Kr+2]=zi,ft[qr+2]=xi,pt[j]=et+Ze,pt[j+1]=St+Ze,pt[j+2]=ot+Ze,Te.faceidx+=3):(ft[Hr]=Fr,ft[Kr]=Tr,ft[ei]=Wr,ft[Hr+1]=br,ft[Kr+1]=Xr,ft[ei+1]=ni,ft[Hr+2]=hi,ft[Kr+2]=zi,ft[ei+2]=Ii,ft[Kr]=Tr,ft[qr]=ii,ft[ei]=Wr,ft[Kr+1]=Xr,ft[qr+1]=ci,ft[ei+1]=ni,ft[Kr+2]=zi,ft[qr+2]=xi,ft[ei+2]=Ii,pt[j]=et+Ze,pt[j+1]=St+Ze,pt[j+2]=wt+Ze,pt[j+3]=St+Ze,pt[j+4]=ot+Ze,pt[j+5]=wt+Ze,Te.faceidx+=6)}}Te.vertices+=Pe},ae.drawCone=function(h,E,g,A,M){if(!E||!g)return;M=M||{r:0,g:0,b:0};let S=new m.Vector3(g.x-E.x,g.y-E.y,g.z-E.z);var P=i(S.x,S.y,S.z);S=S.normalize();var L,X,U,j,W,G,Z=s.basisVectors.length,te=s.basisVectors,re=Z+2,de=h.updateGeoGroup(re),le=de.vertices,ye=de.vertexArray,Pe=de.normalArray,Te=de.colorArray,ke=de.faceArray;for(ye[L=3*le]=E.x,ye[L+1]=E.y,ye[L+2]=E.z,Pe[L]=-S.x,Pe[L+1]=-S.y,Pe[L+2]=-S.z,Te[L]=M.r,Te[L+1]=M.g,Te[L+2]=M.b,ye[L+3]=g.x,ye[L+4]=g.y,ye[L+5]=g.z,Pe[L+3]=S.x,Pe[L+4]=S.y,Pe[L+5]=S.z,Te[L+3]=M.r,Te[L+4]=M.g,Te[L+5]=M.b,L+=6,U=0;U<Z;++U){var we=te[U].clone();we.multiplyScalar(A),j=P[0]*we.x+P[3]*we.y+P[6]*we.z,W=P[1]*we.x+P[4]*we.y+P[7]*we.z,G=P[5]*we.y+P[8]*we.z,ye[L]=j+E.x,ye[L+1]=W+E.y,ye[L+2]=G+E.z,Pe[L]=j,Pe[L+1]=W,Pe[L+2]=G,Te[L]=M.r,Te[L+1]=M.g,Te[L+2]=M.b,L+=3}for(de.vertices+=Z+2,X=de.faceidx,U=0;U<Z;U++){var Ge=le+2+U,Je=le+2+(U+1)%Z;ke[X]=Ge,ke[X+1]=Je,ke[X+2]=le,ke[X+=3]=Ge,ke[X+1]=Je,ke[X+2]=le+1,X+=3}de.faceidx+=6*Z};var l=new class{constructor(){this.cache=new Map}getVerticesForRadius(h,E){E=E||2,this.cache.has(E)||this.cache.set(E,new Map);let g=this.cache.get(E);if(g.has(h))return g.get(h);var A={vertices:[],verticesRows:[],normals:[]},M=16*E,S=10*E;h<1&&(M=10*E,S=8*E);var P,L,X=2*Math.PI,U=Math.PI;for(L=0;L<=S;L++){let W=[];for(P=0;P<=M;P++){let G=P/M,Z=L/S,te=-h*Math.cos(0+G*X)*Math.sin(0+Z*U),re=h*Math.cos(0+Z*U),de=h*Math.sin(0+G*X)*Math.sin(0+Z*U);var j=new m.Vector3(te,re,de);j.normalize(),A.vertices.push({x:te,y:re,z:de}),A.normals.push(j),W.push(A.vertices.length-1)}A.verticesRows.push(W)}return g.set(h,A),A}};ae.drawSphere=function(h,E,g,A,M){var S=l.getVerticesForRadius(g,M),P=S.vertices,L=S.normals,X=h.updateGeoGroup(P.length),U=X.vertices,j=X.vertexArray,W=X.colorArray,G=X.faceArray,Z=X.lineArray,te=X.normalArray;for(let le=0,ye=P.length;le<ye;++le){let Pe=3*(U+le),Te=P[le];j[Pe]=Te.x+E.x,j[Pe+1]=Te.y+E.y,j[Pe+2]=Te.z+E.z,W[Pe]=A.r,W[Pe+1]=A.g,W[Pe+2]=A.b}X.vertices+=P.length;let re=S.verticesRows,de=re.length-1;for(let le=0;le<de;le++){let ye=re[le].length-1;for(let Pe=0;Pe<ye;Pe++){let Te=X.faceidx,ke=X.lineidx,we=re[le][Pe+1]+U,Ge=3*we,Je=re[le][Pe]+U,tt=3*Je,Ze=re[le+1][Pe]+U,ut=3*Ze,ft=re[le+1][Pe+1]+U,Qe=3*ft,pt=L[we-U],Be=L[Je-U],et=L[Ze-U],St=L[ft-U];Math.abs(P[we-U].y)===g?(te[Ge]=pt.x,te[ut]=et.x,te[Qe]=St.x,te[Ge+1]=pt.y,te[ut+1]=et.y,te[Qe+1]=St.y,te[Ge+2]=pt.z,te[ut+2]=et.z,te[Qe+2]=St.z,G[Te]=we,G[Te+1]=Ze,G[Te+2]=ft,Z[ke]=we,Z[ke+1]=Ze,Z[ke+2]=we,Z[ke+3]=ft,Z[ke+4]=Ze,Z[ke+5]=ft,X.faceidx+=3,X.lineidx+=6):Math.abs(P[Ze-U].y)===g?(te[Ge]=pt.x,te[tt]=Be.x,te[ut]=et.x,te[Ge+1]=pt.y,te[tt+1]=Be.y,te[ut+1]=et.y,te[Ge+2]=pt.z,te[tt+2]=Be.z,te[ut+2]=et.z,G[Te]=we,G[Te+1]=Je,G[Te+2]=Ze,Z[ke]=we,Z[ke+1]=Je,Z[ke+2]=we,Z[ke+3]=Ze,Z[ke+4]=Je,Z[ke+5]=Ze,X.faceidx+=3,X.lineidx+=6):(te[Ge]=pt.x,te[tt]=Be.x,te[Qe]=St.x,te[Ge+1]=pt.y,te[tt+1]=Be.y,te[Qe+1]=St.y,te[Ge+2]=pt.z,te[tt+2]=Be.z,te[Qe+2]=St.z,te[tt]=Be.x,te[ut]=et.x,te[Qe]=St.x,te[tt+1]=Be.y,te[ut+1]=et.y,te[Qe+1]=St.y,te[tt+2]=Be.z,te[ut+2]=et.z,te[Qe+2]=St.z,G[Te]=we,G[Te+1]=Je,G[Te+2]=ft,G[Te+3]=Je,G[Te+4]=Ze,G[Te+5]=ft,Z[ke]=we,Z[ke+1]=Je,Z[ke+2]=we,Z[ke+3]=ft,Z[ke+4]=Je,Z[ke+5]=Ze,Z[ke+6]=Ze,Z[ke+7]=ft,X.faceidx+=6,X.lineidx+=8)}}}})(d||(d={}));var T=a(546),x=a(864);function k(ae,i){var s,l,h,E,g,A,M,S,P,L=[],X=ae;for((X=[]).push(ae[0]),s=1,l=ae.length-1;s<l;s++)if(g=ae[s],A=ae[s+1],g.smoothen){var U=new m.Vector3((g.x+A.x)/2,(g.y+A.y)/2,(g.z+A.z)/2);U.atom=g.atom,X.push(U)}else X.push(g);for(X.push(ae[ae.length-1]),s=-1,h=X.length;s<=h-3;s++)if(E=X[s===-1?0:s],g=X[s+1],A=X[s+2],M=X[s===h-3?h-1:s+3],S=new m.Vector3().subVectors(A,E).multiplyScalar(.5),P=new m.Vector3().subVectors(M,g).multiplyScalar(.5),!A.skip)for(var j=0;j<i;j++){var W=1/i*j,G=g.x+W*S.x+W*W*(-3*g.x+3*A.x-2*S.x-P.x)+W*W*W*(2*g.x-2*A.x+S.x+P.x),Z=g.y+W*S.y+W*W*(-3*g.y+3*A.y-2*S.y-P.y)+W*W*W*(2*g.y-2*A.y+S.y+P.y),te=g.z+W*S.z+W*W*(-3*g.z+3*A.z-2*S.z-P.z)+W*W*W*(2*g.z-2*A.z+S.z+P.z),re=new m.Vector3(G,Z,te);re.atom=j<i/2?g.atom:A.atom,L.push(re)}return L.push(X[X.length-1]),L}const F=.5,C=1.3,z=.8,Q=.4,J=.4;function q(ae,i,s,l){for(var h,E,g,A,M=0,S=i.length;M<S;M++){A=Math.round(M*(l.length-1)/S),g=b.CC.color(l[A]);var P=ae.updateGeoGroup(2),L=P.vertexArray,X=P.colorArray,U=P.faceArray;L[E=3*(h=P.vertices)]=i[M].x,L[E+1]=i[M].y,L[E+2]=i[M].z,L[E+3]=s[M].x,L[E+4]=s[M].y,L[E+5]=s[M].z;for(var j=0;j<6;++j)X[E+3*j]=g.r,X[E+1+3*j]=g.g,X[E+2+3*j]=g.b;if(M>0){var W=[h,h+1,h-1,h-2],G=P.faceidx;U[G]=W[0],U[G+1]=W[1],U[G+2]=W[3],U[G+3]=W[1],U[G+4]=W[2],U[G+5]=W[3],P.faceidx+=6}P.vertices+=2}}function w(ae,i,s,l,h,E,g){g&&g!=="default"||(g="rectangle"),g==="edged"?(function(A,M,S,P,L){if(!(M.length<2)){var X,U;if(X=M[0],U=M[M.length-1],X=k(X,P),U=k(U,P),!L)return q(A,X,U,S);var j,W,G,Z,te,re,de,le,ye,Pe,Te,ke,we,Ge,Je,tt,Ze,ut,ft,Qe,pt,Be,et=[],St=[[0,2,-6,-8],[-4,-2,6,4],[7,-1,-5,3],[-3,5,1,-7]];for(we=0,Ge=X.length;we<Ge;we++){if(Pe=Math.round(we*(S.length-1)/Ge),ye=b.CC.color(S[Pe]),et.push(W=X[we]),et.push(W),et.push(G=U[we]),et.push(G),we<Ge-1){var ot=X[we+1].clone().sub(X[we]);j=U[we].clone().sub(X[we]).cross(ot).normalize().multiplyScalar(L)}for(et.push(Z=X[we].clone().add(j)),et.push(Z),et.push(te=U[we].clone().add(j)),et.push(te),W.atom!==void 0&&(Te=W.atom),Qe=(ft=A.updateGeoGroup(8)).vertexArray,pt=ft.colorArray,Be=ft.faceArray,Qe[de=3*(re=ft.vertices)]=W.x,Qe[de+1]=W.y,Qe[de+2]=W.z,Qe[de+3]=W.x,Qe[de+4]=W.y,Qe[de+5]=W.z,Qe[de+6]=G.x,Qe[de+7]=G.y,Qe[de+8]=G.z,Qe[de+9]=G.x,Qe[de+10]=G.y,Qe[de+11]=G.z,Qe[de+12]=Z.x,Qe[de+13]=Z.y,Qe[de+14]=Z.z,Qe[de+15]=Z.x,Qe[de+16]=Z.y,Qe[de+17]=Z.z,Qe[de+18]=te.x,Qe[de+19]=te.y,Qe[de+20]=te.z,Qe[de+21]=te.x,Qe[de+22]=te.y,Qe[de+23]=te.z,Je=0;Je<8;++Je)pt[de+3*Je]=ye.r,pt[de+1+3*Je]=ye.g,pt[de+2+3*Je]=ye.b;if(we>0){var wt=ke!==void 0&&Te!==void 0&&ke.serial!==Te.serial;for(Je=0;Je<4;Je++){var Et=[re+St[Je][0],re+St[Je][1],re+St[Je][2],re+St[Je][3]];if(Be[le=ft.faceidx]=Et[0],Be[le+1]=Et[1],Be[le+2]=Et[3],Be[le+3]=Et[1],Be[le+4]=Et[2],Be[le+5]=Et[3],ft.faceidx+=6,Te.clickable||ke.clickable||Te.hoverable||ke.hoverable){var it=et[Et[3]].clone(),Rt=et[Et[0]].clone(),Ht=et[Et[2]].clone(),kt=et[Et[1]].clone();if(it.atom=et[Et[3]].atom||null,Ht.atom=et[Et[2]].atom||null,Rt.atom=et[Et[0]].atom||null,kt.atom=et[Et[1]].atom||null,wt){var ct=it.clone().add(Rt).multiplyScalar(.5),Jt=Ht.clone().add(kt).multiplyScalar(.5),Nt=it.clone().add(kt).multiplyScalar(.5);Je%2==0?((ke.clickable||ke.hoverable)&&(tt=new v.Triangle(ct,Nt,it),Ze=new v.Triangle(Jt,Ht,Nt),ut=new v.Triangle(Nt,Ht,it),ke.intersectionShape.triangle.push(tt),ke.intersectionShape.triangle.push(Ze),ke.intersectionShape.triangle.push(ut)),(Te.clickable||Te.hoverable)&&(tt=new v.Triangle(Rt,kt,Nt),Ze=new v.Triangle(kt,Jt,Nt),ut=new v.Triangle(Rt,Nt,ct),Te.intersectionShape.triangle.push(tt),Te.intersectionShape.triangle.push(Ze),Te.intersectionShape.triangle.push(ut))):((Te.clickable||Te.hoverable)&&(tt=new v.Triangle(ct,Nt,it),Ze=new v.Triangle(Jt,Ht,Nt),ut=new v.Triangle(Nt,Ht,it),Te.intersectionShape.triangle.push(tt),Te.intersectionShape.triangle.push(Ze),Te.intersectionShape.triangle.push(ut)),(ke.clickable||ke.hoverable)&&(tt=new v.Triangle(Rt,kt,Nt),Ze=new v.Triangle(kt,Jt,Nt),ut=new v.Triangle(Rt,Nt,ct),ke.intersectionShape.triangle.push(tt),ke.intersectionShape.triangle.push(Ze),ke.intersectionShape.triangle.push(ut)))}else(Te.clickable||Te.hoverable)&&(tt=new v.Triangle(Rt,kt,it),Ze=new v.Triangle(kt,Ht,it),Te.intersectionShape.triangle.push(tt),Te.intersectionShape.triangle.push(Ze))}}}ft.vertices+=8,ke=Te}var qt=et.length-8;for(Qe=(ft=A.updateGeoGroup(8)).vertexArray,pt=ft.colorArray,Be=ft.faceArray,de=3*(re=ft.vertices),le=ft.faceidx,we=0;we<4;we++){et.push(et[2*we]),et.push(et[qt+2*we]);var Vt=et[2*we],Kt=et[qt+2*we];Qe[de+6*we]=Vt.x,Qe[de+1+6*we]=Vt.y,Qe[de+2+6*we]=Vt.z,Qe[de+3+6*we]=Kt.x,Qe[de+4+6*we]=Kt.y,Qe[de+5+6*we]=Kt.z,pt[de+6*we]=ye.r,pt[de+1+6*we]=ye.g,pt[de+2+6*we]=ye.b,pt[de+3+6*we]=ye.r,pt[de+4+6*we]=ye.g,pt[de+5+6*we]=ye.b}qt+=8,tt=[re,re+2,re+6,re+4],Ze=[re+1,re+5,re+7,re+3],Be[le]=tt[0],Be[le+1]=tt[1],Be[le+2]=tt[3],Be[le+3]=tt[1],Be[le+4]=tt[2],Be[le+5]=tt[3],Be[le+6]=Ze[0],Be[le+7]=Ze[1],Be[le+8]=Ze[3],Be[le+9]=Ze[1],Be[le+10]=Ze[2],Be[le+11]=Ze[3],ft.faceidx+=12,ft.vertices+=8}})(ae,i,s,l,h):g!=="rectangle"&&g!=="oval"&&g!=="parabola"||(function(A,M,S,P,L,X,U){var j,W,G,Z,te,re,de,le,ye,Pe;if((G=M.length)<2||M[0].length<2)return;for(j=0;j<G;j++)M[j]=k(M[j],P);if(Z=M[0].length,!L)return q(A,M[0],M[G-1],S);var Te=[],ke=[],we=[];for(W=0;W<G;W++)Te.push(.25+1.5*Math.sqrt((G-1)*W-Math.pow(W,2))/(G-1)),ke.push(.5),we.push(2*(Math.pow(W/G,2)-W/G)+.6);var Ge,Je,tt,Ze,ut,ft,Qe,pt,Be,et,St=[];for(W=0;W<2*G-1;W++)St[W]=[W,W+1,W+1-2*G,W-2*G];St[2*G-1]=[W,W+1-2*G,W+1-4*G,W-2*G];let ot=A.updateGeoGroup();for(j=0;j<Z;j++){let Rt=A.groups,Ht=!1;var wt,Et;for(ot=A.updateGeoGroup(2*G),Rt!=A.groups&&j>0&&(j-=1,Ht=!0),ft=Math.round(j*(S.length-1)/Z),ut=b.CC.color(S[ft]),ye=de,Pe=le,de=[],le=[],te=[],M[0][j].atom!==void 0&&(Ze=M[0][j].atom,U==="oval"?re=Te:U==="rectangle"?re=ke:U==="parabola"&&(re=we)),re||(re=ke),W=0;W<G;W++)wt=j<Z-1?M[W][j+1].clone().sub(M[W][j]):M[W][j-1].clone().sub(M[W][j]).negate(),Et=W<G-1?M[W+1][j].clone().sub(M[W][j]):M[W-1][j].clone().sub(M[W][j]).negate(),te[W]=Et.cross(wt).normalize().multiplyScalar(L*re[W]);for(W=0;W<G;W++)de[W]=M[W][j].clone().add(te[W].clone().negate());for(W=0;W<G;W++)le[W]=M[W][j].clone().add(te[W]);for(Qe=ot.vertexArray,pt=ot.colorArray,Be=ot.faceArray,Je=3*(Ge=ot.vertices),W=0;W<G;W++)Qe[Je+3*W+0]=de[W].x,Qe[Je+3*W+1]=de[W].y,Qe[Je+3*W+2]=de[W].z;for(W=0;W<G;W++)Qe[Je+3*W+0+3*G]=le[G-1-W].x,Qe[Je+3*W+1+3*G]=le[G-1-W].y,Qe[Je+3*W+2+3*G]=le[G-1-W].z;for(W=0;W<2*G;++W)pt[Je+3*W+0]=ut.r,pt[Je+3*W+1]=ut.g,pt[Je+3*W+2]=ut.b;if(j>0&&!Ht){for(W=0;W<2*G;W++)et=[Ge+St[W][0],Ge+St[W][1],Ge+St[W][2],Ge+St[W][3]],Be[tt=ot.faceidx]=et[0],Be[tt+1]=et[1],Be[tt+2]=et[3],Be[tt+3]=et[1],Be[tt+4]=et[2],Be[tt+5]=et[3],ot.faceidx+=6;if(Ze.clickable||Ze.hoverable){var it=[];for(W in it.push(new v.Triangle(ye[0],de[0],de[G-1])),it.push(new v.Triangle(ye[0],de[G-1],ye[G-1])),it.push(new v.Triangle(ye[G-1],de[G-1],le[G-1])),it.push(new v.Triangle(ye[G-1],le[G-1],Pe[G-1])),it.push(new v.Triangle(le[0],Pe[0],Pe[G-1])),it.push(new v.Triangle(le[G-1],le[0],Pe[G-1])),it.push(new v.Triangle(de[0],ye[0],Pe[0])),it.push(new v.Triangle(le[0],de[0],Pe[0])),it)Ze.intersectionShape.triangle.push(it[W])}}ot.vertices+=2*G}for(Qe=ot.vertexArray,pt=ot.colorArray,Be=ot.faceArray,Je=3*(Ge=ot.vertices),tt=ot.faceidx,j=0;j<G-1;j++)et=[j,j+1,2*G-2-j,2*G-1-j],Be[tt=ot.faceidx]=et[0],Be[tt+1]=et[1],Be[tt+2]=et[3],Be[tt+3]=et[1],Be[tt+4]=et[2],Be[tt+5]=et[3],ot.faceidx+=6;for(j=0;j<G-1;j++)et=[Ge-1-j,Ge-2-j,Ge-2*G+j+1,Ge-2*G+j],Be[tt=ot.faceidx]=et[0],Be[tt+1]=et[1],Be[tt+2]=et[3],Be[tt+3]=et[1],Be[tt+4]=et[2],Be[tt+5]=et[3],ot.faceidx+=6})(ae,i,s,l,h,0,g)}function N(ae){return ae&&ae.elem==="C"&&ae.atom==="CA"}function V(ae,i){if(ae&&i&&ae.chain===i.chain){if(!(ae.hetflag||i.hetflag||ae.reschain!==i.reschain||ae.resi!==i.resi&&ae.resi!==i.resi-1))return!0;if(ae.resi<i.resi){var s=ae.x-i.x,l=ae.y-i.y,h=ae.z-i.z,E=s*s+l*l+h*h;if(ae.atom=="CA"&&i.atom=="CA"&&E<16||(ae.atom=="P"||i.atom=="P")&&E<64)return!0}}return!1}function H(ae,i,s,l,h){if(i!=null&&i.vertices!=0){h&&(i.initTypedArrays(),i.setUpNormals());var E=new u.MeshDoubleLambertMaterial;E.vertexColors=u.Coloring.FaceColors,typeof s=="number"&&s>=0&&s<1&&(E.transparent=!0,E.opacity=s),E.outline=l;var g=new u.Mesh(i,E);ae.add(g)}}function Y(ae,i,s,l,h,E,g,A,M){var S,P,L,X,U,j;if(l&&h&&g){var W=h.sub(l);W.normalize();var G=A[M];for(P=M+1;P<A.length&&(G=A[P]).atom!=g.atom;P++);if((G=G?new m.Vector3(G.x,G.y,G.z):new m.Vector3(0,0,0)).sub(l),g.ss==="arrow start"){var Z=G.clone().multiplyScalar(.3).cross(h);l.add(Z);var te=G.clone().cross(W).normalize();W.rotateAboutVector(te,.43)}for(g.style.cartoon.ribbon?S=g.style.cartoon.thickness||Q:g.style.cartoon.width?S=g.style.cartoon.width:g.ss==="c"?S=g.atom==="P"?z:F:g.ss==="arrow start"?(S=C,U=!0):S=g.ss==="arrow end"||g.ss==="h"&&g.style.cartoon.tubes||g.ss==="tube start"?F:C,E!=null&&W.dot(E)<0&&W.negate(),W.multiplyScalar(S),P=0;P<i;P++)L=2*P/(i-1)-1,(X=new m.Vector3(l.x+L*W.x,l.y+L*W.y,l.z+L*W.z)).atom=g,g.ss==="s"&&(X.smoothen=!0),ae[P].push(X);if(U)for(W.multiplyScalar(2),P=0;P<i;P++)L=2*P/(i-1)-1,(X=new m.Vector3(l.x+L*W.x,l.y+L*W.y,l.z+L*W.z)).atom=g,X.smoothen=!1,X.skip=!0,ae[P].push(X);return j=g.style.cartoon.style||"default",ae.style?ae.style!=j&&(console.log("Warning: a cartoon chain's strand-style is ambiguous"),ae.style="default"):ae.style=j,g.ss!=="arrow start"&&g.ss!=="arrow end"||(g.ss="s"),U}}const O={C:!0,CA:!0,O:!0,P:!0,OP2:!0,O2P:!0,"O5'":!0,"O3'":!0,"C5'":!0,"C2'":!0,"O5*":!0,"O3*":!0,"C5*":!0,"C2*":!0,N1:!0,N3:!0},ee={DA:!0,DG:!0,A:!0,G:!0},Ae={DT:!0,DC:!0,U:!0,C:!0,T:!0},ce={DA:!0,DG:!0,A:!0,G:!0,DT:!0,DC:!0,U:!0,C:!0,T:!0};function ge(ae,i,s,l=10){let h=l,E=l;var g,A,M,S,P,L,X,U,j,W,G,Z,te,re,de,le,ye,Pe,Te=new u.Geometry(!0),ke=new u.Geometry(!0),we=[],Ge=[],Je=1,tt=!1,Ze={};for(var ut in T.Gradient.builtinGradients)T.Gradient.builtinGradients.hasOwnProperty(ut)&&(Ze[ut]=new T.Gradient.builtinGradients[ut](s[1],s[0]));var ft=function(Vt,Kt){return s&&Kt.color==="spectrum"?Kt.colorscheme in Ze?Ze[Kt.colorscheme].valueToHex(Vt.resi):Ze.sinebow.valueToHex(Vt.resi):(0,x.getColorFromStyle)(Vt,Kt).getHex()};for(U=0;U<h;U++)Ge[U]=[];var Qe=!1,pt=!1,Be=[];for(U in i){if((S=i[U]).elem==="C"&&S.atom==="CA"){var et=V(M,S);et&&S.ss==="s"?Qe=!0:Qe&&(M&&A&&M.style.cartoon.arrows&&A.style.cartoon.arrows&&(M.ss="arrow end",A.ss="arrow start"),Qe=!1),et&&(M.ss==="h"||M.ss=="tube start")&&M.style.cartoon.tubes?!pt&&M.ss!="tube start"&&S.style.cartoon.tubes&&(S.ss="tube start",pt=!0):pt&&(M.ss==="tube start"?M.ss="tube end":A&&A.style.cartoon.tubes&&(A.ss="tube end"),pt=!1),A=M,M=S}S&&S.atom in O&&Be.push(S)}pt&&M.style.cartoon.tubes&&(M.ss="tube end",pt=!1);var St=function(Vt){Ge[0].length>0&&w(ke,Ge,we,E,X,0,Ge.style);var Kt=[],yr=null;if(Vt){for(U=0;U<h;U++)Kt[U]=Ge[U][Ge[U].length-1];yr=we[we.length-1]}for(Ge=[],U=0;U<h;U++)Ge[U]=[];if(we=[],Vt){for(U=0;U<h;U++)Ge[U].push(Kt[U]);we.push(yr)}H(ae,ke,Je,tt,!0),H(ae,Te,Je,tt,!1),ke=new u.Geometry(!0),Te=new u.Geometry(!0)};M=void 0;let ot=[];for(var wt=0;wt<Be.length;wt++){var Et=(S=Be[wt]).resn.trim(),it=Et in ce;if(Je=1,g=S.style.cartoon,M&&M.style.cartoon&&(Je=M.style.cartoon.opacity),M&&M.style.cartoon&&M.style.cartoon.outline&&(tt=M.style.cartoon.outline),!M||!M.style.cartoon||S.style.cartoon&&M.style.cartoon.opacity==S.style.cartoon.opacity||St(M.chain==S.chain),M&&S&&!V(M,S)&&M.chain&&M.chain==S.chain&&!M.hetflag&&!S.hetflag&&M.reschain+1==S.reschain&&ot.push([M,S]),g.style==="trace"){if(!S.hetflag&&(S.elem==="C"&&S.atom==="CA"||it&&S.atom==="P"||S.atom==="BB")){if(L=ft(S,g),X=(0,x.isNumeric)(g.thickness)?g.thickness:Q,V(M,S))if(L==P){var Rt=b.CC.color(L);d.drawCylinder(Te,M,S,X,Rt,2,2)}else{var Ht=new m.Vector3().addVectors(M,S).multiplyScalar(.5),kt=b.CC.color(P),ct=b.CC.color(L);d.drawCylinder(Te,M,Ht,X,kt,2,0),d.drawCylinder(Te,Ht,S,X,ct,0,2)}if((S.clickable===!0||S.hoverable)&&S.intersectionShape!==void 0){var Jt=new m.Vector3(S.x,S.y,S.z);S.intersectionShape.sphere.push(new v.Sphere(Jt,X))}M=S,P=L}}else{if(N(S)||it&&(S.atom==="P"||S.atom.indexOf("O5")==0)){if(Pe)if(S.ss==="tube end")Pe=!1,ye=new m.Vector3(S.x,S.y,S.z),d.drawCylinder(Te,le,ye,2,b.CC.color(P),1,1),S.ss="h";else{if(M.chain==S.chain&&M.ss!=="tube end")continue;Pe=!1,M.ss="h",ye=new m.Vector3(M.x,M.y,M.z),d.drawCylinder(Te,le,ye,2,b.CC.color(P),1,1)}if(M&&(!V(M,S)||M.ss==="tube start")){for(M.ss==="tube start"&&(Pe=!0,le=new m.Vector3(M.x,M.y,M.z),M.ss="h"),de&&(re=Z?new m.Vector3().addVectors(M,Z).multiplyScalar(.5):new m.Vector3(M.x,M.y,M.z),d.drawCylinder(Te,re,de,J,b.CC.color(de.color),0,2),Y(Ge,h,!0,Z,te,G,M,Be,wt),we.push(L),re=null,de=null),Ge[0].length>0&&w(ke,Ge,we,E,X,0,Ge.style),Ge=[],U=0;U<h;U++)Ge[U]=[];we=[]}if(M===void 0||M.rescode!=S.rescode||M.resi!=S.resi){if(de&&M!=null){var Nt=(re=new m.Vector3().addVectors(M,S).multiplyScalar(.5)).clone().sub(de).multiplyScalar(.02);re.add(Nt),d.drawCylinder(Te,re,de,J,b.CC.color(de.color),0,2),re=null,de=null}L=ft(S,g),we.push(L),X=(0,x.isNumeric)(g.thickness)?g.thickness:Q,M=S,(j=new m.Vector3(M.x,M.y,M.z)).resi=M.resi,P=L}S.clickable!==!0&&S.hoverable!==!0||S.intersectionShape!==void 0&&S.intersectionShape.triangle!==void 0||(S.intersectionShape={sphere:null,cylinder:[],line:[],triangle:[]})}else M!=null&&(N(M)&&S.atom==="O"||it&&M.atom==="P"&&(S.atom==="OP2"||S.atom==="O2P")||it&&M.atom.indexOf("O5")==0&&S.atom.indexOf("C5")==0)?((W=new m.Vector3(S.x,S.y,S.z)).resi=S.resi,S.atom!=="OP2"&&S.atom!=="O2P"||(te=new m.Vector3(S.x,S.y,S.z))):it&&S.atom.indexOf("O3")==0?Z=new m.Vector3(S.x,S.y,S.z):(S.atom==="N1"&&Et in ee||S.atom==="N3"&&Et in Ae)&&((de=new m.Vector3(S.x,S.y,S.z)).color=(0,x.getColorFromStyle)(S,g).getHex());W&&j&&W.resi===j.resi&&(Y(Ge,h,!0,j,W,G,M,Be,wt),G=W,j=null,W=null,we.push(L))}}de&&(re=Z?new m.Vector3().addVectors(M,Z).multiplyScalar(.5):new m.Vector3(M.x,M.y,M.z),d.drawCylinder(Te,re,de,J,b.CC.color(de.color),0,2),Y(Ge,h,!0,Z,te,G,M,Be,wt),we.push(L)),St(!1);var qt=function(Vt,Kt){if(Vt.style.cartoon.gapcutoff&&Vt.style.cartoon.gapcutoff==Kt.style.cartoon.gapcutoff){let Fr=Vt.style.cartoon.gapcutoff,Tr=Kt.resi-Vt.resi;if(Tr>0&&Tr<Fr){let ii=.25,Wr=Kt.x-Vt.x,br=Kt.y-Vt.y,Xr=Kt.z-Vt.z,ci=Math.sqrt(Wr*Wr+br*br+Xr*Xr),ni=ci/(2*Tr),hi=new m.Vector3(Vt.x,Vt.y,Vt.z),zi=ci/ni,xi=new m.Vector3((Kt.x-Vt.x)/zi,(Kt.y-Vt.y)/zi,(Kt.z-Vt.z)/zi);hi.add({x:xi.x/2,y:xi.y/2,z:xi.z/2});let Ii=hi.clone().add(xi);xi.multiplyScalar(2);let Hr=(0,x.extend)({},Vt);for(var yr=0;yr<Tr;yr++){Hr.resi+=1;let Kr=ft(Hr,Hr.style.cartoon);d.drawCylinder(Te,hi,Ii,ii,b.CC.color(Kr),c.FLAT,c.FLAT),hi.add(xi),Ii.add(xi)}St(!1)}}};for(let Vt of ot)qt(Vt[0],Vt[1])}var me=a(797),Me=a(865),ue=a(392);function I(ae,i){for(var s=[[]],l=(i=i||{}).assignBonds===void 0||i.assignBonds,h=ae.trimStart().split(/\r?\n|\r/);h.length>0&&!(h.length<3);){var E=parseInt(h[0]);if(isNaN(E)||E<=0||h.length<E+2)break;var g=/Lattice\s*=\s*["\{\}]([^"\{\}]+)["\{\}]\s*/gi.exec(h[1]);if(g!=null&&g.length>1){var A=new Float32Array(g[1].split(/\s+/)),M=new u.Matrix3(A[0],A[3],A[6],A[1],A[4],A[7],A[2],A[5],A[8]);s.modelData=[{cryst:{matrix:M}}]}for(var S=2,P=s[s.length-1].length,L=P+E,X=P;X<L;X++){var U=h[S++].trim().split(/\s+/),j={};j.serial=X;var W=U[0];j.atom=j.elem=W[0].toUpperCase()+W.substring(1,2).toLowerCase(),j.x=parseFloat(U[1]),j.y=parseFloat(U[2]),j.z=parseFloat(U[3]),j.hetflag=!0,j.bonds=[],j.bondOrder=[],j.properties={},s[s.length-1][X]=j,U.length>=7&&(j.dx=parseFloat(U[4]),j.dy=parseFloat(U[5]),j.dz=parseFloat(U[6]))}if(!i.multimodel)break;s.push([]),h.splice(0,S)}if(l)for(let Z=0;Z<s.length;Z++)(0,ue.assignBonds)(s[Z],i);if(i.onemol){var G=s;(s=[]).push(G[0]);for(let Z=1;Z<G.length;Z++){let te=s[0].length;for(let re=0;re<G[Z].length;re++){let de=G[Z][re];for(let le=0;le<de.bonds.length;le++)de.bonds[le]=de.bonds[le]+te;de.index=s[0].length,de.serial=s[0].length,s[0].push(de)}}}return s}function he(ae,i){var s="V2000",l=ae.split(/\r?\n|\r/);return l.length>3&&l[3].length>38&&(s=l[3].substring(34,39)),s==="V2000"?(function(h,E){var g=[[]],A=!1;for(E.keepH!==void 0&&(A=!E.keepH);h.length>0&&!(h.length<4);){var M=parseInt(h[3].substring(0,3));if(isNaN(M)||M<=0)break;var S=parseInt(h[3].substring(3,6)),P=4;if(h.length<4+M+S)break;var L,X,U=[],j=g[g.length-1].length,W=j+M;for(L=j;L<W;L++,P++){var G={},Z=(X=h[P]).substring(31,34).replace(/ /g,"");G.atom=G.elem=Z[0].toUpperCase()+Z.substring(1).toLowerCase(),G.elem==="H"&&A||(G.serial=L,U[L]=g[g.length-1].length,G.x=parseFloat(X.substring(0,10)),G.y=parseFloat(X.substring(10,20)),G.z=parseFloat(X.substring(20,30)),G.hetflag=!0,G.bonds=[],G.bondOrder=[],G.properties={},G.index=g[g.length-1].length,g[g.length-1].push(G))}for(L=0;L<S;L++,P++){X=h[P];var te=U[parseInt(X.substring(0,3))-1+j],re=U[parseInt(X.substring(3,6))-1+j],de=parseFloat(X.substring(6));te!==void 0&&re!==void 0&&(g[g.length-1][te].bonds.push(re),g[g.length-1][te].bondOrder.push(de),g[g.length-1][re].bonds.push(te),g[g.length-1][re].bondOrder.push(de))}if(!E.multimodel)break;for(E.onemol||g.push([]);h[P]!=="$$$$"&&P<h.length;)P++;h.splice(0,++P)}return g})(l,i):s==="V3000"?(function(h,E){var g=[[]],A=!1;for(E.keepH!==void 0&&(A=!E.keepH);h.length>0&&!(h.length<8)&&h[4].startsWith("M  V30 BEGIN CTAB")&&h[5].startsWith("M  V30 COUNTS")&&!(h[5].length<14);){var M=h[5].substring(13).match(/\S+/g);if(M.length<2)break;var S=parseInt(M[0]);if(isNaN(S)||S<=0)break;var P=parseInt(M[1]),L=7;if(h.length<8+S+P)break;var X,U=[],j=g[g.length-1].length,W=j+S;for(X=j;X<W;X++,L++){var G=h[L].substring(6).match(/\S+/g);if(G.length>4){var Z={},te=G[1].replace(/ /g,"");Z.atom=Z.elem=te[0].toUpperCase()+te.substring(1).toLowerCase(),Z.elem==="H"&&A||(Z.serial=X,U[X]=g[g.length-1].length,Z.x=parseFloat(G[2]),Z.y=parseFloat(G[3]),Z.z=parseFloat(G[4]),Z.hetflag=!0,Z.bonds=[],Z.bondOrder=[],Z.properties={},Z.index=g[g.length-1].length,g[g.length-1].push(Z))}}if(h[L]!=="M  V30 END ATOM"||(L++,P===0||h[L]!=="M  V30 BEGIN BOND"))break;for(L++,X=0;X<P;X++,L++){var re=h[L].substring(6).match(/\S+/g);if(re.length>3){var de=U[parseInt(re[2])-1+j],le=U[parseInt(re[3])-1+j],ye=parseFloat(re[1]);de!==void 0&&le!==void 0&&(g[g.length-1][de].bonds.push(le),g[g.length-1][de].bondOrder.push(ye),g[g.length-1][le].bonds.push(de),g[g.length-1][le].bondOrder.push(ye))}}if(!E.multimodel)break;for(E.onemol||g.push([]);h[L]!=="$$$$"&&L<h.length;)L++;h.splice(0,++L)}return g})(l,i):[[""]]}function se(ae,i){var s=[[]];typeof ae=="string"&&(ae=JSON.parse(ae));for(var l=ae.m,h=l[0].a,E=l[0].b,g=l[0].s,A=i!==void 0&&i.parseStyle!==void 0?i.parseStyle:g!==void 0,M=s[s.length-1].length,S=0;S<h.length;S++){var P=h[S],L={};L.id=P.i,L.x=P.x,L.y=P.y,L.z=P.z||0,L.bonds=[],L.bondOrder=[];var X=P.l||"C";L.elem=X[0].toUpperCase()+X.substring(1).toLowerCase(),L.serial=s[s.length-1].length,A&&(L.style=g[P.s||0]),s[s.length-1].push(L)}for(let U=0;U<E.length;U++){let j=E[U],W=j.b+M,G=j.e+M,Z=j.o||1,te=s[s.length-1][W],re=s[s.length-1][G];te.bonds.push(G),te.bondOrder.push(Z),re.bonds.push(W),re.bondOrder.push(Z)}return s}function K(ae,i){(function(S,P){const L=P||3.2,X=L*L,U=[];for(let j=0,W=S.length;j<W;j++){S[j].index=j;const G=S[j];G.hetflag||G.atom!=="N"&&G.atom!=="O"||(U.push(G),G.hbondOther=null,G.hbondDistanceSq=Number.POSITIVE_INFINITY)}U.sort(function(j,W){return j.z-W.z});for(let j=0,W=U.length;j<W;j++){const G=U[j];for(let Z=j+1;Z<W;Z++){const te=U[Z],re=te.z-G.z;if(re>L)break;if(te.atom==G.atom)continue;const de=Math.abs(te.y-G.y);if(de>L)continue;const le=Math.abs(te.x-G.x);if(le>L)continue;const ye=le*le+de*de+re*re;ye>X||te.chain==G.chain&&Math.abs(te.resi-G.resi)<4||(ye<G.hbondDistanceSq&&(G.hbondOther=te,G.hbondDistanceSq=ye),ye<te.hbondDistanceSq&&(te.hbondOther=G,te.hbondDistanceSq=ye))}}})(ae,i);const s={};let l,h,E,g,A,M;for(l=0,h=ae.length;l<h;l++)if(A=ae[l],s[A.chain]===void 0&&(s[A.chain]=[]),isFinite(A.hbondDistanceSq)){const S=A.hbondOther;s[S.chain]===void 0&&(s[S.chain]=[]),Math.abs(S.resi-A.resi)===4&&(s[A.chain][A.resi]="h")}for(E in s)for(g=1;g<s[E].length-1;g++){const S=s[E][g-1],P=s[E][g+1];M=s[E][g],S=="h"&&S==P&&M!=S&&(s[E][g]=S)}for(l=0,h=ae.length;l<h;l++)A=ae[l],isFinite(A.hbondDistanceSq)&&s[A.chain][A.resi]!="h"&&A.ss!=="h"&&(s[A.chain][A.resi]="maybesheet");for(let S=0,P=ae.length;S<P;S++)if(A=ae[S],isFinite(A.hbondDistanceSq)&&s[A.chain][A.resi]=="maybesheet"){let L=A.hbondOther,X=s[L.chain][L.resi];X!="maybesheet"&&X!="s"||(s[A.chain][A.resi]="s",s[L.chain][L.resi]="s")}for(let S in s){for(let P=1;P<s[S].length-1;P++){const L=s[S][P-1],X=s[S][P+1];M=s[S][P],L=="s"&&L==X&&M!=L&&(s[S][P]=L)}for(let P=0;P<s[S].length;P++){const L=s[S][P];L!="h"&&L!="s"||s[S][P-1]!=L&&s[S][P+1]!=L&&delete s[S][P]}}for(l=0,h=ae.length;l<h;l++)A=ae[l],M=s[A.chain][A.resi],delete A.hbondOther,delete A.hbondDistanceSq,M!==void 0&&M!=="maybesheet"&&(A.ss=M,s[A.chain][A.resi-1]!=M&&(A.ssbegin=!0),s[A.chain][A.resi+1]!=M&&(A.ssend=!0))}function Re(ae,i,s,l){const h=!s.duplicateAssemblyAtoms,E=i.length;let g=E,A=-1,M=null,S=null;(s.normalizeAssembly||s.wrapAtoms)&&l&&(M=(0,u.conversionMatrix3)(l.a,l.b,l.c,l.alpha,l.beta,l.gamma),S=new u.Matrix3,S.getInverse3(M));let P=function(U){let j=U.clone().applyMatrix3(S);const W=[j.x,j.y,j.z],G=[0,0,0];for(let te=0;te<3;te++){for(;W[te]<-.001;)W[te]+=1,G[te]+=1;for(;W[te]>1.001;)W[te]-=1,G[te]-=1}const Z=new u.Vector3(G[0],G[1],G[2]);return Z.applyMatrix3(M),Z};if(s.normalizeAssembly&&l)for(let U=0;U<ae.length;U++){const j=new u.Vector3(0,0,0);for(let G=0;G<E;G++){const Z=new u.Vector3(i[G].x,i[G].y,i[G].z);Z.applyMatrix4(ae[U]),j.add(Z)}j.divideScalar(E);const W=P(j);ae[U].isNearlyIdentity()&&W.lengthSq()>.001&&(A=U),ae[U].translate(W)}if(h){if(ae.length>1)for(let U=0;U<i.length;U++){var L=[];for(let j=0;j<ae.length;j++)if(!ae[j].isNearlyIdentity()){var X=new u.Vector3;X.set(i[U].x,i[U].y,i[U].z),X.applyMatrix4(ae[j]),L.push(X)}i[U].symmetries=L}}else{for(let U=0;U<E;U++)i[U].sym=-1;for(let U=0;U<ae.length;U++)if(ae[U].isNearlyIdentity()||A==U)for(let j=0;j<E;j++)i[j].sym=U;else{let j=new u.Vector3;for(let W=0;W<E;W++){const G=[];for(let te=0;te<i[W].bonds.length;te++)G.push(i[W].bonds[te]+g);if(j.set(i[W].x,i[W].y,i[W].z),j.applyMatrix4(ae[U]),s.wrapAtoms&&l){let te=P(j);j.add(te)}const Z={};for(const te in i[W])Z[te]=i[W][te];Z.x=j.x,Z.y=j.y,Z.z=j.z,Z.bonds=G,Z.sym=U,Z.index=i.length,i.push(Z)}g=i.length}if(s.wrapAtoms&&l){let U=new u.Vector3;for(let j=0;j<E;j++){U.set(i[j].x,i[j].y,i[j].z);let W=P(U);U.add(W),i[j].x=U.x,i[j].y=U.y,i[j].z=U.z}}if(A>=0){const U=new u.Vector3;for(let j=0;j<E;j++)U.set(i[j].x,i[j].y,i[j].z),U.applyMatrix4(ae[A]),i[j].x=U.x,i[j].y=U.y,i[j].z=U.z}ae.length=0}}var fe=a(408);const De=new Set(["ABU","ACD","ALA","ALB","ALI","ARG","AR0","ASN","ASP","ASX","BAS","CYS","CYH","CYX","CSS","CSH","GLN","GLU","GLX","GLY","HIS","HIE","HID","HIP","HYP","ILE","ILU","LEU","LYS","MET","PCA","PGA","PHE","PR0","PRO","PRZ","SER","THR","TRP","TYR","VAL","A","1MA","C","5MC","OMC","G","1MG","2MG","M2G","7MG","OMG","YG","I","T","U","+U","H2U","5MU","PSU","ACE","F0R","H2O","HOH","WAT"]);function We(ae,i){const s=[],l=[];for(let A=0,M=ae.length;A<M;A++){const S=ae[A];S.index=A,S.hetflag||!De.has(S.resn)?l.push(S):s.push(S)}(0,ue.assignBonds)(l,i),s.sort(function(A,M){return A.chain!==M.chain?A.chain<M.chain?-1:1:A.resi-M.resi});let h,E=-1,g=-1;for(let A=0,M=s.length;A<M;A++){const S=s[A];S.resi!==E&&(E=S.resi,h||g++,h=!1),S.reschain=g;for(let P=A+1;P<s.length;P++){const L=s[P];if(L.chain!==S.chain||L.resi-S.resi>1)break;(0,fe.areConnected)(S,L,i)&&(S.bonds.indexOf(L.index)===-1&&(S.bonds.push(L.index),S.bondOrder.push(1),L.bonds.push(S.index),L.bondOrder.push(1)),S.resi!==L.resi&&(h=!0))}}}const oe=function(ae,i,s,l){return new u.Vector3(i,s,l).applyMatrix3(ae)};function Ee(ae,i={}){const s=[],l=!i.doAssembly,h=s.modelData=[],E=i.assignBonds===void 0||i.assignBonds;function g(X,U){const j=[];let W=0,G=0;for(;G<X.length;){for(;X.substring(G,G+U.length)!==U&&G<X.length;)if(X[G]==="'"){for(G++;G<X.length&&X[G]!=="'";)G++;for(;X.substring(G,G+U.length)!==U&&G<X.length;)G++}else if(X[G]==='"'){for(G++;G<X.length&&X[G]!=='"';)G++;G++}else G++;j.push(X.substring(W,G)),W=G+=U.length}return j}const A=ae.split(/\r?\n|\r/),M=[];let S=!1;for(let X=0;X<A.length;X++){var P=A[X].split("#")[0];if(S?P[0]===";"&&(S=!1):P[0]===";"&&(S=!0),S||P!==""){if(!S&&(P=P.trim())[0]==="_"){const U=P.split(/\s/)[0].indexOf(".");if(U>-1){let j=P.split("");j[U]="_",P=(P=j.join("")).substring(0,U)+"_"+P.substring(U+1)}}M.push(P)}}let L=0;for(;L<M.length;){for(;!M[L].startsWith("data_")||M[L]==="data_global";)L++;L++;const X={};for(;L<M.length&&!M[L].startsWith("data_");)if(M[L][0]===void 0)L++;else if(M[L][0]==="_"){const G=M[L].split(/\s/)[0].toLowerCase(),Z=X[G]=X[G]||[],te=M[L].substring(M[L].indexOf(G)+G.length);if(te==="")if(L++,M[L][0]===";"){let re=M[L].substring(1);for(L++;M[L]!==";";)re=re+`
`+M[L],L++;Z.push(re)}else Z.push(M[L]);else Z.push(te.trim());L++}else if(M[L].substring(0,5)==="loop_"){L++;const G=[];for(;M[L]===""||M[L][0]==="_";){if(M[L]!==""){let te=M[L].split(/\s/)[0].toLowerCase(),re=X[te]=X[te]||[];G.push(re)}L++}let Z=0;for(;L<M.length&&M[L][0]!=="_"&&!M[L].startsWith("loop_")&&!M[L].startsWith("data_");){let te=g(M[L]," ");for(let re=0;re<te.length;re++)te[re]!==""&&(G[Z].push(te[re]),Z=(Z+1)%G.length);L++}}else L++;h.push({symmetries:[]}),s.push([]);const U=X._atom_site_id!==void 0?X._atom_site_id.length:X._atom_site_label.length;let j;if(X._cell_length_a!==void 0){const G=parseFloat(X._cell_length_a),Z=parseFloat(X._cell_length_b),te=parseFloat(X._cell_length_c),re=parseFloat(X._cell_angle_alpha)||90,de=parseFloat(X._cell_angle_beta)||90,le=parseFloat(X._cell_angle_gamma)||90;j=(0,u.conversionMatrix3)(G,Z,te,re,de,le),h[h.length-1].cryst={a:G,b:Z,c:te,alpha:re,beta:de,gamma:le}}for(let G=0;G<U;G++){if(X._atom_site_group_pdb!==void 0&&X._atom_site_group_pdb[G]==="TER")continue;const Z={};if(X._atom_site_cartn_x!==void 0)Z.x=parseFloat(X._atom_site_cartn_x[G]),Z.y=parseFloat(X._atom_site_cartn_y[G]),Z.z=parseFloat(X._atom_site_cartn_z[G]);else{const re=oe(j,parseFloat(X._atom_site_fract_x[G]),parseFloat(X._atom_site_fract_y[G]),parseFloat(X._atom_site_fract_z[G]));Z.x=re.x,Z.y=re.y,Z.z=re.z}Z.chain=X._atom_site_auth_asym_id?X._atom_site_auth_asym_id[G]:X._atom_site_label_asym_id?X._atom_site_label_asym_id[G]:void 0,Z.lchain=X._atom_site_label_asym_id?X._atom_site_label_asym_id[G]:void 0,Z.resi=X._atom_site_auth_seq_id?parseInt(X._atom_site_auth_seq_id[G]):X._atom_site_label_seq_id?X._atom_site_label_seq_id[G]:void 0,Z.resn=X._atom_site_auth_comp_id?X._atom_site_auth_comp_id[G].trim():X._atom_site_label_comp_id?X._atom_site_label_comp_id[G].trim():void 0,Z.atom=X._atom_site_auth_atom_id?X._atom_site_auth_atom_id[G].replace(/"/gm,""):X._atom_site_label_atom_id?X._atom_site_label_atom_id[G].replace(/"/gm,""):void 0,Z.hetflag=!X._atom_site_group_pdb||X._atom_site_group_pdb[G]==="HETA"||X._atom_site_group_pdb[G]==="HETATM",X._atom_site_b_iso_or_equiv&&(Z.b=parseFloat(X._atom_site_b_iso_or_equiv[G]));let te="X";X._atom_site_type_symbol?te=X._atom_site_type_symbol[G].replace(/\(?\+?\d+.*/,""):X._atom_site_label&&(te=X._atom_site_label[G].split("_")[0].replace(/\(?\d+.*/,"")),Z.elem=te[0].toUpperCase()+te.substring(1,2).toLowerCase(),Z.bonds=[],Z.ss="c",Z.serial=G,Z.bondOrder=[],Z.properties={},s[s.length-1].push(Z)}if(X._pdbx_struct_oper_list_id!==void 0&&!l)for(let G=0;G<X._pdbx_struct_oper_list_id.length;G++){const Z=parseFloat(X["_pdbx_struct_oper_list_matrix[1][1]"][G]),te=parseFloat(X["_pdbx_struct_oper_list_matrix[1][2]"][G]),re=parseFloat(X["_pdbx_struct_oper_list_matrix[1][3]"][G]),de=parseFloat(X["_pdbx_struct_oper_list_vector[1]"][G]),le=parseFloat(X["_pdbx_struct_oper_list_matrix[2][1]"][G]),ye=parseFloat(X["_pdbx_struct_oper_list_matrix[2][2]"][G]),Pe=parseFloat(X["_pdbx_struct_oper_list_matrix[2][3]"][G]),Te=parseFloat(X["_pdbx_struct_oper_list_vector[2]"][G]),ke=parseFloat(X["_pdbx_struct_oper_list_matrix[3][1]"][G]),we=parseFloat(X["_pdbx_struct_oper_list_matrix[3][2]"][G]),Ge=parseFloat(X["_pdbx_struct_oper_list_matrix[3][3]"][G]),Je=parseFloat(X["_pdbx_struct_oper_list_vector[3]"][G]),tt=new u.Matrix4(Z,te,re,de,le,ye,Pe,Te,ke,we,Ge,Je);h[h.length-1].symmetries.push(tt)}const W=function(G){const Z=G.match("-"),te=(G=G.replace(/[-xyz]/g,"")).split("/");let re,de;return de=te[1]===void 0?1:parseInt(te[1]),re=te[0]===""?1:parseInt(te[0]),re/de*(Z?-1:1)};if(X._symmetry_equiv_pos_as_xyz!==void 0&&!l)for(let G=0;G<X._symmetry_equiv_pos_as_xyz.length;G++){const Z=X._symmetry_equiv_pos_as_xyz[G].replace(/["' ]/g,"").split(",").map(function(le){return le.replace(/-/g,"+-")});let te=new u.Matrix4(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1);for(let le=0;le<3;le++){const ye=Z[le].split("+");for(let Pe=0;Pe<ye.length;Pe++){const Te=ye[Pe];if(Te==="")continue;const ke=W(Te);Te.match("x")?te.elements[le+0]=ke:Te.match("y")?te.elements[le+4]=ke:Te.match("z")?te.elements[le+8]=ke:te.elements[le+12]=ke}}const re=j.getMatrix4(),de=new u.Matrix4().getInverse(re,!0);te=new u.Matrix4().multiplyMatrices(te,de),te=new u.Matrix4().multiplyMatrices(re,te),h[h.length-1].symmetries.push(te)}}for(let X=0;X<s.length;X++)!E||i.duplicateAssemblyAtoms&&!i.dontConnectDuplicatedAtoms||We(s[X],i),K(s[X],i.hbondCutoff),Re(h[X].symmetries,s[X],i,h[X].cryst),i.duplicateAssemblyAtoms&&!i.dontConnectDuplicatedAtoms&&E&&We(s[X],i);return s}let He={"C.1":"C",C1:"C","C.2":"C",C2:"C","C.3":"C",C3:"C","C.ar":"C",Car:"C","C.cat":"C",Ccat:"C","H.spc":"H",Hspc:"H","H.t3p":"H",Ht3p:"H","N.1":"N",N1:"N","N.2":"N",N2:"N","N.3":"N",N3:"N","N.4":"N",N4:"N","N.am":"N",Nam:"N","N.ar":"N",Nar:"N","N.p13":"N",Np13:"N","O.2":"O",O2:"O","O.3":"O",O3:"O","O.co2":"O",Oco2:"O","O.spc":"O",Ospc:"O","O.t3p":"O",Ot3p:"O","P.3":"P",P3:"P","S.2":"S",S2:"S","S.3":"S",S3:"S","S.o":"S",So:"S","S.o2":"S",So2:"S"};function Ue(ae,i){var s=[[]],l=!1;i.keepH!==void 0&&(l=!i.keepH);var h=ae.search(/@<TRIPOS>MOLECULE/),E=ae.search(/@<TRIPOS>ATOM/);if(h==-1||E==-1)return s;for(var g=ae.substring(h).split(/\r?\n|\r/);g.length>0;){var A=[],M=g[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),S=parseInt(M[0]),P=0;M.length>1&&(P=parseInt(M[1]));var L,X=4;for(L=3;L<g.length;L++)if(g[L]=="@<TRIPOS>ATOM"){X=L+1;break}var U=s[s.length-1].length,j=U+S;for(L=U;L<j;L++){var W={},G=(M=g[X++].replace(/^\s+/,"").replace(/\s+/g," ").split(" "))[5];if(G=He[G]!==void 0?He[G]:(G=G.split(".")[0])[0].toUpperCase()+G.substring(1).toLowerCase(),W.atom=M[1],W.elem=G,!(W.elem=="H"&&l)){var Z=s[s.length-1].length,te=parseInt(M[0]);W.serial=te,W.x=parseFloat(M[2]),W.y=parseFloat(M[3]),W.z=parseFloat(M[4]),W.atom=M[5];var re=parseFloat(M[8]);W.index=Z,W.bonds=[],W.bondOrder=[],W.properties={charge:re,partialCharge:re},A[te]=Z,s[s.length-1].push(W)}}for(var de=!1;X<g.length;)if(g[X++]=="@<TRIPOS>BOND"){de=!0;break}if(de&&P)for(L=0;L<P;L++){M=g[X++].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");var le=parseInt(M[1]),ye=s[s.length-1][A[le]],Pe=parseInt(M[2]),Te=s[s.length-1][A[Pe]],ke=parseInt(M[3]);isNaN(ke)&&(ke=1),ye!==void 0&&Te!==void 0&&(ye.bonds.push(A[Pe]),ye.bondOrder.push(ke),Te.bonds.push(A[le]),Te.bondOrder.push(ke))}if(!i.multimodel)break;i.onemol||s.push([]),g.splice(0,X),ae=g.join(`
`)}return s}var Ie=a(40);function rt(ae,i){let s=ae.replace(/ /g,"");return s.length>0&&s[0]==="H"&&s!=="Hg"&&s!=="He"&&s!=="Hf"&&s!=="Hs"&&s!=="Ho"&&(s="H"),s.length>1&&(s=s[0].toUpperCase()+s.substring(1).toLowerCase(),Ie.bondTable[s]===void 0?s=s[0]:i&&(s==="Ca"||s==="Cd")&&(s="C")),s}function st(ae){for(const i in ae)return!1;return!0}function at(ae,i,s){const l=[],h=i.assignBonds===void 0||i.assignBonds,E=!i.keepH,g=!!i.noSecondaryStructure,A=!i.noComputeSecondaryStructure,M=!i.doAssembly,S=i.altLoc?i.altLoc:"A",P={symmetries:[],cryst:void 0};let L,X=[];const U=[];let j;const W={};for(let G=0;G<ae.length;G++){j=ae[G].replace(/^\s*/,"");const Z=j.substring(0,6);let te,re,de;if(Z.indexOf("END")===0){if(X=ae.slice(G+1),Z==="END")for(const le in s)s.hasOwnProperty(le)&&delete s[le];break}if(Z==="ATOM  "||Z==="HETATM"){let le,ye,Pe,Te,ke,we,Ge,Je,tt,Ze,ut,ft;if(ut=j.substring(16,17),ut!==" "&&ut!==S&&S!=="*"||(Ze=parseInt(j.substring(6,11)),L=j.substring(12,16).replace(/ /g,""),le=j.substring(17,20).replace(/ /g,""),ye=j.substring(21,22),Pe=parseInt(j.substring(22,26)),Te=j.substring(26,27),ke=parseFloat(j.substring(30,38)),we=parseFloat(j.substring(38,46)),Ge=parseFloat(j.substring(46,54)),ft=parseFloat(j.substring(60,68)),tt=j.substring(76,78).replace(/ /g,""),tt=tt===""||Ie.bondTable[tt]===void 0?rt(j.substring(12,14),j[0]=="A"):tt[0].toUpperCase()+tt.substring(1).toLowerCase(),tt==="H"&&E))continue;Je=Z[0]=="H",U[Ze]=l.length,l.push({resn:le,x:ke,y:we,z:Ge,elem:tt,hetflag:Je,altLoc:ut,chain:ye,resi:Pe,icode:Te,rescode:Pe+(Te!==" "?"^"+Te:""),serial:Ze,atom:L,bonds:[],ss:"c",bondOrder:[],properties:{},b:ft,pdbline:j})}else if(Z==="SHEET "){te=j.substring(21,22),re=parseInt(j.substring(22,26)),de=parseInt(j.substring(33,37)),te in s||(s[te]={}),s[te][re]="s1";for(let le=re+1;le<de;le++)s[te][le]="s";s[te][de]="s2"}else if(Z==="CONECT"){const le=U[parseInt(j.substring(6,11))],ye=l[le],Pe=[11,16,21,26];for(let Te=0;Te<4;Te++){const ke=U[parseInt(j.substring(Pe[Te],Pe[Te]+5))];let we=le+":"+ke;const Ge=l[ke];if(ye!==void 0&&Ge!==void 0)if(W[we]){W[we]+=1;for(let Je=0;Je<ye.bonds.length;Je++)if(ye.bonds[Je]==ke){const tt=W[we];ye.bondOrder[Je]=tt>=4?1:tt}}else W[we]=1,ye.bonds.length!=0&&ye.bonds[ye.bonds.length-1]===ke||(ye.bonds.push(ke),ye.bondOrder.push(1))}}else if(Z==="HELIX "){te=j.substring(19,20),re=parseInt(j.substring(21,25)),de=parseInt(j.substring(33,37)),te in s||(s[te]={}),s[te][re]="h1";for(let le=re+1;le<de;le++)s[te][le]="h";s[te][de]="h2"}else if(M||Z!=="REMARK"||j.substring(13,18)!=="BIOMT"){if(Z==="CRYST1"){let le,ye,Pe,Te,ke,we;le=parseFloat(j.substring(7,15)),ye=parseFloat(j.substring(16,24)),Pe=parseFloat(j.substring(25,33)),Te=parseFloat(j.substring(34,40)),ke=parseFloat(j.substring(41,47)),we=parseFloat(j.substring(48,54)),P.cryst={a:le,b:ye,c:Pe,alpha:Te,beta:ke,gamma:we}}else if(Z==="ANISOU"){const le=l[U[parseInt(j.substring(6,11))]];if(le){const ye=j.substring(30).trim().split(/\s+/),Pe={u11:parseInt(ye[0]),u22:parseInt(ye[1]),u33:parseInt(ye[2]),u12:parseInt(ye[3]),u13:parseInt(ye[4]),u23:parseInt(ye[5])};le.uMat=Pe}}}else{let le,ye=new u.Matrix4;for(le=1;le<=3;le++)if(j=ae[G].replace(/^\s*/,""),parseInt(j.substring(18,19))==le)ye.elements[le-1]=parseFloat(j.substring(23,33)),ye.elements[le-1+4]=parseFloat(j.substring(33,43)),ye.elements[le-1+8]=parseFloat(j.substring(43,53)),ye.elements[le-1+12]=parseFloat(j.substring(53)),G++;else for(;j.substring(13,18)==="BIOMT";)G++,j=ae[G].replace(/^\s*/,"");ye.elements[3]=0,ye.elements[7]=0,ye.elements[11]=0,ye.elements[15]=1,P.symmetries.push(ye),G--}}if((function(G,Z){for(let te=0,re=G.length;te<re;te++){const de=G[te];for(let le=0;le<de.bonds.length;le++){const ye=G[de.bonds[le]],Pe=Z[de.serial];ye&&Pe&&ye.bonds.indexOf(Pe)<0&&(ye.bonds.push(Pe),ye.bondOrder.push(de.bondOrder[le]))}}})(l,U),h&&We(l,i),M||Re(P.symmetries,l,i,P.cryst),A&&!g&&K(l,i.hbondCutoff),!st(s))for(let G=0;G<l.length;G++){const Z=l[G];if(Z!==void 0&&Z.chain in s&&Z.resi in s[Z.chain]){const te=s[Z.chain][Z.resi];Z.ss=te[0],te.length>1&&(te[1]=="1"?Z.ssbegin=!0:te[1]=="2"&&(Z.ssend=!0))}}return[l,P,X]}function Ft(ae,i){i=i||{};var s=[],l={};s.modelData=[];for(var h=ae.split(/\r?\n|\r/);h.length>0;){var E=at(h,i,l),g=E[0],A=E[1];if(h=E[2],g.length!=0){if(i.multimodel&&i.onemol&&s.length>0)for(var M=s[0].length,S=0;S<g.length;S++){var P=g[S];P.index=S;for(var L=0;L<P.bonds.length;L++)P.bonds[L]+=M;s[0].push(P)}else s.modelData.push(A),s.push(g);if(!i.multimodel)break}}return s}function At(ae,i){var s=[[]],l=!i.noSecondaryStructure;s.modelData=[{symmetries:[]}];var h,E=[],g=ae.split(/\r?\n|\r/);for(let de=0;de<g.length;de++){var A=(h=g[de].replace(/^\s*/,"")).substring(0,6);if(A.indexOf("END")==0){if(i.multimodel){i.onemol||s.push([]);continue}break}if(A=="ATOM  "||A=="HETATM"){var M;let le=parseInt(h.substring(6,11)),ye=h.substring(12,16).replace(/ /g,""),Pe=h.substring(17,20).trim(),Te=h.substring(21,22),ke=parseInt(h.substring(22,26));var S=h.substring(30).trim().split(/\s+/),P=parseFloat(S[0]),L=parseFloat(S[1]),X=parseFloat(S[2]),U=parseFloat(S[3]),j=parseFloat(S[4]),W=ye[0];ye.length>1&&ye[1].toUpperCase()!=ye[1]&&(W=ye.substring(0,2)),M=h[0]=="H",E[le]=s[s.length-1].length,s[s.length-1].push({resn:Pe,x:P,y:L,z:X,elem:W,hetflag:M,chain:Te,resi:ke,serial:le,atom:ye,bonds:[],ss:"c",bondOrder:[],properties:{charge:U,partialCharge:U,radius:j},pdbline:h})}else if(A=="CONECT"){var G=parseInt(h.substring(6,11)),Z=s[s.length-1][E[G]];for(let le=0;le<4;le++){var te=parseInt(h.substring([11,16,21,26][le],[11,16,21,26][le]+5)),re=s[s.length-1][E[te]];Z!==void 0&&re!==void 0&&(Z.bonds.push(E[te]),Z.bondOrder.push(1))}}}for(let de=0;de<s.length;de++)We(s[de],i),l&&K(s[de],i.hbondCutoff);return s}var or=a(471),ar=function(ae){return String.fromCharCode.apply(null,ae).replace(/\0/g,"")},kr=function(ae){return ae==0||ae==2||ae==4?"h":ae==3?"s":"c"};let Er=new Set(["D-SACCHARIDE","D-SACCHARIDE 1,4 AND 1,4 LINKING","D-SACCHARIDE 1,4 AND 1,6 LINKING","L-SACCHARIDE","L-SACCHARIDE 1,4 AND 1,4 LINKING","L-SACCHARIDE 1,4 AND 1,6 LINKING","NON-POLYMER","OTHER","PEPTIDE-LIKE","SACCHARIDE"]);function pr(ae,i){var s=!i.keepH,l=i.altLoc?i.altLoc:"A",h=!!i.noSecondaryStructure,E=!i.noComputeSecondaryStructure,g=!i.doAssembly,A=i.assemblyIndex?i.assemblyIndex:0;ae=typeof ae=="string"?(0,x.base64ToArray)(ae):new Uint8Array(ae);var M,S,P,L,X,U,j=or.decode(ae),W=[[]],G=W.modelData=[],Z=0,te=0,re=0,de=j.secStructList,le=j.bFactorList,ye=j.altLocList,Pe=j.occupancyList,Te=j.bondAtomList,ke=j.bondOrderList,we=j.numModels;if(we==0)return W;i.multimodel||(we=1);var Ge=[];if(!g&&j.bioAssemblyList&&j.bioAssemblyList.length>0){var Je=j.bioAssemblyList[A].transformList;for(M=0,U=Je.length;M<U;M++){var tt=new u.Matrix4(Je[M].matrix);tt.transpose(),Ge.push(tt)}}var Ze=null;if(j.unitCell){var ut=j.unitCell;Ze={a:ut[0],b:ut[1],c:ut[2],alpha:ut[3],beta:ut[4],gamma:ut[5]}}let ft=[];j.entityList.forEach($=>{$.chainIndexList.forEach(y=>{ft[y]=$.type=="polymer"})});var Qe=0;for(X=0;X<we;X++){var pt=j.chainsPerModel[X],Be=W[W.length-1],et=[];for(G.push({symmetries:Ge,cryst:Ze}),M=0;M<pt;++M){var St=j.groupsPerChain[Z],ot=ar(j.chainIdList.subarray(4*Z,4*Z+4));j.chainNameList&&(ot=ar(j.chainNameList.subarray(4*Z,4*Z+4)));var wt=te,Et="";for(S=0;S<St;++S){var it=j.groupList[j.groupTypeList[te]],Rt=it.atomNameList.length,Ht=0,kt=!1,ct=!1;if(de){Ht=de[te];var Jt=kr(Ht);te!=0&&Jt==Et||(kt=!0),Et=Jt;var Nt=te+1;(Nt>=de.length||kr(de[Nt]!=Jt))&&(ct=!0)}var qt=j.groupIdList[te],Vt=it.groupName;let $=it.chemCompType;var Kt=re;let y=Er.has($)||!ft[Z];for(P=0;P<Rt;++P){var yr=it.elementList[P];if(s&&yr=="H")re+=1;else{var Fr="";le&&(Fr=le[re]);var Tr="";ye&&ye[re]&&(Tr=String.fromCharCode(ye[re]));var ii="";if(Pe&&(ii=Pe[re]),Tr==""||Tr==l||l=="*"){var Wr=j.atomIdList[re],br=it.atomNameList[P],Xr=0;it.atomChargeList&&(Xr=it.atomChargeList[P]);var ci=j.xCoordList[re],ni=j.yCoordList[re],hi=j.zCoordList[re];et[re]=Be.length,Be.push({resn:Vt,x:ci,y:ni,z:hi,elem:yr,hetflag:y,chain:ot,resi:qt,icode:Tr,rescode:qt+(Tr!=" "?"^"+Tr:""),serial:Wr,altLoc:Tr,index:re,atom:br,bonds:[],ss:kr(Ht),ssbegin:kt,ssend:ct,bondOrder:[],properties:{charge:Xr,occupancy:ii},b:Fr}),re+=1}else re+=1}}var zi=it.bondAtomList;for(P=0,L=it.bondOrderList.length;P<L;++P){var xi=Kt+zi[2*P],Ii=Kt+zi[2*P+1],Hr=it.bondOrderList[P],Kr=et[xi],qr=et[Ii],ei=Be[Kr],p=Be[qr];ei&&p&&(ei.bonds.push(qr),ei.bondOrder.push(Hr),p.bonds.push(Kr),p.bondOrder.push(Hr))}te+=1}for(te=wt,S=0;S<St;++S)te+=1;Z+=1}if(Te)for(let $=Qe,y=Te.length;$<y;$+=2){let be=Te[$],_e=Te[$+1],ve=ke?ke[$/2]:1;if(be>=re){Qe=$;break}let Ke=et[be],ze=et[_e],gt=Be[Ke],Ne=Be[ze];gt&&Ne&&(gt.bonds.push(ze),gt.bondOrder.push(ve),Ne.bonds.push(Ke),Ne.bondOrder.push(ve))}i.multimodel&&(i.onemol||W.push([]))}if(!g)for(let $=0;$<W.length;$++)Re(G[$].symmetries,W[$],i,G[$].cryst);return E&&!h&&K(W,i.hbondCutoff),W}function vr(ae){var i,s=[],l=0,h=ae.split(/\r?\n|\r/);if(!(h.length>0&&h[0].includes("VERSION")))return[];{var E=h.filter(function(j){return j.includes("POINTERS")||j.includes("ATOM_NAME")||j.includes("CHARGE")||j.includes("RADII")||j.includes("BONDS_INC_HYDROGEN")||j.includes("BONDS_WITHOUT_HYDROGEN")||j.includes("RESIDUE_LABEL")||j.includes("RESIDUE_POINTER")}),g=L("POINTERS");if(g==-1)return[];var A=X(g),M=parseInt(h[g+1].slice(0,A[1]));let U=parseInt(h[g+2].slice(A[1],A[0]+A[1]));if(isNaN(M)||M<=0)return[];if((g=L("ATOM_NAME"))==-1)return[];var S=(A=X(g))[0];for(let j=0;j<M/A[0];j++){j==parseInt(M/A[0])&&(S=M%A[0]);for(let W=0;W<S;W++){let G={},Z={charge:"",radii:""};G.serial=l,G.x=0,G.y=0,G.z=0,G.atom=h[g+1].slice(A[1]*W,A[1]*(W+1)).trim(),G.elem=h[g+1].slice(A[1]*W,A[1]*W+1).trim(),G.properties=Z,G.bonds=[],G.bondOrder=[],G.index=s.length,s.push(G),l++}g++}if((g=L("CHARGE"))!=-1){l=0,S=(A=X(g))[0];for(let j=0;j<M/A[0];j++){j==parseInt(M/A[0])&&(S=M%A[0]);for(let W=0;W<S;W++)s[l].properties.charge=parseFloat(h[g+1].slice(A[1]*W,A[1]*(W+1))),l++;g++}}var P=[];if((g=L("RESIDUE_POINTER"))!=-1){S=(A=X(g))[0],g+=1;for(let j=0;j<U/A[0];j++){j==parseInt(U/A[0])&&(S=U%A[0]);for(let W=0;W<S;W++)P.push(parseInt(h[g].slice(A[1]*W,A[1]*(W+1))));g++}if((g=L("RESIDUE_LABEL"))!=-1){let j=[];S=(A=X(g))[0],g+=1;for(let te=0;te<U/A[0];te++){te==parseInt(U/A[0])&&(S=U%A[0]);for(let re=0;re<S;re++)j.push(h[g].slice(A[1]*re,A[1]*(re+1)).trim());g++}let W=0,G=0,Z="";P.push(s.length+1);for(let te=0;te<s.length;te++)te+1>=P[W]&&(Z=j[W],W+=1,G+=1),s[te].resi=G,s[te].resn=Z}}if((g=L("RADII"))!=-1){l=0,S=(A=X(g))[0];for(let j=0;j<M/A[0];j++){j==parseInt(M/A[0])&&(S=M%A[0]);for(let W=0;W<S;W++)s[l].properties.radii=parseFloat(h[g+1].slice(A[1]*W,A[1]*(W+1))),l++;g++}}if((g=L("BONDS_WITHOUT_HYDROGEN"))!=-1)for(l=0,S=(A=X(g))[0],g+=1;!h[g].match(/^%FLAG/);){h[g+1].match(/^%FLAG/)&&(S=M%A[0]);for(let j=0;j<S;j++)l%3==0?i=parseInt(h[g].slice(A[1]*j,A[1]*(j+1))/3):l%3==1&&(s[i].bonds.push(parseInt(h[g].slice(A[1]*j,A[1]*(j+1))/3)),s[i].bondOrder.push(1)),l++;g++}if((g=L("BONDS_INC_HYDROGEN"))!=-1)for(l=0,S=(A=X(g))[0],g+=1;!h[g].match(/^%FLAG/);){h[g+1].match(/^%FLAG/)&&(S=M%A[0]);for(let j=0;j<S;j++)l%3==0?i=parseInt(h[g].slice(A[1]*j,A[1]*(j+1))/3):l%3==1&&(s[i].bonds.push(parseInt(h[g].slice(A[1]*j,A[1]*(j+1))/3)),s[i].bonds.push(1)),l++;g++}}function L(U){var j=h.indexOf(E.filter(function(W){return W.includes(U)})[0]);if(Number.isInteger(j)&&j>0){for(;!h[j].includes("FORMAT");)j++;return j}return-1}function X(U){var j=h[U].match(/\((\d*)\S*/),W=h[U].match(/[a-zA-Z](\d*)\)\s*/);return W==null&&(W=h[U].match(/[a-zA-Z](\d*)\.\d*\)\s*/)),[parseInt(j[1]),parseInt(W[1])]}return[s]}function xr(ae,i){const s=[],l=ae.split(/\r?\n|\r/);for(;l.length>0;){const h=parseInt(l[1]);if(l.length<3||isNaN(h)||h<=0||l.length<h+3)break;const E=[];s.push(E);let g=2;const A=E.length,M=A+h;for(let S=A;S<M;S++){const P=l[g++],L={};L.serial=S,L.atom=P.slice(10,15).trim(),L.elem=rt(L.atom,!0),L.x=10*parseFloat(P.slice(20,28)),L.y=10*parseFloat(P.slice(28,36)),L.z=10*parseFloat(P.slice(36,44)),L.resi=parseInt(P.slice(0,5)),L.resn=P.slice(5,10).trim(),L.bonds=[],L.bondOrder=[],L.properties={},P.length>44&&(L.dx=10*parseFloat(P.slice(44,52)),L.dy=10*parseFloat(P.slice(52,60)),L.dz=10*parseFloat(P.slice(60,68))),E[S]=L}if(l.length<=g+3){const S=l[g++].trim().split(/\s+/);if(S.length===3){for(let P=0;P<3;P++)S[P]=(10*parseFloat(S[P])).toString();s.box=S}}l.splice(0,++g)}for(let h=0;h<s.length;h++)We(s[h],i);return s}const fi={id:"serial",type:"atom",element:"elem",q:"charge",radius:"radius",x:"x",xu:"x",xs:"x",xsu:"x",y:"y",yu:"y",ys:"y",ysu:"y",z:"z",zu:"z",zs:"z",zsu:"z"};function Rr(ae,i){const s=[],l=ae.split(/\r?\n|\r/);let h=0,E=0,g=0;for(;g<l.length-9;){for(var A=g;A<l.length;A++)if(l[A].match(/ITEM: NUMBER OF ATOMS/)&&(E=parseInt(l[A+1])),l[A].match(/ITEM: ATOMS/)){h=A+1;break}const M=l[h-1].replace("ITEM: ATOMS ","").split(" ");s.push([]);for(let S=h;S<h+E;S++){const P={},L={},X=l[S].split(" ");for(let U=0;U<X.length;U++){const j=fi[M[U]];j!==void 0&&(j==="serial"?P[j]=parseInt(X[U]):j==="x"||j==="y"||j==="z"?P[j]=parseFloat(X[U]):j==="charge"||j==="radius"?L[j]=parseFloat(X[U]):P[j]=X[U]),P.properties=L,P.bonds=[],P.bondOrder=[]}s[s.length-1][S-h]=P}g=h+E-1}if(i.assignBonds)for(let M=0;M<s.length;M++)(0,ue.assignBonds)(s[M],i);return s}var Ir;(function(ae){(function(i){i[i.Int8=1]="Int8",i[i.Int16=2]="Int16",i[i.Int32=3]="Int32",i[i.Uint8=4]="Uint8",i[i.Uint16=5]="Uint16",i[i.Uint32=6]="Uint32"})(ae.IntDataType||(ae.IntDataType={})),(function(i){i[i.Float32=32]="Float32",i[i.Float64=33]="Float64"})(ae.FloatDataType||(ae.FloatDataType={})),ae.getDataType=function(i){let s;return s=i instanceof Int8Array?ae.IntDataType.Int8:i instanceof Int16Array?ae.IntDataType.Int16:i instanceof Int32Array?ae.IntDataType.Int32:i instanceof Uint8Array?ae.IntDataType.Uint8:i instanceof Uint16Array?ae.IntDataType.Uint16:i instanceof Uint32Array?ae.IntDataType.Uint32:i instanceof Float32Array?ae.FloatDataType.Float32:i instanceof Float64Array?ae.FloatDataType.Float64:ae.IntDataType.Int32,s},ae.isSignedIntegerDataType=function(i){if(i instanceof Int8Array||i instanceof Int16Array||i instanceof Int32Array)return!0;for(let s=0,l=i.length;s<l;s++)if(s<0)return!1;return!0}})(Ir||(Ir={}));const Di=new Uint16Array(new Uint8Array([18,52]).buffer)[0]===13330;function wi(ae){let i=ae.data;for(let s=ae.encoding.length-1;s>=0;s--)i=Hi(i,ae.encoding[s]);return i}function Hi(ae,i){switch(i.kind){case"ByteArray":switch(i.type){case Ir.IntDataType.Uint8:return ae;case Ir.IntDataType.Int8:return(function(s){return new Int8Array(s.buffer,s.byteOffset)})(ae);case Ir.IntDataType.Int16:return(function(s){return Le(s,2,Int16Array)})(ae);case Ir.IntDataType.Uint16:return(function(s){return Le(s,2,Uint16Array)})(ae);case Ir.IntDataType.Int32:return(function(s){return Le(s,4,Int32Array)})(ae);case Ir.IntDataType.Uint32:return(function(s){return Le(s,4,Uint32Array)})(ae);case Ir.FloatDataType.Float32:return(function(s){return Le(s,4,Float32Array)})(ae);case Ir.FloatDataType.Float64:return(function(s){return Le(s,8,Float64Array)})(ae);default:throw new Error("unreachable")}case"FixedPoint":return(function(s,l){const h=s.length,E=Se(l.srcType,h),g=1/l.factor;for(let A=0;A<h;A++)E[A]=g*s[A];return E})(ae,i);case"IntervalQuantization":return(function(s,l){const h=s.length,E=Se(l.srcType,h),g=(l.max-l.min)/(l.numSteps-1),A=l.min;for(let M=0;M<h;M++)E[M]=A+g*s[M];return E})(ae,i);case"RunLength":return(function(s,l){const h=pe(l.srcType,l.srcSize);let E=0;for(let g=0,A=s.length;g<A;g+=2){const M=s[g],S=s[g+1];for(let P=0;P<S;++P)h[E++]=M}return h})(ae,i);case"Delta":return(function(s,l){const h=s.length,E=pe(l.srcType,h);if(!h)return s;E[0]=s[0]+(0|l.origin);for(let g=1;g<h;++g)E[g]=s[g]+E[g-1];return E})(ae,i);case"IntegerPacking":return(function(s,l){return s.length===l.srcSize?s:l.isUnsigned?(function(h,E){const g=E.byteCount===1?255:65535,A=h.length,M=new Int32Array(E.srcSize);let S=0,P=0;for(;S<A;){let L=0,X=h[S];for(;X===g;)L+=X,S++,X=h[S];L+=X,M[P]=L,S++,P++}return M})(s,l):(function(h,E){const g=E.byteCount===1?127:32767,A=-g-1,M=h.length,S=new Int32Array(E.srcSize);let P=0,L=0;for(;P<M;){let X=0,U=h[P];for(;U===g||U===A;)X+=U,P++,U=h[P];X+=U,S[L]=X,P++,L++}return S})(s,l)})(ae,i);case"StringArray":return(function(s,l){const h=wi({encoding:l.offsetEncoding,data:l.offsets}),E=wi({encoding:l.dataEncoding,data:s}),g=l.stringData,A=new Array(h.length);A[0]="";for(let P=1,L=h.length;P<L;P++)A[P]=g.substring(h[P-1],h[P]);let M=0;const S=new Array(E.length);for(let P=0,L=E.length;P<L;P++)S[M++]=A[E[P]+1];return S})(ae,i)}}function pe(ae,i){switch(ae){case Ir.IntDataType.Int8:return new Int8Array(i);case Ir.IntDataType.Int16:return new Int16Array(i);case Ir.IntDataType.Int32:return new Int32Array(i);case Ir.IntDataType.Uint8:return new Uint8Array(i);case Ir.IntDataType.Uint16:return new Uint16Array(i);case Ir.IntDataType.Uint32:return new Uint32Array(i);default:return new Int32Array(i)}}function Se(ae,i){switch(ae){case Ir.FloatDataType.Float32:return new Float32Array(i);case Ir.FloatDataType.Float64:default:return new Float64Array(i)}}function Le(ae,i,s){return ae.byteOffset==0&&ae.byteLength==ae.buffer.byteLength||(ae=new Uint8Array(ae)),new s(Di?ae.buffer:(function(l,h){const E=new ArrayBuffer(l.length),g=new Uint8Array(E);for(let A=0,M=l.length;A<M;A+=h)for(let S=0;S<h;S++)g[A+h-S-1]=l[A+S];return E})(ae,i))}function dt(ae){const i=Object.create(null),s=Object.create(null);for(const l of ae.columns)i[l.name]=l;return{rowCount:ae.rowCount,name:ae.name.substring(1),fieldNames:ae.columns.map(l=>l.name),getField(l){const h=i[l];if(h)return s[l]||(s[l]=wi(h.data)),s[l]}}}var nt=a(471);class zt{constructor(i){if(this.C={},i){let s=i.getField("comp_id"),l=i.getField("atom_id_1"),h=i.getField("atom_id_2"),E=i.getField("value_order");for(let g=0;g<s.length;g++){let A=s[g],M=l[g],S=h[g],P=E[g],L=1;P=="doub"?L=2:P=="trip"&&(L=3),this.C[A]==null&&(this.C[A]={}),this.C[A][M]==null&&(this.C[A][M]={}),this.C[A][S]==null&&(this.C[A][S]={}),this.C[A][M][S]=L,this.C[A][S][M]=L}}}order(i,s,l){return this.C[i]!==void 0&&this.C[i][s]!==void 0&&this.C[i][s][l]!==void 0?this.C[i][s][l]:0}}class ht{constructor(i){if(this.C=[],i){let s=i.getField("conn_type_id"),l=i.getField("ptnr1_label_asym_id"),h=i.getField("ptnr1_label_seq_id"),E=i.getField("ptnr1_label_comp_id"),g=i.getField("ptnr1_label_atom_id"),A=i.getField("ptnr2_label_asym_id"),M=i.getField("ptnr2_label_seq_id"),S=i.getField("ptnr2_label_comp_id"),P=i.getField("ptnr2_label_atom_id"),L=i.getField("pdbx_value_order");for(let X=0;X<s.length;X++)if(s[X]=="disulf"||s[X]=="covale"){let U=L?L[X]==""?1:parseInt(L[X]):1;this.C.push([[l[X],h[X],E[X],g[X]],[A[X],M[X],S[X],P[X]],U])}}}}class Lt{constructor(){this.R={}}add(i){this.R[i.lchain]==null&&(this.R[i.lchain]={}),this.R[i.lchain][i.lresi]==null&&(this.R[i.lchain][i.lresi]={}),this.R[i.lchain][i.lresi][i.lresn]==null&&(this.R[i.lchain][i.lresi][i.lresn]=[]),this.R[i.lchain][i.lresi][i.lresn].push(i),this.R[i.lchain][i.lresi][i.lresn][i.atom]=i}geta([i,s,l,h]){if(this.R[i]!==void 0&&this.R[i][s]!==void 0&&this.R[i][s][l]!==void 0)return this.R[i][s][l][h]}setBonds(i,s){for(let l in this.R)for(let h in this.R[l])for(let E in this.R[l][h]){let g=this.R[l][h][E];for(let A=0;A<g.length;A++)for(let M=A+1;M<g.length;M++){let S=g[A],P=g[M],L=i.order(E,S.atom,P.atom);S.altLoc!=P.altLoc&&S.altLoc!=""&&P.altLoc!=""&&(L=0),L>0&&(S.bonds.push(P.index),P.bonds.push(S.index),S.bondOrder.push(L),P.bondOrder.push(L))}}for(let l of s.C){let h=l[0],E=l[1],g=l[2],A=this.geta(h),M=this.geta(E);A!=null&&M!=null&&(A.bonds.push(M.index),M.bonds.push(A.index),A.bondOrder.push(g),M.bondOrder.push(g))}}}function Ut(ae,i){var s=!i.keepH,l=i.altLoc?i.altLoc:"A",h=!i.noComputeSecondaryStructure;const E=!i.doAssembly,g=i.assignBonds===void 0||i.assignBonds;if(typeof ae=="string")try{ae=(0,x.base64ToArray)(ae)}catch{ae=new TextEncoder().encode(ae)}else ae=new Uint8Array(ae);var A=nt.decodeMsgpack(ae);A==31&&(ae=(0,x.inflateString)(ae,!1),A=nt.decodeMsgpack(ae));var M=[],S=M.modelData=[],P=A.dataBlocks.length;if(P==0)return M;i.multimodel||(P=1);for(let L=0;L<P;L++){let X=M.length;const U=[];S.push({symmetries:[]}),M.push([]);const j=A.dataBlocks[L],W=Object.create(null);for(const kt of j.categories)W[kt.name.substr(1)]=dt(kt);let G={},Z=W.struct_conf;if(Z){let kt=Z.getField("conf_type_id"),ct=Z.getField("beg_label_asym_id"),Jt=Z.getField("beg_label_seq_id"),Nt=Z.getField("end_label_seq_id");for(let qt=0;qt<kt.length;qt++)if(kt[qt].startsWith("H")){let Vt=ct[qt],Kt=Jt[qt],yr=Nt[qt];Vt in G||(G[Vt]={}),G[Vt][Kt]="h1";for(let Fr=Kt+1;Fr<yr;Fr++)G[Vt][Fr]="h";G[Vt][yr]="h2"}}let te=W.struct_sheet_range;if(te){let kt=te.getField("id"),ct=te.getField("beg_label_asym_id"),Jt=te.getField("beg_label_seq_id"),Nt=te.getField("end_label_seq_id");for(let qt=0;qt<kt.length;qt++){let Vt=ct[qt],Kt=Jt[qt],yr=Nt[qt];Vt in G||(G[Vt]={}),G[Vt][Kt]="s1";for(let Fr=Kt+1;Fr<yr;Fr++)G[Vt][Fr]="s";G[Vt][yr]="s2"}}let re=W.pdbx_struct_oper_list,de=re.getField("id");if(de&&!E){let kt=re.getField("matrix[1][1]"),ct=re.getField("matrix[1][2]"),Jt=re.getField("matrix[1][3]"),Nt=re.getField("matrix[2][1]"),qt=re.getField("matrix[2][2]"),Vt=re.getField("matrix[2][3]"),Kt=re.getField("matrix[3][1]"),yr=re.getField("matrix[3][2]"),Fr=re.getField("matrix[3][3]"),Tr=re.getField("vector[1]"),ii=re.getField("vector[2]"),Wr=re.getField("vector[3]");for(let br=0;br<de.length;br++){const Xr=new u.Matrix4(kt[br],ct[br],Jt[br],Tr[br],Nt[br],qt[br],Vt[br],ii[br],Kt[br],yr[br],Fr[br],Wr[br]);S[S.length-1].symmetries.push(Xr)}}let le=new zt(W.chem_comp_bond),ye=new Lt,Pe=new ht(W.struct_conn),Te=W.atom_site,ke=Te.rowCount,we=Te.getField("group_PDB"),Ge=Te.getField("Cartn_x"),Je=Te.getField("Cartn_y"),tt=Te.getField("Cartn_z"),Ze=Te.getField("auth_asym_id"),ut=Te.getField("label_asym_id"),ft=Te.getField("auth_seq_id"),Qe=Te.getField("label_seq_id"),pt=Te.getField("auth_comp_id"),Be=Te.getField("label_comp_id"),et=Te.getField("auth_atom_id"),St=Te.getField("label_atom_id"),ot=Te.getField("type_symbol"),wt=Te.getField("B_iso_or_equiv"),Et=Te.getField("id"),it=Te.getField("label_alt_id"),Rt=Te.getField("pdbx_PDB_model_num"),Ht=Rt?Rt[0]:0;for(let kt=0;kt<ke;kt++){if(we!==void 0&&we[kt]==="TER")continue;if(Rt&&Rt[kt]!=Ht){if(Ht=Rt[kt],!i.multimodel)break;i.onemol||(M.push([]),S.push(S[S.length-1]),Ht=Rt[kt],ye.setBonds(le,Pe),ye=new Lt)}const ct={};ct.x=Ge[kt],ct.y=Je[kt],ct.z=tt[kt],ct.chain=Ze?Ze[kt]:ut?ut[kt]:void 0,ct.lchain=ut?ut[kt]:void 0,ct.resi=ft?ft[kt]:Qe?Qe[kt]:void 0,ct.lresi=Qe?Qe[kt]:void 0,ct.resn=pt?pt[kt].trim():Be?Be[kt].trim():void 0,ct.lresn=Be?Be[kt].trim():void 0,ct.atom=et?et[kt].replace(/"/gm,""):St?St[kt].replace(/"/gm,""):void 0,ct.icode=it?it[kt]:void 0,ct.altLoc=ct.icode,ct.hetflag=!we||we[kt]==="HETA"||we[kt]==="HETATM";let Jt="X";ot&&(Jt=ot[kt].replace(/\(?\+?\d+.*/,"")),ct.elem=Jt[0].toUpperCase()+Jt.substring(1,2).toLowerCase(),wt&&(ct.b=wt[kt]),s&&ct.elem=="H"||ct.altLoc!=""&&ct.altLoc!=l&&l!="*"||(ct.bonds=[],ct.ss="c",ct.serial=Et[kt],ct.model=Ht,ct.bondOrder=[],ct.properties={},ct.index=M[M.length-1].length,U[ct.serial]=[M.length,ct.index],M[M.length-1].push(ct),ye.add(ct))}if(ye.setBonds(le,Pe),!st(G))for(let kt=X;kt<M.length;kt++){let ct=M[kt];for(let Jt=0;Jt<ct.length;Jt++){const Nt=ct[Jt];if(Nt!==void 0&&Nt.lchain in G&&Nt.lresi in G[Nt.lchain]){const qt=G[Nt.lchain][Nt.lresi];Nt.ss=qt[0],qt.length>1&&(qt[1]=="1"?Nt.ssbegin=!0:qt[1]=="2"&&(Nt.ssend=!0))}}}i.multimodel&&L<P-1&&(i.onemol||(M.push([]),S.push({symmetries:[]})))}for(let L=0;L<M.length;L++)!g||i.duplicateAssemblyAtoms&&!i.dontConnectDuplicatedAtoms||We(M[L],i),h&&K(M[L],i.hbondCutoff),Re(S[L].symmetries,M[L],i,S[L].cryst),i.duplicateAssemblyAtoms&&!i.dontConnectDuplicatedAtoms&&g&&We(M[L],i);return M}const It={vasp:me.VASP,VASP:me.VASP,cube:Me.CUBE,CUBE:Me.CUBE,xyz:I,XYZ:I,sdf:he,SDF:he,json:se,cdjson:se,CDJSON:se,mcif:Ee,cif:Ee,CIF:Ee,mol2:Ue,MOL2:Ue,pdb:Ft,PDB:Ft,pdbqt:Ft,PDBQT:Ft,pqr:At,PQR:At,mmtf:pr,MMTF:pr,prmtop:vr,PRMTOP:vr,gro:xr,GRO:xr,lammpstrj:Rr,LAMMPSTRJ:Rr,bcif:Ut,BCIF:Ut};function mr(ae,i="utf8"){return new TextDecoder(i).decode(ae)}const li=new TextEncoder,Ai=(()=>{const ae=new Uint8Array(4);return!((new Uint32Array(ae.buffer)[0]=1)&ae[0])})(),ui={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class gi{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(i=8192,s={}){let l=!1;typeof i=="number"?i=new ArrayBuffer(i):(l=!0,this.lastWrittenByte=i.byteLength);const h=s.offset?s.offset>>>0:0,E=i.byteLength-h;let g=h;(ArrayBuffer.isView(i)||i instanceof gi)&&(i.byteLength!==i.buffer.byteLength&&(g=i.byteOffset+h),i=i.buffer),this.lastWrittenByte=l?E:0,this.buffer=i,this.length=E,this.byteLength=E,this.byteOffset=g,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,g,E),this._mark=0,this._marks=[]}available(i=1){return this.offset+i<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(i=1){return this.offset+=i,this}back(i=1){return this.offset-=i,this}seek(i){return this.offset=i,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const i=this._marks.pop();if(i===void 0)throw new Error("Mark stack empty");return this.seek(i),this}rewind(){return this.offset=0,this}ensureAvailable(i=1){if(!this.available(i)){const s=2*(this.offset+i),l=new Uint8Array(s);l.set(new Uint8Array(this.buffer)),this.buffer=l.buffer,this.length=s,this.byteLength=s,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(i=1){return this.readArray(i,"uint8")}readArray(i,s){const l=ui[s].BYTES_PER_ELEMENT*i,h=this.byteOffset+this.offset,E=this.buffer.slice(h,h+l);if(this.littleEndian===Ai&&s!=="uint8"&&s!=="int8"){const A=new Uint8Array(this.buffer.slice(h,h+l));A.reverse();const M=new ui[s](A.buffer);return this.offset+=l,M.reverse(),M}const g=new ui[s](E);return this.offset+=l,g}readInt16(){const i=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,i}readUint16(){const i=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,i}readInt32(){const i=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,i}readUint32(){const i=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,i}readFloat32(){const i=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,i}readFloat64(){const i=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,i}readBigInt64(){const i=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,i}readBigUint64(){const i=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,i}readChar(){return String.fromCharCode(this.readInt8())}readChars(i=1){let s="";for(let l=0;l<i;l++)s+=this.readChar();return s}readUtf8(i=1){return mr(this.readBytes(i))}decodeText(i=1,s="utf8"){return mr(this.readBytes(i),s)}writeBoolean(i){return this.writeUint8(i?255:0),this}writeInt8(i){return this.ensureAvailable(1),this._data.setInt8(this.offset++,i),this._updateLastWrittenByte(),this}writeUint8(i){return this.ensureAvailable(1),this._data.setUint8(this.offset++,i),this._updateLastWrittenByte(),this}writeByte(i){return this.writeUint8(i)}writeBytes(i){this.ensureAvailable(i.length);for(let s=0;s<i.length;s++)this._data.setUint8(this.offset++,i[s]);return this._updateLastWrittenByte(),this}writeInt16(i){return this.ensureAvailable(2),this._data.setInt16(this.offset,i,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(i){return this.ensureAvailable(2),this._data.setUint16(this.offset,i,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(i){return this.ensureAvailable(4),this._data.setInt32(this.offset,i,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(i){return this.ensureAvailable(4),this._data.setUint32(this.offset,i,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(i){return this.ensureAvailable(4),this._data.setFloat32(this.offset,i,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(i){return this.ensureAvailable(8),this._data.setFloat64(this.offset,i,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(i){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,i,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(i){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,i,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(i){return this.writeUint8(i.charCodeAt(0))}writeChars(i){for(let s=0;s<i.length;s++)this.writeUint8(i.charCodeAt(s));return this}writeUtf8(i){return this.writeBytes((function(s){return li.encode(s)})(i))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}const jr=1,Lr=2,Dr=3,rr=4,vi=5,bi=6;function $i(ae){switch(Number(ae)){case jr:return"byte";case Lr:return"char";case Dr:return"short";case rr:return"int";case vi:return"float";case bi:return"double";default:return"undefined"}}function Ci(ae){switch(Number(ae)){case jr:case Lr:return 1;case Dr:return 2;case rr:case vi:return 4;case bi:return 8;default:return-1}}function Ni(ae){switch(String(ae)){case"byte":return jr;case"char":return Lr;case"short":return Dr;case"int":return rr;case"float":return vi;case"double":return bi;default:return-1}}function Ti(ae,i){if(ae!==1){const s=new Array(ae);for(let l=0;l<ae;l++)s[l]=i();return s}return i()}function pi(ae,i,s){switch(i){case jr:return Array.from(ae.readBytes(s));case Lr:return(l=ae.readChars(s)).charCodeAt(l.length-1)===0?l.substring(0,l.length-1):l;case Dr:return Ti(s,ae.readInt16.bind(ae));case rr:return Ti(s,ae.readInt32.bind(ae));case vi:return Ti(s,ae.readFloat32.bind(ae));case bi:return Ti(s,ae.readFloat64.bind(ae));default:throw new Error(`non valid type ${i}`)}var l}function Br(ae,i){if(ae)throw new TypeError(`Not a valid NetCDF v3.x file: ${i}`)}function Zr(ae){ae.offset%4!=0&&ae.skip(4-ae.offset%4)}function Vi(ae){const i=ae.readUint32(),s=ae.readChars(i);return Zr(ae),s}function yi(ae,i){const s={version:i},l={length:ae.readUint32()},h=(function(g){const A={};let M,S;const P=g.readUint32();let L;if(P===0)return Br(g.readUint32()!==0,"wrong empty tag for list of dimensions"),[];{Br(P!==10,"wrong tag for list of dimensions");const X=g.readUint32();L=new Array(X);for(let U=0;U<X;U++){const j=Vi(g),W=g.readUint32();W===0&&(M=U,S=j),L[U]={name:j,size:W}}}return M!==void 0&&(A.recordId=M),S!==void 0&&(A.recordName=S),A.dimensions=L,A})(ae);Array.isArray(h)||(l.id=h.recordId,l.name=h.recordName,s.dimensions=h.dimensions),s.globalAttributes=Wi(ae);const E=(function(g,A,M){const S=g.readUint32();let P,L=0;if(S===0)return Br(g.readUint32()!==0,"wrong empty tag for list of variables"),[];{Br(S!==11,"wrong tag for list of variables");const X=g.readUint32();P=new Array(X);for(let U=0;U<X;U++){const j=Vi(g),W=g.readUint32(),G=new Array(W);for(let ye=0;ye<W;ye++)G[ye]=g.readUint32();const Z=Wi(g),te=g.readUint32();Br(te<1&&te>6,`non valid type ${te}`);const re=g.readUint32();let de=g.readUint32();M===2&&(Br(de>0,"offsets larger than 4GB not supported"),de=g.readUint32());let le=!1;A!==void 0&&G[0]===A&&(L+=re,le=!0),P[U]={name:j,dimensions:G,attributes:Z,type:$i(te),size:re,offset:de,record:le}}}return{variables:P,recordStep:L}})(ae,l?.id,i);return Array.isArray(E)||(s.variables=E.variables,l.recordStep=E.recordStep),s.recordDimension=l,s}function Wi(ae){const i=ae.readUint32();let s;if(i===0)return Br(ae.readUint32()!==0,"wrong empty tag for list of attributes"),[];{Br(i!==12,"wrong tag for list of attributes");const l=ae.readUint32();s=new Array(l);for(let h=0;h<l;h++){const E=Vi(ae),g=ae.readUint32();Br(g<1||g>6,`non valid type ${g}`);const A=ae.readUint32(),M=pi(ae,g,A);Zr(ae),s[h]={name:E,type:$i(g),value:M}}}return s}function tn(){const ae=[];ae.push("DIMENSIONS");for(const s of this.dimensions)ae.push(`  ${s.name.padEnd(30)} = size: ${s.size}`);ae.push(""),ae.push("GLOBAL ATTRIBUTES");for(const s of this.globalAttributes)ae.push(`  ${s.name.padEnd(30)} = ${s.value}`);const i=JSON.parse(JSON.stringify(this.variables));ae.push(""),ae.push("VARIABLES:");for(const s of i){s.value=this.getDataVariable(s);let l=JSON.stringify(s.value);l.length>50&&(l=l.substring(0,50)),isNaN(s.value.length)||(l+=` (length: ${s.value.length})`),ae.push(`  ${s.name.padEnd(30)} = ${l}`)}return ae.join(`
`)}class on{constructor(i){this.toString=tn;const s=new gi(i);s.setBigEndian(),Br(s.readChars(3)!=="CDF","should start with CDF");const l=s.readByte();Br(l>2,"unknown version"),this.header=yi(s,l),this.buffer=s}get version(){return this.header.version===1?"classic format":"64-bit offset format"}get recordDimension(){return this.header.recordDimension}get dimensions(){return this.header.dimensions}get globalAttributes(){return this.header.globalAttributes}getAttribute(i){const s=this.globalAttributes.find(l=>l.name===i);return s?s.value:null}getDataVariableAsString(i){const s=this.getDataVariable(i);return s?s.join(""):null}get variables(){return this.header.variables}getDataVariable(i){let s;if(s=typeof i=="string"?this.header.variables.find(l=>l.name===i):i,s===void 0)throw new Error("Not a valid NetCDF v3.x file: variable not found");return this.buffer.seek(s.offset),s.record?(function(l,h,E){const g=Ni(h.type),A=h.size?h.size/Ci(g):1,M=E.length,S=new Array(M),P=E.recordStep;if(!P)throw new Error("recordDimension.recordStep is undefined");for(let L=0;L<M;L++){const X=l.offset;S[L]=pi(l,g,A),l.seek(X+P)}return S})(this.buffer,s,this.header.recordDimension):(function(l,h){const E=Ni(h.type),g=h.size/Ci(E),A=new Array(g);for(let M=0;M<g;M++)A[M]=pi(l,E,1);return A})(this.buffer,s)}dataVariableExists(i){return this.header.variables.find(s=>s.name===i)!==void 0}attributeExists(i){return this.globalAttributes.find(s=>s.name===i)!==void 0}}class ur{static sameObj(i,s){return i&&s?JSON.stringify(i)==JSON.stringify(s):i==s}constructor(i,s,l){this.atoms=[],this.frames=[],this.box=null,this.atomdfs=null,this.id=0,this.hidden=!1,this.molObj=null,this.renderedMolObj=null,this.lastColors=null,this.modelData={},this.modelDatas=null,this.idMatrix=new m.Matrix4,this.dontDuplicateAtoms=!0,this.defaultColor=b.elementColors.defaultColor,this.defaultStickRadius=.25,this.options=s||{},this.viewer=l,this.ElementColors=this.options.defaultcolors?this.options.defaultcolors:b.elementColors.defaultColors,this.defaultSphereRadius=this.options.defaultSphereRadius?this.options.defaultSphereRadius:1.5,this.defaultCartoonQuality=this.options.cartoonQuality?this.options.cartoonQuality:10,this.id=i}getRadiusFromStyle(i,s){var l=this.defaultSphereRadius;if(s.radius!==void 0)l=s.radius;else if(ur.vdwRadii[i.elem])l=ur.vdwRadii[i.elem];else if(i.elem.length>1){let h=i.elem;h=h[0].toUpperCase()+h[1].toLowerCase(),ur.vdwRadii[h]&&(l=ur.vdwRadii[h])}return s.scale!==void 0&&(l*=s.scale),l}drawAtomCross(i,s){if(i.style.cross){var l=i.style.cross;if(!l.hidden){var h=l.linewidth||ur.defaultlineWidth;s[h]||(s[h]=new u.Geometry);var E=s[h].updateGeoGroup(6),g=this.getRadiusFromStyle(i,l),A=[[g,0,0],[-g,0,0],[0,g,0],[0,-g,0],[0,0,g],[0,0,-g]],M=i.clickable||i.hoverable;M&&i.intersectionShape===void 0&&(i.intersectionShape={sphere:[],cylinder:[],line:[]});for(var S=(0,x.getColorFromStyle)(i,l),P=E.vertexArray,L=E.colorArray,X=0;X<6;X++){var U=3*E.vertices;if(E.vertices++,P[U]=i.x+A[X][0],P[U+1]=i.y+A[X][1],P[U+2]=i.z+A[X][2],L[U]=S.r,L[U+1]=S.g,L[U+2]=S.b,M){var j=new m.Vector3(A[X][0],A[X][1],A[X][2]);j.multiplyScalar(.1),j.set(j.x+i.x,j.y+i.y,j.z+i.z),i.intersectionShape.line.push(j)}}}}}getGoodCross(i,s,l,h){for(var E=null,g=-1,A=0,M=i.bonds.length;A<M;A++)if(i.bonds[A]!=s.index){let P=i.bonds[A],L=this.atoms[P],X=new m.Vector3(L.x,L.y,L.z).clone();X.sub(l);let U=X.clone();U.cross(h);var S=U.lengthSq();if(S>g&&(E=U,(g=S)>.1))return E}return E}getSideBondV(i,s,l){var h,E,g,A,M=new m.Vector3(i.x,i.y,i.z),S=new m.Vector3(s.x,s.y,s.z).clone(),P=null;if(S.sub(M),i.bonds.length===1)s.bonds.length===1?(P=S.clone(),Math.abs(P.x)>1e-4?P.y+=1:P.x+=1):(h=(l+1)%s.bonds.length,E=s.bonds[h],(g=this.atoms[E]).index==i.index&&(h=(h+1)%s.bonds.length,E=s.bonds[h],g=this.atoms[E]),(A=new m.Vector3(g.x,g.y,g.z).clone()).sub(M),(P=A.clone()).cross(S));else if((P=this.getGoodCross(i,s,M,S)).lengthSq()<.01){var L=this.getGoodCross(s,i,M,S);L!=null&&(P=L)}return P.lengthSq()<.01&&(P=S.clone(),Math.abs(P.x)>1e-4?P.y+=1:P.x+=1),P.cross(S),P.normalize(),P}addLine(i,s,l,h,E,g){i[l]=h.x,i[l+1]=h.y,i[l+2]=h.z,s[l]=g.r,s[l+1]=g.g,s[l+2]=g.b,i[l+3]=E.x,i[l+4]=E.y,i[l+5]=E.z,s[l+3]=g.r,s[l+4]=g.g,s[l+5]=g.b}drawBondLines(i,s,l){if(i.style.line){var h=i.style.line;if(!h.hidden){var E,g,A,M,S=h.linewidth||ur.defaultlineWidth;l[S]||(l[S]=new u.Geometry);for(var P=l[S].updateGeoGroup(6*i.bonds.length),L=P.vertexArray,X=P.colorArray,U=0;U<i.bonds.length;U++){var j=s[i.bonds[U]];if(j.style.line&&!(i.index>=j.index)){var W=new m.Vector3(i.x,i.y,i.z),G=new m.Vector3(j.x,j.y,j.z),Z=W.clone().add(G).multiplyScalar(.5),te=!1,re=i.clickable||i.hoverable,de=j.clickable||j.hoverable;(re||de)&&(re&&(i.intersectionShape===void 0&&(i.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),i.intersectionShape.line.push(W),i.intersectionShape.line.push(Z)),de&&(j.intersectionShape===void 0&&(j.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),j.intersectionShape.line.push(Z),j.intersectionShape.line.push(G)));var le=(0,x.getColorFromStyle)(i,i.style.line),ye=(0,x.getColorFromStyle)(j,j.style.line);if(i.bondStyles&&i.bondStyles[U]){var Pe=i.bondStyles[U];if(!Pe.iswire)continue;Pe.singleBond&&(te=!0),Pe.color1!==void 0&&(le=b.CC.color(Pe.color1)),Pe.color2!==void 0&&(ye=b.CC.color(Pe.color2))}var Te,ke,we=3*P.vertices;if(i.bondOrder[U]>1&&i.bondOrder[U]<4&&!te){var Ge=this.getSideBondV(i,j,U),Je=G.clone();Je.sub(W),i.bondOrder[U]==2?(Ge.multiplyScalar(.1),(E=W.clone()).add(Ge),(g=W.clone()).sub(Ge),(A=E.clone()).add(Je),(M=g.clone()).add(Je),le==ye?(P.vertices+=4,this.addLine(L,X,we,E,A,le),this.addLine(L,X,we+6,g,M,le)):(P.vertices+=8,Je.multiplyScalar(.5),(Te=E.clone()).add(Je),(ke=g.clone()).add(Je),this.addLine(L,X,we,E,Te,le),this.addLine(L,X,we+6,Te,A,ye),this.addLine(L,X,we+12,g,ke,le),this.addLine(L,X,we+18,ke,M,ye))):i.bondOrder[U]==3&&(Ge.multiplyScalar(.1),(E=W.clone()).add(Ge),(g=W.clone()).sub(Ge),(A=E.clone()).add(Je),(M=g.clone()).add(Je),le==ye?(P.vertices+=6,this.addLine(L,X,we,W,G,le),this.addLine(L,X,we+6,E,A,le),this.addLine(L,X,we+12,g,M,le)):(P.vertices+=12,Je.multiplyScalar(.5),(Te=E.clone()).add(Je),(ke=g.clone()).add(Je),this.addLine(L,X,we,W,Z,le),this.addLine(L,X,we+6,Z,G,ye),this.addLine(L,X,we+12,E,Te,le),this.addLine(L,X,we+18,Te,A,ye),this.addLine(L,X,we+24,g,ke,le),this.addLine(L,X,we+30,ke,M,ye)))}else le==ye?(P.vertices+=2,this.addLine(L,X,we,W,G,le)):(P.vertices+=4,this.addLine(L,X,we,W,Z,le),this.addLine(L,X,we+6,Z,G,ye))}}}}}drawAtomSphere(i,s){if(i.style.sphere){var l=i.style.sphere;if(!l.hidden){var h=(0,x.getColorFromStyle)(i,l),E=this.getRadiusFromStyle(i,l);if((i.clickable===!0||i.hoverable)&&i.intersectionShape!==void 0){var g=new m.Vector3(i.x,i.y,i.z);i.intersectionShape.sphere.push(new v.Sphere(g,E))}d.drawSphere(s,i,E,h)}}}drawAtomClickSphere(i){if(i.style.clicksphere){var s=i.style.clicksphere;if(!s.hidden){var l=this.getRadiusFromStyle(i,s);if((i.clickable===!0||i.hoverable)&&i.intersectionShape!==void 0){var h=new m.Vector3(i.x,i.y,i.z);i.intersectionShape.sphere.push(new v.Sphere(h,l))}}}}drawAtomInstanced(i,s){if(i.style.sphere){var l=i.style.sphere;if(!l.hidden){var h=this.getRadiusFromStyle(i,l),E=(0,x.getColorFromStyle)(i,l),g=s.updateGeoGroup(1),A=g.vertices,M=3*A,S=g.vertexArray,P=g.colorArray,L=g.radiusArray;if(S[M]=i.x,S[M+1]=i.y,S[M+2]=i.z,P[M]=E.r,P[M+1]=E.g,P[M+2]=E.b,L[A]=h,(i.clickable===!0||i.hoverable)&&i.intersectionShape!==void 0){var X=new m.Vector3(i.x,i.y,i.z);i.intersectionShape.sphere.push(new v.Sphere(X,h))}g.vertices+=1}}}drawSphereImposter(i,s,l,h){var E,g=i.updateGeoGroup(4),A=g.vertices,M=3*A,S=g.vertexArray,P=g.colorArray;for(E=0;E<4;E++)S[M+3*E]=s.x,S[M+3*E+1]=s.y,S[M+3*E+2]=s.z;var L=g.normalArray;for(E=0;E<4;E++)P[M+3*E]=h.r,P[M+3*E+1]=h.g,P[M+3*E+2]=h.b;L[M+0]=-l,L[M+1]=l,L[M+2]=0,L[M+3]=-l,L[M+4]=-l,L[M+5]=0,L[M+6]=l,L[M+7]=-l,L[M+8]=0,L[M+9]=l,L[M+10]=l,L[M+11]=0,g.vertices+=4;var X=g.faceArray,U=g.faceidx;X[U+0]=A,X[U+1]=A+1,X[U+2]=A+2,X[U+3]=A+2,X[U+4]=A+3,X[U+5]=A,g.faceidx+=6}drawAtomImposter(i,s){if(i.style.sphere){var l=i.style.sphere;if(!l.hidden){var h=this.getRadiusFromStyle(i,l),E=(0,x.getColorFromStyle)(i,l);if((i.clickable===!0||i.hoverable)&&i.intersectionShape!==void 0){var g=new m.Vector3(i.x,i.y,i.z);i.intersectionShape.sphere.push(new v.Sphere(g,h))}this.drawSphereImposter(s,i,h,E)}}}calculateDashes(i,s,l,h,E){var g=Math.sqrt(Math.pow(i.x-s.x,2)+Math.pow(i.y-s.y,2)+Math.pow(i.z-s.z,2));l=Math.max(l,0),E=Math.max(E,0)+2*l,(h=Math.max(h,.001))+E>g&&(h=g,E=0);var A,M=Math.floor((g-h)/(h+E))+1;E=(g-M*h)/M;for(var S=new m.Vector3(i.x,i.y,i.z),P=new m.Vector3((s.x-i.x)/(g/E),(s.y-i.y)/(g/E),(s.z-i.z)/(g/E)),L=new m.Vector3((s.x-i.x)/(g/h),(s.y-i.y)/(g/h),(s.z-i.z)/(g/h)),X=[],U=0;U<M;U++)A=new m.Vector3(S.x+L.x,S.y+L.y,S.z+L.z),X.push({from:S,to:A}),S=new m.Vector3(A.x+P.x,A.y+P.y,A.z+P.z);return X}static drawStickImposter(i,s,l,h,E,g=0,A=0){for(var M=i.updateGeoGroup(4),S=M.vertices,P=3*S,L=M.vertexArray,X=M.colorArray,U=M.radiusArray,j=M.normalArray,W=E.r,G=E.g,Z=E.b,te=function(Pe){var Te=-Pe;return Te==0&&(Te=-1e-4),Te},re=P,de=0;de<4;de++)L[re]=s.x,j[re]=l.x,X[re]=W,L[++re]=s.y,j[re]=l.y,X[re]=G,L[++re]=s.z,j[re]=l.z,X[re]=de<2?Z:te(Z),re++;M.vertices+=4,U[S]=-h,U[S+1]=h,U[S+2]=-h,U[S+3]=h;var le=M.faceArray,ye=M.faceidx;le[ye+0]=S,le[ye+1]=S+1,le[ye+2]=S+2,le[ye+3]=S+2,le[ye+4]=S+3,le[ye+5]=S,M.faceidx+=6}drawBondSticks(i,s,l){var h,E;if(i.style.stick){var g=i.style.stick;if(!g.hidden){var A,M,S,P,L,X,U,j,W,G,Z,te,re,de,le=g.radius||this.defaultStickRadius,ye=g.doubleBondScaling||.4,Pe=g.tripleBondScaling||.25,Te=((h=g.dashedBondConfig)===null||h===void 0?void 0:h.dashLength)||.1,ke=((E=g.dashedBondConfig)===null||E===void 0?void 0:E.gapLength)||.25,we=le,Ge=g.singleBonds||!1,Je=g.dashedBonds||!1,tt=0,Ze=0,ut=(0,x.getColorFromStyle)(i,g);!i.capDrawn&&i.bonds.length<4&&(tt=2);var ft=Wr=>{var br=l.imposter?ur.drawStickImposter:d.drawCylinder;return!Je&&Wr>=1?br:(Xr,ci,ni,hi,zi,xi=0,Ii=0,Hr=.1,Kr=.25)=>{this.calculateDashes(ci,ni,hi,Hr,Kr).forEach(qr=>{br(Xr,qr.from,qr.to,hi,zi,xi,Ii)})}};for(S=0;S<i.bonds.length;S++){var Qe=ft(i.bondOrder[S]),pt=s[i.bonds[S]];if(te=re=de=null,i.index<pt.index){var Be=pt.style;if(!Be.stick||Be.stick.hidden)continue;var et=(0,x.getColorFromStyle)(pt,Be.stick);if(we=le,P=Ge,i.bondStyles&&i.bondStyles[S]){if((L=i.bondStyles[S]).iswire)continue;L.radius&&(we=L.radius),L.singleBond&&(P=!0),L.color1!==void 0&&(ut=b.CC.color(L.color1)),L.color2!==void 0&&(et=b.CC.color(L.color2))}var St=new m.Vector3(i.x,i.y,i.z),ot=new m.Vector3(pt.x,pt.y,pt.z);if(i.bondOrder[S]<=1||P||i.bondOrder[S]>3){if(i.bondOrder[S]<1&&(we*=i.bondOrder[S]),!pt.capDrawn&&pt.bonds.length<4&&(Ze=2),ut!=et?(te=new m.Vector3().addVectors(St,ot).multiplyScalar(.5),Qe(l,St,te,we,ut,tt,0,Te,ke),Qe(l,te,ot,we,et,0,Ze,Te,ke)):Qe(l,St,ot,we,ut,tt,Ze,Te,ke),A=i.clickable||i.hoverable,M=pt.clickable||pt.hoverable,A||M){if(te||(te=new m.Vector3().addVectors(St,ot).multiplyScalar(.5)),A){var wt=new v.Cylinder(St,te,we),Et=new v.Sphere(St,we);i.intersectionShape.cylinder.push(wt),i.intersectionShape.sphere.push(Et)}if(M){var it=new v.Cylinder(ot,te,we),Rt=new v.Sphere(ot,we);pt.intersectionShape.cylinder.push(it),pt.intersectionShape.sphere.push(Rt)}}}else if(i.bondOrder[S]>1){var Ht=0,kt=0;we!=le&&(Ht=2,kt=2);var ct,Jt,Nt,qt,Vt,Kt=ot.clone(),yr=null;Kt.sub(St),yr=this.getSideBondV(i,pt,S),i.bondOrder[S]==2?(ct=we*ye,yr.multiplyScalar(1.5*ct),(Jt=St.clone()).add(yr),(Nt=St.clone()).sub(yr),(qt=Jt.clone()).add(Kt),(Vt=Nt.clone()).add(Kt),ut!=et?(te=new m.Vector3().addVectors(Jt,qt).multiplyScalar(.5),re=new m.Vector3().addVectors(Nt,Vt).multiplyScalar(.5),Qe(l,Jt,te,ct,ut,Ht,0),Qe(l,te,qt,ct,et,0,kt),Qe(l,Nt,re,ct,ut,Ht,0),Qe(l,re,Vt,ct,et,0,kt)):(Qe(l,Jt,qt,ct,ut,Ht,kt),Qe(l,Nt,Vt,ct,ut,Ht,kt)),A=i.clickable||i.hoverable,M=pt.clickable||pt.hoverable,(A||M)&&(te||(te=new m.Vector3().addVectors(Jt,qt).multiplyScalar(.5)),re||(re=new m.Vector3().addVectors(Nt,Vt).multiplyScalar(.5)),A&&(X=new v.Cylinder(Jt,te,ct),U=new v.Cylinder(Nt,re,ct),i.intersectionShape.cylinder.push(X),i.intersectionShape.cylinder.push(U)),M&&(W=new v.Cylinder(qt,te,ct),G=new v.Cylinder(Vt,re,ct),pt.intersectionShape.cylinder.push(W),pt.intersectionShape.cylinder.push(G)))):i.bondOrder[S]==3&&(ct=we*Pe,yr.cross(Kt),yr.normalize(),yr.multiplyScalar(3*ct),(Jt=St.clone()).add(yr),(Nt=St.clone()).sub(yr),(qt=Jt.clone()).add(Kt),(Vt=Nt.clone()).add(Kt),ut!=et?(te=new m.Vector3().addVectors(Jt,qt).multiplyScalar(.5),re=new m.Vector3().addVectors(Nt,Vt).multiplyScalar(.5),de=new m.Vector3().addVectors(St,ot).multiplyScalar(.5),Qe(l,Jt,te,ct,ut,Ht,0),Qe(l,te,qt,ct,et,0,kt),Qe(l,St,de,ct,ut,tt,0),Qe(l,de,ot,ct,et,0,Ze),Qe(l,Nt,re,ct,ut,Ht,0),Qe(l,re,Vt,ct,et,0,kt)):(Qe(l,Jt,qt,ct,ut,Ht,kt),Qe(l,St,ot,ct,ut,tt,Ze),Qe(l,Nt,Vt,ct,ut,Ht,kt)),A=i.clickable||i.hoverable,M=pt.clickable||pt.hoverable,(A||M)&&(te||(te=new m.Vector3().addVectors(Jt,qt).multiplyScalar(.5)),re||(re=new m.Vector3().addVectors(Nt,Vt).multiplyScalar(.5)),de||(de=new m.Vector3().addVectors(St,ot).multiplyScalar(.5)),A&&(X=new v.Cylinder(Jt.clone(),te.clone(),ct),U=new v.Cylinder(Nt.clone(),re.clone(),ct),j=new v.Cylinder(St.clone(),de.clone(),ct),i.intersectionShape.cylinder.push(X),i.intersectionShape.cylinder.push(U),i.intersectionShape.cylinder.push(j)),M&&(W=new v.Cylinder(qt.clone(),te.clone(),ct),G=new v.Cylinder(Vt.clone(),re.clone(),ct),Z=new v.Cylinder(ot.clone(),de.clone(),ct),pt.intersectionShape.cylinder.push(W),pt.intersectionShape.cylinder.push(G),pt.intersectionShape.cylinder.push(Z))))}}}var Fr=!1,Tr=0,ii=!1;for(S=0;S<i.bonds.length;S++)P=Ge,i.bondStyles&&i.bondStyles[S]&&((L=i.bondStyles[S]).singleBond&&(P=!0),L.radius&&L.radius!=le&&(ii=!0)),(P||i.bondOrder[S]==1)&&Tr++;ii?Tr>0&&(Fr=!0):Tr==0&&(i.bonds.length>0||g.showNonBonded)&&(Fr=!0),Fr&&(we=le,l.imposter?this.drawSphereImposter(l.sphereGeometry,i,we,ut):d.drawSphere(l,i,we,ut))}}}createMolObj(i,s){s=s||{};var l,h,E,g,A=new u.Object3D,M=[],S={},P={},L=this.drawAtomSphere,X=null,U=null;s.supportsImposters?(L=this.drawAtomImposter,(X=new u.Geometry(!0)).imposter=!0,(U=new u.Geometry(!0,!0)).imposter=!0,U.sphereGeometry=new u.Geometry(!0),U.sphereGeometry.imposter=!0,U.drawnCaps={}):s.supportsAIA?(L=this.drawAtomInstanced,(X=new u.Geometry(!1,!0,!0)).instanced=!0,U=new u.Geometry(!0)):(X=new u.Geometry(!0),U=new u.Geometry(!0));var j,W={},G=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];for(l=0,E=i.length;l<E;l++){var Z=i[l];if(Z&&Z.style){for(h in(Z.clickable||Z.hoverable)&&Z.intersectionShape===void 0&&(Z.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),g={line:void 0,cross:void 0,stick:void 0,sphere:void 0})Z.style[h]?Z.style[h].opacity?g[h]=parseFloat(Z.style[h].opacity):g[h]=1:g[h]=void 0,W[h]?g[h]!=null&&W[h]!=g[h]&&(console.log("Warning: "+h+" opacity is ambiguous"),W[h]=1):W[h]=g[h];L.call(this,Z,X),this.drawAtomClickSphere(Z),this.drawAtomCross(Z,P),this.drawBondLines(Z,i,S),this.drawBondSticks(Z,i,U),Z.style.cartoon===void 0||Z.style.cartoon.hidden||(Z.style.cartoon.color!=="spectrum"||typeof Z.resi!="number"||Z.hetflag||(Z.resi<G[0]&&(G[0]=Z.resi),Z.resi>G[1]&&(G[1]=Z.resi)),M.push(Z))}}if(M.length>0&&ge(A,M,G,this.defaultCartoonQuality),X&&X.vertices>0){X.initTypedArrays();var te=null,re=null;X.imposter?te=new u.SphereImposterMaterial({ambient:0,vertexColors:!0,reflectivity:0}):X.instanced?(re=new u.Geometry(!0),d.drawSphere(re,{x:0,y:0,z:0},1,new b.Color(.5,.5,.5)),re.initTypedArrays(),te=new u.InstancedMaterial({sphereMaterial:new u.MeshLambertMaterial({ambient:0,vertexColors:!0,reflectivity:0}),sphere:re})):te=new u.MeshLambertMaterial({ambient:0,vertexColors:!0,reflectivity:0}),W.sphere<1&&W.sphere>=0&&(te.transparent=!0,te.opacity=W.sphere),re=new u.Mesh(X,te),A.add(re)}if(U.vertices>0){var de=null,le=null,ye=U.sphereGeometry;ye&&ye.vertices!==void 0&&ye.vertices!=0||(ye=null),U.initTypedArrays(),ye&&ye.initTypedArrays();var Pe={ambient:0,vertexColors:!0,reflectivity:0};U.imposter?(de=new u.StickImposterMaterial(Pe),le=new u.SphereImposterMaterial(Pe)):(de=new u.MeshLambertMaterial(Pe),le=new u.MeshLambertMaterial(Pe),de.wireframe&&(U.setUpWireframe(),ye&&ye.setUpWireframe())),W.stick<1&&W.stick>=0&&(de.transparent=!0,de.opacity=W.stick,le.transparent=!0,le.opacity=W.stick);var Te=new u.Mesh(U,de);if(A.add(Te),ye){var ke=new u.Mesh(ye,le);A.add(ke)}}for(l in S)if(S.hasOwnProperty(l)){j=l;var we=new u.LineBasicMaterial({linewidth:j,vertexColors:!0});W.line<1&&W.line>=0&&(we.transparent=!0,we.opacity=W.line),S[l].initTypedArrays();var Ge=new u.Line(S[l],we,u.LineStyle.LinePieces);A.add(Ge)}for(l in P)if(P.hasOwnProperty(l)){j=l;var Je=new u.LineBasicMaterial({linewidth:j,vertexColors:!0});W.cross<1&&W.cross>=0&&(Je.transparent=!0,Je.opacity=W.cross),P[l].initTypedArrays();var tt=new u.Line(P[l],Je,u.LineStyle.LinePieces);A.add(tt)}if(this.dontDuplicateAtoms&&this.modelData.symmetries&&this.modelData.symmetries.length>0){var Ze,ut=new u.Object3D;for(Ze=0;Ze<this.modelData.symmetries.length;Ze++){var ft=new u.Object3D;(ft=A.clone()).matrix.copy(this.modelData.symmetries[Ze]),ft.matrixAutoUpdate=!1,ut.add(ft)}return ut}return A}getViewer(){return this.viewer}getInternalState(){return{atoms:this.atoms,frames:this.frames}}setInternalState(i){this.atoms=i.atoms,this.frames=i.frames,this.molObj=null}getCrystData(){if(this.modelData.cryst){if(!this.modelData.cryst.matrix){const i=this.modelData.cryst;this.modelData.cryst.matrix=(0,m.conversionMatrix3)(i.a,i.b,i.c,i.alpha,i.beta,i.gamma)}return this.modelData.cryst}return null}setCrystData(i,s,l,h,E,g){i=i||1,s=s||1,l=l||1,h=h||90,E=E||90,g=g||90;const A=(0,m.conversionMatrix3)(i,s,l,h,E,g);this.modelData.cryst={a:i,b:s,c:l,alpha:h,beta:E,gamma:g,matrix:A}}setCrystMatrix(i){i=i||new m.Matrix3(1,0,0,0,1,0,0,0,1),this.modelData.cryst={matrix:i}}getSymmetries(){return this.modelData.symmetries===void 0&&(this.modelData.symmetries=[this.idMatrix]),this.modelData.symmetries}setSymmetries(i){i===void 0?this.modelData.symmetries=[this.idMatrix]:(this.modelData.symmetries=i,this.molObj=null)}getID(){return this.id}getNumFrames(){return this.frames.numFrames!=null?this.frames.numFrames:this.frames.length}adjustCoord(i,s,l,h){var E=s-i;return E<-l?s+h:E>l?s-h:s}adjustCoordinatesToBox(){if(this.box&&this.atomdfs)for(var i=this.box[0],s=this.box[1],l=this.box[2],h=.9*i,E=.9*s,g=.9*l,A=0;A<this.atomdfs.length;A++)for(var M=this.atomdfs[A],S=1;S<M.length;S++){var P=this.atoms[M[S][0]],L=this.atoms[M[S][1]];P.x=this.adjustCoord(L.x,P.x,h,i),P.y=this.adjustCoord(L.y,P.y,E,s),P.z=this.adjustCoord(L.z,P.z,g,l)}}setFrame(i){var s=this.getNumFrames();let l=this,h=this.viewer;return new Promise(function(E,g){if(s==0&&E(),(i<0||i>=s)&&(i=s-1),l.frames.url!=null){var A=l.frames.url;(0,x.getbin)(A+"/traj/frame/"+i+"/"+l.frames.path,void 0,"POST",void 0).then(function(M){for(var S=new Float32Array(M,44),P=0,L=0;L<l.atoms.length;L++)l.atoms[L].x=S[P++],l.atoms[L].y=S[P++],l.atoms[L].z=S[P++];l.box&&l.atomdfs&&l.adjustCoordinatesToBox(),E()}).catch(g)}else l.atoms=l.frames[i],E();l.molObj=null,l.modelDatas&&i<l.modelDatas.length&&(l.modelData=l.modelDatas[i],l.unitCellObjects&&h&&(h.removeUnitCell(l),h.addUnitCell(l)))})}addFrame(i){this.frames.push(i)}vibrate(i=10,s=1,l=!1,h){var E=0,g=i;let A=this.viewer;l&&(E=-i,g=i),this.frames!==void 0&&this.frames.origIndex!==void 0?this.setFrame(this.frames.origIndex):this.setFrame(0),E<g&&(this.frames=[]),l&&(this.frames.origIndex=i);for(var M=E;M<g;M++){var S=[],P=this.frames.length;if(M!=0||h){for(var L=0;L<this.atoms.length;L++){var X=(0,x.getAtomProperty)(this.atoms[L],"dx"),U=(0,x.getAtomProperty)(this.atoms[L],"dy"),j=(0,x.getAtomProperty)(this.atoms[L],"dz"),W=new m.Vector3(X,U,j),G=new m.Vector3(this.atoms[L].x,this.atoms[L].y,this.atoms[L].z),Z=M*s/i;W.multiplyScalar(Z),G.add(W);var te={};for(var re in this.atoms[L])te[re]=this.atoms[L][re];if(te.x=G.x,te.y=G.y,te.z=G.z,S.push(te),A&&h){var de=(0,x.extend)({},h),le=new m.Vector3(X,U,j);if(le.multiplyScalar(s),le.add(G),de.start=G,de.end=le,de.frame=P,!de.color){var ye=te.style.sphere;ye||(ye=te.style.stick),ye||(ye=te.style.line),de.color=(0,x.getColorFromStyle)(te,ye)}A.addArrow(de)}}this.frames.push(S)}else this.frames.push(this.atoms)}}setAtomDefaults(i){for(let s=0;s<i.length;s++){let l=i[s];l&&(l.style=l.style||(0,x.deepCopy)(ur.defaultAtomStyle),l.color=l.color||this.ElementColors[l.elem]||this.defaultColor,l.model=this.id,(l.clickable||l.hoverable)&&(l.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}))}}addMolData(i,s,l={}){var h=ur.parseMolData(i,s,l);this.dontDuplicateAtoms=!l.duplicateAssemblyAtoms;var E=h.modelData;if(E&&(Array.isArray(E)?(this.modelData=E[0],l.frames&&(this.modelDatas=E)):this.modelData=E),h.box?this.box=h.box:this.box=null,this.frames.length==0){for(let A=0;A<h.length;A++)h[A].length!=0&&this.frames.push(h[A]);this.frames[0]&&(this.atoms=this.frames[0])}else if(l.frames)for(let A=0;A<h.length;A++)this.frames.push(h[A]);else for(var g=0;g<h.length;g++)this.addAtoms(h[g]);for(let A=0;A<this.frames.length;A++)this.setAtomDefaults(this.frames[A]);l.vibrate&&l.vibrate.frames&&l.vibrate.amplitude&&this.vibrate(l.vibrate.frames,l.vibrate.amplitude),l.style&&this.setStyle({},l.style)}setDontDuplicateAtoms(i){this.dontDuplicateAtoms=i}setModelData(i){this.modelData=i}propertyMatches(i,s){if(i==s)return!0;if(typeof s=="string"&&typeof i=="number"){var l=s.match(/(-?\d+)\s*-\s*(-?\d+)/);if(l){var h=parseInt(l[1]),E=parseInt(l[2]);if(l&&i>=h&&i<=E)return!0}}return!1}static deepCopyAndCache(i,s){if(typeof i!="object"||i==null||i instanceof ur||i.__cache_created)return i;const l={};for(const h in i){const E=i[h];if(Array.isArray(E)){l[h]=[];for(let g=0;g<E.length;g++)l[h].push(ur.deepCopyAndCache(E[g],s))}else l[h]=typeof E=="object"&&h!="properties"&&h!="model"?ur.deepCopyAndCache(E,s):E;if(h=="and"||h=="or"){const g=[];for(const A of l[h]){const M=new Set;for(const S of s.selectedAtoms(A))M.add(S.index);g.push(M)}if(h=="and"){const A=function(S,P){const L=new Set;for(const X of P)S.has(X)&&L.add(X);return L};let M=new Set(g[0]);for(const S of g.splice(1))M=A(M,S);l[h].__cached_results=M}else if(h=="or"){const A=new Set;for(const M of g)for(const S of M)A.add(S);l[h].__cached_results=A}}}return l.__cache_created=!0,l}atomIsSelected(i,s){if(s===void 0)return!0;var l=!!s.invert,h=!0;for(var E in s)if(E=="and"||E=="or"||E=="not"){if(E=="not"){if(this.atomIsSelected(i,s[E])){h=!1;break}}else if(s[E].__cached_results===void 0&&(s=ur.deepCopyAndCache(s,this)),!(h=s[E].__cached_results.has(i.index)))break}else if(E==="predicate"){if(!s.predicate(i)){h=!1;break}}else if(E=="properties"&&i[E]){for(var g in s.properties)if(!g.startsWith("__cache")){if(i.properties[g]===void 0){h=!1;break}if(i.properties[g]!=s.properties[g]){h=!1;break}}}else if(E=="model"){let S=s.model;if(typeof S=="number"&&S<0&&(S=this.viewer.getNextModelId()+S),Array.isArray(S)){let P=!1;for(let L=0;L<S.length;L++)if(S[L]==this||S[L]==this.id){P=!0;break}if(!P){h=!1;break}}else if(S!=this&&S!=this.id){h=!1;break}}else if(s.hasOwnProperty(E)&&!ur.ignoredKeys.has(E)&&!E.startsWith("__cache")){if(i[E]===void 0){h=!1;break}let S=!1;if(E==="bonds"){if(s[E]!=i.bonds.length){h=!1;break}}else if(Array.isArray(s[E])){var A=s[E],M=i[E];for(let P=0;P<A.length;P++)if(this.propertyMatches(M,A[P])){S=!0;break}if(!S){h=!1;break}}else{let P=s[E];if(!this.propertyMatches(i[E],P)){h=!1;break}}}return l?!h:h}static squaredDistance(i,s){var l=s.x-i.x,h=s.y-i.y,E=s.z-i.z;return l*l+h*h+E*E}expandAtomList(i,s){if(s<=0)return i;for(var l=(0,x.getExtent)(i,void 0),h=[[],[],[]],E=0;E<3;E++)h[0][E]=l[0][E]-s,h[1][E]=l[1][E]+s,h[2][E]=l[2][E];var g=[];for(let P=0;P<this.atoms.length;P++){var A=this.atoms[P].x,M=this.atoms[P].y,S=this.atoms[P].z;A>=h[0][0]&&A<=h[1][0]&&M>=h[0][1]&&M<=h[1][1]&&S>=h[0][2]&&S<=h[1][2]&&(A>=l[0][0]&&A<=l[1][0]&&M>=l[0][1]&&M<=l[1][1]&&S>=l[0][2]&&S<=l[1][2]||g.push(this.atoms[P]))}return g}static getFloat(i){return typeof i=="number"?i:parseFloat(i)}selectedAtoms(i,s){var l=[];i=ur.deepCopyAndCache(i||{},this),s||(s=this.atoms);for(var h=s.length,E=0;E<h;E++){var g=s[E];g&&this.atomIsSelected(g,i)&&l.push(g)}if(i.hasOwnProperty("expand")){const te=ur.getFloat(i.expand);let re=this.expandAtomList(l,te),de=l.length;const le=te*te;for(let ye=0;ye<re.length;ye++)for(let Pe=0;Pe<de;Pe++){var A=ur.squaredDistance(re[ye],l[Pe]);A<le&&A>0&&l.push(re[ye])}}if(i.hasOwnProperty("within")&&i.within.hasOwnProperty("sel")&&i.within.hasOwnProperty("distance")){var M=this.selectedAtoms(i.within.sel,this.atoms),S={};const te=ur.getFloat(i.within.distance),re=te*te;for(let de=0;de<M.length;de++)for(let le=0;le<l.length;le++){let ye=ur.squaredDistance(M[de],l[le]);ye<re&&ye>0&&(S[le]=1)}var P=[];if(i.within.invert)for(let de=0;de<l.length;de++)S[de]||P.push(l[de]);else for(let de in S)P.push(l[de]);l=P}if(i.hasOwnProperty("byres")){var L={},X=[],U=[];for(let te=0;te<l.length;te++){let re=l[te];var j=re.chain,W=re.resi;if(L[j]===void 0&&(L[j]={}),re.hasOwnProperty("resi")&&L[j][W]===void 0){for(L[j][W]=!0,U.push(re);U.length>0;)if(re=U.pop(),j=re.chain,W=re.resi,X[re.index]===void 0){X[re.index]=!0;for(var G=0;G<re.bonds.length;G++){var Z=this.atoms[re.bonds[G]];X[Z.index]===void 0&&Z.hasOwnProperty("resi")&&Z.chain==j&&Z.resi==W&&(U.push(Z),l.push(Z))}}}}}return l}addAtoms(i){this.molObj=null;var s,l=this.atoms.length,h=[];for(s=0;s<i.length;s++)i[s].index===void 0&&(i[s].index=s),i[s].serial===void 0&&(i[s].serial=s),h[i[s].index]=l+s;for(s=0;s<i.length;s++){var E=i[s],g=h[E.index],A=(0,x.extend)({},E);A.index=g,A.bonds=[],A.bondOrder=[],A.model=this.id,A.style=A.style||(0,x.deepCopy)(ur.defaultAtomStyle),A.color===void 0&&(A.color=this.ElementColors[A.elem]||this.defaultColor);for(var M=E.bonds?E.bonds.length:0,S=0;S<M;S++){var P=h[E.bonds[S]];P!==void 0&&(A.bonds.push(P),A.bondOrder.push(E.bondOrder?E.bondOrder[S]:1))}this.atoms.push(A)}}assignBonds(){(0,ue.assignBonds)(this.atoms,{assignBonds:!0})}removeAtoms(i){this.molObj=null;var s,l=[];for(s=0;s<i.length;s++)l[i[s].index]=!0;var h=[];for(s=0;s<this.atoms.length;s++){var E=this.atoms[s];l[E.index]||h.push(E)}this.atoms=[],this.addAtoms(h)}setStyle(i,s,l){s===void 0&&l===void 0&&(s=i,i={}),typeof s=="string"&&(s=(0,x.specStringToObject)(s));var h=!1,E=this,g=function(M){var S=E.selectedAtoms(i,M);for(let P=0;P<M.length;P++)M[P]&&(M[P].capDrawn=!1);for(let P=0;P<S.length;P++){h=!0,(S[P].clickable||S[P].hoverable)&&(S[P].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),l||(S[P].style={});for(let L in s)s.hasOwnProperty(L)&&(S[P].style[L]=S[P].style[L]||{},Object.assign(S[P].style[L],s[L]))}};if(i.frame!==void 0&&i.frame<this.frames.length){let M=i.frame;M<0&&(M=this.frames.length+M),g(this.frames[M])}else{g(this.atoms);for(var A=0;A<this.frames.length;A++)this.frames[A]!==this.atoms&&g(this.frames[A])}h&&(this.molObj=null)}setClickable(i,s,l){if(s=!!s,(l=(0,x.makeFunction)(l))!==null){var h=this.selectedAtoms(i,this.atoms),E=h.length;for(let g=0;g<E;g++)h[g].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},h[g].clickable=s,l&&(h[g].callback=l);E>0&&(this.molObj=null)}else console.log("Callback is not a function")}setHoverable(i,s,l,h){if(s=!!s,l=(0,x.makeFunction)(l),h=(0,x.makeFunction)(h),l!==null)if(h!==null){var E=this.selectedAtoms(i,this.atoms),g=E.length;for(let A=0;A<g;A++)E[A].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},E[A].hoverable=s,l&&(E[A].hover_callback=l),h&&(E[A].unhover_callback=h);g>0&&(this.molObj=null)}else console.log("Unhover_callback is not a function");else console.log("Hover_callback is not a function")}enableContextMenu(i,s){var l;s=!!s;var h=this.selectedAtoms(i,this.atoms),E=h.length;for(l=0;l<E;l++)h[l].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},h[l].contextMenuEnabled=s;E>0&&(this.molObj=null)}setColorByElement(i,s){if(this.molObj===null||!ur.sameObj(s,this.lastColors)){this.lastColors=s;var l=this.selectedAtoms(i,l);l.length>0&&(this.molObj=null);for(var h=0;h<l.length;h++){var E=l[h];s[E.elem]!==void 0&&(E.color=s[E.elem])}}}setColorByProperty(i,s,l,h){var E,g,A=this.selectedAtoms(i,A);for(this.lastColors=null,A.length>0&&(this.molObj=null),typeof l=="string"&&T.Gradient.builtinGradients[l]!==void 0&&(l=new T.Gradient.builtinGradients[l]),h||(h=l.range()),h||(h=(0,x.getPropertyRange)(A,s)),E=0;E<A.length;E++)g=A[E],(0,x.getAtomProperty)(g,s)!=null&&(g.color=l.valueToHex(parseFloat(g.properties[s]),h))}setColorByFunction(i,s){var l=this.selectedAtoms(i,l);if(typeof s=="function"){this.lastColors=null,l.length>0&&(this.molObj=null);for(let h=0;h<l.length;h++){let E=l[h];E.color=s(E)}}}toCDObject(i=!1){var s={a:[],b:[]};i&&(s.s=[]);for(let h=0;h<this.atoms.length;h++){let E={},g=this.atoms[h];if(E.x=g.x,E.y=g.y,E.z=g.z,g.elem!="C"&&(E.l=g.elem),i){for(var l=0;l<s.s.length&&JSON.stringify(g.style)!==JSON.stringify(s.s[l]);)l++;l===s.s.length&&s.s.push(g.style),l!==0&&(E.s=l)}s.a.push(E);for(let A=0;A<g.bonds.length;A++){let M=h,S=g.bonds[A];if(M>=S)continue;let P={b:M,e:S},L=g.bondOrder[A];L!=1&&(P.o=L),s.b.push(P)}}return s}globj(i,s){(this.molObj===null||s.regen)&&(this.molObj=this.createMolObj(this.atoms,s),this.renderedMolObj&&(i.remove(this.renderedMolObj),this.renderedMolObj=null),this.renderedMolObj=this.molObj.clone(),this.hidden&&(this.renderedMolObj.setVisible(!1),this.molObj.setVisible(!1)),i.add(this.renderedMolObj))}exportVRML(){return this.createMolObj(this.atoms,{supportsImposters:!1,supportsAIA:!1}).vrml()}removegl(i){this.renderedMolObj&&(this.renderedMolObj.geometry!==void 0&&this.renderedMolObj.geometry.dispose(),this.renderedMolObj.material!==void 0&&this.renderedMolObj.material.dispose(),i.remove(this.renderedMolObj),this.renderedMolObj=null),this.molObj=null}hide(){this.hidden=!0,this.renderedMolObj&&this.renderedMolObj.setVisible(!1),this.molObj&&this.molObj.setVisible(!1)}show(){this.hidden=!1,this.renderedMolObj&&this.renderedMolObj.setVisible(!0),this.molObj&&this.molObj.setVisible(!0)}addPropertyLabels(i,s,l){let h=this.selectedAtoms(s),E=this.viewer,g=(0,x.deepCopy)(l);for(let M=0;M<h.length;M++){let S=h[M];var A=null;S[i]!==void 0?A=String(S[i]):S.properties[i]!==void 0&&(A=String(S.properties[i])),A!=null&&(g.position=S,E.addLabel(A,g))}}addResLabels(i,s,l=!1){let h=this.viewer;var E=[],g=function(M,S){for(var P=M.selectedAtoms(i,P),L={},X=0;X<P.length;X++){var U=P[X],j=U.chain,W=U.resn+""+U.resi;L[j]||(L[j]={}),L[j][W]||(L[j][W]=[]),L[j][W].push(U)}var G=(0,x.deepCopy)(s);for(let te in L)if(L.hasOwnProperty(te)){var Z=L[te];for(let re in Z)if(Z.hasOwnProperty(re)){let de=Z[re],le=new m.Vector3(0,0,0);for(let Pe=0;Pe<de.length;Pe++){let Te=de[Pe];le.x+=Te.x,le.y+=Te.y,le.z+=Te.z}le.divideScalar(de.length),G.position=le,G.frame=S;let ye=h.addLabel(re,G,void 0,!0);E.push(ye)}}};if(l){var A=this.getNumFrames();let M=this.atoms;for(let S=0;S<A;S++)this.frames[S]&&(this.atoms=this.frames[S],g(this,S));this.atoms=M}else g(this);return E}setupDFS(){this.atomdfs=[];var i=this,s=new Int8Array(this.atoms.length);s.fill(0);for(var l=function(g,A,M){M.push([g,A]);var S=i.atoms[g];s[g]=1;for(var P=0;P<S.bonds.length;P++){var L=S.bonds[P];i.atoms[L]&&!s[L]&&l(L,g,M)}},h=0;h<this.atoms.length;h++)if(this.atoms[h]&&!s[h]){var E=[];l(h,-1,E),this.atomdfs.push(E)}}setCoordinatesFromURL(i,s){this.frames=[];var l=this;return this.box&&this.setupDFS(),i.startsWith("http")||(i="http://"+i),(0,x.get)(i+"/traj/numframes/"+s,function(h){if(!isNaN(parseInt(h)))return l.frames.push(l.atoms),l.frames.numFrames=h,l.frames.url=i,l.frames.path=s,l.setFrame(0)})}setCoordinates(i,s){if(!i)return[];if(/\.gz$/.test(s=s||"")){s=s.replace(/\.gz$/,"");try{i=(0,x.inflateString)(i)}catch(P){console.log(P)}}if({mdcrd:"",inpcrd:"",pdb:"",netcdf:"",array:""}.hasOwnProperty(s)){this.frames=[];for(var l=this.atoms.length,h=ur.parseCrd(i,s),E=0;E<h.length;){for(var g=[],A=0;A<l;A++){var M={};for(var S in this.atoms[A])M[S]=this.atoms[A][S];g[A]=M,g[A].x=h[E++],g[A].y=h[E++],g[A].z=h[E++]}this.frames.push(g)}return this.atoms=this.frames[0],this.frames}return[]}addAtomSpecs(i){}static parseCrd(i,s){var l=[],h=0;if(s=="pdb")for(var E=i.indexOf(`
ATOM`);E!=-1;){for(;i.slice(E,E+5)==`
ATOM`||i.slice(E,E+7)==`
HETATM`;)l[h++]=parseFloat(i.slice(E+31,E+39)),l[h++]=parseFloat(i.slice(E+39,E+47)),l[h++]=parseFloat(i.slice(E+47,E+55)),E=i.indexOf(`
`,E+54),i.slice(E,E+4)==`
TER`&&(E=i.indexOf(`
`,E+5));E=i.indexOf(`
ATOM`,E)}else if(s=="netcdf"){var g=new on(i);l=[].concat.apply([],g.getDataVariable("coordinates"))}else{if(s=="array"||Array.isArray(i))return i.flat(2);{let A=i.indexOf(`
`);s=="inpcrd"&&(A=i.indexOf(`
`,A+1)),l=(i=i.slice(A+1)).match(/\S+/g).map(parseFloat)}}return l}static parseMolData(i,s="",l){if(!i)return[];if(/\.gz$/.test(s)){s=s.replace(/\.gz$/,"");try{i=s.match(/bcif/i)?(0,x.inflateString)(i,!1):(0,x.inflateString)(i)}catch(h){console.log(h)}}return It[s]===void 0&&(s=s.split(".").pop(),It[s]===void 0&&(console.log("Unknown format: "+s),s=i instanceof Uint8Array?"bcif":i.match(/^@<TRIPOS>MOLECULE/gm)?"mol2":i.match(/^data_/gm)&&i.match(/^loop_/gm)?"cif":i.match(/^HETATM/gm)||i.match(/^ATOM/gm)?"pdb":i.match(/ITEM: TIMESTEP/gm)?"lammpstrj":i.match(/^.*\n.*\n.\s*(\d+)\s+(\d+)/gm)?"sdf":i.match(/^%VERSION\s+VERSION_STAMP/gm)?"prmtop":"xyz",console.log("Best guess: "+s))),(0,It[s])(i,l)}}var Gr;ur.defaultAtomStyle={line:{}},ur.defaultlineWidth=1,ur.vdwRadii={H:1.2,He:1.4,Li:1.82,Be:1.53,B:1.92,C:1.7,N:1.55,O:1.52,F:1.47,Ne:1.54,Na:2.27,Mg:1.73,Al:1.84,Si:2.1,P:1.8,S:1.8,Cl:1.75,Ar:1.88,K:2.75,Ca:2.31,Ni:1.63,Cu:1.4,Zn:1.39,Ga:1.87,Ge:2.11,As:1.85,Se:1.9,Br:1.85,Kr:2.02,Rb:3.03,Sr:2.49,Pd:1.63,Ag:1.72,Cd:1.58,In:1.93,Sn:2.17,Sb:2.06,Te:2.06,I:1.98,Xe:2.16,Cs:3.43,Ba:2.68,Pt:1.75,Au:1.66,Hg:1.55,Tl:1.96,Pb:2.02,Bi:2.07,Po:1.97,At:2.02,Rn:2.2,Fr:3.48,Ra:2.83,U:1.86},ur.ignoredKeys=new Set(["props","invert","model","frame","byres","expand","within","and","or","not"]),(function(ae){ae[ae.VDW=1]="VDW",ae[ae.MS=2]="MS",ae[ae.SAS=3]="SAS",ae[ae.SES=4]="SES"})(Gr||(Gr={}));var $r=!1;function qi(ae){$r=ae}(window.navigator.userAgent.indexOf("MSIE ")>=0||window.navigator.userAgent.indexOf("Trident/")>=0)&&($r=!0);class Bt{constructor(){this.ISDONE=2,this.edgeTable=new Uint32Array([0,0,0,0,0,0,0,2816,0,0,0,1792,0,3328,3584,3840,0,0,0,138,0,21,0,134,0,0,0,652,0,2067,3865,3600,0,0,0,42,0,0,0,294,0,0,21,28,0,3875,1049,3360,0,168,162,170,0,645,2475,2210,0,687,293,172,4010,3747,3497,3232,0,0,0,0,0,69,0,900,0,0,0,1792,138,131,1608,1920,0,81,0,2074,84,85,84,86,0,81,0,3676,330,1105,1881,1616,0,0,0,42,0,69,0,502,0,0,21,3580,138,2035,1273,1520,2816,104,2337,106,840,581,367,102,2816,3695,3429,3180,1898,1635,1385,1120,0,0,0,0,0,0,0,3910,0,0,69,588,42,2083,41,2880,0,0,0,1722,0,2293,4095,3830,0,255,757,764,2538,2291,3065,2800,0,0,81,338,0,3925,1119,3414,84,855,85,340,2130,2899,89,2384,1792,712,194,1162,4036,3781,3535,3270,708,719,197,204,3018,2755,2505,2240,0,0,0,0,168,420,168,1958,162,162,676,2988,170,163,680,928,3328,3096,3328,3642,52,53,1855,1590,2340,2111,2869,2620,298,51,825,560,3584,3584,3090,3482,1668,1941,1183,1430,146,2975,2069,2460,154,915,153,400,3840,3592,3329,3082,1796,1541,1295,1030,2818,2575,2309,2060,778,515,265,0]),this.triTable=[[],[],[],[],[],[],[],[11,9,8],[],[],[],[8,10,9],[],[10,8,11],[9,11,10],[8,10,9,8,11,10],[],[],[],[1,7,3],[],[4,2,0],[],[2,1,7],[],[],[],[2,7,3,2,9,7],[],[1,4,11,1,0,4],[3,8,0,11,9,4,11,10,9],[4,11,9,11,10,9],[],[],[],[5,3,1],[],[],[],[2,5,8,2,1,5],[],[],[2,4,0],[3,2,4],[],[0,9,1,8,10,5,8,11,10],[3,4,0,3,10,4],[5,8,10,8,11,10],[],[3,5,7],[7,1,5],[1,7,3,1,5,7],[],[9,2,0,9,7,2],[0,3,8,1,7,11,1,5,7],[11,1,7,1,5,7],[],[9,1,0,5,3,2,5,7,3],[8,2,5,8,0,2],[2,5,3,5,7,3],[3,9,1,3,8,9,7,11,10,7,10,5],[9,1,0,10,7,11,10,5,7],[3,8,0,7,10,5,7,11,10],[11,5,7,11,10,5],[],[],[],[],[],[0,6,2],[],[7,2,9,7,9,8],[],[],[],[8,10,9],[7,1,3],[7,1,0],[6,9,3,6,10,9],[7,10,8,10,9,8],[],[6,0,4],[],[11,1,4,11,3,1],[2,4,6],[2,0,4,2,4,6],[2,4,6],[1,4,2,4,6,2],[],[6,0,4],[],[2,11,3,6,9,4,6,10,9],[8,6,1,8,1,3],[10,0,6,0,4,6],[8,0,3,9,6,10,9,4,6],[10,4,6,10,9,4],[],[],[],[5,3,1],[],[0,6,2],[],[7,4,8,5,2,1,5,6,2],[],[],[2,4,0],[7,4,8,2,11,3,10,5,6],[7,1,3],[5,6,10,0,9,1,8,7,4],[5,6,10,7,0,3,7,4,0],[10,5,6,4,8,7],[9,11,8],[3,5,6],[0,5,11,0,11,8],[6,3,5,3,1,5],[3,9,6,3,8,9],[9,6,0,6,2,0],[0,3,8,2,5,6,2,1,5],[1,6,2,1,5,6],[9,11,8],[1,0,9,6,10,5,11,3,2],[6,10,5,2,8,0,2,11,8],[3,2,11,10,5,6],[10,5,6,9,3,8,9,1,3],[0,9,1,5,6,10],[8,0,3,10,5,6],[10,5,6],[],[],[],[],[],[],[],[1,10,2,9,11,6,9,8,11],[],[],[6,0,2],[3,6,9,3,2,6],[3,5,1],[0,5,1,0,11,5],[0,3,5],[6,9,11,9,8,11],[],[],[],[4,5,9,7,1,10,7,3,1],[],[11,6,7,2,4,5,2,0,4],[11,6,7,8,0,3,1,10,2,9,4,5],[6,7,11,1,10,2,9,4,5],[],[4,1,0,4,5,1,6,7,3,6,3,2],[9,4,5,0,6,7,0,2,6],[4,5,9,6,3,2,6,7,3],[6,7,11,5,3,8,5,1,3],[6,7,11,4,1,0,4,5,1],[4,5,9,3,8,0,11,6,7],[9,4,5,7,11,6],[],[],[0,6,4],[8,6,4,8,1,6],[],[0,10,2,0,9,10,4,8,11,4,11,6],[10,2,1,6,0,3,6,4,0],[10,2,1,11,4,8,11,6,4],[4,2,6],[1,0,9,2,4,8,2,6,4],[2,4,0,2,6,4],[8,2,4,2,6,4],[11,4,1,11,6,4],[0,9,1,4,11,6,4,8,11],[3,6,0,6,4,0],[8,6,4,8,11,6],[10,8,9],[6,3,9,6,7,3],[6,7,1],[10,7,1,7,3,1],[7,11,6,8,10,2,8,9,10],[11,6,7,10,0,9,10,2,0],[2,1,10,7,11,6,8,0,3],[1,10,2,6,7,11],[7,2,6,7,9,2],[1,0,9,3,6,7,3,2,6],[7,0,6,0,2,6],[2,7,3,2,6,7],[7,11,6,3,9,1,3,8,9],[9,1,0,11,6,7],[0,3,8,11,6,7],[11,6,7],[],[],[],[],[5,3,7],[8,5,2,8,7,5],[5,3,7],[1,10,2,5,8,7,5,9,8],[1,7,5],[1,7,5],[9,2,7,9,7,5],[11,3,2,8,5,9,8,7,5],[1,3,7,1,7,5],[0,7,1,7,5,1],[9,3,5,3,7,5],[9,7,5,9,8,7],[8,10,11],[3,4,10,3,10,11],[8,10,11],[5,9,4,1,11,3,1,10,11],[2,4,5],[5,2,4,2,0,4],[0,3,8,5,9,4,10,2,1],[2,1,10,9,4,5],[2,8,5,2,11,8],[3,2,11,1,4,5,1,0,4],[9,4,5,8,2,11,8,0,2],[11,3,2,9,4,5],[8,5,3,5,1,3],[5,0,4,5,1,0],[3,8,0,4,5,9],[9,4,5],[11,9,10],[11,9,10],[1,11,4,1,10,11],[8,7,4,11,1,10,11,3,1],[2,7,9,2,9,10],[4,8,7,0,10,2,0,9,10],[2,1,10,0,7,4,0,3,7],[10,2,1,8,7,4],[1,7,4],[3,2,11,4,8,7,9,1,0],[11,4,2,4,0,2],[2,11,3,7,4,8],[4,1,7,1,3,7],[1,0,9,8,7,4],[3,4,0,3,7,4],[8,7,4],[8,9,10,8,10,11],[3,9,11,9,10,11],[0,10,8,10,11,8],[10,3,1,10,11,3],[2,8,10,8,9,10],[9,2,0,9,10,2],[8,0,3,1,10,2],[10,2,1],[1,11,9,11,8,9],[11,3,2,0,9,1],[11,0,2,11,8,0],[11,3,2],[8,1,3,8,9,1],[9,1,0],[8,0,3],[]],this.edgeTable2=[0,265,515,778,2060,2309,2575,2822,1030,1295,1541,1804,3082,3331,3593,3840,400,153,915,666,2460,2197,2975,2710,1430,1183,1941,1692,3482,3219,3993,3728,560,825,51,314,2620,2869,2111,2358,1590,1855,1077,1340,3642,3891,3129,3376,928,681,419,170,2988,2725,2479,2214,1958,1711,1445,1196,4010,3747,3497,3232,2240,2505,2755,3018,204,453,719,966,3270,3535,3781,4044,1226,1475,1737,1984,2384,2137,2899,2650,348,85,863,598,3414,3167,3925,3676,1370,1107,1881,1616,2800,3065,2291,2554,764,1013,255,502,3830,4095,3317,3580,1786,2035,1273,1520,2912,2665,2403,2154,876,613,367,102,3942,3695,3429,3180,1898,1635,1385,1120,1120,1385,1635,1898,3180,3429,3695,3942,102,367,613,876,2154,2403,2665,2912,1520,1273,2035,1786,3580,3317,4095,3830,502,255,1013,764,2554,2291,3065,2800,1616,1881,1107,1370,3676,3925,3167,3414,598,863,85,348,2650,2899,2137,2384,1984,1737,1475,1226,4044,3781,3535,3270,966,719,453,204,3018,2755,2505,2240,3232,3497,3747,4010,1196,1445,1711,1958,2214,2479,2725,2988,170,419,681,928,3376,3129,3891,3642,1340,1077,1855,1590,2358,2111,2869,2620,314,51,825,560,3728,3993,3219,3482,1692,1941,1183,1430,2710,2975,2197,2460,666,915,153,400,3840,3593,3331,3082,1804,1541,1295,1030,2822,2575,2309,2060,778,515,265,0],this.triTable2=[[],[8,3,0],[9,0,1],[8,3,1,8,1,9],[11,2,3],[11,2,0,11,0,8],[11,2,3,0,1,9],[2,1,11,1,9,11,11,9,8],[10,1,2],[8,3,0,1,2,10],[9,0,2,9,2,10],[3,2,8,2,10,8,8,10,9],[10,1,3,10,3,11],[1,0,10,0,8,10,10,8,11],[0,3,9,3,11,9,9,11,10],[8,10,9,8,11,10],[8,4,7],[3,0,4,3,4,7],[1,9,0,8,4,7],[9,4,1,4,7,1,1,7,3],[2,3,11,7,8,4],[7,11,4,11,2,4,4,2,0],[3,11,2,4,7,8,9,0,1],[2,7,11,2,1,7,1,4,7,1,9,4],[10,1,2,8,4,7],[2,10,1,0,4,7,0,7,3],[4,7,8,0,2,10,0,10,9],[2,7,3,2,9,7,7,9,4,2,10,9],[8,4,7,11,10,1,11,1,3],[11,4,7,1,4,11,1,11,10,1,0,4],[3,8,0,7,11,4,11,9,4,11,10,9],[7,11,4,4,11,9,11,10,9],[9,5,4],[3,0,8,4,9,5],[5,4,0,5,0,1],[4,8,5,8,3,5,5,3,1],[11,2,3,9,5,4],[9,5,4,8,11,2,8,2,0],[3,11,2,1,5,4,1,4,0],[8,5,4,2,5,8,2,8,11,2,1,5],[2,10,1,9,5,4],[0,8,3,5,4,9,10,1,2],[10,5,2,5,4,2,2,4,0],[3,4,8,3,2,4,2,5,4,2,10,5],[5,4,9,1,3,11,1,11,10],[0,9,1,4,8,5,8,10,5,8,11,10],[3,4,0,3,10,4,4,10,5,3,11,10],[4,8,5,5,8,10,8,11,10],[9,5,7,9,7,8],[0,9,3,9,5,3,3,5,7],[8,0,7,0,1,7,7,1,5],[1,7,3,1,5,7],[11,2,3,8,9,5,8,5,7],[9,2,0,9,7,2,2,7,11,9,5,7],[0,3,8,2,1,11,1,7,11,1,5,7],[2,1,11,11,1,7,1,5,7],[1,2,10,5,7,8,5,8,9],[9,1,0,10,5,2,5,3,2,5,7,3],[5,2,10,8,2,5,8,5,7,8,0,2],[10,5,2,2,5,3,5,7,3],[3,9,1,3,8,9,7,11,10,7,10,5],[9,1,0,10,7,11,10,5,7],[3,8,0,7,10,5,7,11,10],[11,5,7,11,10,5],[11,7,6],[0,8,3,11,7,6],[9,0,1,11,7,6],[7,6,11,3,1,9,3,9,8],[2,3,7,2,7,6],[8,7,0,7,6,0,0,6,2],[1,9,0,3,7,6,3,6,2],[7,6,2,7,2,9,2,1,9,7,9,8],[1,2,10,6,11,7],[2,10,1,7,6,11,8,3,0],[11,7,6,10,9,0,10,0,2],[7,6,11,3,2,8,8,2,10,8,10,9],[6,10,7,10,1,7,7,1,3],[6,10,1,6,1,7,7,1,0,7,0,8],[9,0,3,6,9,3,6,10,9,6,3,7],[6,10,7,7,10,8,10,9,8],[8,4,6,8,6,11],[11,3,6,3,0,6,6,0,4],[0,1,9,4,6,11,4,11,8],[1,9,4,11,1,4,11,3,1,11,4,6],[3,8,2,8,4,2,2,4,6],[2,0,4,2,4,6],[1,9,0,3,8,2,2,8,4,2,4,6],[9,4,1,1,4,2,4,6,2],[10,1,2,11,8,4,11,4,6],[10,1,2,11,3,6,6,3,0,6,0,4],[0,2,10,0,10,9,4,11,8,4,6,11],[2,11,3,6,9,4,6,10,9],[8,4,6,8,6,1,6,10,1,8,1,3],[1,0,10,10,0,6,0,4,6],[8,0,3,9,6,10,9,4,6],[10,4,6,10,9,4],[9,5,4,7,6,11],[4,9,5,3,0,8,11,7,6],[6,11,7,4,0,1,4,1,5],[6,11,7,4,8,5,5,8,3,5,3,1],[4,9,5,6,2,3,6,3,7],[9,5,4,8,7,0,0,7,6,0,6,2],[4,0,1,4,1,5,6,3,7,6,2,3],[7,4,8,5,2,1,5,6,2],[6,11,7,1,2,10,9,5,4],[11,7,6,8,3,0,1,2,10,9,5,4],[11,7,6,10,5,2,2,5,4,2,4,0],[7,4,8,2,11,3,10,5,6],[4,9,5,6,10,7,7,10,1,7,1,3],[5,6,10,0,9,1,8,7,4],[5,6,10,7,0,3,7,4,0],[10,5,6,4,8,7],[5,6,9,6,11,9,9,11,8],[0,9,5,0,5,3,3,5,6,3,6,11],[0,1,5,0,5,11,5,6,11,0,11,8],[11,3,6,6,3,5,3,1,5],[9,5,6,3,9,6,3,8,9,3,6,2],[5,6,9,9,6,0,6,2,0],[0,3,8,2,5,6,2,1,5],[1,6,2,1,5,6],[1,2,10,5,6,9,9,6,11,9,11,8],[1,0,9,6,10,5,11,3,2],[6,10,5,2,8,0,2,11,8],[3,2,11,10,5,6],[10,5,6,9,3,8,9,1,3],[0,9,1,5,6,10],[8,0,3,10,5,6],[10,5,6],[10,6,5],[8,3,0,10,6,5],[0,1,9,5,10,6],[10,6,5,9,8,3,9,3,1],[3,11,2,10,6,5],[6,5,10,2,0,8,2,8,11],[1,9,0,6,5,10,11,2,3],[1,10,2,5,9,6,9,11,6,9,8,11],[1,2,6,1,6,5],[0,8,3,2,6,5,2,5,1],[5,9,6,9,0,6,6,0,2],[9,6,5,3,6,9,3,9,8,3,2,6],[11,6,3,6,5,3,3,5,1],[0,5,1,0,11,5,5,11,6,0,8,11],[0,5,9,0,3,5,3,6,5,3,11,6],[5,9,6,6,9,11,9,8,11],[10,6,5,4,7,8],[5,10,6,7,3,0,7,0,4],[5,10,6,0,1,9,8,4,7],[4,5,9,6,7,10,7,1,10,7,3,1],[7,8,4,2,3,11,10,6,5],[11,6,7,10,2,5,2,4,5,2,0,4],[11,6,7,8,0,3,1,10,2,9,4,5],[6,7,11,1,10,2,9,4,5],[7,8,4,5,1,2,5,2,6],[4,1,0,4,5,1,6,7,3,6,3,2],[9,4,5,8,0,7,0,6,7,0,2,6],[4,5,9,6,3,2,6,7,3],[6,7,11,4,5,8,5,3,8,5,1,3],[6,7,11,4,1,0,4,5,1],[4,5,9,3,8,0,11,6,7],[9,4,5,7,11,6],[10,6,4,10,4,9],[8,3,0,9,10,6,9,6,4],[1,10,0,10,6,0,0,6,4],[8,6,4,8,1,6,6,1,10,8,3,1],[2,3,11,6,4,9,6,9,10],[0,10,2,0,9,10,4,8,11,4,11,6],[10,2,1,11,6,3,6,0,3,6,4,0],[10,2,1,11,4,8,11,6,4],[9,1,4,1,2,4,4,2,6],[1,0,9,3,2,8,2,4,8,2,6,4],[2,4,0,2,6,4],[3,2,8,8,2,4,2,6,4],[1,4,9,11,4,1,11,1,3,11,6,4],[0,9,1,4,11,6,4,8,11],[11,6,3,3,6,0,6,4,0],[8,6,4,8,11,6],[6,7,10,7,8,10,10,8,9],[9,3,0,6,3,9,6,9,10,6,7,3],[6,1,10,6,7,1,7,0,1,7,8,0],[6,7,10,10,7,1,7,3,1],[7,11,6,3,8,2,8,10,2,8,9,10],[11,6,7,10,0,9,10,2,0],[2,1,10,7,11,6,8,0,3],[1,10,2,6,7,11],[7,2,6,7,9,2,2,9,1,7,8,9],[1,0,9,3,6,7,3,2,6],[8,0,7,7,0,6,0,2,6],[2,7,3,2,6,7],[7,11,6,3,9,1,3,8,9],[9,1,0,11,6,7],[0,3,8,11,6,7],[11,6,7],[11,7,5,11,5,10],[3,0,8,7,5,10,7,10,11],[9,0,1,10,11,7,10,7,5],[3,1,9,3,9,8,7,10,11,7,5,10],[10,2,5,2,3,5,5,3,7],[5,10,2,8,5,2,8,7,5,8,2,0],[9,0,1,10,2,5,5,2,3,5,3,7],[1,10,2,5,8,7,5,9,8],[2,11,1,11,7,1,1,7,5],[0,8,3,2,11,1,1,11,7,1,7,5],[9,0,2,9,2,7,2,11,7,9,7,5],[11,3,2,8,5,9,8,7,5],[1,3,7,1,7,5],[8,7,0,0,7,1,7,5,1],[0,3,9,9,3,5,3,7,5],[9,7,5,9,8,7],[4,5,8,5,10,8,8,10,11],[3,0,4,3,4,10,4,5,10,3,10,11],[0,1,9,4,5,8,8,5,10,8,10,11],[5,9,4,1,11,3,1,10,11],[3,8,4,3,4,2,2,4,5,2,5,10],[10,2,5,5,2,4,2,0,4],[0,3,8,5,9,4,10,2,1],[2,1,10,9,4,5],[8,4,5,2,8,5,2,11,8,2,5,1],[3,2,11,1,4,5,1,0,4],[9,4,5,8,2,11,8,0,2],[11,3,2,9,4,5],[4,5,8,8,5,3,5,1,3],[5,0,4,5,1,0],[3,8,0,4,5,9],[9,4,5],[7,4,11,4,9,11,11,9,10],[3,0,8,7,4,11,11,4,9,11,9,10],[11,7,4,1,11,4,1,10,11,1,4,0],[8,7,4,11,1,10,11,3,1],[2,3,7,2,7,9,7,4,9,2,9,10],[4,8,7,0,10,2,0,9,10],[2,1,10,0,7,4,0,3,7],[10,2,1,8,7,4],[2,11,7,2,7,1,1,7,4,1,4,9],[3,2,11,4,8,7,9,1,0],[7,4,11,11,4,2,4,0,2],[2,11,3,7,4,8],[9,1,4,4,1,7,1,3,7],[1,0,9,8,7,4],[3,4,0,3,7,4],[8,7,4],[8,9,10,8,10,11],[0,9,3,3,9,11,9,10,11],[1,10,0,0,10,8,10,11,8],[10,3,1,10,11,3],[3,8,2,2,8,10,8,9,10],[9,2,0,9,10,2],[8,0,3,1,10,2],[10,2,1],[2,11,1,1,11,9,11,8,9],[11,3,2,0,9,1],[11,0,2,11,8,0],[11,3,2],[8,1,3,8,9,1],[9,1,0],[8,0,3],[]]}march(i,s,l,h){let E=!!h.fulltable,g=h.hasOwnProperty("origin")&&h.origin.hasOwnProperty("x")?h.origin:{x:0,y:0,z:0},A=!!h.voxel,M=h.matrix,S=h.nX||0,P=h.nY||0,L=h.nZ||0,X=h.scale||1,U=null;U=h.unitCube?h.unitCube:{x:X,y:X,z:X};let j,W,G=new Int32Array(S*P*L);for(j=0,W=G.length;j<W;++j)G[j]=-1;let Z=function(le,ye,Pe,Te,ke,we){let Ge={x:0,y:0,z:0},Je=ke;if(!(Te&1<<ke)&&Te&1<<we&&(Je=we),1&Je&&Pe++,2&Je&&ye++,4&Je&&le++,M){let Ze=new m.Vector3(le,ye,Pe);Ze=Ze.applyMatrix4(M),Ge={x:Ze.x,y:Ze.y,z:Ze.z}}else Ge.x=g.x+U.x*le,Ge.y=g.y+U.y*ye,Ge.z=g.z+U.z*Pe;let tt=(P*le+ye)*L+Pe;return A?(s.push(Ge),s.length-1):(G[tt]<0&&(G[tt]=s.length,s.push(Ge)),G[tt])},te=new Int32Array(12),re=E?this.edgeTable2:this.edgeTable,de=E?this.triTable2:this.triTable;for(j=0;j<S-1;++j)for(let le=0;le<P-1;++le)for(let ye=0;ye<L-1;++ye){let Pe=0;for(let we=0;we<8;++we)Pe|=!!(i[(P*(j+((4&we)>>2))+le+((2&we)>>1))*L+ye+(1&we)]&this.ISDONE)<<we;if(Pe===0||Pe===255)continue;let Te=re[Pe];if(Te===0)continue;let ke=de[Pe];1&Te&&(te[0]=Z(j,le,ye,Pe,0,1)),2&Te&&(te[1]=Z(j,le,ye,Pe,1,3)),4&Te&&(te[2]=Z(j,le,ye,Pe,3,2)),8&Te&&(te[3]=Z(j,le,ye,Pe,2,0)),16&Te&&(te[4]=Z(j,le,ye,Pe,4,5)),32&Te&&(te[5]=Z(j,le,ye,Pe,5,7)),64&Te&&(te[6]=Z(j,le,ye,Pe,7,6)),128&Te&&(te[7]=Z(j,le,ye,Pe,6,4)),256&Te&&(te[8]=Z(j,le,ye,Pe,0,4)),512&Te&&(te[9]=Z(j,le,ye,Pe,1,5)),1024&Te&&(te[10]=Z(j,le,ye,Pe,3,7)),2048&Te&&(te[11]=Z(j,le,ye,Pe,2,6));for(let we=0;we<ke.length;we+=3){let Ge=te[ke[we]],Je=te[ke[we+1]],tt=te[ke[we+2]];A&&we>=3&&(s.push(s[Ge]),Ge=s.length-1,s.push(s[Je]),Je=s.length-1,s.push(s[tt]),tt=s.length-1),l.push(Ge),l.push(Je),l.push(tt)}}}laplacianSmooth(i,s,l){let h,E,g,A,M,S=new Array(s.length);for(h=0,E=s.length;h<E;h++)S[h]={x:0,y:0,z:0};let P,L=new Array(20);for(h=0;h<20;h++)L[h]=new Array(s.length);for(h=0,E=s.length;h<E;h++)L[0][h]=0;for(h=0,E=l.length/3;h<E;h++){let U=3*h,j=3*h+1,W=3*h+2;for(P=!0,g=0,A=L[0][l[U]];g<A;g++)if(l[j]==L[g+1][l[U]]){P=!1;break}for(P&&(L[0][l[U]]++,L[L[0][l[U]]][l[U]]=l[j]),P=!0,g=0,A=L[0][l[U]];g<A;g++)if(l[W]==L[g+1][l[U]]){P=!1;break}for(P&&(L[0][l[U]]++,L[L[0][l[U]]][l[U]]=l[W]),P=!0,g=0,A=L[0][l[j]];g<A;g++)if(l[U]==L[g+1][l[j]]){P=!1;break}for(P&&(L[0][l[j]]++,L[L[0][l[j]]][l[j]]=l[U]),P=!0,g=0,A=L[0][l[j]];g<A;g++)if(l[W]==L[g+1][l[j]]){P=!1;break}for(P&&(L[0][l[j]]++,L[L[0][l[j]]][l[j]]=l[W]),P=!0,g=0;g<L[0][l[W]];g++)if(l[U]==L[g+1][l[W]]){P=!1;break}for(P&&(L[0][l[W]]++,L[L[0][l[W]]][l[W]]=l[U]),P=!0,g=0,A=L[0][l[W]];g<A;g++)if(l[j]==L[g+1][l[W]]){P=!1;break}P&&(L[0][l[W]]++,L[L[0][l[W]]][l[W]]=l[j])}let X=.5;for(M=0;M<i;M++){for(h=0,E=s.length;h<E;h++)if(L[0][h]<3)S[h].x=s[h].x,S[h].y=s[h].y,S[h].z=s[h].z;else if(L[0][h]==3||L[0][h]==4){for(S[h].x=0,S[h].y=0,S[h].z=0,g=0,A=L[0][h];g<A;g++)S[h].x+=s[L[g+1][h]].x,S[h].y+=s[L[g+1][h]].y,S[h].z+=s[L[g+1][h]].z;S[h].x+=X*s[h].x,S[h].y+=X*s[h].y,S[h].z+=X*s[h].z,S[h].x/=X+L[0][h],S[h].y/=X+L[0][h],S[h].z/=X+L[0][h]}else{for(S[h].x=0,S[h].y=0,S[h].z=0,g=0,A=L[0][h];g<A;g++)S[h].x+=s[L[g+1][h]].x,S[h].y+=s[L[g+1][h]].y,S[h].z+=s[L[g+1][h]].z;S[h].x+=1*s[h].x,S[h].y+=1*s[h].y,S[h].z+=1*s[h].z,S[h].x/=1+L[0][h],S[h].y/=1+L[0][h],S[h].z/=1+L[0][h]}for(h=0,E=s.length;h<E;h++)s[h].x=S[h].x,s[h].y=S[h].y,s[h].z=S[h].z}}}let _=new Bt;class ne{constructor(i,s,l){this.data=new Int32Array(i*s*l*3),this.width=s,this.height=l}set(i,s,l,h){let E=3*((i*this.width+s)*this.height+l);this.data[E]=h.ix,this.data[E+1]=h.iy,this.data[E+2]=h.iz}get(i,s,l){let h=3*((i*this.width+s)*this.height+l);return{ix:this.data[h],iy:this.data[h+1],iz:this.data[h+2]}}}class xe{constructor(){this.INOUT=1,this.ISDONE=2,this.ISBOUND=4,this.ptranx=0,this.ptrany=0,this.ptranz=0,this.probeRadius=1.4,this.defaultScaleFactor=2,this.scaleFactor=this.defaultScaleFactor,this.pHeight=0,this.pWidth=0,this.pLength=0,this.cutRadius=0,this.vpBits=null,this.vpDistance=null,this.vpAtomID=null,this.pminx=0,this.pminy=0,this.pminz=0,this.pmaxx=0,this.pmaxy=0,this.pmaxz=0,this.depty={},this.widxz={},this.faces=[],this.verts=[],this.vdwRadii={H:1.2,Li:1.82,Na:2.27,K:2.75,C:1.7,N:1.55,O:1.52,F:1.47,P:1.8,S:1.8,CL:1.75,BR:1.85,SE:1.9,ZN:1.39,CU:1.4,NI:1.63,X:2},this.nb=[new Int32Array([1,0,0]),new Int32Array([-1,0,0]),new Int32Array([0,1,0]),new Int32Array([0,-1,0]),new Int32Array([0,0,1]),new Int32Array([0,0,-1]),new Int32Array([1,1,0]),new Int32Array([1,-1,0]),new Int32Array([-1,1,0]),new Int32Array([-1,-1,0]),new Int32Array([1,0,1]),new Int32Array([1,0,-1]),new Int32Array([-1,0,1]),new Int32Array([-1,0,-1]),new Int32Array([0,1,1]),new Int32Array([0,1,-1]),new Int32Array([0,-1,1]),new Int32Array([0,-1,-1]),new Int32Array([1,1,1]),new Int32Array([1,1,-1]),new Int32Array([1,-1,1]),new Int32Array([-1,1,1]),new Int32Array([1,-1,-1]),new Int32Array([-1,-1,1]),new Int32Array([-1,1,-1]),new Int32Array([-1,-1,-1])],xe.MarchingCube||(xe.MarchingCube=new Bt)}getVDWIndex(i){return i.elem&&this.vdwRadii[i.elem]!==void 0?i.elem:"X"}getFacesAndVertices(i){let s={};for(let E=0,g=i.length;E<g;E++)s[i[E]]=!0;let l=this.verts;for(let E=0,g=l.length;E<g;E++)l[E].x=l[E].x/this.scaleFactor-this.ptranx,l[E].y=l[E].y/this.scaleFactor-this.ptrany,l[E].z=l[E].z/this.scaleFactor-this.ptranz;let h=[];for(let E=0,g=this.faces.length;E<g;E+=3){let A=this.faces[E],M=this.faces[E+1],S=this.faces[E+2],P=l[A].atomid,L=l[M].atomid,X=l[S].atomid,U=P;L<U&&(U=L),X<U&&(U=X),s[U]&&A!==M&&M!==S&&A!==S&&(h.push(A),h.push(M),h.push(S))}return this.vpBits=null,this.vpDistance=null,this.vpAtomID=null,{vertices:l,faces:h}}initparm(i,s,l){l>1e6&&(this.scaleFactor=this.defaultScaleFactor/2);let h=1/this.scaleFactor*5.5;this.pminx=i[0][0],this.pmaxx=i[1][0],this.pminy=i[0][1],this.pmaxy=i[1][1],this.pminz=i[0][2],this.pmaxz=i[1][2],s?(this.pminx-=this.probeRadius+h,this.pminy-=this.probeRadius+h,this.pminz-=this.probeRadius+h,this.pmaxx+=this.probeRadius+h,this.pmaxy+=this.probeRadius+h,this.pmaxz+=this.probeRadius+h):(this.pminx-=h,this.pminy-=h,this.pminz-=h,this.pmaxx+=h,this.pmaxy+=h,this.pmaxz+=h),this.pminx=Math.floor(this.pminx*this.scaleFactor)/this.scaleFactor,this.pminy=Math.floor(this.pminy*this.scaleFactor)/this.scaleFactor,this.pminz=Math.floor(this.pminz*this.scaleFactor)/this.scaleFactor,this.pmaxx=Math.ceil(this.pmaxx*this.scaleFactor)/this.scaleFactor,this.pmaxy=Math.ceil(this.pmaxy*this.scaleFactor)/this.scaleFactor,this.pmaxz=Math.ceil(this.pmaxz*this.scaleFactor)/this.scaleFactor,this.ptranx=-this.pminx,this.ptrany=-this.pminy,this.ptranz=-this.pminz,this.pLength=Math.ceil(this.scaleFactor*(this.pmaxx-this.pminx))+1,this.pWidth=Math.ceil(this.scaleFactor*(this.pmaxy-this.pminy))+1,this.pHeight=Math.ceil(this.scaleFactor*(this.pmaxz-this.pminz))+1,this.boundingatom(s),this.cutRadius=this.probeRadius*this.scaleFactor,this.vpBits=new Uint8Array(this.pLength*this.pWidth*this.pHeight),this.vpDistance=new Float64Array(this.pLength*this.pWidth*this.pHeight),this.vpAtomID=new Int32Array(this.pLength*this.pWidth*this.pHeight)}boundingatom(i){let s={};for(const l in this.vdwRadii){let h=this.vdwRadii[l];s[l]=i?(h+this.probeRadius)*this.scaleFactor+.5:h*this.scaleFactor+.5;let E=s[l]*s[l];this.widxz[l]=Math.floor(s[l])+1,this.depty[l]=new Int32Array(this.widxz[l]*this.widxz[l]);let g=0;for(let A=0;A<this.widxz[l];A++)for(let M=0;M<this.widxz[l];M++){let S=A*A+M*M;if(S>E)this.depty[l][g]=-1;else{let P=Math.sqrt(E-S);this.depty[l][g]=Math.floor(P)}g++}}}fillvoxels(i,s){for(let l=0,h=this.vpBits.length;l<h;l++)this.vpBits[l]=0,this.vpDistance[l]=-1,this.vpAtomID[l]=-1;for(let l in s){let h=i[s[l]];h!==void 0&&this.fillAtom(h,i)}for(let l=0,h=this.vpBits.length;l<h;l++)this.vpBits[l]&this.INOUT&&(this.vpBits[l]|=this.ISDONE)}fillAtom(i,s){let l=Math.floor(.5+this.scaleFactor*(i.x+this.ptranx)),h=Math.floor(.5+this.scaleFactor*(i.y+this.ptrany)),E=Math.floor(.5+this.scaleFactor*(i.z+this.ptranz)),g=this.getVDWIndex(i),A=0,M=this.pWidth*this.pHeight;for(let S=0,P=this.widxz[g];S<P;S++)for(let L=0;L<P;L++){if(this.depty[g][A]!=-1){for(let X=-1;X<2;X++)for(let U=-1;U<2;U++)for(let j=-1;j<2;j++)if(X!==0&&U!==0&&j!==0){let W=X*S,G=j*L;for(let Z=0;Z<=this.depty[g][A];Z++){let te=Z*U,re=l+W,de=h+te,le=E+G;if(re<0||de<0||le<0||re>=this.pLength||de>=this.pWidth||le>=this.pHeight)continue;let ye=re*M+de*this.pHeight+le;if(this.vpBits[ye]&this.INOUT){let Pe=s[this.vpAtomID[ye]];if(Pe.serial!=i.serial){let Te=l+W-Math.floor(.5+this.scaleFactor*(Pe.x+this.ptranx)),ke=h+te-Math.floor(.5+this.scaleFactor*(Pe.y+this.ptrany)),we=E+G-Math.floor(.5+this.scaleFactor*(Pe.z+this.ptranz));W*W+te*te+G*G<Te*Te+ke*ke+we*we&&(this.vpAtomID[ye]=i.serial)}}else this.vpBits[ye]|=this.INOUT,this.vpAtomID[ye]=i.serial}}}A++}}fillvoxelswaals(i,s){for(let l=0,h=this.vpBits.length;l<h;l++)this.vpBits[l]&=~this.ISDONE;for(let l in s){let h=i[s[l]];h!==void 0&&this.fillAtomWaals(h,i)}}fillAtomWaals(i,s){let l=0,h=Math.floor(.5+this.scaleFactor*(i.x+this.ptranx)),E=Math.floor(.5+this.scaleFactor*(i.y+this.ptrany)),g=Math.floor(.5+this.scaleFactor*(i.z+this.ptranz)),A=this.getVDWIndex(i),M=this.pWidth*this.pHeight;for(let S=0,P=this.widxz[A];S<P;S++)for(let L=0;L<P;L++){if(this.depty[A][l]!=-1){for(let X=-1;X<2;X++)for(let U=-1;U<2;U++)for(let j=-1;j<2;j++)if(X!==0&&U!==0&&j!==0){let W=X*S,G=j*L;for(let Z=0;Z<=this.depty[A][l];Z++){let te=Z*U,re=h+W,de=E+te,le=g+G;if(re<0||de<0||le<0||re>=this.pLength||de>=this.pWidth||le>=this.pHeight)continue;let ye=re*M+de*this.pHeight+le;if(this.vpBits[ye]&this.ISDONE){let Pe=s[this.vpAtomID[ye]];if(Pe.serial!=i.serial){let Te=h+W-Math.floor(.5+this.scaleFactor*(Pe.x+this.ptranx)),ke=E+te-Math.floor(.5+this.scaleFactor*(Pe.y+this.ptrany)),we=g+G-Math.floor(.5+this.scaleFactor*(Pe.z+this.ptranz));W*W+te*te+G*G<Te*Te+ke*ke+we*we&&(this.vpAtomID[ye]=i.serial)}}else this.vpBits[ye]|=this.ISDONE,this.vpAtomID[ye]=i.serial}}}l++}}buildboundary(){let i=this.pWidth*this.pHeight;for(let s=0;s<this.pLength;s++)for(let l=0;l<this.pHeight;l++)for(let h=0;h<this.pWidth;h++){let E=s*i+h*this.pHeight+l;if(this.vpBits[E]&this.INOUT){let g=0;for(;g<26;){let A=s+this.nb[g][0],M=l+this.nb[g][2],S=h+this.nb[g][1];if(A>-1&&A<this.pLength&&S>-1&&S<this.pWidth&&M>-1&&M<this.pHeight&&!(this.vpBits[A*i+S*this.pHeight+M]&this.INOUT)){this.vpBits[E]|=this.ISBOUND;break}g++}}}}fastdistancemap(){let i,s=new ne(this.pLength,this.pWidth,this.pHeight),l=this.pWidth*this.pHeight,h=this.cutRadius*this.cutRadius,E=[],g=[];for(let S=0;S<this.pLength;S++)for(let P=0;P<this.pWidth;P++)for(let L=0;L<this.pHeight;L++)if(i=S*l+P*this.pHeight+L,this.vpBits[i]&=~this.ISDONE,this.vpBits[i]&this.INOUT&&this.vpBits[i]&this.ISBOUND){let X={ix:S,iy:P,iz:L};s.set(S,P,L,X),E.push(X),this.vpDistance[i]=0,this.vpBits[i]|=this.ISDONE,this.vpBits[i]&=~this.ISBOUND}do{g=this.fastoneshell(E,s),E=[];for(let S=0,P=g.length;S<P;S++)i=l*g[S].ix+this.pHeight*g[S].iy+g[S].iz,this.vpBits[i]&=~this.ISBOUND,this.vpDistance[i]<=1.0404*h&&E.push({ix:g[S].ix,iy:g[S].iy,iz:g[S].iz})}while(E.length!==0);E=[],g=[],s=null;let A=this.scaleFactor-.5;A<0&&(A=0);let M=h-.5/(.1+A);for(let S=0;S<this.pLength;S++)for(let P=0;P<this.pWidth;P++)for(let L=0;L<this.pHeight;L++)i=S*l+P*this.pHeight+L,this.vpBits[i]&=~this.ISBOUND,this.vpBits[i]&this.INOUT&&(this.vpBits[i]&this.ISDONE&&!(this.vpBits[i]&this.ISDONE&&this.vpDistance[i]>=M)||(this.vpBits[i]|=this.ISBOUND))}fastoneshell(i,s){let l,h,E,g,A,M,S,P,L,X=[];if(i.length===0)return X;let U={ix:-1,iy:-1,iz:-1},j=this.pWidth*this.pHeight;for(let W=0,G=i.length;W<G;W++){l=i[W].ix,h=i[W].iy,E=i[W].iz,P=s.get(l,h,E);for(let Z=0;Z<6;Z++)U.ix=l+this.nb[Z][0],U.iy=h+this.nb[Z][1],U.iz=E+this.nb[Z][2],U.ix<this.pLength&&U.ix>-1&&U.iy<this.pWidth&&U.iy>-1&&U.iz<this.pHeight&&U.iz>-1&&(L=U.ix*j+this.pHeight*U.iy+U.iz,this.vpBits[L]&this.INOUT&&!(this.vpBits[L]&this.ISDONE)?(s.set(U.ix,U.iy,E+this.nb[Z][2],P),g=U.ix-P.ix,A=U.iy-P.iy,M=U.iz-P.iz,S=g*g+A*A+M*M,this.vpDistance[L]=S,this.vpBits[L]|=this.ISDONE,this.vpBits[L]|=this.ISBOUND,X.push({ix:U.ix,iy:U.iy,iz:U.iz})):this.vpBits[L]&this.INOUT&&this.vpBits[L]&this.ISDONE&&(g=U.ix-P.ix,A=U.iy-P.iy,M=U.iz-P.iz,S=g*g+A*A+M*M,S<this.vpDistance[L]&&(s.set(U.ix,U.iy,U.iz,P),this.vpDistance[L]=S,this.vpBits[L]&this.ISBOUND||(this.vpBits[L]|=this.ISBOUND,X.push({ix:U.ix,iy:U.iy,iz:U.iz})))))}for(let W=0,G=i.length;W<G;W++){l=i[W].ix,h=i[W].iy,E=i[W].iz,P=s.get(l,h,E);for(let Z=6;Z<18;Z++)U.ix=l+this.nb[Z][0],U.iy=h+this.nb[Z][1],U.iz=E+this.nb[Z][2],U.ix<this.pLength&&U.ix>-1&&U.iy<this.pWidth&&U.iy>-1&&U.iz<this.pHeight&&U.iz>-1&&(L=U.ix*j+this.pHeight*U.iy+U.iz,this.vpBits[L]&this.INOUT&&!(this.vpBits[L]&this.ISDONE)?(s.set(U.ix,U.iy,E+this.nb[Z][2],P),g=U.ix-P.ix,A=U.iy-P.iy,M=U.iz-P.iz,S=g*g+A*A+M*M,this.vpDistance[L]=S,this.vpBits[L]|=this.ISDONE,this.vpBits[L]|=this.ISBOUND,X.push({ix:U.ix,iy:U.iy,iz:U.iz})):this.vpBits[L]&this.INOUT&&this.vpBits[L]&this.ISDONE&&(g=U.ix-P.ix,A=U.iy-P.iy,M=U.iz-P.iz,S=g*g+A*A+M*M,S<this.vpDistance[L]&&(s.set(U.ix,U.iy,U.iz,P),this.vpDistance[L]=S,this.vpBits[L]&this.ISBOUND||(this.vpBits[L]|=this.ISBOUND,X.push({ix:U.ix,iy:U.iy,iz:U.iz})))))}for(let W=0,G=i.length;W<G;W++){l=i[W].ix,h=i[W].iy,E=i[W].iz,P=s.get(l,h,E);for(let Z=18;Z<26;Z++)U.ix=l+this.nb[Z][0],U.iy=h+this.nb[Z][1],U.iz=E+this.nb[Z][2],U.ix<this.pLength&&U.ix>-1&&U.iy<this.pWidth&&U.iy>-1&&U.iz<this.pHeight&&U.iz>-1&&(L=U.ix*j+this.pHeight*U.iy+U.iz,this.vpBits[L]&this.INOUT&&!(this.vpBits[L]&this.ISDONE)?(s.set(U.ix,U.iy,E+this.nb[Z][2],P),g=U.ix-P.ix,A=U.iy-P.iy,M=U.iz-P.iz,S=g*g+A*A+M*M,this.vpDistance[L]=S,this.vpBits[L]|=this.ISDONE,this.vpBits[L]|=this.ISBOUND,X.push({ix:U.ix,iy:U.iy,iz:U.iz})):this.vpBits[L]&this.INOUT&&this.vpBits[L]&this.ISDONE&&(g=U.ix-P.ix,A=U.iy-P.iy,M=U.iz-P.iz,S=g*g+A*A+M*M,S<this.vpDistance[L]&&(s.set(U.ix,U.iy,U.iz,P),this.vpDistance[L]=S,this.vpBits[L]&this.ISBOUND||(this.vpBits[L]|=this.ISBOUND,X.push({ix:U.ix,iy:U.iy,iz:U.iz})))))}return X}marchingcubeinit(i){for(let s=0,l=this.vpBits.length;s<l;s++)i==1?this.vpBits[s]&=~this.ISBOUND:i==4?(this.vpBits[s]&=~this.ISDONE,this.vpBits[s]&this.ISBOUND&&(this.vpBits[s]|=this.ISDONE),this.vpBits[s]&=~this.ISBOUND):i==2?this.vpBits[s]&this.ISBOUND&&this.vpBits[s]&this.ISDONE?this.vpBits[s]&=~this.ISBOUND:this.vpBits[s]&this.ISBOUND&&!(this.vpBits[s]&this.ISDONE)&&(this.vpBits[s]|=this.ISDONE):i==3&&(this.vpBits[s]&=~this.ISBOUND)}marchingcube(i){this.marchingcubeinit(i),this.verts=[],this.faces=[],xe.MarchingCube.march(this.vpBits,this.verts,this.faces,{smooth:1,nX:this.pLength,nY:this.pWidth,nZ:this.pHeight});let s=this.pWidth*this.pHeight;for(let l=0,h=this.verts.length;l<h;l++)this.verts[l].atomid=this.vpAtomID[this.verts[l].x*s+this.pHeight*this.verts[l].y+this.verts[l].z];xe.MarchingCube.laplacianSmooth(1,this.verts,this.faces)}}xe.MarchingCube=new Bt;var Ve=a(848);class Oe{static finalizeGeo(i){var s=i.updateGeoGroup(0);s.vertices>0&&s.truncateArrayBuffers(!0,!0)}static updateColor(i,s){var l,h,E;s=s||b.CC.color(s),i.colorsNeedUpdate=!0,s.constructor!==Array&&(l=s.r,h=s.g,E=s.b);for(let g in i.geometryGroups){let A=i.geometryGroups[g],M=A.colorArray;for(let S=0,P=A.vertices;S<P;++S){if(s.constructor===Array){let L=s[S];l=L.r,h=L.g,E=L.b}M[3*S]=l,M[3*S+1]=h,M[3*S+2]=E}}}static drawArrow(i,s,l){var h=l.start,E=l.end,g=l.radius,A=l.radiusRatio,M=l.mid,S=l.midpos;if(!h||!E)return;var P=s.updateGeoGroup(51),L=new m.Vector3(E.x,E.y,E.z).sub(h);if(S){let hi=L.length();M=S>0?S/hi:(hi+S)/hi}L.multiplyScalar(M);var X=new m.Vector3(h.x,h.y,h.z).add(L),U=L.clone().negate();let j=new m.Vector3(h.x,h.y,h.z);i.intersectionShape.cylinder.push(new v.Cylinder(j,X.clone(),g)),i.intersectionShape.sphere.push(new v.Sphere(j,g));var W=[];W[0]=L.clone(),Math.abs(W[0].x)>1e-4?W[0].y+=1:W[0].x+=1,W[0].cross(L),W[0].normalize(),W[4]=W[0].clone(),W[4].crossVectors(W[0],L),W[4].normalize(),W[8]=W[0].clone().negate(),W[12]=W[4].clone().negate(),W[2]=W[0].clone().add(W[4]).normalize(),W[6]=W[4].clone().add(W[8]).normalize(),W[10]=W[8].clone().add(W[12]).normalize(),W[14]=W[12].clone().add(W[0]).normalize(),W[1]=W[0].clone().add(W[2]).normalize(),W[3]=W[2].clone().add(W[4]).normalize(),W[5]=W[4].clone().add(W[6]).normalize(),W[7]=W[6].clone().add(W[8]).normalize(),W[9]=W[8].clone().add(W[10]).normalize(),W[11]=W[10].clone().add(W[12]).normalize(),W[13]=W[12].clone().add(W[14]).normalize(),W[15]=W[14].clone().add(W[0]).normalize();var G,Z,te,re,de,le,ye,Pe,Te,ke,we,Ge,Je,tt,Ze,ut,ft,Qe,pt,Be,et,St,ot=P.vertices,wt=P.vertexArray,Et=P.faceArray,it=P.normalArray,Rt=P.lineArray;for(Z=0,te=W.length;Z<te;++Z){G=3*(ot+3*Z);var Ht=W[Z].clone().multiplyScalar(g).add(h),kt=W[Z].clone().multiplyScalar(g).add(X),ct=W[Z].clone().multiplyScalar(g*A).add(X);if(wt[G]=Ht.x,wt[G+1]=Ht.y,wt[G+2]=Ht.z,wt[G+3]=kt.x,wt[G+4]=kt.y,wt[G+5]=kt.z,wt[G+6]=ct.x,wt[G+7]=ct.y,wt[G+8]=ct.z,Z>0){var Jt=wt[G-3],Nt=wt[G-2],qt=wt[G-1],Vt=new m.Vector3(Jt,Nt,qt),Kt=new m.Vector3(E.x,E.y,E.z),yr=X.clone(),Fr=new m.Vector3(ct.x,ct.y,ct.z);i.intersectionShape.triangle.push(new v.Triangle(Fr,Kt,Vt)),i.intersectionShape.triangle.push(new v.Triangle(Vt.clone(),yr,Fr.clone()))}}P.vertices+=48,wt[G=3*P.vertices]=h.x,wt[G+1]=h.y,wt[G+2]=h.z,wt[G+3]=X.x,wt[G+4]=X.y,wt[G+5]=X.z,wt[G+6]=E.x,wt[G+7]=E.y,wt[G+8]=E.z,P.vertices+=3;var Tr=P.vertices-3,ii=P.vertices-2,Wr=P.vertices-1,br=3*Tr,Xr=3*ii,ci=3*Wr;for(Z=0,te=W.length-1;Z<te;++Z){var ni=ot+3*Z;G=3*ni,de=P.faceidx,le=P.lineidx,Je=3*(ye=ni),tt=3*(Pe=ni+1),Ze=3*(Te=ni+2),ut=3*(ke=ni+4),ft=3*(we=ni+5),Qe=3*(Ge=ni+3),pt=Be=W[Z],et=St=W[Z+1],it[Je]=pt.x,it[tt]=Be.x,it[Qe]=St.x,it[Je+1]=pt.y,it[tt+1]=Be.y,it[Qe+1]=St.y,it[Je+2]=pt.z,it[tt+2]=Be.z,it[Qe+2]=St.z,it[tt]=Be.x,it[ut]=et.x,it[Qe]=St.x,it[tt+1]=Be.y,it[ut+1]=et.y,it[Qe+1]=St.y,it[tt+2]=Be.z,it[ut+2]=et.z,it[Qe+2]=St.z,it[Ze]=Be.x,it[ft]=et.x,it[Ze+1]=Be.y,it[ft+1]=et.y,it[Ze+2]=Be.z,it[ft+2]=et.z,Et[de]=ye,Et[de+1]=Pe,Et[de+2]=Ge,Et[de+3]=Pe,Et[de+4]=ke,Et[de+5]=Ge,Et[de+6]=ye,Et[de+7]=Ge,Et[de+8]=Tr,Et[de+9]=Te,Et[de+10]=ii,Et[de+11]=we,Et[de+12]=Te,Et[de+13]=Wr,Et[de+14]=we,Rt[le]=ye,Rt[le+1]=Pe,Rt[le+2]=ye,Rt[le+3]=Ge,Rt[le+4]=ke,Rt[le+5]=Ge,Rt[le+6]=ye,Rt[le+7]=Ge,Rt[le+8]=Te,Rt[le+9]=Pe,Rt[le+10]=Te,Rt[le+11]=we,Rt[le+12]=ke,Rt[le+13]=we,Rt[le+14]=Te,Rt[le+15]=Wr,Rt[le+16]=Te,Rt[le+17]=we,Rt[le+18]=Wr,Rt[le+19]=we,P.faceidx+=15,P.lineidx+=20}re=[ot+45,ot+46,ot+1,ot,ot+47,ot+2],de=P.faceidx,le=P.lineidx,Je=3*(ye=re[0]),tt=3*(Pe=re[1]),Ze=3*(Te=re[4]),ut=3*(ke=re[2]),ft=3*(we=re[5]),Qe=3*(Ge=re[3]),pt=Be=W[15],et=St=W[0],it[Je]=pt.x,it[tt]=Be.x,it[Qe]=St.x,it[Je+1]=pt.y,it[tt+1]=Be.y,it[Qe+1]=St.y,it[Je+2]=pt.z,it[tt+2]=Be.z,it[Qe+2]=St.z,it[tt]=Be.x,it[ut]=et.x,it[Qe]=St.x,it[tt+1]=Be.y,it[ut+1]=et.y,it[Qe+1]=St.y,it[tt+2]=Be.z,it[ut+2]=et.z,it[Qe+2]=St.z,it[Ze]=Be.x,it[ft]=et.x,it[Ze+1]=Be.y,it[ft+1]=et.y,it[Ze+2]=Be.z,it[ft+2]=et.z,L.normalize(),U.normalize(),it[br]=U.x,it[Xr]=it[ci]=L.x,it[br+1]=U.y,it[Xr+1]=it[ci+1]=L.y,it[br+2]=U.z,it[Xr+2]=it[ci+2]=L.z,Et[de]=ye,Et[de+1]=Pe,Et[de+2]=Ge,Et[de+3]=Pe,Et[de+4]=ke,Et[de+5]=Ge,Et[de+6]=ye,Et[de+7]=Ge,Et[de+8]=Tr,Et[de+9]=Te,Et[de+10]=ii,Et[de+11]=we,Et[de+12]=Te,Et[de+13]=Wr,Et[de+14]=we,Rt[le]=ye,Rt[le+1]=Pe,Rt[le+2]=ye,Rt[le+3]=Ge,Rt[le+4]=ke,Rt[le+5]=Ge,Rt[le+6]=ye,Rt[le+7]=Ge,Rt[le+8]=Te,Rt[le+9]=Pe,Rt[le+10]=Te,Rt[le+11]=we,Rt[le+12]=ke,Rt[le+13]=we,Rt[le+14]=Te,Rt[le+15]=Wr,Rt[le+16]=Te,Rt[le+17]=we,Rt[le+18]=Wr,Rt[le+19]=we,P.faceidx+=15,P.lineidx+=20}static updateBoundingFromPoints(i,s,l,h){i.center.set(0,0,0);let E=1/0,g=1/0,A=1/0,M=-1/0,S=-1/0,P=-1/0;i.box&&(E=i.box.min.x,M=i.box.max.x,g=i.box.min.y,S=i.box.max.y,A=i.box.min.z,P=i.box.max.z);for(let j=0,W=h;j<W;j++){var L=l[3*j],X=l[3*j+1],U=l[3*j+2];L<E&&(E=L),X<g&&(g=X),U<A&&(A=U),L>M&&(M=L),X>S&&(S=X),U>P&&(P=U)}i.center.set((M+E)/2,(S+g)/2,(P+A)/2),i.radius=i.center.distanceTo({x:M,y:S,z:P}),i.box={min:{x:E,y:g,z:A},max:{x:M,y:S,z:P}}}static addCustomGeo(i,s,l,h,E){var g,A,M,S,P,L,X,U,j,W=s.addGeoGroup(),G=l.vertexArr,Z=l.normalArr,te=l.faceArr;W.vertices=G.length,W.faceidx=te.length;var re=W.vertexArray,de=W.colorArray;for(h.constructor!==Array&&(U=h.r,j=h.g,S=h.b),L=0,X=W.vertices;L<X;++L)g=3*L,A=G[L],re[g]=A.x,re[g+1]=A.y,re[g+2]=A.z,h.constructor===Array&&(U=(P=h[L]).r,j=P.g,S=P.b),de[g]=U,de[g+1]=j,de[g+2]=S;if(E)for(L=0,X=W.faceidx/3;L<X;++L){M=te[g=3*L],S=te[g+1],P=te[g+2];var le=new m.Vector3,ye=new m.Vector3,Pe=new m.Vector3;i.intersectionShape.triangle.push(new v.Triangle(le.copy(G[M]),ye.copy(G[S]),Pe.copy(G[P])))}if(E){var Te=new m.Vector3(0,0,0),ke=0;for(let Je=0;Je<s.geometryGroups.length;Je++)Te.add(s.geometryGroups[Je].getCentroid()),ke++;Te.divideScalar(ke),Oe.updateBoundingFromPoints(i.boundingSphere,{centroid:Te},re,W.vertices)}if(W.faceArray=new Uint16Array(te),W.truncateArrayBuffers(!0,!0),Z.length<W.vertices)W.setNormals();else{var we,Ge=W.normalArray=new Float32Array(3*W.vertices);for(L=0,X=W.vertices;L<X;++L)g=3*L,we=Z[L],Ge[g]=we.x,Ge[g+1]=we.y,Ge[g+2]=we.z}W.setLineIndices(),W.lineidx=W.lineArray.length}static updateFromStyle(i,s){s.color!==void 0?(i.color=s.color||new b.Color,s.color instanceof b.Color||(i.color=b.CC.color(s.color))):i.color=b.CC.color(0),i.wireframe=!!s.wireframe,i.opacity=s.alpha?(0,m.clamp)(s.alpha,0,1):1,s.opacity!==void 0&&(i.opacity=(0,m.clamp)(s.opacity,0,1)),i.side=s.side!==void 0?s.side:u.DoubleSide,i.linewidth=s.linewidth===void 0?1:s.linewidth,i.clickable=!!s.clickable,i.callback=(0,x.makeFunction)(s.callback),i.hoverable=!!s.hoverable,i.hover_callback=(0,x.makeFunction)(s.hover_callback),i.unhover_callback=(0,x.makeFunction)(s.unhover_callback),i.contextMenuEnabled=!!s.contextMenuEnabled,i.hidden=s.hidden,i.frame=s.frame}constructor(i){this.color=16777215,this.hidden=!1,this.wireframe=!1,this.opacity=1,this.linewidth=1,this.clickable=!1,this.hoverable=!1,this.contextMenuEnabled=!1,this.side=u.DoubleSide,this.stylespec=i||{},this.boundingSphere=new v.Sphere,this.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},Oe.updateFromStyle(this,this.stylespec),this.components=[],this.shapeObj=null,this.renderedShapeObj=null,this.geo=new u.Geometry(!0),this.linegeo=new u.Geometry(!0)}updateStyle(i){for(var s in i)this.stylespec[s]=i[s];if(Oe.updateFromStyle(this,this.stylespec),i.voldata&&i.volscheme){(0,x.adjustVolumeStyle)(i);const l=i.volscheme,h=i.voldata,E=b.CC,g=l.range()||[-1,1];this.geo.setColors(function(A,M,S){let P=h.getVal(A,M,S);return E.color(l.valueToHex(P,g))}),delete this.color}}addCustom(i){i.vertexArr=i.vertexArr||[],i.faceArr=i.faceArr||[],i.normalArr=i.normalArr||[],Oe.drawCustom(this,this.geo,i)}addSphere(i){i.center||(i.center=new m.Vector3(0,0,0)),i.radius=i.radius?(0,m.clamp)(i.radius,0,1/0):1.5,i.color=b.CC.color(i.color),this.intersectionShape.sphere.push(new v.Sphere(i.center,i.radius)),d.drawSphere(this.geo,i.center,i.radius,i.color,i.quality),this.components.push({centroid:new m.Vector3(i.center.x,i.center.y,i.center.z)});var s=this.geo.updateGeoGroup(0);Oe.updateBoundingFromPoints(this.boundingSphere,this.components,s.vertexArray,s.vertices)}addBox(i){var s,l,h,E=i.dimensions||{w:1,h:1,d:1};s=typeof E.w=="number"?{x:E.w,y:0,z:0}:E.w,l=typeof E.h=="number"?{x:0,y:E.h,z:0}:E.h,h=typeof E.d=="number"?{x:0,y:0,z:E.d}:E.d;var g=i.corner;g==null&&(g=i.center!==void 0?{x:i.center.x-.5*(s.x+l.x+h.x),y:i.center.y-.5*(s.y+l.y+h.y),z:i.center.z-.5*(s.z+l.z+h.z)}:{x:0,y:0,z:0});var A=[{x:g.x,y:g.y,z:g.z},{x:g.x+s.x,y:g.y+s.y,z:g.z+s.z},{x:g.x+l.x,y:g.y+l.y,z:g.z+l.z},{x:g.x+s.x+l.x,y:g.y+s.y+l.y,z:g.z+s.z+l.z},{x:g.x+h.x,y:g.y+h.y,z:g.z+h.z},{x:g.x+s.x+h.x,y:g.y+s.y+h.y,z:g.z+s.z+h.z},{x:g.x+l.x+h.x,y:g.y+l.y+h.y,z:g.z+l.z+h.z},{x:g.x+s.x+l.x+h.x,y:g.y+s.y+l.y+h.y,z:g.z+s.z+l.z+h.z}],M=[],S=[];M.splice(M.length,0,A[0],A[1],A[2],A[3]),S.splice(S.length,0,0,2,1,1,2,3);var P=4;M.splice(M.length,0,A[2],A[3],A[6],A[7]),S.splice(S.length,0,P+0,P+2,P+1,P+1,P+2,P+3),P+=4,M.splice(M.length,0,A[4],A[5],A[0],A[1]),S.splice(S.length,0,P+0,P+2,P+1,P+1,P+2,P+3),P+=4,M.splice(M.length,0,A[6],A[7],A[4],A[5]),S.splice(S.length,0,P+0,P+2,P+1,P+1,P+2,P+3),P+=4,M.splice(M.length,0,A[3],A[1],A[7],A[5]),S.splice(S.length,0,P+0,P+2,P+1,P+1,P+2,P+3),P+=4,M.splice(M.length,0,A[2],A[6],A[0],A[4]),S.splice(S.length,0,P+0,P+2,P+1,P+1,P+2,P+3),P+=4;var L=(0,x.extend)({},i);L.vertexArr=M,L.faceArr=S,L.normalArr=[],Oe.drawCustom(this,this.geo,L);var X=new m.Vector3;this.components.push({centroid:X.addVectors(A[0],A[7]).multiplyScalar(.5)});var U=this.geo.updateGeoGroup(0);Oe.updateBoundingFromPoints(this.boundingSphere,this.components,U.vertexArray,U.vertices)}addCylinder(i){var s,l;s=i.start?new m.Vector3(i.start.x||0,i.start.y||0,i.start.z||0):new m.Vector3(0,0,0),i.end?(l=new m.Vector3(i.end.x,i.end.y||0,i.end.z||0)).x===void 0&&(l.x=3):l=new m.Vector3(0,0,0);var h=i.radius||.1,E=b.CC.color(i.color);this.intersectionShape.cylinder.push(new v.Cylinder(s,l,h)),d.drawCylinder(this.geo,s,l,h,E,i.fromCap,i.toCap);var g=new m.Vector3;this.components.push({centroid:g.addVectors(s,l).multiplyScalar(.5)});var A=this.geo.updateGeoGroup(0);Oe.updateBoundingFromPoints(this.boundingSphere,this.components,A.vertexArray,A.vertices)}addDashedCylinder(i){var s,l;i.dashLength=i.dashLength||.25,i.gapLength=i.gapLength||.25,s=i.start?new m.Vector3(i.start.x||0,i.start.y||0,i.start.z||0):new m.Vector3(0,0,0),i.end?(l=new m.Vector3(i.end.x,i.end.y||0,i.end.z||0)).x===void 0&&(l.x=3):l=new m.Vector3(3,0,0);for(var h=i.radius||.1,E=b.CC.color(i.color),g=Math.sqrt(Math.pow(s.x-l.x,2)+Math.pow(s.y-l.y,2)+Math.pow(s.z-l.z,2)),A=g/(i.gapLength+i.dashLength),M=new m.Vector3(i.start.x||0,i.start.y||0,i.start.z||0),S=new m.Vector3(i.end.x,i.end.y||0,i.end.z||0),P=new m.Vector3((l.x-s.x)/(g/i.gapLength),(l.y-s.y)/(g/i.gapLength),(l.z-s.z)/(g/i.gapLength)),L=new m.Vector3((l.x-s.x)/(g/i.dashLength),(l.y-s.y)/(g/i.dashLength),(l.z-s.z)/(g/i.dashLength)),X=0;X<A;X++)S=new m.Vector3(M.x+L.x,M.y+L.y,M.z+L.z),this.intersectionShape.cylinder.push(new v.Cylinder(M,S,h)),d.drawCylinder(this.geo,M,S,h,E,i.fromCap,i.toCap),M=new m.Vector3(S.x+P.x,S.y+P.y,S.z+P.z);var U=new m.Vector3;this.components.push({centroid:U.addVectors(s,l).multiplyScalar(.5)});var j=this.geo.updateGeoGroup(0);Oe.updateBoundingFromPoints(this.boundingSphere,this.components,j.vertexArray,j.vertices)}addCurve(i){i.points=i.points||[],i.smooth=i.smooth||10,i.fromCap===void 0&&(i.fromCap=2),i.toCap===void 0&&(i.toCap=2);var s=k(i.points,i.smooth);if(s.length<3)console.log("Too few points in addCurve");else{var l=i.radius||.1,h=b.CC.color(i.color),E=0,g=s.length-1,A=s[0].distanceTo(s[1]),M=Math.ceil(2*l/A);if(i.toArrow){let X={start:s[g-=M],end:s[s.length-1],radius:l,color:h,mid:1e-4};this.addArrow(X)}if(i.fromArrow){let X={start:s[E+=M],end:s[0],radius:l,color:h,mid:1e-4};this.addArrow(X)}for(var S=Math.ceil(s.length/2),P={radius:l,color:h,fromCap:2,toCap:2},L=E;L<g;L++)P.start=s[L],P.end=s[L+1],P.fromCap=2,P.toCap=2,L<S?(P.fromCap=2,P.toCap=0):L>S?(P.fromCap=0,P.toCap=2):(P.fromCap=2,P.toCap=2),this.addCylinder(P)}}addLine(i){var s,l;s=i.start?new m.Vector3(i.start.x||0,i.start.y||0,i.start.z||0):new m.Vector3(0,0,0),i.end?(l=new m.Vector3(i.end.x,i.end.y||0,i.end.z||0)).x===void 0&&(l.x=3):l=new m.Vector3(3,0,0);var h=this.geo.updateGeoGroup(2),E=h.vertices,g=3*E,A=h.vertexArray;A[g]=s.x,A[g+1]=s.y,A[g+2]=s.z,A[g+3]=l.x,A[g+4]=l.y,A[g+5]=l.z,h.vertices+=2;var M=h.lineArray,S=h.lineidx;M[S]=E,M[S+1]=E+1,h.lineidx+=2;var P=new m.Vector3;this.components.push({centroid:P.addVectors(s,l).multiplyScalar(.5)}),h=this.geo.updateGeoGroup(0),Oe.updateBoundingFromPoints(this.boundingSphere,this.components,h.vertexArray,h.vertices)}addArrow(i){if(i.start?i.start=new m.Vector3(i.start.x||0,i.start.y||0,i.start.z||0):i.start=new m.Vector3(0,0,0),i.dir instanceof m.Vector3&&typeof i.length=="number"){var s=i.dir.clone().multiplyScalar(i.length).add(i.start);i.end=s}else i.end?(i.end=new m.Vector3(i.end.x,i.end.y||0,i.end.z||0),i.end.x===void 0&&(i.end.x=3)):i.end=new m.Vector3(3,0,0);i.radius=i.radius||.1,i.radiusRatio=i.radiusRatio||1.618034,i.mid=0<i.mid&&i.mid<1?i.mid:.618034,Oe.drawArrow(this,this.geo,i);var l=new m.Vector3;this.components.push({centroid:l.addVectors(i.start,i.end).multiplyScalar(.5)});var h=this.geo.updateGeoGroup(0);Oe.updateBoundingFromPoints(this.boundingSphere,this.components,h.vertexArray,h.vertices)}static distance_from(i,s){return Math.sqrt(Math.pow(i.x-s.x,2)+Math.pow(i.y-s.y,2)+Math.pow(i.z-s.z,2))}static inSelectedRegion(i,s,l){for(var h=0;h<s.length;h++)if(Oe.distance_from(s[h],i)<=l)return!0;return!1}addIsosurface(i,s,l,h){var E,g,A=s.isoval!==void 0&&typeof s.isoval=="number"?s.isoval:0,M=!!s.voxel,S=s.smoothness===void 0?1:s.smoothness,P=i.size.x,L=i.size.y,X=i.size.z,U=new Int16Array(P*L*X),j=i.data;for(E=0,g=U.length;E<g;++E)U[E]=-1;var W=new Uint8Array(P*L*X);for(E=0,g=j.length;E<g;++E)(A>=0?j[E]-A:A-j[E])>0&&(W[E]|=Oe.ISDONE);var G=[],Z=[];_.march(W,G,Z,{fulltable:!0,voxel:M,unitCube:i.unit,origin:i.origin,matrix:i.matrix,nX:P,nY:L,nZ:X}),!M&&S>0&&_.laplacianSmooth(S,G,Z);var te=[],re=[],de=[];if(s.selectedRegion&&s.coords===void 0&&(s.coords=s.selectedRegion),s.coords===void 0&&s.selection!==void 0&&(h?s.coords=h.selectedAtoms(s.selection):console.log("addIsosurface needs viewer is selection provided.")),s.coords!==void 0){var le=s.coords[0].x,ye=s.coords[0].y,Pe=s.coords[0].z,Te=s.coords[0].x,ke=s.coords[0].y,we=s.coords[0].z;for(let Be=0;Be<s.coords.length;Be++)s.coords[Be].x>le?le=s.coords[Be].x:s.coords[Be].x<Te&&(Te=s.coords[Be].x),s.coords[Be].y>ye?ye=s.coords[Be].y:s.coords[Be].y<ke&&(ke=s.coords[Be].y),s.coords[Be].z>Pe?Pe=s.coords[Be].z:s.coords[Be].z<we&&(we=s.coords[Be].z);var Ge=2;s.radius!==void 0&&(Ge=s.radius),s.selectedOffset!==void 0&&(Ge=s.selectedOffset),s.seldist!==void 0&&(Ge=s.seldist),Te-=Ge,le+=Ge,ke-=Ge,ye+=Ge,we-=Ge,Pe+=Ge;for(let Be=0;Be<G.length;Be++)G[Be].x>Te&&G[Be].x<le&&G[Be].y>ke&&G[Be].y<ye&&G[Be].z>we&&G[Be].z<Pe&&Oe.inSelectedRegion(G[Be],s.coords,Ge)?(te.push(re.length),re.push(G[Be])):te.push(-1);for(let Be=0;Be+2<Z.length;Be+=3)te[Z[Be]]!==-1&&te[Z[Be+1]]!==-1&&te[Z[Be+2]]!==-1&&(de.push(Z[Be]-(Z[Be]-te[Z[Be]])),de.push(Z[Be+1]-(Z[Be+1]-te[Z[Be+1]])),de.push(Z[Be+2]-(Z[Be+2]-te[Z[Be+2]])));G=re,Z=de}Oe.drawCustom(this,this.geo,{vertexArr:G,faceArr:Z,normalArr:[],clickable:s.clickable,hoverable:s.hoverable}),this.updateStyle(s);var Je=new m.Vector3(i.origin.x,i.origin.y,i.origin.z),tt=new m.Vector3(i.size.x*i.unit.x,i.size.y*i.unit.y,i.size.z*i.unit.z),Ze=new m.Vector3(0,0,0),ut=Je.clone(),ft=Je.clone().add(tt);for(let Be=0;Be<G.length;Be++)Ze.add(G[Be]),ut.max(G[Be]),ft.min(G[Be]);Ze.divideScalar(G.length);var Qe=Ze.distanceTo(ft),pt=Ze.distanceTo(ut);this.boundingSphere.center=Ze,this.boundingSphere.radius=Math.max(Qe,pt),typeof l=="function"&&l()}addVolumetricData(i,s,l){i=new Ve.VolumeData(i,s),this.addIsosurface(i,l)}finalize(){return Oe.finalizeGeo(this.geo),this.geo.initTypedArrays(),this.geo}globj(i){if(this.renderedShapeObj&&(i.remove(this.renderedShapeObj),this.renderedShapeObj=null),!this.hidden){Oe.finalizeGeo(this.geo),this.geo.initTypedArrays(),this.wireframe&&this.geo.setUpWireframe(),this.color!==void 0&&Oe.updateColor(this.geo,this.color),this.shapeObj=new u.Object3D;var s=null;s=this.side==u.DoubleSide?new u.MeshDoubleLambertMaterial({wireframe:this.wireframe,side:this.side,transparent:this.opacity<1,opacity:this.opacity,wireframeLinewidth:this.linewidth,vertexColors:u.Coloring.VertexColors}):new u.MeshLambertMaterial({wireframe:this.wireframe,side:this.side,transparent:this.opacity<1,opacity:this.opacity,wireframeLinewidth:this.linewidth,vertexColors:u.Coloring.VertexColors});var l=new u.Mesh(this.geo,s);if(this.shapeObj.add(l),this.linegeo&&this.linegeo.vertices>0){var h=new u.LineBasicMaterial({linewidth:this.linewidth,color:this.color}),E=new u.Line(this.linegeo,h,u.LineStyle.LinePieces);this.shapeObj.add(E)}this.renderedShapeObj=this.shapeObj.clone(),i.add(this.renderedShapeObj)}}removegl(i){this.renderedShapeObj&&(this.renderedShapeObj.geometry!==void 0&&this.renderedShapeObj.geometry.dispose(),this.renderedShapeObj.material!==void 0&&this.renderedShapeObj.material.dispose(),i.remove(this.renderedShapeObj),this.renderedShapeObj=null),this.shapeObj=null}get position(){return this.boundingSphere.center}get x(){return this.boundingSphere.center.x}get y(){return this.boundingSphere.center.y}get z(){return this.boundingSphere.center.z}}function yt(ae){if(ae.vertexArr.length<64e3)return[ae];var i=[{vertexArr:[],normalArr:[],faceArr:[]}];ae.colorArr&&(i.colorArr=[]);var s=[],l=[],h=0,E=ae.faceArr;for(let A=0,M=E.length;A<M;A+=3){let S=i[h];for(let P=0;P<3;P++){var g=E[A+P];s[g]!==h&&(s[g]=h,l[g]=S.vertexArr.length,S.vertexArr.push(ae.vertexArr[g]),ae.normalArr&&ae.normalArr[g]&&S.normalArr.push(ae.normalArr[g]),ae.colorArr&&ae.colorArr[g]&&S.colorArr.push(ae.colorArr[g])),S.faceArr.push(l[g])}S.vertexArr.length>=64e3&&(i.push({vertexArr:[],normalArr:[],faceArr:[]}),ae.colorArr&&(i.colorArr=[]),h++)}return i}Oe.ISDONE=2,Oe.drawCustom=function(ae,i,s){var l=s,h=l.vertexArr,E=l.faceArr;h.length!==0&&E.length!==0||console.warn("Error adding custom shape component: No vertices and/or face indices supplied!");var g=s.color;g===void 0&&(g=ae.color),g=b.CC.color(g);for(var A=yt(l),M=0,S=A.length;M<S;M++)Oe.addCustomGeo(ae,i,A[M],A[M].colorArr?A[M].colorArr:g,s.clickable)};let lt=0;function mt(ae,i,s){var l=s;return ae!==void 0&&(ae instanceof b.Color?l=ae.scaled():(l=b.CC.color(ae)).scaled!==void 0&&(l=l.scaled())),i!==void 0&&(l.a=parseFloat(i)),l}class Mt{constructor(i,s){this.id=lt++,this.stylespec=s||{},this.canvas=document.createElement("canvas"),this.canvas.width=134,this.canvas.height=35,this.context=this.canvas.getContext("2d"),this.sprite=new u.Sprite,this.text=i,this.frame=this.stylespec.frame}getStyle(){return this.stylespec}hide(){this.sprite&&(this.sprite.visible=!1)}show(){this.sprite&&(this.sprite.visible=!0)}setContext(){var i=this.stylespec,s=i.useScreen!==void 0&&i.useScreen,l=i.showBackground;l!=="0"&&l!=="false"||(l=!1),l===void 0&&(l=!0);var h=i.font?i.font:"sans-serif",E=parseInt(i.fontSize)?parseInt(i.fontSize):18,g=mt(i.fontColor,i.fontOpacity,{r:255,g:255,b:255,a:1}),A=i.padding?i.padding:4,M=i.borderThickness?i.borderThickness:0,S=mt(i.backgroundColor,i.backgroundOpacity,{r:0,g:0,b:0,a:1}),P=mt(i.borderColor,i.borderOpacity,S),L=i.position?i.position:{x:-10,y:1,z:1},X=i.inFront===void 0||i.inFront;X!=="false"&&X!=="0"||(X=!1);var U=i.alignment||u.SpriteAlignment.topLeft;typeof U=="string"&&U in u.SpriteAlignment&&(U=u.SpriteAlignment[U]);var j="";i.bold&&(j="bold "),this.context.font=j+E+"px  "+h;var W=this.context.measureText(this.text).width;l||(M=0);var G=W+2.5*M+2*A,Z=1.25*E+2*M+2*A;if(i.backgroundImage){var te=i.backgroundImage,re=i.backgroundWidth?i.backgroundWidth:te.width,de=i.backgroundHeight?i.backgroundHeight:te.height;re>G&&(G=re),de>Z&&(Z=de)}if(this.canvas.width=G,this.canvas.height=Z,this.context.clearRect(0,0,this.canvas.width,this.canvas.height),j="",i.bold&&(j="bold "),this.context.font=j+E+"px  "+h,this.context.fillStyle="rgba("+S.r+","+S.g+","+S.b+","+S.a+")",this.context.strokeStyle="rgba("+P.r+","+P.g+","+P.b+","+P.a+")",i.backgroundGradient){let ye=this.context.createLinearGradient(0,Z/2,G,Z/2),Pe=T.Gradient.getGradient(i.backgroundGradient),Te=Pe.range(),ke=-1,we=1;Te&&(ke=Te[0],we=Te[1]);let Ge=we-ke;for(let Je=0;Je<1.01;Je+=.1){let tt=mt(Pe.valueToHex(ke+Ge*Je)),Ze="rgba("+tt.r+","+tt.g+","+tt.b+","+tt.a+")";ye.addColorStop(Je,Ze)}this.context.fillStyle=ye}this.context.lineWidth=M,l&&(function(ye,Pe,Te,ke,we,Ge,Je){ye.beginPath(),ye.moveTo(Pe+Ge,Te),ye.lineTo(Pe+ke-Ge,Te),ye.quadraticCurveTo(Pe+ke,Te,Pe+ke,Te+Ge),ye.lineTo(Pe+ke,Te+we-Ge),ye.quadraticCurveTo(Pe+ke,Te+we,Pe+ke-Ge,Te+we),ye.lineTo(Pe+Ge,Te+we),ye.quadraticCurveTo(Pe,Te+we,Pe,Te+we-Ge),ye.lineTo(Pe,Te+Ge),ye.quadraticCurveTo(Pe,Te,Pe+Ge,Te),ye.closePath(),ye.fill(),Je&&ye.stroke()})(this.context,M,M,G-2*M,Z-2*M,6,M>0),i.backgroundImage&&this.context.drawImage(te,0,0,G,Z),this.context.fillStyle="rgba("+g.r+","+g.g+","+g.b+","+g.a+")",this.context.fillText(this.text,M+A,E+M+A,W);var le=new u.Texture(this.canvas);le.needsUpdate=!0,this.sprite.material=new u.SpriteMaterial({map:le,useScreenCoordinates:s,alignment:U,depthTest:!X,screenOffset:i.screenOffset||null}),this.sprite.scale.set(1,1,1),this.sprite.position.set(L.x,L.y,L.z)}dispose(){this.sprite.material.map!==void 0&&this.sprite.material.map.dispose(),this.sprite.material!==void 0&&this.sprite.material.dispose()}}class Pt{static interpolateArray(i,s){function l(L,X,U){return L+(X-L)*U}var h=[],E=(i.length-1)/(s-1);h[0]=i[0];for(var g=1;g<s-1;g++){var A=g*E,M=Math.floor(A),S=Math.ceil(A),P=A-M;h[g]=l(i[M],i[S],P)}return h[s-1]=i[i.length-1],h}constructor(i,s,l){this.hidden=!1,this.boundingSphere=new v.Sphere,this.renderedShapeObj=null,this.shapeObj=null,this.subsamples=5,this.data=null,this.transferfunctionbuffer=[],this.min=0,this.max=0,s=s||{};var h,E,g,A,M,S,P,L,X,U,j=Object.assign([],s.transferfn);this.subsamples=s.subsamples||5,j.forEach(function(G){G.value=parseFloat(G.value)}),j.sort(function(G,Z){return G.value-Z.value}),this.min=j[0].value,j.length==0&&j.push(j[0]),this.max=j[j.length-1].value;for(let G=0;G<j.length-1;G++)if(g=b.CC.color(j[G].color),A=b.CC.color(j[G+1].color),X=j[G].opacity,U=j[G+1].opacity,(h=Math.floor(256*(j[G].value-this.min)/(this.max-this.min)))!=(E=Math.floor(256*(j[G+1].value-this.min)/(this.max-this.min)))){M=Pt.interpolateArray([255*g.r,255*A.r],E-h),S=Pt.interpolateArray([255*g.g,255*A.g],E-h),P=Pt.interpolateArray([255*g.b,255*A.b],E-h),L=Pt.interpolateArray([255*X,255*U],E-h);for(let Z=0;Z<M.length;Z++)this.transferfunctionbuffer.push(M[Z]),this.transferfunctionbuffer.push(S[Z]),this.transferfunctionbuffer.push(P[Z]),this.transferfunctionbuffer.push(L[Z])}if(this.transferfunctionbuffer=new Uint8ClampedArray(this.transferfunctionbuffer),i.matrix){let G=new m.Vector3(0,0,0),Z=new m.Vector3(i.size.x,i.size.y,i.size.z),te=new m.Vector3(1,1,1);G.applyMatrix4(i.matrix),Z.applyMatrix4(i.matrix),te.applyMatrix4(i.matrix).sub(G),this.extent=[[G.x,G.y,G.z],[Z.x,Z.y,Z.z]];for(let ye=1;ye<7;ye++)Z.x=1&ye?i.size.x:0,Z.y=2&ye?i.size.y:0,Z.z=4&ye?i.size.z:0,Z.applyMatrix4(i.matrix),this.extent[0][0]=Math.min(this.extent[0][0],Z.x),this.extent[0][1]=Math.min(this.extent[0][1],Z.y),this.extent[0][2]=Math.min(this.extent[0][2],Z.z),this.extent[1][0]=Math.max(this.extent[1][0],Z.x),this.extent[1][1]=Math.max(this.extent[1][1],Z.y),this.extent[1][2]=Math.max(this.extent[1][2],Z.z);let re=Z.x-G.x,de=Z.y-G.y,le=Z.z-G.z;this.maxdepth=Math.sqrt(re*re+de*de+le*le),this.minunit=Math.min(Math.min(te.x,te.y),te.z),this.texmatrix=new m.Matrix4().identity().scale({x:i.size.x,y:i.size.y,z:i.size.z}),this.texmatrix=this.texmatrix.multiplyMatrices(i.matrix,this.texmatrix),this.texmatrix=this.texmatrix.getInverse(this.texmatrix)}else{this.texmatrix=new m.Matrix4().identity();let G=i.unit.x*i.size.x,Z=i.unit.y*i.size.y,te=i.unit.z*i.size.z;this.texmatrix.makeTranslation(-i.origin.x/G,-i.origin.y/Z,-i.origin.z/te),this.texmatrix.scale({x:1/G,y:1/Z,z:1/te}),this.minunit=Math.min(Math.min(i.unit.x,i.unit.y),i.unit.z),this.extent=[[i.origin.x,i.origin.y,i.origin.z],[i.origin.x+G,i.origin.y+Z,i.origin.z+te]],this.maxdepth=Math.sqrt(G*G+Z*Z+te*te)}var W=new Oe({});if(W.addBox({corner:{x:this.extent[0][0],y:this.extent[0][1],z:this.extent[0][2]},dimensions:{w:this.extent[1][0]-this.extent[0][0],h:this.extent[1][1]-this.extent[0][1],d:this.extent[1][2]-this.extent[0][2]}}),this.geo=W.finalize(),this.boundingSphere.center=new m.Vector3((this.extent[0][0]+this.extent[1][0])/2,(this.extent[0][1]+this.extent[1][1])/2,(this.extent[0][2]+this.extent[1][2])/2),this.boundingSphere.radius=this.maxdepth/2,s.coords===void 0&&s.selection!==void 0&&(l?s.coords=l.selectedAtoms(s.selection):console.log("Need to provide viewer to volumetric renderer if selection specified.")),s.coords!==void 0&&s.seldist!==void 0){let G=new Uint8Array(i.data.length),Z=s.seldist,te=Z*Z;for(let re=0,de=s.coords.length;re<de;re++){let le=s.coords[re],ye=le.x-Z,Pe=le.y-Z,Te=le.z-Z,ke=le.x+Z,we=le.y+Z,Ge=le.z+Z;if(i.getIndex(ye,Pe,Te)>=0||i.getIndex(ke,we,Ge)>=0)for(let Je=ye;Je<ke;Je+=this.minunit)for(let tt=Pe;tt<we;tt+=this.minunit)for(let Ze=Te;Ze<Ge;Ze+=this.minunit){let ut=i.getIndex(Je,tt,Ze);ut>=0&&!G[ut]&&(Je-le.x)*(Je-le.x)+(tt-le.y)*(tt-le.y)+(Ze-le.z)*(Ze-le.z)<te&&(G[ut]=1)}}for(let re=0,de=i.data.length;re<de;re++)G[re]==0&&(i.data[re]=1/0)}this.data=i}globj(i){if(this.renderedShapeObj&&(i.remove(this.renderedShapeObj),this.renderedShapeObj=null),!this.hidden){this.shapeObj=new u.Object3D;var s,l=new u.Texture(this.data,!0),h=new u.Texture(this.transferfunctionbuffer,!1);l.needsUpdate=!0,h.needsUpdate=!0,h.flipY=!1,s=new u.VolumetricMaterial({transferfn:h,transfermin:this.min,transfermax:this.max,map:l,extent:this.extent,maxdepth:this.maxdepth,texmatrix:this.texmatrix,unit:this.minunit,subsamples:this.subsamples});var E=new u.Mesh(this.geo,s);this.shapeObj.add(E),this.renderedShapeObj=this.shapeObj.clone(),i.add(this.renderedShapeObj)}}removegl(i){this.renderedShapeObj&&(this.renderedShapeObj.geometry!==void 0&&this.renderedShapeObj.geometry.dispose(),this.renderedShapeObj.material!==void 0&&this.renderedShapeObj.material.dispose(),i.remove(this.renderedShapeObj),this.renderedShapeObj=null),this.shapeObj=null}get position(){return this.boundingSphere.center}get x(){return this.boundingSphere.center.x}get y(){return this.boundingSphere.center.y}get z(){return this.boundingSphere.center.z}}const Ot=16;class gr extends Array{constructor(i){super(...i)}getSymmetries(){if(this.length==0)return[];let i=this[0];return i.symmetries===void 0&&this.setSymmetries([new m.Matrix4]),i.symmetries}setSymmetries(i){i===void 0&&(i=[new m.Matrix4]);for(let s of this)s.symmetries=i,s.finished=!1}}class Zt{getWidth(){let i=this.container,s=i.offsetWidth;if(s==0&&i.style.display==="none"){let l=i.style.position,h=i.style.visibility;i.style.display="block",i.style.visibility="hidden",i.style.position="absolute",s=i.offsetWidth,i.style.display="none",i.style.visibility=h,i.style.position=l}return s}getHeight(){let i=this.container,s=i.offsetHeight;if(s==0&&i.style.display==="none"){let l=i.style.position,h=i.style.visibility;i.style.display="block",i.style.visibility="hidden",i.style.position="absolute",s=i.offsetHeight,i.style.display="none",i.style.visibility=h,i.style.position=l}return s}setupRenderer(){let i=Object.assign(Object.assign({},this.config),{preserveDrawingBuffer:!0,premultipliedAlpha:!1,containerWidth:this.WIDTH,containerHeight:this.HEIGHT});this.renderer=new u.Renderer(i),this.renderer.domElement.style.width="100%",this.renderer.domElement.style.height="100%",this.renderer.domElement.style.padding="0",this.renderer.domElement.style.position="absolute",this.renderer.domElement.style.top="0px",this.renderer.domElement.style.left="0px",this.renderer.domElement.style.zIndex="0"}initializeScene(){this.scene=new u.Scene,this.scene.fog=new u.Fog(this.bgColor,100,200),this.modelGroup=new u.Object3D,this.rotationGroup=new u.Object3D,this.rotationGroup.useQuaternion=!0,this.rotationGroup.quaternion=new m.Quaternion(0,0,0,1),this.rotationGroup.add(this.modelGroup),this.scene.add(this.rotationGroup);var i=new u.Light(16777215);i.position=new m.Vector3(.2,.2,1).normalize(),i.intensity=1,this.scene.add(i)}_handleLostContext(i){const s=function(l){const h=l.getBoundingClientRect();return!(h.right<0||h.bottom<0||h.top>(window.innerHeight||document.documentElement.clientHeight)||h.left>(window.innerWidth||document.documentElement.clientWidth))};if(s(this.container)){let l=0;for(let h of document.getElementsByTagName("canvas"))if(s(h)&&h._3dmol_viewer!=null&&(h._3dmol_viewer.resize(),l+=1,l>=Ot))break}}initContainer(i){this.container=i,this.WIDTH=this.getWidth(),this.HEIGHT=this.getHeight(),this.ASPECT=this.renderer.getAspect(this.WIDTH,this.HEIGHT),this.renderer.setSize(this.WIDTH,this.HEIGHT),this.container.append(this.renderer.domElement),this.glDOM=this.renderer.domElement,this.glDOM._3dmol_viewer=this,this.glDOM.addEventListener("webglcontextlost",this._handleLostContext.bind(this)),this.nomouse||(this.glDOM.addEventListener("mousedown",this._handleMouseDown.bind(this),{passive:!1}),this.glDOM.addEventListener("touchstart",this._handleMouseDown.bind(this),{passive:!1}),this.glDOM.addEventListener("wheel",this._handleMouseScroll.bind(this),{passive:!1}),this.glDOM.addEventListener("mousemove",this._handleMouseMove.bind(this),{passive:!1}),this.glDOM.addEventListener("touchmove",this._handleMouseMove.bind(this),{passive:!1}),this.glDOM.addEventListener("contextmenu",this._handleContextMenu.bind(this),{passive:!1}))}decAnim(){this.animated--,this.animated<0&&(this.animated=0)}incAnim(){this.animated++}nextSurfID(){var i=0;for(let l in this.surfaces)if(this.surfaces.hasOwnProperty(l)){var s=parseInt(l);isNaN(s)||s>i&&(i=s)}return i+1}setSlabAndFog(){let i=this.camera.position.z-this.rotationGroup.position.z;i<1&&(i=1),this.camera.near=i+this.slabNear,!this.camera.ortho&&this.camera.near<1&&(this.camera.near=1),this.camera.far=i+this.slabFar,this.camera.near+1>this.camera.far&&(this.camera.far=this.camera.near+1),this.camera.fov=this.fov,this.camera.right=i*Math.tan(Math.PI/180*this.fov),this.camera.left=-this.camera.right,this.camera.top=this.camera.right/this.ASPECT,this.camera.bottom=-this.camera.top,this.camera.updateProjectionMatrix(),this.scene.fog.near=this.camera.near+this.fogStart*(this.camera.far-this.camera.near),this.scene.fog.far=this.camera.near+this.fogEnd*(this.camera.far-this.camera.near),this.config.disableFog&&(this.scene.fog.near=this.scene.fog.far)}show(i){if(this.renderer.setViewport(),this.scene&&(this.setSlabAndFog(),this.renderer.render(this.scene,this.camera),this.viewChangeCallback&&this.viewChangeCallback(this._viewer.getView()),!i&&this.linkedViewers.length>0))for(var s=this._viewer.getView(),l=0;l<this.linkedViewers.length;l++)this.linkedViewers[l].setView(s,!0)}updateClickables(){this.clickables.splice(0,this.clickables.length),this.hoverables.splice(0,this.hoverables.length),this.contextMenuEnabledObjects.splice(0,this.contextMenuEnabledObjects.length);for(let i=0,s=this.models.length;i<s;i++){let l=this.models[i];if(l){let h=l.selectedAtoms({clickable:!0}),E=l.selectedAtoms({hoverable:!0}),g=l.selectedAtoms({contextMenuEnabled:!0});for(let A=0;A<E.length;A++)this.hoverables.push(E[A]);for(let A=0;A<h.length;A++)this.clickables.push(h[A]);for(let A=0;A<g.length;A++)this.contextMenuEnabledObjects.push(g[A])}}for(let i=0,s=this.shapes.length;i<s;i++){let l=this.shapes[i];l&&l.clickable&&this.clickables.push(l),l&&l.hoverable&&this.hoverables.push(l),l&&l.contextMenuEnabled&&this.contextMenuEnabledObjects.push(l)}}handleClickSelection(i,s,l){let h=this.targetedObjects(i,s,this.clickables);if(h.length){var E=h[0].clickable;E.callback!==void 0&&(typeof E.callback!="function"&&(E.callback=(0,x.makeFunction)(E.callback)),typeof E.callback=="function")&&(this.mouseButton===3&&this.contextMenuEnabledObjects.includes(E)&&this.userContextMenuHandler||E.callback(E,this._viewer,l,this.container,h))}}canvasOffset(){let i=this.glDOM,s=i.getBoundingClientRect(),l=i.ownerDocument,h=l.documentElement,E=l.defaultView;return{top:s.top+E.pageYOffset-h.clientTop,left:s.left+E.pageXOffset-h.clientLeft}}setHover(i,s,l){this.current_hover!=i&&(this.current_hover&&(typeof this.current_hover.unhover_callback!="function"&&(this.current_hover.unhover_callback=(0,x.makeFunction)(this.current_hover.unhover_callback)),this.current_hover.unhover_callback(this.current_hover,this._viewer,s,this.container,l)),this.current_hover=i,i&&i.hover_callback!==void 0&&(typeof i.hover_callback!="function"&&(i.hover_callback=(0,x.makeFunction)(i.hover_callback)),typeof i.hover_callback=="function"&&i.hover_callback(i,this._viewer,s,this.container,l)))}handleHoverSelection(i,s,l){if(this.hoverables.length==0)return;let h=this.targetedObjects(i,s,this.hoverables);if(h.length){var E=h[0].clickable;this.setHover(E,l,h),this.current_hover=E}else this.setHover(null)}handleHoverContinue(i,s){let l=this.targetedObjects(i,s,this.hoverables);l.length!=0&&l[0]!==void 0||this.setHover(null),l[0]!==void 0&&l[0].clickable!==this.current_hover&&this.setHover(null)}closeEnoughForClick(i,{allowTolerance:s=i.targetTouches,tolerance:l=5}={}){const h=this.getX(i),E=this.getY(i);if(s){const g=Math.abs(h-this.mouseStartX),A=Math.abs(E-this.mouseStartY);return g<=l&&A<=l}return h===this.mouseStartX&&E===this.mouseStartY}calcTouchDistance(i){var s=i.targetTouches[0].pageX-i.targetTouches[1].pageX,l=i.targetTouches[0].pageY-i.targetTouches[1].pageY;return Math.hypot(s,l)}getX(i){var s=i.pageX;return s==null&&(s=i.pageX),i.targetTouches&&i.targetTouches[0]?s=i.targetTouches[0].pageX:i.changedTouches&&i.changedTouches[0]&&(s=i.changedTouches[0].pageX),s}getY(i){var s=i.pageY;return s==null&&(s=i.pageY),i.targetTouches&&i.targetTouches[0]?s=i.targetTouches[0].pageY:i.changedTouches&&i.changedTouches[0]&&(s=i.changedTouches[0].pageY),s}isInViewer(i,s){if(this.viewers!=null){var l=this.WIDTH/this.cols,h=this.HEIGHT/this.rows,E=this.canvasOffset(),g=i-E.left,A=s-E.top,M=this.rows-Math.floor(A/h)-1,S=Math.floor(g/l);if(M!=this.row||S!=this.col)return!1}return!0}adjustZoomToLimits(i){if(this.config.lowerZoomLimit&&this.config.lowerZoomLimit>0){let s=this.CAMERA_Z-this.config.lowerZoomLimit;i>s&&(i=s)}if(this.config.upperZoomLimit&&this.config.upperZoomLimit>0){let s=this.CAMERA_Z-this.config.upperZoomLimit;i<s&&(i=s)}return i>this.CAMERA_Z-1&&(i=this.CAMERA_Z-1),i}static slerp(i,s,l){if(l==1)return s.clone();if(l==0)return i.clone();let h=i.x*s.x+i.y*s.y+i.z*s.z+i.w*s.w;if(h>.9995){let P=new m.Quaternion(i.x+l*(s.x-i.x),i.y+l*(s.y-i.y),i.z+l*(s.z-i.z),i.w+l*(s.w-i.w));return P.normalize(),P}h<0&&(s=s.clone().multiplyScalar(-1),h=-h),h>1?h=1:h<-1&&(h=-1);var E=Math.acos(h)*l,g=s.clone();g.sub(i.clone().multiplyScalar(h)),g.normalize();var A=Math.cos(E),M=Math.sin(E),S=new m.Quaternion(i.x*A+g.x*M,i.y*A+g.y*M,i.z*A+g.z*M,i.w*A+g.w*M);return S.normalize(),S}constructor(i,s={}){if(this.nomouse=!1,this.glDOM=null,this.models=[],this.surfaces={},this.shapes=[],this.labels=[],this.clickables=[],this.hoverables=[],this.contextMenuEnabledObjects=[],this.current_hover=null,this.hoverDuration=500,this.longTouchDuration=1e3,this.viewer_frame=0,this.viewChangeCallback=null,this.stateChangeCallback=null,this.NEAR=1,this.FAR=800,this.CAMERA_Z=150,this.fov=20,this.linkedViewers=[],this.renderer=null,this.control_all=!1,this.scene=null,this.rotationGroup=null,this.modelGroup=null,this.fogStart=.4,this.fogEnd=1,this.slabNear=-50,this.slabFar=50,this.cq=new m.Quaternion(0,0,0,1),this.dq=new m.Quaternion(0,0,0,1),this.animated=0,this.animationTimers=new Set,this.isDragging=!1,this.mouseStartX=0,this.mouseStartY=0,this.touchDistanceStart=0,this.touchHold=!1,this.currentModelPos=0,this.cz=0,this.cslabNear=0,this.cslabFar=0,this.userContextMenuHandler=null,this.config=s,this.callback=this.config.callback,this.defaultcolors=this.config.defaultcolors,this.defaultcolors||(this.defaultcolors=b.elementColors.defaultColors),this.nomouse=!!this.config.nomouse,this.bgColor=0,this.config.backgroundColor=this.config.backgroundColor||"#ffffff",this.config.backgroundColor!==void 0&&(this.bgColor=b.CC.color(this.config.backgroundColor).getHex()),this.config.backgroundAlpha=this.config.backgroundAlpha==null?1:this.config.backgroundAlpha,this.camerax=0,this.config.camerax!==void 0&&(this.camerax=typeof this.config.camerax=="string"?parseFloat(this.config.camerax):this.config.camerax),this._viewer=this,this.container=i,this.config.hoverDuration!=null&&(this.hoverDuration=this.config.hoverDuration),this.config.antialias===void 0&&(this.config.antialias=!0),this.config.cartoonQuality===void 0&&(this.config.cartoonQuality=10),this.WIDTH=this.getWidth(),this.HEIGHT=this.getHeight(),this.setupRenderer(),this.row=this.config.row==null?0:this.config.row,this.col=this.config.col==null?0:this.config.col,this.cols=this.config.cols,this.rows=this.config.rows,this.viewers=this.config.viewers,this.control_all=this.config.control_all,this.ASPECT=this.renderer.getAspect(this.WIDTH,this.HEIGHT),this.camera=new u.Camera(this.fov,this.ASPECT,this.NEAR,this.FAR,this.config.orthographic),this.camera.position=new m.Vector3(this.camerax,0,this.CAMERA_Z),this.lookingAt=new m.Vector3,this.camera.lookAt(this.lookingAt),this.raycaster=new u.Raycaster(new m.Vector3(0,0,0),new m.Vector3(0,0,0)),this.projector=new u.Projector,this.initializeScene(),this.renderer.setClearColorHex(this.bgColor,this.config.backgroundAlpha),this.scene.fog.color=b.CC.color(this.bgColor),document.body.addEventListener("mouseup",this._handleMouseUp.bind(this)),document.body.addEventListener("touchend",this._handleMouseUp.bind(this)),this.initContainer(this.container),this.config.style&&this.setViewStyle(this.config),window.addEventListener("resize",this.resize.bind(this)),window.ResizeObserver!==void 0&&(this.divwatcher=new window.ResizeObserver(this.resize.bind(this)),this.divwatcher.observe(this.container)),window.IntersectionObserver!==void 0){let l=(h,E)=>{h.forEach(g=>{g.isIntersecting&&this.resize()})};this.intwatcher=new window.IntersectionObserver(l),this.intwatcher.observe(this.container)}try{typeof this.callback=="function"&&this.callback(this)}catch(l){console.log("error with glviewer callback: "+l)}}targetedObjects(i,s,l){var h={x:i,y:s,z:-1};return Array.isArray(l)||(l=this.selectedAtoms(l)),l.length==0?[]:(this.raycaster.setFromCamera(h,this.camera),this.raycaster.intersectObjects(this.modelGroup,l))}modelToScreen(i){let s=!1;Array.isArray(i)||(i=[i],s=!0);let l=this.renderer.getXRatio(),h=this.renderer.getYRatio(),E=this.col,g=this.row,A=E*(this.WIDTH/l),M=(h-g-1)*(this.HEIGHT/h),S=[],P=this.canvasOffset();return i.forEach(L=>{let X=new m.Vector3(L.x,L.y,L.z);X.applyMatrix4(this.modelGroup.matrixWorld),this.projector.projectVector(X,this.camera);let U=this.WIDTH/l*(X.x+1)/2+P.left+A,j=-this.HEIGHT/h*(X.y-1)/2+P.top+M;S.push({x:U,y:j})}),s&&(S=S[0]),S}screenOffsetToModel(i,s,l){var h=i/this.WIDTH,E=s/this.HEIGHT,g=l===void 0?this.rotationGroup.position.z:l,A=this.rotationGroup.quaternion,M=new m.Vector3(0,0,g);return this.projector.projectVector(M,this.camera),M.x+=2*h,M.y-=2*E,this.projector.unprojectVector(M,this.camera),M.z=0,M.applyQuaternion(A),M}screenToModelDistance(i,s){let l=this.canvasOffset(),h=new m.Vector3(s.x,s.y,s.z);h.applyMatrix4(this.modelGroup.matrixWorld);let E=h.clone();this.projector.projectVector(h,this.camera);let g=new m.Vector3(2*(i.x-l.left)/this.WIDTH-1,2*(i.y-l.top)/-this.HEIGHT+1,h.z);return this.projector.unprojectVector(g,this.camera),g.distanceTo(E)}setViewChangeCallback(i){typeof i!="function"&&i!=null||(this.viewChangeCallback=i)}setStateChangeCallback(i){typeof i!="function"&&i!=null||(this.stateChangeCallback=i)}getConfig(){return this.config}setConfig(i){this.config=i,i.ambientOcclusion&&this.renderer.enableAmbientOcclusion(i.ambientOcclusion)}getInternalState(){var i={models:[],surfaces:[],shapes:[],labels:[]};for(let s=0;s<this.models.length;s++)this.models[s]&&(i.models[s]=this.models[s].getInternalState());return i}setInternalState(i){this.clear();var s=i.models;for(let l=0;l<s.length;l++)s[l]&&(this.models[l]=new ur(l,void 0,this),this.models[l].setInternalState(s[l]));this.render()}setZoomLimits(i,s){i!==void 0&&(this.config.lowerZoomLimit=i),s&&(this.config.upperZoomLimit=s),this.rotationGroup.position.z=this.adjustZoomToLimits(this.rotationGroup.position.z),this.show()}setCameraParameters(i){i.fov!==void 0&&(this.fov=i.fov,this.camera.fov=this.fov),i.z!==void 0&&(this.CAMERA_Z=i.z,this.camera.z=this.CAMERA_Z),i.orthographic!==void 0&&(this.camera.ortho=i.orthographic),this.setSlabAndFog()}_handleMouseDown(i){if(i.preventDefault(),!this.scene)return;var s=this.getX(i),l=this.getY(i);if(s===void 0)return;this.isDragging=!0,this.mouseButton=i.which,this.mouseStartX=s,this.mouseStartY=l,this.touchHold=!0,this.touchDistanceStart=0,i.targetTouches&&i.targetTouches.length==2&&(this.touchDistanceStart=this.calcTouchDistance(i)),this.cq=this.rotationGroup.quaternion.clone(),this.cz=this.rotationGroup.position.z,this.currentModelPos=this.modelGroup.position.clone(),this.cslabNear=this.slabNear,this.cslabFar=this.slabFar;let h=this;i.targetTouches&&i.targetTouches.length===1&&(this.longTouchTimeout=setTimeout(function(){if(h.touchHold==1){h.glDOM=h.renderer.domElement;const E=i.targetTouches[0],g=new PointerEvent("contextmenu",Object.assign(Object.assign({},i),{pageX:E.pageX,pageY:E.pageY,screenX:E.screenX,screenY:E.screenY,clientX:E.clientX,clientY:E.clientY}));h.glDOM.dispatchEvent(g)}},this.longTouchDuration))}_handleMouseUp(i){if(this.touchHold=!1,this.isDragging&&this.scene){var s=this.getX(i),l=this.getY(i);if(this.closeEnoughForClick(i)&&this.isInViewer(s,l)){let h=this.mouseXY(s,l);this.handleClickSelection(h.x,h.y,i)}}this.isDragging=!1}_handleMouseScroll(i){if(i.preventDefault(),this.scene){var s=this.getX(i),l=this.getY(i);if(s!==void 0&&(this.control_all||this.isInViewer(s,l))){var h=.85*(this.CAMERA_Z-this.rotationGroup.position.z),E=1;if(i.ctrlKey&&(E=-1),i.detail)this.rotationGroup.position.z+=E*h*i.detail/10;else if(i.wheelDelta){let g=600*i.wheelDelta/(i.wheelDelta+600);this.rotationGroup.position.z-=E*h*g/400}this.rotationGroup.position.z=this.adjustZoomToLimits(this.rotationGroup.position.z),this.show()}}}pngURI(){return this.getCanvas().toDataURL("image/png")}apngURI(i){let s=this;return i=i||1,new Promise(function(l){let h=0,E=s.viewChangeCallback,g=[],A=[],M=Date.now();s.viewChangeCallback=function(){A.push(Date.now()-M),M=Date.now(),g.push(new Promise(S=>{s.getCanvas().toBlob(function(P){P.arrayBuffer().then(S)},"image/png")})),h+=1,h==i&&(s.viewChangeCallback=E,Promise.all(g).then(S=>{let P=[];for(let G=0;G<S.length;G++){let Z=(0,R.decode)(S[G]);P.push((0,R.toRGBA8)(Z)[0])}let L=s.getCanvas().width,X=s.getCanvas().height,U=(0,R.encode)(P,L,X,0,A),j=new Blob([U],{type:"image/png"}),W=new FileReader;W.onload=function(G){l(G.target.result)},W.readAsDataURL(j)}))}})}getCanvas(){return this.glDOM}getRenderer(){return this.renderer}setHoverDuration(i){this.hoverDuration=i}mouseXY(i,s){let l=this.canvasOffset(),h=this.renderer.getXRatio(),E=this.renderer.getYRatio(),g=this.col,A=this.row,M=g*(this.WIDTH/h),S=(E-A-1)*(this.HEIGHT/E);return{x:(i-l.left-M)/(this.WIDTH/h)*2-1,y:-(s-l.top-S)/(this.HEIGHT/E)*2+1}}_handleMouseMove(i){clearTimeout(this.hoverTimeout),i.preventDefault();let s=this.getX(i),l=this.getY(i);if(s===void 0)return;let h=this.renderer.getXRatio(),E=this.renderer.getYRatio(),g=this.mouseXY(s,l),A=this;this.current_hover!==null&&this.handleHoverContinue(g.x,g.y);var M=0;if((this.control_all||this.isInViewer(s,l))&&this.scene&&(this.hoverables.length>0&&(this.hoverTimeout=setTimeout(function(){A.handleHoverSelection(g.x,g.y,i)},this.hoverDuration)),this.isDragging)){i.targetTouches&&(i.targetTouches.length>1||i.targetTouches.length===1&&!this.closeEnoughForClick(i))&&clearTimeout(this.longTouchTimeout);var S=(s-this.mouseStartX)/this.WIDTH,P=(l-this.mouseStartY)/this.HEIGHT;this.touchDistanceStart!=0&&i.targetTouches&&i.targetTouches.length==2?(M=2,P=2*(this.calcTouchDistance(i)-this.touchDistanceStart)/(this.WIDTH+this.HEIGHT)):i.targetTouches&&i.targetTouches.length==3&&(M=1),S*=h,P*=E;var L,X=Math.hypot(S,P);if(M==3||this.mouseButton==3&&i.ctrlKey)this.slabNear=this.cslabNear+100*S,this.slabFar=this.cslabFar-100*P;else if(M==2||this.mouseButton==3||i.shiftKey)(L=.85*(this.CAMERA_Z-this.rotationGroup.position.z))<80&&(L=80),this.rotationGroup.position.z=this.cz+P*L,this.rotationGroup.position.z=this.adjustZoomToLimits(this.rotationGroup.position.z);else if(M==1||this.mouseButton==2||i.ctrlKey){var U=this.screenOffsetToModel(h*(s-this.mouseStartX),E*(l-this.mouseStartY));this.modelGroup.position.addVectors(this.currentModelPos,U)}else if((M===0||this.mouseButton==1)&&X!==0){var j=Math.sin(X*Math.PI)/X;this.dq.x=Math.cos(X*Math.PI),this.dq.y=0,this.dq.z=j*S,this.dq.w=-j*P,this.rotationGroup.quaternion.set(1,0,0,0),this.rotationGroup.quaternion.multiply(this.dq),this.rotationGroup.quaternion.multiply(this.cq)}this.show()}}_handleContextMenu(i){if(i.preventDefault(),this.closeEnoughForClick(i)){var s=this.mouseStartX,l=this.mouseStartY,h=this.canvasOffset();let g=this.mouseXY(s,l),A=g.x,M=g.y,S=this.targetedObjects(A,M,this.contextMenuEnabledObjects);var E=null;S.length&&(E=S[0].clickable),h=this.canvasOffset(),s=this.mouseStartX-h.left,l=this.mouseStartY-h.top,this.userContextMenuHandler&&(this.userContextMenuHandler(E,s,l,S,i),this.isDragging=!1)}}setContainer(i){let s=(0,x.getElement)(i)||this.container;return this.initContainer(s),this}setBackgroundColor(i,s){(s===void 0||s<0||s>1)&&(s=1);var l=b.CC.color(i);return this.scene.fog.color=l,this.bgColor=l.getHex(),this.renderer.setClearColorHex(l.getHex(),s),this.show(),this}setProjection(i){this.camera.ortho=i==="orthographic",this.setSlabAndFog()}setViewStyle(i){if((i=i||{}).style=i.style||"",i.style.includes("outline")?this.renderer.enableOutline(i):this.renderer.disableOutline(),i.style.includes("ambientOcclusion")){var s={};i.strength&&(s.strength=i.strength),i.radius&&(s.radius=i.radius),this.renderer.enableAmbientOcclusion(s)}else this.renderer.disableAmbientOcclusion();return this}updateSize(){this.renderer.setSize(this.WIDTH,this.HEIGHT),this.ASPECT=this.renderer.getAspect(this.WIDTH,this.HEIGHT),this.renderer.setSize(this.WIDTH,this.HEIGHT),this.camera.aspect=this.ASPECT,this.camera.updateProjectionMatrix()}setWidth(i){return this.WIDTH=i||this.WIDTH,this.updateSize(),this}setHeight(i){return this.HEIGHT=i||this.HEIGHT,this.updateSize(),this}resize(){this.WIDTH=this.getWidth(),this.HEIGHT=this.getHeight();let i=!1;if(this.renderer.isLost()&&this.WIDTH>0&&this.HEIGHT>0){let s=!1,l=this.container.querySelector("canvas");l&&l!=this.renderer.getCanvas()?this.config.canvas=l:(l.remove(),this.config&&this.config.canvas!=null&&(delete this.config.canvas,s=!0)),this.setupRenderer(),this.initContainer(this.container),this.renderer.setClearColorHex(this.bgColor,this.config.backgroundAlpha),i=!0,s&&(this.config.canvas=this.renderer.getCanvas())}if(this.WIDTH==0||this.HEIGHT==0?this.animated&&this._viewer.pauseAnimate():this.animated&&this._viewer.resumeAnimate(),this.updateSize(),i){let s=this.renderer.supportedExtensions();if(s.regen=!0,this.viewers)for(let l=0,h=this.viewers.length;l<h;l++)for(let E=0,g=this.viewers[l].length;E<g;E++)this.viewers[l][E].render(null,s);this._viewer.render(null,s)}else this.WIDTH>0&&this.HEIGHT>0&&this.show();return this}getModel(i){return i===void 0?this.models.length==0?null:this.models[this.models.length-1]:i instanceof ur?i:i in this.models?this.models[i]:this.models.length==0?null:this.models[this.models.length-1]}spin(i,s=1,l=!1){if(clearInterval(this.spinInterval),i===void 0&&(i="y"),typeof i=="boolean"){if(!i)return;i="y"}Array.isArray(i)&&(i={x:i[0],y:i[1],z:i[2]});var h=this;this.spinInterval=setInterval(function(){!h.getCanvas().isConnected&&h.renderer.isLost()&&clearInterval(h.spinInterval),(!l||h.container.checkVisibility&&h.container.checkVisibility())&&h.rotate(1*s,i)},25)}animateMotion(i,s,l,h,E,g){var A=Math.ceil(i/20);A<1&&(A=1),this.incAnim();var M={mpos:this.modelGroup.position.clone(),rz:this.rotationGroup.position.z,rot:this.rotationGroup.quaternion.clone(),cam:this.lookingAt.clone()};if(s){let L=new Array(A);for(let W=0;W<A;W++){let G=(W+1)/A,Z={mpos:M.mpos,rz:M.rz,rot:M.rot};Z.mpos=l.clone().sub(M.mpos).multiplyScalar(G).add(M.mpos),Z.rz=M.rz+G*(h-M.rz),Z.rot=Zt.slerp(M.rot,E,G),Z.cam=g.clone().sub(M.cam).multiplyScalar(G).add(M.cam),L[W]=Z}let X=0,U=this,j=function(){var W=L[X];X+=1,U.modelGroup.position=W.mpos,U.rotationGroup.position.z=W.rz,U.rotationGroup.quaternion=W.rot,U.camera.lookAt(W.cam),X<L.length?setTimeout(j,20):U.decAnim(),U.show()};setTimeout(j,20)}else{var S={};let L=1/A;if(l&&(S.mpos=l.clone().sub(M.mpos).multiplyScalar(L)),h!==void 0&&h!=null&&(S.rz=L*(h-M.rz)),E){var P=Zt.slerp(M.rot,E,L);S.rot=M.rot.clone().inverse().multiply(P)}g&&(S.cam=g.clone().sub(M.cam).multiplyScalar(L));let X=0,U=this,j=function(){X+=1,S.mpos&&U.modelGroup.position.add(S.mpos),S.rz&&(U.rotationGroup.position.z+=S.rz),S.rot&&U.rotationGroup.quaternion.multiply(S.rot),S.cam&&(U.lookingAt.add(S.cam),U.camera.lookAt(U.lookingAt)),X<A?setTimeout(j,20):U.decAnim(),U.show()};setTimeout(j,20)}}rotate(i,s="y",l=0,h=!1){if(s=="x"?s={x:1,y:0,z:0}:s=="y"?s={x:0,y:1,z:0}:s=="z"&&(s={x:0,y:0,z:1}),s=="vx"?s={vx:1,vy:0,vz:0}:s=="vy"?s={vx:0,vy:1,vz:0}:s=="vz"&&(s={vx:0,vy:0,vz:1}),s.vx!==void 0){var E=new m.Vector3(s.vx,s.vy,s.vz);E.applyQuaternion(this.rotationGroup.quaternion),s={x:E.x,y:E.y,z:E.z}}var g=(function(M){var S,P,L,X=Math.sin(M/2),U=Math.cos(M/2);return S=s.x*X,P=s.y*X,L=s.z*X,new m.Quaternion(S,P,L,U).normalize()})(Math.PI*i/180);if(l){var A=new m.Quaternion().copy(this.rotationGroup.quaternion).multiply(g);this.animateMotion(l,h,this.modelGroup.position,this.rotationGroup.position.z,A,this.lookingAt)}else this.rotationGroup.quaternion.multiply(g),this.show();return this}surfacesFinished(){for(var i in this.surfaces)if(!this.surfaces[i][0].done)return!1;return!0}getView(){if(!this.modelGroup)return[0,0,0,0,0,0,0,1];var i=this.modelGroup.position,s=this.rotationGroup.quaternion;return[i.x,i.y,i.z,this.rotationGroup.position.z,s.x,s.y,s.z,s.w]}setView(i,s){return i!==void 0&&(i instanceof Array||i.length!==8)&&this.modelGroup&&this.rotationGroup?(this.modelGroup.position.x=i[0],this.modelGroup.position.y=i[1],this.modelGroup.position.z=i[2],this.rotationGroup.position.z=i[3],this.rotationGroup.quaternion.x=i[4],this.rotationGroup.quaternion.y=i[5],this.rotationGroup.quaternion.z=i[6],this.rotationGroup.quaternion.w=i[7],i[8]!==void 0&&(this.rotationGroup.position.x=i[8],this.rotationGroup.position.y=i[9]),this.show(s),this):this}render(i,s){this.renderer.setViewport(),this.updateClickables();var l,h,E=this.getView();for(this.stateChangeCallback&&this.stateChangeCallback(this.getInternalState()),s||(s=this.renderer.supportedExtensions()),l=0;l<this.models.length;l++)this.models[l]&&this.models[l].globj(this.modelGroup,s);for(l=0;l<this.shapes.length;l++)this.shapes[l]&&(this.shapes[l].frame===void 0||this.viewer_frame<0||this.shapes[l].frame<0||this.shapes[l].frame==this.viewer_frame?this.shapes[l].globj(this.modelGroup,s):this.shapes[l].removegl(this.modelGroup));for(l=0;l<this.labels.length;l++)s.regen&&(this.labels[l].dispose(),this.modelGroup.remove(this.labels[l].sprite),this.labels[l].setContext(),this.modelGroup.add(this.labels[l].sprite)),this.labels[l]&&this.labels[l].frame!==void 0&&this.labels[l].frame>=0&&(this.modelGroup.remove(this.labels[l].sprite),(this.viewer_frame<0||this.labels[l].frame==this.viewer_frame)&&this.modelGroup.add(this.labels[l].sprite));for(l in this.surfaces)if(this.surfaces.hasOwnProperty(l)){var g=this.surfaces[l];for(h=0;h<g.length;h++)if(g.hasOwnProperty(h)){var A=g[h].geo;if(!g[h].finished||s.regen){A.verticesNeedUpdate=!0,A.elementsNeedUpdate=!0,A.normalsNeedUpdate=!0,A.colorsNeedUpdate=!0,A.buffersNeedUpdate=!0,g[h].mat.needsUpdate=!0,g[h].done&&(g[h].finished=!0),g[h].lastGL&&this.modelGroup.remove(g[h].lastGL);var M=null;if(g[h].mat instanceof u.LineBasicMaterial?M=new u.Line(A,g[h].mat):("wireframe"in g.style&&g.style.wireframe&&A.setUpWireframe(),M=new u.Mesh(A,g[h].mat)),g[h].mat.transparent&&g[h].mat.opacity==0?M.visible=!1:M.visible=!0,g[h].symmetries.length>1||g[h].symmetries.length==1&&!g[h].symmetries[0].isIdentity()){var S,P=new u.Object3D;for(S=0;S<g[h].symmetries.length;S++){var L=M.clone();L.matrix=g[h].symmetries[S],L.matrixAutoUpdate=!1,P.add(L)}g[h].lastGL=P,this.modelGroup.add(P)}else g[h].lastGL=M,this.modelGroup.add(M)}}}return this.setView(E),typeof i=="function"&&i(this),this}getModelList(i){let s=[];if(i===void 0||i.model===void 0)for(let h=0;h<this.models.length;h++)this.models[h]&&s.push(this.models[h]);else{let h=i.model;Array.isArray(h)||(h=[h]);for(let E=0;E<h.length;E++)if(typeof h[E]=="number"){var l=h[E];l<0&&(l+=this.models.length),s.push(this.models[l])}else s.push(h[E])}return s}getAtomsFromSel(i){var s=[];i===void 0&&(i={});var l=this.getModelList(i);for(let h=0;h<l.length;h++)s=s.concat(l[h].selectedAtoms(i));return s}atomIsSelected(i,s){s===void 0&&(s={});for(var l=this.getModelList(s),h=0;h<l.length;h++)if(l[h].atomIsSelected(i,s))return!0;return!1}selectedAtoms(i){return this.getAtomsFromSel(i)}getUniqueValues(i,s){s===void 0&&(s={});var l=this.getAtomsFromSel(s),h={};for(var E in l)l[E].hasOwnProperty(i)&&(h[l[E][i]]=!0);return Object.keys(h)}pdbData(i){for(var s=this.getAtomsFromSel(i),l="",h=0,E=s.length;h<E;++h)l+=s[h].pdbline+`
`;return l}zoom(i=2,s=0,l=!1){var h=(this.CAMERA_Z-this.rotationGroup.position.z)/i,E=this.CAMERA_Z-h;return s>0?this.animateMotion(s,l,this.modelGroup.position,this.adjustZoomToLimits(E),this.rotationGroup.quaternion,this.lookingAt):(this.rotationGroup.position.z=this.adjustZoomToLimits(E),this.show()),this}translate(i,s,l=0,h=!1){var E=i/this.WIDTH,g=s/this.HEIGHT,A=new m.Vector3(0,0,-this.CAMERA_Z);this.projector.projectVector(A,this.camera),A.x-=E,A.y-=g,this.projector.unprojectVector(A,this.camera),A.z=0;var M=this.lookingAt.clone().add(A);return l>0?this.animateMotion(l,h,this.modelGroup.position,this.rotationGroup.position.z,this.rotationGroup.quaternion,M):(this.lookingAt=M,this.camera.lookAt(this.lookingAt),this.show()),this}translateScene(i,s,l=0,h=!1){var E=this.screenOffsetToModel(i,s),g=this.modelGroup.position.clone().add(E);return l>0?this.animateMotion(l,h,this.modelGroup.position,this.rotationGroup.position.z,this.rotationGroup.quaternion,this.lookingAt):(this.modelGroup.position=g,this.show()),this}fitSlab(i){i=i||{};var s=this.getAtomsFromSel(i),l=(0,x.getExtent)(s),h=l[1][0]-l[0][0],E=l[1][1]-l[0][1],g=l[1][2]-l[0][2],A=Math.hypot(h,E,g);return A<5&&(A=5),this.slabNear=-A/1.9,this.slabFar=A/2,this}center(i={},s=0,l=!1){var h,E,g=this.getAtomsFromSel(i),A=(0,x.getExtent)(g);(0,x.isEmptyObject)(i)?(this.shapes.forEach(Z=>{if(Z&&Z.boundingSphere&&Z.boundingSphere.center){var te=Z.boundingSphere.center,re=Z.boundingSphere.radius;re>0?(g.push(new m.Vector3(te.x+re,te.y,te.z)),g.push(new m.Vector3(te.x-re,te.y,te.z)),g.push(new m.Vector3(te.x,te.y+re,te.z)),g.push(new m.Vector3(te.x,te.y-re,te.z)),g.push(new m.Vector3(te.x,te.y,te.z+re)),g.push(new m.Vector3(te.x,te.y,te.z-re))):g.push(te)}}),A=(0,x.getExtent)(g),h=g,E=A):(h=this.getAtomsFromSel({}),E=(0,x.getExtent)(h));var M=new m.Vector3(A[2][0],A[2][1],A[2][2]),S=E[1][0]-E[0][0],P=E[1][1]-E[0][1],L=E[1][2]-E[0][2],X=Math.hypot(S,P,L);X<5&&(X=5),this.slabNear=-X/1.9,this.slabFar=X/2,S=A[1][0]-A[0][0],P=A[1][1]-A[0][1],L=A[1][2]-A[0][2],(X=Math.hypot(S,P,L))<5&&(X=5);for(var U=25,j=0;j<g.length;j++)if(g[j]){var W=M.distanceToSquared(g[j]);W>U&&(U=W)}X=2*Math.sqrt(U);var G=M.clone().multiplyScalar(-1);return s>0?this.animateMotion(s,l,G,this.rotationGroup.position.z,this.rotationGroup.quaternion,this.lookingAt):(this.modelGroup.position=G,this.show()),this}zoomTo(i={},s=0,l=!1){let h=this.getAtomsFromSel(i),E=(0,x.getExtent)(h),g=E;if((0,x.isEmptyObject)(i)){let te=h&&h.length;if(this.shapes.forEach(re=>{if(re&&re.boundingSphere){if(re.boundingSphere.box){let ye=re.boundingSphere.box;h.push(new m.Vector3(ye.min.x,ye.min.y,ye.min.z)),h.push(new m.Vector3(ye.max.x,ye.max.y,ye.max.z))}else if(re.boundingSphere.center){var de=re.boundingSphere.center,le=re.boundingSphere.radius;le>0?(h.push(new m.Vector3(de.x+le,de.y,de.z)),h.push(new m.Vector3(de.x-le,de.y,de.z)),h.push(new m.Vector3(de.x,de.y+le,de.z)),h.push(new m.Vector3(de.x,de.y-le,de.z)),h.push(new m.Vector3(de.x,de.y,de.z+le)),h.push(new m.Vector3(de.x,de.y,de.z-le))):h.push(de)}}}),g=(0,x.getExtent)(h),!te)for(let re=0;re<3;re++)E[2][re]=(g[0][re]+g[1][re])/2}else{let te=this.getAtomsFromSel({});g=(0,x.getExtent)(te)}var A=new m.Vector3(E[2][0],E[2][1],E[2][2]),M=g[1][0]-g[0][0],S=g[1][1]-g[0][1],P=g[1][2]-g[0][2],L=Math.hypot(M,S,P);L<5&&(L=5),this.slabNear=-L/1.9,this.slabFar=L/2,Object.keys(i).length===0&&(this.slabNear=Math.min(2*-L,-50),this.slabFar=Math.max(2*L,50));var X=this.config.minimumZoomToDistance||5;M=E[1][0]-E[0][0],S=E[1][1]-E[0][1],P=E[1][2]-E[0][2],(L=Math.hypot(M,S,P))<X&&(L=X);for(var U=X*X,j=0;j<h.length;j++)if(h[j]){var W=A.distanceToSquared(h[j]);W>U&&(U=W)}L=2*Math.sqrt(U);var G=A.clone().multiplyScalar(-1),Z=-(.5*L/Math.tan(Math.PI/180*this.camera.fov/2)-this.CAMERA_Z);return Z=this.adjustZoomToLimits(Z),s>0?this.animateMotion(s,l,G,Z,this.rotationGroup.quaternion,this.lookingAt):(this.modelGroup.position=G,this.rotationGroup.position.z=Z,this.show()),this}setSlab(i,s){this.slabNear=i,this.slabFar=s}getSlab(){return{near:this.slabNear,far:this.slabFar}}addLabel(i,s={},l,h=!1){if(l){var E=(0,x.getExtent)(this.getAtomsFromSel(l));s.position={x:E[2][0],y:E[2][1],z:E[2][2]}}var g=new Mt(i,s);return g.setContext(),this.modelGroup.add(g.sprite),this.labels.push(g),h||this.show(),g}addResLabels(i,s,l=!1){let h=this.labels.length;return this.applyToModels("addResLabels",i,s,l),this.show(),this.labels.slice(h)}addPropertyLabels(i,s,l){return this.applyToModels("addPropertyLabels",i,s,l),this.show(),this}removeLabel(i){for(var s=0;s<this.labels.length;s++)if(this.labels[s]==i){this.labels.splice(s,1),i.dispose(),this.modelGroup.remove(i.sprite);break}return this.show(),this}removeAllLabels(){for(var i=0;i<this.labels.length;i++)this.labels[i]&&this.labels[i].sprite&&this.modelGroup.remove(this.labels[i].sprite);return this.labels.splice(0,this.labels.length),this.show(),this}hideAllLabels(){for(var i=0;i<this.labels.length;i++)this.labels[i]&&this.labels[i].hide();return this.show(),this}showAllLabels(){for(var i=0;i<this.labels.length;i++)this.labels[i]&&this.labels[i].show();return this.show(),this}setLabelStyle(i,s){return this.modelGroup.remove(i.sprite),i.dispose(),i.stylespec=s,i.setContext(),this.modelGroup.add(i.sprite),this.show(),i}setLabelText(i,s){return this.modelGroup.remove(i.sprite),i.dispose(),i.text=s,i.setContext(),this.modelGroup.add(i.sprite),this.show(),i}addShape(i){var s=new Oe(i=i||{});return s.shapePosition=this.shapes.length,this.shapes.push(s),s}removeShape(i){if(!i)return this;for(i.removegl(this.modelGroup),delete this.shapes[i.shapePosition];this.shapes.length>0&&this.shapes[this.shapes.length-1]===void 0;)this.shapes.pop();return this}removeAllShapes(){for(var i=0;i<this.shapes.length;i++){var s=this.shapes[i];s&&s.removegl(this.modelGroup)}return this.shapes.splice(0,this.shapes.length),this}getSelectionCenter(i){if(i.hasOwnProperty("x")&&i.hasOwnProperty("y")&&i.hasOwnProperty("z"))return i;var s=this.getAtomsFromSel(i);if(s.length==0)return{x:0,y:0,z:0};var l=(0,x.getExtent)(s);return{x:l[0][0]+(l[1][0]-l[0][0])/2,y:l[0][1]+(l[1][1]-l[0][1])/2,z:l[0][2]+(l[1][2]-l[0][2])/2}}addSphere(i){(i=i||{}).center=this.getSelectionCenter(i.center);var s=new Oe(i);return s.shapePosition=this.shapes.length,s.addSphere(i),this.shapes.push(s),s.finalize(),s}addBox(i={}){i.corner!=null&&(i.corner=this.getSelectionCenter(i.corner)),i.center!=null&&(i.center=this.getSelectionCenter(i.center));var s=new Oe(i);return s.shapePosition=this.shapes.length,s.addBox(i),this.shapes.push(s),s.finalize(),s}addArrow(i={}){i.start=this.getSelectionCenter(i.start),i.end=this.getSelectionCenter(i.end);var s=new Oe(i);return s.shapePosition=this.shapes.length,s.addArrow(i),this.shapes.push(s),s.finalize(),s}addCylinder(i={}){i.start=this.getSelectionCenter(i.start),i.end=this.getSelectionCenter(i.end);var s=new Oe(i);return s.shapePosition=this.shapes.length,i.dashed?s.addDashedCylinder(i):s.addCylinder(i),this.shapes.push(s),s.finalize(),s}addCurve(i={}){var s=new Oe(i);return s.shapePosition=this.shapes.length,s.addCurve(i),this.shapes.push(s),s.finalize(),s}addLine(i={}){i.start=this.getSelectionCenter(i.start),i.end=this.getSelectionCenter(i.end),i.wireframe=!0;var s=new Oe(i);return s.shapePosition=this.shapes.length,i.dashed?s=this.addLineDashed(i,s):s.addLine(i),this.shapes.push(s),s.finalize(),s}addUnitCell(i,s){i=this.getModel(i),(s=s||{alabel:"a",blabel:"b",clabel:"c"}).box=s.box||{},s.astyle=s.astyle||{color:"red",radius:.1,midpos:-1},s.bstyle=s.bstyle||{color:"green",radius:.1,midpos:-1},s.cstyle=s.cstyle||{color:"blue",radius:.1,midpos:-1},s.alabelstyle=s.alabelstyle||{fontColor:"red",showBackground:!1,alignment:"center",inFront:!1},s.blabelstyle=s.blabelstyle||{fontColor:"green",showBackground:!1,alignment:"center",inFront:!1},s.clabelstyle=s.clabelstyle||{fontColor:"blue",showBackground:!1,alignment:"center",inFront:!1},i.unitCellObjects&&this.removeUnitCell(i),i.unitCellObjects={shapes:[],labels:[]};var l=i.getCrystData(),h=null;if(l){if(l.matrix)h=l.matrix;else{var E,g,A,M=l.a,S=l.b,P=l.c,L=l.alpha,X=l.beta,U=l.gamma;L=L*Math.PI/180,X=X*Math.PI/180,U=U*Math.PI/180,E=Math.cos(X),g=(Math.cos(L)-Math.cos(X)*Math.cos(U))/Math.sin(U),A=Math.sqrt(Math.max(0,1-E*E-g*g)),h=new m.Matrix3(M,S*Math.cos(U),P*E,0,S*Math.sin(U),P*g,0,0,P*A)}var j=[new m.Vector3(0,0,0),new m.Vector3(1,0,0),new m.Vector3(0,1,0),new m.Vector3(0,0,1),new m.Vector3(1,1,0),new m.Vector3(0,1,1),new m.Vector3(1,0,1),new m.Vector3(1,1,1)];if(l.matrix4)for(let G=0;G<j.length;G++)l.size&&j[G].multiplyVectors(j[G],l.size),j[G]=j[G].applyMatrix4(l.matrix4);else for(let G=0;G<j.length;G++)j[G]=j[G].applyMatrix3(h);if(s.box&&!s.box.hidden){s.box.wireframe=!0;var W=new Oe(s.box);W.shapePosition=this.shapes.length,W.addLine({start:j[0],end:j[1]}),W.addLine({start:j[0],end:j[2]}),W.addLine({start:j[1],end:j[4]}),W.addLine({start:j[2],end:j[4]}),W.addLine({start:j[0],end:j[3]}),W.addLine({start:j[3],end:j[5]}),W.addLine({start:j[2],end:j[5]}),W.addLine({start:j[1],end:j[6]}),W.addLine({start:j[4],end:j[7]}),W.addLine({start:j[6],end:j[7]}),W.addLine({start:j[3],end:j[6]}),W.addLine({start:j[5],end:j[7]}),this.shapes.push(W),i.unitCellObjects.shapes.push(W),W.finalize()}if(!s.astyle.hidden){s.astyle.start=j[0],s.astyle.end=j[1];let G=this.addArrow(s.astyle);i.unitCellObjects.shapes.push(G)}if(!s.bstyle.hidden){s.bstyle.start=j[0],s.bstyle.end=j[2];let G=this.addArrow(s.bstyle);i.unitCellObjects.shapes.push(G)}if(!s.cstyle.hidden){s.cstyle.start=j[0],s.cstyle.end=j[3];let G=this.addArrow(s.cstyle);i.unitCellObjects.shapes.push(G)}if(s.alabel){s.alabelstyle.position=j[1];let G=this.addLabel(s.alabel,s.alabelstyle);i.unitCellObjects.labels.push(G)}if(s.blabel){s.blabelstyle.position=j[2];let G=this.addLabel(s.blabel,s.blabelstyle);i.unitCellObjects.labels.push(G)}if(s.clabel){s.clabelstyle.position=j[3];let G=this.addLabel(s.clabel,s.clabelstyle);i.unitCellObjects.labels.push(G)}}}removeUnitCell(i){if((i=this.getModel(i)).unitCellObjects){let s=this;i.unitCellObjects.shapes.forEach(function(l){s.removeShape(l)}),i.unitCellObjects.labels.forEach(function(l){s.removeLabel(l)})}delete i.unitCellObjects}replicateUnitCell(i=3,s=i,l=s,h,E,g){let A=(h=this.getModel(h)).getCrystData();if(A){const M=h.selectedAtoms({}),S=A.matrix;let P=function(X){return X%2==0?-X/2:Math.ceil(X/2)};i<=1&&s<=1&&l<=1&&(g=!0,i=s=l=3);let L=function(X,U,j){return!1};if(g){const X=new m.Matrix3().getInverse3(S);L=function(U,j,W){let G=new m.Vector3(U,j,W).applyMatrix3(X);return!(G.x>-1e-4&&G.x<1.0001&&G.y>-1e-4&&G.y<1.0001&&G.z>-1e-4&&G.z<1.0001)}}for(let X=0;X<i;X++)for(let U=0;U<s;U++)for(let j=0;j<l;j++){if(X==0&&U==0&&j==0)continue;let W=new m.Vector3(P(X),P(U),P(j));W.applyMatrix3(S);let G=[];for(let Z=0;Z<M.length;Z++){let te=M[Z].x+W.x,re=M[Z].y+W.y,de=M[Z].z+W.z;if(L(te,re,de))continue;let le={};for(let ye in M[Z])le[ye]=M[Z][ye];le.x=te,le.y=re,le.z=de,G.push(le)}h.addAtoms(G)}E&&h.assignBonds()}}addLineDashed(i,s){var l,h;i.dashLength=i.dashLength||.5,i.gapLength=i.gapLength||.5,l=i.start?new m.Vector3(i.start.x||0,i.start.y||0,i.start.z||0):new m.Vector3(0,0,0),h=i.end?new m.Vector3(i.end.x,i.end.y||0,i.end.z||0):new m.Vector3(0,0,0);var E,g,A,M=new m.Vector3,S=new m.Vector3,P=new m.Vector3,L=l.clone(),X=0;for(M.subVectors(h,l),E=M.length(),M.normalize(),S=M.clone(),P=M.clone(),S.multiplyScalar(i.dashLength),P.multiplyScalar(i.gapLength),g=S.length(),A=P.length();X<E;){if(X+g>E){i.start=l,i.end=h,s.addLine(i);break}L.addVectors(l,S),i.start=l,i.end=L,s.addLine(i),l=L.clone(),X+=g,L.addVectors(l,P),l=L.clone(),X+=A}return s.finalize(),s}addCustom(i){var s=new Oe(i=i||{});return s.shapePosition=this.shapes.length,s.addCustom(i),this.shapes.push(s),s.finalize(),s}addVolumetricData(i,s,l={}){var h=new Ve.VolumeData(i,s);return l.hasOwnProperty("transferfn")?this.addVolumetricRender(h,l):this.addIsosurface(h,l)}addIsosurface(i,s={},l){var h=new Oe(s);return h.shapePosition=this.shapes.length,h.addIsosurface(i,s,l,this),this.shapes.push(h),h}addVolumetricRender(i,s){var l=new Pt(i,s=s||{},this);return l.shapePosition=this.shapes.length,this.shapes.push(l),l}hasVolumetricRender(){return this.renderer.supportsVolumetric()}enableFog(i){if(i){this.scene.fog=new u.Fog(this.bgColor,100,200),this.config.disableFog=!1;const s=i;s.fogStart==null?this.fogStart=.4:this.fogStart=s.fogStart,s.fogEnd==null?this.fogEnd=1:this.fogEnd=s.fogEnd}else this.config.disableFog=!0,this.show()}setFrame(i){this.viewer_frame=i;let s=this;return new Promise(function(l){var h=s.models.map(function(E){return E.setFrame(i)});Promise.all(h).then(function(){l()})})}getFrame(){return this.viewer_frame}getNumFrames(){var i=0;for(let s=0;s<this.models.length;s++)this.models[s].getNumFrames()>i&&(i=this.models[s].getNumFrames());for(let s=0;s<this.shapes.length;s++)this.shapes[s].frame&&this.shapes[s].frame>=i&&(i=this.shapes[s].frame+1);for(let s=0;s<this.labels.length;s++)this.labels[s].frame&&this.labels[s].frame>=i&&(i=this.labels[s].frame+1);return i}getNextModelId(){return this.models.length}animate(i){this.incAnim();var s=100,l="forward",h=1/0;(i=i||{}).interval&&(s=i.interval),i.loop&&(l=i.loop),i.reps&&(h=i.reps);var E=this.getNumFrames(),g=this,A=0;i.startFrame&&(A=i.startFrame%E);var M=1;i.step&&(h/=M=i.step);var S,P,L=0,X=E*h,U=new Date,j=function(W){U=new Date,W=="forward"?g.setFrame(A).then(function(){A=(A+M)%E,S()}):W=="backward"?g.setFrame(E-1-A).then(function(){A=(A+M)%E,S()}):g.setFrame(A).then(function(){M*=(A+=M)%(E-1)==0?-1:1,S()})};return S=function(){if(g.render(),g.getCanvas().isConnected)if(++L>=X||!g.isAnimated())P.cancel(),g.animationTimers.delete(P),g.decAnim();else{var W=s-(new Date().getTime()-U.getTime());W=W>0?W:0,P.cancel(),g.animationTimers.delete(P),P=new x.PausableTimer(j,W,l),g.animationTimers.add(P)}else g.stopAnimate()},P=new x.PausableTimer(j,0,l),this.animationTimers.add(P),this}stopAnimate(){return this.animated=0,this.animationTimers.forEach(function(i){i.cancel()}),this.animationTimers=new Set,this}pauseAnimate(){return this.animationTimers.forEach(function(i){i.pause()}),this}resumeAnimate(){return this.animationTimers.forEach(function(i){i.resume()}),this}isAnimated(){return this.animated>0}getModelOpt(i){return i&&!i.defaultcolors?(i.defaultcolors=this.defaultcolors,i.cartoonQuality=i.cartoonQuality||this.config.cartoonQuality):i===void 0&&(i={defaultcolors:this.defaultcolors,cartoonQuality:this.config.cartoonQuality}),i}addModel(i,s="",l){l=this.getModelOpt(l);var h=new ur(this.models.length,l,this);return h.addMolData(i,s,l),this.models.push(h),h}addModels(i,s,l){(l=this.getModelOpt(l)).multimodel=!0,l.frames=!0;for(var h=ur.parseMolData(i,s,l),E=0;E<h.length;E++){var g=new ur(this.models.length,l,this);g.setAtomDefaults(h[E]),g.addFrame(h[E]),g.setFrame(0),h.modelData&&g.setModelData(h.modelData[E]),g.setDontDuplicateAtoms(!l.duplicateAssemblyAtoms),this.models.push(g)}return this.models}addModelsAsFrames(i,s,l){(l=this.getModelOpt(l)).multimodel=!0,l.frames=!0;var h=new ur(this.models.length,l,this);return h.addMolData(i,s,l),this.models.push(h),h}addAsOneMolecule(i,s,l){(l=this.getModelOpt(l)).multimodel=!0,l.onemol=!0;var h=new ur(this.models.length,l,this);return h.addMolData(i,s,l),this.models.push(h),h}removeModel(i){if(i=this.getModel(i)){for(i.removegl(this.modelGroup),delete this.models[i.getID()];this.models.length>0&&this.models[this.models.length-1]===void 0;)this.models.pop();return this}}removeAllModels(){for(var i=0;i<this.models.length;i++){var s=this.models[i];s&&s.removegl(this.modelGroup)}return this.models.splice(0,this.models.length),this}exportJSON(i,s){var l={};return l.m=s===void 0?this.models.map(function(h){return h.toCDObject(i)}):[this.models[s].toCDObject()],JSON.stringify(l)}exportVRML(){var i=this.modelGroup;this.applyToModels("removegl",this.modelGroup),this.modelGroup=new u.Object3D,this.render(null,{supportsImposters:!1,supportsAIA:!1,regen:!0});var s=`#VRML V2.0 utf8
`+this.modelGroup.vrml()+`
`;return this.applyToModels("removegl",this.modelGroup),this.modelGroup=i,s}createModelFrom(i,s=!1){for(var l=new ur(this.models.length,this.defaultcolors,this),h=0;h<this.models.length;h++)if(this.models[h]){var E=this.models[h].selectedAtoms(i);l.addAtoms(E),s&&this.models[h].removeAtoms(E)}return this.models.push(l),l}applyToModels(i,s,l,h,E,g,A){for(var M=this.getModelList(s),S=0;S<M.length;S++)M[S][i](s,l,h,E,g,A)}setStyle(i,s){return s===void 0&&(s=i,i={}),this.applyToModels("setStyle",i,s,!1),this}addStyle(i,s){return s===void 0&&(s=i,i={}),this.applyToModels("setStyle",i,s,!0),this}setClickable(i,s,l){return this.applyToModels("setClickable",i,s,l),this}setHoverable(i,s,l,h){return this.applyToModels("setHoverable",i,s,l,h),this}enableContextMenu(i,s){return this.applyToModels("enableContextMenu",i,s),this}vibrate(i,s,l,h){return this.applyToModels("vibrate",i,s,l,h),this}setColorByProperty(i,s,l,h){return this.applyToModels("setColorByProperty",i,s,l,h),this}setColorByElement(i,s){return this.applyToModels("setColorByElement",i,s),this}static getAtomsWithin(i,s){var l=[];for(let E=0;E<i.length;E++){var h=i[E];h!==void 0&&(h.x<s[0][0]||h.x>s[1][0]||h.y<s[0][1]||h.y>s[1][1]||h.z<s[0][2]||h.z>s[1][2]||l.push(h))}return l}static volume(i){return(i[1][0]-i[0][0])*(i[1][1]-i[0][1])*(i[1][2]-i[0][2])}carveUpExtent(i,s,l){let h=[],E={};for(let P=0,L=s.length;P<L;P++)E[s[P].index]=P;let g=function(P){let L=[];for(let X=0,U=P.length;X<U;X++)P[X].index in E&&L.push(E[P[X].index]);return L},A=function(P){let L=[];return L[0]=[P[0][0],P[0][1],P[0][2]],L[1]=[P[1][0],P[1][1],P[1][2]],L},M=function(P){if(Zt.volume(P)<Zt.maxVolume)return[P];var L,X=P[1][0]-P[0][0],U=P[1][1]-P[0][1],j=P[1][2]-P[0][2];L=X>U&&X>j?0:U>X&&U>j?1:2;var W=A(P),G=A(P),Z=(P[1][L]-P[0][L])/2+P[0][L];W[1][L]=Z,G[0][L]=Z;var te=M(W),re=M(G);return te.concat(re)},S=M(i);for(let P=0,L=S.length;P<L;P++){let X=A(S[P]);X[0][0]-=6,X[0][1]-=6,X[0][2]-=6,X[1][0]+=6,X[1][1]+=6,X[1][2]+=6;let U=Zt.getAtomsWithin(s,X),j=Zt.getAtomsWithin(l,S[P]);h.push({extent:S[P],atoms:g(U),toshow:g(j)})}return h}static generateSurfaceMesh(i,s,l){var h=new u.Geometry(!0),E=h.updateGeoGroup(0),g=[];for(let ke=0,we=i.length;ke<we;ke++){var A=i[ke];A&&(A.surfaceColor!==void 0?g[ke]=A.surfaceColor:A.color&&(g[ke]=b.CC.color(A.color)))}var M=E.vertexArray,S=s.vertices;for(let ke=0,we=S.length;ke<we;ke++){let Ge=3*E.vertices;M[Ge]=S[ke].x,M[Ge+1]=S[ke].y,M[Ge+2]=S[ke].z,E.vertices++}var P=E.colorArray;let L=E.atomArray;if(l.voldata&&l.volscheme){var X=l.volscheme,U=l.voldata,j=X.range()||[-1,1];for(let ke=0,we=S.length;ke<we;ke++){let Ge=S[ke].atomid,Je=U.getVal(S[ke].x,S[ke].y,S[ke].z),tt=b.CC.color(X.valueToHex(Je,j)),Ze=3*ke;P[Ze]=tt.r,P[Ze+1]=tt.g,P[Ze+2]=tt.b,L[ke]=i[Ge]}}else if(g.length>0)for(let ke=0,we=S.length;ke<we;ke++){let Ge=S[ke].atomid,Je=3*ke;P[Je]=g[Ge].r,P[Je+1]=g[Ge].g,P[Je+2]=g[Ge].b,L[ke]=i[Ge]}var W=s.faces;E.faceidx=W.length,h.initTypedArrays();var G,Z,te,re,de=E.vertexArray,le=E.normalArray;for(let ke=0,we=W.length;ke<we;ke+=3){var ye=3*W[ke],Pe=3*W[ke+1],Te=3*W[ke+2];G=new m.Vector3(de[ye],de[ye+1],de[ye+2]),Z=new m.Vector3(de[Pe],de[Pe+1],de[Pe+2]),(te=new m.Vector3(de[Te],de[Te+1],de[Te+2])).subVectors(te,Z),G.subVectors(G,Z),te.cross(G),(re=te).normalize(),le[ye]+=re.x,le[Pe]+=re.x,le[Te]+=re.x,le[ye+1]+=re.y,le[Pe+1]+=re.y,le[Te+1]+=re.y,le[ye+2]+=re.z,le[Pe+2]+=re.z,le[Te+2]+=re.z}return E.faceArray=new Uint16Array(W),new u.Mesh(h,l)}static generateMeshSyncHelper(i,s,l,h,E,g){var A=new xe;return A.initparm(s,i!==1,g),A.fillvoxels(E,l),A.buildboundary(),i!=Gr.SES&&i!=Gr.MS||(A.fastdistancemap(),A.boundingatom(!1),A.fillvoxelswaals(E,l)),A.marchingcube(i),A.getFacesAndVertices(h)}static getMatWithStyle(i){let s=null;for(var l in s=i.onesided?new u.MeshLambertMaterial:new u.MeshDoubleLambertMaterial,s.vertexColors=u.Coloring.VertexColors,i)l==="color"||l==="map"||i.hasOwnProperty(l)&&(s[l]=i[l]);return i.opacity!==void 0&&(i.opacity===1?s.transparent=!1:s.transparent=!0),i.wireframe!==void 0&&(s.wireframe=i.wireframe),s}addMesh(i){let s={geo:i.geometry,mat:i.material,done:!0,finished:!1};var l=this.nextSurfID();return this.surfaces[l]=new gr([s]),l}static shallowCopy(i){var s=[];let l=i.length;for(let h=0;h<l;h++)s[h]=(0,x.extend)({},i[h]);return s}addSurface(i,s={},l={},h,E,g){let A=this.nextSurfID(),M=null,S=this,P=Gr.VDW;typeof i=="string"?Zt.surfaceTypeMap[i.toUpperCase()]!==void 0?P=Zt.surfaceTypeMap[i]:console.log("Surface type : "+i+" is not recognized"):typeof i=="number"&&(P=i);var L=null,X=null,U=Zt.shallowCopy(this.getAtomsFromSel(l));L=h?Zt.shallowCopy(this.getAtomsFromSel(h)):U,(0,x.adjustVolumeStyle)(s);var j,W=!1;for(j=0;j<this.models.length;j++)if(this.models[j]){var G=this.models[j].getSymmetries();if(G.length>1||G.length==1&&!G[0].isIdentity()){W=!0;break}}var Z=function(Pe,Te,ke){var we;X=E?Zt.shallowCopy(S.getAtomsFromSel(E)):ke;var Ge=(0,x.getExtent)(ke,!0);if(s.map&&s.map.prop){var Je=s.map.prop;let ot=(0,T.getGradient)(s.map.scheme||s.map.gradient||new T.Gradient.RWB),wt=ot.range();wt||(wt=(0,x.getPropertyRange)(ke,Je)),s.colorscheme={prop:Je,gradient:ot}}for(let ot=0,wt=Te.length;ot<wt;ot++)(we=Te[ot]).surfaceColor=(0,x.getColorFromStyle)(we,s);var tt=Zt.volume(Ge),Ze=S.carveUpExtent(Ge,Te,ke);if(X&&X.length&&X.length>0){var ut=(0,x.getExtent)(X,!0);Ze.sort(function(ot,wt){var Et=function(it,Rt){var Ht=it.extent,kt=Ht[1][0]-Ht[0][0],ct=Ht[1][1]-Ht[0][1],Jt=Ht[1][2]-Ht[0][2],Nt=kt-Rt[2][0];Nt*=Nt;var qt=ct-Rt[2][1];qt*=qt;var Vt=Jt-Rt[2][2];return Nt+qt+(Vt*=Vt)};return Et(ot,ut)-Et(wt,ut)})}var ft=[];for(let ot=0,wt=Te.length;ot<wt;ot++)we=Te[ot],ft[ot]={x:we.x,y:we.y,z:we.z,serial:ot,elem:we.elem};var Qe=!!$r;if(typeof $3Dmol<"u"&&$3Dmol.SurfaceWorker!==void 0||(console.log("$3Dmol.SurfaceWorker is not defined, using synchronous surface generation."),Qe=!0),Qe){var pt=function(ot){return new Promise(function(wt){for(var Et=Zt.generateMeshSyncHelper(P,Ze[ot].extent,Ze[ot].atoms,Ze[ot].toshow,ft,tt),it=yt({vertexArr:Et.vertices,faceArr:Et.faces}),Rt=0,Ht=it.length;Rt<Ht;Rt++){Et={vertices:it[Rt].vertexArr,faces:it[Rt].faceArr};var kt=Zt.generateSurfaceMesh(Te,Et,M);(0,x.mergeGeos)(Pe.geo,kt)}S.render(),wt()})},Be=[];for(let ot=0;ot<Ze.length;ot++)Be.push(pt(ot));return Promise.all(Be).then(function(){return Pe.done=!0,S.render(),Promise.resolve(A)})}var et=[];P<0&&(P=0);for(let ot=0,wt=Zt.numWorkers;ot<wt;ot++){var St=new Worker($3Dmol.SurfaceWorker);et.push(St),St.postMessage({type:-1,atoms:ft,volume:tt})}return new Promise(function(ot,wt){var Et=0,it=function(){et&&et.length&&et.forEach(function(ct){ct&&ct.terminate&&ct.terminate()})},Rt=function(ct){for(var Jt=yt({vertexArr:ct.data.vertices,faceArr:ct.data.faces}),Nt=0,qt=Jt.length;Nt<qt;Nt++){var Vt={vertices:Jt[Nt].vertexArr,faces:Jt[Nt].faceArr},Kt=Zt.generateSurfaceMesh(Te,Vt,M);(0,x.mergeGeos)(Pe.geo,Kt)}S.render(),++Et==Ze.length&&(Pe.done=!0,it(),ot(A))},Ht=function(ct){it(),console.log(ct.message+" ("+ct.filename+":"+ct.lineno+")"),wt(ct)};for(let ct=0;ct<Ze.length;ct++){var kt=et[ct%et.length];kt.onmessage=Rt,kt.onerror=Ht,kt.postMessage({type:P,expandedExtent:Ze[ct].extent,extendedAtoms:Ze[ct].atoms,atomsToShow:Ze[ct].toshow})}})};s=s||{},M=Zt.getMatWithStyle(s);let te=new gr([]);te.style=s,te.atomsel=l,te.allsel=h,te.focus=E;var re=null;if(W){var de={},le={};for(j=0;j<this.models.length;j++)de[j]=[],le[j]=[];for(j=0;j<L.length;j++)de[L[j].model].push(L[j]);for(j=0;j<U.length;j++)le[U[j].model].push(U[j]);var ye=[];for(j=0;j<this.models.length;j++)le[j].length>0&&(te.push({geo:new u.Geometry(!0),mat:M,done:!1,finished:!1,symmetries:this.models[j].getSymmetries()}),ye.push(Z(te[te.length-1],de[j],le[j])));re=Promise.all(ye)}else te.push({geo:new u.Geometry(!0),mat:M,done:!1,finished:!1,symmetries:[new m.Matrix4]}),re=Z(te[te.length-1],L,U);return this.surfaces[A]=te,re.surfid=A,g&&typeof g=="function"?(re.then(function(Pe){g(Pe)}),A):re}setSurfaceMaterialStyle(i,s){if((0,x.adjustVolumeStyle)(s),this.surfaces[i]){var l=this.surfaces[i];for(let E=0;E<l.length;E++){var h=l[E].mat=Zt.getMatWithStyle(s);if(l[E].mat.side=u.FrontSide,s.wireframe&&l[E].geo.setUpWireframe(),s.color){l[E].mat.color=b.CC.color(s.color),l[E].geo.colorsNeedUpdate=!0;const g=b.CC.color(s.color);l[E].geo.setColor(g)}else if(h.voldata&&h.volscheme){const g=h.volscheme,A=h.voldata,M=b.CC,S=g.range()||[-1,1];l[E].geo.setColors(function(P,L,X){let U=A.getVal(P,L,X);return M.color(g.valueToHex(U,S))})}else{l[E].geo.colorsNeedUpdate=!0;for(let g of l[E].geo.geometryGroups)for(let A=0;A<g.vertices;A++){let M=(0,x.getColorFromStyle)(g.atomArray[A],s),S=3*A;g.colorArray[S]=M.r,g.colorArray[S+1]=M.g,g.colorArray[S+2]=M.b}}l[E].finished=!1}}return this}getSurface(i){return this.surfaces[i]}removeSurface(i){for(var s=this.surfaces[i],l=0;l<s.length;l++)s[l]&&s[l].lastGL&&(s[l].geo!==void 0&&s[l].geo.dispose(),s[l].mat!==void 0&&s[l].mat.dispose(),this.modelGroup.remove(s[l].lastGL));return delete this.surfaces[i],this.show(),this}removeAllSurfaces(){for(var i in this.surfaces)if(this.surfaces.hasOwnProperty(i)){for(var s=this.surfaces[i],l=0;l<s.length;l++)s[l]&&s[l].lastGL&&(s[l].geo!==void 0&&s[l].geo.dispose(),s[l].mat!==void 0&&s[l].mat.dispose(),this.modelGroup.remove(s[l].lastGL));delete this.surfaces[i]}return this.show(),this}jmolMoveTo(){var i=this.modelGroup.position,s="center { "+-i.x+" "+-i.y+" "+-i.z+" }; ",l=this.rotationGroup.quaternion;return s+="moveto .5 quaternion { "+l.x+" "+l.y+" "+l.z+" "+l.w+" };"}clear(){return this.removeAllSurfaces(),this.removeAllModels(),this.removeAllLabels(),this.removeAllShapes(),this.show(),this}mapAtomProperties(i,s){s=s||{};var l=this.getAtomsFromSel(s);if(typeof i=="function")for(let g=0,A=l.length;g<A;g++)i(l[g]);else for(let g=0,A=l.length;g<A;g++){var h=l[g];for(let M=0,S=i.length;M<S;M++){let P=i[M];if(P.props)for(var E in P.props)P.props.hasOwnProperty(E)&&this.atomIsSelected(h,P)&&(h.properties||(h.properties={}),h.properties[E]=P.props[E])}}return this}linkViewer(i){return this.linkedViewers.push(i),this}getPerceivedDistance(){return this.CAMERA_Z-this.rotationGroup.position.z}setPerceivedDistance(i){this.rotationGroup.position.z=this.CAMERA_Z-i}setAutoEyeSeparation(i,s){var l=this.getPerceivedDistance();return s||(s=5),i||this.camera.position.x>0?this.camera.position.x=l*Math.tan(Math.PI/180*s):this.camera.position.x=-l*Math.tan(Math.PI/180*s),this.camera.lookAt(new m.Vector3(0,0,this.rotationGroup.position.z)),this.camera.position.x}setDefaultCartoonQuality(i){this.config.cartoonQuality=i}}function Ar(ae,i){if(ae=(0,x.getElement)(ae)){i=i||{};try{return new Zt(ae,i)}catch(s){throw"error creating viewer: "+s}}}function Cr(ae,i={},s={}){if(ae=(0,x.getElement)(ae)){var l=[],h=document.createElement("canvas");s.rows=i.rows,s.cols=i.cols,s.control_all=i.control_all!=null&&i.control_all,ae.appendChild(h);try{for(var E=0;E<i.rows;E++){for(var g=[],A=0;A<i.cols;A++){s.row=E,s.col=A,s.canvas=h,s.viewers=l,s.control_all=i.control_all;var M=Ar(ae,(0,x.extend)({},s));g.push(M)}l.unshift(g)}}catch(S){throw"error creating viewer grid: "+S}return l}}function Ur(ae){var i=this;if(ae=(0,x.getElement)(ae)){var s=Cr(ae,{rows:1,cols:2,control_all:!0});this.glviewer1=s[0][0],this.glviewer2=s[0][1],this.glviewer1.setAutoEyeSeparation(!1),this.glviewer2.setAutoEyeSeparation(!0),this.glviewer1.linkViewer(this.glviewer2),this.glviewer2.linkViewer(this.glviewer1);for(var l=Object.getOwnPropertyNames(this.glviewer1.__proto__).filter(function(E){return typeof i.glviewer1[E]=="function"}),h=0;h<l.length;h++)this[l[h]]=(function(E){return function(){return[this.glviewer1[E].apply(this.glviewer1,arguments),this.glviewer2[E].apply(this.glviewer2,arguments)]}})(l[h]);this.setCoordinates=function(E,g,A){for(var M=0;M<E.length;M++)E[M].setCoordinates(g,A)},this.surfacesFinished=function(){return this.glviewer1.surfacesFinished()&&this.glviewer2.surfacesFinished()},this.isAnimated=function(){return this.glviewer1.isAnimated()||this.glviewer2.isAnimated()},this.render=function(E){this.glviewer1.render(),this.glviewer2.render(),E&&E(this)},this.getCanvas=function(){return this.glviewer1.getCanvas()}}}Zt.numWorkers=4,Zt.maxVolume=64e3,Zt.surfaceTypeMap={VDW:Gr.VDW,MS:Gr.MS,SAS:Gr.SAS,SES:Gr.SES};var _r=!1,Or=!1,wr={};function Mi(ae,i){var s,l,h;if(document.querySelector(".viewer_3Dmoljs")!=null&&(_r=!0),_r){Or=!0,ae=ae??null;var E=0;document.querySelectorAll(".viewer_3Dmoljs").forEach(g=>{var A=[],M=[],S="";g.style.position=="static"&&(g.style.position="relative");var P=null;if(h=null,g.dataset.pdb)A.push("https://files.rcsb.org/view/"+g.dataset.pdb+".pdb"),M.push("pdb");else if(g.dataset.cid)M.push("sdf"),A.push("https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+g.dataset.cid+"/SDF?record_type=3d");else if(g.dataset.href||g.dataset.url){if(S=g.dataset.href?g.dataset.href:g.dataset.url,A.push(S),(h=S.substring(S.lastIndexOf(".")+1))=="gz"){let ot=S.substring(0,S.lastIndexOf(".")).lastIndexOf(".");h=S.substring(ot+1)}M.push(h);var L=S.substring(S.lastIndexOf("/")+1,S.lastIndexOf("."));L=="/"&&(L=S.substring(S.lastIndexOf("/")+1)),g.dataset[M[M.length-1]]=L}let X=g.dataset;for(s in X)s.substring(0,3)==="pdb"&&s!=="pdb"?(A.push("https://files.rcsb.org/view/"+X[s]+".pdb"),M.push("pdb")):s.substring(0,4)==="href"&&s!=="href"?(S=X[s],A.push(S),M.push(S.substring(S.lastIndexOf(".")+1))):s.substring(0,3)==="cid"&&s!=="cid"&&(A.push("https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+X[s]+"/SDF?record_type=3d"),M.push("sdf"));var U={};g.dataset.options&&(U=(0,x.specStringToObject)(g.dataset.options));var j=b.CC.color(g.dataset.backgroundcolor),W=g.dataset.backgroundalpha;W=W==null?1:parseFloat(W);var G={line:{}};g.dataset.style&&(G=(0,x.specStringToObject)(g.dataset.style));var Z={};g.dataset.select&&(Z=(0,x.specStringToObject)(g.dataset.select));var te=[],re=[],de=[],le={},ye=null,Pe=g.dataset,Te=/style(.+)/,ke=/surface(.*)/,we=/labelres(.*)/,Ge=[];for(l in Pe)Object.prototype.hasOwnProperty.call(Pe,l)&&Ge.push(l);for(Ge.sort(),s=0;s<Ge.length;s++){l=Ge[s];var Je,tt,Ze,ut=Te.exec(l);ut&&(Je="select"+ut[1],tt=(0,x.specStringToObject)(Pe[Je]),Ze=(0,x.specStringToObject)(Pe[l]),te.push([tt,Ze])),(ut=ke.exec(l))&&(Je="select"+ut[1],tt=(0,x.specStringToObject)(Pe[Je]),Ze=(0,x.specStringToObject)(Pe[l]),re.push([tt,Ze])),(ut=we.exec(l))&&(Je="select"+ut[1],tt=(0,x.specStringToObject)(Pe[Je]),Ze=(0,x.specStringToObject)(Pe[l]),de.push([tt,Ze])),l=="zoomto"&&(le=(0,x.specStringToObject)(Pe[l])),l=="spin"&&(ye=(0,x.specStringToObject)(Pe[l]))}var ft=function(ot){for(ot.setStyle(Z,G),P&&P.createSelectionAndStyle(Z,G),s=0;s<te.length;s++){let wt=te[s][0]||{},Et=te[s][1]||{line:{}};ot.setStyle(wt,Et),P&&P.createSelectionAndStyle(Z,G)}for(s=0;s<re.length;s++){let wt=re[s][0]||{},Et=re[s][1]||{};P?ot.addSurface(Gr.VDW,Et,wt,wt).then(it=>{P.loadSurface("VDW",wt,Et,it)}):ot.addSurface(Gr.VDW,Et,wt,wt)}for(s=0;s<de.length;s++){let wt=de[s][0]||{},Et=de[s][1]||{};ot.addResLabels(wt,Et)}ot.render(),ot.zoomTo(le),ye&&ot.spin(ye.axis,ye.speed)};let Qe=ae;try{var pt=(0,x.specStringToObject)(g.dataset.config)||{};pt.backgroundColor===void 0&&(pt.backgroundColor=j),pt.backgroundAlpha===void 0&&(pt.backgroundAlpha=W),Qe==null?Qe=wr[g.id||E++]=Ar(g,pt):(Qe.setBackgroundColor(j,W),Qe.setConfig(pt),P&&P.initiateUI()),g.dataset.ui&&$3Dmol.StateManager&&(P=new $3Dmol.StateManager(Qe))}catch(ot){console.log(ot),g.textContent="WebGL appears to be disabled."}if(A.length!=0){let ot=0,wt=((Et,it)=>function(Rt){S=A[ot];var Ht=Et.dataset.type||Et.dataset.datatype||M[ot];if(it.addModel(Rt,Ht,U),P){var kt=Et.dataset[M[ot]];P.setModelTitle(kt)}ot+=1,ot<A.length?(0,x.get)(A[ot]).then(wt):(ft(it),Et.dataset.callback&&(0,x.makeFunction)(Et.dataset.callback)(it),Or=!1,i&&i(it))})(g,Qe);h&&h.endsWith("gz")?(0,x.getbin)(A[0]).then(wt):(0,x.get)(A[0]).then(wt)}else{if(g.dataset.element){var Be="#"+g.dataset.element,et=document.querySelector(Be),St=et?et.textContent:"";h=g.dataset.type||g.dataset.datatype,Qe.addModel(St,h,U)}ft(Qe),g.dataset.callback&&(0,x.makeFunction)(g.dataset.callback)(Qe),Or=!1,i&&i(Qe)}})}}document.onreadystatechange=()=>{document.readyState==="complete"&&Mi()};const Qt={"ALA:N":-.15,"ALA:CA":.1,"ALA:CB":0,"ALA:C":.6,"ALA:O":-.55,"ARG:N":-.15,"ARG:CA":.1,"ARG:CB":0,"ARG:CG":0,"ARG:CD":.1,"ARG:NE":-.1,"ARG:CZ":.5,"ARG:NH1":.25,"ARG:NH2":.25,"ARG:C":.6,"ARG:O":-.55,"ASN:N":-.15,"ASN:CA":.1,"ASN:CB":0,"ASN:CG":.55,"ASN:OD1":-.55,"ASN:ND2":0,"ASN:C":.6,"ASN:O":-.55,"ASP:N":-.15,"ASP:CA":.1,"ASP:CB":0,"ASP:CG":.14,"ASP:OD1":-.57,"ASP:OD2":-.57,"ASP:C":.6,"ASP:O":-.55,"CYS:N":-.15,"CYS:CA":.1,"CYS:CB":.19,"CYS:SG":-.19,"CYS:C":.6,"CYS:O":-.55,"GLN:N":-.15,"GLN:CA":.1,"GLN:CB":0,"GLN:CG":0,"GLN:CD":.55,"GLN:OE1":-.55,"GLN:NE2":0,"GLN:C":.6,"GLN:O":-.55,"GLU:N":-.15,"GLU:CA":.1,"GLU:CB":0,"GLU:CG":0,"GLU:CD":.14,"GLU:OE1":-.57,"GLU:OE2":-.57,"GLU:C":.6,"GLU:O":-.55,"GLY:N":-.15,"GLY:CA":.1,"GLY:C":.6,"GLY:O":-.55,"HIS:N":-.15,"HIS:CA":.1,"HIS:CB":0,"HIS:CG":.1,"HIS:ND1":-.1,"HIS:CD2":.1,"HIS:NE2":-.4,"HIS:CE1":.3,"HIS:C":.6,"HIS:O":-.55,"ILE:N":-.15,"ILE:CA":.1,"ILE:CB":0,"ILE:CG2":0,"ILE:CG1":0,"ILE:CD":0,"ILE:C":.6,"ILE:O":-.55,"LEU:N":-.15,"LEU:CA":.1,"LEU:CB":0,"LEU:CG":0,"LEU:CD1":0,"LEU:CD2":0,"LEU:C":.6,"LEU:O":-.55,"LYS:N":-.15,"LYS:CA":.1,"LYS:CB":0,"LYS:CG":0,"LYS:CD":0,"LYS:CE":.25,"LYS:NZ":.75,"LYS:C":.6,"LYS:O":-.55,"MET:N":-.15,"MET:CA":.1,"MET:CB":0,"MET:CG":.06,"MET:SD":-.12,"MET:CE":.06,"MET:C":.6,"MET:O":-.55,"PHE:N":-.15,"PHE:CA":.1,"PHE:CB":0,"PHE:CG":0,"PHE:CD1":0,"PHE:CD2":0,"PHE:CE1":0,"PHE:CE2":0,"PHE:CZ":0,"PHE:C":.6,"PHE:O":-.55,"PRO:N":-.25,"PRO:CD":.1,"PRO:CA":.1,"PRO:CB":0,"PRO:CG":0,"PRO:C":.6,"PRO:O":-.55,"SER:N":-.15,"SER:CA":.1,"SER:CB":.25,"SER:OG":-.25,"SER:C":.6,"SER:O":-.55,"THR:N":-.15,"THR:CA":.1,"THR:CB":.25,"THR:OG1":-.25,"THR:CG2":0,"THR:C":.6,"THR:O":-.55,"TRP:N":-.15,"TRP:CA":.1,"TRP:CB":0,"TRP:CG":-.03,"TRP:CD2":.1,"TRP:CE2":-.04,"TRP:CE3":-.03,"TRP:CD1":.06,"TRP:NE1":-.06,"TRP:CZ2":0,"TRP:CZ3":0,"TRP:CH2":0,"TRP:C":.6,"TRP:O":-.55,"TYR:N":-.15,"TYR:CA":.1,"TYR:CB":0,"TYR:CG":0,"TYR:CD1":0,"TYR:CE1":0,"TYR:CD2":0,"TYR:CE2":0,"TYR:CZ":.25,"TYR:OH":-.25,"TYR:C":.6,"TYR:O":-.55,"VAL:N":-.15,"VAL:CA":.1,"VAL:CB":0,"VAL:CG1":0,"VAL:CG2":0,"VAL:C":.6,"VAL:O":-.55};function ri(ae,i){if((!i||ae.partialCharge===void 0)&&ae.resn&&ae.atom){var s=ae.resn+":"+ae.atom;ae.properties.partialCharge=Qt[s]}}window&&(window.$3Dmol=n)},40:(r,n,a)=>{a.r(n),a.d(n,{bondLength:()=>d,bondTable:()=>c,setBondLength:()=>R});let c={H:.37,He:.32,Li:1.34,Be:.9,B:.82,C:.77,N:.75,O:.73,F:.71,Ne:.69,Na:1.54,Mg:1.3,Al:1.18,Si:1.11,P:1.06,S:1.02,Cl:.99,Ar:.97,K:1.96,Ca:1.74,Sc:1.44,Ti:1.56,V:1.25,Mn:1.39,Fe:1.25,Co:1.26,Ni:1.21,Cu:1.38,Zn:1.31,Ga:1.26,Ge:1.22,Se:1.16,Br:1.14,Kr:1.1,Rb:2.11,Sr:1.92,Y:1.62,Zr:1.48,Nb:1.37,Mo:1.45,Tc:1.56,Ru:1.26,Rh:1.35,Pd:1.31,Ag:1.53,Cd:1.48,In:1.44,Sn:1.41,Sb:1.38,Te:1.35,I:1.33,Xe:1.3,Cs:2.25,Ba:1.98,Lu:1.6,Hf:1.5,Ta:1.38,W:1.46,Re:1.59,Os:1.44,Ir:1.37,Pt:1.28,Au:1.44,Hg:1.49,Tl:1.48,Pb:1.47,Bi:1.46,Rn:1.45};function d(u){return c[u]||1.6}function R(u,v){v<0&&(v=0),c[u]=v}},71:(r,n,a)=>{var c=a(107),d=a(981),R=a(972),u=a(834),v=a(746),m=Object.prototype.toString;function b(x){if(!(this instanceof b))return new b(x);this.options=d.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},x||{});var k=this.options;k.raw&&k.windowBits>0?k.windowBits=-k.windowBits:k.gzip&&k.windowBits>0&&k.windowBits<16&&(k.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new v,this.strm.avail_out=0;var F=c.deflateInit2(this.strm,k.level,k.method,k.windowBits,k.memLevel,k.strategy);if(F!==0)throw new Error(u[F]);if(k.header&&c.deflateSetHeader(this.strm,k.header),k.dictionary){var C;if(C=typeof k.dictionary=="string"?R.string2buf(k.dictionary):m.call(k.dictionary)==="[object ArrayBuffer]"?new Uint8Array(k.dictionary):k.dictionary,(F=c.deflateSetDictionary(this.strm,C))!==0)throw new Error(u[F]);this._dict_set=!0}}function T(x,k){var F=new b(k);if(F.push(x,!0),F.err)throw F.msg||u[F.err];return F.result}b.prototype.push=function(x,k){var F,C,z=this.strm,Q=this.options.chunkSize;if(this.ended)return!1;C=k===~~k?k:k===!0?4:0,typeof x=="string"?z.input=R.string2buf(x):m.call(x)==="[object ArrayBuffer]"?z.input=new Uint8Array(x):z.input=x,z.next_in=0,z.avail_in=z.input.length;do{if(z.avail_out===0&&(z.output=new d.Buf8(Q),z.next_out=0,z.avail_out=Q),(F=c.deflate(z,C))!==1&&F!==0)return this.onEnd(F),this.ended=!0,!1;z.avail_out!==0&&(z.avail_in!==0||C!==4&&C!==2)||(this.options.to==="string"?this.onData(R.buf2binstring(d.shrinkBuf(z.output,z.next_out))):this.onData(d.shrinkBuf(z.output,z.next_out)))}while((z.avail_in>0||z.avail_out===0)&&F!==1);return C===4?(F=c.deflateEnd(this.strm),this.onEnd(F),this.ended=!0,F===0):C!==2||(this.onEnd(0),z.avail_out=0,!0)},b.prototype.onData=function(x){this.chunks.push(x)},b.prototype.onEnd=function(x){x===0&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=d.flattenChunks(this.chunks)),this.chunks=[],this.err=x,this.msg=this.strm.msg},n.Deflate=b,n.deflate=T,n.deflateRaw=function(x,k){return(k=k||{}).raw=!0,T(x,k)},n.gzip=function(x,k){return(k=k||{}).gzip=!0,T(x,k)}},75:(r,n,a)=>{function c(p){let $=p.length;for(;--$>=0;)p[$]=0}a.r(n),a.d(n,{Deflate:()=>ci,Inflate:()=>xi,constants:()=>qr,default:()=>ei,deflate:()=>ni,deflateRaw:()=>hi,gzip:()=>zi,inflate:()=>Ii,inflateRaw:()=>Hr,ungzip:()=>Kr});const d=256,R=286,u=30,v=15,m=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),b=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),T=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),x=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),k=new Array(576);c(k);const F=new Array(60);c(F);const C=new Array(512);c(C);const z=new Array(256);c(z);const Q=new Array(29);c(Q);const J=new Array(u);function q(p,$,y,be,_e){this.static_tree=p,this.extra_bits=$,this.extra_base=y,this.elems=be,this.max_length=_e,this.has_stree=p&&p.length}let w,N,V;function H(p,$){this.dyn_tree=p,this.max_code=0,this.stat_desc=$}c(J);const Y=p=>p<256?C[p]:C[256+(p>>>7)],O=(p,$)=>{p.pending_buf[p.pending++]=255&$,p.pending_buf[p.pending++]=$>>>8&255},ee=(p,$,y)=>{p.bi_valid>16-y?(p.bi_buf|=$<<p.bi_valid&65535,O(p,p.bi_buf),p.bi_buf=$>>16-p.bi_valid,p.bi_valid+=y-16):(p.bi_buf|=$<<p.bi_valid&65535,p.bi_valid+=y)},Ae=(p,$,y)=>{ee(p,y[2*$],y[2*$+1])},ce=(p,$)=>{let y=0;do y|=1&p,p>>>=1,y<<=1;while(--$>0);return y>>>1},ge=(p,$,y)=>{const be=new Array(16);let _e,ve,Ke=0;for(_e=1;_e<=v;_e++)Ke=Ke+y[_e-1]<<1,be[_e]=Ke;for(ve=0;ve<=$;ve++){let ze=p[2*ve+1];ze!==0&&(p[2*ve]=ce(be[ze]++,ze))}},me=p=>{let $;for($=0;$<R;$++)p.dyn_ltree[2*$]=0;for($=0;$<u;$++)p.dyn_dtree[2*$]=0;for($=0;$<19;$++)p.bl_tree[2*$]=0;p.dyn_ltree[512]=1,p.opt_len=p.static_len=0,p.sym_next=p.matches=0},Me=p=>{p.bi_valid>8?O(p,p.bi_buf):p.bi_valid>0&&(p.pending_buf[p.pending++]=p.bi_buf),p.bi_buf=0,p.bi_valid=0},ue=(p,$,y,be)=>{const _e=2*$,ve=2*y;return p[_e]<p[ve]||p[_e]===p[ve]&&be[$]<=be[y]},I=(p,$,y)=>{const be=p.heap[y];let _e=y<<1;for(;_e<=p.heap_len&&(_e<p.heap_len&&ue($,p.heap[_e+1],p.heap[_e],p.depth)&&_e++,!ue($,be,p.heap[_e],p.depth));)p.heap[y]=p.heap[_e],y=_e,_e<<=1;p.heap[y]=be},he=(p,$,y)=>{let be,_e,ve,Ke,ze=0;if(p.sym_next!==0)do be=255&p.pending_buf[p.sym_buf+ze++],be+=(255&p.pending_buf[p.sym_buf+ze++])<<8,_e=p.pending_buf[p.sym_buf+ze++],be===0?Ae(p,_e,$):(ve=z[_e],Ae(p,ve+d+1,$),Ke=m[ve],Ke!==0&&(_e-=Q[ve],ee(p,_e,Ke)),be--,ve=Y(be),Ae(p,ve,y),Ke=b[ve],Ke!==0&&(be-=J[ve],ee(p,be,Ke)));while(ze<p.sym_next);Ae(p,256,$)},se=(p,$)=>{const y=$.dyn_tree,be=$.stat_desc.static_tree,_e=$.stat_desc.has_stree,ve=$.stat_desc.elems;let Ke,ze,gt,Ne=-1;for(p.heap_len=0,p.heap_max=573,Ke=0;Ke<ve;Ke++)y[2*Ke]!==0?(p.heap[++p.heap_len]=Ne=Ke,p.depth[Ke]=0):y[2*Ke+1]=0;for(;p.heap_len<2;)gt=p.heap[++p.heap_len]=Ne<2?++Ne:0,y[2*gt]=1,p.depth[gt]=0,p.opt_len--,_e&&(p.static_len-=be[2*gt+1]);for($.max_code=Ne,Ke=p.heap_len>>1;Ke>=1;Ke--)I(p,y,Ke);gt=ve;do Ke=p.heap[1],p.heap[1]=p.heap[p.heap_len--],I(p,y,1),ze=p.heap[1],p.heap[--p.heap_max]=Ke,p.heap[--p.heap_max]=ze,y[2*gt]=y[2*Ke]+y[2*ze],p.depth[gt]=(p.depth[Ke]>=p.depth[ze]?p.depth[Ke]:p.depth[ze])+1,y[2*Ke+1]=y[2*ze+1]=gt,p.heap[1]=gt++,I(p,y,1);while(p.heap_len>=2);p.heap[--p.heap_max]=p.heap[1],(($e,dr)=>{const Wt=dr.dyn_tree,_t=dr.max_code,si=dr.stat_desc.static_tree,Mr=dr.stat_desc.has_stree,er=dr.stat_desc.extra_bits,zr=dr.stat_desc.extra_base,lr=dr.stat_desc.max_length;let Ct,sr,Pr,Dt,Sr,cr,tr=0;for(Dt=0;Dt<=v;Dt++)$e.bl_count[Dt]=0;for(Wt[2*$e.heap[$e.heap_max]+1]=0,Ct=$e.heap_max+1;Ct<573;Ct++)sr=$e.heap[Ct],Dt=Wt[2*Wt[2*sr+1]+1]+1,Dt>lr&&(Dt=lr,tr++),Wt[2*sr+1]=Dt,sr>_t||($e.bl_count[Dt]++,Sr=0,sr>=zr&&(Sr=er[sr-zr]),cr=Wt[2*sr],$e.opt_len+=cr*(Dt+Sr),Mr&&($e.static_len+=cr*(si[2*sr+1]+Sr)));if(tr!==0){do{for(Dt=lr-1;$e.bl_count[Dt]===0;)Dt--;$e.bl_count[Dt]--,$e.bl_count[Dt+1]+=2,$e.bl_count[lr]--,tr-=2}while(tr>0);for(Dt=lr;Dt!==0;Dt--)for(sr=$e.bl_count[Dt];sr!==0;)Pr=$e.heap[--Ct],Pr>_t||(Wt[2*Pr+1]!==Dt&&($e.opt_len+=(Dt-Wt[2*Pr+1])*Wt[2*Pr],Wt[2*Pr+1]=Dt),sr--)}})(p,$),ge(y,Ne,p.bl_count)},K=(p,$,y)=>{let be,_e,ve=-1,Ke=$[1],ze=0,gt=7,Ne=4;for(Ke===0&&(gt=138,Ne=3),$[2*(y+1)+1]=65535,be=0;be<=y;be++)_e=Ke,Ke=$[2*(be+1)+1],++ze<gt&&_e===Ke||(ze<Ne?p.bl_tree[2*_e]+=ze:_e!==0?(_e!==ve&&p.bl_tree[2*_e]++,p.bl_tree[32]++):ze<=10?p.bl_tree[34]++:p.bl_tree[36]++,ze=0,ve=_e,Ke===0?(gt=138,Ne=3):_e===Ke?(gt=6,Ne=3):(gt=7,Ne=4))},Re=(p,$,y)=>{let be,_e,ve=-1,Ke=$[1],ze=0,gt=7,Ne=4;for(Ke===0&&(gt=138,Ne=3),be=0;be<=y;be++)if(_e=Ke,Ke=$[2*(be+1)+1],!(++ze<gt&&_e===Ke)){if(ze<Ne)do Ae(p,_e,p.bl_tree);while(--ze!==0);else _e!==0?(_e!==ve&&(Ae(p,_e,p.bl_tree),ze--),Ae(p,16,p.bl_tree),ee(p,ze-3,2)):ze<=10?(Ae(p,17,p.bl_tree),ee(p,ze-3,3)):(Ae(p,18,p.bl_tree),ee(p,ze-11,7));ze=0,ve=_e,Ke===0?(gt=138,Ne=3):_e===Ke?(gt=6,Ne=3):(gt=7,Ne=4)}};let fe=!1;const De=(p,$,y,be)=>{ee(p,0+(be?1:0),3),Me(p),O(p,y),O(p,~y),y&&p.pending_buf.set(p.window.subarray($,$+y),p.pending),p.pending+=y};var We=(p,$,y,be)=>{let _e,ve,Ke=0;p.level>0?(p.strm.data_type===2&&(p.strm.data_type=(ze=>{let gt,Ne=4093624447;for(gt=0;gt<=31;gt++,Ne>>>=1)if(1&Ne&&ze.dyn_ltree[2*gt]!==0)return 0;if(ze.dyn_ltree[18]!==0||ze.dyn_ltree[20]!==0||ze.dyn_ltree[26]!==0)return 1;for(gt=32;gt<d;gt++)if(ze.dyn_ltree[2*gt]!==0)return 1;return 0})(p)),se(p,p.l_desc),se(p,p.d_desc),Ke=(ze=>{let gt;for(K(ze,ze.dyn_ltree,ze.l_desc.max_code),K(ze,ze.dyn_dtree,ze.d_desc.max_code),se(ze,ze.bl_desc),gt=18;gt>=3&&ze.bl_tree[2*x[gt]+1]===0;gt--);return ze.opt_len+=3*(gt+1)+5+5+4,gt})(p),_e=p.opt_len+3+7>>>3,ve=p.static_len+3+7>>>3,ve<=_e&&(_e=ve)):_e=ve=y+5,y+4<=_e&&$!==-1?De(p,$,y,be):p.strategy===4||ve===_e?(ee(p,2+(be?1:0),3),he(p,k,F)):(ee(p,4+(be?1:0),3),((ze,gt,Ne,$e)=>{let dr;for(ee(ze,gt-257,5),ee(ze,Ne-1,5),ee(ze,$e-4,4),dr=0;dr<$e;dr++)ee(ze,ze.bl_tree[2*x[dr]+1],3);Re(ze,ze.dyn_ltree,gt-1),Re(ze,ze.dyn_dtree,Ne-1)})(p,p.l_desc.max_code+1,p.d_desc.max_code+1,Ke+1),he(p,p.dyn_ltree,p.dyn_dtree)),me(p),be&&Me(p)},oe={_tr_init:p=>{fe||((()=>{let $,y,be,_e,ve;const Ke=new Array(16);for(be=0,_e=0;_e<28;_e++)for(Q[_e]=be,$=0;$<1<<m[_e];$++)z[be++]=_e;for(z[be-1]=_e,ve=0,_e=0;_e<16;_e++)for(J[_e]=ve,$=0;$<1<<b[_e];$++)C[ve++]=_e;for(ve>>=7;_e<u;_e++)for(J[_e]=ve<<7,$=0;$<1<<b[_e]-7;$++)C[256+ve++]=_e;for(y=0;y<=v;y++)Ke[y]=0;for($=0;$<=143;)k[2*$+1]=8,$++,Ke[8]++;for(;$<=255;)k[2*$+1]=9,$++,Ke[9]++;for(;$<=279;)k[2*$+1]=7,$++,Ke[7]++;for(;$<=287;)k[2*$+1]=8,$++,Ke[8]++;for(ge(k,287,Ke),$=0;$<u;$++)F[2*$+1]=5,F[2*$]=ce($,5);w=new q(k,m,257,R,v),N=new q(F,b,0,u,v),V=new q(new Array(0),T,0,19,7)})(),fe=!0),p.l_desc=new H(p.dyn_ltree,w),p.d_desc=new H(p.dyn_dtree,N),p.bl_desc=new H(p.bl_tree,V),p.bi_buf=0,p.bi_valid=0,me(p)},_tr_stored_block:De,_tr_flush_block:We,_tr_tally:(p,$,y)=>(p.pending_buf[p.sym_buf+p.sym_next++]=$,p.pending_buf[p.sym_buf+p.sym_next++]=$>>8,p.pending_buf[p.sym_buf+p.sym_next++]=y,$===0?p.dyn_ltree[2*y]++:(p.matches++,$--,p.dyn_ltree[2*(z[y]+d+1)]++,p.dyn_dtree[2*Y($)]++),p.sym_next===p.sym_end),_tr_align:p=>{ee(p,2,3),Ae(p,256,k),($=>{$.bi_valid===16?(O($,$.bi_buf),$.bi_buf=0,$.bi_valid=0):$.bi_valid>=8&&($.pending_buf[$.pending++]=255&$.bi_buf,$.bi_buf>>=8,$.bi_valid-=8)})(p)}},Ee=(p,$,y,be)=>{let _e=65535&p,ve=p>>>16&65535,Ke=0;for(;y!==0;){Ke=y>2e3?2e3:y,y-=Ke;do _e=_e+$[be++]|0,ve=ve+_e|0;while(--Ke);_e%=65521,ve%=65521}return _e|ve<<16};const He=new Uint32Array((()=>{let p,$=[];for(var y=0;y<256;y++){p=y;for(var be=0;be<8;be++)p=1&p?3988292384^p>>>1:p>>>1;$[y]=p}return $})());var Ue=(p,$,y,be)=>{const _e=He,ve=be+y;p^=-1;for(let Ke=be;Ke<ve;Ke++)p=p>>>8^_e[255&(p^$[Ke])];return-1^p},Ie={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},rt={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:st,_tr_stored_block:at,_tr_flush_block:Ft,_tr_tally:At,_tr_align:or}=oe,{Z_NO_FLUSH:ar,Z_PARTIAL_FLUSH:kr,Z_FULL_FLUSH:Er,Z_FINISH:pr,Z_BLOCK:vr,Z_OK:xr,Z_STREAM_END:fi,Z_STREAM_ERROR:Rr,Z_DATA_ERROR:Ir,Z_BUF_ERROR:Di,Z_DEFAULT_COMPRESSION:wi,Z_FILTERED:Hi,Z_HUFFMAN_ONLY:pe,Z_RLE:Se,Z_FIXED:Le,Z_DEFAULT_STRATEGY:dt,Z_UNKNOWN:nt,Z_DEFLATED:zt}=rt,ht=258,Lt=262,Ut=42,It=113,mr=666,li=(p,$)=>(p.msg=Ie[$],$),Ai=p=>2*p-(p>4?9:0),ui=p=>{let $=p.length;for(;--$>=0;)p[$]=0},gi=p=>{let $,y,be,_e=p.w_size;$=p.hash_size,be=$;do y=p.head[--be],p.head[be]=y>=_e?y-_e:0;while(--$);$=_e,be=$;do y=p.prev[--be],p.prev[be]=y>=_e?y-_e:0;while(--$)};let jr=(p,$,y)=>($<<p.hash_shift^y)&p.hash_mask;const Lr=p=>{const $=p.state;let y=$.pending;y>p.avail_out&&(y=p.avail_out),y!==0&&(p.output.set($.pending_buf.subarray($.pending_out,$.pending_out+y),p.next_out),p.next_out+=y,$.pending_out+=y,p.total_out+=y,p.avail_out-=y,$.pending-=y,$.pending===0&&($.pending_out=0))},Dr=(p,$)=>{Ft(p,p.block_start>=0?p.block_start:-1,p.strstart-p.block_start,$),p.block_start=p.strstart,Lr(p.strm)},rr=(p,$)=>{p.pending_buf[p.pending++]=$},vi=(p,$)=>{p.pending_buf[p.pending++]=$>>>8&255,p.pending_buf[p.pending++]=255&$},bi=(p,$,y,be)=>{let _e=p.avail_in;return _e>be&&(_e=be),_e===0?0:(p.avail_in-=_e,$.set(p.input.subarray(p.next_in,p.next_in+_e),y),p.state.wrap===1?p.adler=Ee(p.adler,$,_e,y):p.state.wrap===2&&(p.adler=Ue(p.adler,$,_e,y)),p.next_in+=_e,p.total_in+=_e,_e)},$i=(p,$)=>{let y,be,_e=p.max_chain_length,ve=p.strstart,Ke=p.prev_length,ze=p.nice_match;const gt=p.strstart>p.w_size-Lt?p.strstart-(p.w_size-Lt):0,Ne=p.window,$e=p.w_mask,dr=p.prev,Wt=p.strstart+ht;let _t=Ne[ve+Ke-1],si=Ne[ve+Ke];p.prev_length>=p.good_match&&(_e>>=2),ze>p.lookahead&&(ze=p.lookahead);do if(y=$,Ne[y+Ke]===si&&Ne[y+Ke-1]===_t&&Ne[y]===Ne[ve]&&Ne[++y]===Ne[ve+1]){ve+=2,y++;do;while(Ne[++ve]===Ne[++y]&&Ne[++ve]===Ne[++y]&&Ne[++ve]===Ne[++y]&&Ne[++ve]===Ne[++y]&&Ne[++ve]===Ne[++y]&&Ne[++ve]===Ne[++y]&&Ne[++ve]===Ne[++y]&&Ne[++ve]===Ne[++y]&&ve<Wt);if(be=ht-(Wt-ve),ve=Wt-ht,be>Ke){if(p.match_start=$,Ke=be,be>=ze)break;_t=Ne[ve+Ke-1],si=Ne[ve+Ke]}}while(($=dr[$&$e])>gt&&--_e!==0);return Ke<=p.lookahead?Ke:p.lookahead},Ci=p=>{const $=p.w_size;let y,be,_e;do{if(be=p.window_size-p.lookahead-p.strstart,p.strstart>=$+($-Lt)&&(p.window.set(p.window.subarray($,$+$-be),0),p.match_start-=$,p.strstart-=$,p.block_start-=$,p.insert>p.strstart&&(p.insert=p.strstart),gi(p),be+=$),p.strm.avail_in===0)break;if(y=bi(p.strm,p.window,p.strstart+p.lookahead,be),p.lookahead+=y,p.lookahead+p.insert>=3)for(_e=p.strstart-p.insert,p.ins_h=p.window[_e],p.ins_h=jr(p,p.ins_h,p.window[_e+1]);p.insert&&(p.ins_h=jr(p,p.ins_h,p.window[_e+3-1]),p.prev[_e&p.w_mask]=p.head[p.ins_h],p.head[p.ins_h]=_e,_e++,p.insert--,!(p.lookahead+p.insert<3)););}while(p.lookahead<Lt&&p.strm.avail_in!==0)},Ni=(p,$)=>{let y,be,_e,ve=p.pending_buf_size-5>p.w_size?p.w_size:p.pending_buf_size-5,Ke=0,ze=p.strm.avail_in;do{if(y=65535,_e=p.bi_valid+42>>3,p.strm.avail_out<_e||(_e=p.strm.avail_out-_e,be=p.strstart-p.block_start,y>be+p.strm.avail_in&&(y=be+p.strm.avail_in),y>_e&&(y=_e),y<ve&&(y===0&&$!==pr||$===ar||y!==be+p.strm.avail_in)))break;Ke=$===pr&&y===be+p.strm.avail_in?1:0,at(p,0,0,Ke),p.pending_buf[p.pending-4]=y,p.pending_buf[p.pending-3]=y>>8,p.pending_buf[p.pending-2]=~y,p.pending_buf[p.pending-1]=~y>>8,Lr(p.strm),be&&(be>y&&(be=y),p.strm.output.set(p.window.subarray(p.block_start,p.block_start+be),p.strm.next_out),p.strm.next_out+=be,p.strm.avail_out-=be,p.strm.total_out+=be,p.block_start+=be,y-=be),y&&(bi(p.strm,p.strm.output,p.strm.next_out,y),p.strm.next_out+=y,p.strm.avail_out-=y,p.strm.total_out+=y)}while(Ke===0);return ze-=p.strm.avail_in,ze&&(ze>=p.w_size?(p.matches=2,p.window.set(p.strm.input.subarray(p.strm.next_in-p.w_size,p.strm.next_in),0),p.strstart=p.w_size,p.insert=p.strstart):(p.window_size-p.strstart<=ze&&(p.strstart-=p.w_size,p.window.set(p.window.subarray(p.w_size,p.w_size+p.strstart),0),p.matches<2&&p.matches++,p.insert>p.strstart&&(p.insert=p.strstart)),p.window.set(p.strm.input.subarray(p.strm.next_in-ze,p.strm.next_in),p.strstart),p.strstart+=ze,p.insert+=ze>p.w_size-p.insert?p.w_size-p.insert:ze),p.block_start=p.strstart),p.high_water<p.strstart&&(p.high_water=p.strstart),Ke?4:$!==ar&&$!==pr&&p.strm.avail_in===0&&p.strstart===p.block_start?2:(_e=p.window_size-p.strstart,p.strm.avail_in>_e&&p.block_start>=p.w_size&&(p.block_start-=p.w_size,p.strstart-=p.w_size,p.window.set(p.window.subarray(p.w_size,p.w_size+p.strstart),0),p.matches<2&&p.matches++,_e+=p.w_size,p.insert>p.strstart&&(p.insert=p.strstart)),_e>p.strm.avail_in&&(_e=p.strm.avail_in),_e&&(bi(p.strm,p.window,p.strstart,_e),p.strstart+=_e,p.insert+=_e>p.w_size-p.insert?p.w_size-p.insert:_e),p.high_water<p.strstart&&(p.high_water=p.strstart),_e=p.bi_valid+42>>3,_e=p.pending_buf_size-_e>65535?65535:p.pending_buf_size-_e,ve=_e>p.w_size?p.w_size:_e,be=p.strstart-p.block_start,(be>=ve||(be||$===pr)&&$!==ar&&p.strm.avail_in===0&&be<=_e)&&(y=be>_e?_e:be,Ke=$===pr&&p.strm.avail_in===0&&y===be?1:0,at(p,p.block_start,y,Ke),p.block_start+=y,Lr(p.strm)),Ke?3:1)},Ti=(p,$)=>{let y,be;for(;;){if(p.lookahead<Lt){if(Ci(p),p.lookahead<Lt&&$===ar)return 1;if(p.lookahead===0)break}if(y=0,p.lookahead>=3&&(p.ins_h=jr(p,p.ins_h,p.window[p.strstart+3-1]),y=p.prev[p.strstart&p.w_mask]=p.head[p.ins_h],p.head[p.ins_h]=p.strstart),y!==0&&p.strstart-y<=p.w_size-Lt&&(p.match_length=$i(p,y)),p.match_length>=3)if(be=At(p,p.strstart-p.match_start,p.match_length-3),p.lookahead-=p.match_length,p.match_length<=p.max_lazy_match&&p.lookahead>=3){p.match_length--;do p.strstart++,p.ins_h=jr(p,p.ins_h,p.window[p.strstart+3-1]),y=p.prev[p.strstart&p.w_mask]=p.head[p.ins_h],p.head[p.ins_h]=p.strstart;while(--p.match_length!==0);p.strstart++}else p.strstart+=p.match_length,p.match_length=0,p.ins_h=p.window[p.strstart],p.ins_h=jr(p,p.ins_h,p.window[p.strstart+1]);else be=At(p,0,p.window[p.strstart]),p.lookahead--,p.strstart++;if(be&&(Dr(p,!1),p.strm.avail_out===0))return 1}return p.insert=p.strstart<2?p.strstart:2,$===pr?(Dr(p,!0),p.strm.avail_out===0?3:4):p.sym_next&&(Dr(p,!1),p.strm.avail_out===0)?1:2},pi=(p,$)=>{let y,be,_e;for(;;){if(p.lookahead<Lt){if(Ci(p),p.lookahead<Lt&&$===ar)return 1;if(p.lookahead===0)break}if(y=0,p.lookahead>=3&&(p.ins_h=jr(p,p.ins_h,p.window[p.strstart+3-1]),y=p.prev[p.strstart&p.w_mask]=p.head[p.ins_h],p.head[p.ins_h]=p.strstart),p.prev_length=p.match_length,p.prev_match=p.match_start,p.match_length=2,y!==0&&p.prev_length<p.max_lazy_match&&p.strstart-y<=p.w_size-Lt&&(p.match_length=$i(p,y),p.match_length<=5&&(p.strategy===Hi||p.match_length===3&&p.strstart-p.match_start>4096)&&(p.match_length=2)),p.prev_length>=3&&p.match_length<=p.prev_length){_e=p.strstart+p.lookahead-3,be=At(p,p.strstart-1-p.prev_match,p.prev_length-3),p.lookahead-=p.prev_length-1,p.prev_length-=2;do++p.strstart<=_e&&(p.ins_h=jr(p,p.ins_h,p.window[p.strstart+3-1]),y=p.prev[p.strstart&p.w_mask]=p.head[p.ins_h],p.head[p.ins_h]=p.strstart);while(--p.prev_length!==0);if(p.match_available=0,p.match_length=2,p.strstart++,be&&(Dr(p,!1),p.strm.avail_out===0))return 1}else if(p.match_available){if(be=At(p,0,p.window[p.strstart-1]),be&&Dr(p,!1),p.strstart++,p.lookahead--,p.strm.avail_out===0)return 1}else p.match_available=1,p.strstart++,p.lookahead--}return p.match_available&&(be=At(p,0,p.window[p.strstart-1]),p.match_available=0),p.insert=p.strstart<2?p.strstart:2,$===pr?(Dr(p,!0),p.strm.avail_out===0?3:4):p.sym_next&&(Dr(p,!1),p.strm.avail_out===0)?1:2};function Br(p,$,y,be,_e){this.good_length=p,this.max_lazy=$,this.nice_length=y,this.max_chain=be,this.func=_e}const Zr=[new Br(0,0,0,0,Ni),new Br(4,4,8,4,Ti),new Br(4,5,16,8,Ti),new Br(4,6,32,32,Ti),new Br(4,4,16,16,pi),new Br(8,16,32,32,pi),new Br(8,16,128,128,pi),new Br(8,32,128,256,pi),new Br(32,128,258,1024,pi),new Br(32,258,258,4096,pi)];function Vi(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=zt,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),ui(this.dyn_ltree),ui(this.dyn_dtree),ui(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),ui(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),ui(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const yi=p=>{if(!p)return 1;const $=p.state;return!$||$.strm!==p||$.status!==Ut&&$.status!==57&&$.status!==69&&$.status!==73&&$.status!==91&&$.status!==103&&$.status!==It&&$.status!==mr?1:0},Wi=p=>{if(yi(p))return li(p,Rr);p.total_in=p.total_out=0,p.data_type=nt;const $=p.state;return $.pending=0,$.pending_out=0,$.wrap<0&&($.wrap=-$.wrap),$.status=$.wrap===2?57:$.wrap?Ut:It,p.adler=$.wrap===2?0:1,$.last_flush=-2,st($),xr},tn=p=>{const $=Wi(p);var y;return $===xr&&((y=p.state).window_size=2*y.w_size,ui(y.head),y.max_lazy_match=Zr[y.level].max_lazy,y.good_match=Zr[y.level].good_length,y.nice_match=Zr[y.level].nice_length,y.max_chain_length=Zr[y.level].max_chain,y.strstart=0,y.block_start=0,y.lookahead=0,y.insert=0,y.match_length=y.prev_length=2,y.match_available=0,y.ins_h=0),$},on=(p,$,y,be,_e,ve)=>{if(!p)return Rr;let Ke=1;if($===wi&&($=6),be<0?(Ke=0,be=-be):be>15&&(Ke=2,be-=16),_e<1||_e>9||y!==zt||be<8||be>15||$<0||$>9||ve<0||ve>Le||be===8&&Ke!==1)return li(p,Rr);be===8&&(be=9);const ze=new Vi;return p.state=ze,ze.strm=p,ze.status=Ut,ze.wrap=Ke,ze.gzhead=null,ze.w_bits=be,ze.w_size=1<<ze.w_bits,ze.w_mask=ze.w_size-1,ze.hash_bits=_e+7,ze.hash_size=1<<ze.hash_bits,ze.hash_mask=ze.hash_size-1,ze.hash_shift=~~((ze.hash_bits+3-1)/3),ze.window=new Uint8Array(2*ze.w_size),ze.head=new Uint16Array(ze.hash_size),ze.prev=new Uint16Array(ze.w_size),ze.lit_bufsize=1<<_e+6,ze.pending_buf_size=4*ze.lit_bufsize,ze.pending_buf=new Uint8Array(ze.pending_buf_size),ze.sym_buf=ze.lit_bufsize,ze.sym_end=3*(ze.lit_bufsize-1),ze.level=$,ze.strategy=ve,ze.method=y,tn(p)};var ur={deflateInit:(p,$)=>on(p,$,zt,15,8,dt),deflateInit2:on,deflateReset:tn,deflateResetKeep:Wi,deflateSetHeader:(p,$)=>yi(p)||p.state.wrap!==2?Rr:(p.state.gzhead=$,xr),deflate:(p,$)=>{if(yi(p)||$>vr||$<0)return p?li(p,Rr):Rr;const y=p.state;if(!p.output||p.avail_in!==0&&!p.input||y.status===mr&&$!==pr)return li(p,p.avail_out===0?Di:Rr);const be=y.last_flush;if(y.last_flush=$,y.pending!==0){if(Lr(p),p.avail_out===0)return y.last_flush=-1,xr}else if(p.avail_in===0&&Ai($)<=Ai(be)&&$!==pr)return li(p,Di);if(y.status===mr&&p.avail_in!==0)return li(p,Di);if(y.status===Ut&&y.wrap===0&&(y.status=It),y.status===Ut){let _e=zt+(y.w_bits-8<<4)<<8,ve=-1;if(ve=y.strategy>=pe||y.level<2?0:y.level<6?1:y.level===6?2:3,_e|=ve<<6,y.strstart!==0&&(_e|=32),_e+=31-_e%31,vi(y,_e),y.strstart!==0&&(vi(y,p.adler>>>16),vi(y,65535&p.adler)),p.adler=1,y.status=It,Lr(p),y.pending!==0)return y.last_flush=-1,xr}if(y.status===57){if(p.adler=0,rr(y,31),rr(y,139),rr(y,8),y.gzhead)rr(y,(y.gzhead.text?1:0)+(y.gzhead.hcrc?2:0)+(y.gzhead.extra?4:0)+(y.gzhead.name?8:0)+(y.gzhead.comment?16:0)),rr(y,255&y.gzhead.time),rr(y,y.gzhead.time>>8&255),rr(y,y.gzhead.time>>16&255),rr(y,y.gzhead.time>>24&255),rr(y,y.level===9?2:y.strategy>=pe||y.level<2?4:0),rr(y,255&y.gzhead.os),y.gzhead.extra&&y.gzhead.extra.length&&(rr(y,255&y.gzhead.extra.length),rr(y,y.gzhead.extra.length>>8&255)),y.gzhead.hcrc&&(p.adler=Ue(p.adler,y.pending_buf,y.pending,0)),y.gzindex=0,y.status=69;else if(rr(y,0),rr(y,0),rr(y,0),rr(y,0),rr(y,0),rr(y,y.level===9?2:y.strategy>=pe||y.level<2?4:0),rr(y,3),y.status=It,Lr(p),y.pending!==0)return y.last_flush=-1,xr}if(y.status===69){if(y.gzhead.extra){let _e=y.pending,ve=(65535&y.gzhead.extra.length)-y.gzindex;for(;y.pending+ve>y.pending_buf_size;){let ze=y.pending_buf_size-y.pending;if(y.pending_buf.set(y.gzhead.extra.subarray(y.gzindex,y.gzindex+ze),y.pending),y.pending=y.pending_buf_size,y.gzhead.hcrc&&y.pending>_e&&(p.adler=Ue(p.adler,y.pending_buf,y.pending-_e,_e)),y.gzindex+=ze,Lr(p),y.pending!==0)return y.last_flush=-1,xr;_e=0,ve-=ze}let Ke=new Uint8Array(y.gzhead.extra);y.pending_buf.set(Ke.subarray(y.gzindex,y.gzindex+ve),y.pending),y.pending+=ve,y.gzhead.hcrc&&y.pending>_e&&(p.adler=Ue(p.adler,y.pending_buf,y.pending-_e,_e)),y.gzindex=0}y.status=73}if(y.status===73){if(y.gzhead.name){let _e,ve=y.pending;do{if(y.pending===y.pending_buf_size){if(y.gzhead.hcrc&&y.pending>ve&&(p.adler=Ue(p.adler,y.pending_buf,y.pending-ve,ve)),Lr(p),y.pending!==0)return y.last_flush=-1,xr;ve=0}_e=y.gzindex<y.gzhead.name.length?255&y.gzhead.name.charCodeAt(y.gzindex++):0,rr(y,_e)}while(_e!==0);y.gzhead.hcrc&&y.pending>ve&&(p.adler=Ue(p.adler,y.pending_buf,y.pending-ve,ve)),y.gzindex=0}y.status=91}if(y.status===91){if(y.gzhead.comment){let _e,ve=y.pending;do{if(y.pending===y.pending_buf_size){if(y.gzhead.hcrc&&y.pending>ve&&(p.adler=Ue(p.adler,y.pending_buf,y.pending-ve,ve)),Lr(p),y.pending!==0)return y.last_flush=-1,xr;ve=0}_e=y.gzindex<y.gzhead.comment.length?255&y.gzhead.comment.charCodeAt(y.gzindex++):0,rr(y,_e)}while(_e!==0);y.gzhead.hcrc&&y.pending>ve&&(p.adler=Ue(p.adler,y.pending_buf,y.pending-ve,ve))}y.status=103}if(y.status===103){if(y.gzhead.hcrc){if(y.pending+2>y.pending_buf_size&&(Lr(p),y.pending!==0))return y.last_flush=-1,xr;rr(y,255&p.adler),rr(y,p.adler>>8&255),p.adler=0}if(y.status=It,Lr(p),y.pending!==0)return y.last_flush=-1,xr}if(p.avail_in!==0||y.lookahead!==0||$!==ar&&y.status!==mr){let _e=y.level===0?Ni(y,$):y.strategy===pe?((ve,Ke)=>{let ze;for(;;){if(ve.lookahead===0&&(Ci(ve),ve.lookahead===0)){if(Ke===ar)return 1;break}if(ve.match_length=0,ze=At(ve,0,ve.window[ve.strstart]),ve.lookahead--,ve.strstart++,ze&&(Dr(ve,!1),ve.strm.avail_out===0))return 1}return ve.insert=0,Ke===pr?(Dr(ve,!0),ve.strm.avail_out===0?3:4):ve.sym_next&&(Dr(ve,!1),ve.strm.avail_out===0)?1:2})(y,$):y.strategy===Se?((ve,Ke)=>{let ze,gt,Ne,$e;const dr=ve.window;for(;;){if(ve.lookahead<=ht){if(Ci(ve),ve.lookahead<=ht&&Ke===ar)return 1;if(ve.lookahead===0)break}if(ve.match_length=0,ve.lookahead>=3&&ve.strstart>0&&(Ne=ve.strstart-1,gt=dr[Ne],gt===dr[++Ne]&&gt===dr[++Ne]&&gt===dr[++Ne])){$e=ve.strstart+ht;do;while(gt===dr[++Ne]&&gt===dr[++Ne]&&gt===dr[++Ne]&&gt===dr[++Ne]&&gt===dr[++Ne]&&gt===dr[++Ne]&&gt===dr[++Ne]&&gt===dr[++Ne]&&Ne<$e);ve.match_length=ht-($e-Ne),ve.match_length>ve.lookahead&&(ve.match_length=ve.lookahead)}if(ve.match_length>=3?(ze=At(ve,1,ve.match_length-3),ve.lookahead-=ve.match_length,ve.strstart+=ve.match_length,ve.match_length=0):(ze=At(ve,0,ve.window[ve.strstart]),ve.lookahead--,ve.strstart++),ze&&(Dr(ve,!1),ve.strm.avail_out===0))return 1}return ve.insert=0,Ke===pr?(Dr(ve,!0),ve.strm.avail_out===0?3:4):ve.sym_next&&(Dr(ve,!1),ve.strm.avail_out===0)?1:2})(y,$):Zr[y.level].func(y,$);if(_e!==3&&_e!==4||(y.status=mr),_e===1||_e===3)return p.avail_out===0&&(y.last_flush=-1),xr;if(_e===2&&($===kr?or(y):$!==vr&&(at(y,0,0,!1),$===Er&&(ui(y.head),y.lookahead===0&&(y.strstart=0,y.block_start=0,y.insert=0))),Lr(p),p.avail_out===0))return y.last_flush=-1,xr}return $!==pr?xr:y.wrap<=0?fi:(y.wrap===2?(rr(y,255&p.adler),rr(y,p.adler>>8&255),rr(y,p.adler>>16&255),rr(y,p.adler>>24&255),rr(y,255&p.total_in),rr(y,p.total_in>>8&255),rr(y,p.total_in>>16&255),rr(y,p.total_in>>24&255)):(vi(y,p.adler>>>16),vi(y,65535&p.adler)),Lr(p),y.wrap>0&&(y.wrap=-y.wrap),y.pending!==0?xr:fi)},deflateEnd:p=>{if(yi(p))return Rr;const $=p.state.status;return p.state=null,$===It?li(p,Ir):xr},deflateSetDictionary:(p,$)=>{let y=$.length;if(yi(p))return Rr;const be=p.state,_e=be.wrap;if(_e===2||_e===1&&be.status!==Ut||be.lookahead)return Rr;if(_e===1&&(p.adler=Ee(p.adler,$,y,0)),be.wrap=0,y>=be.w_size){_e===0&&(ui(be.head),be.strstart=0,be.block_start=0,be.insert=0);let gt=new Uint8Array(be.w_size);gt.set($.subarray(y-be.w_size,y),0),$=gt,y=be.w_size}const ve=p.avail_in,Ke=p.next_in,ze=p.input;for(p.avail_in=y,p.next_in=0,p.input=$,Ci(be);be.lookahead>=3;){let gt=be.strstart,Ne=be.lookahead-2;do be.ins_h=jr(be,be.ins_h,be.window[gt+3-1]),be.prev[gt&be.w_mask]=be.head[be.ins_h],be.head[be.ins_h]=gt,gt++;while(--Ne);be.strstart=gt,be.lookahead=2,Ci(be)}return be.strstart+=be.lookahead,be.block_start=be.strstart,be.insert=be.lookahead,be.lookahead=0,be.match_length=be.prev_length=2,be.match_available=0,p.next_in=Ke,p.input=ze,p.avail_in=ve,be.wrap=_e,xr},deflateInfo:"pako deflate (from Nodeca project)"};const Gr=(p,$)=>Object.prototype.hasOwnProperty.call(p,$);var $r=function(p){const $=Array.prototype.slice.call(arguments,1);for(;$.length;){const y=$.shift();if(y){if(typeof y!="object")throw new TypeError(y+"must be non-object");for(const be in y)Gr(y,be)&&(p[be]=y[be])}}return p},qi=p=>{let $=0;for(let be=0,_e=p.length;be<_e;be++)$+=p[be].length;const y=new Uint8Array($);for(let be=0,_e=0,ve=p.length;be<ve;be++){let Ke=p[be];y.set(Ke,_e),_e+=Ke.length}return y};let Bt=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Bt=!1}const _=new Uint8Array(256);for(let p=0;p<256;p++)_[p]=p>=252?6:p>=248?5:p>=240?4:p>=224?3:p>=192?2:1;_[254]=_[254]=1;var ne=p=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(p);let $,y,be,_e,ve,Ke=p.length,ze=0;for(_e=0;_e<Ke;_e++)y=p.charCodeAt(_e),(64512&y)==55296&&_e+1<Ke&&(be=p.charCodeAt(_e+1),(64512&be)==56320&&(y=65536+(y-55296<<10)+(be-56320),_e++)),ze+=y<128?1:y<2048?2:y<65536?3:4;for($=new Uint8Array(ze),ve=0,_e=0;ve<ze;_e++)y=p.charCodeAt(_e),(64512&y)==55296&&_e+1<Ke&&(be=p.charCodeAt(_e+1),(64512&be)==56320&&(y=65536+(y-55296<<10)+(be-56320),_e++)),y<128?$[ve++]=y:y<2048?($[ve++]=192|y>>>6,$[ve++]=128|63&y):y<65536?($[ve++]=224|y>>>12,$[ve++]=128|y>>>6&63,$[ve++]=128|63&y):($[ve++]=240|y>>>18,$[ve++]=128|y>>>12&63,$[ve++]=128|y>>>6&63,$[ve++]=128|63&y);return $},xe=(p,$)=>{const y=$||p.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(p.subarray(0,$));let be,_e;const ve=new Array(2*y);for(_e=0,be=0;be<y;){let Ke=p[be++];if(Ke<128){ve[_e++]=Ke;continue}let ze=_[Ke];if(ze>4)ve[_e++]=65533,be+=ze-1;else{for(Ke&=ze===2?31:ze===3?15:7;ze>1&&be<y;)Ke=Ke<<6|63&p[be++],ze--;ze>1?ve[_e++]=65533:Ke<65536?ve[_e++]=Ke:(Ke-=65536,ve[_e++]=55296|Ke>>10&1023,ve[_e++]=56320|1023&Ke)}}return((Ke,ze)=>{if(ze<65534&&Ke.subarray&&Bt)return String.fromCharCode.apply(null,Ke.length===ze?Ke:Ke.subarray(0,ze));let gt="";for(let Ne=0;Ne<ze;Ne++)gt+=String.fromCharCode(Ke[Ne]);return gt})(ve,_e)},Ve=(p,$)=>{($=$||p.length)>p.length&&($=p.length);let y=$-1;for(;y>=0&&(192&p[y])==128;)y--;return y<0||y===0?$:y+_[p[y]]>$?y:$},Oe=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const yt=Object.prototype.toString,{Z_NO_FLUSH:lt,Z_SYNC_FLUSH:mt,Z_FULL_FLUSH:Mt,Z_FINISH:Pt,Z_OK:Ot,Z_STREAM_END:gr,Z_DEFAULT_COMPRESSION:Zt,Z_DEFAULT_STRATEGY:Ar,Z_DEFLATED:Cr}=rt;function Ur(p){this.options=$r({level:Zt,method:Cr,chunkSize:16384,windowBits:15,memLevel:8,strategy:Ar},p||{});let $=this.options;$.raw&&$.windowBits>0?$.windowBits=-$.windowBits:$.gzip&&$.windowBits>0&&$.windowBits<16&&($.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Oe,this.strm.avail_out=0;let y=ur.deflateInit2(this.strm,$.level,$.method,$.windowBits,$.memLevel,$.strategy);if(y!==Ot)throw new Error(Ie[y]);if($.header&&ur.deflateSetHeader(this.strm,$.header),$.dictionary){let be;if(be=typeof $.dictionary=="string"?ne($.dictionary):yt.call($.dictionary)==="[object ArrayBuffer]"?new Uint8Array($.dictionary):$.dictionary,y=ur.deflateSetDictionary(this.strm,be),y!==Ot)throw new Error(Ie[y]);this._dict_set=!0}}function _r(p,$){const y=new Ur($);if(y.push(p,!0),y.err)throw y.msg||Ie[y.err];return y.result}Ur.prototype.push=function(p,$){const y=this.strm,be=this.options.chunkSize;let _e,ve;if(this.ended)return!1;for(ve=$===~~$?$:$===!0?Pt:lt,typeof p=="string"?y.input=ne(p):yt.call(p)==="[object ArrayBuffer]"?y.input=new Uint8Array(p):y.input=p,y.next_in=0,y.avail_in=y.input.length;;)if(y.avail_out===0&&(y.output=new Uint8Array(be),y.next_out=0,y.avail_out=be),(ve===mt||ve===Mt)&&y.avail_out<=6)this.onData(y.output.subarray(0,y.next_out)),y.avail_out=0;else{if(_e=ur.deflate(y,ve),_e===gr)return y.next_out>0&&this.onData(y.output.subarray(0,y.next_out)),_e=ur.deflateEnd(this.strm),this.onEnd(_e),this.ended=!0,_e===Ot;if(y.avail_out!==0){if(ve>0&&y.next_out>0)this.onData(y.output.subarray(0,y.next_out)),y.avail_out=0;else if(y.avail_in===0)break}else this.onData(y.output)}return!0},Ur.prototype.onData=function(p){this.chunks.push(p)},Ur.prototype.onEnd=function(p){p===Ot&&(this.result=qi(this.chunks)),this.chunks=[],this.err=p,this.msg=this.strm.msg};var Or={Deflate:Ur,deflate:_r,deflateRaw:function(p,$){return($=$||{}).raw=!0,_r(p,$)},gzip:function(p,$){return($=$||{}).gzip=!0,_r(p,$)}};const wr=16209;var Mi=function(p,$){let y,be,_e,ve,Ke,ze,gt,Ne,$e,dr,Wt,_t,si,Mr,er,zr,lr,Ct,sr,Pr,Dt,Sr,cr,tr;const fr=p.state;y=p.next_in,cr=p.input,be=y+(p.avail_in-5),_e=p.next_out,tr=p.output,ve=_e-($-p.avail_out),Ke=_e+(p.avail_out-257),ze=fr.dmax,gt=fr.wsize,Ne=fr.whave,$e=fr.wnext,dr=fr.window,Wt=fr.hold,_t=fr.bits,si=fr.lencode,Mr=fr.distcode,er=(1<<fr.lenbits)-1,zr=(1<<fr.distbits)-1;e:do{_t<15&&(Wt+=cr[y++]<<_t,_t+=8,Wt+=cr[y++]<<_t,_t+=8),lr=si[Wt&er];t:for(;;){if(Ct=lr>>>24,Wt>>>=Ct,_t-=Ct,Ct=lr>>>16&255,Ct===0)tr[_e++]=65535&lr;else{if(!(16&Ct)){if(64&Ct){if(32&Ct){fr.mode=16191;break e}p.msg="invalid literal/length code",fr.mode=wr;break e}lr=si[(65535&lr)+(Wt&(1<<Ct)-1)];continue t}for(sr=65535&lr,Ct&=15,Ct&&(_t<Ct&&(Wt+=cr[y++]<<_t,_t+=8),sr+=Wt&(1<<Ct)-1,Wt>>>=Ct,_t-=Ct),_t<15&&(Wt+=cr[y++]<<_t,_t+=8,Wt+=cr[y++]<<_t,_t+=8),lr=Mr[Wt&zr];;){if(Ct=lr>>>24,Wt>>>=Ct,_t-=Ct,Ct=lr>>>16&255,16&Ct){if(Pr=65535&lr,Ct&=15,_t<Ct&&(Wt+=cr[y++]<<_t,_t+=8,_t<Ct&&(Wt+=cr[y++]<<_t,_t+=8)),Pr+=Wt&(1<<Ct)-1,Pr>ze){p.msg="invalid distance too far back",fr.mode=wr;break e}if(Wt>>>=Ct,_t-=Ct,Ct=_e-ve,Pr>Ct){if(Ct=Pr-Ct,Ct>Ne&&fr.sane){p.msg="invalid distance too far back",fr.mode=wr;break e}if(Dt=0,Sr=dr,$e===0){if(Dt+=gt-Ct,Ct<sr){sr-=Ct;do tr[_e++]=dr[Dt++];while(--Ct);Dt=_e-Pr,Sr=tr}}else if($e<Ct){if(Dt+=gt+$e-Ct,Ct-=$e,Ct<sr){sr-=Ct;do tr[_e++]=dr[Dt++];while(--Ct);if(Dt=0,$e<sr){Ct=$e,sr-=Ct;do tr[_e++]=dr[Dt++];while(--Ct);Dt=_e-Pr,Sr=tr}}}else if(Dt+=$e-Ct,Ct<sr){sr-=Ct;do tr[_e++]=dr[Dt++];while(--Ct);Dt=_e-Pr,Sr=tr}for(;sr>2;)tr[_e++]=Sr[Dt++],tr[_e++]=Sr[Dt++],tr[_e++]=Sr[Dt++],sr-=3;sr&&(tr[_e++]=Sr[Dt++],sr>1&&(tr[_e++]=Sr[Dt++]))}else{Dt=_e-Pr;do tr[_e++]=tr[Dt++],tr[_e++]=tr[Dt++],tr[_e++]=tr[Dt++],sr-=3;while(sr>2);sr&&(tr[_e++]=tr[Dt++],sr>1&&(tr[_e++]=tr[Dt++]))}break}if(64&Ct){p.msg="invalid distance code",fr.mode=wr;break e}lr=Mr[(65535&lr)+(Wt&(1<<Ct)-1)]}}break}}while(y<be&&_e<Ke);sr=_t>>3,y-=sr,_t-=sr<<3,Wt&=(1<<_t)-1,p.next_in=y,p.next_out=_e,p.avail_in=y<be?be-y+5:5-(y-be),p.avail_out=_e<Ke?Ke-_e+257:257-(_e-Ke),fr.hold=Wt,fr.bits=_t};const Qt=15,ri=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),ae=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),i=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),s=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var l=(p,$,y,be,_e,ve,Ke,ze)=>{const gt=ze.bits;let Ne,$e,dr,Wt,_t,si,Mr=0,er=0,zr=0,lr=0,Ct=0,sr=0,Pr=0,Dt=0,Sr=0,cr=0,tr=null;const fr=new Uint16Array(16),Li=new Uint16Array(16);let Wn,os,Xn,Kn=null;for(Mr=0;Mr<=Qt;Mr++)fr[Mr]=0;for(er=0;er<be;er++)fr[$[y+er]]++;for(Ct=gt,lr=Qt;lr>=1&&fr[lr]===0;lr--);if(Ct>lr&&(Ct=lr),lr===0)return _e[ve++]=20971520,_e[ve++]=20971520,ze.bits=1,0;for(zr=1;zr<lr&&fr[zr]===0;zr++);for(Ct<zr&&(Ct=zr),Dt=1,Mr=1;Mr<=Qt;Mr++)if(Dt<<=1,Dt-=fr[Mr],Dt<0)return-1;if(Dt>0&&(p===0||lr!==1))return-1;for(Li[1]=0,Mr=1;Mr<Qt;Mr++)Li[Mr+1]=Li[Mr]+fr[Mr];for(er=0;er<be;er++)$[y+er]!==0&&(Ke[Li[$[y+er]]++]=er);if(p===0?(tr=Kn=Ke,si=20):p===1?(tr=ri,Kn=ae,si=257):(tr=i,Kn=s,si=0),cr=0,er=0,Mr=zr,_t=ve,sr=Ct,Pr=0,dr=-1,Sr=1<<Ct,Wt=Sr-1,p===1&&Sr>852||p===2&&Sr>592)return 1;for(;;){Wn=Mr-Pr,Ke[er]+1<si?(os=0,Xn=Ke[er]):Ke[er]>=si?(os=Kn[Ke[er]-si],Xn=tr[Ke[er]-si]):(os=96,Xn=0),Ne=1<<Mr-Pr,$e=1<<sr,zr=$e;do $e-=Ne,_e[_t+(cr>>Pr)+$e]=Wn<<24|os<<16|Xn;while($e!==0);for(Ne=1<<Mr-1;cr&Ne;)Ne>>=1;if(Ne!==0?(cr&=Ne-1,cr+=Ne):cr=0,er++,--fr[Mr]===0){if(Mr===lr)break;Mr=$[y+Ke[er]]}if(Mr>Ct&&(cr&Wt)!==dr){for(Pr===0&&(Pr=Ct),_t+=zr,sr=Mr-Pr,Dt=1<<sr;sr+Pr<lr&&(Dt-=fr[sr+Pr],!(Dt<=0));)sr++,Dt<<=1;if(Sr+=1<<sr,p===1&&Sr>852||p===2&&Sr>592)return 1;dr=cr&Wt,_e[dr]=Ct<<24|sr<<16|_t-ve}}return cr!==0&&(_e[_t+cr]=Mr-Pr<<24|64<<16),ze.bits=Ct,0};const{Z_FINISH:h,Z_BLOCK:E,Z_TREES:g,Z_OK:A,Z_STREAM_END:M,Z_NEED_DICT:S,Z_STREAM_ERROR:P,Z_DATA_ERROR:L,Z_MEM_ERROR:X,Z_BUF_ERROR:U,Z_DEFLATED:j}=rt,W=16180,G=16190,Z=16191,te=16192,re=16194,de=16199,le=16200,ye=16206,Pe=16209,Te=p=>(p>>>24&255)+(p>>>8&65280)+((65280&p)<<8)+((255&p)<<24);function ke(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const we=p=>{if(!p)return 1;const $=p.state;return!$||$.strm!==p||$.mode<W||$.mode>16211?1:0},Ge=p=>{if(we(p))return P;const $=p.state;return p.total_in=p.total_out=$.total=0,p.msg="",$.wrap&&(p.adler=1&$.wrap),$.mode=W,$.last=0,$.havedict=0,$.flags=-1,$.dmax=32768,$.head=null,$.hold=0,$.bits=0,$.lencode=$.lendyn=new Int32Array(852),$.distcode=$.distdyn=new Int32Array(592),$.sane=1,$.back=-1,A},Je=p=>{if(we(p))return P;const $=p.state;return $.wsize=0,$.whave=0,$.wnext=0,Ge(p)},tt=(p,$)=>{let y;if(we(p))return P;const be=p.state;return $<0?(y=0,$=-$):(y=5+($>>4),$<48&&($&=15)),$&&($<8||$>15)?P:(be.window!==null&&be.wbits!==$&&(be.window=null),be.wrap=y,be.wbits=$,Je(p))},Ze=(p,$)=>{if(!p)return P;const y=new ke;p.state=y,y.strm=p,y.window=null,y.mode=W;const be=tt(p,$);return be!==A&&(p.state=null),be};let ut,ft,Qe=!0;const pt=p=>{if(Qe){ut=new Int32Array(512),ft=new Int32Array(32);let $=0;for(;$<144;)p.lens[$++]=8;for(;$<256;)p.lens[$++]=9;for(;$<280;)p.lens[$++]=7;for(;$<288;)p.lens[$++]=8;for(l(1,p.lens,0,288,ut,0,p.work,{bits:9}),$=0;$<32;)p.lens[$++]=5;l(2,p.lens,0,32,ft,0,p.work,{bits:5}),Qe=!1}p.lencode=ut,p.lenbits=9,p.distcode=ft,p.distbits=5},Be=(p,$,y,be)=>{let _e;const ve=p.state;return ve.window===null&&(ve.wsize=1<<ve.wbits,ve.wnext=0,ve.whave=0,ve.window=new Uint8Array(ve.wsize)),be>=ve.wsize?(ve.window.set($.subarray(y-ve.wsize,y),0),ve.wnext=0,ve.whave=ve.wsize):(_e=ve.wsize-ve.wnext,_e>be&&(_e=be),ve.window.set($.subarray(y-be,y-be+_e),ve.wnext),(be-=_e)?(ve.window.set($.subarray(y-be,y),0),ve.wnext=be,ve.whave=ve.wsize):(ve.wnext+=_e,ve.wnext===ve.wsize&&(ve.wnext=0),ve.whave<ve.wsize&&(ve.whave+=_e))),0};var et={inflateReset:Je,inflateReset2:tt,inflateResetKeep:Ge,inflateInit:p=>Ze(p,15),inflateInit2:Ze,inflate:(p,$)=>{let y,be,_e,ve,Ke,ze,gt,Ne,$e,dr,Wt,_t,si,Mr,er,zr,lr,Ct,sr,Pr,Dt,Sr,cr=0;const tr=new Uint8Array(4);let fr,Li;const Wn=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(we(p)||!p.output||!p.input&&p.avail_in!==0)return P;y=p.state,y.mode===Z&&(y.mode=te),Ke=p.next_out,_e=p.output,gt=p.avail_out,ve=p.next_in,be=p.input,ze=p.avail_in,Ne=y.hold,$e=y.bits,dr=ze,Wt=gt,Sr=A;e:for(;;)switch(y.mode){case W:if(y.wrap===0){y.mode=te;break}for(;$e<16;){if(ze===0)break e;ze--,Ne+=be[ve++]<<$e,$e+=8}if(2&y.wrap&&Ne===35615){y.wbits===0&&(y.wbits=15),y.check=0,tr[0]=255&Ne,tr[1]=Ne>>>8&255,y.check=Ue(y.check,tr,2,0),Ne=0,$e=0,y.mode=16181;break}if(y.head&&(y.head.done=!1),!(1&y.wrap)||(((255&Ne)<<8)+(Ne>>8))%31){p.msg="incorrect header check",y.mode=Pe;break}if((15&Ne)!==j){p.msg="unknown compression method",y.mode=Pe;break}if(Ne>>>=4,$e-=4,Dt=8+(15&Ne),y.wbits===0&&(y.wbits=Dt),Dt>15||Dt>y.wbits){p.msg="invalid window size",y.mode=Pe;break}y.dmax=1<<y.wbits,y.flags=0,p.adler=y.check=1,y.mode=512&Ne?16189:Z,Ne=0,$e=0;break;case 16181:for(;$e<16;){if(ze===0)break e;ze--,Ne+=be[ve++]<<$e,$e+=8}if(y.flags=Ne,(255&y.flags)!==j){p.msg="unknown compression method",y.mode=Pe;break}if(57344&y.flags){p.msg="unknown header flags set",y.mode=Pe;break}y.head&&(y.head.text=Ne>>8&1),512&y.flags&&4&y.wrap&&(tr[0]=255&Ne,tr[1]=Ne>>>8&255,y.check=Ue(y.check,tr,2,0)),Ne=0,$e=0,y.mode=16182;case 16182:for(;$e<32;){if(ze===0)break e;ze--,Ne+=be[ve++]<<$e,$e+=8}y.head&&(y.head.time=Ne),512&y.flags&&4&y.wrap&&(tr[0]=255&Ne,tr[1]=Ne>>>8&255,tr[2]=Ne>>>16&255,tr[3]=Ne>>>24&255,y.check=Ue(y.check,tr,4,0)),Ne=0,$e=0,y.mode=16183;case 16183:for(;$e<16;){if(ze===0)break e;ze--,Ne+=be[ve++]<<$e,$e+=8}y.head&&(y.head.xflags=255&Ne,y.head.os=Ne>>8),512&y.flags&&4&y.wrap&&(tr[0]=255&Ne,tr[1]=Ne>>>8&255,y.check=Ue(y.check,tr,2,0)),Ne=0,$e=0,y.mode=16184;case 16184:if(1024&y.flags){for(;$e<16;){if(ze===0)break e;ze--,Ne+=be[ve++]<<$e,$e+=8}y.length=Ne,y.head&&(y.head.extra_len=Ne),512&y.flags&&4&y.wrap&&(tr[0]=255&Ne,tr[1]=Ne>>>8&255,y.check=Ue(y.check,tr,2,0)),Ne=0,$e=0}else y.head&&(y.head.extra=null);y.mode=16185;case 16185:if(1024&y.flags&&(_t=y.length,_t>ze&&(_t=ze),_t&&(y.head&&(Dt=y.head.extra_len-y.length,y.head.extra||(y.head.extra=new Uint8Array(y.head.extra_len)),y.head.extra.set(be.subarray(ve,ve+_t),Dt)),512&y.flags&&4&y.wrap&&(y.check=Ue(y.check,be,_t,ve)),ze-=_t,ve+=_t,y.length-=_t),y.length))break e;y.length=0,y.mode=16186;case 16186:if(2048&y.flags){if(ze===0)break e;_t=0;do Dt=be[ve+_t++],y.head&&Dt&&y.length<65536&&(y.head.name+=String.fromCharCode(Dt));while(Dt&&_t<ze);if(512&y.flags&&4&y.wrap&&(y.check=Ue(y.check,be,_t,ve)),ze-=_t,ve+=_t,Dt)break e}else y.head&&(y.head.name=null);y.length=0,y.mode=16187;case 16187:if(4096&y.flags){if(ze===0)break e;_t=0;do Dt=be[ve+_t++],y.head&&Dt&&y.length<65536&&(y.head.comment+=String.fromCharCode(Dt));while(Dt&&_t<ze);if(512&y.flags&&4&y.wrap&&(y.check=Ue(y.check,be,_t,ve)),ze-=_t,ve+=_t,Dt)break e}else y.head&&(y.head.comment=null);y.mode=16188;case 16188:if(512&y.flags){for(;$e<16;){if(ze===0)break e;ze--,Ne+=be[ve++]<<$e,$e+=8}if(4&y.wrap&&Ne!==(65535&y.check)){p.msg="header crc mismatch",y.mode=Pe;break}Ne=0,$e=0}y.head&&(y.head.hcrc=y.flags>>9&1,y.head.done=!0),p.adler=y.check=0,y.mode=Z;break;case 16189:for(;$e<32;){if(ze===0)break e;ze--,Ne+=be[ve++]<<$e,$e+=8}p.adler=y.check=Te(Ne),Ne=0,$e=0,y.mode=G;case G:if(y.havedict===0)return p.next_out=Ke,p.avail_out=gt,p.next_in=ve,p.avail_in=ze,y.hold=Ne,y.bits=$e,S;p.adler=y.check=1,y.mode=Z;case Z:if($===E||$===g)break e;case te:if(y.last){Ne>>>=7&$e,$e-=7&$e,y.mode=ye;break}for(;$e<3;){if(ze===0)break e;ze--,Ne+=be[ve++]<<$e,$e+=8}switch(y.last=1&Ne,Ne>>>=1,$e-=1,3&Ne){case 0:y.mode=16193;break;case 1:if(pt(y),y.mode=de,$===g){Ne>>>=2,$e-=2;break e}break;case 2:y.mode=16196;break;case 3:p.msg="invalid block type",y.mode=Pe}Ne>>>=2,$e-=2;break;case 16193:for(Ne>>>=7&$e,$e-=7&$e;$e<32;){if(ze===0)break e;ze--,Ne+=be[ve++]<<$e,$e+=8}if((65535&Ne)!=(Ne>>>16^65535)){p.msg="invalid stored block lengths",y.mode=Pe;break}if(y.length=65535&Ne,Ne=0,$e=0,y.mode=re,$===g)break e;case re:y.mode=16195;case 16195:if(_t=y.length,_t){if(_t>ze&&(_t=ze),_t>gt&&(_t=gt),_t===0)break e;_e.set(be.subarray(ve,ve+_t),Ke),ze-=_t,ve+=_t,gt-=_t,Ke+=_t,y.length-=_t;break}y.mode=Z;break;case 16196:for(;$e<14;){if(ze===0)break e;ze--,Ne+=be[ve++]<<$e,$e+=8}if(y.nlen=257+(31&Ne),Ne>>>=5,$e-=5,y.ndist=1+(31&Ne),Ne>>>=5,$e-=5,y.ncode=4+(15&Ne),Ne>>>=4,$e-=4,y.nlen>286||y.ndist>30){p.msg="too many length or distance symbols",y.mode=Pe;break}y.have=0,y.mode=16197;case 16197:for(;y.have<y.ncode;){for(;$e<3;){if(ze===0)break e;ze--,Ne+=be[ve++]<<$e,$e+=8}y.lens[Wn[y.have++]]=7&Ne,Ne>>>=3,$e-=3}for(;y.have<19;)y.lens[Wn[y.have++]]=0;if(y.lencode=y.lendyn,y.lenbits=7,fr={bits:y.lenbits},Sr=l(0,y.lens,0,19,y.lencode,0,y.work,fr),y.lenbits=fr.bits,Sr){p.msg="invalid code lengths set",y.mode=Pe;break}y.have=0,y.mode=16198;case 16198:for(;y.have<y.nlen+y.ndist;){for(;cr=y.lencode[Ne&(1<<y.lenbits)-1],er=cr>>>24,zr=cr>>>16&255,lr=65535&cr,!(er<=$e);){if(ze===0)break e;ze--,Ne+=be[ve++]<<$e,$e+=8}if(lr<16)Ne>>>=er,$e-=er,y.lens[y.have++]=lr;else{if(lr===16){for(Li=er+2;$e<Li;){if(ze===0)break e;ze--,Ne+=be[ve++]<<$e,$e+=8}if(Ne>>>=er,$e-=er,y.have===0){p.msg="invalid bit length repeat",y.mode=Pe;break}Dt=y.lens[y.have-1],_t=3+(3&Ne),Ne>>>=2,$e-=2}else if(lr===17){for(Li=er+3;$e<Li;){if(ze===0)break e;ze--,Ne+=be[ve++]<<$e,$e+=8}Ne>>>=er,$e-=er,Dt=0,_t=3+(7&Ne),Ne>>>=3,$e-=3}else{for(Li=er+7;$e<Li;){if(ze===0)break e;ze--,Ne+=be[ve++]<<$e,$e+=8}Ne>>>=er,$e-=er,Dt=0,_t=11+(127&Ne),Ne>>>=7,$e-=7}if(y.have+_t>y.nlen+y.ndist){p.msg="invalid bit length repeat",y.mode=Pe;break}for(;_t--;)y.lens[y.have++]=Dt}}if(y.mode===Pe)break;if(y.lens[256]===0){p.msg="invalid code -- missing end-of-block",y.mode=Pe;break}if(y.lenbits=9,fr={bits:y.lenbits},Sr=l(1,y.lens,0,y.nlen,y.lencode,0,y.work,fr),y.lenbits=fr.bits,Sr){p.msg="invalid literal/lengths set",y.mode=Pe;break}if(y.distbits=6,y.distcode=y.distdyn,fr={bits:y.distbits},Sr=l(2,y.lens,y.nlen,y.ndist,y.distcode,0,y.work,fr),y.distbits=fr.bits,Sr){p.msg="invalid distances set",y.mode=Pe;break}if(y.mode=de,$===g)break e;case de:y.mode=le;case le:if(ze>=6&&gt>=258){p.next_out=Ke,p.avail_out=gt,p.next_in=ve,p.avail_in=ze,y.hold=Ne,y.bits=$e,Mi(p,Wt),Ke=p.next_out,_e=p.output,gt=p.avail_out,ve=p.next_in,be=p.input,ze=p.avail_in,Ne=y.hold,$e=y.bits,y.mode===Z&&(y.back=-1);break}for(y.back=0;cr=y.lencode[Ne&(1<<y.lenbits)-1],er=cr>>>24,zr=cr>>>16&255,lr=65535&cr,!(er<=$e);){if(ze===0)break e;ze--,Ne+=be[ve++]<<$e,$e+=8}if(zr&&!(240&zr)){for(Ct=er,sr=zr,Pr=lr;cr=y.lencode[Pr+((Ne&(1<<Ct+sr)-1)>>Ct)],er=cr>>>24,zr=cr>>>16&255,lr=65535&cr,!(Ct+er<=$e);){if(ze===0)break e;ze--,Ne+=be[ve++]<<$e,$e+=8}Ne>>>=Ct,$e-=Ct,y.back+=Ct}if(Ne>>>=er,$e-=er,y.back+=er,y.length=lr,zr===0){y.mode=16205;break}if(32&zr){y.back=-1,y.mode=Z;break}if(64&zr){p.msg="invalid literal/length code",y.mode=Pe;break}y.extra=15&zr,y.mode=16201;case 16201:if(y.extra){for(Li=y.extra;$e<Li;){if(ze===0)break e;ze--,Ne+=be[ve++]<<$e,$e+=8}y.length+=Ne&(1<<y.extra)-1,Ne>>>=y.extra,$e-=y.extra,y.back+=y.extra}y.was=y.length,y.mode=16202;case 16202:for(;cr=y.distcode[Ne&(1<<y.distbits)-1],er=cr>>>24,zr=cr>>>16&255,lr=65535&cr,!(er<=$e);){if(ze===0)break e;ze--,Ne+=be[ve++]<<$e,$e+=8}if(!(240&zr)){for(Ct=er,sr=zr,Pr=lr;cr=y.distcode[Pr+((Ne&(1<<Ct+sr)-1)>>Ct)],er=cr>>>24,zr=cr>>>16&255,lr=65535&cr,!(Ct+er<=$e);){if(ze===0)break e;ze--,Ne+=be[ve++]<<$e,$e+=8}Ne>>>=Ct,$e-=Ct,y.back+=Ct}if(Ne>>>=er,$e-=er,y.back+=er,64&zr){p.msg="invalid distance code",y.mode=Pe;break}y.offset=lr,y.extra=15&zr,y.mode=16203;case 16203:if(y.extra){for(Li=y.extra;$e<Li;){if(ze===0)break e;ze--,Ne+=be[ve++]<<$e,$e+=8}y.offset+=Ne&(1<<y.extra)-1,Ne>>>=y.extra,$e-=y.extra,y.back+=y.extra}if(y.offset>y.dmax){p.msg="invalid distance too far back",y.mode=Pe;break}y.mode=16204;case 16204:if(gt===0)break e;if(_t=Wt-gt,y.offset>_t){if(_t=y.offset-_t,_t>y.whave&&y.sane){p.msg="invalid distance too far back",y.mode=Pe;break}_t>y.wnext?(_t-=y.wnext,si=y.wsize-_t):si=y.wnext-_t,_t>y.length&&(_t=y.length),Mr=y.window}else Mr=_e,si=Ke-y.offset,_t=y.length;_t>gt&&(_t=gt),gt-=_t,y.length-=_t;do _e[Ke++]=Mr[si++];while(--_t);y.length===0&&(y.mode=le);break;case 16205:if(gt===0)break e;_e[Ke++]=y.length,gt--,y.mode=le;break;case ye:if(y.wrap){for(;$e<32;){if(ze===0)break e;ze--,Ne|=be[ve++]<<$e,$e+=8}if(Wt-=gt,p.total_out+=Wt,y.total+=Wt,4&y.wrap&&Wt&&(p.adler=y.check=y.flags?Ue(y.check,_e,Wt,Ke-Wt):Ee(y.check,_e,Wt,Ke-Wt)),Wt=gt,4&y.wrap&&(y.flags?Ne:Te(Ne))!==y.check){p.msg="incorrect data check",y.mode=Pe;break}Ne=0,$e=0}y.mode=16207;case 16207:if(y.wrap&&y.flags){for(;$e<32;){if(ze===0)break e;ze--,Ne+=be[ve++]<<$e,$e+=8}if(4&y.wrap&&Ne!==(4294967295&y.total)){p.msg="incorrect length check",y.mode=Pe;break}Ne=0,$e=0}y.mode=16208;case 16208:Sr=M;break e;case Pe:Sr=L;break e;case 16210:return X;default:return P}return p.next_out=Ke,p.avail_out=gt,p.next_in=ve,p.avail_in=ze,y.hold=Ne,y.bits=$e,(y.wsize||Wt!==p.avail_out&&y.mode<Pe&&(y.mode<ye||$!==h))&&Be(p,p.output,p.next_out,Wt-p.avail_out),dr-=p.avail_in,Wt-=p.avail_out,p.total_in+=dr,p.total_out+=Wt,y.total+=Wt,4&y.wrap&&Wt&&(p.adler=y.check=y.flags?Ue(y.check,_e,Wt,p.next_out-Wt):Ee(y.check,_e,Wt,p.next_out-Wt)),p.data_type=y.bits+(y.last?64:0)+(y.mode===Z?128:0)+(y.mode===de||y.mode===re?256:0),(dr===0&&Wt===0||$===h)&&Sr===A&&(Sr=U),Sr},inflateEnd:p=>{if(we(p))return P;let $=p.state;return $.window&&($.window=null),p.state=null,A},inflateGetHeader:(p,$)=>{if(we(p))return P;const y=p.state;return 2&y.wrap?(y.head=$,$.done=!1,A):P},inflateSetDictionary:(p,$)=>{const y=$.length;let be,_e,ve;return we(p)?P:(be=p.state,be.wrap!==0&&be.mode!==G?P:be.mode===G&&(_e=1,_e=Ee(_e,$,y,0),_e!==be.check)?L:(ve=Be(p,$,y,y),ve?(be.mode=16210,X):(be.havedict=1,A)))},inflateInfo:"pako inflate (from Nodeca project)"},St=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const ot=Object.prototype.toString,{Z_NO_FLUSH:wt,Z_FINISH:Et,Z_OK:it,Z_STREAM_END:Rt,Z_NEED_DICT:Ht,Z_STREAM_ERROR:kt,Z_DATA_ERROR:ct,Z_MEM_ERROR:Jt}=rt;function Nt(p){this.options=$r({chunkSize:65536,windowBits:15,to:""},p||{});const $=this.options;$.raw&&$.windowBits>=0&&$.windowBits<16&&($.windowBits=-$.windowBits,$.windowBits===0&&($.windowBits=-15)),!($.windowBits>=0&&$.windowBits<16)||p&&p.windowBits||($.windowBits+=32),$.windowBits>15&&$.windowBits<48&&(15&$.windowBits||($.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Oe,this.strm.avail_out=0;let y=et.inflateInit2(this.strm,$.windowBits);if(y!==it)throw new Error(Ie[y]);if(this.header=new St,et.inflateGetHeader(this.strm,this.header),$.dictionary&&(typeof $.dictionary=="string"?$.dictionary=ne($.dictionary):ot.call($.dictionary)==="[object ArrayBuffer]"&&($.dictionary=new Uint8Array($.dictionary)),$.raw&&(y=et.inflateSetDictionary(this.strm,$.dictionary),y!==it)))throw new Error(Ie[y])}function qt(p,$){const y=new Nt($);if(y.push(p),y.err)throw y.msg||Ie[y.err];return y.result}Nt.prototype.push=function(p,$){const y=this.strm,be=this.options.chunkSize,_e=this.options.dictionary;let ve,Ke,ze;if(this.ended)return!1;for(Ke=$===~~$?$:$===!0?Et:wt,ot.call(p)==="[object ArrayBuffer]"?y.input=new Uint8Array(p):y.input=p,y.next_in=0,y.avail_in=y.input.length;;){for(y.avail_out===0&&(y.output=new Uint8Array(be),y.next_out=0,y.avail_out=be),ve=et.inflate(y,Ke),ve===Ht&&_e&&(ve=et.inflateSetDictionary(y,_e),ve===it?ve=et.inflate(y,Ke):ve===ct&&(ve=Ht));y.avail_in>0&&ve===Rt&&y.state.wrap>0&&p[y.next_in]!==0;)et.inflateReset(y),ve=et.inflate(y,Ke);switch(ve){case kt:case ct:case Ht:case Jt:return this.onEnd(ve),this.ended=!0,!1}if(ze=y.avail_out,y.next_out&&(y.avail_out===0||ve===Rt))if(this.options.to==="string"){let gt=Ve(y.output,y.next_out),Ne=y.next_out-gt,$e=xe(y.output,gt);y.next_out=Ne,y.avail_out=be-Ne,Ne&&y.output.set(y.output.subarray(gt,gt+Ne),0),this.onData($e)}else this.onData(y.output.length===y.next_out?y.output:y.output.subarray(0,y.next_out));if(ve!==it||ze!==0){if(ve===Rt)return ve=et.inflateEnd(this.strm),this.onEnd(ve),this.ended=!0,!0;if(y.avail_in===0)break}}return!0},Nt.prototype.onData=function(p){this.chunks.push(p)},Nt.prototype.onEnd=function(p){p===it&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=qi(this.chunks)),this.chunks=[],this.err=p,this.msg=this.strm.msg};var Vt={Inflate:Nt,inflate:qt,inflateRaw:function(p,$){return($=$||{}).raw=!0,qt(p,$)},ungzip:qt};const{Deflate:Kt,deflate:yr,deflateRaw:Fr,gzip:Tr}=Or,{Inflate:ii,inflate:Wr,inflateRaw:br,ungzip:Xr}=Vt;var ci=Kt,ni=yr,hi=Fr,zi=Tr,xi=ii,Ii=Wr,Hr=br,Kr=Xr,qr=rt,ei={Deflate:Kt,deflate:yr,deflateRaw:Fr,gzip:Tr,Inflate:ii,inflate:Wr,inflateRaw:br,ungzip:Xr,constants:rt}},99:(r,n,a)=>{a.r(n),a.d(n,{Cylinder:()=>u,Sphere:()=>d,Triangle:()=>m});var c=a(529);class d{constructor(T={x:0,y:0,z:0},x=0){this.center=new c.Vector3(T.x,T.y,T.z),this.radius=x}set(T,x){return this.center.copy(T),this.radius=x,this}copy(T){return this.center.copy(T.center),this.radius=T.radius,this}applyMatrix4(T){return this.center.applyMatrix4(T),this.radius=this.radius*T.getMaxScaleOnAxis(),this}translate(T){return this.center.add(T),this}equals(T){return T.center.equals(this.center)&&T.radius===this.radius}clone(){return new d().copy(this)}}let R=new c.Vector3;class u{constructor(T=new c.Vector3,x=new c.Vector3,k=0){this.c1=T,this.c2=x,this.radius=k,this.direction=new c.Vector3().subVectors(this.c2,this.c1).normalize()}copy(T){return this.c1.copy(T.c1),this.c2.copy(T.c2),this.direction.copy(T.direction),this.radius=T.radius,this}lengthSq(){return R.subVectors(this.c2,this.c1).lengthSq()}applyMatrix4(T){return this.direction.add(this.c1).applyMatrix4(T),this.c1.applyMatrix4(T),this.c2.applyMatrix4(T),this.direction.sub(this.c1).normalize(),this.radius=this.radius*T.getMaxScaleOnAxis(),this}}const v=new c.Vector3;class m{constructor(T=new c.Vector3,x=new c.Vector3,k=new c.Vector3){this.a=T,this.b=x,this.c=k}copy(T){return this.a.copy(T.a),this.b.copy(T.b),this.c.copy(T.c),this}applyMatrix4(T){return this.a.applyMatrix4(T),this.b.applyMatrix4(T),this.c.applyMatrix4(T),this}getNormal(){var T=this.a.clone();return T.sub(this.b),v.subVectors(this.c,this.b),T.cross(v),T.normalize(),T}}},107:(r,n,a)=>{var c,d=a(981),R=a(697),u=a(701),v=a(407),m=a(834),b=-2,T=258,x=262,k=103,F=113,C=666;function z(I,he){return I.msg=m[he],he}function Q(I){return(I<<1)-(I>4?9:0)}function J(I){for(var he=I.length;--he>=0;)I[he]=0}function q(I){var he=I.state,se=he.pending;se>I.avail_out&&(se=I.avail_out),se!==0&&(d.arraySet(I.output,he.pending_buf,he.pending_out,se,I.next_out),I.next_out+=se,he.pending_out+=se,I.total_out+=se,I.avail_out-=se,he.pending-=se,he.pending===0&&(he.pending_out=0))}function w(I,he){R._tr_flush_block(I,I.block_start>=0?I.block_start:-1,I.strstart-I.block_start,he),I.block_start=I.strstart,q(I.strm)}function N(I,he){I.pending_buf[I.pending++]=he}function V(I,he){I.pending_buf[I.pending++]=he>>>8&255,I.pending_buf[I.pending++]=255&he}function H(I,he,se,K){var Re=I.avail_in;return Re>K&&(Re=K),Re===0?0:(I.avail_in-=Re,d.arraySet(he,I.input,I.next_in,Re,se),I.state.wrap===1?I.adler=u(I.adler,he,Re,se):I.state.wrap===2&&(I.adler=v(I.adler,he,Re,se)),I.next_in+=Re,I.total_in+=Re,Re)}function Y(I,he){var se,K,Re=I.max_chain_length,fe=I.strstart,De=I.prev_length,We=I.nice_match,oe=I.strstart>I.w_size-x?I.strstart-(I.w_size-x):0,Ee=I.window,He=I.w_mask,Ue=I.prev,Ie=I.strstart+T,rt=Ee[fe+De-1],st=Ee[fe+De];I.prev_length>=I.good_match&&(Re>>=2),We>I.lookahead&&(We=I.lookahead);do if(Ee[(se=he)+De]===st&&Ee[se+De-1]===rt&&Ee[se]===Ee[fe]&&Ee[++se]===Ee[fe+1]){fe+=2,se++;do;while(Ee[++fe]===Ee[++se]&&Ee[++fe]===Ee[++se]&&Ee[++fe]===Ee[++se]&&Ee[++fe]===Ee[++se]&&Ee[++fe]===Ee[++se]&&Ee[++fe]===Ee[++se]&&Ee[++fe]===Ee[++se]&&Ee[++fe]===Ee[++se]&&fe<Ie);if(K=T-(Ie-fe),fe=Ie-T,K>De){if(I.match_start=he,De=K,K>=We)break;rt=Ee[fe+De-1],st=Ee[fe+De]}}while((he=Ue[he&He])>oe&&--Re!==0);return De<=I.lookahead?De:I.lookahead}function O(I){var he,se,K,Re,fe,De=I.w_size;do{if(Re=I.window_size-I.lookahead-I.strstart,I.strstart>=De+(De-x)){d.arraySet(I.window,I.window,De,De,0),I.match_start-=De,I.strstart-=De,I.block_start-=De,he=se=I.hash_size;do K=I.head[--he],I.head[he]=K>=De?K-De:0;while(--se);he=se=De;do K=I.prev[--he],I.prev[he]=K>=De?K-De:0;while(--se);Re+=De}if(I.strm.avail_in===0)break;if(se=H(I.strm,I.window,I.strstart+I.lookahead,Re),I.lookahead+=se,I.lookahead+I.insert>=3)for(fe=I.strstart-I.insert,I.ins_h=I.window[fe],I.ins_h=(I.ins_h<<I.hash_shift^I.window[fe+1])&I.hash_mask;I.insert&&(I.ins_h=(I.ins_h<<I.hash_shift^I.window[fe+3-1])&I.hash_mask,I.prev[fe&I.w_mask]=I.head[I.ins_h],I.head[I.ins_h]=fe,fe++,I.insert--,!(I.lookahead+I.insert<3)););}while(I.lookahead<x&&I.strm.avail_in!==0)}function ee(I,he){for(var se,K;;){if(I.lookahead<x){if(O(I),I.lookahead<x&&he===0)return 1;if(I.lookahead===0)break}if(se=0,I.lookahead>=3&&(I.ins_h=(I.ins_h<<I.hash_shift^I.window[I.strstart+3-1])&I.hash_mask,se=I.prev[I.strstart&I.w_mask]=I.head[I.ins_h],I.head[I.ins_h]=I.strstart),se!==0&&I.strstart-se<=I.w_size-x&&(I.match_length=Y(I,se)),I.match_length>=3)if(K=R._tr_tally(I,I.strstart-I.match_start,I.match_length-3),I.lookahead-=I.match_length,I.match_length<=I.max_lazy_match&&I.lookahead>=3){I.match_length--;do I.strstart++,I.ins_h=(I.ins_h<<I.hash_shift^I.window[I.strstart+3-1])&I.hash_mask,se=I.prev[I.strstart&I.w_mask]=I.head[I.ins_h],I.head[I.ins_h]=I.strstart;while(--I.match_length!==0);I.strstart++}else I.strstart+=I.match_length,I.match_length=0,I.ins_h=I.window[I.strstart],I.ins_h=(I.ins_h<<I.hash_shift^I.window[I.strstart+1])&I.hash_mask;else K=R._tr_tally(I,0,I.window[I.strstart]),I.lookahead--,I.strstart++;if(K&&(w(I,!1),I.strm.avail_out===0))return 1}return I.insert=I.strstart<2?I.strstart:2,he===4?(w(I,!0),I.strm.avail_out===0?3:4):I.last_lit&&(w(I,!1),I.strm.avail_out===0)?1:2}function Ae(I,he){for(var se,K,Re;;){if(I.lookahead<x){if(O(I),I.lookahead<x&&he===0)return 1;if(I.lookahead===0)break}if(se=0,I.lookahead>=3&&(I.ins_h=(I.ins_h<<I.hash_shift^I.window[I.strstart+3-1])&I.hash_mask,se=I.prev[I.strstart&I.w_mask]=I.head[I.ins_h],I.head[I.ins_h]=I.strstart),I.prev_length=I.match_length,I.prev_match=I.match_start,I.match_length=2,se!==0&&I.prev_length<I.max_lazy_match&&I.strstart-se<=I.w_size-x&&(I.match_length=Y(I,se),I.match_length<=5&&(I.strategy===1||I.match_length===3&&I.strstart-I.match_start>4096)&&(I.match_length=2)),I.prev_length>=3&&I.match_length<=I.prev_length){Re=I.strstart+I.lookahead-3,K=R._tr_tally(I,I.strstart-1-I.prev_match,I.prev_length-3),I.lookahead-=I.prev_length-1,I.prev_length-=2;do++I.strstart<=Re&&(I.ins_h=(I.ins_h<<I.hash_shift^I.window[I.strstart+3-1])&I.hash_mask,se=I.prev[I.strstart&I.w_mask]=I.head[I.ins_h],I.head[I.ins_h]=I.strstart);while(--I.prev_length!==0);if(I.match_available=0,I.match_length=2,I.strstart++,K&&(w(I,!1),I.strm.avail_out===0))return 1}else if(I.match_available){if((K=R._tr_tally(I,0,I.window[I.strstart-1]))&&w(I,!1),I.strstart++,I.lookahead--,I.strm.avail_out===0)return 1}else I.match_available=1,I.strstart++,I.lookahead--}return I.match_available&&(K=R._tr_tally(I,0,I.window[I.strstart-1]),I.match_available=0),I.insert=I.strstart<2?I.strstart:2,he===4?(w(I,!0),I.strm.avail_out===0?3:4):I.last_lit&&(w(I,!1),I.strm.avail_out===0)?1:2}function ce(I,he,se,K,Re){this.good_length=I,this.max_lazy=he,this.nice_length=se,this.max_chain=K,this.func=Re}function ge(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new d.Buf16(1146),this.dyn_dtree=new d.Buf16(122),this.bl_tree=new d.Buf16(78),J(this.dyn_ltree),J(this.dyn_dtree),J(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new d.Buf16(16),this.heap=new d.Buf16(573),J(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new d.Buf16(573),J(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function me(I){var he;return I&&I.state?(I.total_in=I.total_out=0,I.data_type=2,(he=I.state).pending=0,he.pending_out=0,he.wrap<0&&(he.wrap=-he.wrap),he.status=he.wrap?42:F,I.adler=he.wrap===2?0:1,he.last_flush=0,R._tr_init(he),0):z(I,b)}function Me(I){var he,se=me(I);return se===0&&((he=I.state).window_size=2*he.w_size,J(he.head),he.max_lazy_match=c[he.level].max_lazy,he.good_match=c[he.level].good_length,he.nice_match=c[he.level].nice_length,he.max_chain_length=c[he.level].max_chain,he.strstart=0,he.block_start=0,he.lookahead=0,he.insert=0,he.match_length=he.prev_length=2,he.match_available=0,he.ins_h=0),se}function ue(I,he,se,K,Re,fe){if(!I)return b;var De=1;if(he===-1&&(he=6),K<0?(De=0,K=-K):K>15&&(De=2,K-=16),Re<1||Re>9||se!==8||K<8||K>15||he<0||he>9||fe<0||fe>4)return z(I,b);K===8&&(K=9);var We=new ge;return I.state=We,We.strm=I,We.wrap=De,We.gzhead=null,We.w_bits=K,We.w_size=1<<We.w_bits,We.w_mask=We.w_size-1,We.hash_bits=Re+7,We.hash_size=1<<We.hash_bits,We.hash_mask=We.hash_size-1,We.hash_shift=~~((We.hash_bits+3-1)/3),We.window=new d.Buf8(2*We.w_size),We.head=new d.Buf16(We.hash_size),We.prev=new d.Buf16(We.w_size),We.lit_bufsize=1<<Re+6,We.pending_buf_size=4*We.lit_bufsize,We.pending_buf=new d.Buf8(We.pending_buf_size),We.d_buf=1*We.lit_bufsize,We.l_buf=3*We.lit_bufsize,We.level=he,We.strategy=fe,We.method=se,Me(I)}c=[new ce(0,0,0,0,function(I,he){var se=65535;for(se>I.pending_buf_size-5&&(se=I.pending_buf_size-5);;){if(I.lookahead<=1){if(O(I),I.lookahead===0&&he===0)return 1;if(I.lookahead===0)break}I.strstart+=I.lookahead,I.lookahead=0;var K=I.block_start+se;if((I.strstart===0||I.strstart>=K)&&(I.lookahead=I.strstart-K,I.strstart=K,w(I,!1),I.strm.avail_out===0)||I.strstart-I.block_start>=I.w_size-x&&(w(I,!1),I.strm.avail_out===0))return 1}return I.insert=0,he===4?(w(I,!0),I.strm.avail_out===0?3:4):(I.strstart>I.block_start&&(w(I,!1),I.strm.avail_out),1)}),new ce(4,4,8,4,ee),new ce(4,5,16,8,ee),new ce(4,6,32,32,ee),new ce(4,4,16,16,Ae),new ce(8,16,32,32,Ae),new ce(8,16,128,128,Ae),new ce(8,32,128,256,Ae),new ce(32,128,258,1024,Ae),new ce(32,258,258,4096,Ae)],n.deflateInit=function(I,he){return ue(I,he,8,15,8,0)},n.deflateInit2=ue,n.deflateReset=Me,n.deflateResetKeep=me,n.deflateSetHeader=function(I,he){return I&&I.state?I.state.wrap!==2?b:(I.state.gzhead=he,0):b},n.deflate=function(I,he){var se,K,Re,fe;if(!I||!I.state||he>5||he<0)return I?z(I,b):b;if(K=I.state,!I.output||!I.input&&I.avail_in!==0||K.status===C&&he!==4)return z(I,I.avail_out===0?-5:b);if(K.strm=I,se=K.last_flush,K.last_flush=he,K.status===42)if(K.wrap===2)I.adler=0,N(K,31),N(K,139),N(K,8),K.gzhead?(N(K,(K.gzhead.text?1:0)+(K.gzhead.hcrc?2:0)+(K.gzhead.extra?4:0)+(K.gzhead.name?8:0)+(K.gzhead.comment?16:0)),N(K,255&K.gzhead.time),N(K,K.gzhead.time>>8&255),N(K,K.gzhead.time>>16&255),N(K,K.gzhead.time>>24&255),N(K,K.level===9?2:K.strategy>=2||K.level<2?4:0),N(K,255&K.gzhead.os),K.gzhead.extra&&K.gzhead.extra.length&&(N(K,255&K.gzhead.extra.length),N(K,K.gzhead.extra.length>>8&255)),K.gzhead.hcrc&&(I.adler=v(I.adler,K.pending_buf,K.pending,0)),K.gzindex=0,K.status=69):(N(K,0),N(K,0),N(K,0),N(K,0),N(K,0),N(K,K.level===9?2:K.strategy>=2||K.level<2?4:0),N(K,3),K.status=F);else{var De=8+(K.w_bits-8<<4)<<8;De|=(K.strategy>=2||K.level<2?0:K.level<6?1:K.level===6?2:3)<<6,K.strstart!==0&&(De|=32),De+=31-De%31,K.status=F,V(K,De),K.strstart!==0&&(V(K,I.adler>>>16),V(K,65535&I.adler)),I.adler=1}if(K.status===69)if(K.gzhead.extra){for(Re=K.pending;K.gzindex<(65535&K.gzhead.extra.length)&&(K.pending!==K.pending_buf_size||(K.gzhead.hcrc&&K.pending>Re&&(I.adler=v(I.adler,K.pending_buf,K.pending-Re,Re)),q(I),Re=K.pending,K.pending!==K.pending_buf_size));)N(K,255&K.gzhead.extra[K.gzindex]),K.gzindex++;K.gzhead.hcrc&&K.pending>Re&&(I.adler=v(I.adler,K.pending_buf,K.pending-Re,Re)),K.gzindex===K.gzhead.extra.length&&(K.gzindex=0,K.status=73)}else K.status=73;if(K.status===73)if(K.gzhead.name){Re=K.pending;do{if(K.pending===K.pending_buf_size&&(K.gzhead.hcrc&&K.pending>Re&&(I.adler=v(I.adler,K.pending_buf,K.pending-Re,Re)),q(I),Re=K.pending,K.pending===K.pending_buf_size)){fe=1;break}fe=K.gzindex<K.gzhead.name.length?255&K.gzhead.name.charCodeAt(K.gzindex++):0,N(K,fe)}while(fe!==0);K.gzhead.hcrc&&K.pending>Re&&(I.adler=v(I.adler,K.pending_buf,K.pending-Re,Re)),fe===0&&(K.gzindex=0,K.status=91)}else K.status=91;if(K.status===91)if(K.gzhead.comment){Re=K.pending;do{if(K.pending===K.pending_buf_size&&(K.gzhead.hcrc&&K.pending>Re&&(I.adler=v(I.adler,K.pending_buf,K.pending-Re,Re)),q(I),Re=K.pending,K.pending===K.pending_buf_size)){fe=1;break}fe=K.gzindex<K.gzhead.comment.length?255&K.gzhead.comment.charCodeAt(K.gzindex++):0,N(K,fe)}while(fe!==0);K.gzhead.hcrc&&K.pending>Re&&(I.adler=v(I.adler,K.pending_buf,K.pending-Re,Re)),fe===0&&(K.status=k)}else K.status=k;if(K.status===k&&(K.gzhead.hcrc?(K.pending+2>K.pending_buf_size&&q(I),K.pending+2<=K.pending_buf_size&&(N(K,255&I.adler),N(K,I.adler>>8&255),I.adler=0,K.status=F)):K.status=F),K.pending!==0){if(q(I),I.avail_out===0)return K.last_flush=-1,0}else if(I.avail_in===0&&Q(he)<=Q(se)&&he!==4)return z(I,-5);if(K.status===C&&I.avail_in!==0)return z(I,-5);if(I.avail_in!==0||K.lookahead!==0||he!==0&&K.status!==C){var We=K.strategy===2?(function(oe,Ee){for(var He;;){if(oe.lookahead===0&&(O(oe),oe.lookahead===0)){if(Ee===0)return 1;break}if(oe.match_length=0,He=R._tr_tally(oe,0,oe.window[oe.strstart]),oe.lookahead--,oe.strstart++,He&&(w(oe,!1),oe.strm.avail_out===0))return 1}return oe.insert=0,Ee===4?(w(oe,!0),oe.strm.avail_out===0?3:4):oe.last_lit&&(w(oe,!1),oe.strm.avail_out===0)?1:2})(K,he):K.strategy===3?(function(oe,Ee){for(var He,Ue,Ie,rt,st=oe.window;;){if(oe.lookahead<=T){if(O(oe),oe.lookahead<=T&&Ee===0)return 1;if(oe.lookahead===0)break}if(oe.match_length=0,oe.lookahead>=3&&oe.strstart>0&&(Ue=st[Ie=oe.strstart-1])===st[++Ie]&&Ue===st[++Ie]&&Ue===st[++Ie]){rt=oe.strstart+T;do;while(Ue===st[++Ie]&&Ue===st[++Ie]&&Ue===st[++Ie]&&Ue===st[++Ie]&&Ue===st[++Ie]&&Ue===st[++Ie]&&Ue===st[++Ie]&&Ue===st[++Ie]&&Ie<rt);oe.match_length=T-(rt-Ie),oe.match_length>oe.lookahead&&(oe.match_length=oe.lookahead)}if(oe.match_length>=3?(He=R._tr_tally(oe,1,oe.match_length-3),oe.lookahead-=oe.match_length,oe.strstart+=oe.match_length,oe.match_length=0):(He=R._tr_tally(oe,0,oe.window[oe.strstart]),oe.lookahead--,oe.strstart++),He&&(w(oe,!1),oe.strm.avail_out===0))return 1}return oe.insert=0,Ee===4?(w(oe,!0),oe.strm.avail_out===0?3:4):oe.last_lit&&(w(oe,!1),oe.strm.avail_out===0)?1:2})(K,he):c[K.level].func(K,he);if(We!==3&&We!==4||(K.status=C),We===1||We===3)return I.avail_out===0&&(K.last_flush=-1),0;if(We===2&&(he===1?R._tr_align(K):he!==5&&(R._tr_stored_block(K,0,0,!1),he===3&&(J(K.head),K.lookahead===0&&(K.strstart=0,K.block_start=0,K.insert=0))),q(I),I.avail_out===0))return K.last_flush=-1,0}return he!==4?0:K.wrap<=0?1:(K.wrap===2?(N(K,255&I.adler),N(K,I.adler>>8&255),N(K,I.adler>>16&255),N(K,I.adler>>24&255),N(K,255&I.total_in),N(K,I.total_in>>8&255),N(K,I.total_in>>16&255),N(K,I.total_in>>24&255)):(V(K,I.adler>>>16),V(K,65535&I.adler)),q(I),K.wrap>0&&(K.wrap=-K.wrap),K.pending!==0?0:1)},n.deflateEnd=function(I){var he;return I&&I.state?(he=I.state.status)!==42&&he!==69&&he!==73&&he!==91&&he!==k&&he!==F&&he!==C?z(I,b):(I.state=null,he===F?z(I,-3):0):b},n.deflateSetDictionary=function(I,he){var se,K,Re,fe,De,We,oe,Ee,He=he.length;if(!I||!I.state||(fe=(se=I.state).wrap)===2||fe===1&&se.status!==42||se.lookahead)return b;for(fe===1&&(I.adler=u(I.adler,he,He,0)),se.wrap=0,He>=se.w_size&&(fe===0&&(J(se.head),se.strstart=0,se.block_start=0,se.insert=0),Ee=new d.Buf8(se.w_size),d.arraySet(Ee,he,He-se.w_size,se.w_size,0),he=Ee,He=se.w_size),De=I.avail_in,We=I.next_in,oe=I.input,I.avail_in=He,I.next_in=0,I.input=he,O(se);se.lookahead>=3;){K=se.strstart,Re=se.lookahead-2;do se.ins_h=(se.ins_h<<se.hash_shift^se.window[K+3-1])&se.hash_mask,se.prev[K&se.w_mask]=se.head[se.ins_h],se.head[se.ins_h]=K,K++;while(--Re);se.strstart=K,se.lookahead=2,O(se)}return se.strstart+=se.lookahead,se.block_start=se.strstart,se.insert=se.lookahead,se.lookahead=0,se.match_length=se.prev_length=2,se.match_available=0,I.next_in=We,I.input=oe,I.avail_in=De,se.wrap=fe,0},n.deflateInfo="pako deflate (from Nodeca project)"},111:(r,n,a)=>{var c;c={},r.exports=c,(function(d,R){d.toRGBA8=function(u){var v=u.width,m=u.height;if(u.tabs.acTL==null)return[d.toRGBA8.decodeImage(u.data,v,m,u).buffer];var b=[];u.frames[0].data==null&&(u.frames[0].data=u.data);for(var T,x=new Uint8Array(v*m*4),k=0;k<u.frames.length;k++){var F=u.frames[k],C=F.rect.x,z=F.rect.y,Q=F.rect.width,J=F.rect.height,q=d.toRGBA8.decodeImage(F.data,Q,J,u);if(k==0?T=q:F.blend==0?d._copyTile(q,Q,J,T,v,m,C,z,0):F.blend==1&&d._copyTile(q,Q,J,T,v,m,C,z,1),b.push(T.buffer),T=T.slice(0),F.dispose!=0){if(F.dispose==1)d._copyTile(x,Q,J,T,v,m,C,z,0);else if(F.dispose==2){for(var w=k-1;u.frames[w].dispose==2;)w--;T=new Uint8Array(b[w]).slice(0)}}}return b},d.toRGBA8.decodeImage=function(u,v,m,b){var T=v*m,x=d.decode._getBPP(b),k=Math.ceil(v*x/8),F=new Uint8Array(4*T),C=new Uint32Array(F.buffer),z=b.ctype,Q=b.depth,J=d._bin.readUshort;if(z==6){var q=T<<2;if(Q==8)for(var w=0;w<q;w++)F[w]=u[w];if(Q==16)for(w=0;w<q;w++)F[w]=u[w<<1]}else if(z==2){var N=b.tabs.tRNS,V=-1,H=-1,Y=-1;if(N&&(V=N[0],H=N[1],Y=N[2]),Q==8)for(w=0;w<T;w++){var O=3*w;F[ue=w<<2]=u[O],F[ue+1]=u[O+1],F[ue+2]=u[O+2],F[ue+3]=255,V!=-1&&u[O]==V&&u[O+1]==H&&u[O+2]==Y&&(F[ue+3]=0)}if(Q==16)for(w=0;w<T;w++)O=6*w,F[ue=w<<2]=u[O],F[ue+1]=u[O+2],F[ue+2]=u[O+4],F[ue+3]=255,V!=-1&&J(u,O)==V&&J(u,O+2)==H&&J(u,O+4)==Y&&(F[ue+3]=0)}else if(z==3){var ee=b.tabs.PLTE,Ae=b.tabs.tRNS,ce=Ae?Ae.length:0;if(Q==1)for(var ge=0;ge<m;ge++){var me=ge*k,Me=ge*v;for(w=0;w<v;w++){var ue=Me+w<<2,I=3*(he=u[me+(w>>3)]>>7-(7&w)&1);F[ue]=ee[I],F[ue+1]=ee[I+1],F[ue+2]=ee[I+2],F[ue+3]=he<ce?Ae[he]:255}}if(Q==2)for(ge=0;ge<m;ge++)for(me=ge*k,Me=ge*v,w=0;w<v;w++)ue=Me+w<<2,I=3*(he=u[me+(w>>2)]>>6-((3&w)<<1)&3),F[ue]=ee[I],F[ue+1]=ee[I+1],F[ue+2]=ee[I+2],F[ue+3]=he<ce?Ae[he]:255;if(Q==4)for(ge=0;ge<m;ge++)for(me=ge*k,Me=ge*v,w=0;w<v;w++)ue=Me+w<<2,I=3*(he=u[me+(w>>1)]>>4-((1&w)<<2)&15),F[ue]=ee[I],F[ue+1]=ee[I+1],F[ue+2]=ee[I+2],F[ue+3]=he<ce?Ae[he]:255;if(Q==8)for(w=0;w<T;w++){var he;ue=w<<2,I=3*(he=u[w]),F[ue]=ee[I],F[ue+1]=ee[I+1],F[ue+2]=ee[I+2],F[ue+3]=he<ce?Ae[he]:255}}else if(z==4){if(Q==8)for(w=0;w<T;w++){ue=w<<2;var se=u[K=w<<1];F[ue]=se,F[ue+1]=se,F[ue+2]=se,F[ue+3]=u[K+1]}if(Q==16)for(w=0;w<T;w++){var K;ue=w<<2,se=u[K=w<<2],F[ue]=se,F[ue+1]=se,F[ue+2]=se,F[ue+3]=u[K+2]}}else if(z==0){if(V=b.tabs.tRNS?b.tabs.tRNS:-1,Q==1)for(w=0;w<T;w++){var Re=(se=255*(u[w>>3]>>7-(7&w)&1))==255*V?0:255;C[w]=Re<<24|se<<16|se<<8|se}if(Q==2)for(w=0;w<T;w++)Re=(se=85*(u[w>>2]>>6-((3&w)<<1)&3))==85*V?0:255,C[w]=Re<<24|se<<16|se<<8|se;if(Q==4)for(w=0;w<T;w++)Re=(se=17*(u[w>>1]>>4-((1&w)<<2)&15))==17*V?0:255,C[w]=Re<<24|se<<16|se<<8|se;if(Q==8)for(w=0;w<T;w++)Re=(se=u[w])==V?0:255,C[w]=Re<<24|se<<16|se<<8|se;if(Q==16)for(w=0;w<T;w++)se=u[w<<1],Re=J(u,w<<1)==V?0:255,C[w]=Re<<24|se<<16|se<<8|se}return F},d.decode=function(u){for(var v,m=new Uint8Array(u),b=8,T=d._bin,x=T.readUshort,k=T.readUint,F={tabs:{},frames:[]},C=new Uint8Array(m.length),z=0,Q=0,J=[137,80,78,71,13,10,26,10],q=0;q<8;q++)if(m[q]!=J[q])throw"The input is not a PNG file!";for(;b<m.length;){var w=T.readUint(m,b);b+=4;var N=T.readASCII(m,b,4);if(b+=4,N=="IHDR")d.decode._IHDR(m,b,F);else if(N=="IDAT"){for(q=0;q<w;q++)C[z+q]=m[b+q];z+=w}else if(N=="acTL")F.tabs[N]={num_frames:k(m,b),num_plays:k(m,b+4)},v=new Uint8Array(m.length);else if(N=="fcTL"){Q!=0&&((me=F.frames[F.frames.length-1]).data=d.decode._decompress(F,v.slice(0,Q),me.rect.width,me.rect.height),Q=0);var V={x:k(m,b+12),y:k(m,b+16),width:k(m,b+4),height:k(m,b+8)},H=x(m,b+22);H=x(m,b+20)/(H==0?100:H);var Y={rect:V,delay:Math.round(1e3*H),dispose:m[b+24],blend:m[b+25]};F.frames.push(Y)}else if(N=="fdAT"){for(q=0;q<w-4;q++)v[Q+q]=m[b+q+4];Q+=w-4}else if(N=="pHYs")F.tabs[N]=[T.readUint(m,b),T.readUint(m,b+4),m[b+8]];else if(N=="cHRM")for(F.tabs[N]=[],q=0;q<8;q++)F.tabs[N].push(T.readUint(m,b+4*q));else if(N=="tEXt"){F.tabs[N]==null&&(F.tabs[N]={});var O=T.nextZero(m,b),ee=T.readASCII(m,b,O-b),Ae=T.readASCII(m,O+1,b+w-O-1);F.tabs[N][ee]=Ae}else if(N=="iTXt"){F.tabs[N]==null&&(F.tabs[N]={}),O=0;var ce=b;O=T.nextZero(m,ce),ee=T.readASCII(m,ce,O-ce),m[ce=O+1],m[ce+1],ce+=2,O=T.nextZero(m,ce),T.readASCII(m,ce,O-ce),ce=O+1,O=T.nextZero(m,ce),T.readUTF8(m,ce,O-ce),ce=O+1,Ae=T.readUTF8(m,ce,w-(ce-b)),F.tabs[N][ee]=Ae}else if(N=="PLTE")F.tabs[N]=T.readBytes(m,b,w);else if(N=="hIST"){var ge=F.tabs.PLTE.length/3;for(F.tabs[N]=[],q=0;q<ge;q++)F.tabs[N].push(x(m,b+2*q))}else if(N=="tRNS")F.ctype==3?F.tabs[N]=T.readBytes(m,b,w):F.ctype==0?F.tabs[N]=x(m,b):F.ctype==2&&(F.tabs[N]=[x(m,b),x(m,b+2),x(m,b+4)]);else if(N=="gAMA")F.tabs[N]=T.readUint(m,b)/1e5;else if(N=="sRGB")F.tabs[N]=m[b];else if(N=="bKGD")F.ctype==0||F.ctype==4?F.tabs[N]=[x(m,b)]:F.ctype==2||F.ctype==6?F.tabs[N]=[x(m,b),x(m,b+2),x(m,b+4)]:F.ctype==3&&(F.tabs[N]=m[b]);else if(N=="IEND"){var me;Q!=0&&((me=F.frames[F.frames.length-1]).data=d.decode._decompress(F,v.slice(0,Q),me.rect.width,me.rect.height),Q=0),F.data=d.decode._decompress(F,C,F.width,F.height);break}b+=w,T.readUint(m,b),b+=4}return delete F.compress,delete F.interlace,delete F.filter,F},d.decode._decompress=function(u,v,m,b){return u.compress==0&&(v=d.decode._inflate(v)),u.interlace==0?v=d.decode._filterZero(v,u,0,m,b):u.interlace==1&&(v=d.decode._readInterlace(v,u)),v},d.decode._inflate=function(u){return R.inflate(u)},d.decode._readInterlace=function(u,v){for(var m=v.width,b=v.height,T=d.decode._getBPP(v),x=T>>3,k=Math.ceil(m*T/8),F=new Uint8Array(b*k),C=0,z=[0,0,4,0,2,0,1],Q=[0,4,0,2,0,1,0],J=[8,8,8,4,4,2,2],q=[8,8,4,4,2,2,1],w=0;w<7;){for(var N=J[w],V=q[w],H=0,Y=0,O=z[w];O<b;)O+=N,Y++;for(var ee=Q[w];ee<m;)ee+=V,H++;var Ae=Math.ceil(H*T/8);d.decode._filterZero(u,v,C,H,Y);for(var ce=0,ge=z[w];ge<b;){for(var me=Q[w],Me=C+ce*Ae<<3;me<m;){var ue;if(T==1&&(ue=(ue=u[Me>>3])>>7-(7&Me)&1,F[ge*k+(me>>3)]|=ue<<7-(3&me)),T==2&&(ue=(ue=u[Me>>3])>>6-(7&Me)&3,F[ge*k+(me>>2)]|=ue<<6-((3&me)<<1)),T==4&&(ue=(ue=u[Me>>3])>>4-(7&Me)&15,F[ge*k+(me>>1)]|=ue<<4-((1&me)<<2)),T>=8)for(var I=ge*k+me*x,he=0;he<x;he++)F[I+he]=u[(Me>>3)+he];Me+=T,me+=V}ce++,ge+=N}H*Y!=0&&(C+=Y*(1+Ae)),w+=1}return F},d.decode._getBPP=function(u){return[1,null,3,1,2,null,4][u.ctype]*u.depth},d.decode._filterZero=function(u,v,m,b,T){var x=d.decode._getBPP(v),k=Math.ceil(b*x/8),F=d.decode._paeth;x=Math.ceil(x/8);for(var C=0;C<T;C++){var z=m+C*k,Q=z+C+1,J=u[Q-1];if(J==0)for(var q=0;q<k;q++)u[z+q]=u[Q+q];else if(J==1){for(q=0;q<x;q++)u[z+q]=u[Q+q];for(q=x;q<k;q++)u[z+q]=u[Q+q]+u[z+q-x]&255}else if(C==0){for(q=0;q<x;q++)u[z+q]=u[Q+q];if(J==2)for(q=x;q<k;q++)u[z+q]=255&u[Q+q];if(J==3)for(q=x;q<k;q++)u[z+q]=u[Q+q]+(u[z+q-x]>>1)&255;if(J==4)for(q=x;q<k;q++)u[z+q]=u[Q+q]+F(u[z+q-x],0,0)&255}else{if(J==2)for(q=0;q<k;q++)u[z+q]=u[Q+q]+u[z+q-k]&255;if(J==3){for(q=0;q<x;q++)u[z+q]=u[Q+q]+(u[z+q-k]>>1)&255;for(q=x;q<k;q++)u[z+q]=u[Q+q]+(u[z+q-k]+u[z+q-x]>>1)&255}if(J==4){for(q=0;q<x;q++)u[z+q]=u[Q+q]+F(0,u[z+q-k],0)&255;for(q=x;q<k;q++)u[z+q]=u[Q+q]+F(u[z+q-x],u[z+q-k],u[z+q-x-k])&255}}}return u},d.decode._paeth=function(u,v,m){var b=u+v-m,T=Math.abs(b-u),x=Math.abs(b-v),k=Math.abs(b-m);return T<=x&&T<=k?u:x<=k?v:m},d.decode._IHDR=function(u,v,m){var b=d._bin;m.width=b.readUint(u,v),v+=4,m.height=b.readUint(u,v),v+=4,m.depth=u[v],v++,m.ctype=u[v],v++,m.compress=u[v],v++,m.filter=u[v],v++,m.interlace=u[v],v++},d._bin={nextZero:function(u,v){for(;u[v]!=0;)v++;return v},readUshort:function(u,v){return u[v]<<8|u[v+1]},writeUshort:function(u,v,m){u[v]=m>>8&255,u[v+1]=255&m},readUint:function(u,v){return 16777216*u[v]+(u[v+1]<<16|u[v+2]<<8|u[v+3])},writeUint:function(u,v,m){u[v]=m>>24&255,u[v+1]=m>>16&255,u[v+2]=m>>8&255,u[v+3]=255&m},readASCII:function(u,v,m){for(var b="",T=0;T<m;T++)b+=String.fromCharCode(u[v+T]);return b},writeASCII:function(u,v,m){for(var b=0;b<m.length;b++)u[v+b]=m.charCodeAt(b)},readBytes:function(u,v,m){for(var b=[],T=0;T<m;T++)b.push(u[v+T]);return b},pad:function(u){return u.length<2?"0"+u:u},readUTF8:function(u,v,m){for(var b,T="",x=0;x<m;x++)T+="%"+d._bin.pad(u[v+x].toString(16));try{b=decodeURIComponent(T)}catch{return d._bin.readASCII(u,v,m)}return b}},d._copyTile=function(u,v,m,b,T,x,k,F,C){for(var z=Math.min(v,T),Q=Math.min(m,x),J=0,q=0,w=0;w<Q;w++)for(var N=0;N<z;N++)if(k>=0&&F>=0?(J=w*v+N<<2,q=(F+w)*T+k+N<<2):(J=(-F+w)*v-k+N<<2,q=w*T+N<<2),C==0)b[q]=u[J],b[q+1]=u[J+1],b[q+2]=u[J+2],b[q+3]=u[J+3];else if(C==1){var V=u[J+3]*.00392156862745098,H=u[J]*V,Y=u[J+1]*V,O=u[J+2]*V,ee=b[q+3]*(1/255),Ae=b[q]*ee,ce=b[q+1]*ee,ge=b[q+2]*ee,me=1-V,Me=V+ee*me,ue=Me==0?0:1/Me;b[q+3]=255*Me,b[q+0]=(H+Ae*me)*ue,b[q+1]=(Y+ce*me)*ue,b[q+2]=(O+ge*me)*ue}else if(C==2)V=u[J+3],H=u[J],Y=u[J+1],O=u[J+2],ee=b[q+3],Ae=b[q],ce=b[q+1],ge=b[q+2],V==ee&&H==Ae&&Y==ce&&O==ge?(b[q]=0,b[q+1]=0,b[q+2]=0,b[q+3]=0):(b[q]=H,b[q+1]=Y,b[q+2]=O,b[q+3]=V);else if(C==3){if(V=u[J+3],H=u[J],Y=u[J+1],O=u[J+2],ee=b[q+3],Ae=b[q],ce=b[q+1],ge=b[q+2],V==ee&&H==Ae&&Y==ce&&O==ge)continue;if(V<220&&ee>20)return!1}return!0},d.encode=function(u,v,m,b,T,x){b==null&&(b=0),x==null&&(x=!1);for(var k=new Uint8Array(u[0].byteLength*u.length+100),F=[137,80,78,71,13,10,26,10],C=0;C<8;C++)k[C]=F[C];var z=8,Q=d._bin,J=d.crc.crc,q=Q.writeUint,w=Q.writeUshort,N=Q.writeASCII,V=d.encode.compressPNG(u,v,m,b,x);q(k,z,13),N(k,z+=4,"IHDR"),q(k,z+=4,v),q(k,z+=4,m),k[z+=4]=V.depth,k[++z]=V.ctype,k[++z]=0,k[++z]=0,k[++z]=0,q(k,++z,J(k,z-17,17)),q(k,z+=4,1),N(k,z+=4,"sRGB"),k[z+=4]=1,q(k,++z,J(k,z-5,5)),z+=4;var H=u.length>1;if(H&&(q(k,z,8),N(k,z+=4,"acTL"),q(k,z+=4,u.length),q(k,z+=4,0),q(k,z+=4,J(k,z-12,12)),z+=4),V.ctype==3){for(q(k,z,3*(ue=V.plte.length)),N(k,z+=4,"PLTE"),z+=4,C=0;C<ue;C++){var Y=3*C,O=V.plte[C],ee=255&O,Ae=O>>8&255,ce=O>>16&255;k[z+Y+0]=ee,k[z+Y+1]=Ae,k[z+Y+2]=ce}if(q(k,z+=3*ue,J(k,z-3*ue-4,3*ue+4)),z+=4,V.gotAlpha){for(q(k,z,ue),N(k,z+=4,"tRNS"),z+=4,C=0;C<ue;C++)k[z+C]=V.plte[C]>>24&255;q(k,z+=ue,J(k,z-ue-4,ue+4)),z+=4}}for(var ge=0,me=0;me<V.frames.length;me++){var Me=V.frames[me];H&&(q(k,z,26),N(k,z+=4,"fcTL"),q(k,z+=4,ge++),q(k,z+=4,Me.rect.width),q(k,z+=4,Me.rect.height),q(k,z+=4,Me.rect.x),q(k,z+=4,Me.rect.y),w(k,z+=4,T[me]),w(k,z+=2,1e3),k[z+=2]=Me.dispose,k[++z]=Me.blend,q(k,++z,J(k,z-30,30)),z+=4);var ue,I=Me.cimg;q(k,z,(ue=I.length)+(me==0?0:4));var he=z+=4;for(N(k,z,me==0?"IDAT":"fdAT"),z+=4,me!=0&&(q(k,z,ge++),z+=4),C=0;C<ue;C++)k[z+C]=I[C];q(k,z+=ue,J(k,he,z-he)),z+=4}return q(k,z,0),N(k,z+=4,"IEND"),q(k,z+=4,J(k,z-4,4)),z+=4,k.buffer.slice(0,z)},d.encode.compressPNG=function(u,v,m,b,T){for(var x=d.encode.compress(u,v,m,b,!1,T),k=0;k<u.length;k++){var F=x.frames[k],C=(F.rect.width,F.rect.height),z=F.bpl,Q=F.bpp,J=new Uint8Array(C*z+C);F.cimg=d.encode._filterZero(F.img,C,Q,z,J)}return x},d.encode.compress=function(u,v,m,b,T,x){x==null&&(x=!1);for(var k=6,F=8,C=4,z=255,Q=0;Q<u.length;Q++)for(var J=new Uint8Array(u[Q]),q=J.length,w=0;w<q;w+=4)z&=J[w+3];var N=z!=255,V={},H=[];if(u.length!=0&&(V[0]=0,H.push(0),b!=0&&b--),b!=0){var Y=d.quantize(u,b,T);for(u=Y.bufs,w=0;w<Y.plte.length;w++)V[ee=Y.plte[w].est.rgba]==null&&(V[ee]=H.length,H.push(ee))}else for(Q=0;Q<u.length;Q++){var O=new Uint32Array(u[Q]);for(q=O.length,w=0;w<q;w++){var ee=O[w];if((w<v||ee!=O[w-1]&&ee!=O[w-v])&&V[ee]==null&&(V[ee]=H.length,H.push(ee),H.length>=300))break}}var Ae=!!N&&T,ce=H.length;ce<=256&&x==0&&(F=ce<=2?1:ce<=4?2:ce<=16?4:8,T&&(F=8),N=!0);var ge=[];for(Q=0;Q<u.length;Q++){var me=new Uint8Array(u[Q]),Me=new Uint32Array(me.buffer),ue=0,I=0,he=v,se=m,K=0;if(Q!=0&&!Ae){for(var Re=T||Q==1||ge[ge.length-2].dispose==2?1:2,fe=0,De=1e9,We=0;We<Re;We++){for(var oe=new Uint8Array(u[Q-1-We]),Ee=new Uint32Array(u[Q-1-We]),He=v,Ue=m,Ie=-1,rt=-1,st=0;st<m;st++)for(var at=0;at<v;at++)Me[w=st*v+at]!=Ee[w]&&(at<He&&(He=at),at>Ie&&(Ie=at),st<Ue&&(Ue=st),st>rt&&(rt=st));var Ft=Ie==-1?1:(Ie-He+1)*(rt-Ue+1);Ft<De&&(De=Ft,fe=We,Ie==-1?(ue=I=0,he=se=1):(ue=He,I=Ue,he=Ie-He+1,se=rt-Ue+1))}oe=new Uint8Array(u[Q-1-fe]),fe==1&&(ge[ge.length-1].dispose=2);var At=new Uint8Array(he*se*4);new Uint32Array(At.buffer),d._copyTile(oe,v,m,At,he,se,-ue,-I,0),d._copyTile(me,v,m,At,he,se,-ue,-I,3)?(d._copyTile(me,v,m,At,he,se,-ue,-I,2),K=1):(d._copyTile(me,v,m,At,he,se,-ue,-I,0),K=0),me=At,Me=new Uint32Array(me.buffer)}var or=4*he;if(ce<=256&&x==0){for(or=Math.ceil(F*he/8),At=new Uint8Array(or*se),st=0;st<se;st++){w=st*or;var ar=st*he;if(F==8)for(at=0;at<he;at++)At[w+at]=V[Me[ar+at]];else if(F==4)for(at=0;at<he;at++)At[w+(at>>1)]|=V[Me[ar+at]]<<4-4*(1&at);else if(F==2)for(at=0;at<he;at++)At[w+(at>>2)]|=V[Me[ar+at]]<<6-2*(3&at);else if(F==1)for(at=0;at<he;at++)At[w+(at>>3)]|=V[Me[ar+at]]<<7-1*(7&at)}me=At,k=3,C=1}else if(N==0&&u.length==1){At=new Uint8Array(he*se*3);var kr=he*se;for(w=0;w<kr;w++){var Er=3*w,pr=4*w;At[Er]=me[pr],At[Er+1]=me[pr+1],At[Er+2]=me[pr+2]}me=At,k=2,C=3,or=3*he}ge.push({rect:{x:ue,y:I,width:he,height:se},img:me,bpl:or,bpp:C,blend:K,dispose:Ae?1:0})}return{ctype:k,depth:F,plte:H,gotAlpha:N,frames:ge}},d.encode._filterZero=function(u,v,m,b,T){for(var x=[],k=0;k<5;k++)if(!(v*b>5e5)||k!=2&&k!=3&&k!=4){for(var F=0;F<v;F++)d.encode._filterLine(T,u,F,b,m,k);if(x.push(R.deflate(T)),m==1)break}for(var C,z=1e9,Q=0;Q<x.length;Q++)x[Q].length<z&&(C=Q,z=x[Q].length);return x[C]},d.encode._filterLine=function(u,v,m,b,T,x){var k=m*b,F=k+m,C=d.decode._paeth;if(u[F]=x,F++,x==0)for(var z=0;z<b;z++)u[F+z]=v[k+z];else if(x==1){for(z=0;z<T;z++)u[F+z]=v[k+z];for(z=T;z<b;z++)u[F+z]=v[k+z]-v[k+z-T]+256&255}else if(m==0){for(z=0;z<T;z++)u[F+z]=v[k+z];if(x==2)for(z=T;z<b;z++)u[F+z]=v[k+z];if(x==3)for(z=T;z<b;z++)u[F+z]=v[k+z]-(v[k+z-T]>>1)+256&255;if(x==4)for(z=T;z<b;z++)u[F+z]=v[k+z]-C(v[k+z-T],0,0)+256&255}else{if(x==2)for(z=0;z<b;z++)u[F+z]=v[k+z]+256-v[k+z-b]&255;if(x==3){for(z=0;z<T;z++)u[F+z]=v[k+z]+256-(v[k+z-b]>>1)&255;for(z=T;z<b;z++)u[F+z]=v[k+z]+256-(v[k+z-b]+v[k+z-T]>>1)&255}if(x==4){for(z=0;z<T;z++)u[F+z]=v[k+z]+256-C(0,v[k+z-b],0)&255;for(z=T;z<b;z++)u[F+z]=v[k+z]+256-C(v[k+z-T],v[k+z-b],v[k+z-T-b])&255}}},d.crc={table:(function(){for(var u=new Uint32Array(256),v=0;v<256;v++){for(var m=v,b=0;b<8;b++)1&m?m=3988292384^m>>>1:m>>>=1;u[v]=m}return u})(),update:function(u,v,m,b){for(var T=0;T<b;T++)u=d.crc.table[255&(u^v[m+T])]^u>>>8;return u},crc:function(u,v,m){return 4294967295^d.crc.update(4294967295,u,v,m)}},d.quantize=function(u,v,m){for(var b=[],T=0,x=0;x<u.length;x++)b.push(d.encode.alphaMul(new Uint8Array(u[x]),m)),T+=u[x].byteLength;var k=new Uint8Array(T),F=new Uint32Array(k.buffer),C=0;for(x=0;x<b.length;x++){for(var z=b[x],Q=z.length,J=0;J<Q;J++)k[C+J]=z[J];C+=Q}var q={i0:0,i1:k.length,bst:null,est:null,tdst:0,left:null,right:null};q.bst=d.quantize.stats(k,q.i0,q.i1),q.est=d.quantize.estats(q.bst);for(var w=[q];w.length<v;){var N=0,V=0;for(x=0;x<w.length;x++)w[x].est.L>N&&(N=w[x].est.L,V=x);if(N<.001)break;var H=w[V],Y=d.quantize.splitPixels(k,F,H.i0,H.i1,H.est.e,H.est.eMq255),O={i0:H.i0,i1:Y,bst:null,est:null,tdst:0,left:null,right:null};O.bst=d.quantize.stats(k,O.i0,O.i1),O.est=d.quantize.estats(O.bst);var ee={i0:Y,i1:H.i1,bst:null,est:null,tdst:0,left:null,right:null};for(ee.bst={R:[],m:[],N:H.bst.N-O.bst.N},x=0;x<16;x++)ee.bst.R[x]=H.bst.R[x]-O.bst.R[x];for(x=0;x<4;x++)ee.bst.m[x]=H.bst.m[x]-O.bst.m[x];ee.est=d.quantize.estats(ee.bst),H.left=O,H.right=ee,w[V]=O,w.push(ee)}w.sort(function(Re,fe){return fe.bst.N-Re.bst.N});for(var Ae=0;Ae<b.length;Ae++){var ce=d.quantize.planeDst,ge=new Uint8Array(b[Ae].buffer),me=new Uint32Array(b[Ae].buffer),Me=ge.length;for(x=0;x<Me;x+=4){for(var ue=ge[x]*.00392156862745098,I=ge[x+1]*.00392156862745098,he=ge[x+2]*.00392156862745098,se=ge[x+3]*.00392156862745098,K=q;K.left;)K=ce(K.est,ue,I,he,se)<=0?K.left:K.right;me[x>>2]=K.est.rgba}b[Ae]=me.buffer}return{bufs:b,plte:w}},d.quantize.getNearest=function(u,v,m,b,T){if(u.left==null)return u.tdst=d.quantize.dist(u.est.q,v,m,b,T),u;var x=d.quantize.planeDst(u.est,v,m,b,T),k=u.left,F=u.right;x>0&&(k=u.right,F=u.left);var C=d.quantize.getNearest(k,v,m,b,T);if(C.tdst<=x*x)return C;var z=d.quantize.getNearest(F,v,m,b,T);return z.tdst<C.tdst?z:C},d.quantize.planeDst=function(u,v,m,b,T){var x=u.e;return x[0]*v+x[1]*m+x[2]*b+x[3]*T-u.eMq},d.quantize.dist=function(u,v,m,b,T){var x=v-u[0],k=m-u[1],F=b-u[2],C=T-u[3];return x*x+k*k+F*F+C*C},d.quantize.splitPixels=function(u,v,m,b,T,x){var k=d.quantize.vecDot;for(b-=4;m<b;){for(;k(u,m,T)<=x;)m+=4;for(;k(u,b,T)>x;)b-=4;if(m>=b)break;var F=v[m>>2];v[m>>2]=v[b>>2],v[b>>2]=F,m+=4,b-=4}for(;k(u,m,T)>x;)m-=4;return m+4},d.quantize.vecDot=function(u,v,m){return u[v]*m[0]+u[v+1]*m[1]+u[v+2]*m[2]+u[v+3]*m[3]},d.quantize.stats=function(u,v,m){for(var b=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],T=[0,0,0,0],x=m-v>>2,k=v;k<m;k+=4){var F=u[k]*.00392156862745098,C=u[k+1]*(1/255),z=u[k+2]*(1/255),Q=u[k+3]*(1/255);T[0]+=F,T[1]+=C,T[2]+=z,T[3]+=Q,b[0]+=F*F,b[1]+=F*C,b[2]+=F*z,b[3]+=F*Q,b[5]+=C*C,b[6]+=C*z,b[7]+=C*Q,b[10]+=z*z,b[11]+=z*Q,b[15]+=Q*Q}return b[4]=b[1],b[8]=b[2],b[12]=b[3],b[9]=b[6],b[13]=b[7],b[14]=b[11],{R:b,m:T,N:x}},d.quantize.estats=function(u){var v=u.R,m=u.m,b=u.N,T=m[0],x=m[1],k=m[2],F=m[3],C=b==0?0:1/b,z=[v[0]-T*T*C,v[1]-T*x*C,v[2]-T*k*C,v[3]-T*F*C,v[4]-x*T*C,v[5]-x*x*C,v[6]-x*k*C,v[7]-x*F*C,v[8]-k*T*C,v[9]-k*x*C,v[10]-k*k*C,v[11]-k*F*C,v[12]-F*T*C,v[13]-F*x*C,v[14]-F*k*C,v[15]-F*F*C],Q=z,J=d.M4,q=[.5,.5,.5,.5],w=0,N=0;if(b!=0)for(var V=0;V<10&&(q=J.multVec(Q,q),N=Math.sqrt(J.dot(q,q)),q=J.sml(1/N,q),!(Math.abs(N-w)<1e-9));V++)w=N;var H=[T*C,x*C,k*C,F*C],Y=J.dot(J.sml(255,H),q),O=H[3]<.001?0:1/H[3];return{Cov:z,q:H,e:q,L:w,eMq255:Y,eMq:J.dot(q,H),rgba:(Math.round(255*H[3])<<24|Math.round(255*H[2]*O)<<16|Math.round(255*H[1]*O)<<8|Math.round(255*H[0]*O))>>>0}},d.M4={multVec:function(u,v){return[u[0]*v[0]+u[1]*v[1]+u[2]*v[2]+u[3]*v[3],u[4]*v[0]+u[5]*v[1]+u[6]*v[2]+u[7]*v[3],u[8]*v[0]+u[9]*v[1]+u[10]*v[2]+u[11]*v[3],u[12]*v[0]+u[13]*v[1]+u[14]*v[2]+u[15]*v[3]]},dot:function(u,v){return u[0]*v[0]+u[1]*v[1]+u[2]*v[2]+u[3]*v[3]},sml:function(u,v){return[u*v[0],u*v[1],u*v[2],u*v[3]]}},d.encode.alphaMul=function(u,v){for(var m=new Uint8Array(u.length),b=u.length>>2,T=0;T<b;T++){var x=T<<2,k=u[x+3];v&&(k=k<128?0:255);var F=k*(1/255);m[x+0]=u[x+0]*F,m[x+1]=u[x+1]*F,m[x+2]=u[x+2]*F,m[x+3]=k}return m}})(c,a(788))},165:r=>{r.exports=function(n,a){var c,d,R,u,v,m,b,T,x,k,F,C,z,Q,J,q,w,N,V,H,Y,O,ee,Ae,ce;c=n.state,d=n.next_in,Ae=n.input,R=d+(n.avail_in-5),u=n.next_out,ce=n.output,v=u-(a-n.avail_out),m=u+(n.avail_out-257),b=c.dmax,T=c.wsize,x=c.whave,k=c.wnext,F=c.window,C=c.hold,z=c.bits,Q=c.lencode,J=c.distcode,q=(1<<c.lenbits)-1,w=(1<<c.distbits)-1;e:do{z<15&&(C+=Ae[d++]<<z,z+=8,C+=Ae[d++]<<z,z+=8),N=Q[C&q];t:for(;;){if(C>>>=V=N>>>24,z-=V,(V=N>>>16&255)==0)ce[u++]=65535&N;else{if(!(16&V)){if(64&V){if(32&V){c.mode=12;break e}n.msg="invalid literal/length code",c.mode=30;break e}N=Q[(65535&N)+(C&(1<<V)-1)];continue t}for(H=65535&N,(V&=15)&&(z<V&&(C+=Ae[d++]<<z,z+=8),H+=C&(1<<V)-1,C>>>=V,z-=V),z<15&&(C+=Ae[d++]<<z,z+=8,C+=Ae[d++]<<z,z+=8),N=J[C&w];;){if(C>>>=V=N>>>24,z-=V,16&(V=N>>>16&255)){if(Y=65535&N,z<(V&=15)&&(C+=Ae[d++]<<z,(z+=8)<V&&(C+=Ae[d++]<<z,z+=8)),(Y+=C&(1<<V)-1)>b){n.msg="invalid distance too far back",c.mode=30;break e}if(C>>>=V,z-=V,Y>(V=u-v)){if((V=Y-V)>x&&c.sane){n.msg="invalid distance too far back",c.mode=30;break e}if(O=0,ee=F,k===0){if(O+=T-V,V<H){H-=V;do ce[u++]=F[O++];while(--V);O=u-Y,ee=ce}}else if(k<V){if(O+=T+k-V,(V-=k)<H){H-=V;do ce[u++]=F[O++];while(--V);if(O=0,k<H){H-=V=k;do ce[u++]=F[O++];while(--V);O=u-Y,ee=ce}}}else if(O+=k-V,V<H){H-=V;do ce[u++]=F[O++];while(--V);O=u-Y,ee=ce}for(;H>2;)ce[u++]=ee[O++],ce[u++]=ee[O++],ce[u++]=ee[O++],H-=3;H&&(ce[u++]=ee[O++],H>1&&(ce[u++]=ee[O++]))}else{O=u-Y;do ce[u++]=ce[O++],ce[u++]=ce[O++],ce[u++]=ce[O++],H-=3;while(H>2);H&&(ce[u++]=ce[O++],H>1&&(ce[u++]=ce[O++]))}break}if(64&V){n.msg="invalid distance code",c.mode=30;break e}N=J[(65535&N)+(C&(1<<V)-1)]}}break}}while(d<R&&u<m);d-=H=z>>3,C&=(1<<(z-=H<<3))-1,n.next_in=d,n.next_out=u,n.avail_in=d<R?R-d+5:5-(d-R),n.avail_out=u<m?m-u+257:257-(u-m),c.hold=C,c.bits=z}},185:()=>{$3Dmol.workerString=(function(){self.onmessage=function(r){var n=r.data,a=n.type;if(a<0)self.atomData=n.atoms,self.volume=n.volume,self.ps=new ProteinSurface;else{var c=self.ps;c.initparm(n.expandedExtent,a!=1,self.volume),c.fillvoxels(self.atomData,n.extendedAtoms),c.buildboundary(),a!==4&&a!==2||(c.fastdistancemap(),c.boundingatom(!1),c.fillvoxelswaals(self.atomData,n.extendedAtoms)),c.marchingcube(a);var d=c.getFacesAndVertices(n.atomsToShow);self.postMessage(d)}}}).toString().replace(/(^.*?\{|\}$)/g,""),$3Dmol.workerString+=`;
function _classCallCheck() {};`,$3Dmol.workerString+=`;
`+$3Dmol.Vector3.toString(),$3Dmol.workerString+=`;
`+$3Dmol.MarchingCubeInitializer.toString()+`;

`,$3Dmol.workerString+=`;
`+$3Dmol.PointGrid.toString()+`;
`,$3Dmol.workerString+=`;
var ProteinSurface = `+$3Dmol.ProteinSurface.toString()+`;
`,$3Dmol.SurfaceWorker=window.URL?window.URL.createObjectURL(new Blob([$3Dmol.workerString],{type:"text/javascript"})):void 0},222:(r,n,a)=>{a.r(n),a.d(n,{CC:()=>d,Color:()=>c,builtinColorSchemes:()=>x,chains:()=>T,elementColors:()=>m,htmlColors:()=>R,residues:()=>b,ssColors:()=>u});class c{constructor(F,C,z){return this.r=0,this.g=0,this.b=0,arguments.length>1&&typeof F=="number"?(this.r=F||0,this.g=C||0,this.b=z||0,this):this.set(F||0)}set(F){return F instanceof c?F.clone():(typeof F=="number"?this.setHex(F):typeof F=="object"&&(this.r=F?.r||0,this.g=F?.g||0,this.b=F?.b||0),this)}setHex(F){return F=Math.floor(F),this.r=(F>>16&255)/255,this.g=(F>>8&255)/255,this.b=(255&F)/255,this}getHex(){return Math.round(255*this.r)<<16|Math.round(255*this.g)<<8|Math.round(255*this.b)}clone(){return new c(this.r,this.g,this.b)}copy(F){return this.r=F.r,this.g=F.g,this.b=F.b,this}scaled(){var F={};return F.r=Math.round(255*this.r),F.g=Math.round(255*this.g),F.b=Math.round(255*this.b),F.a=1,F}}class d{static color(F){if(!F)return d.cache[0];if(F instanceof c)return F;if(typeof F=="number"&&d.cache[F]!==void 0)return d.cache[F];if(F&&Array.isArray(F))return F.map(d.color);let C=d.getHex(F),z=new c(C);return d.cache[C]=z,z}static getHex(F){if(Array.isArray(F))return F.map(d.getHex);if(typeof F=="string"){let C=F;if(!isNaN(parseInt(C)))return parseInt(C);if(C=C.trim(),C.length==4&&C[0]=="#"&&(C="#"+C[1]+C[1]+C[2]+C[2]+C[3]+C[3]),C.length==7&&C[0]=="#")return parseInt(C.substring(1),16);let z=d.rgbRegEx.exec(C);if(z){z[1]!=""&&console.log("WARNING: Opacity value in rgba ignored.  Specify separately as opacity attribute.");let J=0;for(let q=2;q<5;q++){J*=256;let w=z[q].endsWith("%")?255*parseFloat(z[q])/100:parseFloat(z[q]);J+=Math.round(w)}return J}let Q=R[C.toLowerCase()];return Q!==void 0?Q:(console.error("color not found",F.toLowerCase(),R),0)}return F}}d.rgbRegEx=/rgb(a?)\(\s*([^ ,\)\t]+)\s*,\s*([^ ,\)\t]+)\s*,\s*([^ ,\)\t]+)/i,d.cache={0:new c(0)};const R={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgrey:11119017,darkgreen:25600,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,grey:8421504,green:32768,greenyellow:11403055,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgrey:13882323,lightgreen:9498256,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074,b:255,g:32768,r:16711680,c:49087,m:12517567,y:12566272,k:0,w:16777215},u={pyMol:{h:16711680,s:16776960,c:65280},Jmol:{h:16711808,s:16762880,c:16777215}},v={H:16777215,He:16761035,HE:16761035,Li:11674146,LI:11674146,B:65280,C:13158600,N:9408511,O:15728640,F:14329120,Na:255,NA:255,Mg:2263842,MG:2263842,Al:8421520,AL:8421520,Si:14329120,SI:14329120,P:16753920,S:16762930,Cl:65280,CL:65280,Ca:8421520,CA:8421520,Ti:8421520,TI:8421520,Cr:8421520,CR:8421520,Mn:8421520,MN:8421520,Fe:16753920,FE:16753920,Ni:10824234,NI:10824234,Cu:10824234,CU:10824234,Zn:10824234,ZN:10824234,Br:10824234,BR:10824234,Ag:8421520,AG:8421520,I:10494192,Ba:16753920,BA:16753920,Au:14329120,AU:14329120},m={defaultColor:16716947,Jmol:{H:16777215,He:14286847,HE:14286847,Li:13402367,LI:13402367,Be:12779264,BE:12779264,B:16758197,C:9474192,N:3166456,O:16715021,F:9494608,Ne:11789301,NE:11789301,Na:11230450,NA:11230450,Mg:9109248,MG:9109248,Al:12560038,AL:12560038,Si:1578e4,SI:1578e4,P:16744448,S:16777008,Cl:2093087,CL:2093087,Ar:8442339,AR:8442339,K:9388244,Ca:4062976,CA:4062976,Sc:15132390,SC:15132390,Ti:12567239,TI:12567239,V:10921643,Cr:9083335,CR:9083335,Mn:10255047,MN:10255047,Fe:14706227,FE:14706227,Co:15765664,CO:15765664,Ni:5296208,NI:5296208,Cu:13140019,CU:13140019,Zn:8224944,ZN:8224944,Ga:12750735,GA:12750735,Ge:6721423,GE:6721423,As:12419299,AS:12419299,Se:16752896,SE:16752896,Br:10889513,BR:10889513,Kr:6076625,KR:6076625,Rb:7351984,RB:7351984,Sr:65280,SR:65280,Y:9764863,Zr:9756896,ZR:9756896,Nb:7586505,NB:7586505,Mo:5551541,MO:5551541,Tc:3907230,TC:3907230,Ru:2396047,RU:2396047,Rh:687500,RH:687500,Pd:27013,PD:27013,Ag:12632256,AG:12632256,Cd:16767375,CD:16767375,In:10909043,IN:10909043,Sn:6717568,SN:6717568,Sb:10380213,SB:10380213,Te:13924864,TE:13924864,I:9699476,Xe:4366e3,XE:4366e3,Cs:5707663,CS:5707663,Ba:51456,BA:51456,La:7394559,LA:7394559,Ce:16777159,CE:16777159,Pr:14286791,PR:14286791,Nd:13107143,ND:13107143,Pm:10747847,PM:10747847,Sm:9437127,SM:9437127,Eu:6422471,EU:6422471,Gd:4587463,GD:4587463,Tb:3211207,TB:3211207,Dy:2097095,DY:2097095,Ho:65436,HO:65436,Er:58997,ER:58997,Tm:54354,TM:54354,Yb:48952,YB:48952,Lu:43812,LU:43812,Hf:5096191,HF:5096191,Ta:5089023,TA:5089023,W:2200790,Re:2522539,RE:2522539,Os:2516630,OS:2516630,Ir:1528967,IR:1528967,Pt:13684960,PT:13684960,Au:16765219,AU:16765219,Hg:12105936,HG:12105936,Tl:10900557,TL:10900557,Pb:5724513,PB:5724513,Bi:10375093,BI:10375093,Po:11230208,PO:11230208,At:7688005,AT:7688005,Rn:4358806,RN:4358806,Fr:4325478,FR:4325478,Ra:32e3,RA:32e3,Ac:7384058,AC:7384058,Th:47871,TH:47871,Pa:41471,PA:41471,U:36863,Np:33023,NP:33023,Pu:27647,PU:27647,Am:5528818,AM:5528818,Cm:7888099,CM:7888099,Bk:9064419,BK:9064419,Cf:10565332,CF:10565332,Es:11739092,ES:11739092,Fm:11739066,FM:11739066,Md:11734438,MD:11734438,No:12389767,NO:12389767,Lr:13041766,LR:13041766,Rf:13369433,RF:13369433,Db:13697103,DB:13697103,Sg:14221381,SG:14221381,Bh:14680120,BH:14680120,Hs:15073326,HS:15073326,Mt:15400998,MT:15400998},rasmol:v,defaultColors:Object.assign({},v),greenCarbon:Object.assign(Object.assign({},v),{C:65280}),cyanCarbon:Object.assign(Object.assign({},v),{C:65535}),magentaCarbon:Object.assign(Object.assign({},v),{C:16711935}),yellowCarbon:Object.assign(Object.assign({},v),{C:16776960}),whiteCarbon:Object.assign(Object.assign({},v),{C:16777215}),orangeCarbon:Object.assign(Object.assign({},v),{C:16753920}),purpleCarbon:Object.assign(Object.assign({},v),{C:8388736}),blueCarbon:Object.assign(Object.assign({},v),{C:255})},b={amino:{ALA:13158600,ARG:1334015,ASN:56540,ASP:15075850,CYS:15132160,GLN:56540,GLU:15075850,GLY:15461355,HIS:8553170,ILE:1016335,LEU:1016335,LYS:1334015,MET:15132160,PHE:3289770,PRO:14456450,SER:16422400,THR:16422400,TRP:11819700,TYR:3289770,VAL:1016335,ASX:16738740,GLX:16738740},shapely:{ALA:9240460,ARG:124,ASN:16743536,ASP:10485826,CYS:16777072,GLN:16731212,GLU:6684672,GLY:16777215,HIS:7368959,ILE:19456,LEU:4546117,LYS:4671416,MET:12099650,PHE:5459026,PRO:5395026,SER:16740418,THR:12078080,TRP:5195264,TYR:9203788,VAL:16747775,ASX:16711935,GLX:16711935},nucleic:{A:10526975,G:16740464,I:8454143,C:16747595,T:10551200,U:16744576}},T={atom:{A:12636415,B:11599792,C:16761032,D:16777088,E:16761087,F:11596016,G:16765040,H:15761536,I:16113331,J:49151,K:13458524,L:6737322,M:10145074,N:15631086,O:52945,P:65407,Q:3978097,R:139,S:12433259,T:25600,U:8388608,V:8421376,W:8388736,X:32896,Y:12092939,Z:11674146},hetatm:{A:9478351,B:8441752,C:13602992,D:13619056,E:13603023,F:8437952,G:13607008,H:12603504,I:12955267,J:42959,K:11881548,L:5682578,M:9090346,N:12481214,O:46753,P:53103,Q:3447649,R:187,S:10854235,T:37888,U:11534336,V:11579392,W:11534512,X:45232,Y:15250963,Z:12726834}},x={ssPyMol:{prop:"ss",map:u.pyMol},ssJmol:{prop:"ss",map:u.Jmol},Jmol:{prop:"elem",map:m.Jmol},amino:{prop:"resn",map:b.amino},shapely:{prop:"resn",map:b.shapely},nucleic:{prop:"resn",map:b.nucleic},chain:{prop:"chain",map:T.atom},rasmol:{prop:"elem",map:m.rasmol},default:{prop:"elem",map:m.defaultColors},greenCarbon:{prop:"elem",map:m.greenCarbon},chainHetatm:{prop:"chain",map:T.hetatm},cyanCarbon:{prop:"elem",map:m.cyanCarbon},magentaCarbon:{prop:"elem",map:m.magentaCarbon},purpleCarbon:{prop:"elem",map:m.purpleCarbon},whiteCarbon:{prop:"elem",map:m.whiteCarbon},orangeCarbon:{prop:"elem",map:m.orangeCarbon},yellowCarbon:{prop:"elem",map:m.yellowCarbon},blueCarbon:{prop:"elem",map:m.blueCarbon}}},307:r=>{typeof r.exports=="object"&&(r.exports=window.$3Dmol)},358:(r,n,a)=>{var c=a(981),d=15,R=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],u=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],v=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],m=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(b,T,x,k,F,C,z,Q){var J,q,w,N,V,H,Y,O,ee,Ae=Q.bits,ce=0,ge=0,me=0,Me=0,ue=0,I=0,he=0,se=0,K=0,Re=0,fe=null,De=0,We=new c.Buf16(16),oe=new c.Buf16(16),Ee=null,He=0;for(ce=0;ce<=d;ce++)We[ce]=0;for(ge=0;ge<k;ge++)We[T[x+ge]]++;for(ue=Ae,Me=d;Me>=1&&We[Me]===0;Me--);if(ue>Me&&(ue=Me),Me===0)return F[C++]=20971520,F[C++]=20971520,Q.bits=1,0;for(me=1;me<Me&&We[me]===0;me++);for(ue<me&&(ue=me),se=1,ce=1;ce<=d;ce++)if(se<<=1,(se-=We[ce])<0)return-1;if(se>0&&(b===0||Me!==1))return-1;for(oe[1]=0,ce=1;ce<d;ce++)oe[ce+1]=oe[ce]+We[ce];for(ge=0;ge<k;ge++)T[x+ge]!==0&&(z[oe[T[x+ge]]++]=ge);if(b===0?(fe=Ee=z,H=19):b===1?(fe=R,De-=257,Ee=u,He-=257,H=256):(fe=v,Ee=m,H=-1),Re=0,ge=0,ce=me,V=C,I=ue,he=0,w=-1,N=(K=1<<ue)-1,b===1&&K>852||b===2&&K>592)return 1;for(;;){Y=ce-he,z[ge]<H?(O=0,ee=z[ge]):z[ge]>H?(O=Ee[He+z[ge]],ee=fe[De+z[ge]]):(O=96,ee=0),J=1<<ce-he,me=q=1<<I;do F[V+(Re>>he)+(q-=J)]=Y<<24|O<<16|ee;while(q!==0);for(J=1<<ce-1;Re&J;)J>>=1;if(J!==0?(Re&=J-1,Re+=J):Re=0,ge++,--We[ce]===0){if(ce===Me)break;ce=T[x+z[ge]]}if(ce>ue&&(Re&N)!==w){for(he===0&&(he=ue),V+=me,se=1<<(I=ce-he);I+he<Me&&!((se-=We[I+he])<=0);)I++,se<<=1;if(K+=1<<I,b===1&&K>852||b===2&&K>592)return 1;F[w=Re&N]=ue<<24|I<<16|V-C}}return Re!==0&&(F[V+Re]=ce-he<<24|4194304),Q.bits=ue,0}},378:(r,n,a)=>{var c;a.r(n),a.d(n,{BackSide:()=>R,Camera:()=>Wi,ClampToEdgeWrapping:()=>T,Coloring:()=>c,Cylinder:()=>K.Cylinder,DoubleSide:()=>u,EventDispatcher:()=>N,FloatType:()=>z,Fog:()=>tn,FrontSide:()=>d,Geometry:()=>ce,GeometryGroup:()=>Ae,GeometryIDCount:()=>ge,ImposterMaterial:()=>kr,InstancedMaterial:()=>Er,Light:()=>I,Line:()=>Se,LineBasicMaterial:()=>O,LineStyle:()=>pe,LinearFilter:()=>x,LinearMipMapLinearFilter:()=>F,Material:()=>H,MaterialIdCount:()=>Y,Matrix3:()=>m.Matrix3,Matrix4:()=>m.Matrix4,Mesh:()=>Le,MeshDoubleLambertMaterial:()=>vr,MeshLambertMaterial:()=>pr,MeshOutlineMaterial:()=>xr,NearestFilter:()=>k,Object3D:()=>Me,Object3DIDCount:()=>me,Projector:()=>se,Quaternion:()=>m.Quaternion,R32Format:()=>q,RFormat:()=>J,RGBAFormat:()=>Q,Ray:()=>m.Ray,Raycaster:()=>De,Renderer:()=>qi,Scene:()=>ue,ShaderLib:()=>Zr,ShaderUtils:()=>yi,Shading:()=>v,Sphere:()=>K.Sphere,SphereImposterMaterial:()=>fi,SphereImposterOutlineMaterial:()=>Rr,Sprite:()=>dt,SpriteAlignment:()=>b,SpriteMaterial:()=>Ir,SpritePlugin:()=>on,StickImposterMaterial:()=>Di,StickImposterOutlineMaterial:()=>wi,Texture:()=>or,TextureIdCount:()=>ar,TextureOperations:()=>w,Triangle:()=>K.Triangle,UVMapping:()=>At,UnsignedByteType:()=>C,Vector2:()=>m.Vector2,Vector3:()=>m.Vector3,VolumetricMaterial:()=>Hi,basic:()=>zt,clamp:()=>m.clamp,clone:()=>Vi,conversionMatrix3:()=>m.conversionMatrix3,degToRad:()=>m.degToRad,instanced:()=>Lt,intersectObject:()=>Ft,lambert:()=>It,lambertdouble:()=>li,outline:()=>ui,screen:()=>gi,screenaa:()=>jr,sphereimposter:()=>Dr,sphereimposteroutline:()=>vi,sprite:()=>bi,stickimposter:()=>Ni,stickimposteroutline:()=>Ti,volumetric:()=>Br}),(function(Bt){Bt[Bt.NoColors=0]="NoColors",Bt[Bt.FaceColors=1]="FaceColors",Bt[Bt.VertexColors=2]="VertexColors"})(c||(c={}));const d=0,R=1,u=2;var v;(function(Bt){Bt[Bt.NoShading=0]="NoShading",Bt[Bt.FlatShading=1]="FlatShading",Bt[Bt.SmoothShading=2]="SmoothShading"})(v||(v={}));var m=a(529);const b={topLeft:new m.Vector2(1,-1),topCenter:new m.Vector2(0,-1),topRight:new m.Vector2(-1,-1),centerLeft:new m.Vector2(1,0),center:new m.Vector2(0,0),centerRight:new m.Vector2(-1,0),bottomLeft:new m.Vector2(1,1),bottomCenter:new m.Vector2(0,1),bottomRight:new m.Vector2(-1,1)},T=1001,x=1006,k=1007,F=1008,C=1009,z=1010,Q=1021,J=1022,q=1023;var w;(function(Bt){Bt[Bt.MultiplyOperation=0]="MultiplyOperation",Bt[Bt.MixOperation=1]="MixOperation",Bt[Bt.AddOperation=2]="AddOperation"})(w||(w={}));class N{constructor(){this.listeners={}}dispatchEvent(_){var ne=this.listeners[_.type];if(ne!==void 0){_.target=this;for(var xe=0,Ve=ne.length;xe<Ve;xe++)ne[xe].call(this,_)}}removeEventListener(_,ne){if(ne){var xe=this.listeners[_].indexOf(ne);xe!==-1&&this.listeners[_].splice(xe,1)}else this.listeners[_]=[]}addEventListener(_,ne){this.listeners[_]===void 0&&(this.listeners[_]=[]),this.listeners[_].indexOf(ne)===-1&&this.listeners[_].push(ne)}}var V=a(222);class H extends N{constructor(){super(...arguments),this.id=Y++,this.name="",this.side=d,this.opacity=1,this.transparent=!1,this.depthTest=!0,this.depthWrite=!0,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.alphaTest=0,this.visible=!0,this.needsUpdate=!0,this.outline=!1,this.wireframe=!1,this.shaded=!1}setValues(_={}){if(_!==void 0)for(var ne in _){var xe=_[ne];if(xe!==void 0){if(ne in this){var Ve=this[ne];Ve instanceof V.Color&&xe instanceof V.Color?Ve.copy(xe):Ve instanceof V.Color?Ve.set(xe):Ve instanceof m.Vector3&&xe instanceof m.Vector3?Ve.copy(xe):this[ne]=xe}}else console.warn("$3Dmol.Material: '"+ne+"' parameter is undefined.")}}clone(_=new H){return _.name=this.name,_.side=this.side,_.opacity=this.opacity,_.transparent=this.transparent,_.depthTest=this.depthTest,_.depthWrite=this.depthWrite,_.polygonOffset=this.polygonOffset,_.polygonOffsetFactor=this.polygonOffsetFactor,_.polygonOffsetUnits=this.polygonOffsetUnits,_.alphaTest=this.alphaTest,_.overdraw=this.overdraw,_.visible=this.visible,_}makeShaded(_){this.shaded=!0,this.uniforms&&(this.uniforms.shading={type:"i",value:_},this.uniforms.vWidth={type:"f",value:1},this.uniforms.vHeight={type:"f",value:1})}dispose(){this.dispatchEvent({type:"dispose"})}}let Y=0;class O extends H{constructor(_){super(),this.color=new V.Color(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.vertexColors=!1,this.fog=!0,this.shaderID="basic",this.setValues(_)}clone(_=new O){return super.clone.call(this,_),_.color.copy(this.color),_}}const ee=65535;class Ae{constructor(_=0){this.vertexArray=null,this.colorArray=null,this.normalArray=null,this.radiusArray=null,this.faceArray=null,this.lineArray=null,this.atomArray=Array(),this.vertices=0,this.faceidx=0,this.lineidx=0,this.__inittedArrays=!1,this.id=_}setColor(_){var ne=this.vertexArray,xe=this.colorArray;if(!ne)throw new Error("vertex array not initialized");if(!xe)throw new Error("color array not initialized");let Ve=V.CC.color(_);for(var Oe=0;Oe<ne.length;Oe+=3)xe[Oe]=Ve.r,xe[Oe+1]=Ve.g,xe[Oe+2]=Ve.b}setColors(_){var ne=this.vertexArray,xe=this.colorArray;if(!ne)throw new Error("vertex array not initialized");if(!xe)throw new Error("color array not initialized");if(ne.length==xe.length)for(var Ve=0;Ve<ne.length;Ve+=3){var Oe=_(ne[Ve],ne[Ve+1],ne[Ve+2]);Oe instanceof V.Color||(Oe=V.CC.color(Oe)),xe[Ve]=Oe.r,xe[Ve+1]=Oe.g,xe[Ve+2]=Oe.b}else console.log("Cannot re-color geometry group due to mismatched lengths.")}getNumVertices(){return this.vertices}getVertices(){return this.vertexArray}getCentroid(){if(!this.vertexArray)throw new Error("vertex array not initialized");for(var _,ne,xe,Ve,Oe=new m.Vector3,yt=0;yt<this.vertices;++yt)_=3*yt,ne=this.vertexArray[_],xe=this.vertexArray[_+1],Ve=this.vertexArray[_+2],Oe.x+=ne,Oe.y+=xe,Oe.z+=Ve;return Oe.divideScalar(this.vertices),Oe}setNormals(){var _=this.faceArray,ne=this.vertexArray,xe=this.normalArray;if(this.vertices&&this.faceidx){if(!_)throw new Error("face array not initialized");if(!ne)throw new Error("vertex array not initialized");if(!xe)throw new Error("normal array not initialized");for(var Ve,Oe,yt,lt,mt,Mt,Pt,Ot=0;Ot<_.length/3;++Ot)Ve=3*_[3*Ot],Oe=3*_[3*Ot+1],yt=3*_[3*Ot+2],lt=new m.Vector3(ne[Ve],ne[Ve+1],ne[Ve+2]),mt=new m.Vector3(ne[Oe],ne[Oe+1],ne[Oe+2]),Mt=new m.Vector3(ne[yt],ne[yt+1],ne[yt+2]),lt.subVectors(lt,mt),Mt.subVectors(Mt,mt),Mt.cross(lt),(Pt=Mt).normalize(),xe[Ve]+=Pt.x,xe[Oe]+=Pt.x,xe[yt]+=Pt.x,xe[Ve+1]+=Pt.y,xe[Oe+1]+=Pt.y,xe[yt+1]+=Pt.y,xe[Ve+2]+=Pt.z,xe[Oe+2]+=Pt.z,xe[yt+2]+=Pt.z}}setLineIndices(){if(this.faceidx&&(!this.lineArray||this.lineArray.length!=2*this.faceidx||this.lineidx!=2*this.faceidx)){var _=this.faceArray,ne=this.lineArray=new Uint16Array(2*this.faceidx);if(this.lineidx=2*this.faceidx,!_)throw new Error("face array not initialized");for(var xe=0;xe<this.faceidx/3;++xe){var Ve=3*xe,Oe=2*Ve,yt=_[Ve],lt=_[Ve+1],mt=_[Ve+2];ne[Oe]=yt,ne[Oe+1]=lt,ne[Oe+2]=yt,ne[Oe+3]=mt,ne[Oe+4]=lt,ne[Oe+5]=mt}}}vrml(_,ne){var xe,Ve,Oe,yt,lt,mt,Mt,Pt,Ot,gr,Zt,Ar,Cr,Ur,_r,Or,wr,Mi,Qt="";if(Qt+=_+`Shape {
`+_+` appearance Appearance {
`+_+`  material Material {
`+_+"   diffuseColor "+((xe=ne?.color)===null||xe===void 0?void 0:xe.r)+" "+((Ve=ne?.color)===null||Ve===void 0?void 0:Ve.g)+" "+((Oe=ne?.color)===null||Oe===void 0?void 0:Oe.b)+`
`,ne.wireframe&&this.colorArray){let ae=this.colorArray;Qt+=_+"    emissiveColor "+ae[0]+" "+ae[1]+" "+ae[2]+`
`}ne?.transparent&&(Qt+=_+"   transparency "+(1-ne.opacity)+`
`),Qt+=_+`  }
`,Qt+=_+` }
`;var ri=_;if(_+=" ",ne instanceof O||ne.wireframe){let ae,i,s;Qt+=_+`geometry IndexedLineSet {
`+_+` colorPerVertex TRUE
`+_+` coord Coordinate {
`+_+`  point [
`;for(let l=0;l<this.vertices;++l){let h=3*l;ae=(yt=this.vertexArray)===null||yt===void 0?void 0:yt[h],i=(lt=this.vertexArray)===null||lt===void 0?void 0:lt[h+1],s=(mt=this.vertexArray)===null||mt===void 0?void 0:mt[h+2],Qt+=_+"   "+ae+" "+i+" "+s+`,
`}if(Qt+=_+`  ]
`,Qt+=_+` }
`,this.colorArray&&!ne.wireframe){Qt+=_+` color Color {
`+_+`  color [
`;for(let l=0;l<this.vertices;++l){let h=3*l;ae=this.colorArray[h],i=this.colorArray[h+1],s=this.colorArray[h+2],Qt+=_+"   "+ae+" "+i+" "+s+`,
`}Qt+=_+`  ]
`,Qt+=_+` }
`}if(Qt+=_+` coordIndex [
`,ne.wireframe&&this.faceArray)for(let l=0;l<this.faceidx;l+=3)ae=(Mt=this.faceArray)===null||Mt===void 0?void 0:Mt[l],i=(Pt=this.faceArray)===null||Pt===void 0?void 0:Pt[l+1],s=(Ot=this.faceArray)===null||Ot===void 0?void 0:Ot[l+2],Qt+=_+"  "+ae+", "+i+", "+s+`, -1,
`;else for(let l=0;l<this.vertices-1;l+=2)Qt+=_+"  "+l+", "+(l+1)+`, -1,
`;Qt+=_+` ]
`,Qt+=_+`}
`}else{let ae,i,s;Qt+=_+`geometry IndexedFaceSet {
`+_+` colorPerVertex TRUE
`+_+` normalPerVertex TRUE
`+_+` solid FALSE
`,Qt+=_+` coord Coordinate {
`+_+`  point [
`;for(let l=0;l<this.vertices;++l){let h=3*l;ae=(gr=this.vertexArray)===null||gr===void 0?void 0:gr[h],i=(Zt=this.vertexArray)===null||Zt===void 0?void 0:Zt[h+1],s=(Ar=this.vertexArray)===null||Ar===void 0?void 0:Ar[h+2],Qt+=_+"   "+ae+" "+i+" "+s+`,
`}Qt+=_+`  ]
`,Qt+=_+` }
`,Qt+=_+` normal Normal {
`+_+`  vector [
`;for(let l=0;l<this.vertices;++l){let h=3*l;ae=(Cr=this.normalArray)===null||Cr===void 0?void 0:Cr[h],i=(Ur=this.normalArray)===null||Ur===void 0?void 0:Ur[h+1],s=(_r=this.normalArray)===null||_r===void 0?void 0:_r[h+2],Qt+=_+"   "+ae+" "+i+" "+s+`,
`}if(Qt+=_+`  ]
`,Qt+=_+` }
`,this.colorArray){Qt+=_+` color Color {
`+_+`  color [
`;for(let l=0;l<this.vertices;++l){let h=3*l;ae=this.colorArray[h],i=this.colorArray[h+1],s=this.colorArray[h+2],Qt+=_+"   "+ae+" "+i+" "+s+`,
`}Qt+=_+`  ]
`,Qt+=_+` }
`}Qt+=_+` coordIndex [
`;for(let l=0;l<this.faceidx;l+=3)ae=(Or=this.faceArray)===null||Or===void 0?void 0:Or[l],i=(wr=this.faceArray)===null||wr===void 0?void 0:wr[l+1],s=(Mi=this.faceArray)===null||Mi===void 0?void 0:Mi[l+2],Qt+=_+"  "+ae+", "+i+", "+s+`, -1,
`;Qt+=_+` ]
`,Qt+=_+`}
`}return Qt+=ri+"}"}truncateArrayBuffers(_=!0,ne=!1){var xe=this.vertexArray,Ve=this.colorArray,Oe=this.normalArray,yt=this.faceArray,lt=this.lineArray,mt=this.radiusArray;this.vertexArray=xe?.subarray(0,3*this.vertices)||null,this.colorArray=Ve?.subarray(0,3*this.vertices)||null,_?(this.normalArray=Oe?.subarray(0,3*this.vertices)||null,this.faceArray=yt?.subarray(0,this.faceidx)||null,this.lineidx>0?this.lineArray=lt?.subarray(0,this.lineidx)||null:this.lineArray=new Uint16Array(0)):(this.normalArray=new Float32Array(0),this.faceArray=new Uint16Array(0),this.lineArray=new Uint16Array(0)),mt&&(this.radiusArray=mt.subarray(0,this.vertices)),ne&&(this.normalArray&&(this.normalArray=new Float32Array(this.normalArray)),this.faceArray&&(this.faceArray=new Uint16Array(this.faceArray)),this.lineArray&&(this.lineArray=new Uint16Array(this.lineArray)),this.vertexArray&&(this.vertexArray=new Float32Array(this.vertexArray)),this.colorArray&&(this.colorArray=new Float32Array(this.colorArray)),this.radiusArray&&(this.radiusArray=new Float32Array(this.radiusArray))),this.__inittedArrays=!0}}class ce extends N{constructor(_=!1,ne=!1,xe=!1){super(),this.name="",this.hasTangents=!1,this.dynamic=!0,this.verticesNeedUpdate=!1,this.elementsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.buffersNeedUpdate=!1,this.imposter=!1,this.instanced=!1,this.geometryGroups=[],this.groups=0,this.id=ge++,this.mesh=_,this.radii=ne,this.offset=xe}updateGeoGroup(_=0){var ne,xe=this.groups>0?this.geometryGroups[this.groups-1]:null;return(!xe||xe.vertices+_>(((ne=xe?.vertexArray)===null||ne===void 0?void 0:ne.length)||0)/3)&&(xe=this.addGeoGroup()),xe}vrml(_,ne){for(var xe="",Ve=this.geometryGroups.length,Oe=0;Oe<Ve;Oe++)xe+=this.geometryGroups[Oe].vrml(_,ne)+`,
`;return xe}addGeoGroup(){var _=new Ae(this.geometryGroups.length);return this.geometryGroups.push(_),this.groups=this.geometryGroups.length,_.vertexArray=new Float32Array(196605),_.colorArray=new Float32Array(196605),this.mesh&&(_.normalArray=new Float32Array(196605),_.faceArray=new Uint16Array(393210),_.lineArray=new Uint16Array(393210)),this.radii&&(_.radiusArray=new Float32Array(ee)),_.useOffset=this.offset,_}setUpNormals(..._){for(var ne=0;ne<this.groups;ne++)this.geometryGroups[ne].setNormals(..._)}setColors(..._){for(var ne=this.geometryGroups.length,xe=0;xe<ne;xe++)this.geometryGroups[xe].setColors(..._)}setColor(..._){let ne=this.geometryGroups.length;for(var xe=0;xe<ne;xe++)this.geometryGroups[xe].setColor(..._)}setUpWireframe(..._){let ne=this.geometryGroups.length;for(var xe=0;xe<ne;xe++)this.geometryGroups[xe].setLineIndices(..._)}initTypedArrays(){for(var _=0;_<this.groups;_++){var ne=this.geometryGroups[_];ne.__inittedArrays!==!0&&ne.truncateArrayBuffers(this.mesh,!1)}}dispose(){this.dispatchEvent({type:"dispose"})}get vertices(){for(var _=0,ne=0;ne<this.groups;ne++)_+=this.geometryGroups[ne].vertices;return _}}let ge=0,me=0;class Me{constructor(){this.id=me++,this.name="",this.children=[],this.position=new m.Vector3,this.rotation=new m.Vector3,this.matrix=new m.Matrix4,this.matrixWorld=new m.Matrix4,this.quaternion=new m.Quaternion,this.eulerOrder="XYZ",this.up=new m.Vector3(0,1,0),this.scale=new m.Vector3(1,1,1),this.matrixAutoUpdate=!0,this.matrixWorldNeedsUpdate=!0,this.rotationAutoUpdate=!0,this.useQuaternion=!1,this.visible=!0}lookAt(_){this.matrix.lookAt(_,this.position,this.up),this.rotationAutoUpdate&&(this.useQuaternion===!0?console.error("Unimplemented math operation."):this.rotation instanceof m.Vector3&&this.rotation.setEulerFromRotationMatrix(this.matrix,this.eulerOrder))}add(_){if(_!==this){_.parent=this,this.children.push(_);for(var ne=this;ne.parent!==void 0;)ne=ne.parent;ne!==void 0&&ne instanceof ue&&ne.__addObject(_)}else console.error("Can't add $3Dmol.Object3D to itself")}remove(_){var ne=this.children.indexOf(_);if(ne!==-1){_.parent=void 0,this.children.splice(ne,1);for(var xe=this;xe.parent!==void 0;)xe=xe.parent;xe!==void 0&&xe instanceof ue&&xe.__removeObject(_)}}vrml(_){_||(_=" ");var ne=2*Math.atan2(this.quaternion.lengthxyz(),this.quaternion.w),xe=0,Ve=0,Oe=0;if(ne!=0){let mt=Math.sin(ne/2);xe=this.quaternion.x/mt,Ve=this.quaternion.y/mt,Oe=this.quaternion.z/mt}var yt=_+`Transform {
`+_+" center "+this.position.x+" "+this.position.y+" "+this.position.z+`
`+_+" rotation "+xe+" "+Ve+" "+Oe+" "+ne+`
`+_+` children [
`;this.geometry&&(yt+=this.geometry.vrml(_,this.material));for(var lt=0;lt<this.children.length;lt++)yt+=this.children[lt].vrml(_+" ")+`,
`;return yt+=` ]
`,yt+="}"}updateMatrix(){this.matrix.setPosition(this.position),this.useQuaternion===!1&&this.rotation instanceof m.Vector3?this.matrix.setRotationFromEuler(this.rotation,this.eulerOrder):this.matrix.setRotationFromQuaternion(this.quaternion),this.scale.x===1&&this.scale.y===1&&this.scale.z===1||this.matrix.scale(this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(_){this.matrixAutoUpdate===!0&&this.updateMatrix(),this.matrixWorldNeedsUpdate!==!0&&_!==!0||(this.parent===void 0?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1;for(var ne=0;ne<this.children.length;ne++)this.children[ne].updateMatrixWorld(!0)}clone(_){_===void 0&&(_=new Me),_.name=this.name,_.up.copy(this.up),_.position.copy(this.position),_.rotation instanceof m.Vector3&&this.rotation instanceof m.Vector3?_.rotation.copy(this.rotation):_.rotation=this.rotation,_.eulerOrder=this.eulerOrder,_.scale.copy(this.scale),_.rotationAutoUpdate=this.rotationAutoUpdate,_.matrix.copy(this.matrix),_.matrixWorld.copy(this.matrixWorld),_.quaternion.copy(this.quaternion),_.matrixAutoUpdate=this.matrixAutoUpdate,_.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate,_.useQuaternion=this.useQuaternion,_.visible=this.visible;for(var ne=0;ne<this.children.length;ne++){var xe=this.children[ne];_.add(xe.clone())}return _}setVisible(_){this.visible=_;for(var ne=0;ne<this.children.length;ne++)this.children[ne].setVisible(_)}}class ue extends Me{constructor(){super(...arguments),this.fog=null,this.overrideMaterial=null,this.matrixAutoUpdate=!1,this.__objects=[],this.__lights=[],this.__objectsAdded=[],this.__objectsRemoved=[]}__addObject(_){if(_ instanceof I)this.__lights.indexOf(_)===-1&&this.__lights.push(_),_.target&&_.target.parent===void 0&&this.add(_.target);else if(this.__objects.indexOf(_)===-1){this.__objects.push(_),this.__objectsAdded.push(_);var ne=this.__objectsRemoved.indexOf(_);ne!==-1&&this.__objectsRemoved.splice(ne,1)}for(var xe=0;xe<_.children.length;xe++)this.__addObject(_.children[xe])}__removeObject(_){var ne;_ instanceof I?(ne=this.__lights.indexOf(_))!==-1&&this.__lights.splice(ne,1):(ne=this.__objects.indexOf(_))!==-1&&(this.__objects.splice(ne,1),this.__objectsRemoved.push(_),this.__objectsAdded.indexOf(_)!==-1&&this.__objectsAdded.splice(ne,1));for(var xe=0;xe<_.children.length;xe++)this.__removeObject(_.children[xe])}}class I extends Me{constructor(_,ne=1){super(),this.position=new m.Vector3(0,1,0),this.target=new Me,this.castShadow=!1,this.onlyShadow=!1,this.color=new V.Color(_),this.intensity=ne}}const he=new m.Matrix4;class se{static unprojectVector(_,ne){return ne.projectionMatrixInverse.getInverse(ne.projectionMatrix),he.multiplyMatrices(ne.matrixWorld,ne.projectionMatrixInverse),_.applyProjection(he)}static projectVector(_,ne){return ne.matrixWorldInverse.getInverse(ne.matrixWorld),he.multiplyMatrices(ne.projectionMatrix,ne.matrixWorldInverse),_.applyProjection(he)}projectVector(_,ne){return se.projectVector(_,ne)}unprojectVector(_,ne){return se.unprojectVector(_,ne)}}var K=a(99);const Re=(Bt,_)=>Bt.distance-_.distance,fe=new m.Matrix4;class De{constructor(_,ne,xe,Ve){this.precision=1e-4,this.linePrecision=.2,this.ray=new m.Ray(_,ne),this.ray.direction.lengthSq()>0&&this.ray.direction.normalize(),this.near=Ve||0,this.far=xe||1/0}set(_,ne){this.ray.set(_,ne)}setFromCamera(_,ne){ne.ortho?(this.ray.origin.set(_.x,_.y,(ne.near+ne.far)/(ne.near-ne.far)).unproject(ne),this.ray.direction.set(0,0,-1).transformDirection(ne.matrixWorld)):(this.ray.origin.setFromMatrixPosition(ne.matrixWorld),this.ray.direction.set(_.x,_.y,_.z),ne.projectionMatrixInverse.getInverse(ne.projectionMatrix),fe.multiplyMatrices(ne.matrixWorld,ne.projectionMatrixInverse),this.ray.direction.applyProjection(fe),this.ray.direction.sub(this.ray.origin).normalize())}intersectObjects(_,ne){for(var xe=[],Ve=0,Oe=ne.length;Ve<Oe;Ve++)Ft(_,ne[Ve],this,xe);return xe.sort(Re),xe}}const We=Bt=>Math.min(Math.max(Bt,-1),1);var oe=new K.Sphere,Ee=new K.Cylinder,He=new K.Triangle,Ue=new m.Vector3,Ie=new m.Vector3,rt=new m.Vector3,st=new m.Vector3,at=new m.Vector3;function Ft(Bt,_,ne,xe){if(at.getPositionFromMatrix(Bt.matrixWorld),_.intersectionShape===void 0||_.hidden)return xe;var Ve,Oe,yt,lt,mt,Mt,Pt,Ot,gr,Zt,Ar,Cr,Ur,_r,Or=_.intersectionShape,wr=ne.linePrecision,Mi=(wr*=Bt.matrixWorld.getMaxScaleOnAxis())*wr;if(_.boundingSphere!==void 0&&_.boundingSphere instanceof K.Sphere&&(oe.copy(_.boundingSphere),oe.applyMatrix4(Bt.matrixWorld),!ne.ray.isIntersectionSphere(oe)))return xe;for(Ve=0,Oe=Or.triangle.length;Ve<Oe;Ve++)if(Or.triangle[Ve]instanceof K.Triangle){if(He.copy(Or.triangle[Ve]),He.applyMatrix4(Bt.matrixWorld),yt=He.getNormal(),(lt=ne.ray.direction.dot(yt))>=0||(Ue.subVectors(He.a,ne.ray.origin),(Pt=yt.dot(Ue)/lt)<0))continue;Ie.copy(ne.ray.direction).multiplyScalar(Pt).add(ne.ray.origin),Ie.sub(He.a),rt.copy(He.b).sub(He.a),st.copy(He.c).sub(He.a);var Qt=rt.dot(st),ri=rt.lengthSq(),ae=st.lengthSq();if((Cr=(ri*Ie.dot(st)-Qt*Ie.dot(rt))/(ri*ae-Qt*Qt))<0||Cr>1||(Ar=(Ie.dot(rt)-Cr*Qt)/ri)<0||Ar>1||Ar+Cr>1)continue;xe.push({clickable:_,distance:Pt})}for(Ve=0,Oe=Or.cylinder.length;Ve<Oe;Ve++)if(Or.cylinder[Ve]instanceof K.Cylinder){if(Ee.copy(Or.cylinder[Ve]),Ee.applyMatrix4(Bt.matrixWorld),Ue.subVectors(Ee.c1,ne.ray.origin),mt=Ue.dot(Ee.direction),Mt=Ue.dot(ne.ray.direction),(gr=1-(lt=We(ne.ray.direction.dot(Ee.direction)))*lt)==0)continue;Ur=(lt*Mt-mt)/gr,_r=(Mt-lt*mt)/gr,Ie.copy(Ee.direction).multiplyScalar(Ur).add(Ee.c1),rt.copy(ne.ray.direction).multiplyScalar(_r).add(ne.ray.origin),Ot=st.subVectors(Ie,rt).lengthSq();var i=Ee.radius*Ee.radius;if(Ot<=i){if((Ar=lt*(Cr=Pt=(Zt=(lt*mt-Mt)*(lt*mt-Mt)-gr*(Ue.lengthSq()-mt*mt-i))<=0?Math.sqrt(Ot):(Mt-lt*mt-Math.sqrt(Zt))/gr)-mt)<0||Ar*Ar>Ee.lengthSq()||Cr<0)continue;xe.push({clickable:_,distance:Pt})}}for(Ve=0,Oe=Or.line.length;Ve<Oe;Ve+=2){Ie.copy(Or.line[Ve]),Ie.applyMatrix4(Bt.matrixWorld),rt.copy(Or.line[Ve+1]),rt.applyMatrix4(Bt.matrixWorld),st.subVectors(rt,Ie);var s=st.lengthSq();st.normalize(),Ue.subVectors(Ie,ne.ray.origin);var l=Ue.dot(st);Mt=Ue.dot(ne.ray.direction),(gr=1-(lt=We(ne.ray.direction.dot(st)))*lt)!=0&&(Ur=(lt*Mt-l)/gr,_r=(Mt-lt*l)/gr,Ie.add(st.multiplyScalar(Ur)),rt.copy(ne.ray.direction).multiplyScalar(_r).add(ne.ray.origin),(Ot=st.subVectors(rt,Ie).lengthSq())<Mi&&Ur*Ur<s&&xe.push({clickable:_,distance:_r}))}for(Ve=0,Oe=Or.sphere.length;Ve<Oe;Ve++)if(Or.sphere[Ve]instanceof K.Sphere&&(oe.copy(Or.sphere[Ve]),oe.applyMatrix4(Bt.matrixWorld),ne.ray.isIntersectionSphere(oe))){Ie.subVectors(oe.center,ne.ray.origin);var h=Ie.dot(ne.ray.direction);if(Zt=h*h-(Ie.lengthSq()-oe.radius*oe.radius),h<0)return xe;Pt=Zt<=0?h:h-Math.sqrt(Zt),xe.push({clickable:_,distance:Pt})}return xe}class At{}class or extends N{constructor(_,ne){super(),this.id=ar++,this.name="",this.image=_,this.mapping=new At,this.wrapS=T,this.wrapT=T,this.anisotropy=1,ne?(this.format=J,this.type=z,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.magFilter=k,this.minFilter=k):(this.format=Q,this.type=C,this.offset=new m.Vector2(0,0),this.repeat=new m.Vector2(1,1),this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.magFilter=x,this.minFilter=F),this.needsUpdate=!1,this.onUpdate=null}clone(_=new or){return _.image=this.image,_.mapping=this.mapping,_.wrapS=this.wrapS,_.wrapT=this.wrapT,_.magFilter=this.magFilter,_.minFilter=this.minFilter,_.anisotropy=this.anisotropy,_.format=this.format,_.type=this.type,_.offset.copy(this.offset),_.repeat.copy(this.repeat),_.premultiplyAlpha=this.premultiplyAlpha,_.flipY=this.flipY,_.unpackAlignment=this.unpackAlignment,_}dispose(){this.dispatchEvent({type:"dispose"})}}let ar=0;class kr extends H{constructor(_){super(),this.color=new V.Color(16777215),this.ambient=new V.Color(1048575),this.emissive=new V.Color(0),this.imposter=!0,this.wrapAround=!1,this.wrapRGB=new m.Vector3(1,1,1),this.map=void 0,this.lightMap=null,this.specularMap=null,this.envMap=null,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.shading=v.SmoothShading,this.shaderID=null,this.vertexColors=c.NoColors,this.skinning=!1,this.setValues(_)}clone(_=new kr){return super.clone.call(this,_),_.color.copy(this.color),_.ambient.copy(this.ambient),_.emissive.copy(this.emissive),_.wrapAround=this.wrapAround,_.wrapRGB.copy(this.wrapRGB),_.map=this.map,_.lightMap=this.lightMap,_.specularMap=this.specularMap,_.envMap=this.envMap,_.combine=this.combine,_.reflectivity=this.reflectivity,_.refractionRatio=this.refractionRatio,_.fog=this.fog,_.shading=this.shading,_.shaderID=this.shaderID,_.vertexColors=this.vertexColors,_.skinning=this.skinning,_.morphTargets=this.morphTargets,_.morphNormals=this.morphNormals,_}}class Er extends H{constructor(_){super(),this.color=new V.Color(16777215),this.ambient=new V.Color(1048575),this.emissive=new V.Color(0),this.wrapAround=!1,this.wrapRGB=new m.Vector3(1,1,1),this.map=void 0,this.lightMap=null,this.specularMap=null,this.envMap=null,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.shading=v.SmoothShading,this.shaderID="instanced",this.vertexColors=c.NoColors,this.skinning=!1,this.sphere=null,this.setValues(_)}clone(_=new Er){return super.clone.call(this,_),_.color.copy(this.color),_.ambient.copy(this.ambient),_.emissive.copy(this.emissive),_.wrapAround=this.wrapAround,_.wrapRGB.copy(this.wrapRGB),_.map=this.map,_.lightMap=this.lightMap,_.specularMap=this.specularMap,_.envMap=this.envMap,_.combine=this.combine,_.reflectivity=this.reflectivity,_.refractionRatio=this.refractionRatio,_.fog=this.fog,_.shading=this.shading,_.shaderID=this.shaderID,_.vertexColors=this.vertexColors,_.skinning=this.skinning,_.morphTargets=this.morphTargets,_.morphNormals=this.morphNormals,_.sphere=this.sphere,_}}class pr extends H{constructor(_){super(),this.color=new V.Color(16777215),this.ambient=new V.Color(1048575),this.emissive=new V.Color(0),this.wrapAround=!1,this.wrapRGB=new m.Vector3(1,1,1),this.map=void 0,this.lightMap=null,this.specularMap=null,this.envMap=null,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.shading=v.SmoothShading,this.shaderID="lambert",this.vertexColors=c.NoColors,this.skinning=!1,this.setValues(_)}clone(_=new pr){return super.clone.call(this,_),_.color.copy(this.color),_.ambient.copy(this.ambient),_.emissive.copy(this.emissive),_.wrapAround=this.wrapAround,_.wrapRGB.copy(this.wrapRGB),_.map=this.map,_.lightMap=this.lightMap,_.specularMap=this.specularMap,_.envMap=this.envMap,_.combine=this.combine,_.reflectivity=this.reflectivity,_.refractionRatio=this.refractionRatio,_.fog=this.fog,_.shading=this.shading,_.shaderID=this.shaderID,_.vertexColors=this.vertexColors,_.skinning=this.skinning,_.morphTargets=this.morphTargets,_.morphNormals=this.morphNormals,_}}class vr extends pr{constructor(_){super(_),this.shaderID="lambertdouble",this.side=u,this.outline=!1}clone(_=new vr){return super.clone.call(this,_),_}}class xr extends H{constructor(_){super(),_=_||{},this.fog=!0,this.shaderID="outline",this.wireframe=!1,this.outlineColor=V.CC.color(_.color||new V.Color(0,0,0)),this.outlineWidth=_.width||.1,this.outlinePushback=_.pushback||1,this.outlineMaxPixels=_.maxpixels||0}clone(_=new xr){return super.clone.call(this,_),_.fog=this.fog,_.shaderID=this.shaderID,_.wireframe=this.wireframe,_.outlineColor=this.outlineColor,_.outlineWidth=this.outlineWidth,_.outlinePushback=this.outlinePushback,_.outlineMaxPixels=this.outlineMaxPixels,_}}class fi extends kr{constructor(_){super(_),this.shaderID="sphereimposter",this.setValues(_)}clone(_=new fi){return super.clone.call(this,_),_}}class Rr extends kr{constructor(_){super(_),_=_||{},this.shaderID="sphereimposteroutline",this.outlineColor=V.CC.color(_.color||new V.Color(0,0,0)),this.outlineWidth=_.width||.1,this.outlinePushback=_.pushback||1,this.outlineMaxPixels=_.maxpixels||0,this.setValues(_)}clone(_=new Rr){return super.clone.call(this,_),_.outlineColor=this.outlineColor,_.outlineWidth=this.outlineWidth,_.outlinePushback=this.outlinePushback,_.outlineMaxPixels=this.outlineMaxPixels,_}}class Ir extends H{constructor(_){super(),this.color=new V.Color(16777215),this.map=new or,this.useScreenCoordinates=!0,this.fog=!1,this.uvOffset=new m.Vector2(0,0),this.uvScale=new m.Vector2(1,1),this.depthTest=!this.useScreenCoordinates,this.sizeAttenuation=!this.useScreenCoordinates,this.screenOffset=this.screenOffset,this.scaleByViewPort=!this.sizeAttenuation,this.alignment=b.center.clone(),this.setValues(_),(_=_||{}).depthTest===void 0&&(this.depthTest=!this.useScreenCoordinates),_.sizeAttenuation===void 0&&(this.sizeAttenuation=!this.useScreenCoordinates),_.scaleByViewPort===void 0&&(this.scaleByViewPort=!this.sizeAttenuation)}clone(_=new Ir){return super.clone.call(this,_),_.color.copy(this.color),_.map=this.map,_.useScreenCoordinates=this.useScreenCoordinates,_.screenOffset=this.screenOffset,_.sizeAttenuation=this.sizeAttenuation,_.scaleByViewport=this.scaleByViewPort,_.alignment.copy(this.alignment),_.uvOffset.copy(this.uvOffset),_}}class Di extends kr{constructor(_){super(_),this.shaderID="stickimposter",this.setValues(_)}clone(_=new Di){return super.clone.call(this,_),_}}class wi extends kr{constructor(_={}){super(_),this.shaderID="stickimposteroutline",this.outlineColor=new V.Color(0,0,0),this.outlineWidth=.1,this.outlinePushback=1,this.outlineMaxPixels=0,_.color&&(this.outlineColor=V.CC.color(_.color)),_.width&&(this.outlineWidth=_.width),_.pushback&&(this.outlinePushback=_.pushback),_.maxpixels&&(this.outlineMaxPixels=_.maxpixels),this.setValues(_)}clone(_=new wi){return super.clone.call(this,_),_.outlineColor=this.outlineColor,_.outlineWidth=this.outlineWidth,_.outlinePushback=this.outlinePushback,_.outlineMaxPixels=this.outlineMaxPixels,_}}class Hi extends H{constructor(_){super(),this.transparent=!1,this.volumetric=!0,this.color=new V.Color(16777215),this.transferfn=null,this.map=void 0,this.extent=[],this.maxdepth=100,this.unit=0,this.texmatrix=null,this.transfermin=-1,this.transfermax=1,this.subsamples=5,this.shaderID="volumetric",this.side=d,this.setValues(_)}clone(_=new Hi){return super.clone.call(this,_),_.transparent=this.transparent,_.volumetric=this.volumetric,_.color=this.color,_.transferfn=this.transferfn,_.map=this.map,_.extent=this.extent,_.maxdepth=this.maxdepth,_.unit=this.unit,_.texmatrix=this.texmatrix,_.transfermin=this.transfermin,_.transfermax=this.transfermax,_.subsamples=this.subsamples,_.shaderID=this.shaderID,_.side=this.side,_}}var pe;(function(Bt){Bt[Bt.LineStrip=0]="LineStrip",Bt[Bt.LinePieces=1]="LinePieces"})(pe||(pe={}));class Se extends Me{constructor(_,ne=new O({color:16777215*Math.random()}),xe=pe.LineStrip){super(),this.geometry=_,this.material=ne,this.type=xe}clone(_=new Se(this.geometry,this.material,this.type)){return super.clone.call(this,_),_}}class Le extends Me{constructor(_,ne){super(),this.geometry=_,this.material=ne}clone(_){return _===void 0&&(_=new Le(this.geometry,this.material)),super.clone.call(this,_),_}}class dt extends Me{constructor(_=new Ir){super(),this.material=_,this.rotation3d=this.rotation,this.rotation=0}updateMatrix(){this.matrix.setPosition(this.position),this.rotation3d.set(0,0,this.rotation),this.matrix.setRotationFromEuler(this.rotation3d),this.scale.x===1&&this.scale.y===1||this.matrix.scale(this.scale),this.matrixWorldNeedsUpdate=!0}clone(_=new dt(this.material)){return Me.prototype.clone.call(this,_),_}}const nt={opacity:{type:"f",value:1},fogColor:{type:"c",value:new V.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3}},zt={vertexShader:`uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;

attribute vec3 position;
attribute vec3 color;

varying vec3 vColor;
varying vec4 mvPosition;

void main() {

    vColor = color;
    mvPosition = modelViewMatrix * vec4( position, 1.0 );
    gl_Position = projectionMatrix * mvPosition;

}`.replace("#define GLSLIFY 1",""),fragmentShader:`uniform mat4 viewMatrix;
uniform float opacity;
uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
varying vec3 vColor;
varying vec4 mvPosition;

//DEFINEFRAGCOLOR
void main() {
    gl_FragColor = vec4( vColor, opacity );
    if(fogNear != fogFar) {
        float depth = -mvPosition.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }
}`.replace("#define GLSLIFY 1",""),uniforms:nt},ht={opacity:{type:"f",value:1},fogColor:{type:"c",value:new V.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}},Lt={fragmentShader:`uniform mat4 viewMatrix;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
#ifdef SHADED
uniform highp sampler2D shading;
#endif
varying vec3 vLightFront;
varying vec3 vColor;
//DEFINEFRAGCOLOR

void main() {

    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );

    #ifndef WIREFRAME
    gl_FragColor.xyz *= vLightFront;
    #endif

#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    vColor *= shadowFactor;
#endif
    gl_FragColor = gl_FragColor * vec4( vColor, opacity );
    float depth = gl_FragCoord.z / gl_FragCoord.w;

    float fogFactor = smoothstep( fogNear, fogFar, depth );

    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );

}


`.replace("#define GLSLIFY 1",""),vertexShader:`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 offset;
attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;
attribute float radius;

varying vec3 vColor;
varying vec3 vLightFront;

void main() {

    vColor = color;

    vec3 objectNormal = normal;
    vec3 transformedNormal = normalMatrix * objectNormal;
    vec4 mvPosition = modelViewMatrix * vec4( position * radius + offset, 1.0 );

    vLightFront = vec3( 0.0 );

    transformedNormal = normalize( transformedNormal );

    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vec3 dirVector = normalize( lDirection.xyz );
    float dotProduct = dot( transformedNormal, dirVector );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );

    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;

    gl_Position = projectionMatrix * mvPosition;
}

`.replace("#define GLSLIFY 1",""),uniforms:ht},Ut={opacity:{type:"f",value:1},fogColor:{type:"c",value:new V.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}},It={fragmentShader:`uniform mat4 viewMatrix;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
#ifdef SHADED
uniform highp sampler2D shading;
#endif
varying vec3 vLightFront;
varying vec3 vColor;
varying vec4 mvPosition;


//DEFINEFRAGCOLOR

void main() {

    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );

    #ifndef WIREFRAME
    gl_FragColor.xyz *= vLightFront;
    #endif
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    vColor *= shadowFactor;
#endif
    gl_FragColor = gl_FragColor * vec4( vColor, opacity );

    if(fogNear != fogFar) {
        float depth = -mvPosition.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }

}`.replace("#define GLSLIFY 1",""),vertexShader:`
uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec3 vColor;
varying vec3 vLightFront;
varying vec4 mvPosition;

void main() {

    vColor = color;

    vec3 objectNormal = normal;
    vec3 transformedNormal = normalMatrix * objectNormal;
    mvPosition = modelViewMatrix * vec4( position, 1.0 );

    vLightFront = vec3( 0.0 );

    transformedNormal = normalize( transformedNormal );

    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vec3 dirVector = normalize( lDirection.xyz );
    float dotProduct = dot( transformedNormal, dirVector );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );

    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;

    gl_Position = projectionMatrix * mvPosition;
}`.replace("#define GLSLIFY 1",""),uniforms:Ut},mr={opacity:{type:"f",value:1},fogColor:{type:"c",value:new V.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}},li={fragmentShader:`
#ifdef SHADED
uniform highp sampler2D shading;
#endif

uniform mat4 viewMatrix;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;

varying vec3 vLightFront;
varying vec3 vLightBack;

varying vec3 vColor;
varying vec4 mvPosition;

//DEFINEFRAGCOLOR

void main() {

    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );

    #ifndef WIREFRAME
    if ( gl_FrontFacing )
       gl_FragColor.xyz *= vLightFront;
    else
       gl_FragColor.xyz *= vLightBack;
    #endif

    vec3 color = vColor;
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    color *= shadowFactor;
#endif
    gl_FragColor = gl_FragColor * vec4( color, opacity );

    if(fogNear != fogFar) {
        float depth = -mvPosition.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }

}


`.replace("#define GLSLIFY 1",""),vertexShader:`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec3 vColor;
varying vec3 vLightFront;
varying vec3 vLightBack;
varying vec4 mvPosition;

void main() {

    vColor = color;

    vec3 objectNormal = normal;
    vec3 transformedNormal = normalMatrix * objectNormal;
    mvPosition = modelViewMatrix * vec4( position, 1.0 );

    vLightFront = vec3( 0.0 );
    vLightBack = vec3( 0.0 );

    transformedNormal = normalize( transformedNormal );

    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vec3 dirVector = normalize( lDirection.xyz );
    float dotProduct = dot( transformedNormal, dirVector );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );
    vec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );

    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;
    vLightBack += directionalLightColor[ 0 ] * directionalLightWeightingBack;

    gl_Position = projectionMatrix * mvPosition;
}

`.replace("#define GLSLIFY 1",""),uniforms:mr},Ai={opacity:{type:"f",value:1},outlineColor:{type:"c",value:new V.Color(0,0,0)},fogColor:{type:"c",value:new V.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},outlineWidth:{type:"f",value:.1},outlinePushback:{type:"f",value:1},outlineMaxPixels:{type:"f",value:0}},ui={fragmentShader:`

uniform float opacity;
uniform vec3 outlineColor;
uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;

varying vec4 mvPosition;
//DEFINEFRAGCOLOR

void main() {
    gl_FragColor = vec4( outlineColor, 1 );

    if(fogNear != fogFar) {
        float depth = -mvPosition.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }
}


`.replace("#define GLSLIFY 1",""),vertexShader:`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform float outlineWidth;
uniform float outlinePushback;
uniform float vWidth;
uniform float vHeight;
uniform float outlineMaxPixels;

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec4 mvPosition;

void main() {

    vec4 norm = modelViewMatrix*vec4(normalize(normal),0.0);
    mvPosition = modelViewMatrix * vec4( position, 1.0 );
    mvPosition.xy += norm.xy*outlineWidth;
    vec4 outpos = projectionMatrix * mvPosition;

    if(outlineMaxPixels > 0.0) {
        vec4 unadjusted = projectionMatrix*modelViewMatrix * vec4( position, 1.0 );
        float w = outpos.w;
        //normalize homogeneous coords
        unadjusted /= unadjusted.w;
        outpos /= outpos.w;
        vec2 diff = outpos.xy-unadjusted.xy;
        //put into pixels
        diff.x *= vWidth;
        diff.y *= vHeight;
        if ( length(diff) > outlineMaxPixels) {
            vec2 ndiff = normalize(diff)*outlineMaxPixels;
            ndiff.x /= vWidth;
            ndiff.y /= vHeight;
            outpos.xy = unadjusted.xy;
            outpos.xy += ndiff;
        }
        outpos *= w; //if I don't do this things blow up
    }
    gl_Position = outpos;
    mvPosition.z -= outlinePushback; //go backwards in model space
    vec4 pushpos = projectionMatrix*mvPosition; //project to get z in projection space, I'm probably missing some simple math to do the same thing..
    gl_Position.z = gl_Position.w*pushpos.z/pushpos.w;
}

`.replace("#define GLSLIFY 1",""),uniforms:Ai},gi={fragmentShader:`uniform sampler2D colormap;
varying highp vec2 vTexCoords;
uniform vec2 dimensions;
//DEFINEFRAGCOLOR
void main (void) {
   gl_FragColor = texture2D(colormap, vTexCoords);

   //gl_FragColor.g = gl_FragColor.b =  gl_FragColor.r; //debug shading 
}
        `.replace("#define GLSLIFY 1",""),vertexShader:`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `.replace("#define GLSLIFY 1",""),uniforms:{}},jr={fragmentShader:`
        
precision highp float;
precision highp int;
precision highp sampler2D;

uniform sampler2D tColor;
varying highp vec2 vTexCoords;

// adapted from https://github.com/kosua20/Rendu
// MIT License Copyright (c) 2017 Simon Rodriguez
// by way of molstar (https://github.com/molstar/molstar/blob/master/src/mol-gl/shader/fxaa.frag.ts)

#define QUALITY(q) ((q) < 5 ? 1.0 : ((q) > 5 ? ((q) < 10 ? 2.0 : ((q) < 11 ? 4.0 : 8.0)) : 1.5))

float rgb2luma(vec3 rgb){
    return sqrt(dot(rgb, vec3(0.299, 0.587, 0.114)));
}

float sampleLuma(vec2 uv) {
    return rgb2luma(texture2D(tColor, uv).rgb);
}

float sampleLuma(vec2 uv, float uOffset, float vOffset) {
    uv += vec2(uOffset, vOffset);
    return sampleLuma(uv);
}

//DEFINEFRAGCOLOR
void main(void) {
    ivec2 dim = textureSize(tColor,0);
    vec2 dimensions = vec2(float(dim.x),float(dim.y));
    vec2 inverseScreenSize = vec2(1.0 / dimensions.x, 1.0 / dimensions.y);
    vec2 coords = vTexCoords;

    vec4 colorCenter = texture2D(tColor, coords);
    float dEdgeThresholdMin = 0.0312;
    float dEdgeThresholdMax = 0.125;
    int dIterations = 12;
    float dSubpixelQuality = 0.3;

    // Luma at the current fragment
    float lumaCenter = rgb2luma(colorCenter.rgb);

    // Luma at the four direct neighbours of the current fragment.
    float lumaDown = sampleLuma(coords, 0.0, -inverseScreenSize.y);
    float lumaUp = sampleLuma(coords, 0.0, inverseScreenSize.y);
    float lumaLeft = sampleLuma(coords, -inverseScreenSize.x, 0.0);
    float lumaRight = sampleLuma(coords, inverseScreenSize.x, 0.0);

    // Find the maximum and minimum luma around the current fragment.
    float lumaMin = min(lumaCenter, min(min(lumaDown, lumaUp), min(lumaLeft, lumaRight)));
    float lumaMax = max(lumaCenter, max(max(lumaDown, lumaUp), max(lumaLeft, lumaRight)));

    // Compute the delta.
    float lumaRange = lumaMax - lumaMin;

    // If the luma variation is lower that a threshold (or if we are in a really dark area),
    // we are not on an edge, don't perform any AA.
    if (lumaRange < max(dEdgeThresholdMin, lumaMax * dEdgeThresholdMax)) {
        gl_FragColor = colorCenter;
        return;
    }

    // Query the 4 remaining corners lumas.
    float lumaDownLeft = sampleLuma(coords, -inverseScreenSize.x, -inverseScreenSize.y);
    float lumaUpRight = sampleLuma(coords, inverseScreenSize.x, inverseScreenSize.y);
    float lumaUpLeft = sampleLuma(coords, -inverseScreenSize.x, inverseScreenSize.y);
    float lumaDownRight = sampleLuma(coords, inverseScreenSize.x, -inverseScreenSize.y);

    // Combine the four edges lumas (using intermediary variables for future computations
    // with the same values).
    float lumaDownUp = lumaDown + lumaUp;
    float lumaLeftRight = lumaLeft + lumaRight;

    // Same for corners
    float lumaLeftCorners = lumaDownLeft + lumaUpLeft;
    float lumaDownCorners = lumaDownLeft + lumaDownRight;
    float lumaRightCorners = lumaDownRight + lumaUpRight;
    float lumaUpCorners = lumaUpRight + lumaUpLeft;

    // Compute an estimation of the gradient along the horizontal and vertical axis.
    float edgeHorizontal = abs(-2.0 * lumaLeft + lumaLeftCorners) + abs(-2.0 * lumaCenter + lumaDownUp) * 2.0 + abs(-2.0 * lumaRight + lumaRightCorners);
    float edgeVertical = abs(-2.0 * lumaUp + lumaUpCorners) + abs(-2.0 * lumaCenter + lumaLeftRight) * 2.0 + abs(-2.0 * lumaDown + lumaDownCorners);

    // Is the local edge horizontal or vertical ?
    bool isHorizontal = (edgeHorizontal >= edgeVertical);

    // Choose the step size (one pixel) accordingly.
    float stepLength = isHorizontal ? inverseScreenSize.y : inverseScreenSize.x;

    // Select the two neighboring texels lumas in the opposite direction to the local edge.
    float luma1 = isHorizontal ? lumaDown : lumaLeft;
    float luma2 = isHorizontal ? lumaUp : lumaRight;
    // Compute gradients in this direction.
    float gradient1 = luma1 - lumaCenter;
    float gradient2 = luma2 - lumaCenter;

    // Which direction is the steepest ?
    bool is1Steepest = abs(gradient1) >= abs(gradient2);

    // Gradient in the corresponding direction, normalized.
    float gradientScaled = 0.25 * max(abs(gradient1), abs(gradient2));

    // Average luma in the correct direction.
    float lumaLocalAverage = 0.0;
    if(is1Steepest){
        // Switch the direction
        stepLength = -stepLength;
        lumaLocalAverage = 0.5 * (luma1 + lumaCenter);
    } else {
        lumaLocalAverage = 0.5 * (luma2 + lumaCenter);
    }

    // Shift UV in the correct direction by half a pixel.
    vec2 currentUv = coords;
    if(isHorizontal){
        currentUv.y += stepLength * 0.5;
    } else {
        currentUv.x += stepLength * 0.5;
    }

    // Compute offset (for each iteration step) in the right direction.
    vec2 offset = isHorizontal ? vec2(inverseScreenSize.x, 0.0) : vec2(0.0, inverseScreenSize.y);
    // Compute UVs to explore on each side of the edge, orthogonally.
    // The QUALITY allows us to step faster.
    vec2 uv1 = currentUv - offset * QUALITY(0);
    vec2 uv2 = currentUv + offset * QUALITY(0);

    // Read the lumas at both current extremities of the exploration segment,
    // and compute the delta wrt to the local average luma.
    float lumaEnd1 = sampleLuma(uv1);
    float lumaEnd2 = sampleLuma(uv2);
    lumaEnd1 -= lumaLocalAverage;
    lumaEnd2 -= lumaLocalAverage;

    // If the luma deltas at the current extremities is larger than the local gradient,
    // we have reached the side of the edge.
    bool reached1 = abs(lumaEnd1) >= gradientScaled;
    bool reached2 = abs(lumaEnd2) >= gradientScaled;
    bool reachedBoth = reached1 && reached2;

    // If the side is not reached, we continue to explore in this direction.
    if(!reached1){
        uv1 -= offset * QUALITY(1);
    }
    if(!reached2){
        uv2 += offset * QUALITY(1);
    }

    // If both sides have not been reached, continue to explore.
    if(!reachedBoth){
        for(int i = 2; i < dIterations; i++){
            // If needed, read luma in 1st direction, compute delta.
            if(!reached1){
                lumaEnd1 = sampleLuma(uv1);
                lumaEnd1 = lumaEnd1 - lumaLocalAverage;
            }
            // If needed, read luma in opposite direction, compute delta.
            if(!reached2){
                lumaEnd2 = sampleLuma(uv2);
                lumaEnd2 = lumaEnd2 - lumaLocalAverage;
            }
            // If the luma deltas at the current extremities is larger than the local gradient,
            // we have reached the side of the edge.
            reached1 = abs(lumaEnd1) >= gradientScaled;
            reached2 = abs(lumaEnd2) >= gradientScaled;
            reachedBoth = reached1 && reached2;

            // If the side is not reached, we continue to explore in this direction,
            // with a variable quality.
            if(!reached1){
                uv1 -= offset * QUALITY(i);
            }
            if(!reached2){
                uv2 += offset * QUALITY(i);
            }

            // If both sides have been reached, stop the exploration.
            if(reachedBoth){
                break;
            }
        }
    }

    // Compute the distances to each side edge of the edge (!).
    float distance1 = isHorizontal ? (coords.x - uv1.x) : (coords.y - uv1.y);
    float distance2 = isHorizontal ? (uv2.x - coords.x) : (uv2.y - coords.y);

    // In which direction is the side of the edge closer ?
    bool isDirection1 = distance1 < distance2;
    float distanceFinal = min(distance1, distance2);

    // Thickness of the edge.
    float edgeThickness = (distance1 + distance2);

    // Is the luma at center smaller than the local average ?
    bool isLumaCenterSmaller = lumaCenter < lumaLocalAverage;

    // If the luma at center is smaller than at its neighbour,
    // the delta luma at each end should be positive (same variation).
    bool correctVariation1 = (lumaEnd1 < 0.0) != isLumaCenterSmaller;
    bool correctVariation2 = (lumaEnd2 < 0.0) != isLumaCenterSmaller;

    // Only keep the result in the direction of the closer side of the edge.
    bool correctVariation = isDirection1 ? correctVariation1 : correctVariation2;

    // UV offset: read in the direction of the closest side of the edge.
    float pixelOffset = - distanceFinal / edgeThickness + 0.5;

    // If the luma variation is incorrect, do not offset.
    float finalOffset = correctVariation ? pixelOffset : 0.0;

    // Sub-pixel shifting
    // Full weighted average of the luma over the 3x3 neighborhood.
    float lumaAverage = (1.0 / 12.0) * (2.0 * (lumaDownUp + lumaLeftRight) + lumaLeftCorners + lumaRightCorners);
    // Ratio of the delta between the global average and the center luma,
    // over the luma range in the 3x3 neighborhood.
    float subPixelOffset1 = clamp(abs(lumaAverage - lumaCenter) / lumaRange, 0.0, 1.0);
    float subPixelOffset2 = (-2.0 * subPixelOffset1 + 3.0) * subPixelOffset1 * subPixelOffset1;
    // Compute a sub-pixel offset based on this delta.
    float subPixelOffsetFinal = subPixelOffset2 * subPixelOffset2 * float(dSubpixelQuality);

    // Pick the biggest of the two offsets.
    finalOffset = max(finalOffset, subPixelOffsetFinal);

    // Compute the final UV coordinates.
    vec2 finalUv = coords;
    if(isHorizontal){
        finalUv.y += finalOffset * stepLength;
    } else {
        finalUv.x += finalOffset * stepLength;
    }

    // Read the color at the new UV coordinates, and use it.
    gl_FragColor = texture2D(tColor, finalUv);
}        

/* old fxaa implementation
uniform highp sampler2D colormap;
varying highp vec2 vTexCoords;


// Basic FXAA implementation based on the code on geeks3d.com 
#define FXAA_REDUCE_MIN (1.0/ 128.0)
#define FXAA_REDUCE_MUL (1.0 / 8.0)
#define FXAA_SPAN_MAX 8.0


vec4 applyFXAA(vec2 fragCoord, highp sampler2D tex)
{
    vec4 color;
    ivec2 dim = textureSize(tex,0);
    vec2 dimensions = vec2(float(dim.x),float(dim.y));
    vec2 inverseVP = vec2(1.0 / dimensions.x, 1.0 / dimensions.y);
    vec4 rgbNW = texture2D(tex, fragCoord + vec2(-1.0, -1.0) * inverseVP);
    vec4 rgbNE = texture2D(tex, fragCoord + vec2(1.0, -1.0) * inverseVP);
    vec4 rgbSW = texture2D(tex, fragCoord + vec2(-1.0, 1.0) * inverseVP);
    vec4 rgbSE = texture2D(tex, fragCoord + vec2(1.0, 1.0) * inverseVP);
    vec4 rgbM  = texture2D(tex, fragCoord );
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW.xyz, luma);
    float lumaNE = dot(rgbNE.xyz, luma);
    float lumaSW = dot(rgbSW.xyz, luma);
    float lumaSE = dot(rgbSE.xyz, luma);
    float lumaM  = dot(rgbM.xyz,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                        (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
            max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
            dir * rcpDirMin)) * inverseVP;

    vec4 rgbA = 0.5 * (
        texture2D(tex, fragCoord + dir * (1.0 / 3.0 - 0.5)) +
        texture2D(tex, fragCoord  + dir * (2.0 / 3.0 - 0.5)));
    vec4 rgbB = rgbA * 0.5 + 0.25 * (
        texture2D(tex, fragCoord  + dir * -0.5) +
        texture2D(tex, fragCoord  + dir * 0.5));

    float lumaB = dot(rgbB.xyz, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = rgbA;
    else
        color = rgbB;

    return color;
}


//DEFINEFRAGCOLOR
void main (void) {
    ivec2 dim = textureSize(colormap,0);

  gl_FragColor = applyFXAA(vTexCoords, colormap);
}
        
*/`.replace("#define GLSLIFY 1",""),vertexShader:`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `.replace("#define GLSLIFY 1",""),uniforms:{}},Lr={opacity:{type:"f",value:1},fogColor:{type:"c",value:new V.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}},Dr={vertexShader:`uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec2 mapping;
varying vec3 vColor;
varying float rval;
varying vec3 vLight;
varying vec3 center;

void main() {

    vColor = color;
    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
    center = mvPosition.xyz;
    vec4 projPosition = projectionMatrix * mvPosition;
    vec4 adjust = projectionMatrix* vec4(normal,0.0); adjust.z = 0.0; adjust.w = 0.0;
    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vLight = normalize( lDirection.xyz );
    mapping = normal.xy;
    rval = abs(normal.x);
    gl_Position = projPosition+adjust;

}
`.replace("#define GLSLIFY 1",""),fragmentShader:`
uniform mat4 viewMatrix;
uniform float opacity;
uniform mat4 projectionMatrix;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
uniform float uDepth;
uniform vec3 directionalLightColor[ 1 ];

varying vec3 vColor;
varying vec2 mapping;
varying float rval;
varying vec3 vLight;
varying vec3 center;

#ifdef SHADED
uniform highp sampler2D shading;
#endif

//DEFINEFRAGCOLOR

void main() {
    float lensqr = dot(mapping,mapping);
    float rsqr = rval*rval;
    if(lensqr > rsqr)
       discard;
    float z = sqrt(rsqr-lensqr);
    vec3 cameraPos = center+ vec3(mapping.x,mapping.y,z);
    vec4 clipPos = projectionMatrix * vec4(cameraPos, 1.0);
    float ndcDepth = clipPos.z / clipPos.w;
    gl_FragDepthEXT = ((gl_DepthRange.diff * ndcDepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
    vec3 norm = normalize(vec3(mapping.x,mapping.y,z));
    float dotProduct = dot( norm, vLight );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );
    vec3 vLight = directionalLightColor[ 0 ] * directionalLightWeighting;
    vec3 color = vLight*vColor;
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    color *= shadowFactor;
#endif    
    gl_FragColor = vec4(color, opacity*opacity );

    if(fogNear != fogFar) {
        float depth = -cameraPos.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }
     
}

`.replace("#define GLSLIFY 1",""),uniforms:Lr},rr={opacity:{type:"f",value:1},outlineColor:{type:"c",value:new V.Color(0,0,0)},fogColor:{type:"c",value:new V.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},outlineWidth:{type:"f",value:.1},outlinePushback:{type:"f",value:1},outlineMaxPixels:{type:"f",value:0}},vi={fragmentShader:`

uniform float opacity;
uniform vec3 outlineColor;
uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
uniform mat4 projectionMatrix;
varying vec2 mapping;
varying float rval;
varying vec3 center;

uniform float outlinePushback;

//DEFINEFRAGCOLOR

void main() {
    float lensqr = dot(mapping,mapping);
    float rsqr = rval*rval;
    if(lensqr > rsqr)
       discard;
    float z = sqrt(rsqr-lensqr);
    vec3 cameraPos = center+ vec3(mapping.x,mapping.y,z-outlinePushback);
    vec4 clipPos = projectionMatrix * vec4(cameraPos, 1.0);
    float ndcDepth = clipPos.z / clipPos.w;
    gl_FragDepthEXT = ((gl_DepthRange.diff * ndcDepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
    gl_FragColor = vec4(outlineColor, 1 );

    if(fogNear != fogFar) {
        float depth = -cameraPos.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }
}


`.replace("#define GLSLIFY 1",""),vertexShader:`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform float outlineWidth;
uniform float outlinePushback;
uniform float outlineMaxPixels;
uniform float vWidth;
uniform float vHeight;

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec2 mapping;
varying float rval;
varying vec3 center;

void main() {

    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
    center = mvPosition.xyz;
    vec4 projPosition = projectionMatrix * mvPosition;
    vec2 norm = normal.xy + vec2(sign(normal.x)*outlineWidth,sign(normal.y)*outlineWidth);

    vec4 adjust = projectionMatrix* vec4(norm,normal.z,1.0); 
    mapping = norm.xy;
    rval = abs(norm.x);
    gl_Position = projPosition+vec4(adjust.xy,0.0,0.0);

    if(outlineMaxPixels > 0.0) {
        vec4 unadjusted = projectionMatrix*vec4(center.x+normal.x, center.y,center.z,1.0); 
        vec4 ccoord = projectionMatrix*vec4(center.xyz,1.0);
        adjust = projectionMatrix* vec4(center.x+norm.x,center.y,center.z,1.0); 
        //subtract center 
        unadjusted.xyz -= ccoord.xyz;
        adjust.xyz -= ccoord.xyz;
        unadjusted /= unadjusted.w;
        adjust /= adjust.w;
        float diff = abs(adjust.x-unadjusted.x);
        diff *= vWidth;
        if(diff > outlineMaxPixels) {
            
            float fixlen = abs(unadjusted.x) + outlineMaxPixels/vWidth;
            //adjsut reval by ratio of lengths
            rval *= fixlen/abs(adjust.x);
        }

    }
}

`.replace("#define GLSLIFY 1",""),uniforms:rr},bi={fragmentShader:`

uniform vec3 color;
uniform sampler2D map;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
uniform float alphaTest;

varying vec2 vUV;
//DEFINEFRAGCOLOR

void main() {

    vec4 texture = texture2D(map, vUV);

    if (texture.a <= alphaTest) discard;

    gl_FragColor = vec4(color * texture.xyz, texture.a * opacity);

    if (fogNear != fogFar) {

        float depth = gl_FragCoord.z / gl_FragCoord.w; //probably wrong
        float fogFactor = smoothstep(fogNear, fogFar, depth);        
        gl_FragColor = mix(gl_FragColor, vec4(fogColor, gl_FragColor.w), fogFactor);
    }
}

`.replace("#define GLSLIFY 1",""),vertexShader:`

uniform int useScreenCoordinates;
uniform vec3 screenPosition;
uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform float rotation;
uniform vec2 scale;
uniform vec2 alignment;
uniform vec2 uvOffset;
uniform vec2 uvScale;

attribute vec2 position;
attribute vec2 uv;

varying vec2 vUV;

void main() {

    vUV = uvOffset + uv * uvScale;

    vec2 alignedPosition = position + alignment;

    vec2 rotatedPosition;
    rotatedPosition.x = ( cos(rotation) * alignedPosition.x - sin(rotation) * alignedPosition.y ) * scale.x;
    rotatedPosition.y = ( sin(rotation) * alignedPosition.x + cos(rotation) * alignedPosition.y ) * scale.y;

    vec4 finalPosition;

    if(useScreenCoordinates != 0) {
        finalPosition = vec4(screenPosition.xy + rotatedPosition, screenPosition.z, 1.0);
    }

    else {
        finalPosition = projectionMatrix * modelViewMatrix * vec4(0.0, 0.0, 0.0, 1.0); finalPosition /= finalPosition.w;
        finalPosition.xy += rotatedPosition; 
    }

    gl_Position = finalPosition;

}

`.replace("#define GLSLIFY 1",""),uniforms:{}},$i={opacity:{type:"f",value:1},fogColor:{type:"c",value:new V.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}},Ci=`uniform float opacity;
uniform mat4 projectionMatrix;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;

varying vec3 vLight;
varying vec3 vColor;
varying vec3 cposition;
varying vec3 p1;
varying vec3 p2;
varying float r;

#ifdef SHADED
uniform highp sampler2D shading;
#endif

//DEFINEFRAGCOLOR

//cylinder-ray intersection testing taken from http://mrl.nyu.edu/~dzorin/cg05/lecture12.pdf
//also useful: http://stackoverflow.com/questions/9595300/cylinder-impostor-in-glsl
//with a bit more care (caps) this could be a general cylinder imposter (see also outline)
void main() {
    vec3 color = abs(vColor);
    vec3 pos = cposition;
    vec3 p = pos; //ray point
    vec3 v = vec3(0.0,0.0,-1.0); //ray normal - orthographic
    if(projectionMatrix[3][3] == 0.0) v = normalize(pos); //ray normal - perspective
    vec3 pa = p1; //cyl start
    vec3 va = normalize(p2-p1); //cyl norm
    vec3 tmp1 = v-(dot(v,va)*va);
    vec3 deltap = p-pa;
    float A = dot(tmp1,tmp1);
    if(A == 0.0) discard;
    vec3 tmp2 = deltap-(dot(deltap,va)*va);
    float B = 2.0*dot(tmp1, tmp2);
    float C = dot(tmp2,tmp2)-r*r;
//quadratic equation!
    float det = (B*B) - (4.0*A*C);
    if(det < 0.0) discard;
    float sqrtDet = sqrt(det);
    float posT = (-B+sqrtDet)/(2.0*A);
    float negT = (-B-sqrtDet)/(2.0*A);
    float intersectionT = min(posT,negT);
    vec3 qi = p+v*intersectionT;
    float dotp1 = dot(va,qi-p1);
    float dotp2 = dot(va,qi-p2);
    vec3 norm;
    if( dotp1 < 0.0 || dotp2 > 0.0) { //(p-c)^2 + 2(p-c)vt +v^2+t^2 - r^2 = 0
       vec3 cp;
       if( dotp1 < 0.0) {  
//        if(vColor.x < 0.0 ) discard; //color sign bit indicates if we should cap or not
        cp = p1;
       } else {
//          if(vColor.y < 0.0 ) discard;
          cp = p2;
       }
       vec3 diff = p-cp;
       A = dot(v,v);
       B = dot(diff,v)*2.0;
       C = dot(diff,diff)-r*r;
       det = (B*B) - (4.0*C);
       if(det < 0.0) discard;
       sqrtDet = sqrt(det);
       posT = (-B+sqrtDet)/(2.0);
       negT = (-B-sqrtDet)/(2.0);
       float t = min(posT,negT);
       qi = p+v*t; 
       norm = normalize(qi-cp); 
    } else {
       norm = normalize(qi-(dotp1*va + p1));
    }
    vec4 clipPos = projectionMatrix * vec4(qi, 1.0);
    float ndcDepth = clipPos.z / clipPos.w;
    float depth = ((gl_DepthRange.diff * ndcDepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
    gl_FragDepthEXT = depth;`,Ni={fragmentShader:[Ci,`    float dotProduct = dot( norm, vLight );
    vec3 light = vec3( max( dotProduct, 0.0 ) );
    color *= light;
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    color *= shadowFactor;
#endif    
    gl_FragColor = vec4(color, opacity*opacity );
    if(fogNear != fogFar) {
        float depth = -qi.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }
}`].join(`
`),vertexShader:`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;
attribute float radius;

varying vec3 vColor;
varying vec3 vLight;
varying vec3 cposition;
varying vec3 p1;
varying vec3 p2;
varying float r;

void main() {

    vColor = color; vColor.z = abs(vColor.z); //z indicates which vertex and so would vary
    r = abs(radius);
    vec4 to = modelViewMatrix*vec4(normal, 1.0); //normal is other point of cylinder
    vec4 pt = modelViewMatrix*vec4(position, 1.0);
    vec4 mvPosition = pt;
    p1 = pt.xyz; p2 = to.xyz;
    vec3 norm = to.xyz-pt.xyz;
    float mult = 1.1; //slop to account for perspective of sphere
    if(length(p1) > length(p2)) { //billboard at level of closest point
       mvPosition = to;
    }
    vec3 n = normalize(mvPosition.xyz);
    bool isperspective = (projectionMatrix[3][3] == 0.0);
//intersect with the plane defined by the camera looking at the billboard point
    if(color.z >= 0.0) { //p1
       if(isperspective) { //perspective
         vec3 pnorm = normalize(p1);
         float t = dot(mvPosition.xyz-p1,n)/dot(pnorm,n);
         mvPosition.xyz = p1+t*pnorm; 
       } else { //orthographic
         mvPosition.xyz = p1;
       }
    } else {
      if(isperspective) { //perspective
         vec3 pnorm = normalize(p2);
         float t = dot(mvPosition.xyz-p2,n)/dot(pnorm,n);
         mvPosition.xyz = p2+t*pnorm;
       } else { //orthographic
         mvPosition.xyz = p2;
       } 
       mult *= -1.0;
    }

    if(isperspective) { //perspective
      vec3 cr = normalize(cross(mvPosition.xyz,norm))*radius;
      vec3 doublecr = normalize(cross(mvPosition.xyz,cr))*radius;
      mvPosition.xyz +=  mult*(cr + doublecr).xyz;
    } else {
      vec3 cr = normalize(cross(vec3(0.0,0.0,-1.0),norm))*radius;
      vec3 doublecr = normalize(cross(vec3(0.0,0.0,-1.0),cr))*radius;
      mvPosition.xyz +=  mult*(cr + doublecr).xyz;     
    }

    cposition = mvPosition.xyz;
    gl_Position = projectionMatrix * mvPosition;
    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vLight = normalize( lDirection.xyz )*directionalLightColor[0]; //not really sure this is right, but color is always white so..
}

`,uniforms:$i},Ti={fragmentShader:Ci+`
    gl_FragColor = vec4(color, opacity*opacity );
    if(fogNear != fogFar) {
        float depth = -qi.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }
}`,vertexShader:`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];
uniform vec3 outlineColor;
uniform float outlineWidth;
uniform float outlinePushback;
uniform float outlineMaxPixels;
uniform float vWidth;
uniform mat4 projinv;


attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;
attribute float radius;

varying vec3 vColor;
varying vec3 vLight;
varying vec3 cposition;
varying vec3 p1;
varying vec3 p2;
varying float r;

void main() {

    vColor = outlineColor;
    float rad = radius+sign(radius)*outlineWidth;
    r = abs(rad);

    vec4 to = modelViewMatrix*vec4(normal, 1.0); //normal is other point of cylinder
    vec4 pt = modelViewMatrix*vec4(position, 1.0);
//pushback
    float scale = 1.0;
    if(projectionMatrix[3][3] != 0.0) { //orthographic
        to.z -= outlinePushback;
        pt.z -= outlinePushback;
    } else { //perspective
        vec4 midbefore = pt;
        if(length(to.xyz) < length(pt)) {
            midbefore = to;
        }
        vec4 midafter = midbefore;
        midafter.xyz += normalize(midbefore.xyz)*outlinePushback;

        to.xyz += normalize(to.xyz)*outlinePushback;
        pt.xyz += normalize(pt.xyz)*outlinePushback;

        //figure out a scaling factor for radius to account for perspective setback
        vec4 midbeforer = vec4(midbefore.x+rad,midbefore.y, midbefore.z, midbefore.w);
        vec4 midafterr = vec4(midafter.x+rad,midafter.y, midafter.z, midafter.w);

        vec4 mb = projectionMatrix*midbefore;
        vec4 mbr = projectionMatrix*midbeforer;
        vec4 ma = projectionMatrix*midafter;
        vec4 mar = projectionMatrix*midafterr;
        mb /= mb.w;
        mbr /= mbr.w;
        ma /= ma.w;
        mar /= mar.w;
        scale = abs((mbr.x-mb.x)/(mar.x-ma.x));
        rad *= scale;
        r = abs(rad);
    }
    vec4 mvPosition = pt;
    p1 = pt.xyz; p2 = to.xyz;
    vec3 norm = to.xyz-pt.xyz;
    float mult = 1.1; //slop to account for perspective of sphere
    if(length(p1) > length(p2)) { //billboard at level of closest point
       mvPosition = to;
    }

    vec3 n = normalize(mvPosition.xyz);
//intersect with the plane defined by the camera looking at the billboard point
    if(color.z >= 0.0) { //p1
       vec3 pnorm = normalize(p1);
       float t = dot(mvPosition.xyz-p1,n)/dot(pnorm,n);
       mvPosition.xyz = p1+t*pnorm;
    } else {
       vec3 pnorm = normalize(p2);
       float t = dot(mvPosition.xyz-p2,n)/dot(pnorm,n);
       mvPosition.xyz = p2+t*pnorm;
       mult *= -1.0;
    }

    if(outlineMaxPixels > 0.0) {
        vec4 cpos = mvPosition;
        vec4 unadjusted = projectionMatrix*vec4(cpos.x+abs(scale*radius), cpos.y,cpos.z,cpos.w); 
        vec4 ccoord = projectionMatrix*cpos;
        vec4 adjust = projectionMatrix*vec4(cpos.x+r,cpos.y,cpos.z,cpos.w); 
        unadjusted /= unadjusted.w;
        adjust /= adjust.w;
        unadjusted.xyz -= ccoord.xyz/ccoord.w;
        adjust.xyz -= ccoord.xyz/ccoord.w;
        float diff = abs(adjust.x-unadjusted.x);
        diff *= vWidth; //this should now be in pixels
        if(diff > outlineMaxPixels) {
            float fixlen = abs(unadjusted.x) + outlineMaxPixels/vWidth; 
            vec4 pcoord = ccoord;
            pcoord.x += fixlen*pcoord.w;
            vec4 altc = projinv*pcoord;
            r= abs(altc.x-cpos.x);
        }
    }

    vec3 cr = normalize(cross(mvPosition.xyz,norm))*rad;
    vec3 doublecr = normalize(cross(mvPosition.xyz,cr))*rad;
    mvPosition.xy +=  mult*(cr + doublecr).xy;
    cposition = mvPosition.xyz;
    gl_Position = projectionMatrix * mvPosition;
    vLight = vec3(1.0,1.0,1.0);
}

`,uniforms:{opacity:{type:"f",value:1},fogColor:{type:"c",value:new V.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},outlineColor:{type:"c",value:new V.Color(0,0,0)},outlineWidth:{type:"f",value:.1},outlinePushback:{type:"f",value:1},outlineMaxPixels:{type:"f",value:0},projinv:{type:"mat4",value:[]}}},pi={opacity:{type:"f",value:1},fogColor:{type:"c",value:new V.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},data:{type:"i",value:3},colormap:{type:"i",value:4},depthmap:{type:"i",value:5},step:{type:"f",value:1},maxdepth:{type:"f",value:100},subsamples:{type:"f",value:5},textmat:{type:"mat4",value:[]},projinv:{type:"mat4",value:[]},transfermin:{type:"f",value:-.2},transfermax:{type:"f",value:.2}},Br={fragmentShader:`
uniform highp sampler3D data;
uniform highp sampler2D colormap;
uniform highp sampler2D depthmap;


uniform mat4 textmat;
uniform mat4 projinv;
uniform mat4 projectionMatrix;

uniform float step;
uniform float subsamples;
uniform float maxdepth;
uniform float transfermin;
uniform float transfermax;
in  vec4 mvPosition;
out vec4 color;
void main(void) {

   vec4 pos = mvPosition;
   bool seengood = false;
   float i = 0.0;
   color = vec4(1,1,1,0);
   float increment = 1.0/subsamples;
   float maxsteps = (maxdepth*subsamples/step);
//there's probably a better way to do this..
//calculate farthest possible point in model coordinates
   vec4 maxpos = vec4(pos.x,pos.y,pos.z-maxdepth,1.0);
// convert to projection
   maxpos = projectionMatrix*maxpos;
   vec4 startp = projectionMatrix*pos;
// homogonize
   maxpos /= maxpos.w;
   startp /= startp.w;
//take x,y from start and z from max
   maxpos = vec4(startp.x,startp.y,maxpos.z,1.0);
//convert back to model space
   maxpos = projinv*maxpos;
   maxpos /= maxpos.w;
   float incr = step/subsamples;
//get depth from depthmap
//startp is apparently [-1,1]
   vec2 tpos = startp.xy/2.0+0.5;
   float depth = texture(depthmap, tpos).r;
//compute vector between start and end
   vec4 direction = maxpos-pos;
   for( i = 0.0; i <= maxsteps; i++) {
      vec4 pt = (pos+(i/maxsteps)*direction);
      vec4 ppt = projectionMatrix*pt;
      float ptdepth = ppt.z/ppt.w;
      ptdepth = ((gl_DepthRange.diff * ptdepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
      if(ptdepth > depth) break;
      pt = textmat*pt;
//       pt /= pt.w;
      if(pt.x >= -0.01 && pt.y >= -0.01 && pt.z >= -0.01 && pt.x <= 1.01 && pt.y <= 1.01 && pt.z <= 1.01) {
         seengood = true;
      } else if(seengood) {
         break;
      }
      if( pt.x < -0.01 || pt.x > 1.01 || pt.y < -0.01 || pt.y > 1.01 || pt.z < -0.01 || pt.z > 1.01  ){
          color.a = 0.0;
          continue;
      }
      else {
         float val = texture(data, pt.zyx).r;
         if(isinf(val)) continue; //masked out
         float cval = (val-transfermin)/(transfermax-transfermin); //scale to texture 0-1 range
         vec4 val_color = texture(colormap, vec2(cval,0.5));
         color.rgb = color.rgb*color.a + (1.0-color.a)*val_color.a*val_color.rgb;
         color.a += (1.0 - color.a) * val_color.a; 
         if(color.a > 0.0) color.rgb /= color.a;
//          color = vec4(pt.x, pt.y, pt.z, 1.0);
      }
//       color = vec4(pt.x, pt.y, pt.z, 0.0)
    }
}

        `.replace("#define GLSLIFY 1",""),vertexShader:`uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;

in vec3 position;
out vec4 mvPosition;
void main() {

    mvPosition = modelViewMatrix * vec4( position, 1.0 );
    gl_Position = projectionMatrix*mvPosition;
}
`.replace("#define GLSLIFY 1",""),uniforms:pi},Zr={basic:zt,blur:{fragmentShader:`const float INV_TOTAL_SAMPLES_FACTOR = 1.0 / 9.0;
uniform highp sampler2D inTex;
varying highp vec2 vTexCoords;
    
void main() {
 
 vec2 texelSize = 1.0 / vec2(textureSize(inTex,0));
 float blurred_visibility_factor = 0.0f;
 for (int t = -1; t <= 1; ++t) {
  for (int s = -1; s <= 1; ++s) {
   vec2 offset = vec2(float(s), float(t)) * texelSize;
   blurred_visibility_factor += texture2D(inTex, vTexCoords + offset).r;
  }
 }
    
 gl_FragDepthEXT = blurred_visibility_factor * INV_TOTAL_SAMPLES_FACTOR;
 
}`,vertexShader:`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `,uniforms:{}},instanced:Lt,lambert:It,lambertdouble:li,outline:ui,screen:gi,screenaa:jr,ssao:{fragmentShader:`uniform sampler2D depthmap;
varying highp vec2 vTexCoords;
uniform float vWidth;
uniform float vHeight;
uniform float total_strength;
uniform float radius;
uniform mat4 projinv;
uniform mat4 projectionMatrix;

//code for pseudorandom vector from chatgpt
float hash(vec3 p) {
    p = fract(p * vec3(0.1031, 0.1030, 0.0973));
    p += dot(p, p.yzx + 33.33);
    return fract((p.x + p.y) * p.z);
}

// Generate a pseudorandom vec3 from a seed vec3
vec3 pseudorandomVec3(vec3 seed) {
    vec3 randomVec;
    randomVec.x = hash(seed);
    randomVec.y = hash(seed + vec3(1.0, 0.0, 17.1));
    randomVec.z = hash(seed + vec3(0.0, 13.23, 0.0));
    return randomVec;
}

void main(void)
{   
   const float base = 0.2;
   const float area = 0.75;
   const int cycles = 1;

   const int samples = 64;
   vec3 sample_sphere[64] = vec3[](
      vec3(0.091258,-0.510164,0.000000),
      vec3(-0.204347,-0.872967,0.187199),
      vec3(0.009690,-0.263696,-0.110414),
      vec3(0.175208,-0.563987,0.228527),
      vec3(-0.001824,-0.003113,-0.000323),
      vec3(0.411134,-0.719869,-0.261530),
      vec3(-0.074272,-0.377368,0.276290),
      vec3(-0.147773,-0.381587,-0.284529),
      vec3(0.173317,-0.199635,0.063295),
      vec3(-0.186452,-0.199460,0.076965),
      vec3(0.143985,-0.308160,-0.307687),
      vec3(0.053194,-0.148286,0.169589),
      vec3(-0.547656,-0.486476,-0.317378),
      vec3(0.020804,-0.015092,-0.004574),
      vec3(-0.038006,-0.043165,0.054059),
      vec3(-0.094795,-0.443908,-0.731525),
      vec3(0.547552,-0.396466,0.461477),
      vec3(-0.176886,-0.089989,0.007315),
      vec3(0.074401,-0.048840,-0.074039),
      vec3(-0.008240,-0.075697,0.178197),
      vec3(-0.307880,-0.185053,-0.368943),
      vec3(0.309520,-0.108483,0.041646),
      vec3(-0.773478,-0.292946,0.538166),
      vec3(0.184487,-0.231594,-0.820065),
      vec3(0.207318,-0.100531,0.361797),
      vec3(-0.173306,-0.037737,-0.055289),
      vec3(0.548102,-0.105342,-0.253237),
      vec3(-0.119342,-0.043907,0.285162),
      vec3(-0.270247,-0.087861,-0.751357),
      vec3(0.449312,-0.039777,0.236146),
      vec3(-0.743773,-0.036095,0.196056),
      vec3(0.148819,-0.004300,-0.231448),
      vec3(0.008773,0.000809,0.051047),
      vec3(-0.461467,0.027390,-0.357386),
      vec3(0.169626,0.013338,-0.014053),
      vec3(-0.043786,0.007095,0.047331),
      vec3(0.004821,0.140371,-0.988260),
      vec3(0.092402,0.023994,0.101860),
      vec3(-0.295335,0.061530,-0.027372),
      vec3(0.024903,0.007537,-0.018901),
      vec3(-0.081463,0.125402,0.447794),
      vec3(-0.397119,0.231805,-0.631062),
      vec3(0.163853,0.059014,0.044905),
      vec3(-0.495220,0.214357,0.254139),
      vec3(0.306123,0.373687,-0.825715),
      vec3(0.021665,0.026737,0.053220),
      vec3(-0.208231,0.117129,-0.098685),
      vec3(0.139749,0.080968,-0.043086),
      vec3(-0.153599,0.182814,0.262090),
      vec3(-0.159673,0.496777,-0.743568),
      vec3(0.134797,0.117152,0.095753),
      vec3(-0.155626,0.120533,0.019395),
      vec3(0.042311,0.054462,-0.049709),
      vec3(0.001257,0.031288,0.034468),
      vec3(-0.002271,0.003199,-0.002304),
      vec3(0.662104,0.717307,0.033854),
      vec3(-0.373100,0.576021,0.308274),
      vec3(0.024233,0.231316,-0.173688),
      vec3(0.161311,0.420217,0.234273),
      vec3(-0.045248,0.078031,-0.010411),
      vec3(0.167453,0.376942,-0.094872),
      vec3(-0.056194,0.433247,0.173218),
      vec3(-0.016224,0.123149,-0.035569),
      vec3(0.067127,0.407641,0.028479)
   );

   float depth = texture2D(depthmap, vTexCoords).r;
   if(depth == 1.0) {
      discard;
   }

   vec4 screen_position = vec4(vTexCoords, depth,1.0);
   vec4 pos = projinv*screen_position;
   pos /= pos.w;
   vec3 position = pos.xyz;

   //approximate the normal from the depth map; I find this simpler
   //than trying to recompute the exact normal within every possible object shader

   //pixel offset positions in screen space
   ivec2 dim = textureSize(depthmap,0);
   vec2 offset1 = vec2(0.0,1.0/float(dim.y));
   vec2 offset2 = vec2(1.0/float(dim.x),0.0);
   float depth1 = texture2D(depthmap, vTexCoords + offset1).r;
   float depth2 = texture2D(depthmap, vTexCoords + offset2).r;
   
   vec3 p1 = vec3(screen_position.xy+offset1, depth1 - depth);
   vec3 p2 = vec3(screen_position.xy+offset2, depth2 - depth);

   //convert to model space
   vec4 pos1 = projinv*vec4(p1,1);
   pos1 /= pos1.w;
   vec4 pos2 = projinv*vec4(p2,1);
   pos2 /= pos2.w;

   vec3 normal = normalize(cross(pos1.xyz-position, pos2.xyz-position)); //model normal, important we normalize in model space

   //pseudo random number

   float occlusion = 0.0;
   for(int c = 0; c < cycles; c++) {
   vec3 random = normalize(pseudorandomVec3(position+float(c)));
   for(int i=0; i < samples; i++) {

      vec3 ray = radius * reflect(sample_sphere[i],random);
      vec3 hemi_ray = position + sign(dot(ray,normal)) * ray; //model space
      vec4 hemi_screen = projectionMatrix*vec4(hemi_ray,1.0);
      hemi_screen /= hemi_screen.w;
      
      float occ_depth = texture2D(depthmap, clamp(hemi_screen.xy,0.0,1.0)).r;
      float difference = hemi_screen.z - occ_depth;
      
      occlusion += step(0.0, difference) * (1.0-smoothstep(0.0, area, difference));
   }
   }
   float ao = 1.0 - total_strength * occlusion * (1.0 / float(cycles*samples));
   gl_FragDepthEXT = clamp(ao+base,0.0,1.0);

}`,vertexShader:`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `,uniforms:{total_strength:{type:"f",value:1},radius:{type:"f",value:5},projinv:{type:"mat4",value:[]}}},sphereimposter:Dr,sphereimposteroutline:vi,sprite:bi,stickimposter:Ni,stickimposteroutline:Ti,volumetric:Br};function Vi(Bt){let _={};for(const xe in Bt){_[xe]={},_[xe].type=Bt[xe].type;var ne=Bt[xe].value;ne instanceof V.Color?_[xe].value=ne.clone():typeof ne=="number"?_[xe].value=ne:ne instanceof Array?_[xe].value=[]:console.error("Error copying shader uniforms from ShaderLib: unknown type for uniform")}return _}const yi={clone:Vi};class Wi extends Me{constructor(_=50,ne=1,xe=.1,Ve=2e3,Oe=!1){super(),this.projectionMatrix=new m.Matrix4,this.projectionMatrixInverse=new m.Matrix4,this.matrixWorldInverse=new m.Matrix4,this.fov=_,this.aspect=ne,this.near=xe,this.far=Ve;var yt=this.position.z;this.right=yt*Math.tan(Math.PI/180*_),this.left=-this.right,this.top=this.right/this.aspect,this.bottom=-this.top,this.ortho=!!Oe,this.updateProjectionMatrix()}lookAt(_){this.matrix.lookAt(this.position,_,this.up),this.rotationAutoUpdate&&(this.useQuaternion===!1&&this.rotation instanceof m.Vector3?this.rotation.setEulerFromRotationMatrix(this.matrix,this.eulerOrder):console.error("Unimplemented math operation."))}updateProjectionMatrix(){this.ortho?this.projectionMatrix.makeOrthographic(this.left,this.right,this.top,this.bottom,this.near,this.far):this.projectionMatrix.makePerspective(this.fov,this.aspect,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)}}class tn{constructor(_,ne=1,xe=1e3){this.name="",this.color=new V.Color(_),this.near=ne,this.far=xe}clone(){return new tn(this.color.getHex(),this.near,this.far)}}class on{constructor(){this.sprite={vertices:null,faces:null,vertexBuffer:null,elementBuffer:null,program:null,attributes:{},uniforms:null}}init(_){this.gl=_.context,this.renderer=_,this.precision=_.getPrecision(),this.sprite.vertices=new Float32Array(16),this.sprite.faces=new Uint16Array(6);var ne=0;this.sprite.vertices[ne++]=-1,this.sprite.vertices[ne++]=-1,this.sprite.vertices[ne++]=0,this.sprite.vertices[ne++]=0,this.sprite.vertices[ne++]=1,this.sprite.vertices[ne++]=-1,this.sprite.vertices[ne++]=1,this.sprite.vertices[ne++]=0,this.sprite.vertices[ne++]=1,this.sprite.vertices[ne++]=1,this.sprite.vertices[ne++]=1,this.sprite.vertices[ne++]=1,this.sprite.vertices[ne++]=-1,this.sprite.vertices[ne++]=1,this.sprite.vertices[ne++]=0,this.sprite.vertices[ne++]=1,ne=0,this.sprite.faces[ne++]=0,this.sprite.faces[ne++]=1,this.sprite.faces[ne++]=2,this.sprite.faces[ne++]=0,this.sprite.faces[ne++]=2,this.sprite.faces[ne++]=3,this.sprite.vertexBuffer=this.gl.createBuffer(),this.sprite.elementBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.sprite.vertexBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.sprite.vertices,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.sprite.elementBuffer),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.sprite.faces,this.gl.STATIC_DRAW),this.sprite.program=this.createProgram(Zr.sprite,this.precision||1),this.sprite.attributes={};const xe={};this.sprite.attributes.position=this.gl.getAttribLocation(this.sprite.program,"position"),this.sprite.attributes.uv=this.gl.getAttribLocation(this.sprite.program,"uv"),xe.uvOffset=this.gl.getUniformLocation(this.sprite.program,"uvOffset"),xe.uvScale=this.gl.getUniformLocation(this.sprite.program,"uvScale"),xe.rotation=this.gl.getUniformLocation(this.sprite.program,"rotation"),xe.scale=this.gl.getUniformLocation(this.sprite.program,"scale"),xe.alignment=this.gl.getUniformLocation(this.sprite.program,"alignment"),xe.color=this.gl.getUniformLocation(this.sprite.program,"color"),xe.map=this.gl.getUniformLocation(this.sprite.program,"map"),xe.opacity=this.gl.getUniformLocation(this.sprite.program,"opacity"),xe.useScreenCoordinates=this.gl.getUniformLocation(this.sprite.program,"useScreenCoordinates"),xe.screenPosition=this.gl.getUniformLocation(this.sprite.program,"screenPosition"),xe.modelViewMatrix=this.gl.getUniformLocation(this.sprite.program,"modelViewMatrix"),xe.projectionMatrix=this.gl.getUniformLocation(this.sprite.program,"projectionMatrix"),xe.fogNear=this.gl.getUniformLocation(this.sprite.program,"fogNear"),xe.fogFar=this.gl.getUniformLocation(this.sprite.program,"fogFar"),xe.fogColor=this.gl.getUniformLocation(this.sprite.program,"fogColor"),xe.alphaTest=this.gl.getUniformLocation(this.sprite.program,"alphaTest"),this.sprite.uniforms=xe}render(_,ne,xe,Ve,Oe){var yt,lt,mt,Mt,Pt,Ot,gr,Zt,Ar,Cr;if(!this.gl)throw new Error("WebGLRenderer not initialized");let Ur=[];(yt=_?.__webglSprites)===null||yt===void 0||yt.forEach(A=>{(Oe&&A.material.depthTest==0||!Oe&&A.material.depthTest)&&Ur.push(A)});let _r=Ur.length;if(!_r)return;const Or=this.sprite.attributes,wr=this.sprite.uniforms;if(!wr)throw new Error("Uniforms not defined");var Mi=.5*xe,Qt=.5*Ve;this.gl.useProgram(this.sprite.program),this.gl.enableVertexAttribArray(Or.position),this.gl.enableVertexAttribArray(Or.uv),this.gl.disable(this.gl.CULL_FACE),this.gl.enable(this.gl.BLEND),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.sprite.vertexBuffer),this.gl.vertexAttribPointer(Or.position,2,this.gl.FLOAT,!1,16,0),this.gl.vertexAttribPointer(Or.uv,2,this.gl.FLOAT,!1,16,8),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.sprite.elementBuffer),this.gl.uniformMatrix4fv(wr.projectionMatrix,!1,ne.projectionMatrix.elements),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.uniform1i(wr.map,0);var ri,ae=_.fog;let i,s,l;ae?(this.gl.uniform3f(wr.fogColor,ae.color.r,ae.color.g,ae.color.b),this.gl.uniform1f(wr.fogNear,ae.near),this.gl.uniform1f(wr.fogFar,ae.far)):(this.gl.uniform1f(wr.fogNear,0),this.gl.uniform1f(wr.fogFar,0));let h=[];for(ri=0;ri<_r;ri++)i=Ur[ri],s=i.material,s&&(s.depthTest!=0||Oe)&&i.visible&&s.opacity!==0&&(s.useScreenCoordinates?i.z=-i.position.z:(i._modelViewMatrix.multiplyMatrices(ne.matrixWorldInverse,i.matrixWorld),i.z=-i._modelViewMatrix.elements[14]));for(Ur.sort(ur),ri=0;ri<_r;ri++)if(i=Ur[ri],s=i.material,s&&i.visible&&s.opacity!==0&&s.map&&s.map.image&&s.map.image.width){this.gl.uniform1f(wr?.alphaTest||null,s.alphaTest);var E=s.map.image.width,g=s.map.image.height;h[0]=E*this.renderer.devicePixelRatio/xe,h[1]=g*this.renderer.devicePixelRatio/Ve,s.useScreenCoordinates===!0?(this.gl.uniform1i(wr.useScreenCoordinates,1),this.gl.uniform3f(wr.screenPosition,(i.position.x*this.renderer.devicePixelRatio-Mi)/Mi,(Qt-i.position.y*this.renderer.devicePixelRatio)/Qt,Math.max(0,Math.min(1,i.position.z)))):(this.gl.uniform1i(wr.useScreenCoordinates,0),this.gl.uniformMatrix4fv(wr.modelViewMatrix,!1,i._modelViewMatrix.elements)),l=1/(s.scaleByViewport?Ve:1),h[0]*=l*i.scale.x,h[1]*=l*i.scale.y;let A=(lt=s?.alignment)===null||lt===void 0?void 0:lt.x,M=(mt=s?.alignment)===null||mt===void 0?void 0:mt.y;s.screenOffset&&(A=(A||0)+2*s.screenOffset.x/E,M=(M||0)+2*s.screenOffset.y/g),this.gl.uniform2f(wr.uvScale,((Mt=s?.uvScale)===null||Mt===void 0?void 0:Mt.x)||1,((Pt=s?.uvScale)===null||Pt===void 0?void 0:Pt.y)||1),this.gl.uniform2f(wr.uvOffset,((Ot=s?.uvOffset)===null||Ot===void 0?void 0:Ot.x)||0,((gr=s?.uvOffset)===null||gr===void 0?void 0:gr.y)||0),this.gl.uniform2f(wr.alignment,A||0,M||0),this.gl.uniform1f(wr.opacity,s.opacity),this.gl.uniform3f(wr.color,((Zt=s?.color)===null||Zt===void 0?void 0:Zt.r)||0,((Ar=s?.color)===null||Ar===void 0?void 0:Ar.g)||0,((Cr=s?.color)===null||Cr===void 0?void 0:Cr.b)||0),this.gl.uniform1f(wr.rotation,i.rotation),this.gl.uniform2fv(wr.scale,h),this.renderer.setDepthTest(s.depthTest),this.renderer.setDepthWrite(s.depthWrite),this.renderer.setTexture(s.map,0),this.gl.drawElements(this.gl.TRIANGLES,6,this.gl.UNSIGNED_SHORT,0)}this.gl.enable(this.gl.CULL_FACE)}createProgram(_,ne){if(!this.gl)throw new Error("WebGL Rendering context not found");var xe=this.gl.createProgram();if(!xe)throw new Error("Error creating webgl program");var Ve=this.gl.createShader(this.gl.FRAGMENT_SHADER),Oe=this.gl.createShader(this.gl.VERTEX_SHADER);if(!Ve)throw new Error("Unable to create fragment shader SpritePlugin.createProgram");if(!Oe)throw new Error("Unable to create vertex shader SpritePlugin.createProgram");var yt="precision "+ne+` float;
`;if(this.gl.shaderSource(Ve,yt+_.fragmentShader),this.gl.shaderSource(Oe,yt+_.vertexShader),this.gl.compileShader(Ve),this.gl.compileShader(Oe),!this.gl.getShaderParameter(Ve,this.gl.COMPILE_STATUS)||!this.gl.getShaderParameter(Oe,this.gl.COMPILE_STATUS))throw new Error(`Error compiling shader: 
      ${this.gl.getShaderInfoLog(Ve)} 
      ${this.gl.getShaderInfoLog(Oe)}`);return this.gl.attachShader(xe,Ve),this.gl.attachShader(xe,Oe),this.gl.linkProgram(xe),this.gl.getProgramParameter(xe,this.gl.LINK_STATUS)||console.error("Could not initialize shader"),xe}}function ur(Bt,_){return Bt.z!==_.z?_.z-Bt.z:_.id-Bt.id}var Gr=null,$r=null;class qi{constructor(_){this.context=null,this.devicePixelRatio=1,this.sortObjects=!0,this.autoUpdateObjects=!0,this.autoUpdateScene=!0,this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}},this._offscreen=null,this._bitmap=null,this._programs=[],this._programs_counter=0,this._webglversion=1,this._currentProgram=null,this._currentMaterialId=-1,this._currentGeometryGroupHash=null,this._currentCamera=null,this._geometryGroupCounter=0,this._oldDoubleSided=-1,this._oldFlipSided=-1,this._oldDepthTest=-1,this._oldDepthWrite=-1,this._oldPolygonOffset=null,this._oldLineWidth=null,this._viewportWidth=0,this._viewportHeight=0,this._currentWidth=0,this._currentHeight=0,this._enabledAttributes={},this._vector3=new m.Vector3,this._worldInverse=new m.Matrix4,this._projInverse=new m.Matrix4,this._textureMatrix=new m.Matrix4,this._fullProjModelMatrix=new m.Matrix4,this._fullProjModelMatrixInv=new m.Matrix4,this._direction=new m.Vector3,this._lightsNeedUpdate=!0,this._lights={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}},this.sprites=new on,this._screenshader=null,this._AOshader=null,this._blurshader=null,this._vertexattribpos=null,this._aovertexattribpos=null,this._blurvertexattribpos=null,this._screenQuadVBO=null,this._fb=null,this._targetTexture=null,this._depthTexture=null,this._shadingTexture=null,this._scratchTexture=null,this._upscale=null,this._AOstrength=1,this._AOradius=5,this.SHADE_TEXTURE=3,_=_||{},this.row=_.row,this.col=_.col,this.rows=_.rows,this.cols=_.cols,this._canvas=_.canvas!==void 0?_.canvas:document.createElement("canvas"),this._precision=_.precision!==void 0?_.precision:"highp",this._alpha=_.alpha===void 0||_.alpha,this._premultipliedAlpha=_.premultipliedAlpha===void 0||_.premultipliedAlpha,this._antialias=_.antialias!==void 0&&_.antialias,this._upscale=_.upscale!==void 0?_.upscale:this._antialias,this._preserveDrawingBuffer=_.preserveDrawingBuffer!==void 0&&_.preserveDrawingBuffer,this._clearColor=_.clearColor!==void 0?new V.Color(_.clearColor):new V.Color(0),this._clearAlpha=_.clearAlpha!==void 0?_.clearAlpha:0,this._outlineMaterial=new xr(_.outline),this._outlineSphereImposterMaterial=new Rr(_.outline),this._outlineStickImposterMaterial=new wi(_.outline),this._outlineEnabled=!!_.outline,this._AOEnabled=!!_.ambientOcclusion,_.ambientOcclusion&&_.ambientOcclusion.strength!==void 0&&(this._AOstrength=parseFloat(_.ambientOcclusion.strength)),this._AOstrength==0&&(this._AOEnabled=!1),_.ambientOcclusion&&_.ambientOcclusion.radius!==void 0&&(this._AOradius=parseFloat(_.ambientOcclusion.radius)),this.domElement=this._canvas,this._canvas.id=_.id,_.containerWidth!=0&&_.containerHeight!=0&&(this.initGL(),this.setDefaultGLState(),this.context=this._gl,this.isWebGL1()?this._extInstanced=this._gl.getExtension("ANGLE_instanced_arrays"):this._extInstanced={vertexAttribDivisorANGLE:this._gl.vertexAttribDivisor.bind(this._gl),drawElementsInstancedANGLE:this._gl.drawElementsInstanced.bind(this._gl)},this._extFragDepth=this._gl.getExtension("EXT_frag_depth"),this._extFloatLinear=this._gl.getExtension("OES_texture_float_linear"),this._extColorBufferFloat=this._gl.getExtension("EXT_color_buffer_float"),this.sprites.init(this))}supportedExtensions(){return{supportsAIA:!!this._extInstanced,supportsImposters:!!this._extFragDepth||!this.isWebGL1(),regen:!1}}getContext(){return this._gl}getCanvas(){return this._canvas}isLost(){return this._gl==null||this._gl.isContextLost()}getPrecision(){return this._precision}setClearColorHex(_,ne){this._clearColor.setHex(_),this._clearAlpha=ne,this.isLost()||this._gl.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearAlpha)}enableOutline(_){this._outlineMaterial=new xr(_),this._outlineSphereImposterMaterial=new Rr(_),this._outlineStickImposterMaterial=new wi(_),this._outlineEnabled=!0}disableOutline(){this._outlineEnabled=!1}enableAmbientOcclusion(_){_&&(_.strength&&(this._AOstrength=_.strength),_.scale&&(this._AOradius=_.scale)),this._AOEnabled=this._AOstrength>0}disableAmbientOcclusion(){this._AOEnabled=!1}setViewport(){if(this._offscreen&&(this._offscreen.width=this._canvas.width,this._offscreen.height=this._canvas.height),this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null&&!this.isLost()){var _=this._gl.drawingBufferWidth/this.cols,ne=this._gl.drawingBufferHeight/this.rows;this._viewportWidth=_,this._viewportHeight=ne,this._gl.enable(this._gl.SCISSOR_TEST),this._gl.scissor(_*this.col,ne*this.row,_,ne),this._gl.viewport(_*this.col,ne*this.row,_,ne)}}setSize(_,ne){this.devicePixelRatio=window.devicePixelRatio!==void 0?window.devicePixelRatio:1,this._upscale&&this.devicePixelRatio<2&&(this.devicePixelRatio=2),this._canvas.width=_*this.devicePixelRatio,this._canvas.height=ne*this.devicePixelRatio,this._canvas.style.width=_+"px",this._canvas.style.height=ne+"px",this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null?(this.isLost()||(this._viewportWidth=this._gl.drawingBufferWidth/this.cols,this._viewportHeight=this._gl.drawingBufferHeight/this.rows),this.setViewport()):(this._viewportWidth=this._canvas.width,this._viewportHeight=this._canvas.height,this.isLost()||this._gl.viewport(0,0,this._gl.drawingBufferWidth,this._gl.drawingBufferHeight)),this.initFrameBuffer()}clear(_,ne,xe){var Ve=0;(_===void 0||_)&&(Ve|=this._gl.COLOR_BUFFER_BIT),(ne===void 0||ne)&&(Ve|=this._gl.DEPTH_BUFFER_BIT),(xe===void 0||xe)&&(Ve|=this._gl.STENCIL_BUFFER_BIT),this._gl.clear(Ve)}setMaterialFaces(_,ne){var xe=_.side===u,Ve=_.side===R;_.imposter||(Ve=ne?!Ve:Ve),this._oldDoubleSided!==xe&&(xe?this._gl.disable(this._gl.CULL_FACE):this._gl.enable(this._gl.CULL_FACE),this._oldDoubleSided=xe),this._oldFlipSided!==Ve&&(Ve?this._gl.frontFace(this._gl.CW):this._gl.frontFace(this._gl.CCW),this._oldFlipSided=Ve),this._gl.cullFace(this._gl.BACK)}setDepthTest(_){this._oldDepthTest!==_&&(_?this._gl.enable(this._gl.DEPTH_TEST):this._gl.disable(this._gl.DEPTH_TEST),this._oldDepthTest=_)}setDepthWrite(_){this._oldDepthWrite!==_&&(this._gl.depthMask(_),this._oldDepthWrite=_)}setBlending(_){_?(this._gl.enable(this._gl.BLEND),this._gl.blendEquationSeparate(this._gl.FUNC_ADD,this._gl.FUNC_ADD),this._gl.blendFuncSeparate(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA)):this._gl.disable(this._gl.BLEND)}initMaterial(_,ne,xe,Ve){var Oe,yt;if(_.addEventListener("dispose",this.onMaterialDispose.bind(this)),yt=_.shaderID){var lt=Zr[yt];_.vertexShader=lt.vertexShader,_.fragmentShader=lt.fragmentShader,_.uniforms=yi.clone(lt.uniforms),_.shaded&&_.makeShaded(this.SHADE_TEXTURE)}Oe={wireframe:_.wireframe,fragdepth:_.imposter,volumetric:_.volumetric,shaded:_.shaded},_.program=this.buildProgram(_.fragmentShader,_.vertexShader,_.uniforms,Oe)}renderBuffer(_,ne,xe,Ve,Oe,yt){var lt,mt;if(Ve.visible&&(lt=this.setProgram(_,ne,xe,Ve,yt,this))){mt=lt.attributes;var Mt,Pt,Ot=!1,gr=Ve.wireframe?1:0,Zt=16777215*Oe.id+2*lt.id+gr;if(Zt!==this._currentGeometryGroupHash&&(this._currentGeometryGroupHash=Zt,Ot=!0),Ot&&(this.disableAttributes(),mt.position>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,Oe.__webglVertexBuffer),this.enableAttribute(mt.position),this._gl.vertexAttribPointer(mt.position,3,this._gl.FLOAT,!1,0,0)),mt.color>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,Oe.__webglColorBuffer),this.enableAttribute(mt.color),this._gl.vertexAttribPointer(mt.color,3,this._gl.FLOAT,!1,0,0)),mt.normal>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,Oe.__webglNormalBuffer),this.enableAttribute(mt.normal),this._gl.vertexAttribPointer(mt.normal,3,this._gl.FLOAT,!1,0,0)),mt.offset>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,Oe.__webglOffsetBuffer),this.enableAttribute(mt.offset),this._gl.vertexAttribPointer(mt.offset,3,this._gl.FLOAT,!1,0,0)),mt.radius>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,Oe.__webglRadiusBuffer),this.enableAttribute(mt.radius),this._gl.vertexAttribPointer(mt.radius,1,this._gl.FLOAT,!1,0,0))),yt instanceof Le){if(Ve.shaderID==="instanced"){var Ar=Ve.sphere.geometryGroups[0];Ot&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,Oe.__webglVertexBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,Ar.vertexArray,this._gl.STATIC_DRAW),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,Oe.__webglNormalBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,Ar.normalArray,this._gl.STATIC_DRAW),this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,Oe.__webglFaceBuffer),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,Ar.faceArray,this._gl.STATIC_DRAW)),Mt=Ar.faceidx,this._extInstanced.vertexAttribDivisorANGLE(mt.offset,1),this._extInstanced.vertexAttribDivisorANGLE(mt.radius,1),this._extInstanced.vertexAttribDivisorANGLE(mt.color,1),this._extInstanced.drawElementsInstancedANGLE(this._gl.TRIANGLES,Mt,this._gl.UNSIGNED_SHORT,0,Oe.radiusArray.length),this._extInstanced.vertexAttribDivisorANGLE(mt.offset,0),this._extInstanced.vertexAttribDivisorANGLE(mt.radius,0),this._extInstanced.vertexAttribDivisorANGLE(mt.color,0)}else Ve.wireframe?(Pt=Oe.lineidx,this.setLineWidth(Ve.wireframeLinewidth),Ot&&this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,Oe.__webglLineBuffer),this._gl.drawElements(this._gl.LINES,Pt,this._gl.UNSIGNED_SHORT,0)):(Mt=Oe.faceidx,Ot&&this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,Oe.__webglFaceBuffer),this._gl.drawElements(this._gl.TRIANGLES,Mt,this._gl.UNSIGNED_SHORT,0));this.info.render.calls++,this.info.render.vertices+=Mt,this.info.render.faces+=Mt/3}else yt instanceof Se&&(Pt=Oe.vertices,this.setLineWidth(Ve.linewidth),this._gl.drawArrays(this._gl.LINES,0,Pt),this.info.render.calls++)}}clearShading(){this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this.clear(!1,!0,!1),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._depthTexture,0)}setShading(_,ne,xe){let Ve=_.__lights,Oe=_.fog,yt=[];for(let Mt=0,Pt=_.__webglObjects.length;Mt<Pt;Mt++){let Ot=_.__webglObjects[Mt];Ot.render&&Ot[xe]&&yt.push(Ot)}if(yt.length==0)return;this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,null,0),this.renderObjects(_.__webglObjects,!0,xe+"Depth",ne,Ve,Oe,!1),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._scratchTexture,0),this.clear(!1,!0,!1),this._gl.useProgram(this._AOshader),this._currentProgram=this._AOshader,this.setDepthTest(-1),this.setDepthWrite(-1);let lt=this._AOshader.uniforms;this._gl.uniform1f(lt.total_strength,this._AOstrength),this._gl.uniform1f(lt.radius,this._AOradius),this._fullProjModelMatrix=new m.Matrix4,this._fullProjModelMatrixInv=new m.Matrix4;let mt=yt[0].object;this._fullProjModelMatrix.multiplyMatrices(ne.projectionMatrix,mt._modelViewMatrix),this._fullProjModelMatrixInv.getInverse(this._fullProjModelMatrix),this._gl.uniformMatrix4fv(lt.projectionMatrix,!1,this._fullProjModelMatrix.elements),this._gl.uniformMatrix4fv(lt.projinv,!1,this._fullProjModelMatrixInv.elements),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.enableVertexAttribArray(this._aovertexattribpos),this._gl.vertexAttribPointer(this._aovertexattribpos,2,this._gl.FLOAT,!1,0,0),this._gl.activeTexture(this._gl.TEXTURE0),this._gl.bindTexture(this._gl.TEXTURE_2D,this._shadingTexture),this._gl.drawArrays(this._gl.TRIANGLES,0,6),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this.clear(!1,!0,!1),this._gl.useProgram(this._blurshader),this._currentProgram=this._blurshader,this.setDepthTest(-1),this.setDepthWrite(-1),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.enableVertexAttribArray(this._blurvertexattribpos),this._gl.vertexAttribPointer(this._blurvertexattribpos,2,this._gl.FLOAT,!1,0,0),this._gl.activeTexture(this._gl.TEXTURE0),this._gl.bindTexture(this._gl.TEXTURE_2D,this._scratchTexture),this._gl.drawArrays(this._gl.TRIANGLES,0,6),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,this._targetTexture,0),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._depthTexture,0)}render(_,ne){if(ne instanceof Wi==0)return void console.error("Renderer.render: camera is not an instance of Camera.");var xe,Ve,Oe,yt,lt,mt=_.__lights,Mt=_.fog;if(this._currentMaterialId=-1,this._lightsNeedUpdate=!0,this.autoUpdateScene&&_.updateMatrixWorld(),ne.parent===void 0&&ne.updateMatrixWorld(),ne.matrixWorldInverse.getInverse(ne.matrixWorld),this.isLost())return;this.autoUpdateObjects&&this.initWebGLObjects(_),this.info.render.calls=0,this.info.render.vertices=0,this.info.render.faces=0,this.info.render.points=0,this._currentWidth=this._viewportWidth,this._currentHeight=this._viewportHeight,this.setViewport(),this.setFrameBuffer(),this._gl.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearAlpha),this.clear(!0,!0,!0),lt=_.__webglObjects;let Pt=!1,Ot=this._AOEnabled;for(xe=0,Ve=lt.length;xe<Ve;xe++)yt=(Oe=lt[xe]).object,Oe.render=!1,yt.visible&&(this.setupMatrices(yt,ne),this.unrollBufferMaterial(Oe),Oe.render=!0,Oe.volumetric&&(Pt=!0),Oe.hasAO&&(Ot=!0));if(this.setBlending(!1),Ot&&this.setShading(_,ne,"opaque"),this.renderObjects(_.__webglObjects,!0,"opaque",ne,mt,Mt,!1),Ot&&this.clearShading(),this.renderSprites(_,ne,!1),this.renderObjects(_.__webglObjects,!0,"transparentDepth",ne,mt,Mt,!0),this.renderObjects(_.__webglObjects,!1,"transparent",ne,mt,Mt,!0),Pt&&this._fb&&(this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,null,0),this.renderObjects(_.__webglObjects,!1,"volumetric",ne,mt,Mt,!0)),this.renderFrameBuffertoScreen(),this.setDepthTest(!0),this.setDepthWrite(!0),this.renderSprites(_,ne,!0),this._bitmap){const gr=this._offscreen.transferToImageBitmap();this._bitmap.transferFromImageBitmap(gr),gr.close()}}setFrameBuffer(){if(this.isWebGL1()||!this._fb)return;let _=this._viewportWidth,ne=this._viewportHeight;this._gl.enable(this._gl.SCISSOR_TEST),this._gl.scissor(0,0,_,ne),this._gl.viewport(0,0,_,ne),this._gl.bindTexture(this._gl.TEXTURE_2D,this._targetTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.RGBA,_,ne,0,this._gl.RGBA,this._gl.UNSIGNED_BYTE,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.LINEAR),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.LINEAR),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.bindTexture(this._gl.TEXTURE_2D,this._depthTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.DEPTH_COMPONENT32F,_,ne,0,this._gl.DEPTH_COMPONENT,this._gl.FLOAT,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._shadingTexture&&(this._gl.deleteTexture(this._shadingTexture),this._shadingTexture=this._gl.createTexture(),this._gl.bindTexture(this._gl.TEXTURE_2D,this._shadingTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.DEPTH_COMPONENT32F,_,ne,0,this._gl.DEPTH_COMPONENT,this._gl.FLOAT,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.deleteTexture(this._scratchTexture),this._scratchTexture=this._gl.createTexture(),this._gl.bindTexture(this._gl.TEXTURE_2D,this._scratchTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.DEPTH_COMPONENT32F,_,ne,0,this._gl.DEPTH_COMPONENT,this._gl.FLOAT,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE)),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,this._fb),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,this._targetTexture,0),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this._gl.clearDepth(1),this._gl.clear(this._gl.DEPTH_BUFFER_BIT),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._depthTexture,0)}initFrameBuffer(){if(this.isWebGL1())return;let _=this._viewportWidth,ne=this._viewportHeight;this._gl.enable(this._gl.SCISSOR_TEST),this._gl.scissor(0,0,_,ne),this._gl.viewport(0,0,_,ne),this._targetTexture=this._gl.createTexture(),this._depthTexture=this._gl.createTexture(),this._shadingTexture=this._gl.createTexture(),this._scratchTexture=this._gl.createTexture(),this._fb=this._gl.createFramebuffer();var xe=this._antialias?Zr.screenaa:Zr.screen;this._screenshader=this.buildProgram(xe.fragmentShader,xe.vertexShader,xe.uniforms,{}),this._vertexattribpos=this._gl.getAttribLocation(this._screenshader,"vertexPosition"),this._screenQuadVBO=this._gl.createBuffer(),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array([1,1,-1,1,-1,-1,-1,-1,1,-1,1,1]),this._gl.STATIC_DRAW);let Ve=Zr.ssao;this._AOshader=this.buildProgram(Ve.fragmentShader,Ve.vertexShader,Ve.uniforms,{}),this._aovertexattribpos=this._gl.getAttribLocation(this._AOshader,"vertexPosition");let Oe=Zr.blur;this._blurshader=this.buildProgram(Oe.fragmentShader,Oe.vertexShader,Oe.uniforms,{}),this._blurvertexattribpos=this._gl.getAttribLocation(this._blurshader,"vertexPosition")}renderFrameBuffertoScreen(){this.isWebGL1()||this._fb===null||(this.setViewport(),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null),this._gl.clear(this._gl.COLOR_BUFFER_BIT|this._gl.DEPTH_BUFFER_BIT),this._gl.frontFace(this._gl.CCW),this._gl.cullFace(this._gl.BACK),this._gl.useProgram(this._screenshader),this._currentProgram=this._screenshader,this.setDepthTest(-1),this.setDepthWrite(-1),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.enableVertexAttribArray(this._vertexattribpos),this._gl.vertexAttribPointer(this._vertexattribpos,2,this._gl.FLOAT,!1,0,0),this._gl.activeTexture(this._gl.TEXTURE0),this._gl.bindTexture(this._gl.TEXTURE_2D,this._targetTexture),this._gl.drawArrays(this._gl.TRIANGLES,0,6))}initWebGLObjects(_){if(_.__webglObjects||(_.__webglObjects=[],_.__webglObjectsImmediate=[],_.__webglSprites=[],_.__webglFlares=[]),_.__objectsAdded.length){for(;_.__objectsAdded.length;)this.addObject(_.__objectsAdded[0],_),_.__objectsAdded.splice(0,1);this._currentGeometryGroupHash=-1}for(;_.__objectsRemoved.length;)this.removeObject(_.__objectsRemoved[0],_),_.__objectsRemoved.splice(0,1);for(var ne=0,xe=_.__webglObjects.length;ne<xe;ne++)this.updateObject(_.__webglObjects[ne].object)}getYRatio(){return this.rows!==void 0&&this.row!==void 0?this.rows:1}getXRatio(){return this.cols!==void 0&&this.col!==void 0?this.cols:1}getAspect(_,ne){_!=null&&ne!=null||(_=this._canvas.width,ne=this._canvas.height);var xe=_/ne;return this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null&&(xe=_/this.cols/(ne/this.rows)),xe}setTexture(_,ne,xe){if(_.needsUpdate){_.__webglInit||(_.__webglInit=!0,_.addEventListener("dispose",this.onTextureDispose.bind(this)),_.__webglTexture=this._gl.createTexture(),this.info.memory.textures++),this._gl.activeTexture(this._gl.TEXTURE0+ne);var Ve=xe?this._gl.TEXTURE_3D:this._gl.TEXTURE_2D;this._gl.bindTexture(Ve,_.__webglTexture),this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL,_.flipY),this._gl.pixelStorei(this._gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,_.premultiplyAlpha),this._gl.pixelStorei(this._gl.UNPACK_ALIGNMENT,_.unpackAlignment),this._gl.pixelStorei(this._gl.PACK_ALIGNMENT,_.unpackAlignment);var Oe=this.paramToGL(_.format),yt=this.paramToGL(_.type);if(xe)this.setTextureParameters(this._gl.TEXTURE_3D,_),this._gl.texImage3D(this._gl.TEXTURE_3D,0,this._gl.R32F,_.image.size.z,_.image.size.y,_.image.size.x,0,this._gl.RED,this._gl.FLOAT,_.image.data);else{var lt=_.image,mt=lt.width,Mt=lt.height;mt===void 0&&(mt=lt.length,Oe==this._gl.RGBA&&(mt/=4),Mt=1),this.setTextureParameters(this._gl.TEXTURE_2D,_),this.isWebGL1()?this._gl.texImage2D(this._gl.TEXTURE_2D,0,Oe,Oe,yt,_.image):this._gl.texImage2D(this._gl.TEXTURE_2D,0,Oe,mt,Mt,0,Oe,yt,_.image)}_.needsUpdate=!1,_.onUpdate&&_.onUpdate()}else this._gl.activeTexture(this._gl.TEXTURE0+ne),xe?this._gl.bindTexture(this._gl.TEXTURE_3D,_.__webglTexture):this._gl.bindTexture(this._gl.TEXTURE_2D,_.__webglTexture)}supportsVolumetric(){return!this.isWebGL1()}enableAttribute(_){this._enabledAttributes[_]||(this._gl.enableVertexAttribArray(_),this._enabledAttributes[_]=!0)}disableAttributes(){for(let _ in this._enabledAttributes)this._enabledAttributes[_]&&(this._gl.disableVertexAttribArray(_),this._enabledAttributes[_]=!1)}setPolygonOffset(_,ne,xe){this._oldPolygonOffset!==_&&(_?this._gl.enable(this._gl.POLYGON_OFFSET_FILL):this._gl.disable(this._gl.POLYGON_OFFSET_FILL))}setLineWidth(_){_!==this._oldLineWidth&&(this._gl.lineWidth(_),this._oldLineWidth=_)}deallocateGeometry(_){if(_.__webglInit=void 0,_.__webglVertexBuffer!==void 0&&this._gl.deleteBuffer(_.__webglVertexBuffer),_.__webglColorBuffer!==void 0&&this._gl.deleteBuffer(_.__webglColorBuffer),_.geometryGroups!==void 0)for(var ne=0,xe=_.groups;ne<xe;ne++){var Ve=_.geometryGroups[ne];Ve.__webglVertexBuffer!==void 0&&this._gl.deleteBuffer(Ve.__webglVertexBuffer),Ve.__webglColorBuffer!==void 0&&this._gl.deleteBuffer(Ve.__webglColorBuffer),Ve.__webglNormalBuffer!==void 0&&this._gl.deleteBuffer(Ve.__webglNormalBuffer),Ve.__webglFaceBuffer!==void 0&&this._gl.deleteBuffer(Ve.__webglFaceBuffer),Ve.__webglLineBuffer!==void 0&&this._gl.deleteBuffer(Ve.__webglLineBuffer)}}deallocateMaterial(_){var ne=_.program;if(ne!==void 0){var xe,Ve,Oe;_.program=void 0;var yt=!1;for(xe=0,Ve=this._programs.length;xe<Ve;xe++)if((Oe=this._programs[xe]).program===ne){Oe.usedTimes--,Oe.usedTimes===0&&(yt=!0);break}if(yt===!0){var lt=[];for(xe=0,Ve=this._programs.length;xe<Ve;xe++)(Oe=this._programs[xe]).program!==ne&&lt.push(Oe);this._programs=lt,this._gl.deleteProgram(ne),this.info.memory.programs--}}}deallocateTexture(_){if(_.image&&_.image.__webglTextureCube)this._gl.deleteTexture(_.image.__webglTextureCube);else{if(!_.__webglInit)return;_.__webglInit=!1,this._gl.deleteTexture(_.__webglTexture)}}onGeometryDispose(_){var ne=_.target;ne.removeEventListener("dispose",this.onGeometryDispose),this.deallocateGeometry(ne),this.info.memory.geometries--}onTextureDispose(_){var ne=_.target;ne.removeEventListener("dispose",this.onTextureDispose),this.deallocateTexture(ne),this.info.memory.textures--}onMaterialDispose(_){var ne=_.target;ne.removeEventListener("dispose",this.onMaterialDispose),this.deallocateMaterial(ne)}getShader(_,ne){var xe;return this.isWebGL1()||ne.startsWith("#version")||(ne=ne.replace(/gl_FragDepthEXT/g,"gl_FragDepth"),ne=`#version 300 es
`+(ne=(ne=(ne=(ne=(ne=_=="fragment"?ne.replace(/varying/g,"in"):ne.replace(/varying/g,"out")).replace(/attribute/g,"in")).replace(/texture2D/g,"texture")).replace(/\/\/DEFINEFRAGCOLOR/g,"out vec4 glFragColor;")).replace(/gl_FragColor/g,"glFragColor"))),_==="fragment"?xe=this._gl.createShader(this._gl.FRAGMENT_SHADER):_==="vertex"&&(xe=this._gl.createShader(this._gl.VERTEX_SHADER)),xe==null?null:(this._gl.shaderSource(xe,ne),this._gl.compileShader(xe),this._gl.getShaderParameter(xe,this._gl.COMPILE_STATUS)?xe:(console.error(this._gl.getShaderInfoLog(xe)),console.error("could not initialize shader"),null))}buildProgram(_,ne,xe,Ve){var Oe,yt,lt,mt,Mt=[];for(Oe in Mt.push(_),Mt.push(ne),Ve)Mt.push(Oe),Mt.push(Ve[Oe]);for(mt=Mt.join(),Oe=0,yt=this._programs.length;Oe<yt;Oe++){var Pt=this._programs[Oe];if(Pt.code===mt)return Pt.usedTimes++,Pt.program}if(this.isWebGL1()&&Ve.volumetric)throw new Error("Volumetric rendering requires webgl2 which is not supported by your hardware.");if((lt=this._gl.createProgram())==null)return null;var Ot,gr,Zt,Ar="precision "+this._precision+" float;",Cr=[Ve.volumetric?"#version 300 es":"",Ar].join(`
`),Ur=[Ve.volumetric?"#version 300 es":"",Ve.fragdepth&&this.isWebGL1()?"#extension GL_EXT_frag_depth: enable":"",Ve.shaded?"#define SHADED 1":"",Ve.wireframe?"#define WIREFRAME 1":"",Ar].join(`
`),_r=this.getShader("fragment",Ur+_),Or=this.getShader("vertex",Cr+ne);for(gr in Or!=null&&this._gl.attachShader(lt,Or),_r!=null&&this._gl.attachShader(lt,_r),this._gl.linkProgram(lt),this._gl.getProgramParameter(lt,this._gl.LINK_STATUS)||console.error("Could not initialize shader"),lt.uniforms={},lt.attributes={},Ot=["viewMatrix","modelViewMatrix","projectionMatrix","normalMatrix","vWidth","vHeight"],xe)Ot.push(gr);for(Zt=0;Zt<Ot.length;Zt++){var wr=Ot[Zt];lt.uniforms[wr]=this._gl.getUniformLocation(lt,wr)}for(Ot=["position","normal","color","lineDistance","offset","radius"],Zt=0;Zt<Ot.length;Zt++){var Mi=Ot[Zt];lt.attributes[Mi]=this._gl.getAttribLocation(lt,Mi)}return lt.id=this._programs_counter++,this._programs.push({program:lt,code:mt,usedTimes:1}),this.info.memory.programs=this._programs.length,lt}setProgram(_,ne,xe,Ve,Oe,yt){if(Ve.needsUpdate&&(Ve.program&&this.deallocateMaterial(Ve),this.initMaterial(Ve,ne,xe,Oe),Ve.needsUpdate=!1),Ve.program==null)return null;var lt=!1,mt=Ve.program,Mt=mt.uniforms,Pt=Ve.uniforms;if(mt!=this._currentProgram&&(this._gl.useProgram(mt),this._currentProgram=mt,lt=!0),Ve.id!=this._currentMaterialId&&(this._currentMaterialId=Ve.id,lt=!0),_!=this._currentCamera&&(this._currentCamera=_,lt=!0),Mt.projectionMatrix&&this._gl.uniformMatrix4fv(Mt.projectionMatrix,!1,_.projectionMatrix.elements),Mt.modelViewMatrix&&this._gl.uniformMatrix4fv(Mt.modelViewMatrix,!1,Oe._modelViewMatrix.elements),Mt.normalMatrix&&this._gl.uniformMatrix3fv(Mt.normalMatrix,!1,Oe._normalMatrix.elements),Mt.projinv&&(this._projInverse.getInverse(_.projectionMatrix),this._gl.uniformMatrix4fv(Mt.projinv,!1,this._projInverse.elements)),Mt.viewMatrix&&this._gl.uniformMatrix4fv(Mt.viewMatrix,!1,_.matrixWorldInverse.elements),Mt.vWidth&&this._gl.uniform1f(Mt.vWidth,this._viewportWidth),Mt.vHeight&&this._gl.uniform1f(Mt.vHeight,this._viewportHeight),lt){if(Pt.fogColor.value=xe.color,Pt.fogNear.value=xe.near,Pt.fogFar.value=xe.far,Ve.shaderID.startsWith("lambert")||Ve.shaderID==="instanced"||Ve.shaderID.endsWith("imposter"))this._lightsNeedUpdate&&(this.setupLights(mt,ne),this._lightsNeedUpdate=!1),Pt.directionalLightColor.value=this._lights.directional.colors,Pt.directionalLightDirection.value=this._lights.directional.positions;else if(Ve.shaderID.endsWith("outline"))Pt.outlineColor.value=Ve.outlineColor,Pt.outlineWidth.value=Ve.outlineWidth,Pt.outlinePushback.value=Ve.outlinePushback,Pt.outlineMaxPixels.value=Ve.outlineMaxPixels*this.devicePixelRatio;else if(Ve.shaderID==="volumetric"){Oe._modelViewMatrix.getScale(this._direction),this._worldInverse.getInverse(Oe._modelViewMatrix),this._projInverse.getInverse(_.projectionMatrix),this._textureMatrix.multiplyMatrices(Oe.material.texmatrix,this._worldInverse),this._gl.uniformMatrix4fv(Mt.textmat,!1,this._textureMatrix.elements),this._gl.uniformMatrix4fv(Mt.projinv,!1,this._projInverse.elements);let Ot=Math.min(Math.min(this._direction.x,this._direction.y),this._direction.z);Pt.step.value=Oe.material.unit*Ot,Pt.maxdepth.value=Oe.material.maxdepth*Ot,Pt.transfermax.value=Oe.material.transfermax,Pt.transfermin.value=Oe.material.transfermin,Pt.subsamples.value=Oe.material.subsamples,yt.setTexture(Oe.material.transferfn,4,!1),yt.setTexture(Oe.material.map,3,!0),this._gl.activeTexture(this._gl.TEXTURE5),this._gl.bindTexture(this._gl.TEXTURE_2D,this._depthTexture)}Pt.opacity.value=Ve.opacity,this.loadMaterialUniforms(Mt,Pt)}return Pt.shading&&(Pt.shading.value==3?(this._gl.activeTexture(this._gl.TEXTURE0+this.SHADE_TEXTURE),this._gl.bindTexture(this._gl.TEXTURE_2D,this._shadingTexture)):console.error("Invalid shading textures.")),mt}loadMaterialUniforms(_,ne){var xe,Ve,Oe,yt;for(xe in ne)_[xe]&&(Ve=ne[xe].type,Oe=ne[xe].value,yt=_[xe],Ve==="f"?this._gl.uniform1f(yt,Oe):Ve==="i"?this._gl.uniform1i(yt,Oe):Ve==="fv"?this._gl.uniform3fv(yt,Oe):Ve==="c"?this._gl.uniform3f(yt,Oe.r,Oe.g,Oe.b):Ve==="f4"&&this._gl.uniform4f(yt,Oe[0],Oe[1],Oe[2],Oe[3]))}addObject(_,ne){var xe,Ve,Oe,yt;if(!_.__webglInit&&(_.__webglInit=!0,_._modelViewMatrix=new m.Matrix4,_._normalMatrix=new m.Matrix3,_.geometry!==void 0&&_.geometry.__webglInit===void 0&&(_.geometry.__webglInit=!0,_.geometry.addEventListener("dispose",this.onGeometryDispose.bind(this))),_ instanceof Le||_ instanceof Se))for(xe=0,Ve=(Oe=_.geometry).geometryGroups.length;xe<Ve;xe++)(yt=Oe.geometryGroups[xe]).id=this._geometryGroupCounter++,yt.__webglVertexBuffer||(_ instanceof Le?(this.createMeshBuffers(yt),Oe.elementsNeedUpdate=!0,Oe.normalsNeedUpdate=!0):_ instanceof Se&&this.createLineBuffers(yt),Oe.verticesNeedUpdate=!0,Oe.colorsNeedUpdate=!0);if(!_.__webglActive){if(_ instanceof Le||_ instanceof Se)for(xe=0,Ve=(Oe=_.geometry).geometryGroups.length;xe<Ve;xe++)yt=Oe.geometryGroups[xe],this.addBuffer(ne.__webglObjects,yt,_);else _ instanceof dt&&ne.__webglSprites.push(_);_.__webglActive=!0}}updateObject(_){var ne,xe=_.geometry;if(_ instanceof Le||_ instanceof Se){for(var Ve=0,Oe=xe.geometryGroups.length;Ve<Oe;Ve++)ne=xe.geometryGroups[Ve],(xe.verticesNeedUpdate||xe.elementsNeedUpdate||xe.colorsNeedUpdate||xe.normalsNeedUpdate)&&this.setBuffers(ne,this._gl.STATIC_DRAW);xe.verticesNeedUpdate=!1,xe.elementsNeedUpdate=!1,xe.normalsNeedUpdate=!1,xe.colorsNeedUpdate=!1,xe.buffersNeedUpdate=!1}}removeObject(_,ne){_ instanceof Le||_ instanceof Se?this.removeInstances(ne.__webglObjects,_):_ instanceof dt&&this.removeInstancesDirect(ne.__webglSprites,_),_.__webglActive=!1}removeInstances(_,ne){for(var xe=_.length-1;xe>=0;--xe)_[xe].object===ne&&_.splice(xe,1)}removeInstancesDirect(_,ne){for(var xe=_.length-1;xe>=0;--xe)_[xe]===ne&&_.splice(xe,1)}unrollBufferMaterial(_){var ne=_.object.material;if(ne.volumetric)_.opaque=null,_.transparent=null,_.volumetric=ne;else if(ne.transparent){if(_.opaque=null,_.volumetric=null,_.transparent=ne,!ne.wireframe){let xe=ne.clone();xe.opacity=0,_.transparentDepth=xe}}else{if(_.opaque=ne,_.transparent=null,_.volumetric=null,!ne.wireframe){let xe=ne.clone();xe.opacity=0,_.opaqueDepth=xe}ne.hasAO&&(_.hasAO=!0),(this._AOEnabled||_.hasAO)&&(_.opaqueShaded=ne.clone(),_.opaqueShaded.shaded=!0)}}setBuffers(_,ne){var xe=_.vertexArray,Ve=_.colorArray;if(_.__webglOffsetBuffer!==void 0?(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,_.__webglOffsetBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,xe,ne)):(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,_.__webglVertexBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,xe,ne)),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,_.__webglColorBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,Ve,ne),_.normalArray&&_.__webglNormalBuffer!==void 0){var Oe=_.normalArray;this._gl.bindBuffer(this._gl.ARRAY_BUFFER,_.__webglNormalBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,Oe,ne)}if(_.radiusArray&&_.__webglRadiusBuffer!==void 0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,_.__webglRadiusBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,_.radiusArray,ne)),_.faceArray&&_.__webglFaceBuffer!==void 0){var yt=_.faceArray;this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,_.__webglFaceBuffer),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,yt,ne)}if(_.lineArray&&_.__webglLineBuffer!==void 0){var lt=_.lineArray;this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,_.__webglLineBuffer),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,lt,ne)}}createMeshBuffers(_){_.radiusArray&&(_.__webglRadiusBuffer=this._gl.createBuffer()),_.useOffset&&(_.__webglOffsetBuffer=this._gl.createBuffer()),_.__webglVertexBuffer=this._gl.createBuffer(),_.__webglNormalBuffer=this._gl.createBuffer(),_.__webglColorBuffer=this._gl.createBuffer(),_.__webglFaceBuffer=this._gl.createBuffer(),_.__webglLineBuffer=this._gl.createBuffer(),this.info.memory.geometries++}createLineBuffers(_){_.__webglVertexBuffer=this._gl.createBuffer(),_.__webglColorBuffer=this._gl.createBuffer(),this.info.memory.geometries++}addBuffer(_,ne,xe){_.push({buffer:ne,object:xe,opaque:null,transparent:null})}setupMatrices(_,ne){_._modelViewMatrix.multiplyMatrices(ne.matrixWorldInverse,_.matrixWorld),_._normalMatrix.getInverse(_._modelViewMatrix),_._normalMatrix.transpose()}filterFallback(_){return this._gl.LINEAR}setTextureParameters(_,ne){_==this._gl.TEXTURE_2D?(this._gl.texParameteri(_,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(_,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(_,this._gl.TEXTURE_MAG_FILTER,this.filterFallback(ne.magFilter)),this._gl.texParameteri(_,this._gl.TEXTURE_MIN_FILTER,this.filterFallback(ne.minFilter))):(this._gl.texParameteri(_,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(_,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(_,this._gl.TEXTURE_WRAP_R,this._gl.CLAMP_TO_EDGE),this._extColorBufferFloat&&this._extFloatLinear?(this._gl.texParameteri(_,this._gl.TEXTURE_MAG_FILTER,this._gl.LINEAR),this._gl.texParameteri(_,this._gl.TEXTURE_MIN_FILTER,this._gl.LINEAR)):(this._gl.texParameteri(_,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(_,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST)))}paramToGL(_){return _===C?this._gl.UNSIGNED_BYTE:_===Q?this._gl.RGBA:_===k?this._gl.NEAREST:0}setupLights(_,ne){var xe,Ve,Oe,yt,lt,mt=this._lights,Mt=mt.directional.colors,Pt=mt.directional.positions,Ot=0,gr=0;for(xe=0,Ve=ne.length;xe<Ve;xe++)if(yt=(Oe=ne[xe]).color,lt=Oe.intensity,Oe instanceof I){if(this._direction.getPositionFromMatrix(Oe.matrixWorld),this._vector3.getPositionFromMatrix(Oe.target.matrixWorld),this._direction.sub(this._vector3),this._direction.normalize(),this._direction.x===0&&this._direction.y===0&&this._direction.z===0)continue;Pt[gr]=this._direction.x,Pt[gr+1]=this._direction.y,Pt[gr+2]=this._direction.z,Mt[gr]=yt.r*lt,Mt[gr+1]=yt.g*lt,Mt[gr+2]=yt.b*lt,gr+=3,Ot++}mt.ambient[0]=0,mt.ambient[1]=0,mt.ambient[2]=0,mt.directional.length=Ot}initGL(){try{if(!OffscreenCanvas||this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null){if(!(this._gl=this._canvas.getContext("webgl2",{alpha:this._alpha,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer}))&&!(this._gl=this._canvas.getContext("experimental-webgl",{alpha:this._alpha,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer}))&&!(this._gl=this._canvas.getContext("webgl",{alpha:this._alpha,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer})))throw"Error creating WebGL context."}else($r==null||$r.isContextLost())&&(Gr=new OffscreenCanvas(this._canvas.width,this._canvas.height),$r=Gr.getContext("webgl2",{alpha:!0,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer})),this._offscreen=Gr,this._gl=$r,this._bitmap=this._canvas.getContext("bitmaprenderer",{alpha:!0});var _=this._gl.getParameter(this._gl.VERSION);this._webglversion=parseInt(_[6])}catch(ne){console.error(ne)}}isWebGL1(){return this._webglversion==1}setDefaultGLState(){this._gl.clearDepth(1),this._gl.clearStencil(0),this._gl.enable(this._gl.DEPTH_TEST),this._gl.depthFunc(this._gl.LEQUAL),this._gl.frontFace(this._gl.CCW),this._gl.cullFace(this._gl.BACK),this._gl.enable(this._gl.CULL_FACE),this._gl.enable(this._gl.BLEND),this._gl.blendEquation(this._gl.FUNC_ADD),this._gl.blendFunc(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA),this._gl.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearAlpha)}renderObjects(_,ne,xe,Ve,Oe,yt,lt){var mt,Mt,Pt,Ot,gr,Zt,Ar;ne?(gr=_.length-1,Zt=-1,Ar=-1):(gr=0,Zt=_.length,Ar=1);for(var Cr=gr;Cr!==Zt;Cr+=Ar)if((mt=_[Cr]).render){if(Mt=mt.object,Pt=mt.buffer,Ot=mt[xe],(mt.hasAO||this._AOEnabled)&&mt[xe+"Shaded"]&&(Ot=mt[xe+"Shaded"]),!Ot)continue;this.setBlending(lt),this.setDepthTest(Ot.depthTest),this.setDepthWrite(Ot.depthWrite),this.setPolygonOffset(Ot.polygonOffset,Ot.polygonOffsetFactor,Ot.polygonOffsetUnits);var Ur=Mt._modelViewMatrix.isReflected();if(this.setMaterialFaces(Ot,Ur),this.renderBuffer(Ve,Oe,yt,Ot,Pt,Mt),(this._outlineEnabled||Ot.outline)&&!Ot.wireframe&&Ot.shaderID!=="basic"&&Ot.opacity!==0){let _r=this._outlineMaterial;Ot.shaderID=="sphereimposter"?_r=this._outlineSphereImposterMaterial:Ot.shaderID=="stickimposter"&&(_r=this._outlineStickImposterMaterial),this.renderBuffer(Ve,Oe,yt,_r,Pt,Mt)}}}renderSprites(_,ne,xe){this._currentGeometryGroupHash=-1,this._currentProgram=null,this._currentCamera=null,this._oldDepthWrite=-1,this._oldDepthTest=-1,this._oldDoubleSided=-1,this._currentMaterialId=-1,this._oldFlipSided=-1,this._lightsNeedUpdate=!0,this.sprites.render(_,ne,this._currentWidth,this._currentHeight,xe),this._currentGeometryGroupHash=-1,this._currentProgram=null,this._currentCamera=null,this._oldDepthWrite=-1,this._oldDepthTest=-1,this._oldDoubleSided=-1,this._currentMaterialId=-1,this._oldFlipSided=-1}}},392:(r,n,a)=>{a.r(n),a.d(n,{assignBonds:()=>u});var c=a(408);const d=[{x:0,y:0,z:1},{x:0,y:1,z:-1},{x:0,y:1,z:0},{x:0,y:1,z:1},{x:1,y:-1,z:-1},{x:1,y:-1,z:0},{x:1,y:-1,z:1},{x:1,y:0,z:-1},{x:1,y:0,z:0},{x:1,y:0,z:1},{x:1,y:1,z:-1},{x:1,y:1,z:0},{x:1,y:1,z:1}],R=4.95;function u(v,m){for(let x=0,k=v.length;x<k;x++)v[x].index||(v[x].index=x);const b={x:{y:{z:[]}}};for(let x=0;x<v.length;x++){const k=v[x],F=Math.floor(k.x/R),C=Math.floor(k.y/R),z=Math.floor(k.z/R);b[F]||(b[F]={}),b[F][C]||(b[F][C]={}),b[F][C][z]||(b[F][C][z]=[]),b[F][C][z].push(k)}function T(x,k){for(let F=0;F<x.length;F++){const C=x[F];for(let z=0;z<k.length;z++){const Q=k[z];if((0,c.areConnected)(C,Q,m)){const J=C.bonds.indexOf(Q.index),q=Q.bonds.indexOf(C.index);J===-1&&q===-1?(C.bonds.push(Q.index),C.bondOrder.push(1),Q.bonds.push(C.index),Q.bondOrder.push(1)):J===-1?(C.bonds.push(Q.index),C.bondOrder.push(Q.bondOrder[q])):q===-1&&(Q.bonds.push(C.index),Q.bondOrder.push(C.bondOrder[J]))}}}}for(let x in b){const k=parseInt(x);for(let F in b[k]){const C=parseInt(F);for(let z in b[k][C]){const Q=parseInt(z),J=b[k][C][Q];for(let q=0;q<J.length;q++){const w=J[q];for(let N=q+1;N<J.length;N++){const V=J[N];(0,c.areConnected)(w,V,m)&&w.bonds.indexOf(V.index)==-1&&(w.bonds.push(V.index),w.bondOrder.push(1),V.bonds.push(w.index),V.bondOrder.push(1))}}for(let q=0;q<d.length;q++){const w=d[q];b[k+w.x]&&b[k+w.x][C+w.y]&&b[k+w.x][C+w.y][Q+w.z]&&T(J,b[k+w.x][C+w.y][Q+w.z])}}}}}},407:r=>{var n=(function(){for(var a,c=[],d=0;d<256;d++){a=d;for(var R=0;R<8;R++)a=1&a?3988292384^a>>>1:a>>>1;c[d]=a}return c})();r.exports=function(a,c,d,R){var u=n,v=R+d;a^=-1;for(var m=R;m<v;m++)a=a>>>8^u[255&(a^c[m])];return-1^a}},408:(r,n,a)=>{a.r(n),a.d(n,{areConnected:()=>R});var c=a(40);const d=new Set(["Na","K","Ca","Mg","Mn","Sr"]);function R(u,v,m){if(m&&m.unboundCations&&(d.has(u.elem)||d.has(v.elem)))return!1;let b=(0,c.bondLength)(u.elem)+(0,c.bondLength)(v.elem);b+=.25,b*=b;let T=u.x-v.x;if(T*=T,T>b)return!1;let x=u.y-v.y;if(x*=x,x>b)return!1;let k=u.z-v.z;if(k*=k,k>b)return!1;const F=T+x+k;return!(isNaN(F)||F<.5||F>b||u.altLoc!==v.altLoc&&u.altLoc.trim()!==""&&v.altLoc.trim()!=="")}},471:function(r,n){(function(a){function c(pe,Se,Le){for(var dt=(pe.byteLength,0),nt=Le.length;nt>dt;dt++){var zt=Le.charCodeAt(dt);if(128>zt)pe.setUint8(Se++,zt>>>0&127);else if(2048>zt)pe.setUint8(Se++,zt>>>6&31|192),pe.setUint8(Se++,zt>>>0&63|128);else if(65536>zt)pe.setUint8(Se++,zt>>>12&15|224),pe.setUint8(Se++,zt>>>6&63|128),pe.setUint8(Se++,zt>>>0&63|128);else{if(!(1114112>zt))throw new Error("bad codepoint "+zt);pe.setUint8(Se++,zt>>>18&7|240),pe.setUint8(Se++,zt>>>12&63|128),pe.setUint8(Se++,zt>>>6&63|128),pe.setUint8(Se++,zt>>>0&63|128)}}}function d(pe){for(var Se=0,Le=0,dt=pe.length;dt>Le;Le++){var nt=pe.charCodeAt(Le);if(128>nt)Se+=1;else if(2048>nt)Se+=2;else if(65536>nt)Se+=3;else{if(!(1114112>nt))throw new Error("bad codepoint "+nt);Se+=4}}return Se}function R(pe,Se,Le){var dt=typeof pe;if(dt==="string"){if(32>(nt=d(pe)))return Se.setUint8(Le,160|nt),c(Se,Le+1,pe),1+nt;if(256>nt)return Se.setUint8(Le,217),Se.setUint8(Le+1,nt),c(Se,Le+2,pe),2+nt;if(65536>nt)return Se.setUint8(Le,218),Se.setUint16(Le+1,nt),c(Se,Le+3,pe),3+nt;if(4294967296>nt)return Se.setUint8(Le,219),Se.setUint32(Le+1,nt),c(Se,Le+5,pe),5+nt}if(pe instanceof Uint8Array){var nt=pe.byteLength,zt=new Uint8Array(Se.buffer);if(256>nt)return Se.setUint8(Le,196),Se.setUint8(Le+1,nt),zt.set(pe,Le+2),2+nt;if(65536>nt)return Se.setUint8(Le,197),Se.setUint16(Le+1,nt),zt.set(pe,Le+3),3+nt;if(4294967296>nt)return Se.setUint8(Le,198),Se.setUint32(Le+1,nt),zt.set(pe,Le+5),5+nt}if(dt==="number"){if(!isFinite(pe))throw new Error("Number not finite: "+pe);if(Math.floor(pe)!==pe)return Se.setUint8(Le,203),Se.setFloat64(Le+1,pe),9;if(pe>=0){if(128>pe)return Se.setUint8(Le,pe),1;if(256>pe)return Se.setUint8(Le,204),Se.setUint8(Le+1,pe),2;if(65536>pe)return Se.setUint8(Le,205),Se.setUint16(Le+1,pe),3;if(4294967296>pe)return Se.setUint8(Le,206),Se.setUint32(Le+1,pe),5;throw new Error("Number too big 0x"+pe.toString(16))}if(pe>=-32)return Se.setInt8(Le,pe),1;if(pe>=-128)return Se.setUint8(Le,208),Se.setInt8(Le+1,pe),2;if(pe>=-32768)return Se.setUint8(Le,209),Se.setInt16(Le+1,pe),3;if(pe>=-2147483648)return Se.setUint8(Le,210),Se.setInt32(Le+1,pe),5;throw new Error("Number too small -0x"+(-pe).toString(16).substr(1))}if(pe===null)return Se.setUint8(Le,192),1;if(dt==="boolean")return Se.setUint8(Le,pe?195:194),1;if(dt==="object"){var ht=0,Lt=Array.isArray(pe);if(Lt)nt=pe.length;else{var Ut=Object.keys(pe);nt=Ut.length}if(16>nt?(Se.setUint8(Le,nt|(Lt?144:128)),ht=1):65536>nt?(Se.setUint8(Le,Lt?220:222),Se.setUint16(Le+1,nt),ht=3):4294967296>nt&&(Se.setUint8(Le,Lt?221:223),Se.setUint32(Le+1,nt),ht=5),Lt)for(var It=0;nt>It;It++)ht+=R(pe[It],Se,Le+ht);else for(It=0;nt>It;It++){var mr=Ut[It];ht+=R(mr,Se,Le+ht),ht+=R(pe[mr],Se,Le+ht)}return ht}throw new Error("Unknown type "+dt)}function u(pe){var Se=typeof pe;if(Se==="string"){if(32>(Le=d(pe)))return 1+Le;if(256>Le)return 2+Le;if(65536>Le)return 3+Le;if(4294967296>Le)return 5+Le}if(pe instanceof Uint8Array){if(256>(Le=pe.byteLength))return 2+Le;if(65536>Le)return 3+Le;if(4294967296>Le)return 5+Le}if(Se==="number"){if(Math.floor(pe)!==pe)return 9;if(pe>=0){if(128>pe)return 1;if(256>pe)return 2;if(65536>pe)return 3;if(4294967296>pe)return 5;throw new Error("Number too big 0x"+pe.toString(16))}if(pe>=-32)return 1;if(pe>=-128)return 2;if(pe>=-32768)return 3;if(pe>=-2147483648)return 5;throw new Error("Number too small -0x"+pe.toString(16).substr(1))}if(Se==="boolean"||pe===null)return 1;if(Se==="object"){var Le,dt=0;if(Array.isArray(pe)){Le=pe.length;for(var nt=0;Le>nt;nt++)dt+=u(pe[nt])}else{var zt=Object.keys(pe);for(Le=zt.length,nt=0;Le>nt;nt++){var ht=zt[nt];dt+=u(ht)+u(pe[ht])}}if(16>Le)return 1+dt;if(65536>Le)return 3+dt;if(4294967296>Le)return 5+dt;throw new Error("Array or object too long 0x"+Le.toString(16))}throw new Error("Unknown type "+Se)}function v(pe){var Se=new ArrayBuffer(u(pe));return R(pe,new DataView(Se),0),new Uint8Array(Se)}function m(pe,Se,Le){return Se?new pe(Se.buffer,Se.byteOffset,Se.byteLength/(Le||1)):void 0}function b(pe){return m(DataView,pe)}function T(pe){return m(Uint8Array,pe)}function x(pe){return m(Int8Array,pe)}function k(pe){return m(Int32Array,pe,4)}function F(pe){return m(Float32Array,pe,4)}function C(pe,Se){var Le=pe.length/2;Se||(Se=new Int16Array(Le));for(var dt=0,nt=0;Le>dt;++dt,nt+=2)Se[dt]=pe[nt]<<8^pe[nt+1];return Se}function z(pe,Se){var Le=pe.length;Se||(Se=new Uint8Array(2*Le));for(var dt=b(Se),nt=0;Le>nt;++nt)dt.setInt16(2*nt,pe[nt]);return T(Se)}function Q(pe,Se){var Le=pe.length/4;Se||(Se=new Int32Array(Le));for(var dt=0,nt=0;Le>dt;++dt,nt+=4)Se[dt]=pe[nt]<<24^pe[nt+1]<<16^pe[nt+2]<<8^pe[nt+3];return Se}function J(pe,Se){var Le=pe.length;Se||(Se=new Uint8Array(4*Le));for(var dt=b(Se),nt=0;Le>nt;++nt)dt.setInt32(4*nt,pe[nt]);return T(Se)}function q(pe,Se){var Le=pe.length;Se||(Se=new Float32Array(Le/4));for(var dt=b(Se),nt=b(pe),zt=0,ht=0,Lt=Le/4;Lt>zt;++zt,ht+=4)dt.setFloat32(ht,nt.getFloat32(ht),!0);return Se}function w(pe,Se,Le){var dt=pe.length,nt=1/Se;Le||(Le=new Float32Array(dt));for(var zt=0;dt>zt;++zt)Le[zt]=pe[zt]*nt;return Le}function N(pe,Se,Le){var dt=pe.length;Le||(Le=new Int32Array(dt));for(var nt=0;dt>nt;++nt)Le[nt]=Math.round(pe[nt]*Se);return Le}function V(pe,Se){var Le,dt;if(!Se){var nt=0;for(Le=0,dt=pe.length;dt>Le;Le+=2)nt+=pe[Le+1];Se=new pe.constructor(nt)}var zt=0;for(Le=0,dt=pe.length;dt>Le;Le+=2)for(var ht=pe[Le],Lt=pe[Le+1],Ut=0;Lt>Ut;++Ut)Se[zt]=ht,++zt;return Se}function H(pe){if(pe.length===0)return new Int32Array;var Se,Le,dt=2;for(Se=1,Le=pe.length;Le>Se;++Se)pe[Se-1]!==pe[Se]&&(dt+=2);var nt=new Int32Array(dt),zt=0,ht=1;for(Se=1,Le=pe.length;Le>Se;++Se)pe[Se-1]!==pe[Se]?(nt[zt]=pe[Se-1],nt[zt+1]=ht,ht=1,zt+=2):++ht;return nt[zt]=pe[pe.length-1],nt[zt+1]=ht,nt}function Y(pe,Se){var Le=pe.length;Se||(Se=new pe.constructor(Le)),Le&&(Se[0]=pe[0]);for(var dt=1;Le>dt;++dt)Se[dt]=pe[dt]+Se[dt-1];return Se}function O(pe,Se){var Le=pe.length;Se||(Se=new pe.constructor(Le)),Se[0]=pe[0];for(var dt=1;Le>dt;++dt)Se[dt]=pe[dt]-pe[dt-1];return Se}function ee(pe,Se){var Le,dt,nt=pe instanceof Int8Array?127:32767,zt=-nt-1,ht=pe.length;if(!Se){var Lt=0;for(Le=0;ht>Le;++Le)pe[Le]<nt&&pe[Le]>zt&&++Lt;Se=new Int32Array(Lt)}for(Le=0,dt=0;ht>Le;){for(var Ut=0;pe[Le]===nt||pe[Le]===zt;)Ut+=pe[Le],++Le;Ut+=pe[Le],++Le,Se[dt]=Ut,++dt}return Se}function Ae(pe,Se){var Le,dt=32767,nt=-dt-1,zt=pe.length,ht=0;for(Le=0;zt>Le;++Le)(It=pe[Le])===0?++ht:It>0?(ht+=Math.ceil(It/dt),It%dt===0&&(ht+=1)):(ht+=Math.ceil(It/nt),It%nt===0&&(ht+=1));var Lt=new Int16Array(ht),Ut=0;for(Le=0;zt>Le;++Le){var It;if((It=pe[Le])>=0)for(;It>=dt;)Lt[Ut]=dt,++Ut,It-=dt;else for(;nt>=It;)Lt[Ut]=nt,++Ut,It-=nt;Lt[Ut]=It,++Ut}return Lt}function ce(pe,Se){return Y(V(pe),Se)}function ge(pe){return H(O(pe))}function me(pe,Se,Le){return w(V(pe,k(Le)),Se,Le)}function Me(pe,Se){return H(N(pe,Se))}function ue(pe,Se,Le){return w(Y(pe,k(Le)),Se,Le)}function I(pe,Se,Le){return O(N(pe,Se),Le)}function he(pe,Se,Le){return w(ee(pe,k(Le)),Se,Le)}function se(pe,Se,Le){var dt=ee(pe,k(Le));return ue(dt,Se,F(dt))}function K(pe,Se,Le){return Ae(I(pe,Se))}function Re(pe){var Se=b(pe),Le=Se.getInt32(0),dt=Se.getInt32(4),nt=pe.subarray(8,12);return[Le,pe=pe.subarray(12),dt,nt]}function fe(pe,Se,Le,dt){var nt=new ArrayBuffer(12+dt.byteLength),zt=new Uint8Array(nt),ht=new DataView(nt);return ht.setInt32(0,pe),ht.setInt32(4,Se),Le&&zt.set(Le,8),zt.set(dt,12),zt}function De(pe){return fe(2,pe.length,void 0,T(pe))}function We(pe){return fe(4,pe.length,void 0,J(pe))}function oe(pe,Se){return fe(5,pe.length/Se,J([Se]),T(pe))}function Ee(pe){return fe(6,pe.length,void 0,J(H(pe)))}function He(pe){return fe(8,pe.length,void 0,J(ge(pe)))}function Ue(pe,Se){return fe(9,pe.length,J([Se]),J(Me(pe,Se)))}function Ie(pe,Se){return fe(10,pe.length,J([Se]),z(K(pe,Se)))}function rt(pe){var Se={};return xr.forEach(function(Le){pe[Le]!==void 0&&(Se[Le]=pe[Le])}),pe.bondAtomList&&(Se.bondAtomList=We(pe.bondAtomList)),pe.bondOrderList&&(Se.bondOrderList=De(pe.bondOrderList)),Se.xCoordList=Ie(pe.xCoordList,1e3),Se.yCoordList=Ie(pe.yCoordList,1e3),Se.zCoordList=Ie(pe.zCoordList,1e3),pe.bFactorList&&(Se.bFactorList=Ie(pe.bFactorList,100)),pe.atomIdList&&(Se.atomIdList=He(pe.atomIdList)),pe.altLocList&&(Se.altLocList=Ee(pe.altLocList)),pe.occupancyList&&(Se.occupancyList=Ue(pe.occupancyList,100)),Se.groupIdList=He(pe.groupIdList),Se.groupTypeList=We(pe.groupTypeList),pe.secStructList&&(Se.secStructList=De(pe.secStructList)),pe.insCodeList&&(Se.insCodeList=Ee(pe.insCodeList)),pe.sequenceIndexList&&(Se.sequenceIndexList=He(pe.sequenceIndexList)),Se.chainIdList=oe(pe.chainIdList,4),pe.chainNameList&&(Se.chainNameList=oe(pe.chainNameList,4)),Se}function st(pe){function Se(Ut){for(var It={},mr=0;Ut>mr;mr++)It[zt()]=zt();return It}function Le(Ut){var It=pe.subarray(ht,ht+Ut);return ht+=Ut,It}function dt(Ut){var It=pe.subarray(ht,ht+Ut);ht+=Ut;var mr=65535;if(Ut>mr){for(var li=[],Ai=0;Ai<It.length;Ai+=mr)li.push(String.fromCharCode.apply(null,It.subarray(Ai,Ai+mr)));return li.join("")}return String.fromCharCode.apply(null,It)}function nt(Ut){for(var It=new Array(Ut),mr=0;Ut>mr;mr++)It[mr]=zt();return It}function zt(){var Ut,It,mr=pe[ht];if(!(128&mr))return ht++,mr;if((240&mr)==128)return ht++,Se(It=15&mr);if((240&mr)==144)return ht++,nt(It=15&mr);if((224&mr)==160)return ht++,dt(It=31&mr);if(!(224&~mr))return Ut=Lt.getInt8(ht),ht++,Ut;switch(mr){case 192:return ht++,null;case 194:return ht++,!1;case 195:return ht++,!0;case 196:return It=Lt.getUint8(ht+1),ht+=2,Le(It);case 197:return It=Lt.getUint16(ht+1),ht+=3,Le(It);case 198:return It=Lt.getUint32(ht+1),ht+=5,Le(It);case 202:return Ut=Lt.getFloat32(ht+1),ht+=5,Ut;case 203:return Ut=Lt.getFloat64(ht+1),ht+=9,Ut;case 204:return Ut=pe[ht+1],ht+=2,Ut;case 205:return Ut=Lt.getUint16(ht+1),ht+=3,Ut;case 206:return Ut=Lt.getUint32(ht+1),ht+=5,Ut;case 208:return Ut=Lt.getInt8(ht+1),ht+=2,Ut;case 209:return Ut=Lt.getInt16(ht+1),ht+=3,Ut;case 210:return Ut=Lt.getInt32(ht+1),ht+=5,Ut;case 217:return It=Lt.getUint8(ht+1),ht+=2,dt(It);case 218:return It=Lt.getUint16(ht+1),ht+=3,dt(It);case 219:return It=Lt.getUint32(ht+1),ht+=5,dt(It);case 220:return It=Lt.getUint16(ht+1),ht+=3,nt(It);case 221:return It=Lt.getUint32(ht+1),ht+=5,nt(It);case 222:return It=Lt.getUint16(ht+1),ht+=3,Se(It);case 223:return It=Lt.getUint32(ht+1),ht+=5,Se(It)}throw new Error("Unknown type 0x"+mr.toString(16))}var ht=0,Lt=new DataView(pe.buffer);return zt()}function at(pe,Se,Le,dt){switch(pe){case 1:return q(Se);case 2:return x(Se);case 3:return C(Se);case 4:return Q(Se);case 5:return T(Se);case 6:return V(Q(Se),new Uint8Array(Le));case 7:return V(Q(Se));case 8:return ce(Q(Se));case 9:return me(Q(Se),Q(dt)[0]);case 10:return se(C(Se),Q(dt)[0]);case 11:return w(C(Se),Q(dt)[0]);case 12:return he(C(Se),Q(dt)[0]);case 13:return he(x(Se),Q(dt)[0]);case 14:return ee(C(Se));case 15:return ee(x(Se))}}function Ft(pe,Se){var Le=(Se=Se||{}).ignoreFields,dt={};return Rr.forEach(function(nt){var zt=!!Le&&Le.indexOf(nt)!==-1,ht=pe[nt];zt||ht===void 0||(ht instanceof Uint8Array?dt[nt]=at.apply(null,Re(ht)):dt[nt]=ht)}),dt}function At(pe){return String.fromCharCode.apply(null,pe).replace(/\0/g,"")}function or(pe,Se,Le){var dt,nt,zt,ht,Lt,Ut,It=(Le=Le||{}).firstModelOnly,mr=Se.onModel,li=Se.onChain,Ai=Se.onGroup,ui=Se.onAtom,gi=Se.onBond,jr=0,Lr=0,Dr=0,rr=0,vi=0,bi=-1,$i=pe.chainNameList,Ci=pe.secStructList,Ni=pe.insCodeList,Ti=pe.sequenceIndexList,pi=pe.atomIdList,Br=pe.bFactorList,Zr=pe.altLocList,Vi=pe.occupancyList,yi=pe.bondAtomList,Wi=pe.bondOrderList;for(dt=0,nt=pe.chainsPerModel.length;nt>dt&&!(It&&jr>0);++dt){var tn=pe.chainsPerModel[jr];for(mr&&mr({chainCount:tn,modelIndex:jr}),zt=0;tn>zt;++zt){var on=pe.groupsPerChain[Lr];if(li){var ur=At(pe.chainIdList.subarray(4*Lr,4*Lr+4)),Gr=null;$i&&(Gr=At($i.subarray(4*Lr,4*Lr+4))),li({groupCount:on,chainIndex:Lr,modelIndex:jr,chainId:ur,chainName:Gr})}for(ht=0;on>ht;++ht){var $r=pe.groupList[pe.groupTypeList[Dr]],qi=$r.atomNameList.length;if(Ai){var Bt=null;Ci&&(Bt=Ci[Dr]);var _=null;pe.insCodeList&&(_=String.fromCharCode(Ni[Dr]));var ne=null;Ti&&(ne=Ti[Dr]),Ai({atomCount:qi,groupIndex:Dr,chainIndex:Lr,modelIndex:jr,groupId:pe.groupIdList[Dr],groupType:pe.groupTypeList[Dr],groupName:$r.groupName,singleLetterCode:$r.singleLetterCode,chemCompType:$r.chemCompType,secStruct:Bt,insCode:_,sequenceIndex:ne})}for(Lt=0;qi>Lt;++Lt){if(ui){var xe=null;pi&&(xe=pi[rr]);var Ve=null;Br&&(Ve=Br[rr]);var Oe=null;Zr&&(Oe=String.fromCharCode(Zr[rr]));var yt=null;Vi&&(yt=Vi[rr]),ui({atomIndex:rr,groupIndex:Dr,chainIndex:Lr,modelIndex:jr,atomId:xe,element:$r.elementList[Lt],atomName:$r.atomNameList[Lt],formalCharge:$r.formalChargeList[Lt],xCoord:pe.xCoordList[rr],yCoord:pe.yCoordList[rr],zCoord:pe.zCoordList[rr],bFactor:Ve,altLoc:Oe,occupancy:yt})}rr+=1}if(gi){var lt=$r.bondAtomList;for(Lt=0,Ut=$r.bondOrderList.length;Ut>Lt;++Lt)gi({atomIndex1:rr-qi+lt[2*Lt],atomIndex2:rr-qi+lt[2*Lt+1],bondOrder:$r.bondOrderList[Lt]})}Dr+=1}Lr+=1}if(vi=bi+1,bi=rr-1,gi&&yi)for(Lt=0,Ut=yi.length;Ut>Lt;Lt+=2){var mt=yi[Lt],Mt=yi[Lt+1];(mt>=vi&&bi>=mt||Mt>=vi&&bi>=Mt)&&gi({atomIndex1:mt,atomIndex2:Mt,bondOrder:Wi?Wi[Lt/2]:null})}jr+=1}}function ar(pe){return v(rt(pe))}function kr(pe,Se){return pe instanceof ArrayBuffer&&(pe=new Uint8Array(pe)),Ft(pe instanceof Uint8Array?st(pe):pe,Se)}function Er(pe,Se,Le,dt){function nt(){try{var ht=kr(zt.response);Le(ht)}catch(Lt){dt(Lt)}}var zt=new XMLHttpRequest;zt.addEventListener("load",nt,!0),zt.addEventListener("error",dt,!0),zt.responseType="arraybuffer",zt.open("GET",Se+pe.toUpperCase()),zt.send()}function pr(pe,Se,Le){Er(pe,wi,Se,Le)}function vr(pe,Se,Le){Er(pe,Hi,Se,Le)}var xr=["mmtfVersion","mmtfProducer","unitCell","spaceGroup","structureId","title","depositionDate","releaseDate","experimentalMethods","resolution","rFree","rWork","bioAssemblyList","ncsOperatorList","entityList","groupList","numBonds","numAtoms","numGroups","numChains","numModels","groupsPerChain","chainsPerModel"],fi=["xCoordList","yCoordList","zCoordList","groupIdList","groupTypeList","chainIdList","bFactorList","atomIdList","altLocList","occupancyList","secStructList","insCodeList","sequenceIndexList","chainNameList","bondAtomList","bondOrderList"],Rr=xr.concat(fi),Ir="v1.0.1",Di="//mmtf.rcsb.org/v1.0/",wi=Di+"full/",Hi=Di+"reduced/";a.encode=ar,a.decode=kr,a.traverse=or,a.fetch=pr,a.fetchReduced=vr,a.version=Ir,a.fetchUrl=wi,a.fetchReducedUrl=Hi,a.encodeMsgpack=v,a.encodeMmtf=rt,a.decodeMsgpack=st,a.decodeMmtf=Ft})(n)},529:(r,n,a)=>{a.r(n),a.d(n,{Matrix3:()=>z,Matrix4:()=>F,Quaternion:()=>c,Ray:()=>Q,Vector2:()=>d,Vector3:()=>C,clamp:()=>R,conversionMatrix3:()=>J,degToRad:()=>v});class c{constructor(w,N,V,H){this.x=w||0,this.y=N||0,this.z=V||0,this.w=H!==void 0?H:1}set(w,N,V,H){return this.x=w,this.y=N,this.z=V,this.w=H,this}copy(w){return this.x=w.x,this.y=w.y,this.z=w.z,this.w=w.w,this}conjugate(){return this.x*=-1,this.y*=-1,this.z*=-1,this}inverse(){return this.conjugate().normalize()}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}lengthxyz(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}normalize(){let w=this.length();return w===0?(this.x=0,this.y=0,this.z=0,this.w=1):(w=1/w,this.x*=w,this.y*=w,this.z*=w,this.w*=w),this}multiply(w){return this.multiplyQuaternions(this,w)}multiplyScalar(w){return this.x*=w,this.y*=w,this.z*=w,this.w*=w,this}multiplyQuaternions(w,N){const V=w.x,H=w.y,Y=w.z,O=w.w,ee=N.x,Ae=N.y,ce=N.z,ge=N.w;return this.x=V*ge+O*ee+H*ce-Y*Ae,this.y=H*ge+O*Ae+Y*ee-V*ce,this.z=Y*ge+O*ce+V*Ae-H*ee,this.w=O*ge-V*ee-H*Ae-Y*ce,this}sub(w){return this.x-=w.x,this.y-=w.y,this.z-=w.z,this.w-=w.w,this}clone(){return new c(this.x,this.y,this.z,this.w)}setFromEuler(w){const N=Math.cos(w.x/2),V=Math.cos(w.y/2),H=Math.cos(w.z/2),Y=Math.sin(w.x/2),O=Math.sin(w.y/2),ee=Math.sin(w.z/2);return this.x=Y*V*H+N*O*ee,this.y=N*O*H-Y*V*ee,this.z=N*V*ee+Y*O*H,this.w=N*V*H-Y*O*ee,this}}class d{constructor(w,N){this.x=w||0,this.y=N||0}set(w,N){return this.x=w,this.y=N,this}subVectors(w,N){return this.x=w.x-N.x,this.y=w.y-N.y,this}copy(w){return this.x=w.x,this.y=w.y,this}clone(){return new d(this.x,this.y)}}function R(q,w,N){return Math.min(Math.max(q,w),N)}const u=Math.PI/180;function v(q){return q*u}var m,b,T,x,k;class F{constructor(w=1,N=0,V=0,H=0,Y=0,O=1,ee=0,Ae=0,ce=0,ge=0,me=1,Me=0,ue=0,I=0,he=0,se=1){w!==void 0&&typeof w!="number"?this.elements=new Float32Array(w):(this.elements=new Float32Array(16),this.elements[0]=w,this.elements[4]=N,this.elements[8]=V,this.elements[12]=H,this.elements[1]=Y,this.elements[5]=O,this.elements[9]=ee,this.elements[13]=Ae,this.elements[2]=ce,this.elements[6]=ge,this.elements[10]=me,this.elements[14]=Me,this.elements[3]=ue,this.elements[7]=I,this.elements[11]=he,this.elements[15]=se)}makeScale(w,N,V){throw new Error("Method not implemented.")}set(w,N,V,H,Y,O,ee,Ae,ce,ge,me,Me,ue,I,he,se){const K=this.elements;return K[0]=w,K[4]=N,K[8]=V,K[12]=H,K[1]=Y,K[5]=O,K[9]=ee,K[13]=Ae,K[2]=ce,K[6]=ge,K[10]=me,K[14]=Me,K[3]=ue,K[7]=I,K[11]=he,K[15]=se,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}copy(w){const N=w.elements;return this.set(N[0],N[4],N[8],N[12],N[1],N[5],N[9],N[13],N[2],N[6],N[10],N[14],N[3],N[7],N[11],N[15]),this}matrix3FromTopLeft(){const w=this.elements;return new z(w[0],w[4],w[8],w[1],w[5],w[9],w[2],w[6],w[10])}setRotationFromEuler(w,N){const V=this.elements,{x:H,y:Y,z:O}=w,ee=Math.cos(H),Ae=Math.sin(H),ce=Math.cos(Y),ge=Math.sin(Y),me=Math.cos(O),Me=Math.sin(O);if(N===void 0||N==="XYZ"){const ue=ee*me,I=ee*Me,he=Ae*me,se=Ae*Me;V[0]=ce*me,V[4]=-ce*Me,V[8]=ge,V[1]=I+he*ge,V[5]=ue-se*ge,V[9]=-Ae*ce,V[2]=se-ue*ge,V[6]=he+I*ge,V[10]=ee*ce}else console.error(`Error with matrix4 setRotationFromEuler. Order: ${N}`);return this}setRotationFromQuaternion(w){const N=this.elements,{x:V,y:H,z:Y,w:O}=w,ee=V+V,Ae=H+H,ce=Y+Y,ge=V*ee,me=V*Ae,Me=V*ce,ue=H*Ae,I=H*ce,he=Y*ce,se=O*ee,K=O*Ae,Re=O*ce;return N[0]=1-(ue+he),N[4]=me-Re,N[8]=Me+K,N[1]=me+Re,N[5]=1-(ge+he),N[9]=I-se,N[2]=Me-K,N[6]=I+se,N[10]=1-(ge+ue),this}multiplyMatrices(w,N){const V=w.elements,H=N.elements,Y=this.elements,O=V[0],ee=V[4],Ae=V[8],ce=V[12],ge=V[1],me=V[5],Me=V[9],ue=V[13],I=V[2],he=V[6],se=V[10],K=V[14],Re=V[3],fe=V[7],De=V[11],We=V[15],oe=H[0],Ee=H[4],He=H[8],Ue=H[12],Ie=H[1],rt=H[5],st=H[9],at=H[13],Ft=H[2],At=H[6],or=H[10],ar=H[14],kr=H[3],Er=H[7],pr=H[11],vr=H[15];return Y[0]=O*oe+ee*Ie+Ae*Ft+ce*kr,Y[4]=O*Ee+ee*rt+Ae*At+ce*Er,Y[8]=O*He+ee*st+Ae*or+ce*pr,Y[12]=O*Ue+ee*at+Ae*ar+ce*vr,Y[1]=ge*oe+me*Ie+Me*Ft+ue*kr,Y[5]=ge*Ee+me*rt+Me*At+ue*Er,Y[9]=ge*He+me*st+Me*or+ue*pr,Y[13]=ge*Ue+me*at+Me*ar+ue*vr,Y[2]=I*oe+he*Ie+se*Ft+K*kr,Y[6]=I*Ee+he*rt+se*At+K*Er,Y[10]=I*He+he*st+se*or+K*pr,Y[14]=I*Ue+he*at+se*ar+K*vr,Y[3]=Re*oe+fe*Ie+De*Ft+We*kr,Y[7]=Re*Ee+fe*rt+De*At+We*Er,Y[11]=Re*He+fe*st+De*or+We*pr,Y[15]=Re*Ue+fe*at+De*ar+We*vr,this}multiplyScalar(w){const N=this.elements;return N[0]*=w,N[4]*=w,N[8]*=w,N[12]*=w,N[1]*=w,N[5]*=w,N[9]*=w,N[13]*=w,N[2]*=w,N[6]*=w,N[10]*=w,N[14]*=w,N[3]*=w,N[7]*=w,N[11]*=w,N[15]*=w,this}makeTranslation(w,N,V){return this.set(1,0,0,w,0,1,0,N,0,0,1,V,0,0,0,1),this}snap(w){const N=Math.pow(10,4),V=this.elements;for(let H=0;H<16;H++){const Y=Math.round(V[H]);Y===Math.round(V[H]*N)/N&&(V[H]=Y)}return this}transpose(){const w=this.elements;let N;return N=w[1],w[1]=w[4],w[4]=N,N=w[2],w[2]=w[8],w[8]=N,N=w[6],w[6]=w[9],w[9]=N,N=w[3],w[3]=w[12],w[12]=N,N=w[7],w[7]=w[13],w[13]=N,N=w[11],w[11]=w[14],w[14]=N,this}setPosition(w){const N=this.elements;return N[12]=w.x,N[13]=w.y,N[14]=w.z,this}translate(w){const N=this.elements;return N[12]+=w.x,N[13]+=w.y,N[14]+=w.z,this}getInverse(w,N){const V=this.elements,H=w.elements,Y=H[0],O=H[4],ee=H[8],Ae=H[12],ce=H[1],ge=H[5],me=H[9],Me=H[13],ue=H[2],I=H[6],he=H[10],se=H[14],K=H[3],Re=H[7],fe=H[11],De=H[15];V[0]=me*se*Re-Me*he*Re+Me*I*fe-ge*se*fe-me*I*De+ge*he*De,V[4]=Ae*he*Re-ee*se*Re-Ae*I*fe+O*se*fe+ee*I*De-O*he*De,V[8]=ee*Me*Re-Ae*me*Re+Ae*ge*fe-O*Me*fe-ee*ge*De+O*me*De,V[12]=Ae*me*I-ee*Me*I-Ae*ge*he+O*Me*he+ee*ge*se-O*me*se,V[1]=Me*he*K-me*se*K-Me*ue*fe+ce*se*fe+me*ue*De-ce*he*De,V[5]=ee*se*K-Ae*he*K+Ae*ue*fe-Y*se*fe-ee*ue*De+Y*he*De,V[9]=Ae*me*K-ee*Me*K-Ae*ce*fe+Y*Me*fe+ee*ce*De-Y*me*De,V[13]=ee*Me*ue-Ae*me*ue+Ae*ce*he-Y*Me*he-ee*ce*se+Y*me*se,V[2]=ge*se*K-Me*I*K+Me*ue*Re-ce*se*Re-ge*ue*De+ce*I*De,V[6]=Ae*I*K-O*se*K-Ae*ue*Re+Y*se*Re+O*ue*De-Y*I*De,V[10]=O*Me*K-Ae*ge*K+Ae*ce*Re-Y*Me*Re-O*ce*De+Y*ge*De,V[14]=Ae*ge*ue-O*Me*ue-Ae*ce*I+Y*Me*I+O*ce*se-Y*ge*se,V[3]=me*I*K-ge*he*K-me*ue*Re+ce*he*Re+ge*ue*fe-ce*I*fe,V[7]=O*he*K-ee*I*K+ee*ue*Re-Y*he*Re-O*ue*fe+Y*I*fe,V[11]=ee*ge*K-O*me*K-ee*ce*Re+Y*me*Re+O*ce*fe-Y*ge*fe,V[15]=O*me*ue-ee*ge*ue+ee*ce*I-Y*me*I-O*ce*he+Y*ge*he;const We=Y*V[0]+ce*V[4]+ue*V[8]+K*V[12];if(We===0){const oe="Matrix4.getInverse(): can't invert matrix, determinant is 0";if(N)throw new Error(oe);return console.warn(oe),this.identity(),this}return this.multiplyScalar(1/We),this}isReflected(){const w=this.elements,N=w[0],V=w[4],H=w[8],Y=w[1],O=w[5],ee=w[9],Ae=w[2],ce=w[6],ge=w[10];return N*O*ge+Y*ce*H+Ae*V*ee-Ae*O*H-Y*V*ge-N*ce*ee<0}scale(w){const N=this.elements,{x:V}=w,{y:H}=w,{z:Y}=w;return N[0]*=V,N[4]*=H,N[8]*=Y,N[1]*=V,N[5]*=H,N[9]*=Y,N[2]*=V,N[6]*=H,N[10]*=Y,N[3]*=V,N[7]*=H,N[11]*=Y,this}getMaxScaleOnAxis(){const w=this.elements,N=w[0]*w[0]+w[1]*w[1]+w[2]*w[2],V=w[4]*w[4]+w[5]*w[5]+w[6]*w[6],H=w[8]*w[8]+w[9]*w[9]+w[10]*w[10];return Math.sqrt(Math.max(N,Math.max(V,H)))}makeFrustum(w,N,V,H,Y,O){const ee=this.elements,Ae=2*Y/(N-w),ce=2*Y/(H-V),ge=(N+w)/(N-w),me=(H+V)/(H-V),Me=-(O+Y)/(O-Y),ue=-2*O*Y/(O-Y);return ee[0]=Ae,ee[4]=0,ee[8]=ge,ee[12]=0,ee[1]=0,ee[5]=ce,ee[9]=me,ee[13]=0,ee[2]=0,ee[6]=0,ee[10]=Me,ee[14]=ue,ee[3]=0,ee[7]=0,ee[11]=-1,ee[15]=0,this}makePerspective(w,N,V,H){const Y=V*Math.tan(v(.5*w)),O=-Y,ee=O*N,Ae=Y*N;return this.makeFrustum(ee,Ae,O,Y,V,H)}makeOrthographic(w,N,V,H,Y,O){const ee=this.elements,Ae=1/(N-w),ce=1/(V-H),ge=1/(O-Y),me=(N+w)*Ae,Me=(V+H)*ce,ue=(O+Y)*ge;return ee[0]=2*Ae,ee[4]=0,ee[8]=0,ee[12]=-me,ee[1]=0,ee[5]=2*ce,ee[9]=0,ee[13]=-Me,ee[2]=0,ee[6]=0,ee[10]=-2*ge,ee[14]=-ue,ee[3]=0,ee[7]=0,ee[11]=0,ee[15]=1,this}isEqual(w){const N=w.elements,V=this.elements;return V[0]===N[0]&&V[4]===N[4]&&V[8]===N[8]&&V[12]===N[12]&&V[1]===N[1]&&V[5]===N[5]&&V[9]===N[9]&&V[13]===N[13]&&V[2]===N[2]&&V[6]===N[6]&&V[10]===N[10]&&V[14]===N[14]&&V[3]===N[3]&&V[7]===N[7]&&V[11]===N[11]&&V[15]===N[15]}clone(){const w=this.elements;return new F(w[0],w[4],w[8],w[12],w[1],w[5],w[9],w[13],w[2],w[6],w[10],w[14],w[3],w[7],w[11],w[15])}isIdentity(){const w=this.elements;return w[0]===1&&w[4]===0&&w[8]===0&&w[12]===0&&w[1]===0&&w[5]===1&&w[9]===0&&w[13]===0&&w[2]===0&&w[6]===0&&w[10]===1&&w[14]===0&&w[3]===0&&w[7]===0&&w[11]===0&&w[15]===1}isNearlyIdentity(w){return this.clone().snap(w).isIdentity()}getScale(w){const N=this.elements;return w=w||new C,T.set(N[0],N[1],N[2]),x.set(N[4],N[5],N[6]),k.set(N[8],N[9],N[10]),w.x=T.length(),w.y=x.length(),w.z=k.length(),w}lookAt(w,N,V){const H=this.elements;return k.subVectors(w,N).normalize(),k.length()===0&&(k.z=1),T.crossVectors(V,k).normalize(),T.length()===0&&(k.x+=1e-4,T.crossVectors(V,k).normalize()),x.crossVectors(k,T),H[0]=T.x,H[4]=x.x,H[8]=k.x,H[1]=T.y,H[5]=x.y,H[9]=k.y,H[2]=T.z,H[6]=x.z,H[10]=k.z,this}compose(w,N,V){const H=this.elements;return m.identity(),m.setRotationFromQuaternion(N),b.makeScale(V.x,V.y,V.z),this.multiplyMatrices(m,b),H[12]=w.x,H[13]=w.y,H[14]=w.z,this}}m=new F,b=new F;class C{constructor(w,N,V){this.x=w||0,this.y=N||0,this.z=V||0,this.atomid=void 0}set(w,N,V){return this.x=w,this.y=N,this.z=V,this}copy(w){return this.x=w.x,this.y=w.y,this.z=w.z,this}add(w){return this.x+=w.x,this.y+=w.y,this.z+=w.z,this}addVectors(w,N){return this.x=w.x+N.x,this.y=w.y+N.y,this.z=w.z+N.z,this}multiplyVectors(w,N){return this.x=w.x*N.x,this.y=w.y*N.y,this.z=w.z*N.z,this}sub(w){return this.x-=w.x,this.y-=w.y,this.z-=w.z,this}subVectors(w,N){return this.x=w.x-N.x,this.y=w.y-N.y,this.z=w.z-N.z,this}multiplyScalar(w){return this.x*=w,this.y*=w,this.z*=w,this}divideScalar(w){return w!==0?(this.x/=w,this.y/=w,this.z/=w):(this.x=0,this.y=0,this.z=0),this}max(w){return this.x=Math.max(this.x,w.x),this.y=Math.max(this.y,w.y),this.z=Math.max(this.z,w.z),this}min(w){return this.x=Math.min(this.x,w.x),this.y=Math.min(this.y,w.y),this.z=Math.min(this.z,w.z),this}distanceTo(w){return Math.sqrt(this.distanceToSquared(w))}distanceToSquared(w){const N=this.x-w.x,V=this.y-w.y,H=this.z-w.z;return N*N+V*V+H*H}applyMatrix3(w){const{x:N}=this,{y:V}=this,{z:H}=this,Y=w.elements;return this.x=Y[0]*N+Y[3]*V+Y[6]*H,this.y=Y[1]*N+Y[4]*V+Y[7]*H,this.z=Y[2]*N+Y[5]*V+Y[8]*H,this}applyMatrix4(w){const{x:N}=this,{y:V}=this,{z:H}=this,Y=w.elements;return this.x=Y[0]*N+Y[4]*V+Y[8]*H+Y[12],this.y=Y[1]*N+Y[5]*V+Y[9]*H+Y[13],this.z=Y[2]*N+Y[6]*V+Y[10]*H+Y[14],this}applyProjection(w){const{x:N}=this,{y:V}=this,{z:H}=this,Y=w.elements,O=Y[3]*N+Y[7]*V+Y[11]*H+Y[15];return this.x=(Y[0]*N+Y[4]*V+Y[8]*H+Y[12])/O,this.y=(Y[1]*N+Y[5]*V+Y[9]*H+Y[13])/O,this.z=(Y[2]*N+Y[6]*V+Y[10]*H+Y[14])/O,this}applyQuaternion(w){const{x:N}=this,{y:V}=this,{z:H}=this,Y=w.x,O=w.y,ee=w.z,Ae=w.w,ce={};ce.x=2*(V*ee-H*O),ce.y=2*(H*Y-N*ee),ce.z=2*(N*O-V*Y);const ge={};return ge.x=ce.y*ee-ce.z*O,ge.y=ce.z*Y-ce.x*ee,ge.z=ce.x*O-ce.y*Y,this.x=N+Ae*ce.x+ge.x,this.y=V+Ae*ce.y+ge.y,this.z=H+Ae*ce.z+ge.z,this}negate(){return this.multiplyScalar(-1)}dot(w){return this.x*w.x+this.y*w.y+this.z*w.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}normalize(){return this.divideScalar(this.length())}cross(w){const{x:N}=this,{y:V}=this,{z:H}=this;return this.x=V*w.z-H*w.y,this.y=H*w.x-N*w.z,this.z=N*w.y-V*w.x,this}crossVectors(w,N){return this.x=w.y*N.z-w.z*N.y,this.y=w.z*N.x-w.x*N.z,this.z=w.x*N.y-w.y*N.x,this}equals(w){return this.x==w.x&&this.y==w.y&&this.z==w.z}getPositionFromMatrix(w){return this.x=w.elements[12],this.y=w.elements[13],this.z=w.elements[14],this}setEulerFromRotationMatrix(w,N){const V=w.elements,H=V[0],Y=V[4],O=V[8],ee=V[5],Ae=V[9],ce=V[6],ge=V[10];return N===void 0||N==="XYZ"?(this.y=Math.asin(R(O,-1,1)),Math.abs(O)<.99999?(this.x=Math.atan2(-Ae,ge),this.z=Math.atan2(-Y,H)):(this.x=Math.atan2(ce,ee),this.z=0)):console.error(`Error with vector's setEulerFromRotationMatrix: Unknown order: ${N}`),this}rotateAboutVector(w,N){w.normalize();const V=Math.cos(N),H=Math.sin(N),Y=this.clone().multiplyScalar(V),O=w.clone().cross(this).multiplyScalar(H),ee=w.clone().multiplyScalar(w.clone().dot(this)).multiplyScalar(1-V),Ae=Y.add(O).add(ee);return this.x=Ae.x,this.y=Ae.y,this.z=Ae.z,this}setFromMatrixPosition(w){const N=w.elements;return this.x=N[12],this.y=N[13],this.z=N[14],this}transformDirection(w){const{x:N}=this,{y:V}=this,{z:H}=this,Y=w.elements;return this.x=Y[0]*N+Y[4]*V+Y[8]*H,this.y=Y[1]*N+Y[5]*V+Y[9]*H,this.z=Y[2]*N+Y[6]*V+Y[10]*H,this.normalize()}clone(){return new C(this.x,this.y,this.z)}unproject(w){const N=m;return N.multiplyMatrices(w.matrixWorld,N.getInverse(w.projectionMatrix)),this.applyMatrix4(N)}}T=new C,x=new C,k=new C;class z{constructor(w=1,N=0,V=0,H=0,Y=1,O=0,ee=0,Ae=0,ce=1){this.elements=new Float32Array(9),this.set(w,N,V,H,Y,O,ee,Ae,ce)}set(w,N,V,H,Y,O,ee,Ae,ce){const ge=this.elements;return ge[0]=w,ge[3]=N,ge[6]=V,ge[1]=H,ge[4]=Y,ge[7]=O,ge[2]=ee,ge[5]=Ae,ge[8]=ce,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(w){const N=w.elements;this.set(N[0],N[3],N[6],N[1],N[4],N[7],N[2],N[5],N[8])}multiplyScalar(w){const N=this.elements;return N[0]*=w,N[3]*=w,N[6]*=w,N[1]*=w,N[4]*=w,N[7]*=w,N[2]*=w,N[5]*=w,N[8]*=w,this}getInverse3(w){const N=w.elements,V=this.elements;V[0]=N[4]*N[8]-N[5]*N[7],V[3]=N[6]*N[5]-N[3]*N[8],V[6]=N[3]*N[7]-N[6]*N[4],V[1]=N[7]*N[2]-N[1]*N[8],V[4]=N[0]*N[8]-N[6]*N[2],V[7]=N[1]*N[6]-N[0]*N[7],V[2]=N[1]*N[5]-N[2]*N[4],V[5]=N[2]*N[3]-N[0]*N[5],V[8]=N[0]*N[4]-N[1]*N[3];const H=N[0]*V[0]+N[3]*V[1]+N[6]*V[2];return this.multiplyScalar(1/H),this}getInverse(w,N){const V=w.elements,H=this.elements;H[0]=V[10]*V[5]-V[6]*V[9],H[1]=-V[10]*V[1]+V[2]*V[9],H[2]=V[6]*V[1]-V[2]*V[5],H[3]=-V[10]*V[4]+V[6]*V[8],H[4]=V[10]*V[0]-V[2]*V[8],H[5]=-V[6]*V[0]+V[2]*V[4],H[6]=V[9]*V[4]-V[5]*V[8],H[7]=-V[9]*V[0]+V[1]*V[8],H[8]=V[5]*V[0]-V[1]*V[4];const Y=V[0]*H[0]+V[1]*H[3]+V[2]*H[6];if(Y===0){const O="Matrix3.getInverse(): can't invert matrix, determinant is 0";if(N)throw new Error(O);return console.warn(O),this.identity(),this}return this.multiplyScalar(1/Y),this}getDeterminant(){const w=this.elements;return w[0]*w[4]*w[8]+w[1]*w[5]*w[6]+w[2]*w[3]*w[7]-w[2]*w[4]*w[6]-w[1]*w[3]*w[8]-w[0]*w[5]*w[7]}transpose(){let w;const N=this.elements;return w=N[1],N[1]=N[3],N[3]=w,w=N[2],N[2]=N[6],N[6]=w,w=N[5],N[5]=N[7],N[7]=w,this}clone(){const w=this.elements;return new z(w[0],w[3],w[6],w[1],w[4],w[7],w[2],w[5],w[8])}getMatrix4(){const w=this.elements;return new F(w[0],w[3],w[6],0,w[1],w[4],w[7],0,w[2],w[5],w[8],0)}}class Q{constructor(w,N){this.origin=w!==void 0?w:new C,this.direction=N!==void 0?N:new C}set(w,N){return this.origin.copy(w),this.direction.copy(N),this}copy(w){return this.origin.copy(w.origin),this.direction.copy(w.direction),this}at(w,N){return(N||new C).copy(this.direction).multiplyScalar(w).add(this.origin)}recast(w){const N=T;return this.origin.copy(this.at(w,N)),this}closestPointToPoint(w,N){const V=N||new C;V.subVectors(w,this.origin);const H=V.dot(this.direction);return V.copy(this.direction).multiplyScalar(H).add(this.origin)}distanceToPoint(w){const N=T,V=N.subVectors(w,this.origin).dot(this.direction);return N.copy(this.direction).multiplyScalar(V).add(this.origin),N.distanceTo(w)}isIntersectionCylinder(){}isIntersectionSphere(w){return this.distanceToPoint(w.center)<=w.radius}isIntersectionPlane(w){return w.normal.dot(this.direction)!==0||w.distanceToPoint(this.origin)===0}distanceToPlane(w){const N=w.normal.dot(this.direction);return N===0?w.distanceToPoint(this.origin)===0?0:void 0:-(this.origin.dot(w.normal)+w.constant)/N}intersectPlane(w,N){const V=this.distanceToPlane(w);if(V!==void 0)return this.at(V,N)}applyMatrix4(w){return this.direction.add(this.origin).applyMatrix4(w),this.origin.applyMatrix4(w),this.direction.sub(this.origin),this}clone(){return new Q().copy(this)}}function J(q,w,N,V,H,Y){V=V*Math.PI/180,H=H*Math.PI/180,Y=Y*Math.PI/180;const O=me=>me*me,ee=Math.cos(V),Ae=Math.cos(H),ce=Math.cos(Y),ge=Math.sin(Y);return new z(q,w*ce,N*Ae,0,w*ge,N*(ee-Ae*ce)/ge,0,0,N*Math.sqrt(1-O(ee)-O(Ae)-O(ce)+2*ee*Ae*ce)/ge)}},546:(r,n,a)=>{a.r(n),a.d(n,{CustomLinear:()=>T,Gradient:()=>k,GradientType:()=>d,ROYGB:()=>m,RWB:()=>v,Sinebow:()=>b,builtinGradients:()=>x,getGradient:()=>u,normalizeValue:()=>R});var c=a(222);class d{}function R(F,C,z){return C>=F?(z<F&&(z=F),z>C&&(z=C),{lo:F,hi:C,val:z}):(z>F&&(z=F),z<C&&(z=C),{lo:C,hi:F,val:z=F-z+C})}function u(F){if(F instanceof d)return F;if(F.gradient!==void 0&&x[F.gradient]){let C=F.min===void 0?-1:F.min,z=F.max===void 0?1:F.max;return F.mid===void 0?F.colors===void 0?new x[F.gradient](C,z):new x[F.gradient](C,z,F.colors):new x[F.gradient](C,z,F.mid)}if(typeof F.gradient=="string"&&F.gradient.startsWith("linear_")){let C=F.gradient.split("_");C.shift();let z=F.min===void 0?-1:F.min,Q=F.max===void 0?1:F.max;return new T(z,Q,C)}return F}class v extends d{constructor(C,z,Q){super(),this.gradient="RWB",this.mult=1,this.mid=Q,this.min=C,this.max=z,z===void 0&&Array.isArray(C)&&C.length>=2?(this.max=C[1],this.min=C[0]):C&&z&&!Array.isArray(C)&&(this.min=C,this.max=z)}range(){return this.min!==void 0&&this.max!==void 0?[this.min,this.max]:null}valueToHex(C,z){var Q,J;if(C=this.mult*C,z?(Q=z[0],J=z[1]):(Q=this.min,J=this.max),C===void 0)return 16777215;var q=R(Q,J,C);Q=q.lo;var w,N=((J=q.hi)+Q)/2;return(C=q.val)<(N=z&&z[2]!==void 0?z[2]:this.mid!==void 0?this.mid:(Q+J)/2)?16711680+256*(w=Math.floor(255*Math.sqrt((C-Q)/(N-Q))))+w:C>N?65536*(w=Math.floor(255*Math.sqrt(1-(C-N)/(J-N))))+256*w+255:16777215}}class m extends d{constructor(C,z){super(),this.gradient="ROYGB",this.mult=1,this.min=C,this.max=z,z===void 0&&Array.isArray(C)&&C.length>=2?(this.max=C[1],this.min=C[0]):C&&z&&!Array.isArray(C)&&(this.min=C,this.max=z)}valueToHex(C,z){var Q,J;if(C=this.mult*C,z?(Q=z[0],J=z[1]):(Q=this.min,J=this.max),C===void 0)return 16777215;var q=R(Q,J,C),w=((Q=q.lo)+(J=q.hi))/2,N=(Q+w)/2,V=(w+J)/2;return(C=q.val)<N?16711680+256*Math.floor(255*Math.sqrt((C-Q)/(N-Q)))+0:C<w?65536*Math.floor(255*Math.sqrt(1-(C-N)/(w-N)))+65280+0:C<V?65280+1*Math.floor(255*Math.sqrt((C-w)/(V-w))):0+256*Math.floor(255*Math.sqrt(1-(C-V)/(J-V)))+255}range(){return this.min!==void 0&&this.max!==void 0?[this.min,this.max]:null}}class b extends d{constructor(C,z){super(),this.gradient="Sinebow",this.mult=1,this.min=C,this.max=z,z===void 0&&Array.isArray(C)&&C.length>=2&&(this.max=C[1],this.min=C[0]),z<C&&(this.mult=-1,this.min*=-1,this.max*=-1)}valueToHex(C,z){var Q,J;if(C=this.mult*C,z?(Q=z[0],J=z[1]):(Q=this.min,J=this.max),C===void 0)return 16777215;var q=k.normalizeValue(Q,J,C);Q=q.lo,J=q.hi;var w=((C=q.val)-Q)/(J-Q)*5/6+.5,N=Math.sin(Math.PI*w);N*=255*N;var V=Math.sin(Math.PI*(w+1/3));V*=255*V;var H=Math.sin(Math.PI*(w+2/3));return H*=255*H,65536*Math.floor(N)+256*Math.floor(H)+1*Math.floor(V)}range(){return this.min!==void 0&&this.max!==void 0?[this.min,this.max]:null}}class T extends d{constructor(C,z,Q){var J;if(super(),this.gradient="linear",this.colors=new Array,Array.isArray(C)&&C.length>=2?(this.max=C[1],this.min=C[0],J=z):(this.min=C,this.max=z,J=Q),J)for(let q of J)this.colors.push(c.CC.color(q));else this.colors.push(c.CC.color(0))}range(){return this.min!==void 0&&this.max!==void 0?[this.min,this.max]:null}valueToHex(C,z){var Q,J;if(z?(Q=z[0],J=z[1]):(Q=this.min,J=this.max),C===void 0)return 16777215;var q=R(Q,J,C);Q=q.lo,J=q.hi,C=q.val;let w=this.colors.length,N=(J-Q)/w,V=Math.min(Math.floor((C-Q)/N),w-1),H=Math.min(V+1,w-1),Y=(C-Q-V*N)/N,O=this.colors[V],ee=this.colors[H];return new c.Color(O.r+Y*(ee.r-O.r),O.g+Y*(ee.g-O.g),O.b+Y*(ee.b-O.b)).getHex()}}const x={rwb:v,RWB:v,roygb:m,ROYGB:m,sinebow:b,linear:T};class k extends d{valueToHex(C,z){return 0}range(){return null}}k.RWB=v,k.ROYGB=m,k.Sinebow=b,k.CustomLinear=T,k.builtinGradients=x,k.normalizeValue=R,k.getGradient=u},663:(r,n,a)=>{var c=a(981),d=a(701),R=a(407),u=a(165),v=a(358),m=-2,b=12,T=30;function x(H){return(H>>>24&255)+(H>>>8&65280)+((65280&H)<<8)+((255&H)<<24)}function k(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new c.Buf16(320),this.work=new c.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function F(H){var Y;return H&&H.state?(Y=H.state,H.total_in=H.total_out=Y.total=0,H.msg="",Y.wrap&&(H.adler=1&Y.wrap),Y.mode=1,Y.last=0,Y.havedict=0,Y.dmax=32768,Y.head=null,Y.hold=0,Y.bits=0,Y.lencode=Y.lendyn=new c.Buf32(852),Y.distcode=Y.distdyn=new c.Buf32(592),Y.sane=1,Y.back=-1,0):m}function C(H){var Y;return H&&H.state?((Y=H.state).wsize=0,Y.whave=0,Y.wnext=0,F(H)):m}function z(H,Y){var O,ee;return H&&H.state?(ee=H.state,Y<0?(O=0,Y=-Y):(O=1+(Y>>4),Y<48&&(Y&=15)),Y&&(Y<8||Y>15)?m:(ee.window!==null&&ee.wbits!==Y&&(ee.window=null),ee.wrap=O,ee.wbits=Y,C(H))):m}function Q(H,Y){var O,ee;return H?(ee=new k,H.state=ee,ee.window=null,(O=z(H,Y))!==0&&(H.state=null),O):m}var J,q,w=!0;function N(H){if(w){var Y;for(J=new c.Buf32(512),q=new c.Buf32(32),Y=0;Y<144;)H.lens[Y++]=8;for(;Y<256;)H.lens[Y++]=9;for(;Y<280;)H.lens[Y++]=7;for(;Y<288;)H.lens[Y++]=8;for(v(1,H.lens,0,288,J,0,H.work,{bits:9}),Y=0;Y<32;)H.lens[Y++]=5;v(2,H.lens,0,32,q,0,H.work,{bits:5}),w=!1}H.lencode=J,H.lenbits=9,H.distcode=q,H.distbits=5}function V(H,Y,O,ee){var Ae,ce=H.state;return ce.window===null&&(ce.wsize=1<<ce.wbits,ce.wnext=0,ce.whave=0,ce.window=new c.Buf8(ce.wsize)),ee>=ce.wsize?(c.arraySet(ce.window,Y,O-ce.wsize,ce.wsize,0),ce.wnext=0,ce.whave=ce.wsize):((Ae=ce.wsize-ce.wnext)>ee&&(Ae=ee),c.arraySet(ce.window,Y,O-ee,Ae,ce.wnext),(ee-=Ae)?(c.arraySet(ce.window,Y,O-ee,ee,0),ce.wnext=ee,ce.whave=ce.wsize):(ce.wnext+=Ae,ce.wnext===ce.wsize&&(ce.wnext=0),ce.whave<ce.wsize&&(ce.whave+=Ae))),0}n.inflateReset=C,n.inflateReset2=z,n.inflateResetKeep=F,n.inflateInit=function(H){return Q(H,15)},n.inflateInit2=Q,n.inflate=function(H,Y){var O,ee,Ae,ce,ge,me,Me,ue,I,he,se,K,Re,fe,De,We,oe,Ee,He,Ue,Ie,rt,st,at,Ft=0,At=new c.Buf8(4),or=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!H||!H.state||!H.output||!H.input&&H.avail_in!==0)return m;(O=H.state).mode===b&&(O.mode=13),ge=H.next_out,Ae=H.output,Me=H.avail_out,ce=H.next_in,ee=H.input,me=H.avail_in,ue=O.hold,I=O.bits,he=me,se=Me,rt=0;e:for(;;)switch(O.mode){case 1:if(O.wrap===0){O.mode=13;break}for(;I<16;){if(me===0)break e;me--,ue+=ee[ce++]<<I,I+=8}if(2&O.wrap&&ue===35615){O.check=0,At[0]=255&ue,At[1]=ue>>>8&255,O.check=R(O.check,At,2,0),ue=0,I=0,O.mode=2;break}if(O.flags=0,O.head&&(O.head.done=!1),!(1&O.wrap)||(((255&ue)<<8)+(ue>>8))%31){H.msg="incorrect header check",O.mode=T;break}if((15&ue)!=8){H.msg="unknown compression method",O.mode=T;break}if(I-=4,Ie=8+(15&(ue>>>=4)),O.wbits===0)O.wbits=Ie;else if(Ie>O.wbits){H.msg="invalid window size",O.mode=T;break}O.dmax=1<<Ie,H.adler=O.check=1,O.mode=512&ue?10:b,ue=0,I=0;break;case 2:for(;I<16;){if(me===0)break e;me--,ue+=ee[ce++]<<I,I+=8}if(O.flags=ue,(255&O.flags)!=8){H.msg="unknown compression method",O.mode=T;break}if(57344&O.flags){H.msg="unknown header flags set",O.mode=T;break}O.head&&(O.head.text=ue>>8&1),512&O.flags&&(At[0]=255&ue,At[1]=ue>>>8&255,O.check=R(O.check,At,2,0)),ue=0,I=0,O.mode=3;case 3:for(;I<32;){if(me===0)break e;me--,ue+=ee[ce++]<<I,I+=8}O.head&&(O.head.time=ue),512&O.flags&&(At[0]=255&ue,At[1]=ue>>>8&255,At[2]=ue>>>16&255,At[3]=ue>>>24&255,O.check=R(O.check,At,4,0)),ue=0,I=0,O.mode=4;case 4:for(;I<16;){if(me===0)break e;me--,ue+=ee[ce++]<<I,I+=8}O.head&&(O.head.xflags=255&ue,O.head.os=ue>>8),512&O.flags&&(At[0]=255&ue,At[1]=ue>>>8&255,O.check=R(O.check,At,2,0)),ue=0,I=0,O.mode=5;case 5:if(1024&O.flags){for(;I<16;){if(me===0)break e;me--,ue+=ee[ce++]<<I,I+=8}O.length=ue,O.head&&(O.head.extra_len=ue),512&O.flags&&(At[0]=255&ue,At[1]=ue>>>8&255,O.check=R(O.check,At,2,0)),ue=0,I=0}else O.head&&(O.head.extra=null);O.mode=6;case 6:if(1024&O.flags&&((K=O.length)>me&&(K=me),K&&(O.head&&(Ie=O.head.extra_len-O.length,O.head.extra||(O.head.extra=new Array(O.head.extra_len)),c.arraySet(O.head.extra,ee,ce,K,Ie)),512&O.flags&&(O.check=R(O.check,ee,K,ce)),me-=K,ce+=K,O.length-=K),O.length))break e;O.length=0,O.mode=7;case 7:if(2048&O.flags){if(me===0)break e;K=0;do Ie=ee[ce+K++],O.head&&Ie&&O.length<65536&&(O.head.name+=String.fromCharCode(Ie));while(Ie&&K<me);if(512&O.flags&&(O.check=R(O.check,ee,K,ce)),me-=K,ce+=K,Ie)break e}else O.head&&(O.head.name=null);O.length=0,O.mode=8;case 8:if(4096&O.flags){if(me===0)break e;K=0;do Ie=ee[ce+K++],O.head&&Ie&&O.length<65536&&(O.head.comment+=String.fromCharCode(Ie));while(Ie&&K<me);if(512&O.flags&&(O.check=R(O.check,ee,K,ce)),me-=K,ce+=K,Ie)break e}else O.head&&(O.head.comment=null);O.mode=9;case 9:if(512&O.flags){for(;I<16;){if(me===0)break e;me--,ue+=ee[ce++]<<I,I+=8}if(ue!==(65535&O.check)){H.msg="header crc mismatch",O.mode=T;break}ue=0,I=0}O.head&&(O.head.hcrc=O.flags>>9&1,O.head.done=!0),H.adler=O.check=0,O.mode=b;break;case 10:for(;I<32;){if(me===0)break e;me--,ue+=ee[ce++]<<I,I+=8}H.adler=O.check=x(ue),ue=0,I=0,O.mode=11;case 11:if(O.havedict===0)return H.next_out=ge,H.avail_out=Me,H.next_in=ce,H.avail_in=me,O.hold=ue,O.bits=I,2;H.adler=O.check=1,O.mode=b;case b:if(Y===5||Y===6)break e;case 13:if(O.last){ue>>>=7&I,I-=7&I,O.mode=27;break}for(;I<3;){if(me===0)break e;me--,ue+=ee[ce++]<<I,I+=8}switch(O.last=1&ue,I-=1,3&(ue>>>=1)){case 0:O.mode=14;break;case 1:if(N(O),O.mode=20,Y===6){ue>>>=2,I-=2;break e}break;case 2:O.mode=17;break;case 3:H.msg="invalid block type",O.mode=T}ue>>>=2,I-=2;break;case 14:for(ue>>>=7&I,I-=7&I;I<32;){if(me===0)break e;me--,ue+=ee[ce++]<<I,I+=8}if((65535&ue)!=(ue>>>16^65535)){H.msg="invalid stored block lengths",O.mode=T;break}if(O.length=65535&ue,ue=0,I=0,O.mode=15,Y===6)break e;case 15:O.mode=16;case 16:if(K=O.length){if(K>me&&(K=me),K>Me&&(K=Me),K===0)break e;c.arraySet(Ae,ee,ce,K,ge),me-=K,ce+=K,Me-=K,ge+=K,O.length-=K;break}O.mode=b;break;case 17:for(;I<14;){if(me===0)break e;me--,ue+=ee[ce++]<<I,I+=8}if(O.nlen=257+(31&ue),ue>>>=5,I-=5,O.ndist=1+(31&ue),ue>>>=5,I-=5,O.ncode=4+(15&ue),ue>>>=4,I-=4,O.nlen>286||O.ndist>30){H.msg="too many length or distance symbols",O.mode=T;break}O.have=0,O.mode=18;case 18:for(;O.have<O.ncode;){for(;I<3;){if(me===0)break e;me--,ue+=ee[ce++]<<I,I+=8}O.lens[or[O.have++]]=7&ue,ue>>>=3,I-=3}for(;O.have<19;)O.lens[or[O.have++]]=0;if(O.lencode=O.lendyn,O.lenbits=7,st={bits:O.lenbits},rt=v(0,O.lens,0,19,O.lencode,0,O.work,st),O.lenbits=st.bits,rt){H.msg="invalid code lengths set",O.mode=T;break}O.have=0,O.mode=19;case 19:for(;O.have<O.nlen+O.ndist;){for(;We=(Ft=O.lencode[ue&(1<<O.lenbits)-1])>>>16&255,oe=65535&Ft,!((De=Ft>>>24)<=I);){if(me===0)break e;me--,ue+=ee[ce++]<<I,I+=8}if(oe<16)ue>>>=De,I-=De,O.lens[O.have++]=oe;else{if(oe===16){for(at=De+2;I<at;){if(me===0)break e;me--,ue+=ee[ce++]<<I,I+=8}if(ue>>>=De,I-=De,O.have===0){H.msg="invalid bit length repeat",O.mode=T;break}Ie=O.lens[O.have-1],K=3+(3&ue),ue>>>=2,I-=2}else if(oe===17){for(at=De+3;I<at;){if(me===0)break e;me--,ue+=ee[ce++]<<I,I+=8}I-=De,Ie=0,K=3+(7&(ue>>>=De)),ue>>>=3,I-=3}else{for(at=De+7;I<at;){if(me===0)break e;me--,ue+=ee[ce++]<<I,I+=8}I-=De,Ie=0,K=11+(127&(ue>>>=De)),ue>>>=7,I-=7}if(O.have+K>O.nlen+O.ndist){H.msg="invalid bit length repeat",O.mode=T;break}for(;K--;)O.lens[O.have++]=Ie}}if(O.mode===T)break;if(O.lens[256]===0){H.msg="invalid code -- missing end-of-block",O.mode=T;break}if(O.lenbits=9,st={bits:O.lenbits},rt=v(1,O.lens,0,O.nlen,O.lencode,0,O.work,st),O.lenbits=st.bits,rt){H.msg="invalid literal/lengths set",O.mode=T;break}if(O.distbits=6,O.distcode=O.distdyn,st={bits:O.distbits},rt=v(2,O.lens,O.nlen,O.ndist,O.distcode,0,O.work,st),O.distbits=st.bits,rt){H.msg="invalid distances set",O.mode=T;break}if(O.mode=20,Y===6)break e;case 20:O.mode=21;case 21:if(me>=6&&Me>=258){H.next_out=ge,H.avail_out=Me,H.next_in=ce,H.avail_in=me,O.hold=ue,O.bits=I,u(H,se),ge=H.next_out,Ae=H.output,Me=H.avail_out,ce=H.next_in,ee=H.input,me=H.avail_in,ue=O.hold,I=O.bits,O.mode===b&&(O.back=-1);break}for(O.back=0;We=(Ft=O.lencode[ue&(1<<O.lenbits)-1])>>>16&255,oe=65535&Ft,!((De=Ft>>>24)<=I);){if(me===0)break e;me--,ue+=ee[ce++]<<I,I+=8}if(We&&!(240&We)){for(Ee=De,He=We,Ue=oe;We=(Ft=O.lencode[Ue+((ue&(1<<Ee+He)-1)>>Ee)])>>>16&255,oe=65535&Ft,!(Ee+(De=Ft>>>24)<=I);){if(me===0)break e;me--,ue+=ee[ce++]<<I,I+=8}ue>>>=Ee,I-=Ee,O.back+=Ee}if(ue>>>=De,I-=De,O.back+=De,O.length=oe,We===0){O.mode=26;break}if(32&We){O.back=-1,O.mode=b;break}if(64&We){H.msg="invalid literal/length code",O.mode=T;break}O.extra=15&We,O.mode=22;case 22:if(O.extra){for(at=O.extra;I<at;){if(me===0)break e;me--,ue+=ee[ce++]<<I,I+=8}O.length+=ue&(1<<O.extra)-1,ue>>>=O.extra,I-=O.extra,O.back+=O.extra}O.was=O.length,O.mode=23;case 23:for(;We=(Ft=O.distcode[ue&(1<<O.distbits)-1])>>>16&255,oe=65535&Ft,!((De=Ft>>>24)<=I);){if(me===0)break e;me--,ue+=ee[ce++]<<I,I+=8}if(!(240&We)){for(Ee=De,He=We,Ue=oe;We=(Ft=O.distcode[Ue+((ue&(1<<Ee+He)-1)>>Ee)])>>>16&255,oe=65535&Ft,!(Ee+(De=Ft>>>24)<=I);){if(me===0)break e;me--,ue+=ee[ce++]<<I,I+=8}ue>>>=Ee,I-=Ee,O.back+=Ee}if(ue>>>=De,I-=De,O.back+=De,64&We){H.msg="invalid distance code",O.mode=T;break}O.offset=oe,O.extra=15&We,O.mode=24;case 24:if(O.extra){for(at=O.extra;I<at;){if(me===0)break e;me--,ue+=ee[ce++]<<I,I+=8}O.offset+=ue&(1<<O.extra)-1,ue>>>=O.extra,I-=O.extra,O.back+=O.extra}if(O.offset>O.dmax){H.msg="invalid distance too far back",O.mode=T;break}O.mode=25;case 25:if(Me===0)break e;if(K=se-Me,O.offset>K){if((K=O.offset-K)>O.whave&&O.sane){H.msg="invalid distance too far back",O.mode=T;break}K>O.wnext?(K-=O.wnext,Re=O.wsize-K):Re=O.wnext-K,K>O.length&&(K=O.length),fe=O.window}else fe=Ae,Re=ge-O.offset,K=O.length;K>Me&&(K=Me),Me-=K,O.length-=K;do Ae[ge++]=fe[Re++];while(--K);O.length===0&&(O.mode=21);break;case 26:if(Me===0)break e;Ae[ge++]=O.length,Me--,O.mode=21;break;case 27:if(O.wrap){for(;I<32;){if(me===0)break e;me--,ue|=ee[ce++]<<I,I+=8}if(se-=Me,H.total_out+=se,O.total+=se,se&&(H.adler=O.check=O.flags?R(O.check,Ae,se,ge-se):d(O.check,Ae,se,ge-se)),se=Me,(O.flags?ue:x(ue))!==O.check){H.msg="incorrect data check",O.mode=T;break}ue=0,I=0}O.mode=28;case 28:if(O.wrap&&O.flags){for(;I<32;){if(me===0)break e;me--,ue+=ee[ce++]<<I,I+=8}if(ue!==(4294967295&O.total)){H.msg="incorrect length check",O.mode=T;break}ue=0,I=0}O.mode=29;case 29:rt=1;break e;case T:rt=-3;break e;case 31:return-4;default:return m}return H.next_out=ge,H.avail_out=Me,H.next_in=ce,H.avail_in=me,O.hold=ue,O.bits=I,(O.wsize||se!==H.avail_out&&O.mode<T&&(O.mode<27||Y!==4))&&V(H,H.output,H.next_out,se-H.avail_out)?(O.mode=31,-4):(he-=H.avail_in,se-=H.avail_out,H.total_in+=he,H.total_out+=se,O.total+=se,O.wrap&&se&&(H.adler=O.check=O.flags?R(O.check,Ae,se,H.next_out-se):d(O.check,Ae,se,H.next_out-se)),H.data_type=O.bits+(O.last?64:0)+(O.mode===b?128:0)+(O.mode===20||O.mode===15?256:0),(he===0&&se===0||Y===4)&&rt===0&&(rt=-5),rt)},n.inflateEnd=function(H){if(!H||!H.state)return m;var Y=H.state;return Y.window&&(Y.window=null),H.state=null,0},n.inflateGetHeader=function(H,Y){var O;return H&&H.state&&2&(O=H.state).wrap?(O.head=Y,Y.done=!1,0):m},n.inflateSetDictionary=function(H,Y){var O,ee=Y.length;return H&&H.state?(O=H.state).wrap!==0&&O.mode!==11?m:O.mode===11&&d(1,Y,ee,0)!==O.check?-3:V(H,Y,ee,ee)?(O.mode=31,-4):(O.havedict=1,0):m},n.inflateInfo="pako inflate (from Nodeca project)"},670:r=>{r.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},681:r=>{r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},697:(r,n,a)=>{var c=a(981);function d(oe){for(var Ee=oe.length;--Ee>=0;)oe[Ee]=0}var R=256,u=286,v=30,m=15,b=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],T=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],k=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],F=new Array(576);d(F);var C=new Array(60);d(C);var z=new Array(512);d(z);var Q=new Array(256);d(Q);var J=new Array(29);d(J);var q,w,N,V=new Array(v);function H(oe,Ee,He,Ue,Ie){this.static_tree=oe,this.extra_bits=Ee,this.extra_base=He,this.elems=Ue,this.max_length=Ie,this.has_stree=oe&&oe.length}function Y(oe,Ee){this.dyn_tree=oe,this.max_code=0,this.stat_desc=Ee}function O(oe){return oe<256?z[oe]:z[256+(oe>>>7)]}function ee(oe,Ee){oe.pending_buf[oe.pending++]=255&Ee,oe.pending_buf[oe.pending++]=Ee>>>8&255}function Ae(oe,Ee,He){oe.bi_valid>16-He?(oe.bi_buf|=Ee<<oe.bi_valid&65535,ee(oe,oe.bi_buf),oe.bi_buf=Ee>>16-oe.bi_valid,oe.bi_valid+=He-16):(oe.bi_buf|=Ee<<oe.bi_valid&65535,oe.bi_valid+=He)}function ce(oe,Ee,He){Ae(oe,He[2*Ee],He[2*Ee+1])}function ge(oe,Ee){var He=0;do He|=1&oe,oe>>>=1,He<<=1;while(--Ee>0);return He>>>1}function me(oe,Ee,He){var Ue,Ie,rt=new Array(16),st=0;for(Ue=1;Ue<=m;Ue++)rt[Ue]=st=st+He[Ue-1]<<1;for(Ie=0;Ie<=Ee;Ie++){var at=oe[2*Ie+1];at!==0&&(oe[2*Ie]=ge(rt[at]++,at))}}function Me(oe){var Ee;for(Ee=0;Ee<u;Ee++)oe.dyn_ltree[2*Ee]=0;for(Ee=0;Ee<v;Ee++)oe.dyn_dtree[2*Ee]=0;for(Ee=0;Ee<19;Ee++)oe.bl_tree[2*Ee]=0;oe.dyn_ltree[512]=1,oe.opt_len=oe.static_len=0,oe.last_lit=oe.matches=0}function ue(oe){oe.bi_valid>8?ee(oe,oe.bi_buf):oe.bi_valid>0&&(oe.pending_buf[oe.pending++]=oe.bi_buf),oe.bi_buf=0,oe.bi_valid=0}function I(oe,Ee,He,Ue){var Ie=2*Ee,rt=2*He;return oe[Ie]<oe[rt]||oe[Ie]===oe[rt]&&Ue[Ee]<=Ue[He]}function he(oe,Ee,He){for(var Ue=oe.heap[He],Ie=He<<1;Ie<=oe.heap_len&&(Ie<oe.heap_len&&I(Ee,oe.heap[Ie+1],oe.heap[Ie],oe.depth)&&Ie++,!I(Ee,Ue,oe.heap[Ie],oe.depth));)oe.heap[He]=oe.heap[Ie],He=Ie,Ie<<=1;oe.heap[He]=Ue}function se(oe,Ee,He){var Ue,Ie,rt,st,at=0;if(oe.last_lit!==0)do Ue=oe.pending_buf[oe.d_buf+2*at]<<8|oe.pending_buf[oe.d_buf+2*at+1],Ie=oe.pending_buf[oe.l_buf+at],at++,Ue===0?ce(oe,Ie,Ee):(ce(oe,(rt=Q[Ie])+R+1,Ee),(st=b[rt])!==0&&Ae(oe,Ie-=J[rt],st),ce(oe,rt=O(--Ue),He),(st=T[rt])!==0&&Ae(oe,Ue-=V[rt],st));while(at<oe.last_lit);ce(oe,256,Ee)}function K(oe,Ee){var He,Ue,Ie,rt=Ee.dyn_tree,st=Ee.stat_desc.static_tree,at=Ee.stat_desc.has_stree,Ft=Ee.stat_desc.elems,At=-1;for(oe.heap_len=0,oe.heap_max=573,He=0;He<Ft;He++)rt[2*He]!==0?(oe.heap[++oe.heap_len]=At=He,oe.depth[He]=0):rt[2*He+1]=0;for(;oe.heap_len<2;)rt[2*(Ie=oe.heap[++oe.heap_len]=At<2?++At:0)]=1,oe.depth[Ie]=0,oe.opt_len--,at&&(oe.static_len-=st[2*Ie+1]);for(Ee.max_code=At,He=oe.heap_len>>1;He>=1;He--)he(oe,rt,He);Ie=Ft;do He=oe.heap[1],oe.heap[1]=oe.heap[oe.heap_len--],he(oe,rt,1),Ue=oe.heap[1],oe.heap[--oe.heap_max]=He,oe.heap[--oe.heap_max]=Ue,rt[2*Ie]=rt[2*He]+rt[2*Ue],oe.depth[Ie]=(oe.depth[He]>=oe.depth[Ue]?oe.depth[He]:oe.depth[Ue])+1,rt[2*He+1]=rt[2*Ue+1]=Ie,oe.heap[1]=Ie++,he(oe,rt,1);while(oe.heap_len>=2);oe.heap[--oe.heap_max]=oe.heap[1],(function(or,ar){var kr,Er,pr,vr,xr,fi,Rr=ar.dyn_tree,Ir=ar.max_code,Di=ar.stat_desc.static_tree,wi=ar.stat_desc.has_stree,Hi=ar.stat_desc.extra_bits,pe=ar.stat_desc.extra_base,Se=ar.stat_desc.max_length,Le=0;for(vr=0;vr<=m;vr++)or.bl_count[vr]=0;for(Rr[2*or.heap[or.heap_max]+1]=0,kr=or.heap_max+1;kr<573;kr++)(vr=Rr[2*Rr[2*(Er=or.heap[kr])+1]+1]+1)>Se&&(vr=Se,Le++),Rr[2*Er+1]=vr,Er>Ir||(or.bl_count[vr]++,xr=0,Er>=pe&&(xr=Hi[Er-pe]),fi=Rr[2*Er],or.opt_len+=fi*(vr+xr),wi&&(or.static_len+=fi*(Di[2*Er+1]+xr)));if(Le!==0){do{for(vr=Se-1;or.bl_count[vr]===0;)vr--;or.bl_count[vr]--,or.bl_count[vr+1]+=2,or.bl_count[Se]--,Le-=2}while(Le>0);for(vr=Se;vr!==0;vr--)for(Er=or.bl_count[vr];Er!==0;)(pr=or.heap[--kr])>Ir||(Rr[2*pr+1]!==vr&&(or.opt_len+=(vr-Rr[2*pr+1])*Rr[2*pr],Rr[2*pr+1]=vr),Er--)}})(oe,Ee),me(rt,At,oe.bl_count)}function Re(oe,Ee,He){var Ue,Ie,rt=-1,st=Ee[1],at=0,Ft=7,At=4;for(st===0&&(Ft=138,At=3),Ee[2*(He+1)+1]=65535,Ue=0;Ue<=He;Ue++)Ie=st,st=Ee[2*(Ue+1)+1],++at<Ft&&Ie===st||(at<At?oe.bl_tree[2*Ie]+=at:Ie!==0?(Ie!==rt&&oe.bl_tree[2*Ie]++,oe.bl_tree[32]++):at<=10?oe.bl_tree[34]++:oe.bl_tree[36]++,at=0,rt=Ie,st===0?(Ft=138,At=3):Ie===st?(Ft=6,At=3):(Ft=7,At=4))}function fe(oe,Ee,He){var Ue,Ie,rt=-1,st=Ee[1],at=0,Ft=7,At=4;for(st===0&&(Ft=138,At=3),Ue=0;Ue<=He;Ue++)if(Ie=st,st=Ee[2*(Ue+1)+1],!(++at<Ft&&Ie===st)){if(at<At)do ce(oe,Ie,oe.bl_tree);while(--at!==0);else Ie!==0?(Ie!==rt&&(ce(oe,Ie,oe.bl_tree),at--),ce(oe,16,oe.bl_tree),Ae(oe,at-3,2)):at<=10?(ce(oe,17,oe.bl_tree),Ae(oe,at-3,3)):(ce(oe,18,oe.bl_tree),Ae(oe,at-11,7));at=0,rt=Ie,st===0?(Ft=138,At=3):Ie===st?(Ft=6,At=3):(Ft=7,At=4)}}d(V);var De=!1;function We(oe,Ee,He,Ue){Ae(oe,0+(Ue?1:0),3),(function(Ie,rt,st,at){ue(Ie),ee(Ie,st),ee(Ie,~st),c.arraySet(Ie.pending_buf,Ie.window,rt,st,Ie.pending),Ie.pending+=st})(oe,Ee,He)}n._tr_init=function(oe){De||((function(){var Ee,He,Ue,Ie,rt,st=new Array(16);for(Ue=0,Ie=0;Ie<28;Ie++)for(J[Ie]=Ue,Ee=0;Ee<1<<b[Ie];Ee++)Q[Ue++]=Ie;for(Q[Ue-1]=Ie,rt=0,Ie=0;Ie<16;Ie++)for(V[Ie]=rt,Ee=0;Ee<1<<T[Ie];Ee++)z[rt++]=Ie;for(rt>>=7;Ie<v;Ie++)for(V[Ie]=rt<<7,Ee=0;Ee<1<<T[Ie]-7;Ee++)z[256+rt++]=Ie;for(He=0;He<=m;He++)st[He]=0;for(Ee=0;Ee<=143;)F[2*Ee+1]=8,Ee++,st[8]++;for(;Ee<=255;)F[2*Ee+1]=9,Ee++,st[9]++;for(;Ee<=279;)F[2*Ee+1]=7,Ee++,st[7]++;for(;Ee<=287;)F[2*Ee+1]=8,Ee++,st[8]++;for(me(F,287,st),Ee=0;Ee<v;Ee++)C[2*Ee+1]=5,C[2*Ee]=ge(Ee,5);q=new H(F,b,257,u,m),w=new H(C,T,0,v,m),N=new H(new Array(0),x,0,19,7)})(),De=!0),oe.l_desc=new Y(oe.dyn_ltree,q),oe.d_desc=new Y(oe.dyn_dtree,w),oe.bl_desc=new Y(oe.bl_tree,N),oe.bi_buf=0,oe.bi_valid=0,Me(oe)},n._tr_stored_block=We,n._tr_flush_block=function(oe,Ee,He,Ue){var Ie,rt,st=0;oe.level>0?(oe.strm.data_type===2&&(oe.strm.data_type=(function(at){var Ft,At=4093624447;for(Ft=0;Ft<=31;Ft++,At>>>=1)if(1&At&&at.dyn_ltree[2*Ft]!==0)return 0;if(at.dyn_ltree[18]!==0||at.dyn_ltree[20]!==0||at.dyn_ltree[26]!==0)return 1;for(Ft=32;Ft<R;Ft++)if(at.dyn_ltree[2*Ft]!==0)return 1;return 0})(oe)),K(oe,oe.l_desc),K(oe,oe.d_desc),st=(function(at){var Ft;for(Re(at,at.dyn_ltree,at.l_desc.max_code),Re(at,at.dyn_dtree,at.d_desc.max_code),K(at,at.bl_desc),Ft=18;Ft>=3&&at.bl_tree[2*k[Ft]+1]===0;Ft--);return at.opt_len+=3*(Ft+1)+5+5+4,Ft})(oe),Ie=oe.opt_len+3+7>>>3,(rt=oe.static_len+3+7>>>3)<=Ie&&(Ie=rt)):Ie=rt=He+5,He+4<=Ie&&Ee!==-1?We(oe,Ee,He,Ue):oe.strategy===4||rt===Ie?(Ae(oe,2+(Ue?1:0),3),se(oe,F,C)):(Ae(oe,4+(Ue?1:0),3),(function(at,Ft,At,or){var ar;for(Ae(at,Ft-257,5),Ae(at,At-1,5),Ae(at,or-4,4),ar=0;ar<or;ar++)Ae(at,at.bl_tree[2*k[ar]+1],3);fe(at,at.dyn_ltree,Ft-1),fe(at,at.dyn_dtree,At-1)})(oe,oe.l_desc.max_code+1,oe.d_desc.max_code+1,st+1),se(oe,oe.dyn_ltree,oe.dyn_dtree)),Me(oe),Ue&&ue(oe)},n._tr_tally=function(oe,Ee,He){return oe.pending_buf[oe.d_buf+2*oe.last_lit]=Ee>>>8&255,oe.pending_buf[oe.d_buf+2*oe.last_lit+1]=255&Ee,oe.pending_buf[oe.l_buf+oe.last_lit]=255&He,oe.last_lit++,Ee===0?oe.dyn_ltree[2*He]++:(oe.matches++,Ee--,oe.dyn_ltree[2*(Q[He]+R+1)]++,oe.dyn_dtree[2*O(Ee)]++),oe.last_lit===oe.lit_bufsize-1},n._tr_align=function(oe){Ae(oe,2,3),ce(oe,256,F),(function(Ee){Ee.bi_valid===16?(ee(Ee,Ee.bi_buf),Ee.bi_buf=0,Ee.bi_valid=0):Ee.bi_valid>=8&&(Ee.pending_buf[Ee.pending++]=255&Ee.bi_buf,Ee.bi_buf>>=8,Ee.bi_valid-=8)})(oe)}},701:r=>{r.exports=function(n,a,c,d){for(var R=65535&n,u=n>>>16&65535,v=0;c!==0;){c-=v=c>2e3?2e3:c;do u=u+(R=R+a[d++]|0)|0;while(--v);R%=65521,u%=65521}return R|u<<16}},746:r=>{r.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},788:(r,n,a)=>{var c={};(0,a(981).assign)(c,a(71),a(3),a(681)),r.exports=c},797:(r,n,a)=>{a.r(n),a.d(n,{VASP:()=>R});var c=a(378),d=a(392);function R(u,v={}){var m=[[]],b={};const T=v.assignBonds===void 0||v.assignBonds;var x=u.replace(/^\s+/,"").split(/\r?\n/);if(x.length<3)return m;if(!x[1].match(/\d+/))return console.log("Warning: second line of the vasp structure file must be a number"),m;if(b.length=parseFloat(x[1]),b.length<0)return console.log("Warning: Vasp implementation for negative lattice lengths is not yet available"),m;b.xVec=new Float32Array(x[2].replace(/^\s+/,"").split(/\s+/)),b.yVec=new Float32Array(x[3].replace(/^\s+/,"").split(/\s+/)),b.zVec=new Float32Array(x[4].replace(/^\s+/,"").split(/\s+/));var k=new c.Matrix3(b.xVec[0],b.xVec[1],b.xVec[2],b.yVec[0],b.yVec[1],b.yVec[2],b.zVec[0],b.zVec[1],b.zVec[2]);k.multiplyScalar(b.length),m.modelData=[{symmetries:[],cryst:{matrix:k}}];var F=x[5].trim().split(/\s+/),C=new Int16Array(x[6].trim().split(/\s+/)),z=x[7].trim(),Q=!1;if(z.match(/S/)&&(Q=!0,z=x[8].trim()),z.toLowerCase()[0]=="c")z="cartesian";else{if(z.toLowerCase()[0]!="d")return console.log("Warning: Unknown vasp mode in POSCAR file: mode must be either C(artesian) or D(irect)"),m;z="direct"}if(F.length!=C.length)return console.log("Warning: declaration of atomary species wrong:"),console.log(F),console.log(C),m;Q?x.splice(0,9):x.splice(0,8);for(var J=0,q=0,w=F.length;q<w;q++){for(var N=F[q],V=0,H=C[q];V<H;V++){var Y=new Float32Array(x[J+V].trim().split(/\s+/)),O={};O.elem=N,z=="cartesian"?(O.x=b.length*Y[0],O.y=b.length*Y[1],O.z=b.length*Y[2]):(O.x=b.length*(Y[0]*b.xVec[0]+Y[1]*b.yVec[0]+Y[2]*b.zVec[0]),O.y=b.length*(Y[0]*b.xVec[1]+Y[1]*b.yVec[1]+Y[2]*b.zVec[1]),O.z=b.length*(Y[0]*b.xVec[2]+Y[1]*b.yVec[2]+Y[2]*b.zVec[2])),O.bonds=[],O.bondOrder=[],m[0].push(O)}J+=C[q]}if(T)for(let ee=0;ee<m.length;ee++)(0,d.assignBonds)(m[ee],v);return m}},834:r=>{r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},848:(r,n,a)=>{a.r(n),a.d(n,{VolumeData:()=>m});var c=a(864),d=a(529),R=a(797),u=a(865),v=a(75);class m{constructor(T,x,k){if(this.unit={x:1,y:1,z:1},this.origin={x:0,y:0,z:0},this.size={x:0,y:0,z:0},this.data=new Float32Array([]),this.matrix=null,this.inversematrix=null,this.isbinary=new Set(["ccp4","CCP4"]),this.getCoordinates=function(J){var q=J/(this.size.y*this.size.z),w=J%(this.size.y*this.size.z),N=J%this.size.z;return q*=this.unit.x,w*=this.unit.y,N*=this.unit.z,{x:q+=this.origin.x,y:w+=this.origin.y,z:N+=this.origin.z}},this.vasp=function(J){var q=J.replace(/^\s+/,"").split(/[\n\r]/),w=(0,R.VASP)(J)[0].length;if(w==0)return console.warn("No good formating of CHG or CHGCAR file, not atomic information provided in the file."),void(this.data=[]);var N,V=1.889725992,H=parseFloat(q[1]);N=q[2].replace(/^\s+/,"").split(/\s+/);var Y=new d.Vector3(parseFloat(N[0]),parseFloat(N[1]),parseFloat(N[2])).multiplyScalar(H*V);N=q[3].replace(/^\s+/,"").split(/\s+/);var O=new d.Vector3(parseFloat(N[0]),parseFloat(N[1]),parseFloat(N[2])).multiplyScalar(H*V);N=q[4].replace(/^\s+/,"").split(/\s+/);var ee=new d.Vector3(parseFloat(N[0]),parseFloat(N[1]),parseFloat(N[2])).multiplyScalar(H*V),Ae=Y.x*(O.y*ee.z-ee.y*O.z)-O.x*(Y.y*ee.z-ee.y*Y.z)+ee.x*(Y.y*O.z-O.y*Y.z),ce=1/(Ae=Math.abs(Ae)/Math.pow(V,3));q.splice(0,8+w+1);var ge=q[0].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),me=Math.abs(parseFloat(ge[0])),Me=Math.abs(parseFloat(ge[1])),ue=Math.abs(parseFloat(ge[2])),I=this.origin=new d.Vector3(0,0,0);this.size={x:me,y:Me,z:ue},this.unit=new d.Vector3(Y.x,O.y,ee.z),Y=Y.multiplyScalar(1/(V*me)),O=O.multiplyScalar(1/(V*Me)),ee=ee.multiplyScalar(1/(V*ue)),Y.y==0&&Y.z==0&&O.x==0&&O.z==0&&ee.x==0&&ee.y==0||(this.matrix=new d.Matrix4(Y.x,O.x,ee.x,0,Y.y,O.y,ee.y,0,Y.z,O.z,ee.z,0,0,0,0,1),this.matrix=this.matrix.multiplyMatrices(this.matrix,new d.Matrix4().makeTranslation(I.x,I.y,I.z)),this.origin=new d.Vector3(0,0,0),this.unit=new d.Vector3(1,1,1)),q.splice(0,1);var he=q.join(" "),se=(he=he.replace(/^\s+/,"")).split(/[\s\r]+/);se.splice(me*Me*ue+1);for(var K=Float32Array.from(se,parseFloat),Re=0;Re<K.length;Re++)K[Re]=K[Re]*ce*.036749309;this.data=K},this.dx=function(J){var q,w=J.split(/[\n\r]+/),N=/gridpositions\s+counts\s+(\d+)\s+(\d+)\s+(\d+)/,V=/^origin\s+(\S+)\s+(\S+)\s+(\S+)/,H=/^delta\s+(\S+)\s+(\S+)\s+(\S+)/,Y=/data follows/,O=0;for(O=0;O<w.length;O++){var ee=w[O];if(q=N.exec(ee)){var Ae=parseInt(q[1]),ce=parseInt(q[2]),ge=parseInt(q[3]);this.size={x:Ae,y:ce,z:ge}}else if(q=H.exec(ee)){var me=parseFloat(q[1]);if(parseFloat(q[2])==0&&parseFloat(q[3])==0||console.warn("Non-orthogonal delta matrix not currently supported in dx format"),ee=w[O+=1],(q=H.exec(ee))==null)return void console.error("Parse error in dx delta matrix");var Me=parseFloat(q[2]);if(parseFloat(q[1])==0&&parseFloat(q[3])==0||console.warn("Non-orthogonal delta matrix not currently supported in dx format"),ee=w[O+=1],(q=H.exec(ee))==null)return void console.error("Parse error in dx delta matrix");var ue=parseFloat(q[3]);parseFloat(q[1])==0&&parseFloat(q[2])==0||console.warn("Non-orthogonal delta matrix not currently supported in dx format"),this.unit=new d.Vector3(me,Me,ue)}else if(q=V.exec(ee)){var I=parseFloat(q[1]),he=parseFloat(q[2]),se=parseFloat(q[3]);this.origin=new d.Vector3(I,he,se)}else if(q=Y.exec(ee))break}if(O+=1,this.size&&this.origin&&this.unit&&this.size){var K=w.splice(O).join(" ").split(/[\s\r]+/);this.data=Float32Array.from(K,parseFloat)}else console.error("Error parsing dx format")},x=x.toLowerCase(),/\.gz$/.test(x)){x=x.replace(/\.gz$/,"");try{this[x]&&this.isbinary.has(x)?(typeof T=="string"&&(T=(0,c.base64ToArray)(T)),T=(0,v.inflate)(T)):T=new TextDecoder("utf-8").decode((0,v.inflate)(T))}catch(J){console.error(J)}}if(this[x]&&(this.isbinary.has(x)&&typeof T=="string"&&(T=(0,c.base64ToArray)(T)),this[x](T)),k){if(k.negate)for(let J=0,q=this.data.length;J<q;J++)this.data[J]=-this.data[J];if(k.normalize){var F=0;for(let J=0,q=this.data.length;J<q;J++)F+=this.data[J];var C=F/this.data.length;F=0;for(let J=0,q=this.data.length;J<q;J++){var z=this.data[J]-C;F+=z*z}var Q=F/this.data.length;for(let J=0,q=this.data.length;J<q;J++)this.data[J]=(this.data[J]-C)/Q}}}getIndex(T,x,k){if(this.matrix){this.inversematrix==null&&(this.inversematrix=new d.Matrix4().getInverse(this.matrix));var F=new d.Vector3(T,x,k);T=(F=F.applyMatrix4(this.inversematrix)).x,x=F.y,k=F.z}else T-=this.origin.x,x-=this.origin.y,k-=this.origin.z,T/=this.unit.x,x/=this.unit.y,k/=this.unit.z;return T=Math.round(T),x=Math.round(x),k=Math.round(k),T<0||T>=this.size.x||x<0||x>=this.size.y||k<0||k>=this.size.z?-1:T*this.size.y*this.size.z+x*this.size.z+k}getVal(T,x,k){let F=this.getIndex(T,x,k);return F<0?0:this.data[F]}cube(T){var x=T.split(/\r?\n/);if(!(x.length<6)){var k=(0,u.CUBE)(T,{}).modelData[0].cryst,F=x[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),C=parseFloat(F[0]),z=Math.abs(C);this.origin=k.origin,this.size=k.size,this.unit=k.unit,this.matrix=k.matrix4;var Q=6;C<0&&Q++;var J=x.splice(z+Q).join(" "),q=(J=J.replace(/^\s+/,"")).split(/[\s\r]+/);this.data=Float32Array.from(q,parseFloat)}}ccp4(T){var x={};T=new Int8Array(T);var k=new Int32Array(T.buffer,0,56),F=new Float32Array(T.buffer,0,56),C=new DataView(T.buffer);if(x.MAP=String.fromCharCode(C.getUint8(208),C.getUint8(209),C.getUint8(210),C.getUint8(211)),x.MACHST=[C.getUint8(212),C.getUint8(213)],x.MACHST[0]===17&&x.MACHST[1]===17)for(var z=T.byteLength,Q=0;Q<z;Q+=4)C.setFloat32(Q,C.getFloat32(Q),!0);x.NX=k[0],x.NY=k[1],x.NZ=k[2],x.MODE=k[3],x.NXSTART=k[4],x.NYSTART=k[5],x.NZSTART=k[6],x.MX=k[7],x.MY=k[8],x.MZ=k[9],x.xlen=F[10],x.ylen=F[11],x.zlen=F[12],x.alpha=F[13],x.beta=F[14],x.gamma=F[15],x.MAPC=k[16],x.MAPR=k[17],x.MAPS=k[18],x.DMIN=F[19],x.DMAX=F[20],x.DMEAN=F[21],x.ISPG=k[22],x.NSYMBT=k[23],x.LSKFLG=k[24],x.originX=F[49],x.originY=F[50],x.originZ=F[51],x.ARMS=F[54];var J=x,q=[J.xlen,0,0],w=[J.ylen*Math.cos(Math.PI/180*J.gamma),J.ylen*Math.sin(Math.PI/180*J.gamma),0],N=[J.zlen*Math.cos(Math.PI/180*J.beta),J.zlen*(Math.cos(Math.PI/180*J.alpha)-Math.cos(Math.PI/180*J.gamma)*Math.cos(Math.PI/180*J.beta))/Math.sin(Math.PI/180*J.gamma),0];N[2]=Math.sqrt(J.zlen*J.zlen*Math.sin(Math.PI/180*J.beta)*Math.sin(Math.PI/180*J.beta)-N[1]*N[1]);var V=[0,q,w,N],H=[0,J.MX,J.MY,J.MZ],Y=[0,J.MAPC,J.MAPR,J.MAPS];this.matrix=new d.Matrix4,this.matrix.set(V[Y[1]][0]/H[Y[1]],V[Y[2]][0]/H[Y[2]],V[Y[3]][0]/H[Y[3]],0,V[Y[1]][1]/H[Y[1]],V[Y[2]][1]/H[Y[2]],V[Y[3]][1]/H[Y[3]],0,V[Y[1]][2]/H[Y[1]],V[Y[2]][2]/H[Y[2]],V[Y[3]][2]/H[Y[3]],0,0,0,0,1),this.matrix=this.matrix.multiplyMatrices(this.matrix,new d.Matrix4().makeTranslation(J.NXSTART+J.originX,J.NYSTART+J.originY,J.NZSTART+J.originZ)),this.origin=new d.Vector3(0,0,0),this.unit=new d.Vector3(1,1,1),this.size={x:x.NX,y:x.NY,z:x.NZ},this.dimensionorder=[x.MAPC,x.MAPR,x.MAPS];var O=new Float32Array(T.buffer,1024+x.NSYMBT),ee=x.NX,Ae=x.NY,ce=x.NZ;this.data=new Float32Array(ee*Ae*ce);for(let ge=0;ge<ee;ge++)for(let me=0;me<Ae;me++)for(let Me=0;Me<ce;Me++)this.data[(ge*Ae+me)*ce+Me]=O[(Me*Ae+me)*ee+ge]}}},864:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{PausableTimer:()=>PausableTimer,adjustVolumeStyle:()=>adjustVolumeStyle,base64ToArray:()=>base64ToArray,deepCopy:()=>deepCopy,download:()=>download,extend:()=>extend,get:()=>get,getAtomProperty:()=>getAtomProperty,getColorFromStyle:()=>getColorFromStyle,getElement:()=>getElement,getExtent:()=>getExtent,getPropertyRange:()=>getPropertyRange,getbin:()=>getbin,inflateString:()=>inflateString,isEmptyObject:()=>isEmptyObject,isNumeric:()=>isNumeric,makeFunction:()=>makeFunction,mergeGeos:()=>mergeGeos,specStringToObject:()=>specStringToObject});var _Gradient__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(546),_VolumeData__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(848),_colors__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(222),pako__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(75);function extend(r,n){for(var a in n)n.hasOwnProperty(a)&&n[a]!==void 0&&(r[a]=n[a]);return r}function deepCopy(r){let n,a,c;if(r==null)return{};if(typeof r!="object"||r===null)return r;for(c in n=Array.isArray(r)?[]:{},r)a=r[c],n[c]=deepCopy(a);return n}function isNumeric(r){var n=typeof r;return(n==="number"||n==="string")&&!isNaN(r-parseFloat(r))}function isEmptyObject(r){return Object.keys(r).length===0}function makeFunction(callback){return callback&&typeof callback=="string"&&(callback=eval("("+callback+")")),callback&&typeof callback!="function"?(console.warn("Invalid callback provided."),()=>{}):callback}function adjustVolumeStyle(r){r&&(!r.volformat||r.voldata instanceof _VolumeData__WEBPACK_IMPORTED_MODULE_1__.VolumeData||(r.voldata=new _VolumeData__WEBPACK_IMPORTED_MODULE_1__.VolumeData(r.voldata,r.volformat)),r.volscheme&&(r.volscheme=_Gradient__WEBPACK_IMPORTED_MODULE_0__.Gradient.getGradient(r.volscheme)))}function getExtent(r,n){var a,c,d,R,u,v,m,b,T,x,k=!n;if(a=c=d=9999,R=u=v=-9999,m=b=T=x=0,r.length===0)return[[0,0,0],[0,0,0],[0,0,0]];for(var F=0;F<r.length;F++){var C=r[F];if(C!==void 0&&isFinite(C.x)&&isFinite(C.y)&&isFinite(C.z)&&(x++,m+=C.x,b+=C.y,T+=C.z,a=a<C.x?a:C.x,c=c<C.y?c:C.y,d=d<C.z?d:C.z,R=R>C.x?R:C.x,u=u>C.y?u:C.y,v=v>C.z?v:C.z,C.symmetries&&k))for(var z=0;z<C.symmetries.length;z++)x++,m+=C.symmetries[z].x,b+=C.symmetries[z].y,T+=C.symmetries[z].z,a=a<C.symmetries[z].x?a:C.symmetries[z].x,c=c<C.symmetries[z].y?c:C.symmetries[z].y,d=d<C.symmetries[z].z?d:C.symmetries[z].z,R=R>C.symmetries[z].x?R:C.symmetries[z].x,u=u>C.symmetries[z].y?u:C.symmetries[z].y,v=v>C.symmetries[z].z?v:C.symmetries[z].z}return[[a,c,d],[R,u,v],[m/x,b/x,T/x]]}function getPropertyRange(r,n){for(var a=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,d=0,R=r.length;d<R;d++){var u=getAtomProperty(r[d],n);u!=null&&(u<a&&(a=u),u>c&&(c=u))}return isFinite(a)||isFinite(c)?isFinite(a)?isFinite(c)||(c=a):a=c:a=c=0,[a,c]}class PausableTimer{constructor(n,a,c){this.total_time_run=0,this.fn=n,this.arg=c,this.countdown=a,this.start_time=new Date().getTime(),this.ident=setTimeout(n,a,c)}cancel(){clearTimeout(this.ident)}pause(){clearTimeout(this.ident),this.total_time_run=new Date().getTime()-this.start_time}resume(){this.ident=setTimeout(this.fn,Math.max(0,this.countdown-this.total_time_run),this.arg)}}function base64ToArray(r){for(var n=window.atob(r),a=n.length,c=new Uint8Array(a),d=0;d<a;d++)c[d]=n.charCodeAt(d);return c}function getAtomProperty(r,n){var a=null;return r.properties&&r.properties[n]!==void 0?a=r.properties[n]:r[n]!==void 0&&(a=r[n]),a}function mergeGeos(r,n){var a=n.geometry;a!==void 0&&r.geometryGroups.push(a.geometryGroups[0])}function specStringToObject(r){if(typeof r=="object"||r===void 0||r==null)return r;try{return JSON.parse(r)}catch{}var n=function(k){return isNumeric(k)?Math.floor(parseFloat(k))==parseInt(k)||k.indexOf(".")>=0?parseFloat(k):parseInt(k):k==="true"||k!=="false"&&k},a={};if((r=r.replace(/%7E/g,"~"))==="all")return a;for(var c=r.split(";"),d=0;d<c.length;d++){var R=c[d].split(":"),u=R[0],v={},m=R[1];if(m)if((m=m.replace(/~/g,"=")).indexOf("=")!==-1)for(var b=m.split(","),T=0;T<b.length;T++){var x=b[T].split("=",2);v[x[0]]=n(x[1])}else v=m.indexOf(",")!==-1?m.split(","):n(m);a[u]=v}return a}function checkStatus(r){if(!r.ok)throw new Error(`HTTP ${r.status} - ${r.statusText}`);return r}function get(r,n){var a=fetch(r).then(checkStatus).then(c=>c.text());return n?a.then(n):a}function getbin(r,n,a,c){var d;return d=a=="POST"?fetch(r,{method:"POST",body:c}).then(R=>checkStatus(R)).then(R=>R.arrayBuffer()):fetch(r).then(R=>checkStatus(R)).then(R=>R.arrayBuffer()),n?d.then(n):d}function download(r,n,a,c){var d="",R="",u="",v=null,m=n.addModel();if(r.indexOf(":")<0&&(r=r.length==4?"pdb:"+r:isNaN(r)?"url:"+r:"cid:"+r),r.substring(0,5)=="mmtf:"&&(console.warn("WARNING: MMTF now deprecated.  Reverting to bcif."),r="bcif:"+r.slice(5)),r.substring(0,5)==="bcif:")r=r.substring(5).toUpperCase(),u="https://models.rcsb.org/"+r+".bcif.gz",a&&a.noComputeSecondaryStructure===void 0&&(a.noComputeSecondaryStructure=!0),v=new Promise(function(T){getbin(u).then(function(x){m.addMolData(x,"bcif.gz",a),n.zoomTo(),n.render(),T(m)},function(){console.error("fetch of "+u+" failed.")})});else{if(r.substring(0,4)==="pdb:"){if(d="bcif",a&&a.format&&(d=a.format),a&&a.noComputeSecondaryStructure===void 0&&(a.noComputeSecondaryStructure=!0),!(r=r.substring(4).toUpperCase()).match(/^[1-9][A-Za-z0-9]{3}$/))return void alert("Wrong PDB ID");d=="bcif"?u="https://models.rcsb.org/"+r.toUpperCase()+".bcif.gz":(R=a&&a.pdbUri?a.pdbUri:"https://files.rcsb.org/view/",u=R+r+"."+d)}else if(r.substring(0,4)=="cid:"){if(d="sdf",!(r=r.substring(4)).match(/^[0-9]+$/))return void alert("Wrong Compound ID");u="https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+r+"/SDF?record_type=3d"}else r.substring(0,4)=="url:"&&(u=r.substring(4),d=u);var b=function(T){m.addMolData(T,d,a),n.zoomTo(),n.render()};v=new Promise(function(T){d=="bcif"?getbin(u).then(function(x){b(x),T(m)}).catch(function(){R=a&&a.pdbUri?a.pdbUri:"https://files.rcsb.org/view/",u=R+r+".pdb",d="pdb",console.warn("falling back to pdb format"),get(u).then(function(x){b(x),T(m)}).catch(function(x){b(""),T(m),console.error("fetch of "+u+" failed: "+x.statusText)})}):get(u).then(function(x){b(x),T(m)}).catch(function(x){b(""),T(m),console.error("fetch of "+u+" failed: "+x.statusText)})})}return c?(v.then(function(T){c(T)}),m):v}function getColorFromStyle(r,n){let a=n.colorscheme;if(_colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[a]!==void 0)a=_colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[a];else if(typeof a=="string"&&a.endsWith("Carbon")){let R=a.substring(0,a.lastIndexOf("Carbon")).toLowerCase();if(_colors__WEBPACK_IMPORTED_MODULE_2__.htmlColors[R]!==void 0){let u=Object.assign({},_colors__WEBPACK_IMPORTED_MODULE_2__.elementColors.defaultColors);u.C=_colors__WEBPACK_IMPORTED_MODULE_2__.htmlColors[R],_colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[a]={prop:"elem",map:u},a=_colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[a]}}let c=r.color;if(n.color!==void 0&&n.color!="spectrum"&&(c=n.color),a!==void 0){let R,u;if(_colors__WEBPACK_IMPORTED_MODULE_2__.elementColors[a]!==void 0)a=_colors__WEBPACK_IMPORTED_MODULE_2__.elementColors[a],a[r[a.prop]]!==void 0&&(c=a.map[r[a.prop]]);else if(a[r[a.prop]]!==void 0)c=a.map[r[a.prop]];else if(a.prop!==void 0&&a.gradient!==void 0){R=a.prop;var d=a.gradient;d instanceof _Gradient__WEBPACK_IMPORTED_MODULE_0__.GradientType||(d=(0,_Gradient__WEBPACK_IMPORTED_MODULE_0__.getGradient)(a));let v=d.range()||[-1,1];u=getAtomProperty(r,R),u!=null&&(c=d.valueToHex(u,v))}else a.prop!==void 0&&a.map!==void 0?(R=a.prop,u=getAtomProperty(r,R),a.map[u]!==void 0&&(c=a.map[u])):n.colorscheme[r.elem]!==void 0?c=n.colorscheme[r.elem]:console.warn("Could not interpret colorscheme "+a)}else n.colorfunc!==void 0&&(c=n.colorfunc(r));return _colors__WEBPACK_IMPORTED_MODULE_2__.CC.color(c)}function getElement(r){let n=r;return typeof r=="string"?n=document.querySelector("#"+r):typeof r=="object"&&r.get&&(n=r.get(0)),n}function inflateString(r,n=!0){let a;return a=typeof r=="string"?new TextEncoder().encode(r):new Uint8Array(r),(0,pako__WEBPACK_IMPORTED_MODULE_3__.inflate)(a,{to:n?"string":null})}},865:(r,n,a)=>{a.r(n),a.d(n,{CUBE:()=>u});var c=a(378),d=a(392);const R={1:"H",2:"He",3:"Li",4:"Be",5:"B",6:"C",7:"N",8:"O",9:"F",10:"Ne",11:"Na",12:"Mg",13:"Al",14:"Si",15:"P",16:"S",17:"Cl",18:"Ar",19:"K",20:"Ca",21:"Sc",22:"Ti",23:"V",24:"Cr",25:"Mn",26:"Fe",27:"Co",28:"Ni",29:"Cu",30:"Zn",31:"Ga",32:"Ge",33:"As",34:"Se",35:"Br",36:"Kr",37:"Rb",38:"Sr",39:"Y",40:"Zr",41:"Nb",42:"Mo",43:"Tc",44:"Ru",45:"Rh",46:"Pd",47:"Ag",48:"Cd",49:"In",50:"Sn",51:"Sb",52:"Te",53:"I",54:"Xe",55:"Cs",56:"Ba",71:"Lu",72:"Hf",73:"Ta",74:"W",75:"Re",76:"Os",77:"Ir",78:"Pt",79:"Au",80:"Hg",81:"Tl",82:"Pb",83:"Bi",84:"Po",85:"At",86:"Rn",87:"Fr",88:"Ra",104:"Rf",105:"Db",106:"Sg",107:"Bh",108:"Hs",109:"Mt",110:"Ds",111:"Rg",112:"Cn",113:"Nh",114:"Fl",115:"Mc",116:"Lv",117:"Ts",118:"Og",57:"La",58:"Ce",59:"Pr",60:"Nd",61:"Pm",62:"Sm",63:"Eu",64:"Gd",65:"Tb",66:"Dy",67:"Ho",68:"Er",69:"Tm",70:"Yb",89:"Ac",90:"Th",91:"Pa",92:"U",93:"Np",94:"Pu",95:"Am",96:"Cm",97:"Bk",98:"Cf",99:"Es",100:"Fm",101:"Md",102:"No"};function u(v,m){m=m||{};const b=[[]];let T=v.split(/\r?\n/);const x=m.assignBonds===void 0||m.assignBonds;if(T.length<6)return b;let k=T[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const F=Math.abs(parseFloat(k[0]));let C={origin:void 0,size:void 0,unit:void 0,matrix4:void 0,matrix:void 0};const z=C.origin=new c.Vector3(parseFloat(k[1]),parseFloat(k[2]),parseFloat(k[3]));k=T[3].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),k=T[3].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const Q=k[0]>0?.529177:1;z.multiplyScalar(Q);const J=Math.abs(k[0]),q=new c.Vector3(parseFloat(k[1]),parseFloat(k[2]),parseFloat(k[3])).multiplyScalar(Q);k=T[4].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const w=Math.abs(k[0]),N=new c.Vector3(parseFloat(k[1]),parseFloat(k[2]),parseFloat(k[3])).multiplyScalar(Q);k=T[5].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const V=Math.abs(k[0]),H=new c.Vector3(parseFloat(k[1]),parseFloat(k[2]),parseFloat(k[3])).multiplyScalar(Q);if(C.size={x:J,y:w,z:V},C.unit=new c.Vector3(q.x,N.y,H.z),q.y!=0||q.z!=0||N.x!=0||N.z!=0||H.x!=0||H.y!=0){C.matrix4=new c.Matrix4(q.x,N.x,H.x,0,q.y,N.y,H.y,0,q.z,N.z,H.z,0,0,0,0,1);let ge=new c.Matrix4().makeTranslation(z.x,z.y,z.z);C.matrix4=C.matrix4.multiplyMatrices(ge,C.matrix4),C.matrix=C.matrix4.matrix3FromTopLeft(),C.origin=new c.Vector3(0,0,0),C.unit=new c.Vector3(1,1,1)}b.modelData=[{cryst:C}],T=T.splice(6,F);for(var Y=b[b.length-1].length,O=Y+T.length,ee=Y;ee<O;++ee){var Ae={};Ae.serial=ee;var ce=T[ee-Y].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");Ae.elem=R[ce[0]],Ae.x=parseFloat(ce[2])*Q,Ae.y=parseFloat(ce[3])*Q,Ae.z=parseFloat(ce[4])*Q,Ae.hetflag=!0,Ae.bonds=[],Ae.bondOrder=[],Ae.properties={},b[b.length-1].push(Ae)}if(x)for(let ge=0;ge<b.length;ge++)(0,d.assignBonds)(b[ge],m);return b}},972:(r,n,a)=>{var c=a(981),d=!0,R=!0;try{String.fromCharCode.apply(null,[0])}catch{d=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{R=!1}for(var u=new c.Buf8(256),v=0;v<256;v++)u[v]=v>=252?6:v>=248?5:v>=240?4:v>=224?3:v>=192?2:1;function m(b,T){if(T<65534&&(b.subarray&&R||!b.subarray&&d))return String.fromCharCode.apply(null,c.shrinkBuf(b,T));for(var x="",k=0;k<T;k++)x+=String.fromCharCode(b[k]);return x}u[254]=u[254]=1,n.string2buf=function(b){var T,x,k,F,C,z=b.length,Q=0;for(F=0;F<z;F++)(64512&(x=b.charCodeAt(F)))==55296&&F+1<z&&(64512&(k=b.charCodeAt(F+1)))==56320&&(x=65536+(x-55296<<10)+(k-56320),F++),Q+=x<128?1:x<2048?2:x<65536?3:4;for(T=new c.Buf8(Q),C=0,F=0;C<Q;F++)(64512&(x=b.charCodeAt(F)))==55296&&F+1<z&&(64512&(k=b.charCodeAt(F+1)))==56320&&(x=65536+(x-55296<<10)+(k-56320),F++),x<128?T[C++]=x:x<2048?(T[C++]=192|x>>>6,T[C++]=128|63&x):x<65536?(T[C++]=224|x>>>12,T[C++]=128|x>>>6&63,T[C++]=128|63&x):(T[C++]=240|x>>>18,T[C++]=128|x>>>12&63,T[C++]=128|x>>>6&63,T[C++]=128|63&x);return T},n.buf2binstring=function(b){return m(b,b.length)},n.binstring2buf=function(b){for(var T=new c.Buf8(b.length),x=0,k=T.length;x<k;x++)T[x]=b.charCodeAt(x);return T},n.buf2string=function(b,T){var x,k,F,C,z=T||b.length,Q=new Array(2*z);for(k=0,x=0;x<z;)if((F=b[x++])<128)Q[k++]=F;else if((C=u[F])>4)Q[k++]=65533,x+=C-1;else{for(F&=C===2?31:C===3?15:7;C>1&&x<z;)F=F<<6|63&b[x++],C--;C>1?Q[k++]=65533:F<65536?Q[k++]=F:(F-=65536,Q[k++]=55296|F>>10&1023,Q[k++]=56320|1023&F)}return m(Q,k)},n.utf8border=function(b,T){var x;for((T=T||b.length)>b.length&&(T=b.length),x=T-1;x>=0&&(192&b[x])==128;)x--;return x<0||x===0?T:x+u[b[x]]>T?x:T}},981:(r,n)=>{var a=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function c(u,v){return Object.prototype.hasOwnProperty.call(u,v)}n.assign=function(u){for(var v=Array.prototype.slice.call(arguments,1);v.length;){var m=v.shift();if(m){if(typeof m!="object")throw new TypeError(m+"must be non-object");for(var b in m)c(m,b)&&(u[b]=m[b])}}return u},n.shrinkBuf=function(u,v){return u.length===v?u:u.subarray?u.subarray(0,v):(u.length=v,u)};var d={arraySet:function(u,v,m,b,T){if(v.subarray&&u.subarray)u.set(v.subarray(m,m+b),T);else for(var x=0;x<b;x++)u[T+x]=v[m+x]},flattenChunks:function(u){var v,m,b,T,x,k;for(b=0,v=0,m=u.length;v<m;v++)b+=u[v].length;for(k=new Uint8Array(b),T=0,v=0,m=u.length;v<m;v++)x=u[v],k.set(x,T),T+=x.length;return k}},R={arraySet:function(u,v,m,b,T){for(var x=0;x<b;x++)u[T+x]=v[m+x]},flattenChunks:function(u){return[].concat.apply([],u)}};n.setTyped=function(u){u?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,d)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,R))},n.setTyped(a)}},__webpack_module_cache__={};function __webpack_require__(r){var n=__webpack_module_cache__[r];if(n!==void 0)return n.exports;var a=__webpack_module_cache__[r]={exports:{}};return __webpack_modules__[r].call(a.exports,a,a.exports,__webpack_require__),a.exports}__webpack_require__.d=(r,n)=>{for(var a in n)__webpack_require__.o(n,a)&&!__webpack_require__.o(r,a)&&Object.defineProperty(r,a,{enumerable:!0,get:n[a]})},__webpack_require__.o=(r,n)=>Object.prototype.hasOwnProperty.call(r,n),__webpack_require__.r=r=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},__webpack_require__(16),__webpack_require__(185);var __webpack_exports__=__webpack_require__(307);return __webpack_exports__})(),module.exports=factory()})(_3DmolMin)),_3DmolMin.exports}require_3DmolMin();const covalentRadii={H:.31,He:.28,Li:1.28,Be:.96,B:.84,C:.76,N:.71,O:.66,F:.57,Ne:.58,Na:1.66,Mg:1.41,Al:1.21,Si:1.11,P:1.07,S:1.05,Cl:1.02,Ar:1.06,K:2.03,Ca:1.76,Sc:1.7,Ti:1.6,V:1.53,Cr:1.39,Mn:1.61,Fe:1.52,Co:1.5,Ni:1.24,Cu:1.32,Zn:1.22,Ga:1.22,Ge:1.2,As:1.19,Se:1.2,Br:1.2,Kr:1.16,Rb:2.2,Sr:1.95,Y:1.9,Zr:1.75,Nb:1.64,Mo:1.54,Tc:1.47,Ru:1.46,Rh:1.42,Pd:1.39,Ag:1.45,Cd:1.44,In:1.42,Sn:1.39,Sb:1.39,Te:1.38,I:1.39,Xe:1.4,Cs:2.44,Ba:2.15,La:2.07,Ce:2.04,Pr:2.03,Nd:2.01,Pm:1.99,Sm:1.98,Eu:1.98,Gd:1.96,Tb:1.94,Dy:1.92,Ho:1.92,Er:1.89,Tm:1.9,Yb:1.87,Lu:1.75,Hf:1.87,Ta:1.7,W:1.62,Re:1.51,Os:1.44,Ir:1.41,Pt:1.36,Au:1.36,Hg:1.32,Tl:1.45,Pb:1.46,Bi:1.48,Po:1.4,At:1.5,Rn:1.5,Fr:2.6,Ra:2.21,Ac:2.15,Th:2.06,Pa:2,U:1.96,Np:1.9,Pu:1.87,Am:1.8,Cm:1.69},$3Dmol$1=window.$3Dmol;function mod(r,n){return(r%n+n)%n}function setCustomBondLengths(){function r(n,a){$3Dmol$1.setBondLength(n,a)}Object.keys(covalentRadii).forEach(n=>{r(n,1.05*covalentRadii[n])})}const Visualizer3dmol=reactExports.forwardRef(({viewerParams:r,cifText:n},a)=>{const c=reactExports.useRef(null),d=reactExports.useRef(null),R=reactExports.useRef("gldiv-"+(Math.random()+1).toString(36).substring(7));reactExports.useEffect(()=>{setCustomBondLengths()},[]);const u=()=>{if(d.current=c.current.addModel(),n){let b=$3Dmol$1.Parsers.CIF(n),T=b[0],x=b.modelData[0].cryst;d.current.setCrystData(x.a,x.b,x.c,x.alpha,x.beta,x.gamma);let k=d.current.modelData.cryst.matrix,F=new $3Dmol$1.Matrix3().getInverse3(k),C=[],z=[];T.forEach(q=>{let w=new $3Dmol$1.Vector3(q.x,q.y,q.z);if(r.packedCell){let N=w.clone().applyMatrix3(F);w=new $3Dmol$1.Vector3(mod(N.x,1),mod(N.y,1),mod(N.z,1)).applyMatrix3(k)}z.push({elem:q.elem,x:w.x,y:w.y,z:w.z})});let Q=.03,J=r.supercell;for(let q=-1;q<J[0]+1;q++)for(let w=-1;w<J[1]+1;w++)for(let N=-1;N<J[2]+1;N++){let V=new $3Dmol$1.Vector3(q,w,N);if(V.applyMatrix3(k),q==-1||q==J[0]||w==-1||w==J[1]||N==-1||N==J[2])if(r.packedCell)z.forEach(H=>{let Y=new $3Dmol$1.Vector3(H.x,H.y,H.z);Y.add(V);let O=Y.clone().applyMatrix3(F);O.x>-Q&&O.x<J[0]+Q&&O.y>-Q&&O.y<J[1]+Q&&O.z>-Q&&O.z<J[2]+Q&&C.push({elem:H.elem,x:Y.x,y:Y.y,z:Y.z})});else continue;else z.forEach(H=>{C.push({elem:H.elem,x:H.x+V.x,y:H.y+V.y,z:H.z+V.z})})}d.current.addAtoms(C)}},v=()=>{c.current.removeAllModels(),u();let b={sphere:{scale:.3,colorscheme:"Jmol"}};r.vdwRadius&&(b.sphere.scale=1),r.bonds&&(b.stick={radius:.15,colorscheme:"Jmol"}),c.current.setStyle(b),c.current.addUnitCell(d.current),d.current.assignBonds(),c.current.removeAllLabels(),r.atomLabels&&d.current.atoms.forEach(T=>{c.current.addLabel(T.elem,{position:{x:T.x,y:T.y,z:T.z},fontColor:"black",bold:!0,fontSize:18,showBackground:!1,backgroundOpacity:1,inFront:!0},null,!0)}),c.current.zoomTo(),c.current.zoom(1.4),c.current.render()},m=(b,T)=>{b=="camera"&&(T=="x"&&c.current.setView([0,0,0,0,-.5,-.5,-.5,.5]),T=="y"&&c.current.setView([0,0,0,0,.5,.5,.5,.5]),T=="z"&&c.current.setView([0,0,0,0,0,0,0,1]),c.current.zoomTo(),c.current.zoom(1.4))};return reactExports.useImperativeHandle(a,()=>({handleEvent:m})),reactExports.useEffect(()=>{let b={backgroundColor:"white",orthographic:!0};c.current=$3Dmol$1.createViewer(R.current,b),v()},[]),reactExports.useEffect(()=>{c.current&&v()},[r,n]),jsxRuntimeExports.jsx("div",{id:R.current,className:"gldiv",children:"No data!"})});Visualizer3dmol.displayName="Visualizer3dmol";const StructureWindow=({mouseEnabled:r,setMouseEnabledState:n,visualizerRef:a,viewerParams:c,cifText:d})=>{let R="structure-window";r||(R+=" disable-mouse");let u="Click to interact",v="mouse-disabled-note";return r&&(v="mouse-disabled-note on"),jsxRuntimeExports.jsxs("div",{className:"structure-window-outer",children:[jsxRuntimeExports.jsx("div",{className:"structure-window-click-handler",onClick:()=>n(!0),children:jsxRuntimeExports.jsx("div",{className:R,children:jsxRuntimeExports.jsx(Visualizer3dmol,{ref:a,viewerParams:c,cifText:d})})}),jsxRuntimeExports.jsx("div",{className:v,onClick:()=>n(!r),children:u})]})},StructureVisualizer=r=>{const[n,a]=reactExports.useState({supercell:r.initSupercell||[2,2,2],bonds:!0,packedCell:!0,atomLabels:!1,vdwRadius:!1}),[c,d]=reactExports.useState(!1),R=reactExports.useRef(null),u=reactExports.useRef(null);reactExports.useEffect(()=>{const T=x=>{u&&!u.current.contains(x.target)&&d(!1)};return document.addEventListener("mousedown",T),()=>{document.removeEventListener("mousedown",T)}},[]);const v=T=>{d(T)},m=(T,x)=>{a(k=>({...k,[T]:x}))},b=(T,x)=>{R.current.handleEvent(T,x)};return jsxRuntimeExports.jsxs("div",{ref:u,className:"structure-visualizer",children:[jsxRuntimeExports.jsx(StructureWindow,{visualizerRef:R,viewerParams:n,cifText:r.cifText,mouseEnabled:c,setMouseEnabledState:v}),jsxRuntimeExports.jsx(ControlBox,{viewerParams:n,onViewerParamChange:m,onViewerEvent:b})]})};function DownloadIcon({size:r=14,className:n=""}){return jsxRuntimeExports.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:r,height:r,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[jsxRuntimeExports.jsx("path",{d:"M12 15V3"}),jsxRuntimeExports.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),jsxRuntimeExports.jsx("path",{d:"m7 10 5 5 5-5"})]})}function NextIcon({size:r=14,className:n=""}){return jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:r,hegiht:r,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:jsxRuntimeExports.jsx("path",{d:"m9 18 6-6-6-6"})})}function PreviousIcon({size:r=14,className:n=""}){return jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:r,hegiht:r,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:jsxRuntimeExports.jsx("path",{d:"m15 18-6-6 6-6"})})}function FirstIcon({size:r=14,className:n=""}){return jsxRuntimeExports.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:r,hegiht:r,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[jsxRuntimeExports.jsx("path",{d:"m17 18-6-6 6-6"}),jsxRuntimeExports.jsx("path",{d:"M7 6v12"})]})}function LastIcon({size:r=14,className:n=""}){return jsxRuntimeExports.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:r,hegiht:r,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[jsxRuntimeExports.jsx("path",{d:"m7 18 6-6-6-6"}),jsxRuntimeExports.jsx("path",{d:"M17 6v12"})]})}var ARRAY_TYPE=typeof Float32Array<"u"?Float32Array:Array;function create$1(){var r=new ARRAY_TYPE(9);return ARRAY_TYPE!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function fromValues$1(r,n,a,c,d,R,u,v,m){var b=new ARRAY_TYPE(9);return b[0]=r,b[1]=n,b[2]=a,b[3]=c,b[4]=d,b[5]=R,b[6]=u,b[7]=v,b[8]=m,b}function invert(r,n){var a=n[0],c=n[1],d=n[2],R=n[3],u=n[4],v=n[5],m=n[6],b=n[7],T=n[8],x=T*u-v*b,k=-T*R+v*m,F=b*R-u*m,C=a*x+c*k+d*F;return C?(C=1/C,r[0]=x*C,r[1]=(-T*c+d*b)*C,r[2]=(v*c-d*u)*C,r[3]=k*C,r[4]=(T*a-d*m)*C,r[5]=(-v*a+d*R)*C,r[6]=F*C,r[7]=(-b*a+c*m)*C,r[8]=(u*a-c*R)*C,r):null}function create(){var r=new ARRAY_TYPE(3);return ARRAY_TYPE!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function length(r){var n=r[0],a=r[1],c=r[2];return Math.sqrt(n*n+a*a+c*c)}function fromValues(r,n,a){var c=new ARRAY_TYPE(3);return c[0]=r,c[1]=n,c[2]=a,c}function dot(r,n){return r[0]*n[0]+r[1]*n[1]+r[2]*n[2]}function transformMat3(r,n,a){var c=n[0],d=n[1],R=n[2];return r[0]=c*a[0]+d*a[3]+R*a[6],r[1]=c*a[1]+d*a[4]+R*a[7],r[2]=c*a[2]+d*a[5]+R*a[8],r}(function(){var r=create();return function(n,a,c,d,R,u){var v,m;for(a||(a=3),c||(c=0),d?m=Math.min(d*a+c,n.length):m=n.length,v=c;v<m;v+=a)r[0]=n[v],r[1]=n[v+1],r[2]=n[v+2],R(r,r,u),n[v]=r[0],n[v+1]=r[1],n[v+2]=r[2];return n}})();function vecLength(r){return length(r)}function radToDeg$1(r){return r*180/Math.PI}function cartesianToFractional(r,n){const a=n[0],c=n[1],d=n[2],R=fromValues$1(a[0],a[1],a[2],c[0],c[1],c[2],d[0],d[1],d[2]),u=create$1();if(!invert(u,R))throw new Error("Singular lattice matrix");return r.map(v=>{const m=fromValues(v.x,v.y,v.z),b=create();return transformMat3(b,m,u),{element:v.element,x:b[0],y:b[1],z:b[2]}})}function latticeMatrixToCIFParams(r){const n=fromValues(...r[0]),a=fromValues(...r[1]),c=fromValues(...r[2]),d=vecLength(n),R=vecLength(a),u=vecLength(c),v=Math.min(1,Math.max(-1,dot(a,c)/(R*u))),m=Math.min(1,Math.max(-1,dot(n,c)/(d*u))),b=Math.min(1,Math.max(-1,dot(n,a)/(d*R))),T=radToDeg$1(Math.acos(v)),x=radToDeg$1(Math.acos(m)),k=radToDeg$1(Math.acos(b));return{a:d,b:R,c:u,alpha:T,beta:x,gamma:k}}function generateCIFfromMatrix(r){const{lattice:n,sites:a}=r,c=cartesianToFractional(a,n),{a:d,b:R,c:u,alpha:v,beta:m,gamma:b}=latticeMatrixToCIFParams(n);let T=`data_generated_structure
_symmetry_space_group_name_H-M   'P 1'
_cell_length_a   ${d.toFixed(6)}
_cell_length_b   ${R.toFixed(6)}
_cell_length_c   ${u.toFixed(6)}
_cell_angle_alpha   ${v.toFixed(6)}
_cell_angle_beta    ${m.toFixed(6)}
_cell_angle_gamma   ${b.toFixed(6)}

loop_
_atom_site_label
_atom_site_type_symbol
_atom_site_fract_x
_atom_site_fract_y
_atom_site_fract_z
`;return c.forEach((x,k)=>{T+=`${x.element}${k+1} ${x.element} ${x.x.toFixed(6)} ${x.y.toFixed(6)} ${x.z.toFixed(6)}
`}),T}function generateXYZ(r){const{lattice:n,sites:a}=r,c=a.length,d=n.flat().map(u=>u.toFixed(6)).join(" ");let R=`${c}
`;return R+=`Lattice="${d}" Properties=species:S:1:pos:R:3
`,a.forEach(u=>{R+=`${u.element} ${u.x.toFixed(6)} ${u.y.toFixed(6)} ${u.z.toFixed(6)}
`}),R}function generatePOSCAR(r){const{lattice:n,sites:a}=r,c=[...new Set(a.map(v=>v.element))],d=c.map(v=>a.filter(m=>m.element===v).length),R=n.map(v=>v.map(m=>m.toFixed(6)).join(" ")).join(`
`),u=c.flatMap(v=>a.filter(m=>m.element===v).map(m=>`${m.x.toFixed(6)} ${m.y.toFixed(6)} ${m.z.toFixed(6)}`));return["Generated structure from OPTIMADE CLIENT","1.0",R,c.join(" "),d.join(" "),"Cartesian",...u].join(`
`)}function generateXSF(r){const{lattice:n,sites:a}=r;let c=`CRYSTAL
PRIMVEC
`;return n.forEach(d=>{c+=d.map(R=>R.toFixed(6)).join(" ")+`
`}),c+=`PRIMCOORD
${a.length} 1
`,a.forEach(d=>{c+=`${d.element} ${d.x.toFixed(6)} ${d.y.toFixed(6)} ${d.z.toFixed(6)}
`}),c}const defaultFormats=[{format:"json",label:"JSON"},{format:"cif",label:"CIF"},{format:"xyz",label:"XYZ"},{format:"xsf",label:"XSF"},{format:"poscar",label:"VASP"}];function downloadFile(r,n){const a=new Blob([r],{type:"text/plain"}),c=URL.createObjectURL(a),d=document.createElement("a");d.href=c,d.download=n,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(c)}function StructureDownload({OptimadeStructure:r,download_formats:n}){const[a,c]=reactExports.useState(!1),d=reactExports.useRef(null),R=n||defaultFormats,u=r.attributes.lattice_vectors,v=r?.attributes?.cartesian_site_positions||[],m=r.attributes.species_at_sites,b=v.map((k,F)=>({element:m[F],x:k[0],y:k[1],z:k[2]})),T={lattice:u,sites:b},x=k=>{let F="",C="structure";k==="cif"?(F=generateCIFfromMatrix(T),C+=".cif"):k==="xyz"?(F=generateXYZ(T),C+=".xyz"):k==="poscar"?(F=generatePOSCAR(T),C+=".vasp"):k==="xsf"?(F=generateXSF(T),C+=".xsf"):k==="json"&&(F=JSON.stringify(r,null,2),C+=".json"),F&&downloadFile(F,C),c(!1)};return reactExports.useEffect(()=>{const k=F=>{d.current&&!d.current.contains(F.target)&&c(!1)};return document.addEventListener("mousedown",k),()=>document.removeEventListener("mousedown",k)},[]),jsxRuntimeExports.jsxs("div",{className:"relative inline-block",ref:d,children:[jsxRuntimeExports.jsx("div",{onClick:()=>c(k=>!k),className:`${baseButtonStyle} ${textSmall} py-2! px-2!`,title:"Download",children:jsxRuntimeExports.jsx(DownloadIcon,{})}),a&&jsxRuntimeExports.jsx("div",{className:"absolute right-0 mt-0.5 bg-white rounded-sm shadow-sm ring-1 ring-slate-500 z-100",children:jsxRuntimeExports.jsx("ul",{children:R.map(({format:k,label:F})=>jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("button",{onClick:()=>x(k),className:`${textSmall} w-full text-left px-3 py-1.25 text-slate-700 hover:bg-gray-100 hover:cursor-pointer`,children:F})},k))})})]})}function StructureViewerWithDownload({OptimadeStructure:r}){const n=r.attributes.lattice_vectors,a=r?.attributes?.cartesian_site_positions||null,c=r.attributes.species_at_sites;let d=[];a&&(d=a.map((v,m)=>({element:c[m],x:v[0],y:v[1],z:v[2]})));const R={lattice:n,sites:d},u=reactExports.useMemo(()=>generateCIFfromMatrix(R),[R]);return a?jsxRuntimeExports.jsxs("div",{className:"relative min-h-[450px] ",children:[jsxRuntimeExports.jsx("div",{className:"w-full h-[450px]",children:jsxRuntimeExports.jsx(StructureVisualizer,{cifText:u},u)}),jsxRuntimeExports.jsx("div",{className:"absolute top-2 right-2 z-10",children:jsxRuntimeExports.jsx(StructureDownload,{OptimadeStructure:r})})]}):jsxRuntimeExports.jsx("div",{className:`${containerStyle} min-h-[450px] flex items-center justify-center`,children:jsxRuntimeExports.jsxs("div",{className:textError,children:[jsxRuntimeExports.jsx("p",{children:"Unexpected or malformed data format found. "}),jsxRuntimeExports.jsx("p",{children:"--"}),jsxRuntimeExports.jsx("p",{children:"Crystal structure rendering skipped..."})]})})}function QEInputButton({cifText:r}){const n="https://qeinputgenerator.materialscloud.io",a=async()=>{if(!r){alert("No CIF data available");return}const c=window.open("","_blank");try{const d=new FormData;d.append("fileformat","cif-ase"),d.append("structurefile",new Blob([r],{type:"text/plain;charset=utf-8"}),"structure.cif");const R=await fetch(`${n}/compute/upload_structure/`,{method:"POST",body:d});if(!R.ok)throw new Error(`Upload failed: ${R.statusText}`);const u=await R.json();u.redirect?c.location=`${n}${u.redirect}`:(c.close(),alert("Unexpected response from server"))}catch(d){console.error(d),c.close(),alert("Failed to upload structure.")}};return jsxRuntimeExports.jsx("button",{onClick:a,disabled:!r,title:"Use the chosen structure in the QE Input Generator Tool",className:`${baseButtonStyle} ${textNormal}`,children:"Use in QE Input Generator"})}function ResultViewer({selectedResult:r}){console.log("selectedResult",r);const n=r?.attributes?.lattice_vectors??[],a=r?.attributes?.cartesian_site_positions??[],c=r?.attributes?.species_at_sites??[],d=a.map((v,m)=>({element:c[m],x:v[0],y:v[1],z:v[2]})),R=reactExports.useMemo(()=>({lattice:n,sites:d}),[n,d]),u=reactExports.useMemo(()=>generateCIFfromMatrix(R),[R]);return jsxRuntimeExports.jsxs("div",{className:"w-full flex flex-col",children:[r&&jsxRuntimeExports.jsxs("div",{className:"@container w-full flex flex-col md:flex-row gap-2 md:gap-4",children:[jsxRuntimeExports.jsx("div",{className:"w-full md:w-1/2",children:jsxRuntimeExports.jsx(StructureViewerWithDownload,{OptimadeStructure:r,cifText:u})}),jsxRuntimeExports.jsx("div",{className:containerStyleHalf,children:jsxRuntimeExports.jsx(JsonView,{data:r,compactTopLevel:!0,shouldExpandNode:v=>v<2,style:{backgroundColor:""}})})]}),jsxRuntimeExports.jsx("div",{className:"mt-2 md:mt-4 flex justify-center",children:jsxRuntimeExports.jsx(QEInputButton,{cifText:u})})]})}function ResultsDropdown({results:r,resultsLoading:n,selectedResult:a,setSelectedResult:c}){const d=R=>{const u=r?.data?.find(v=>String(v.id)===R.target.value);u&&c(u)};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select a result"}),jsxRuntimeExports.jsx("select",{className:`${slateDropdown} w-full`,value:a?.id||"",onChange:d,disabled:n||!r?.data?.length,children:r?.data?.length?r.data.map(R=>jsxRuntimeExports.jsx("option",{value:R.id,children:`${R.attributes?.chemical_formula_descriptive||R.attributes?.chemical_formula_hill||"Unknown"} (${R.id})`},R.id)):jsxRuntimeExports.jsx("option",{value:"",children:"No results for current query"})})]})}const tableTitleclassName="font-semibold border-b [&>th]:px-2",tableRowclassName="border-b border-slate-300 *:py-0.5 *:pl-2 pr-8 *:break-words";function OptimadeProviderInfo({queryUrl:r}){const[n,a]=reactExports.useState(null),[c,d]=reactExports.useState([]),[R,u]=reactExports.useState(!1),[v,m]=reactExports.useState(!1),b=reactExports.useRef(null),[T,x]=reactExports.useState("0px");return reactExports.useEffect(()=>{if(!r)return;u(!0),a(null),d([]);async function k(){try{const{customProps:F,error:C}=await getInfo({providerUrl:r});C&&d([C]),F&&a(F)}catch(F){d([F])}finally{u(!1)}}k()},[r]),reactExports.useEffect(()=>{b.current&&x(v?`${b.current.scrollHeight}px`:"0px")},[v,n,c,R]),!r||c.length>0&&!R?null:jsxRuntimeExports.jsxs("div",{className:containerStyleDropdown,children:[jsxRuntimeExports.jsxs("button",{onClick:()=>m(!v),className:"w-full flex justify-between p-3 bg-slate-100 hover:bg-slate-200 hover:cursor-pointer transition",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold",children:"Custom attributes in selected database"}),jsxRuntimeExports.jsx("span",{children:v?"":""})]}),jsxRuntimeExports.jsx("div",{ref:b,style:{maxHeight:T},className:"transition-[max-height] duration-300 ease-in-out",children:jsxRuntimeExports.jsxs("div",{className:"pt-2 max-h-96 overflow-y-auto",children:[R&&jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center py-4",children:[jsxRuntimeExports.jsx("div",{className:"w-5 h-5 border-2 border-t-2 border-gray-400 border-t-blue-500 rounded-full animate-spin mr-2"}),jsxRuntimeExports.jsx("span",{className:"text-gray-500",children:"Loading provider info"})]}),n&&!R&&jsxRuntimeExports.jsx("div",{className:"",children:jsxRuntimeExports.jsxs("table",{className:"w-full table-fixed text-left border-collapse",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{className:tableTitleclassName,children:[jsxRuntimeExports.jsx("th",{children:"Field"}),jsxRuntimeExports.jsx("th",{children:"Description"}),jsxRuntimeExports.jsx("th",{children:"Unit"})]})}),jsxRuntimeExports.jsx("tbody",{children:Object.entries(n).map(([k,F])=>jsxRuntimeExports.jsxs("tr",{className:tableRowclassName,children:[jsxRuntimeExports.jsx("td",{children:k}),jsxRuntimeExports.jsx("td",{children:F.description||"-"}),jsxRuntimeExports.jsx("td",{children:F.unit||"-"})]},k))})]})})]})})]})}const buttonClassName="px-3 py-1 bg-gray-200 rounded hover:bg-gray-300 hover:cursor-pointer disabled:bg-gray-200 disabled:opacity-50 disabled:cursor-default";function PaginationHandler({currentPage:r,totalPages:n,resultsLoading:a,metaData:c,onPageChange:d}){if(!n||n<1)return null;const R=c?.data_returned||"N/A",u=r>1;let v=!1;return(c?.more_data_available===!0||r<n)&&(v=!0),jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap justify-center items-center gap-1",children:[jsxRuntimeExports.jsx("span",{className:"text-slate-700 text-sm text-center w-full md:w-auto",children:`Filtered results: ${R} of ${c.data_available} | Showing page ${r} of ${n}`}),jsxRuntimeExports.jsx("button",{onClick:()=>d(1),disabled:r===1||a,className:buttonClassName,children:jsxRuntimeExports.jsx(FirstIcon,{})}),jsxRuntimeExports.jsx("button",{onClick:()=>d(r-1),disabled:!u||a,className:buttonClassName,children:jsxRuntimeExports.jsx(PreviousIcon,{})}),jsxRuntimeExports.jsx("button",{onClick:()=>d(r+1),disabled:!v||a,className:buttonClassName,children:jsxRuntimeExports.jsx(NextIcon,{})}),jsxRuntimeExports.jsx("button",{onClick:()=>d(n),disabled:r===n||a,className:buttonClassName,children:jsxRuntimeExports.jsx(LastIcon,{})})]})}const LayoutGroupContext=reactExports.createContext({});function useConstant(r){const n=reactExports.useRef(null);return n.current===null&&(n.current=r()),n.current}const isBrowser$1=typeof window<"u",useIsomorphicLayoutEffect=isBrowser$1?reactExports.useLayoutEffect:reactExports.useEffect,PresenceContext=reactExports.createContext(null);function addUniqueItem(r,n){r.indexOf(n)===-1&&r.push(n)}function removeItem(r,n){const a=r.indexOf(n);a>-1&&r.splice(a,1)}const clamp=(r,n,a)=>a>n?n:a<r?r:a;let invariant=()=>{};const MotionGlobalConfig={},isNumericalString=r=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(r);function isObject(r){return typeof r=="object"&&r!==null}const isZeroValueString=r=>/^0[^.\s]+$/u.test(r);function memo(r){let n;return()=>(n===void 0&&(n=r()),n)}const noop=r=>r,combineFunctions=(r,n)=>a=>n(r(a)),pipe=(...r)=>r.reduce(combineFunctions),progress=(r,n,a)=>{const c=n-r;return c===0?1:(a-r)/c};class SubscriptionManager{constructor(){this.subscriptions=[]}add(n){return addUniqueItem(this.subscriptions,n),()=>removeItem(this.subscriptions,n)}notify(n,a,c){const d=this.subscriptions.length;if(d)if(d===1)this.subscriptions[0](n,a,c);else for(let R=0;R<d;R++){const u=this.subscriptions[R];u&&u(n,a,c)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const secondsToMilliseconds=r=>r*1e3,millisecondsToSeconds=r=>r/1e3;function velocityPerSecond(r,n){return n?r*(1e3/n):0}const calcBezier=(r,n,a)=>(((1-3*a+3*n)*r+(3*a-6*n))*r+3*n)*r,subdivisionPrecision=1e-7,subdivisionMaxIterations=12;function binarySubdivide(r,n,a,c,d){let R,u,v=0;do u=n+(a-n)/2,R=calcBezier(u,c,d)-r,R>0?a=u:n=u;while(Math.abs(R)>subdivisionPrecision&&++v<subdivisionMaxIterations);return u}function cubicBezier(r,n,a,c){if(r===n&&a===c)return noop;const d=R=>binarySubdivide(R,0,1,r,a);return R=>R===0||R===1?R:calcBezier(d(R),n,c)}const mirrorEasing=r=>n=>n<=.5?r(2*n)/2:(2-r(2*(1-n)))/2,reverseEasing=r=>n=>1-r(1-n),backOut=cubicBezier(.33,1.53,.69,.99),backIn=reverseEasing(backOut),backInOut=mirrorEasing(backIn),anticipate=r=>(r*=2)<1?.5*backIn(r):.5*(2-Math.pow(2,-10*(r-1))),circIn=r=>1-Math.sin(Math.acos(r)),circOut=reverseEasing(circIn),circInOut=mirrorEasing(circIn),easeIn=cubicBezier(.42,0,1,1),easeOut=cubicBezier(0,0,.58,1),easeInOut=cubicBezier(.42,0,.58,1),isEasingArray=r=>Array.isArray(r)&&typeof r[0]!="number",isBezierDefinition=r=>Array.isArray(r)&&typeof r[0]=="number",easingLookup={linear:noop,easeIn,easeInOut,easeOut,circIn,circInOut,circOut,backIn,backInOut,backOut,anticipate},isValidEasing=r=>typeof r=="string",easingDefinitionToFunction=r=>{if(isBezierDefinition(r)){invariant(r.length===4);const[n,a,c,d]=r;return cubicBezier(n,a,c,d)}else if(isValidEasing(r))return easingLookup[r];return r},stepsOrder=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function createRenderStep(r,n){let a=new Set,c=new Set,d=!1,R=!1;const u=new WeakSet;let v={delta:0,timestamp:0,isProcessing:!1};function m(T){u.has(T)&&(b.schedule(T),r()),T(v)}const b={schedule:(T,x=!1,k=!1)=>{const C=k&&d?a:c;return x&&u.add(T),C.has(T)||C.add(T),T},cancel:T=>{c.delete(T),u.delete(T)},process:T=>{if(v=T,d){R=!0;return}d=!0,[a,c]=[c,a],a.forEach(m),a.clear(),d=!1,R&&(R=!1,b.process(T))}};return b}const maxElapsed=40;function createRenderBatcher(r,n){let a=!1,c=!0;const d={delta:0,timestamp:0,isProcessing:!1},R=()=>a=!0,u=stepsOrder.reduce((w,N)=>(w[N]=createRenderStep(R),w),{}),{setup:v,read:m,resolveKeyframes:b,preUpdate:T,update:x,preRender:k,render:F,postRender:C}=u,z=()=>{const w=MotionGlobalConfig.useManualTiming?d.timestamp:performance.now();a=!1,MotionGlobalConfig.useManualTiming||(d.delta=c?1e3/60:Math.max(Math.min(w-d.timestamp,maxElapsed),1)),d.timestamp=w,d.isProcessing=!0,v.process(d),m.process(d),b.process(d),T.process(d),x.process(d),k.process(d),F.process(d),C.process(d),d.isProcessing=!1,a&&n&&(c=!1,r(z))},Q=()=>{a=!0,c=!0,d.isProcessing||r(z)};return{schedule:stepsOrder.reduce((w,N)=>{const V=u[N];return w[N]=(H,Y=!1,O=!1)=>(a||Q(),V.schedule(H,Y,O)),w},{}),cancel:w=>{for(let N=0;N<stepsOrder.length;N++)u[stepsOrder[N]].cancel(w)},state:d,steps:u}}const{schedule:frame,cancel:cancelFrame,state:frameData,steps:frameSteps}=createRenderBatcher(typeof requestAnimationFrame<"u"?requestAnimationFrame:noop,!0);let now;function clearTime(){now=void 0}const time={now:()=>(now===void 0&&time.set(frameData.isProcessing||MotionGlobalConfig.useManualTiming?frameData.timestamp:performance.now()),now),set:r=>{now=r,queueMicrotask(clearTime)}},checkStringStartsWith=r=>n=>typeof n=="string"&&n.startsWith(r),isCSSVariableName=checkStringStartsWith("--"),startsAsVariableToken=checkStringStartsWith("var(--"),isCSSVariableToken=r=>startsAsVariableToken(r)?singleCssVariableRegex.test(r.split("/*")[0].trim()):!1,singleCssVariableRegex=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu;function containsCSSVariable(r){return typeof r!="string"?!1:r.split("/*")[0].includes("var(--")}const number={test:r=>typeof r=="number",parse:parseFloat,transform:r=>r},alpha={...number,transform:r=>clamp(0,1,r)},scale={...number,default:1},sanitize=r=>Math.round(r*1e5)/1e5,floatRegex=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function isNullish(r){return r==null}const singleColorRegex=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,isColorString=(r,n)=>a=>!!(typeof a=="string"&&singleColorRegex.test(a)&&a.startsWith(r)||n&&!isNullish(a)&&Object.prototype.hasOwnProperty.call(a,n)),splitColor=(r,n,a)=>c=>{if(typeof c!="string")return c;const[d,R,u,v]=c.match(floatRegex);return{[r]:parseFloat(d),[n]:parseFloat(R),[a]:parseFloat(u),alpha:v!==void 0?parseFloat(v):1}},clampRgbUnit=r=>clamp(0,255,r),rgbUnit={...number,transform:r=>Math.round(clampRgbUnit(r))},rgba={test:isColorString("rgb","red"),parse:splitColor("red","green","blue"),transform:({red:r,green:n,blue:a,alpha:c=1})=>"rgba("+rgbUnit.transform(r)+", "+rgbUnit.transform(n)+", "+rgbUnit.transform(a)+", "+sanitize(alpha.transform(c))+")"};function parseHex(r){let n="",a="",c="",d="";return r.length>5?(n=r.substring(1,3),a=r.substring(3,5),c=r.substring(5,7),d=r.substring(7,9)):(n=r.substring(1,2),a=r.substring(2,3),c=r.substring(3,4),d=r.substring(4,5),n+=n,a+=a,c+=c,d+=d),{red:parseInt(n,16),green:parseInt(a,16),blue:parseInt(c,16),alpha:d?parseInt(d,16)/255:1}}const hex={test:isColorString("#"),parse:parseHex,transform:rgba.transform},createUnitType=r=>({test:n=>typeof n=="string"&&n.endsWith(r)&&n.split(" ").length===1,parse:parseFloat,transform:n=>`${n}${r}`}),degrees=createUnitType("deg"),percent=createUnitType("%"),px=createUnitType("px"),vh=createUnitType("vh"),vw=createUnitType("vw"),progressPercentage={...percent,parse:r=>percent.parse(r)/100,transform:r=>percent.transform(r*100)},hsla={test:isColorString("hsl","hue"),parse:splitColor("hue","saturation","lightness"),transform:({hue:r,saturation:n,lightness:a,alpha:c=1})=>"hsla("+Math.round(r)+", "+percent.transform(sanitize(n))+", "+percent.transform(sanitize(a))+", "+sanitize(alpha.transform(c))+")"},color={test:r=>rgba.test(r)||hex.test(r)||hsla.test(r),parse:r=>rgba.test(r)?rgba.parse(r):hsla.test(r)?hsla.parse(r):hex.parse(r),transform:r=>typeof r=="string"?r:r.hasOwnProperty("red")?rgba.transform(r):hsla.transform(r),getAnimatableNone:r=>{const n=color.parse(r);return n.alpha=0,color.transform(n)}},colorRegex=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function test(r){return isNaN(r)&&typeof r=="string"&&(r.match(floatRegex)?.length||0)+(r.match(colorRegex)?.length||0)>0}const NUMBER_TOKEN="number",COLOR_TOKEN="color",VAR_TOKEN="var",VAR_FUNCTION_TOKEN="var(",SPLIT_TOKEN="${}",complexRegex=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function analyseComplexValue(r){const n=r.toString(),a=[],c={color:[],number:[],var:[]},d=[];let R=0;const v=n.replace(complexRegex,m=>(color.test(m)?(c.color.push(R),d.push(COLOR_TOKEN),a.push(color.parse(m))):m.startsWith(VAR_FUNCTION_TOKEN)?(c.var.push(R),d.push(VAR_TOKEN),a.push(m)):(c.number.push(R),d.push(NUMBER_TOKEN),a.push(parseFloat(m))),++R,SPLIT_TOKEN)).split(SPLIT_TOKEN);return{values:a,split:v,indexes:c,types:d}}function parseComplexValue(r){return analyseComplexValue(r).values}function createTransformer(r){const{split:n,types:a}=analyseComplexValue(r),c=n.length;return d=>{let R="";for(let u=0;u<c;u++)if(R+=n[u],d[u]!==void 0){const v=a[u];v===NUMBER_TOKEN?R+=sanitize(d[u]):v===COLOR_TOKEN?R+=color.transform(d[u]):R+=d[u]}return R}}const convertNumbersToZero=r=>typeof r=="number"?0:color.test(r)?color.getAnimatableNone(r):r;function getAnimatableNone$1(r){const n=parseComplexValue(r);return createTransformer(r)(n.map(convertNumbersToZero))}const complex={test,parse:parseComplexValue,createTransformer,getAnimatableNone:getAnimatableNone$1};function hueToRgb(r,n,a){return a<0&&(a+=1),a>1&&(a-=1),a<1/6?r+(n-r)*6*a:a<1/2?n:a<2/3?r+(n-r)*(2/3-a)*6:r}function hslaToRgba({hue:r,saturation:n,lightness:a,alpha:c}){r/=360,n/=100,a/=100;let d=0,R=0,u=0;if(!n)d=R=u=a;else{const v=a<.5?a*(1+n):a+n-a*n,m=2*a-v;d=hueToRgb(m,v,r+1/3),R=hueToRgb(m,v,r),u=hueToRgb(m,v,r-1/3)}return{red:Math.round(d*255),green:Math.round(R*255),blue:Math.round(u*255),alpha:c}}function mixImmediate(r,n){return a=>a>0?n:r}const mixNumber$1=(r,n,a)=>r+(n-r)*a,mixLinearColor=(r,n,a)=>{const c=r*r,d=a*(n*n-c)+c;return d<0?0:Math.sqrt(d)},colorTypes=[hex,rgba,hsla],getColorType=r=>colorTypes.find(n=>n.test(r));function asRGBA(r){const n=getColorType(r);if(!n)return!1;let a=n.parse(r);return n===hsla&&(a=hslaToRgba(a)),a}const mixColor=(r,n)=>{const a=asRGBA(r),c=asRGBA(n);if(!a||!c)return mixImmediate(r,n);const d={...a};return R=>(d.red=mixLinearColor(a.red,c.red,R),d.green=mixLinearColor(a.green,c.green,R),d.blue=mixLinearColor(a.blue,c.blue,R),d.alpha=mixNumber$1(a.alpha,c.alpha,R),rgba.transform(d))},invisibleValues=new Set(["none","hidden"]);function mixVisibility(r,n){return invisibleValues.has(r)?a=>a<=0?r:n:a=>a>=1?n:r}function mixNumber(r,n){return a=>mixNumber$1(r,n,a)}function getMixer(r){return typeof r=="number"?mixNumber:typeof r=="string"?isCSSVariableToken(r)?mixImmediate:color.test(r)?mixColor:mixComplex:Array.isArray(r)?mixArray:typeof r=="object"?color.test(r)?mixColor:mixObject:mixImmediate}function mixArray(r,n){const a=[...r],c=a.length,d=r.map((R,u)=>getMixer(R)(R,n[u]));return R=>{for(let u=0;u<c;u++)a[u]=d[u](R);return a}}function mixObject(r,n){const a={...r,...n},c={};for(const d in a)r[d]!==void 0&&n[d]!==void 0&&(c[d]=getMixer(r[d])(r[d],n[d]));return d=>{for(const R in c)a[R]=c[R](d);return a}}function matchOrder(r,n){const a=[],c={color:0,var:0,number:0};for(let d=0;d<n.values.length;d++){const R=n.types[d],u=r.indexes[R][c[R]],v=r.values[u]??0;a[d]=v,c[R]++}return a}const mixComplex=(r,n)=>{const a=complex.createTransformer(n),c=analyseComplexValue(r),d=analyseComplexValue(n);return c.indexes.var.length===d.indexes.var.length&&c.indexes.color.length===d.indexes.color.length&&c.indexes.number.length>=d.indexes.number.length?invisibleValues.has(r)&&!d.values.length||invisibleValues.has(n)&&!c.values.length?mixVisibility(r,n):pipe(mixArray(matchOrder(c,d),d.values),a):mixImmediate(r,n)};function mix(r,n,a){return typeof r=="number"&&typeof n=="number"&&typeof a=="number"?mixNumber$1(r,n,a):getMixer(r)(r,n)}const frameloopDriver=r=>{const n=({timestamp:a})=>r(a);return{start:(a=!0)=>frame.update(n,a),stop:()=>cancelFrame(n),now:()=>frameData.isProcessing?frameData.timestamp:time.now()}},generateLinearEasing=(r,n,a=10)=>{let c="";const d=Math.max(Math.round(n/a),2);for(let R=0;R<d;R++)c+=Math.round(r(R/(d-1))*1e4)/1e4+", ";return`linear(${c.substring(0,c.length-2)})`},maxGeneratorDuration=2e4;function calcGeneratorDuration(r){let n=0;const a=50;let c=r.next(n);for(;!c.done&&n<maxGeneratorDuration;)n+=a,c=r.next(n);return n>=maxGeneratorDuration?1/0:n}function createGeneratorEasing(r,n=100,a){const c=a({...r,keyframes:[0,n]}),d=Math.min(calcGeneratorDuration(c),maxGeneratorDuration);return{type:"keyframes",ease:R=>c.next(d*R).value/n,duration:millisecondsToSeconds(d)}}const velocitySampleDuration=5;function calcGeneratorVelocity(r,n,a){const c=Math.max(n-velocitySampleDuration,0);return velocityPerSecond(a-r(c),n-c)}const springDefaults={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},safeMin=.001;function findSpring({duration:r=springDefaults.duration,bounce:n=springDefaults.bounce,velocity:a=springDefaults.velocity,mass:c=springDefaults.mass}){let d,R,u=1-n;u=clamp(springDefaults.minDamping,springDefaults.maxDamping,u),r=clamp(springDefaults.minDuration,springDefaults.maxDuration,millisecondsToSeconds(r)),u<1?(d=b=>{const T=b*u,x=T*r,k=T-a,F=calcAngularFreq(b,u),C=Math.exp(-x);return safeMin-k/F*C},R=b=>{const x=b*u*r,k=x*a+a,F=Math.pow(u,2)*Math.pow(b,2)*r,C=Math.exp(-x),z=calcAngularFreq(Math.pow(b,2),u);return(-d(b)+safeMin>0?-1:1)*((k-F)*C)/z}):(d=b=>{const T=Math.exp(-b*r),x=(b-a)*r+1;return-safeMin+T*x},R=b=>{const T=Math.exp(-b*r),x=(a-b)*(r*r);return T*x});const v=5/r,m=approximateRoot(d,R,v);if(r=secondsToMilliseconds(r),isNaN(m))return{stiffness:springDefaults.stiffness,damping:springDefaults.damping,duration:r};{const b=Math.pow(m,2)*c;return{stiffness:b,damping:u*2*Math.sqrt(c*b),duration:r}}}const rootIterations=12;function approximateRoot(r,n,a){let c=a;for(let d=1;d<rootIterations;d++)c=c-r(c)/n(c);return c}function calcAngularFreq(r,n){return r*Math.sqrt(1-n*n)}const durationKeys=["duration","bounce"],physicsKeys=["stiffness","damping","mass"];function isSpringType(r,n){return n.some(a=>r[a]!==void 0)}function getSpringOptions(r){let n={velocity:springDefaults.velocity,stiffness:springDefaults.stiffness,damping:springDefaults.damping,mass:springDefaults.mass,isResolvedFromDuration:!1,...r};if(!isSpringType(r,physicsKeys)&&isSpringType(r,durationKeys))if(r.visualDuration){const a=r.visualDuration,c=2*Math.PI/(a*1.2),d=c*c,R=2*clamp(.05,1,1-(r.bounce||0))*Math.sqrt(d);n={...n,mass:springDefaults.mass,stiffness:d,damping:R}}else{const a=findSpring(r);n={...n,...a,mass:springDefaults.mass},n.isResolvedFromDuration=!0}return n}function spring(r=springDefaults.visualDuration,n=springDefaults.bounce){const a=typeof r!="object"?{visualDuration:r,keyframes:[0,1],bounce:n}:r;let{restSpeed:c,restDelta:d}=a;const R=a.keyframes[0],u=a.keyframes[a.keyframes.length-1],v={done:!1,value:R},{stiffness:m,damping:b,mass:T,duration:x,velocity:k,isResolvedFromDuration:F}=getSpringOptions({...a,velocity:-millisecondsToSeconds(a.velocity||0)}),C=k||0,z=b/(2*Math.sqrt(m*T)),Q=u-R,J=millisecondsToSeconds(Math.sqrt(m/T)),q=Math.abs(Q)<5;c||(c=q?springDefaults.restSpeed.granular:springDefaults.restSpeed.default),d||(d=q?springDefaults.restDelta.granular:springDefaults.restDelta.default);let w;if(z<1){const V=calcAngularFreq(J,z);w=H=>{const Y=Math.exp(-z*J*H);return u-Y*((C+z*J*Q)/V*Math.sin(V*H)+Q*Math.cos(V*H))}}else if(z===1)w=V=>u-Math.exp(-J*V)*(Q+(C+J*Q)*V);else{const V=J*Math.sqrt(z*z-1);w=H=>{const Y=Math.exp(-z*J*H),O=Math.min(V*H,300);return u-Y*((C+z*J*Q)*Math.sinh(O)+V*Q*Math.cosh(O))/V}}const N={calculatedDuration:F&&x||null,next:V=>{const H=w(V);if(F)v.done=V>=x;else{let Y=V===0?C:0;z<1&&(Y=V===0?secondsToMilliseconds(C):calcGeneratorVelocity(w,V,H));const O=Math.abs(Y)<=c,ee=Math.abs(u-H)<=d;v.done=O&&ee}return v.value=v.done?u:H,v},toString:()=>{const V=Math.min(calcGeneratorDuration(N),maxGeneratorDuration),H=generateLinearEasing(Y=>N.next(V*Y).value,V,30);return V+"ms "+H},toTransition:()=>{}};return N}spring.applyToOptions=r=>{const n=createGeneratorEasing(r,100,spring);return r.ease=n.ease,r.duration=secondsToMilliseconds(n.duration),r.type="keyframes",r};function inertia({keyframes:r,velocity:n=0,power:a=.8,timeConstant:c=325,bounceDamping:d=10,bounceStiffness:R=500,modifyTarget:u,min:v,max:m,restDelta:b=.5,restSpeed:T}){const x=r[0],k={done:!1,value:x},F=O=>v!==void 0&&O<v||m!==void 0&&O>m,C=O=>v===void 0?m:m===void 0||Math.abs(v-O)<Math.abs(m-O)?v:m;let z=a*n;const Q=x+z,J=u===void 0?Q:u(Q);J!==Q&&(z=J-x);const q=O=>-z*Math.exp(-O/c),w=O=>J+q(O),N=O=>{const ee=q(O),Ae=w(O);k.done=Math.abs(ee)<=b,k.value=k.done?J:Ae};let V,H;const Y=O=>{F(k.value)&&(V=O,H=spring({keyframes:[k.value,C(k.value)],velocity:calcGeneratorVelocity(w,O,k.value),damping:d,stiffness:R,restDelta:b,restSpeed:T}))};return Y(0),{calculatedDuration:null,next:O=>{let ee=!1;return!H&&V===void 0&&(ee=!0,N(O),Y(O)),V!==void 0&&O>=V?H.next(O-V):(!ee&&N(O),k)}}}function createMixers(r,n,a){const c=[],d=a||MotionGlobalConfig.mix||mix,R=r.length-1;for(let u=0;u<R;u++){let v=d(r[u],r[u+1]);if(n){const m=Array.isArray(n)?n[u]||noop:n;v=pipe(m,v)}c.push(v)}return c}function interpolate(r,n,{clamp:a=!0,ease:c,mixer:d}={}){const R=r.length;if(invariant(R===n.length),R===1)return()=>n[0];if(R===2&&n[0]===n[1])return()=>n[1];const u=r[0]===r[1];r[0]>r[R-1]&&(r=[...r].reverse(),n=[...n].reverse());const v=createMixers(n,c,d),m=v.length,b=T=>{if(u&&T<r[0])return n[0];let x=0;if(m>1)for(;x<r.length-2&&!(T<r[x+1]);x++);const k=progress(r[x],r[x+1],T);return v[x](k)};return a?T=>b(clamp(r[0],r[R-1],T)):b}function fillOffset(r,n){const a=r[r.length-1];for(let c=1;c<=n;c++){const d=progress(0,n,c);r.push(mixNumber$1(a,1,d))}}function defaultOffset(r){const n=[0];return fillOffset(n,r.length-1),n}function convertOffsetToTimes(r,n){return r.map(a=>a*n)}function defaultEasing(r,n){return r.map(()=>n||easeInOut).splice(0,r.length-1)}function keyframes({duration:r=300,keyframes:n,times:a,ease:c="easeInOut"}){const d=isEasingArray(c)?c.map(easingDefinitionToFunction):easingDefinitionToFunction(c),R={done:!1,value:n[0]},u=convertOffsetToTimes(a&&a.length===n.length?a:defaultOffset(n),r),v=interpolate(u,n,{ease:Array.isArray(d)?d:defaultEasing(n,d)});return{calculatedDuration:r,next:m=>(R.value=v(m),R.done=m>=r,R)}}const isNotNull$1=r=>r!==null;function getFinalKeyframe$1(r,{repeat:n,repeatType:a="loop"},c,d=1){const R=r.filter(isNotNull$1),v=d<0||n&&a!=="loop"&&n%2===1?0:R.length-1;return!v||c===void 0?R[v]:c}const transitionTypeMap={decay:inertia,inertia,tween:keyframes,keyframes,spring};function replaceTransitionType(r){typeof r.type=="string"&&(r.type=transitionTypeMap[r.type])}class WithPromise{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(n=>{this.resolve=n})}notifyFinished(){this.resolve()}then(n,a){return this.finished.then(n,a)}}const percentToProgress=r=>r/100;class JSAnimation extends WithPromise{constructor(n){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:a}=this.options;a&&a.updatedAt!==time.now()&&this.tick(time.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=n,this.initAnimation(),this.play(),n.autoplay===!1&&this.pause()}initAnimation(){const{options:n}=this;replaceTransitionType(n);const{type:a=keyframes,repeat:c=0,repeatDelay:d=0,repeatType:R,velocity:u=0}=n;let{keyframes:v}=n;const m=a||keyframes;m!==keyframes&&typeof v[0]!="number"&&(this.mixKeyframes=pipe(percentToProgress,mix(v[0],v[1])),v=[0,100]);const b=m({...n,keyframes:v});R==="mirror"&&(this.mirroredGenerator=m({...n,keyframes:[...v].reverse(),velocity:-u})),b.calculatedDuration===null&&(b.calculatedDuration=calcGeneratorDuration(b));const{calculatedDuration:T}=b;this.calculatedDuration=T,this.resolvedDuration=T+d,this.totalDuration=this.resolvedDuration*(c+1)-d,this.generator=b}updateTime(n){const a=Math.round(n-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=a}tick(n,a=!1){const{generator:c,totalDuration:d,mixKeyframes:R,mirroredGenerator:u,resolvedDuration:v,calculatedDuration:m}=this;if(this.startTime===null)return c.next(0);const{delay:b=0,keyframes:T,repeat:x,repeatType:k,repeatDelay:F,type:C,onUpdate:z,finalKeyframe:Q}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,n):this.speed<0&&(this.startTime=Math.min(n-d/this.speed,this.startTime)),a?this.currentTime=n:this.updateTime(n);const J=this.currentTime-b*(this.playbackSpeed>=0?1:-1),q=this.playbackSpeed>=0?J<0:J>d;this.currentTime=Math.max(J,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=d);let w=this.currentTime,N=c;if(x){const O=Math.min(this.currentTime,d)/v;let ee=Math.floor(O),Ae=O%1;!Ae&&O>=1&&(Ae=1),Ae===1&&ee--,ee=Math.min(ee,x+1),ee%2&&(k==="reverse"?(Ae=1-Ae,F&&(Ae-=F/v)):k==="mirror"&&(N=u)),w=clamp(0,1,Ae)*v}const V=q?{done:!1,value:T[0]}:N.next(w);R&&(V.value=R(V.value));let{done:H}=V;!q&&m!==null&&(H=this.playbackSpeed>=0?this.currentTime>=d:this.currentTime<=0);const Y=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&H);return Y&&C!==inertia&&(V.value=getFinalKeyframe$1(T,this.options,Q,this.speed)),z&&z(V.value),Y&&this.finish(),V}then(n,a){return this.finished.then(n,a)}get duration(){return millisecondsToSeconds(this.calculatedDuration)}get iterationDuration(){const{delay:n=0}=this.options||{};return this.duration+millisecondsToSeconds(n)}get time(){return millisecondsToSeconds(this.currentTime)}set time(n){n=secondsToMilliseconds(n),this.currentTime=n,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=n:this.driver&&(this.startTime=this.driver.now()-n/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(n){this.updateTime(time.now());const a=this.playbackSpeed!==n;this.playbackSpeed=n,a&&(this.time=millisecondsToSeconds(this.currentTime))}play(){if(this.isStopped)return;const{driver:n=frameloopDriver,startTime:a}=this.options;this.driver||(this.driver=n(d=>this.tick(d))),this.options.onPlay?.();const c=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=c):this.holdTime!==null?this.startTime=c-this.holdTime:this.startTime||(this.startTime=a??c),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(time.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(n){return this.startTime=0,this.tick(n,!0)}attachTimeline(n){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),n.observe(this)}}function fillWildcards(r){for(let n=1;n<r.length;n++)r[n]??(r[n]=r[n-1])}const radToDeg=r=>r*180/Math.PI,rotate=r=>{const n=radToDeg(Math.atan2(r[1],r[0]));return rebaseAngle(n)},matrix2dParsers={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:r=>(Math.abs(r[0])+Math.abs(r[3]))/2,rotate,rotateZ:rotate,skewX:r=>radToDeg(Math.atan(r[1])),skewY:r=>radToDeg(Math.atan(r[2])),skew:r=>(Math.abs(r[1])+Math.abs(r[2]))/2},rebaseAngle=r=>(r=r%360,r<0&&(r+=360),r),rotateZ=rotate,scaleX=r=>Math.sqrt(r[0]*r[0]+r[1]*r[1]),scaleY=r=>Math.sqrt(r[4]*r[4]+r[5]*r[5]),matrix3dParsers={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX,scaleY,scale:r=>(scaleX(r)+scaleY(r))/2,rotateX:r=>rebaseAngle(radToDeg(Math.atan2(r[6],r[5]))),rotateY:r=>rebaseAngle(radToDeg(Math.atan2(-r[2],r[0]))),rotateZ,rotate:rotateZ,skewX:r=>radToDeg(Math.atan(r[4])),skewY:r=>radToDeg(Math.atan(r[1])),skew:r=>(Math.abs(r[1])+Math.abs(r[4]))/2};function defaultTransformValue(r){return r.includes("scale")?1:0}function parseValueFromTransform(r,n){if(!r||r==="none")return defaultTransformValue(n);const a=r.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let c,d;if(a)c=matrix3dParsers,d=a;else{const v=r.match(/^matrix\(([-\d.e\s,]+)\)$/u);c=matrix2dParsers,d=v}if(!d)return defaultTransformValue(n);const R=c[n],u=d[1].split(",").map(convertTransformToNumber);return typeof R=="function"?R(u):u[R]}const readTransformValue=(r,n)=>{const{transform:a="none"}=getComputedStyle(r);return parseValueFromTransform(a,n)};function convertTransformToNumber(r){return parseFloat(r.trim())}const transformPropOrder=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],transformProps=new Set(transformPropOrder),isNumOrPxType=r=>r===number||r===px,transformKeys=new Set(["x","y","z"]),nonTranslationalTransformKeys=transformPropOrder.filter(r=>!transformKeys.has(r));function removeNonTranslationalTransform(r){const n=[];return nonTranslationalTransformKeys.forEach(a=>{const c=r.getValue(a);c!==void 0&&(n.push([a,c.get()]),c.set(a.startsWith("scale")?1:0))}),n}const positionalValues={width:({x:r},{paddingLeft:n="0",paddingRight:a="0"})=>r.max-r.min-parseFloat(n)-parseFloat(a),height:({y:r},{paddingTop:n="0",paddingBottom:a="0"})=>r.max-r.min-parseFloat(n)-parseFloat(a),top:(r,{top:n})=>parseFloat(n),left:(r,{left:n})=>parseFloat(n),bottom:({y:r},{top:n})=>parseFloat(n)+(r.max-r.min),right:({x:r},{left:n})=>parseFloat(n)+(r.max-r.min),x:(r,{transform:n})=>parseValueFromTransform(n,"x"),y:(r,{transform:n})=>parseValueFromTransform(n,"y")};positionalValues.translateX=positionalValues.x;positionalValues.translateY=positionalValues.y;const toResolve=new Set;let isScheduled=!1,anyNeedsMeasurement=!1,isForced=!1;function measureAllKeyframes(){if(anyNeedsMeasurement){const r=Array.from(toResolve).filter(c=>c.needsMeasurement),n=new Set(r.map(c=>c.element)),a=new Map;n.forEach(c=>{const d=removeNonTranslationalTransform(c);d.length&&(a.set(c,d),c.render())}),r.forEach(c=>c.measureInitialState()),n.forEach(c=>{c.render();const d=a.get(c);d&&d.forEach(([R,u])=>{c.getValue(R)?.set(u)})}),r.forEach(c=>c.measureEndState()),r.forEach(c=>{c.suspendedScrollY!==void 0&&window.scrollTo(0,c.suspendedScrollY)})}anyNeedsMeasurement=!1,isScheduled=!1,toResolve.forEach(r=>r.complete(isForced)),toResolve.clear()}function readAllKeyframes(){toResolve.forEach(r=>{r.readKeyframes(),r.needsMeasurement&&(anyNeedsMeasurement=!0)})}function flushKeyframeResolvers(){isForced=!0,readAllKeyframes(),measureAllKeyframes(),isForced=!1}class KeyframeResolver{constructor(n,a,c,d,R,u=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...n],this.onComplete=a,this.name=c,this.motionValue=d,this.element=R,this.isAsync=u}scheduleResolve(){this.state="scheduled",this.isAsync?(toResolve.add(this),isScheduled||(isScheduled=!0,frame.read(readAllKeyframes),frame.resolveKeyframes(measureAllKeyframes))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:n,name:a,element:c,motionValue:d}=this;if(n[0]===null){const R=d?.get(),u=n[n.length-1];if(R!==void 0)n[0]=R;else if(c&&a){const v=c.readValue(a,u);v!=null&&(n[0]=v)}n[0]===void 0&&(n[0]=u),d&&R===void 0&&d.set(n[0])}fillWildcards(n)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(n=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,n),toResolve.delete(this)}cancel(){this.state==="scheduled"&&(toResolve.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const isCSSVar=r=>r.startsWith("--");function setStyle(r,n,a){isCSSVar(n)?r.style.setProperty(n,a):r.style[n]=a}const supportsScrollTimeline=memo(()=>window.ScrollTimeline!==void 0),supportsFlags={};function memoSupports(r,n){const a=memo(r);return()=>supportsFlags[n]??a()}const supportsLinearEasing=memoSupports(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),cubicBezierAsString=([r,n,a,c])=>`cubic-bezier(${r}, ${n}, ${a}, ${c})`,supportedWaapiEasing={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:cubicBezierAsString([0,.65,.55,1]),circOut:cubicBezierAsString([.55,0,1,.45]),backIn:cubicBezierAsString([.31,.01,.66,-.59]),backOut:cubicBezierAsString([.33,1.53,.69,.99])};function mapEasingToNativeEasing(r,n){if(r)return typeof r=="function"?supportsLinearEasing()?generateLinearEasing(r,n):"ease-out":isBezierDefinition(r)?cubicBezierAsString(r):Array.isArray(r)?r.map(a=>mapEasingToNativeEasing(a,n)||supportedWaapiEasing.easeOut):supportedWaapiEasing[r]}function startWaapiAnimation(r,n,a,{delay:c=0,duration:d=300,repeat:R=0,repeatType:u="loop",ease:v="easeOut",times:m}={},b=void 0){const T={[n]:a};m&&(T.offset=m);const x=mapEasingToNativeEasing(v,d);Array.isArray(x)&&(T.easing=x);const k={delay:c,duration:d,easing:Array.isArray(x)?"linear":x,fill:"both",iterations:R+1,direction:u==="reverse"?"alternate":"normal"};return b&&(k.pseudoElement=b),r.animate(T,k)}function isGenerator(r){return typeof r=="function"&&"applyToOptions"in r}function applyGeneratorOptions({type:r,...n}){return isGenerator(r)&&supportsLinearEasing()?r.applyToOptions(n):(n.duration??(n.duration=300),n.ease??(n.ease="easeOut"),n)}class NativeAnimation extends WithPromise{constructor(n){if(super(),this.finishedTime=null,this.isStopped=!1,this.manualStartTime=null,!n)return;const{element:a,name:c,keyframes:d,pseudoElement:R,allowFlatten:u=!1,finalKeyframe:v,onComplete:m}=n;this.isPseudoElement=!!R,this.allowFlatten=u,this.options=n,invariant(typeof n.type!="string");const b=applyGeneratorOptions(n);this.animation=startWaapiAnimation(a,c,d,b,R),b.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!R){const T=getFinalKeyframe$1(d,this.options,v,this.speed);this.updateMotionValue?this.updateMotionValue(T):setStyle(a,c,T),this.animation.cancel()}m?.(),this.notifyFinished()}}play(){this.isStopped||(this.manualStartTime=null,this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:n}=this;n==="idle"||n==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const n=this.animation.effect?.getComputedTiming?.().duration||0;return millisecondsToSeconds(Number(n))}get iterationDuration(){const{delay:n=0}=this.options||{};return this.duration+millisecondsToSeconds(n)}get time(){return millisecondsToSeconds(Number(this.animation.currentTime)||0)}set time(n){this.manualStartTime=null,this.finishedTime=null,this.animation.currentTime=secondsToMilliseconds(n)}get speed(){return this.animation.playbackRate}set speed(n){n<0&&(this.finishedTime=null),this.animation.playbackRate=n}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return this.manualStartTime??Number(this.animation.startTime)}set startTime(n){this.manualStartTime=this.animation.startTime=n}attachTimeline({timeline:n,observe:a}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,n&&supportsScrollTimeline()?(this.animation.timeline=n,noop):a(this)}}const unsupportedEasingFunctions={anticipate,backInOut,circInOut};function isUnsupportedEase(r){return r in unsupportedEasingFunctions}function replaceStringEasing(r){typeof r.ease=="string"&&isUnsupportedEase(r.ease)&&(r.ease=unsupportedEasingFunctions[r.ease])}const sampleDelta=10;class NativeAnimationExtended extends NativeAnimation{constructor(n){replaceStringEasing(n),replaceTransitionType(n),super(n),n.startTime!==void 0&&(this.startTime=n.startTime),this.options=n}updateMotionValue(n){const{motionValue:a,onUpdate:c,onComplete:d,element:R,...u}=this.options;if(!a)return;if(n!==void 0){a.set(n);return}const v=new JSAnimation({...u,autoplay:!1}),m=Math.max(sampleDelta,time.now()-this.startTime),b=clamp(0,sampleDelta,m-sampleDelta);a.setWithVelocity(v.sample(Math.max(0,m-b)).value,v.sample(m).value,b),v.stop()}}const isAnimatable=(r,n)=>n==="zIndex"?!1:!!(typeof r=="number"||Array.isArray(r)||typeof r=="string"&&(complex.test(r)||r==="0")&&!r.startsWith("url("));function hasKeyframesChanged(r){const n=r[0];if(r.length===1)return!0;for(let a=0;a<r.length;a++)if(r[a]!==n)return!0}function canAnimate(r,n,a,c){const d=r[0];if(d===null)return!1;if(n==="display"||n==="visibility")return!0;const R=r[r.length-1],u=isAnimatable(d,n),v=isAnimatable(R,n);return!u||!v?!1:hasKeyframesChanged(r)||(a==="spring"||isGenerator(a))&&c}function makeAnimationInstant(r){r.duration=0,r.type="keyframes"}const acceleratedValues=new Set(["opacity","clipPath","filter","transform"]),supportsWaapi=memo(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function supportsBrowserAnimation(r){const{motionValue:n,name:a,repeatDelay:c,repeatType:d,damping:R,type:u}=r;if(!(n?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:m,transformTemplate:b}=n.owner.getProps();return supportsWaapi()&&a&&acceleratedValues.has(a)&&(a!=="transform"||!b)&&!m&&!c&&d!=="mirror"&&R!==0&&u!=="inertia"}const MAX_RESOLVE_DELAY=40;class AsyncMotionValueAnimation extends WithPromise{constructor({autoplay:n=!0,delay:a=0,type:c="keyframes",repeat:d=0,repeatDelay:R=0,repeatType:u="loop",keyframes:v,name:m,motionValue:b,element:T,...x}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=time.now();const k={autoplay:n,delay:a,type:c,repeat:d,repeatDelay:R,repeatType:u,name:m,motionValue:b,element:T,...x},F=T?.KeyframeResolver||KeyframeResolver;this.keyframeResolver=new F(v,(C,z,Q)=>this.onKeyframesResolved(C,z,k,!Q),m,b,T),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(n,a,c,d){this.keyframeResolver=void 0;const{name:R,type:u,velocity:v,delay:m,isHandoff:b,onUpdate:T}=c;this.resolvedAt=time.now(),canAnimate(n,R,u,v)||((MotionGlobalConfig.instantAnimations||!m)&&T?.(getFinalKeyframe$1(n,c,a)),n[0]=n[n.length-1],makeAnimationInstant(c),c.repeat=0);const k={startTime:d?this.resolvedAt?this.resolvedAt-this.createdAt>MAX_RESOLVE_DELAY?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:a,...c,keyframes:n},F=!b&&supportsBrowserAnimation(k)?new NativeAnimationExtended({...k,element:k.motionValue.owner.current}):new JSAnimation(k);F.finished.then(()=>this.notifyFinished()).catch(noop),this.pendingTimeline&&(this.stopTimeline=F.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=F}get finished(){return this._animation?this.animation.finished:this._finished}then(n,a){return this.finished.finally(n).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),flushKeyframeResolvers()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(n){this.animation.time=n}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(n){this.animation.speed=n}get startTime(){return this.animation.startTime}attachTimeline(n){return this._animation?this.stopTimeline=this.animation.attachTimeline(n):this.pendingTimeline=n,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const splitCSSVariableRegex=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function parseCSSVariable(r){const n=splitCSSVariableRegex.exec(r);if(!n)return[,];const[,a,c,d]=n;return[`--${a??c}`,d]}function getVariableValue(r,n,a=1){const[c,d]=parseCSSVariable(r);if(!c)return;const R=window.getComputedStyle(n).getPropertyValue(c);if(R){const u=R.trim();return isNumericalString(u)?parseFloat(u):u}return isCSSVariableToken(d)?getVariableValue(d,n,a+1):d}function getValueTransition(r,n){return r?.[n]??r?.default??r}const underDampedSpring={type:"spring",stiffness:500,damping:25,restSpeed:10},criticallyDampedSpring=r=>({type:"spring",stiffness:550,damping:r===0?2*Math.sqrt(550):30,restSpeed:10}),keyframesTransition={type:"keyframes",duration:.8},ease={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},getDefaultTransition=(r,{keyframes:n})=>n.length>2?keyframesTransition:transformProps.has(r)?r.startsWith("scale")?criticallyDampedSpring(n[1]):underDampedSpring:ease;function isTransitionDefined({when:r,delay:n,delayChildren:a,staggerChildren:c,staggerDirection:d,repeat:R,repeatType:u,repeatDelay:v,from:m,elapsed:b,...T}){return!!Object.keys(T).length}const isNotNull=r=>r!==null;function getFinalKeyframe(r,{repeat:n,repeatType:a="loop"},c){const d=r.filter(isNotNull),R=n&&a!=="loop"&&n%2===1?0:d.length-1;return d[R]}function calcChildStagger(r,n,a,c=0,d=1){const R=Array.from(r).sort((b,T)=>b.sortNodePosition(T)).indexOf(n),u=r.size,v=(u-1)*c;return typeof a=="function"?a(R,u):d===1?R*c:v-R*c}const animateMotionValue=(r,n,a,c={},d,R)=>u=>{const v=getValueTransition(c,r)||{},m=v.delay||c.delay||0;let{elapsed:b=0}=c;b=b-secondsToMilliseconds(m);const T={keyframes:Array.isArray(a)?a:[null,a],ease:"easeOut",velocity:n.getVelocity(),...v,delay:-b,onUpdate:k=>{n.set(k),v.onUpdate&&v.onUpdate(k)},onComplete:()=>{u(),v.onComplete&&v.onComplete()},name:r,motionValue:n,element:R?void 0:d};isTransitionDefined(v)||Object.assign(T,getDefaultTransition(r,T)),T.duration&&(T.duration=secondsToMilliseconds(T.duration)),T.repeatDelay&&(T.repeatDelay=secondsToMilliseconds(T.repeatDelay)),T.from!==void 0&&(T.keyframes[0]=T.from);let x=!1;if((T.type===!1||T.duration===0&&!T.repeatDelay)&&(makeAnimationInstant(T),T.delay===0&&(x=!0)),(MotionGlobalConfig.instantAnimations||MotionGlobalConfig.skipAnimations)&&(x=!0,makeAnimationInstant(T),T.delay=0),T.allowFlatten=!v.type&&!v.ease,x&&!R&&n.get()!==void 0){const k=getFinalKeyframe(T.keyframes,v);if(k!==void 0){frame.update(()=>{T.onUpdate(k),T.onComplete()});return}}return v.isSync?new JSAnimation(T):new AsyncMotionValueAnimation(T)},positionalKeys=new Set(["width","height","top","left","right","bottom",...transformPropOrder]),MAX_VELOCITY_DELTA=30,isFloat=r=>!isNaN(parseFloat(r));class MotionValue{constructor(n,a={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=c=>{const d=time.now();if(this.updatedAt!==d&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(c),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const R of this.dependents)R.dirty()},this.hasAnimated=!1,this.setCurrent(n),this.owner=a.owner}setCurrent(n){this.current=n,this.updatedAt=time.now(),this.canTrackVelocity===null&&n!==void 0&&(this.canTrackVelocity=isFloat(this.current))}setPrevFrameValue(n=this.current){this.prevFrameValue=n,this.prevUpdatedAt=this.updatedAt}onChange(n){return this.on("change",n)}on(n,a){this.events[n]||(this.events[n]=new SubscriptionManager);const c=this.events[n].add(a);return n==="change"?()=>{c(),frame.read(()=>{this.events.change.getSize()||this.stop()})}:c}clearListeners(){for(const n in this.events)this.events[n].clear()}attach(n,a){this.passiveEffect=n,this.stopPassiveEffect=a}set(n){this.passiveEffect?this.passiveEffect(n,this.updateAndNotify):this.updateAndNotify(n)}setWithVelocity(n,a,c){this.set(a),this.prev=void 0,this.prevFrameValue=n,this.prevUpdatedAt=this.updatedAt-c}jump(n,a=!0){this.updateAndNotify(n),this.prev=n,this.prevUpdatedAt=this.prevFrameValue=void 0,a&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(n){this.dependents||(this.dependents=new Set),this.dependents.add(n)}removeDependent(n){this.dependents&&this.dependents.delete(n)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const n=time.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||n-this.updatedAt>MAX_VELOCITY_DELTA)return 0;const a=Math.min(this.updatedAt-this.prevUpdatedAt,MAX_VELOCITY_DELTA);return velocityPerSecond(parseFloat(this.current)-parseFloat(this.prevFrameValue),a)}start(n){return this.stop(),new Promise(a=>{this.hasAnimated=!0,this.animation=n(a),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function motionValue(r,n){return new MotionValue(r,n)}function getValueState(r){const n=[{},{}];return r?.values.forEach((a,c)=>{n[0][c]=a.get(),n[1][c]=a.getVelocity()}),n}function resolveVariantFromProps(r,n,a,c){if(typeof n=="function"){const[d,R]=getValueState(c);n=n(a!==void 0?a:r.custom,d,R)}if(typeof n=="string"&&(n=r.variants&&r.variants[n]),typeof n=="function"){const[d,R]=getValueState(c);n=n(a!==void 0?a:r.custom,d,R)}return n}function resolveVariant(r,n,a){const c=r.getProps();return resolveVariantFromProps(c,n,a!==void 0?a:c.custom,r)}const isKeyframesTarget=r=>Array.isArray(r);function setMotionValue(r,n,a){r.hasValue(n)?r.getValue(n).set(a):r.addValue(n,motionValue(a))}function resolveFinalValueInKeyframes(r){return isKeyframesTarget(r)?r[r.length-1]||0:r}function setTarget(r,n){const a=resolveVariant(r,n);let{transitionEnd:c={},transition:d={},...R}=a||{};R={...R,...c};for(const u in R){const v=resolveFinalValueInKeyframes(R[u]);setMotionValue(r,u,v)}}const isMotionValue=r=>!!(r&&r.getVelocity);function isWillChangeMotionValue(r){return!!(isMotionValue(r)&&r.add)}function addValueToWillChange(r,n){const a=r.getValue("willChange");if(isWillChangeMotionValue(a))return a.add(n);if(!a&&MotionGlobalConfig.WillChange){const c=new MotionGlobalConfig.WillChange("auto");r.addValue("willChange",c),c.add(n)}}function camelToDash(r){return r.replace(/([A-Z])/g,n=>`-${n.toLowerCase()}`)}const optimizedAppearDataId="framerAppearId",optimizedAppearDataAttribute="data-"+camelToDash(optimizedAppearDataId);function getOptimisedAppearId(r){return r.props[optimizedAppearDataAttribute]}function shouldBlockAnimation({protectedKeys:r,needsAnimating:n},a){const c=r.hasOwnProperty(a)&&n[a]!==!0;return n[a]=!1,c}function animateTarget(r,n,{delay:a=0,transitionOverride:c,type:d}={}){let{transition:R=r.getDefaultTransition(),transitionEnd:u,...v}=n;c&&(R=c);const m=[],b=d&&r.animationState&&r.animationState.getState()[d];for(const T in v){const x=r.getValue(T,r.latestValues[T]??null),k=v[T];if(k===void 0||b&&shouldBlockAnimation(b,T))continue;const F={delay:a,...getValueTransition(R||{},T)},C=x.get();if(C!==void 0&&!x.isAnimating&&!Array.isArray(k)&&k===C&&!F.velocity)continue;let z=!1;if(window.MotionHandoffAnimation){const J=getOptimisedAppearId(r);if(J){const q=window.MotionHandoffAnimation(J,T,frame);q!==null&&(F.startTime=q,z=!0)}}addValueToWillChange(r,T),x.start(animateMotionValue(T,x,k,r.shouldReduceMotion&&positionalKeys.has(T)?{type:!1}:F,r,z));const Q=x.animation;Q&&m.push(Q)}return u&&Promise.all(m).then(()=>{frame.update(()=>{u&&setTarget(r,u)})}),m}function animateVariant(r,n,a={}){const c=resolveVariant(r,n,a.type==="exit"?r.presenceContext?.custom:void 0);let{transition:d=r.getDefaultTransition()||{}}=c||{};a.transitionOverride&&(d=a.transitionOverride);const R=c?()=>Promise.all(animateTarget(r,c,a)):()=>Promise.resolve(),u=r.variantChildren&&r.variantChildren.size?(m=0)=>{const{delayChildren:b=0,staggerChildren:T,staggerDirection:x}=d;return animateChildren(r,n,m,b,T,x,a)}:()=>Promise.resolve(),{when:v}=d;if(v){const[m,b]=v==="beforeChildren"?[R,u]:[u,R];return m().then(()=>b())}else return Promise.all([R(),u(a.delay)])}function animateChildren(r,n,a=0,c=0,d=0,R=1,u){const v=[];for(const m of r.variantChildren)m.notify("AnimationStart",n),v.push(animateVariant(m,n,{...u,delay:a+(typeof c=="function"?0:c)+calcChildStagger(r.variantChildren,m,c,d,R)}).then(()=>m.notify("AnimationComplete",n)));return Promise.all(v)}function animateVisualElement(r,n,a={}){r.notify("AnimationStart",n);let c;if(Array.isArray(n)){const d=n.map(R=>animateVariant(r,R,a));c=Promise.all(d)}else if(typeof n=="string")c=animateVariant(r,n,a);else{const d=typeof n=="function"?resolveVariant(r,n,a.custom):n;c=Promise.all(animateTarget(r,d,a))}return c.then(()=>{r.notify("AnimationComplete",n)})}const auto={test:r=>r==="auto",parse:r=>r},testValueType=r=>n=>n.test(r),dimensionValueTypes=[number,px,percent,degrees,vw,vh,auto],findDimensionValueType=r=>dimensionValueTypes.find(testValueType(r));function isNone(r){return typeof r=="number"?r===0:r!==null?r==="none"||r==="0"||isZeroValueString(r):!0}const maxDefaults=new Set(["brightness","contrast","saturate","opacity"]);function applyDefaultFilter(r){const[n,a]=r.slice(0,-1).split("(");if(n==="drop-shadow")return r;const[c]=a.match(floatRegex)||[];if(!c)return r;const d=a.replace(c,"");let R=maxDefaults.has(n)?1:0;return c!==a&&(R*=100),n+"("+R+d+")"}const functionRegex=/\b([a-z-]*)\(.*?\)/gu,filter={...complex,getAnimatableNone:r=>{const n=r.match(functionRegex);return n?n.map(applyDefaultFilter).join(" "):r}},int={...number,transform:Math.round},transformValueTypes={rotate:degrees,rotateX:degrees,rotateY:degrees,rotateZ:degrees,scale,scaleX:scale,scaleY:scale,scaleZ:scale,skew:degrees,skewX:degrees,skewY:degrees,distance:px,translateX:px,translateY:px,translateZ:px,x:px,y:px,z:px,perspective:px,transformPerspective:px,opacity:alpha,originX:progressPercentage,originY:progressPercentage,originZ:px},numberValueTypes={borderWidth:px,borderTopWidth:px,borderRightWidth:px,borderBottomWidth:px,borderLeftWidth:px,borderRadius:px,radius:px,borderTopLeftRadius:px,borderTopRightRadius:px,borderBottomRightRadius:px,borderBottomLeftRadius:px,width:px,maxWidth:px,height:px,maxHeight:px,top:px,right:px,bottom:px,left:px,inset:px,insetBlock:px,insetBlockStart:px,insetBlockEnd:px,insetInline:px,insetInlineStart:px,insetInlineEnd:px,padding:px,paddingTop:px,paddingRight:px,paddingBottom:px,paddingLeft:px,paddingBlock:px,paddingBlockStart:px,paddingBlockEnd:px,paddingInline:px,paddingInlineStart:px,paddingInlineEnd:px,margin:px,marginTop:px,marginRight:px,marginBottom:px,marginLeft:px,marginBlock:px,marginBlockStart:px,marginBlockEnd:px,marginInline:px,marginInlineStart:px,marginInlineEnd:px,backgroundPositionX:px,backgroundPositionY:px,...transformValueTypes,zIndex:int,fillOpacity:alpha,strokeOpacity:alpha,numOctaves:int},defaultValueTypes={...numberValueTypes,color,backgroundColor:color,outlineColor:color,fill:color,stroke:color,borderColor:color,borderTopColor:color,borderRightColor:color,borderBottomColor:color,borderLeftColor:color,filter,WebkitFilter:filter},getDefaultValueType=r=>defaultValueTypes[r];function getAnimatableNone(r,n){let a=getDefaultValueType(r);return a!==filter&&(a=complex),a.getAnimatableNone?a.getAnimatableNone(n):void 0}const invalidTemplates=new Set(["auto","none","0"]);function makeNoneKeyframesAnimatable(r,n,a){let c=0,d;for(;c<r.length&&!d;){const R=r[c];typeof R=="string"&&!invalidTemplates.has(R)&&analyseComplexValue(R).values.length&&(d=r[c]),c++}if(d&&a)for(const R of n)r[R]=getAnimatableNone(a,d)}class DOMKeyframesResolver extends KeyframeResolver{constructor(n,a,c,d,R){super(n,a,c,d,R,!0)}readKeyframes(){const{unresolvedKeyframes:n,element:a,name:c}=this;if(!a||!a.current)return;super.readKeyframes();for(let T=0;T<n.length;T++){let x=n[T];if(typeof x=="string"&&(x=x.trim(),isCSSVariableToken(x))){const k=getVariableValue(x,a.current);k!==void 0&&(n[T]=k),T===n.length-1&&(this.finalKeyframe=x)}}if(this.resolveNoneKeyframes(),!positionalKeys.has(c)||n.length!==2)return;const[d,R]=n,u=findDimensionValueType(d),v=findDimensionValueType(R),m=containsCSSVariable(d),b=containsCSSVariable(R);if(m!==b&&positionalValues[c]){this.needsMeasurement=!0;return}if(u!==v)if(isNumOrPxType(u)&&isNumOrPxType(v))for(let T=0;T<n.length;T++){const x=n[T];typeof x=="string"&&(n[T]=parseFloat(x))}else positionalValues[c]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:n,name:a}=this,c=[];for(let d=0;d<n.length;d++)(n[d]===null||isNone(n[d]))&&c.push(d);c.length&&makeNoneKeyframesAnimatable(n,c,a)}measureInitialState(){const{element:n,unresolvedKeyframes:a,name:c}=this;if(!n||!n.current)return;c==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=positionalValues[c](n.measureViewportBox(),window.getComputedStyle(n.current)),a[0]=this.measuredOrigin;const d=a[a.length-1];d!==void 0&&n.getValue(c,d).jump(d,!1)}measureEndState(){const{element:n,name:a,unresolvedKeyframes:c}=this;if(!n||!n.current)return;const d=n.getValue(a);d&&d.jump(this.measuredOrigin,!1);const R=c.length-1,u=c[R];c[R]=positionalValues[a](n.measureViewportBox(),window.getComputedStyle(n.current)),u!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=u),this.removedTransforms?.length&&this.removedTransforms.forEach(([v,m])=>{n.getValue(v).set(m)}),this.resolveNoneKeyframes()}}function resolveElements(r,n,a){if(r instanceof EventTarget)return[r];if(typeof r=="string"){let c=document;const d=a?.[r]??c.querySelectorAll(r);return d?Array.from(d):[]}return Array.from(r)}const getValueAsType=(r,n)=>n&&typeof r=="number"?n.transform(r):r;function isHTMLElement(r){return isObject(r)&&"offsetHeight"in r}const{schedule:microtask}=createRenderBatcher(queueMicrotask,!1),isDragging={x:!1,y:!1};function isDragActive(){return isDragging.x||isDragging.y}function setDragLock(r){return r==="x"||r==="y"?isDragging[r]?null:(isDragging[r]=!0,()=>{isDragging[r]=!1}):isDragging.x||isDragging.y?null:(isDragging.x=isDragging.y=!0,()=>{isDragging.x=isDragging.y=!1})}function setupGesture(r,n){const a=resolveElements(r),c=new AbortController,d={passive:!0,...n,signal:c.signal};return[a,d,()=>c.abort()]}function isValidHover(r){return!(r.pointerType==="touch"||isDragActive())}function hover(r,n,a={}){const[c,d,R]=setupGesture(r,a),u=v=>{if(!isValidHover(v))return;const{target:m}=v,b=n(m,v);if(typeof b!="function"||!m)return;const T=x=>{isValidHover(x)&&(b(x),m.removeEventListener("pointerleave",T))};m.addEventListener("pointerleave",T,d)};return c.forEach(v=>{v.addEventListener("pointerenter",u,d)}),R}const isNodeOrChild=(r,n)=>n?r===n?!0:isNodeOrChild(r,n.parentElement):!1,isPrimaryPointer=r=>r.pointerType==="mouse"?typeof r.button!="number"||r.button<=0:r.isPrimary!==!1,interactiveElements=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function isElementKeyboardAccessible(r){return interactiveElements.has(r.tagName)||r.isContentEditable===!0}const isPressing=new WeakSet;function filterEvents(r){return n=>{n.key==="Enter"&&r(n)}}function firePointerEvent(r,n){r.dispatchEvent(new PointerEvent("pointer"+n,{isPrimary:!0,bubbles:!0}))}const enableKeyboardPress=(r,n)=>{const a=r.currentTarget;if(!a)return;const c=filterEvents(()=>{if(isPressing.has(a))return;firePointerEvent(a,"down");const d=filterEvents(()=>{firePointerEvent(a,"up")}),R=()=>firePointerEvent(a,"cancel");a.addEventListener("keyup",d,n),a.addEventListener("blur",R,n)});a.addEventListener("keydown",c,n),a.addEventListener("blur",()=>a.removeEventListener("keydown",c),n)};function isValidPressEvent(r){return isPrimaryPointer(r)&&!isDragActive()}function press(r,n,a={}){const[c,d,R]=setupGesture(r,a),u=v=>{const m=v.currentTarget;if(!isValidPressEvent(v))return;isPressing.add(m);const b=n(m,v),T=(F,C)=>{window.removeEventListener("pointerup",x),window.removeEventListener("pointercancel",k),isPressing.has(m)&&isPressing.delete(m),isValidPressEvent(F)&&typeof b=="function"&&b(F,{success:C})},x=F=>{T(F,m===window||m===document||a.useGlobalTarget||isNodeOrChild(m,F.target))},k=F=>{T(F,!1)};window.addEventListener("pointerup",x,d),window.addEventListener("pointercancel",k,d)};return c.forEach(v=>{(a.useGlobalTarget?window:v).addEventListener("pointerdown",u,d),isHTMLElement(v)&&(v.addEventListener("focus",b=>enableKeyboardPress(b,d)),!isElementKeyboardAccessible(v)&&!v.hasAttribute("tabindex")&&(v.tabIndex=0))}),R}function isSVGElement(r){return isObject(r)&&"ownerSVGElement"in r}function isSVGSVGElement(r){return isSVGElement(r)&&r.tagName==="svg"}const valueTypes=[...dimensionValueTypes,color,complex],findValueType=r=>valueTypes.find(testValueType(r)),createAxisDelta=()=>({translate:0,scale:1,origin:0,originPoint:0}),createDelta=()=>({x:createAxisDelta(),y:createAxisDelta()}),createAxis=()=>({min:0,max:0}),createBox=()=>({x:createAxis(),y:createAxis()}),prefersReducedMotion={current:null},hasReducedMotionListener={current:!1},isBrowser=typeof window<"u";function initPrefersReducedMotion(){if(hasReducedMotionListener.current=!0,!!isBrowser)if(window.matchMedia){const r=window.matchMedia("(prefers-reduced-motion)"),n=()=>prefersReducedMotion.current=r.matches;r.addEventListener("change",n),n()}else prefersReducedMotion.current=!1}const visualElementStore=new WeakMap;function isAnimationControls(r){return r!==null&&typeof r=="object"&&typeof r.start=="function"}function isVariantLabel(r){return typeof r=="string"||Array.isArray(r)}const variantPriorityOrder=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],variantProps=["initial",...variantPriorityOrder];function isControllingVariants(r){return isAnimationControls(r.animate)||variantProps.some(n=>isVariantLabel(r[n]))}function isVariantNode(r){return!!(isControllingVariants(r)||r.variants)}function updateMotionValuesFromProps(r,n,a){for(const c in n){const d=n[c],R=a[c];if(isMotionValue(d))r.addValue(c,d);else if(isMotionValue(R))r.addValue(c,motionValue(d,{owner:r}));else if(R!==d)if(r.hasValue(c)){const u=r.getValue(c);u.liveStyle===!0?u.jump(d):u.hasAnimated||u.set(d)}else{const u=r.getStaticValue(c);r.addValue(c,motionValue(u!==void 0?u:d,{owner:r}))}}for(const c in a)n[c]===void 0&&r.removeValue(c);return n}const propEventHandlers=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];let featureDefinitions={};function setFeatureDefinitions(r){featureDefinitions=r}function getFeatureDefinitions(){return featureDefinitions}class VisualElement{scrapeMotionValuesFromProps(n,a,c){return{}}constructor({parent:n,props:a,presenceContext:c,reducedMotionConfig:d,blockInitialAnimation:R,visualState:u},v={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=KeyframeResolver,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const k=time.now();this.renderScheduledAt<k&&(this.renderScheduledAt=k,frame.render(this.render,!1,!0))};const{latestValues:m,renderState:b}=u;this.latestValues=m,this.baseTarget={...m},this.initialValues=a.initial?{...m}:{},this.renderState=b,this.parent=n,this.props=a,this.presenceContext=c,this.depth=n?n.depth+1:0,this.reducedMotionConfig=d,this.options=v,this.blockInitialAnimation=!!R,this.isControllingVariants=isControllingVariants(a),this.isVariantNode=isVariantNode(a),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(n&&n.current);const{willChange:T,...x}=this.scrapeMotionValuesFromProps(a,{},this);for(const k in x){const F=x[k];m[k]!==void 0&&isMotionValue(F)&&F.set(m[k])}}mount(n){this.current=n,visualElementStore.set(n,this),this.projection&&!this.projection.instance&&this.projection.mount(n),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((a,c)=>this.bindToMotionValue(c,a)),this.reducedMotionConfig==="never"?this.shouldReduceMotion=!1:this.reducedMotionConfig==="always"?this.shouldReduceMotion=!0:(hasReducedMotionListener.current||initPrefersReducedMotion(),this.shouldReduceMotion=prefersReducedMotion.current),this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),cancelFrame(this.notifyUpdate),cancelFrame(this.render),this.valueSubscriptions.forEach(n=>n()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const n in this.events)this.events[n].clear();for(const n in this.features){const a=this.features[n];a&&(a.unmount(),a.isMounted=!1)}this.current=null}addChild(n){this.children.add(n),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(n)}removeChild(n){this.children.delete(n),this.enteringChildren&&this.enteringChildren.delete(n)}bindToMotionValue(n,a){this.valueSubscriptions.has(n)&&this.valueSubscriptions.get(n)();const c=transformProps.has(n);c&&this.onBindTransform&&this.onBindTransform();const d=a.on("change",u=>{this.latestValues[n]=u,this.props.onUpdate&&frame.preRender(this.notifyUpdate),c&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let R;typeof window<"u"&&window.MotionCheckAppearSync&&(R=window.MotionCheckAppearSync(this,n,a)),this.valueSubscriptions.set(n,()=>{d(),R&&R(),a.owner&&a.stop()})}sortNodePosition(n){return!this.current||!this.sortInstanceNodePosition||this.type!==n.type?0:this.sortInstanceNodePosition(this.current,n.current)}updateFeatures(){let n="animation";for(n in featureDefinitions){const a=featureDefinitions[n];if(!a)continue;const{isEnabled:c,Feature:d}=a;if(!this.features[n]&&d&&c(this.props)&&(this.features[n]=new d(this)),this.features[n]){const R=this.features[n];R.isMounted?R.update():(R.mount(),R.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):createBox()}getStaticValue(n){return this.latestValues[n]}setStaticValue(n,a){this.latestValues[n]=a}update(n,a){(n.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=n,this.prevPresenceContext=this.presenceContext,this.presenceContext=a;for(let c=0;c<propEventHandlers.length;c++){const d=propEventHandlers[c];this.propEventSubscriptions[d]&&(this.propEventSubscriptions[d](),delete this.propEventSubscriptions[d]);const R="on"+d,u=n[R];u&&(this.propEventSubscriptions[d]=this.on(d,u))}this.prevMotionValues=updateMotionValuesFromProps(this,this.scrapeMotionValuesFromProps(n,this.prevProps||{},this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(n){return this.props.variants?this.props.variants[n]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(n){const a=this.getClosestVariantNode();if(a)return a.variantChildren&&a.variantChildren.add(n),()=>a.variantChildren.delete(n)}addValue(n,a){const c=this.values.get(n);a!==c&&(c&&this.removeValue(n),this.bindToMotionValue(n,a),this.values.set(n,a),this.latestValues[n]=a.get())}removeValue(n){this.values.delete(n);const a=this.valueSubscriptions.get(n);a&&(a(),this.valueSubscriptions.delete(n)),delete this.latestValues[n],this.removeValueFromRenderState(n,this.renderState)}hasValue(n){return this.values.has(n)}getValue(n,a){if(this.props.values&&this.props.values[n])return this.props.values[n];let c=this.values.get(n);return c===void 0&&a!==void 0&&(c=motionValue(a===null?void 0:a,{owner:this}),this.addValue(n,c)),c}readValue(n,a){let c=this.latestValues[n]!==void 0||!this.current?this.latestValues[n]:this.getBaseTargetFromProps(this.props,n)??this.readValueFromInstance(this.current,n,this.options);return c!=null&&(typeof c=="string"&&(isNumericalString(c)||isZeroValueString(c))?c=parseFloat(c):!findValueType(c)&&complex.test(a)&&(c=getAnimatableNone(n,a)),this.setBaseTarget(n,isMotionValue(c)?c.get():c)),isMotionValue(c)?c.get():c}setBaseTarget(n,a){this.baseTarget[n]=a}getBaseTarget(n){const{initial:a}=this.props;let c;if(typeof a=="string"||typeof a=="object"){const R=resolveVariantFromProps(this.props,a,this.presenceContext?.custom);R&&(c=R[n])}if(a&&c!==void 0)return c;const d=this.getBaseTargetFromProps(this.props,n);return d!==void 0&&!isMotionValue(d)?d:this.initialValues[n]!==void 0&&c===void 0?void 0:this.baseTarget[n]}on(n,a){return this.events[n]||(this.events[n]=new SubscriptionManager),this.events[n].add(a)}notify(n,...a){this.events[n]&&this.events[n].notify(...a)}scheduleRenderMicrotask(){microtask.render(this.render)}}class Feature{constructor(n){this.isMounted=!1,this.node=n}update(){}}class DOMVisualElement extends VisualElement{constructor(){super(...arguments),this.KeyframeResolver=DOMKeyframesResolver}sortInstanceNodePosition(n,a){return n.compareDocumentPosition(a)&2?1:-1}getBaseTargetFromProps(n,a){const c=n.style;return c?c[a]:void 0}removeValueFromRenderState(n,{vars:a,style:c}){delete a[n],delete c[n]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:n}=this.props;isMotionValue(n)&&(this.childSubscription=n.on("change",a=>{this.current&&(this.current.textContent=`${a}`)}))}}function convertBoundingBoxToBox({top:r,left:n,right:a,bottom:c}){return{x:{min:n,max:a},y:{min:r,max:c}}}function convertBoxToBoundingBox({x:r,y:n}){return{top:n.min,right:r.max,bottom:n.max,left:r.min}}function transformBoxPoints(r,n){if(!n)return r;const a=n({x:r.left,y:r.top}),c=n({x:r.right,y:r.bottom});return{top:a.y,left:a.x,bottom:c.y,right:c.x}}function isIdentityScale(r){return r===void 0||r===1}function hasScale({scale:r,scaleX:n,scaleY:a}){return!isIdentityScale(r)||!isIdentityScale(n)||!isIdentityScale(a)}function hasTransform(r){return hasScale(r)||has2DTranslate(r)||r.z||r.rotate||r.rotateX||r.rotateY||r.skewX||r.skewY}function has2DTranslate(r){return is2DTranslate(r.x)||is2DTranslate(r.y)}function is2DTranslate(r){return r&&r!=="0%"}function scalePoint(r,n,a){const c=r-a,d=n*c;return a+d}function applyPointDelta(r,n,a,c,d){return d!==void 0&&(r=scalePoint(r,d,c)),scalePoint(r,a,c)+n}function applyAxisDelta(r,n=0,a=1,c,d){r.min=applyPointDelta(r.min,n,a,c,d),r.max=applyPointDelta(r.max,n,a,c,d)}function applyBoxDelta(r,{x:n,y:a}){applyAxisDelta(r.x,n.translate,n.scale,n.originPoint),applyAxisDelta(r.y,a.translate,a.scale,a.originPoint)}const TREE_SCALE_SNAP_MIN=.999999999999,TREE_SCALE_SNAP_MAX=1.0000000000001;function applyTreeDeltas(r,n,a,c=!1){const d=a.length;if(!d)return;n.x=n.y=1;let R,u;for(let v=0;v<d;v++){R=a[v],u=R.projectionDelta;const{visualElement:m}=R.options;m&&m.props.style&&m.props.style.display==="contents"||(c&&R.options.layoutScroll&&R.scroll&&R!==R.root&&transformBox(r,{x:-R.scroll.offset.x,y:-R.scroll.offset.y}),u&&(n.x*=u.x.scale,n.y*=u.y.scale,applyBoxDelta(r,u)),c&&hasTransform(R.latestValues)&&transformBox(r,R.latestValues))}n.x<TREE_SCALE_SNAP_MAX&&n.x>TREE_SCALE_SNAP_MIN&&(n.x=1),n.y<TREE_SCALE_SNAP_MAX&&n.y>TREE_SCALE_SNAP_MIN&&(n.y=1)}function translateAxis(r,n){r.min=r.min+n,r.max=r.max+n}function transformAxis(r,n,a,c,d=.5){const R=mixNumber$1(r.min,r.max,d);applyAxisDelta(r,n,a,R,c)}function transformBox(r,n){transformAxis(r.x,n.x,n.scaleX,n.scale,n.originX),transformAxis(r.y,n.y,n.scaleY,n.scale,n.originY)}function measureViewportBox(r,n){return convertBoundingBoxToBox(transformBoxPoints(r.getBoundingClientRect(),n))}function measurePageBox(r,n,a){const c=measureViewportBox(r,a),{scroll:d}=n;return d&&(translateAxis(c.x,d.offset.x),translateAxis(c.y,d.offset.y)),c}const translateAlias={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},numTransforms=transformPropOrder.length;function buildTransform(r,n,a){let c="",d=!0;for(let R=0;R<numTransforms;R++){const u=transformPropOrder[R],v=r[u];if(v===void 0)continue;let m=!0;if(typeof v=="number"?m=v===(u.startsWith("scale")?1:0):m=parseFloat(v)===0,!m||a){const b=getValueAsType(v,numberValueTypes[u]);if(!m){d=!1;const T=translateAlias[u]||u;c+=`${T}(${b}) `}a&&(n[u]=b)}}return c=c.trim(),a?c=a(n,d?"":c):d&&(c="none"),c}function buildHTMLStyles(r,n,a){const{style:c,vars:d,transformOrigin:R}=r;let u=!1,v=!1;for(const m in n){const b=n[m];if(transformProps.has(m)){u=!0;continue}else if(isCSSVariableName(m)){d[m]=b;continue}else{const T=getValueAsType(b,numberValueTypes[m]);m.startsWith("origin")?(v=!0,R[m]=T):c[m]=T}}if(n.transform||(u||a?c.transform=buildTransform(n,r.transform,a):c.transform&&(c.transform="none")),v){const{originX:m="50%",originY:b="50%",originZ:T=0}=R;c.transformOrigin=`${m} ${b} ${T}`}}function renderHTML(r,{style:n,vars:a},c,d){const R=r.style;let u;for(u in n)R[u]=n[u];d?.applyProjectionStyles(R,c);for(u in a)R.setProperty(u,a[u])}function pixelsToPercent(r,n){return n.max===n.min?0:r/(n.max-n.min)*100}const correctBorderRadius={correct:(r,n)=>{if(!n.target)return r;if(typeof r=="string")if(px.test(r))r=parseFloat(r);else return r;const a=pixelsToPercent(r,n.target.x),c=pixelsToPercent(r,n.target.y);return`${a}% ${c}%`}},correctBoxShadow={correct:(r,{treeScale:n,projectionDelta:a})=>{const c=r,d=complex.parse(r);if(d.length>5)return c;const R=complex.createTransformer(r),u=typeof d[0]!="number"?1:0,v=a.x.scale*n.x,m=a.y.scale*n.y;d[0+u]/=v,d[1+u]/=m;const b=mixNumber$1(v,m,.5);return typeof d[2+u]=="number"&&(d[2+u]/=b),typeof d[3+u]=="number"&&(d[3+u]/=b),R(d)}},scaleCorrectors={borderRadius:{...correctBorderRadius,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:correctBorderRadius,borderTopRightRadius:correctBorderRadius,borderBottomLeftRadius:correctBorderRadius,borderBottomRightRadius:correctBorderRadius,boxShadow:correctBoxShadow};function isForcedMotionValue(r,{layout:n,layoutId:a}){return transformProps.has(r)||r.startsWith("origin")||(n||a!==void 0)&&(!!scaleCorrectors[r]||r==="opacity")}function scrapeMotionValuesFromProps$1(r,n,a){const c=r.style,d=n?.style,R={};if(!c)return R;for(const u in c)(isMotionValue(c[u])||d&&isMotionValue(d[u])||isForcedMotionValue(u,r)||a?.getValue(u)?.liveStyle!==void 0)&&(R[u]=c[u]);return R}function getComputedStyle$1(r){return window.getComputedStyle(r)}class HTMLVisualElement extends DOMVisualElement{constructor(){super(...arguments),this.type="html",this.renderInstance=renderHTML}readValueFromInstance(n,a){if(transformProps.has(a))return this.projection?.isProjecting?defaultTransformValue(a):readTransformValue(n,a);{const c=getComputedStyle$1(n),d=(isCSSVariableName(a)?c.getPropertyValue(a):c[a])||0;return typeof d=="string"?d.trim():d}}measureInstanceViewportBox(n,{transformPagePoint:a}){return measureViewportBox(n,a)}build(n,a,c){buildHTMLStyles(n,a,c.transformTemplate)}scrapeMotionValuesFromProps(n,a,c){return scrapeMotionValuesFromProps$1(n,a,c)}}const dashKeys={offset:"stroke-dashoffset",array:"stroke-dasharray"},camelKeys={offset:"strokeDashoffset",array:"strokeDasharray"};function buildSVGPath(r,n,a=1,c=0,d=!0){r.pathLength=1;const R=d?dashKeys:camelKeys;r[R.offset]=px.transform(-c);const u=px.transform(n),v=px.transform(a);r[R.array]=`${u} ${v}`}const cssMotionPathProperties=["offsetDistance","offsetPath","offsetRotate","offsetAnchor"];function buildSVGAttrs(r,{attrX:n,attrY:a,attrScale:c,pathLength:d,pathSpacing:R=1,pathOffset:u=0,...v},m,b,T){if(buildHTMLStyles(r,v,b),m){r.style.viewBox&&(r.attrs.viewBox=r.style.viewBox);return}r.attrs=r.style,r.style={};const{attrs:x,style:k}=r;x.transform&&(k.transform=x.transform,delete x.transform),(k.transform||x.transformOrigin)&&(k.transformOrigin=x.transformOrigin??"50% 50%",delete x.transformOrigin),k.transform&&(k.transformBox=T?.transformBox??"fill-box",delete x.transformBox);for(const F of cssMotionPathProperties)x[F]!==void 0&&(k[F]=x[F],delete x[F]);n!==void 0&&(x.x=n),a!==void 0&&(x.y=a),c!==void 0&&(x.scale=c),d!==void 0&&buildSVGPath(x,d,R,u,!1)}const camelCaseAttributes=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]),isSVGTag=r=>typeof r=="string"&&r.toLowerCase()==="svg";function renderSVG(r,n,a,c){renderHTML(r,n,void 0,c);for(const d in n.attrs)r.setAttribute(camelCaseAttributes.has(d)?d:camelToDash(d),n.attrs[d])}function scrapeMotionValuesFromProps(r,n,a){const c=scrapeMotionValuesFromProps$1(r,n,a);for(const d in r)if(isMotionValue(r[d])||isMotionValue(n[d])){const R=transformPropOrder.indexOf(d)!==-1?"attr"+d.charAt(0).toUpperCase()+d.substring(1):d;c[R]=r[d]}return c}class SVGVisualElement extends DOMVisualElement{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=createBox}getBaseTargetFromProps(n,a){return n[a]}readValueFromInstance(n,a){if(transformProps.has(a)){const c=getDefaultValueType(a);return c&&c.default||0}return a=camelCaseAttributes.has(a)?a:camelToDash(a),n.getAttribute(a)}scrapeMotionValuesFromProps(n,a,c){return scrapeMotionValuesFromProps(n,a,c)}build(n,a,c){buildSVGAttrs(n,a,this.isSVGTag,c.transformTemplate,c.style)}renderInstance(n,a,c,d){renderSVG(n,a,c,d)}mount(n){this.isSVGTag=isSVGTag(n.tagName),super.mount(n)}}const numVariantProps=variantProps.length;function getVariantContext(r){if(!r)return;if(!r.isControllingVariants){const a=r.parent?getVariantContext(r.parent)||{}:{};return r.props.initial!==void 0&&(a.initial=r.props.initial),a}const n={};for(let a=0;a<numVariantProps;a++){const c=variantProps[a],d=r.props[c];(isVariantLabel(d)||d===!1)&&(n[c]=d)}return n}function shallowCompare(r,n){if(!Array.isArray(n))return!1;const a=n.length;if(a!==r.length)return!1;for(let c=0;c<a;c++)if(n[c]!==r[c])return!1;return!0}const reversePriorityOrder=[...variantPriorityOrder].reverse(),numAnimationTypes=variantPriorityOrder.length;function createAnimateFunction(r){return n=>Promise.all(n.map(({animation:a,options:c})=>animateVisualElement(r,a,c)))}function createAnimationState(r){let n=createAnimateFunction(r),a=createState(),c=!0;const d=m=>(b,T)=>{const x=resolveVariant(r,T,m==="exit"?r.presenceContext?.custom:void 0);if(x){const{transition:k,transitionEnd:F,...C}=x;b={...b,...C,...F}}return b};function R(m){n=m(r)}function u(m){const{props:b}=r,T=getVariantContext(r.parent)||{},x=[],k=new Set;let F={},C=1/0;for(let Q=0;Q<numAnimationTypes;Q++){const J=reversePriorityOrder[Q],q=a[J],w=b[J]!==void 0?b[J]:T[J],N=isVariantLabel(w),V=J===m?q.isActive:null;V===!1&&(C=Q);let H=w===T[J]&&w!==b[J]&&N;if(H&&c&&r.manuallyAnimateOnMount&&(H=!1),q.protectedKeys={...F},!q.isActive&&V===null||!w&&!q.prevProp||isAnimationControls(w)||typeof w=="boolean")continue;const Y=checkVariantsDidChange(q.prevProp,w);let O=Y||J===m&&q.isActive&&!H&&N||Q>C&&N,ee=!1;const Ae=Array.isArray(w)?w:[w];let ce=Ae.reduce(d(J),{});V===!1&&(ce={});const{prevResolvedValues:ge={}}=q,me={...ge,...ce},Me=he=>{O=!0,k.has(he)&&(ee=!0,k.delete(he)),q.needsAnimating[he]=!0;const se=r.getValue(he);se&&(se.liveStyle=!1)};for(const he in me){const se=ce[he],K=ge[he];if(F.hasOwnProperty(he))continue;let Re=!1;isKeyframesTarget(se)&&isKeyframesTarget(K)?Re=!shallowCompare(se,K):Re=se!==K,Re?se!=null?Me(he):k.add(he):se!==void 0&&k.has(he)?Me(he):q.protectedKeys[he]=!0}q.prevProp=w,q.prevResolvedValues=ce,q.isActive&&(F={...F,...ce}),c&&r.blockInitialAnimation&&(O=!1);const ue=H&&Y;O&&(!ue||ee)&&x.push(...Ae.map(he=>{const se={type:J};if(typeof he=="string"&&c&&!ue&&r.manuallyAnimateOnMount&&r.parent){const{parent:K}=r,Re=resolveVariant(K,he);if(K.enteringChildren&&Re){const{delayChildren:fe}=Re.transition||{};se.delay=calcChildStagger(K.enteringChildren,r,fe)}}return{animation:he,options:se}}))}if(k.size){const Q={};if(typeof b.initial!="boolean"){const J=resolveVariant(r,Array.isArray(b.initial)?b.initial[0]:b.initial);J&&J.transition&&(Q.transition=J.transition)}k.forEach(J=>{const q=r.getBaseTarget(J),w=r.getValue(J);w&&(w.liveStyle=!0),Q[J]=q??null}),x.push({animation:Q})}let z=!!x.length;return c&&(b.initial===!1||b.initial===b.animate)&&!r.manuallyAnimateOnMount&&(z=!1),c=!1,z?n(x):Promise.resolve()}function v(m,b){if(a[m].isActive===b)return Promise.resolve();r.variantChildren?.forEach(x=>x.animationState?.setActive(m,b)),a[m].isActive=b;const T=u(m);for(const x in a)a[x].protectedKeys={};return T}return{animateChanges:u,setActive:v,setAnimateFunction:R,getState:()=>a,reset:()=>{a=createState()}}}function checkVariantsDidChange(r,n){return typeof n=="string"?n!==r:Array.isArray(n)?!shallowCompare(n,r):!1}function createTypeState(r=!1){return{isActive:r,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function createState(){return{animate:createTypeState(!0),whileInView:createTypeState(),whileHover:createTypeState(),whileTap:createTypeState(),whileDrag:createTypeState(),whileFocus:createTypeState(),exit:createTypeState()}}const SCALE_PRECISION=1e-4,SCALE_MIN=1-SCALE_PRECISION,SCALE_MAX=1+SCALE_PRECISION,TRANSLATE_PRECISION=.01,TRANSLATE_MIN=0-TRANSLATE_PRECISION,TRANSLATE_MAX=0+TRANSLATE_PRECISION;function calcLength(r){return r.max-r.min}function isNear(r,n,a){return Math.abs(r-n)<=a}function calcAxisDelta(r,n,a,c=.5){r.origin=c,r.originPoint=mixNumber$1(n.min,n.max,r.origin),r.scale=calcLength(a)/calcLength(n),r.translate=mixNumber$1(a.min,a.max,r.origin)-r.originPoint,(r.scale>=SCALE_MIN&&r.scale<=SCALE_MAX||isNaN(r.scale))&&(r.scale=1),(r.translate>=TRANSLATE_MIN&&r.translate<=TRANSLATE_MAX||isNaN(r.translate))&&(r.translate=0)}function calcBoxDelta(r,n,a,c){calcAxisDelta(r.x,n.x,a.x,c?c.originX:void 0),calcAxisDelta(r.y,n.y,a.y,c?c.originY:void 0)}function calcRelativeAxis(r,n,a){r.min=a.min+n.min,r.max=r.min+calcLength(n)}function calcRelativeBox(r,n,a){calcRelativeAxis(r.x,n.x,a.x),calcRelativeAxis(r.y,n.y,a.y)}function calcRelativeAxisPosition(r,n,a){r.min=n.min-a.min,r.max=r.min+calcLength(n)}function calcRelativePosition(r,n,a){calcRelativeAxisPosition(r.x,n.x,a.x),calcRelativeAxisPosition(r.y,n.y,a.y)}function removePointDelta(r,n,a,c,d){return r-=n,r=scalePoint(r,1/a,c),d!==void 0&&(r=scalePoint(r,1/d,c)),r}function removeAxisDelta(r,n=0,a=1,c=.5,d,R=r,u=r){if(percent.test(n)&&(n=parseFloat(n),n=mixNumber$1(u.min,u.max,n/100)-u.min),typeof n!="number")return;let v=mixNumber$1(R.min,R.max,c);r===R&&(v-=n),r.min=removePointDelta(r.min,n,a,v,d),r.max=removePointDelta(r.max,n,a,v,d)}function removeAxisTransforms(r,n,[a,c,d],R,u){removeAxisDelta(r,n[a],n[c],n[d],n.scale,R,u)}const xKeys=["x","scaleX","originX"],yKeys=["y","scaleY","originY"];function removeBoxTransforms(r,n,a,c){removeAxisTransforms(r.x,n,xKeys,a?a.x:void 0,c?c.x:void 0),removeAxisTransforms(r.y,n,yKeys,a?a.y:void 0,c?c.y:void 0)}function copyAxisInto(r,n){r.min=n.min,r.max=n.max}function copyBoxInto(r,n){copyAxisInto(r.x,n.x),copyAxisInto(r.y,n.y)}function copyAxisDeltaInto(r,n){r.translate=n.translate,r.scale=n.scale,r.originPoint=n.originPoint,r.origin=n.origin}function isAxisDeltaZero(r){return r.translate===0&&r.scale===1}function isDeltaZero(r){return isAxisDeltaZero(r.x)&&isAxisDeltaZero(r.y)}function axisEquals(r,n){return r.min===n.min&&r.max===n.max}function boxEquals(r,n){return axisEquals(r.x,n.x)&&axisEquals(r.y,n.y)}function axisEqualsRounded(r,n){return Math.round(r.min)===Math.round(n.min)&&Math.round(r.max)===Math.round(n.max)}function boxEqualsRounded(r,n){return axisEqualsRounded(r.x,n.x)&&axisEqualsRounded(r.y,n.y)}function aspectRatio(r){return calcLength(r.x)/calcLength(r.y)}function axisDeltaEquals(r,n){return r.translate===n.translate&&r.scale===n.scale&&r.originPoint===n.originPoint}function eachAxis(r){return[r("x"),r("y")]}function buildProjectionTransform(r,n,a){let c="";const d=r.x.translate/n.x,R=r.y.translate/n.y,u=a?.z||0;if((d||R||u)&&(c=`translate3d(${d}px, ${R}px, ${u}px) `),(n.x!==1||n.y!==1)&&(c+=`scale(${1/n.x}, ${1/n.y}) `),a){const{transformPerspective:b,rotate:T,rotateX:x,rotateY:k,skewX:F,skewY:C}=a;b&&(c=`perspective(${b}px) ${c}`),T&&(c+=`rotate(${T}deg) `),x&&(c+=`rotateX(${x}deg) `),k&&(c+=`rotateY(${k}deg) `),F&&(c+=`skewX(${F}deg) `),C&&(c+=`skewY(${C}deg) `)}const v=r.x.scale*n.x,m=r.y.scale*n.y;return(v!==1||m!==1)&&(c+=`scale(${v}, ${m})`),c||"none"}const borders=["TopLeft","TopRight","BottomLeft","BottomRight"],numBorders=borders.length,asNumber=r=>typeof r=="string"?parseFloat(r):r,isPx=r=>typeof r=="number"||px.test(r);function mixValues(r,n,a,c,d,R){d?(r.opacity=mixNumber$1(0,a.opacity??1,easeCrossfadeIn(c)),r.opacityExit=mixNumber$1(n.opacity??1,0,easeCrossfadeOut(c))):R&&(r.opacity=mixNumber$1(n.opacity??1,a.opacity??1,c));for(let u=0;u<numBorders;u++){const v=`border${borders[u]}Radius`;let m=getRadius(n,v),b=getRadius(a,v);if(m===void 0&&b===void 0)continue;m||(m=0),b||(b=0),m===0||b===0||isPx(m)===isPx(b)?(r[v]=Math.max(mixNumber$1(asNumber(m),asNumber(b),c),0),(percent.test(b)||percent.test(m))&&(r[v]+="%")):r[v]=b}(n.rotate||a.rotate)&&(r.rotate=mixNumber$1(n.rotate||0,a.rotate||0,c))}function getRadius(r,n){return r[n]!==void 0?r[n]:r.borderRadius}const easeCrossfadeIn=compress(0,.5,circOut),easeCrossfadeOut=compress(.5,.95,noop);function compress(r,n,a){return c=>c<r?0:c>n?1:a(progress(r,n,c))}function delay(r,n){const a=time.now(),c=({timestamp:d})=>{const R=d-a;R>=n&&(cancelFrame(c),r(R-n))};return frame.setup(c,!0),()=>cancelFrame(c)}function addDomEvent(r,n,a,c={passive:!0}){return r.addEventListener(n,a,c),()=>r.removeEventListener(n,a)}function resolveMotionValue(r){return isMotionValue(r)?r.get():r}function animateSingleValue(r,n,a){const c=isMotionValue(r)?r:motionValue(r);return c.start(animateMotionValue("",c,n,a)),c.animation}const compareByDepth=(r,n)=>r.depth-n.depth;class FlatTree{constructor(){this.children=[],this.isDirty=!1}add(n){addUniqueItem(this.children,n),this.isDirty=!0}remove(n){removeItem(this.children,n),this.isDirty=!0}forEach(n){this.isDirty&&this.children.sort(compareByDepth),this.isDirty=!1,this.children.forEach(n)}}class NodeStack{constructor(){this.members=[]}add(n){addUniqueItem(this.members,n),n.scheduleRender()}remove(n){if(removeItem(this.members,n),n===this.prevLead&&(this.prevLead=void 0),n===this.lead){const a=this.members[this.members.length-1];a&&this.promote(a)}}relegate(n){const a=this.members.findIndex(d=>n===d);if(a===0)return!1;let c;for(let d=a;d>=0;d--){const R=this.members[d];if(R.isPresent!==!1){c=R;break}}return c?(this.promote(c),!0):!1}promote(n,a){const c=this.lead;if(n!==c&&(this.prevLead=c,this.lead=n,n.show(),c)){c.instance&&c.scheduleRender(),n.scheduleRender(),n.resumeFrom=c,a&&(n.resumeFrom.preserveOpacity=!0),c.snapshot&&(n.snapshot=c.snapshot,n.snapshot.latestValues=c.animationValues||c.latestValues),n.root&&n.root.isUpdating&&(n.isLayoutDirty=!0);const{crossfade:d}=n.options;d===!1&&c.hide()}}exitAnimationComplete(){this.members.forEach(n=>{const{options:a,resumingFrom:c}=n;a.onExitComplete&&a.onExitComplete(),c&&c.options.onExitComplete&&c.options.onExitComplete()})}scheduleRender(){this.members.forEach(n=>{n.instance&&n.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}const globalProjectionState={hasAnimatedSinceResize:!0,hasEverUpdated:!1},transformAxes=["","X","Y","Z"],animationTarget=1e3;let id$1=0;function resetDistortingTransform(r,n,a,c){const{latestValues:d}=n;d[r]&&(a[r]=d[r],n.setStaticValue(r,0),c&&(c[r]=0))}function cancelTreeOptimisedTransformAnimations(r){if(r.hasCheckedOptimisedAppear=!0,r.root===r)return;const{visualElement:n}=r.options;if(!n)return;const a=getOptimisedAppearId(n);if(window.MotionHasOptimisedAnimation(a,"transform")){const{layout:d,layoutId:R}=r.options;window.MotionCancelOptimisedAnimation(a,"transform",frame,!(d||R))}const{parent:c}=r;c&&!c.hasCheckedOptimisedAppear&&cancelTreeOptimisedTransformAnimations(c)}function createProjectionNode$1({attachResizeListener:r,defaultParent:n,measureScroll:a,checkIsScrollRoot:c,resetTransform:d}){return class{constructor(u={},v=n?.()){this.id=id$1++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(propagateDirtyNodes),this.nodes.forEach(resolveTargetDelta),this.nodes.forEach(calcProjection),this.nodes.forEach(cleanDirtyNodes)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=u,this.root=v?v.root||v:this,this.path=v?[...v.path,v]:[],this.parent=v,this.depth=v?v.depth+1:0;for(let m=0;m<this.path.length;m++)this.path[m].shouldResetTransform=!0;this.root===this&&(this.nodes=new FlatTree)}addEventListener(u,v){return this.eventHandlers.has(u)||this.eventHandlers.set(u,new SubscriptionManager),this.eventHandlers.get(u).add(v)}notifyListeners(u,...v){const m=this.eventHandlers.get(u);m&&m.notify(...v)}hasListeners(u){return this.eventHandlers.has(u)}mount(u){if(this.instance)return;this.isSVG=isSVGElement(u)&&!isSVGSVGElement(u),this.instance=u;const{layoutId:v,layout:m,visualElement:b}=this.options;if(b&&!b.current&&b.mount(u),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(m||v)&&(this.isLayoutDirty=!0),r){let T,x=0;const k=()=>this.root.updateBlockedByResize=!1;frame.read(()=>{x=window.innerWidth}),r(u,()=>{const F=window.innerWidth;F!==x&&(x=F,this.root.updateBlockedByResize=!0,T&&T(),T=delay(k,250),globalProjectionState.hasAnimatedSinceResize&&(globalProjectionState.hasAnimatedSinceResize=!1,this.nodes.forEach(finishAnimation)))})}v&&this.root.registerSharedNode(v,this),this.options.animate!==!1&&b&&(v||m)&&this.addEventListener("didUpdate",({delta:T,hasLayoutChanged:x,hasRelativeLayoutChanged:k,layout:F})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const C=this.options.transition||b.getDefaultTransition()||defaultLayoutTransition,{onLayoutAnimationStart:z,onLayoutAnimationComplete:Q}=b.getProps(),J=!this.targetLayout||!boxEqualsRounded(this.targetLayout,F),q=!x&&k;if(this.options.layoutRoot||this.resumeFrom||q||x&&(J||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const w={...getValueTransition(C,"layout"),onPlay:z,onComplete:Q};(b.shouldReduceMotion||this.options.layoutRoot)&&(w.delay=0,w.type=!1),this.startAnimation(w),this.setAnimationOrigin(T,q)}else x||finishAnimation(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=F})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const u=this.getStack();u&&u.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),cancelFrame(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(resetSkewAndRotation),this.animationId++)}getTransformTemplate(){const{visualElement:u}=this.options;return u&&u.getProps().transformTemplate}willUpdate(u=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&cancelTreeOptimisedTransformAnimations(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let T=0;T<this.path.length;T++){const x=this.path[T];x.shouldResetTransform=!0,x.updateScroll("snapshot"),x.options.layoutRoot&&x.willUpdate(!1)}const{layoutId:v,layout:m}=this.options;if(v===void 0&&!m)return;const b=this.getTransformTemplate();this.prevTransformTemplateValue=b?b(this.latestValues,""):void 0,this.updateSnapshot(),u&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(clearMeasurements);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(clearIsLayoutDirty);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(resetTransformStyle),this.nodes.forEach(updateLayout),this.nodes.forEach(notifyLayoutUpdate)):this.nodes.forEach(clearIsLayoutDirty),this.clearAllSnapshots();const v=time.now();frameData.delta=clamp(0,1e3/60,v-frameData.timestamp),frameData.timestamp=v,frameData.isProcessing=!0,frameSteps.update.process(frameData),frameSteps.preRender.process(frameData),frameSteps.render.process(frameData),frameData.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,microtask.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(clearSnapshot),this.sharedNodes.forEach(removeLeadSnapshots)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,frame.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){frame.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!calcLength(this.snapshot.measuredBox.x)&&!calcLength(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let m=0;m<this.path.length;m++)this.path[m].updateScroll();const u=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=createBox(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:v}=this.options;v&&v.notify("LayoutMeasure",this.layout.layoutBox,u?u.layoutBox:void 0)}updateScroll(u="measure"){let v=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===u&&(v=!1),v&&this.instance){const m=c(this.instance);this.scroll={animationId:this.root.animationId,phase:u,isRoot:m,offset:a(this.instance),wasRoot:this.scroll?this.scroll.isRoot:m}}}resetTransform(){if(!d)return;const u=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,v=this.projectionDelta&&!isDeltaZero(this.projectionDelta),m=this.getTransformTemplate(),b=m?m(this.latestValues,""):void 0,T=b!==this.prevTransformTemplateValue;u&&this.instance&&(v||hasTransform(this.latestValues)||T)&&(d(this.instance,b),this.shouldResetTransform=!1,this.scheduleRender())}measure(u=!0){const v=this.measurePageBox();let m=this.removeElementScroll(v);return u&&(m=this.removeTransform(m)),roundBox(m),{animationId:this.root.animationId,measuredBox:v,layoutBox:m,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:u}=this.options;if(!u)return createBox();const v=u.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(checkNodeWasScrollRoot))){const{scroll:b}=this.root;b&&(translateAxis(v.x,b.offset.x),translateAxis(v.y,b.offset.y))}return v}removeElementScroll(u){const v=createBox();if(copyBoxInto(v,u),this.scroll?.wasRoot)return v;for(let m=0;m<this.path.length;m++){const b=this.path[m],{scroll:T,options:x}=b;b!==this.root&&T&&x.layoutScroll&&(T.wasRoot&&copyBoxInto(v,u),translateAxis(v.x,T.offset.x),translateAxis(v.y,T.offset.y))}return v}applyTransform(u,v=!1){const m=createBox();copyBoxInto(m,u);for(let b=0;b<this.path.length;b++){const T=this.path[b];!v&&T.options.layoutScroll&&T.scroll&&T!==T.root&&transformBox(m,{x:-T.scroll.offset.x,y:-T.scroll.offset.y}),hasTransform(T.latestValues)&&transformBox(m,T.latestValues)}return hasTransform(this.latestValues)&&transformBox(m,this.latestValues),m}removeTransform(u){const v=createBox();copyBoxInto(v,u);for(let m=0;m<this.path.length;m++){const b=this.path[m];if(!b.instance||!hasTransform(b.latestValues))continue;hasScale(b.latestValues)&&b.updateSnapshot();const T=createBox(),x=b.measurePageBox();copyBoxInto(T,x),removeBoxTransforms(v,b.latestValues,b.snapshot?b.snapshot.layoutBox:void 0,T)}return hasTransform(this.latestValues)&&removeBoxTransforms(v,this.latestValues),v}setTargetDelta(u){this.targetDelta=u,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(u){this.options={...this.options,...u,crossfade:u.crossfade!==void 0?u.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==frameData.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(u=!1){const v=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=v.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=v.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=v.isSharedProjectionDirty);const m=!!this.resumingFrom||this!==v;if(!(u||m&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:T,layoutId:x}=this.options;if(!this.layout||!(T||x))return;this.resolvedRelativeTargetAt=frameData.timestamp;const k=this.getClosestProjectingParent();k&&this.linkedParentVersion!==k.layoutVersion&&!k.options.layoutRoot&&this.removeRelativeTarget(),!this.targetDelta&&!this.relativeTarget&&(k&&k.layout?this.createRelativeTarget(k,this.layout.layoutBox,k.layout.layoutBox):this.removeRelativeTarget()),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=createBox(),this.targetWithTransforms=createBox()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),calcRelativeBox(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):copyBoxInto(this.target,this.layout.layoutBox),applyBoxDelta(this.target,this.targetDelta)):copyBoxInto(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,k&&!!k.resumingFrom==!!this.resumingFrom&&!k.options.layoutScroll&&k.target&&this.animationProgress!==1?this.createRelativeTarget(k,this.target,k.target):this.relativeParent=this.relativeTarget=void 0))}getClosestProjectingParent(){if(!(!this.parent||hasScale(this.parent.latestValues)||has2DTranslate(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(u,v,m){this.relativeParent=u,this.linkedParentVersion=u.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=createBox(),this.relativeTargetOrigin=createBox(),calcRelativePosition(this.relativeTargetOrigin,v,m),copyBoxInto(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){const u=this.getLead(),v=!!this.resumingFrom||this!==u;let m=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(m=!1),v&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(m=!1),this.resolvedRelativeTargetAt===frameData.timestamp&&(m=!1),m)return;const{layout:b,layoutId:T}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(b||T))return;copyBoxInto(this.layoutCorrected,this.layout.layoutBox);const x=this.treeScale.x,k=this.treeScale.y;applyTreeDeltas(this.layoutCorrected,this.treeScale,this.path,v),u.layout&&!u.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(u.target=u.layout.layoutBox,u.targetWithTransforms=createBox());const{target:F}=u;if(!F){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(copyAxisDeltaInto(this.prevProjectionDelta.x,this.projectionDelta.x),copyAxisDeltaInto(this.prevProjectionDelta.y,this.projectionDelta.y)),calcBoxDelta(this.projectionDelta,this.layoutCorrected,F,this.latestValues),(this.treeScale.x!==x||this.treeScale.y!==k||!axisDeltaEquals(this.projectionDelta.x,this.prevProjectionDelta.x)||!axisDeltaEquals(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",F))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(u=!0){if(this.options.visualElement?.scheduleRender(),u){const v=this.getStack();v&&v.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=createDelta(),this.projectionDelta=createDelta(),this.projectionDeltaWithTransform=createDelta()}setAnimationOrigin(u,v=!1){const m=this.snapshot,b=m?m.latestValues:{},T={...this.latestValues},x=createDelta();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!v;const k=createBox(),F=m?m.source:void 0,C=this.layout?this.layout.source:void 0,z=F!==C,Q=this.getStack(),J=!Q||Q.members.length<=1,q=!!(z&&!J&&this.options.crossfade===!0&&!this.path.some(hasOpacityCrossfade));this.animationProgress=0;let w;this.mixTargetDelta=N=>{const V=N/1e3;mixAxisDelta(x.x,u.x,V),mixAxisDelta(x.y,u.y,V),this.setTargetDelta(x),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(calcRelativePosition(k,this.layout.layoutBox,this.relativeParent.layout.layoutBox),mixBox(this.relativeTarget,this.relativeTargetOrigin,k,V),w&&boxEquals(this.relativeTarget,w)&&(this.isProjectionDirty=!1),w||(w=createBox()),copyBoxInto(w,this.relativeTarget)),z&&(this.animationValues=T,mixValues(T,b,this.latestValues,V,q,J)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=V},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(u){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(cancelFrame(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=frame.update(()=>{globalProjectionState.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=motionValue(0)),this.currentAnimation=animateSingleValue(this.motionValue,[0,1e3],{...u,velocity:0,isSync:!0,onUpdate:v=>{this.mixTargetDelta(v),u.onUpdate&&u.onUpdate(v)},onStop:()=>{},onComplete:()=>{u.onComplete&&u.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const u=this.getStack();u&&u.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(animationTarget),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const u=this.getLead();let{targetWithTransforms:v,target:m,layout:b,latestValues:T}=u;if(!(!v||!m||!b)){if(this!==u&&this.layout&&b&&shouldAnimatePositionOnly(this.options.animationType,this.layout.layoutBox,b.layoutBox)){m=this.target||createBox();const x=calcLength(this.layout.layoutBox.x);m.x.min=u.target.x.min,m.x.max=m.x.min+x;const k=calcLength(this.layout.layoutBox.y);m.y.min=u.target.y.min,m.y.max=m.y.min+k}copyBoxInto(v,m),transformBox(v,T),calcBoxDelta(this.projectionDeltaWithTransform,this.layoutCorrected,v,T)}}registerSharedNode(u,v){this.sharedNodes.has(u)||this.sharedNodes.set(u,new NodeStack),this.sharedNodes.get(u).add(v);const b=v.options.initialPromotionConfig;v.promote({transition:b?b.transition:void 0,preserveFollowOpacity:b&&b.shouldPreserveFollowOpacity?b.shouldPreserveFollowOpacity(v):void 0})}isLead(){const u=this.getStack();return u?u.lead===this:!0}getLead(){const{layoutId:u}=this.options;return u?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:u}=this.options;return u?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:u}=this.options;if(u)return this.root.sharedNodes.get(u)}promote({needsReset:u,transition:v,preserveFollowOpacity:m}={}){const b=this.getStack();b&&b.promote(this,m),u&&(this.projectionDelta=void 0,this.needsReset=!0),v&&this.setOptions({transition:v})}relegate(){const u=this.getStack();return u?u.relegate(this):!1}resetSkewAndRotation(){const{visualElement:u}=this.options;if(!u)return;let v=!1;const{latestValues:m}=u;if((m.z||m.rotate||m.rotateX||m.rotateY||m.rotateZ||m.skewX||m.skewY)&&(v=!0),!v)return;const b={};m.z&&resetDistortingTransform("z",u,b,this.animationValues);for(let T=0;T<transformAxes.length;T++)resetDistortingTransform(`rotate${transformAxes[T]}`,u,b,this.animationValues),resetDistortingTransform(`skew${transformAxes[T]}`,u,b,this.animationValues);u.render();for(const T in b)u.setStaticValue(T,b[T]),this.animationValues&&(this.animationValues[T]=b[T]);u.scheduleRender()}applyProjectionStyles(u,v){if(!this.instance||this.isSVG)return;if(!this.isVisible){u.visibility="hidden";return}const m=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,u.visibility="",u.opacity="",u.pointerEvents=resolveMotionValue(v?.pointerEvents)||"",u.transform=m?m(this.latestValues,""):"none";return}const b=this.getLead();if(!this.projectionDelta||!this.layout||!b.target){this.options.layoutId&&(u.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,u.pointerEvents=resolveMotionValue(v?.pointerEvents)||""),this.hasProjected&&!hasTransform(this.latestValues)&&(u.transform=m?m({},""):"none",this.hasProjected=!1);return}u.visibility="";const T=b.animationValues||b.latestValues;this.applyTransformsToTarget();let x=buildProjectionTransform(this.projectionDeltaWithTransform,this.treeScale,T);m&&(x=m(T,x)),u.transform=x;const{x:k,y:F}=this.projectionDelta;u.transformOrigin=`${k.origin*100}% ${F.origin*100}% 0`,b.animationValues?u.opacity=b===this?T.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:T.opacityExit:u.opacity=b===this?T.opacity!==void 0?T.opacity:"":T.opacityExit!==void 0?T.opacityExit:0;for(const C in scaleCorrectors){if(T[C]===void 0)continue;const{correct:z,applyTo:Q,isCSSVariable:J}=scaleCorrectors[C],q=x==="none"?T[C]:z(T[C],b);if(Q){const w=Q.length;for(let N=0;N<w;N++)u[Q[N]]=q}else J?this.options.visualElement.renderState.vars[C]=q:u[C]=q}this.options.layoutId&&(u.pointerEvents=b===this?resolveMotionValue(v?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(u=>u.currentAnimation?.stop()),this.root.nodes.forEach(clearMeasurements),this.root.sharedNodes.clear()}}}function updateLayout(r){r.updateLayout()}function notifyLayoutUpdate(r){const n=r.resumeFrom?.snapshot||r.snapshot;if(r.isLead()&&r.layout&&n&&r.hasListeners("didUpdate")){const{layoutBox:a,measuredBox:c}=r.layout,{animationType:d}=r.options,R=n.source!==r.layout.source;d==="size"?eachAxis(T=>{const x=R?n.measuredBox[T]:n.layoutBox[T],k=calcLength(x);x.min=a[T].min,x.max=x.min+k}):shouldAnimatePositionOnly(d,n.layoutBox,a)&&eachAxis(T=>{const x=R?n.measuredBox[T]:n.layoutBox[T],k=calcLength(a[T]);x.max=x.min+k,r.relativeTarget&&!r.currentAnimation&&(r.isProjectionDirty=!0,r.relativeTarget[T].max=r.relativeTarget[T].min+k)});const u=createDelta();calcBoxDelta(u,a,n.layoutBox);const v=createDelta();R?calcBoxDelta(v,r.applyTransform(c,!0),n.measuredBox):calcBoxDelta(v,a,n.layoutBox);const m=!isDeltaZero(u);let b=!1;if(!r.resumeFrom){const T=r.getClosestProjectingParent();if(T&&!T.resumeFrom){const{snapshot:x,layout:k}=T;if(x&&k){const F=createBox();calcRelativePosition(F,n.layoutBox,x.layoutBox);const C=createBox();calcRelativePosition(C,a,k.layoutBox),boxEqualsRounded(F,C)||(b=!0),T.options.layoutRoot&&(r.relativeTarget=C,r.relativeTargetOrigin=F,r.relativeParent=T)}}}r.notifyListeners("didUpdate",{layout:a,snapshot:n,delta:v,layoutDelta:u,hasLayoutChanged:m,hasRelativeLayoutChanged:b})}else if(r.isLead()){const{onExitComplete:a}=r.options;a&&a()}r.options.transition=void 0}function propagateDirtyNodes(r){r.parent&&(r.isProjecting()||(r.isProjectionDirty=r.parent.isProjectionDirty),r.isSharedProjectionDirty||(r.isSharedProjectionDirty=!!(r.isProjectionDirty||r.parent.isProjectionDirty||r.parent.isSharedProjectionDirty)),r.isTransformDirty||(r.isTransformDirty=r.parent.isTransformDirty))}function cleanDirtyNodes(r){r.isProjectionDirty=r.isSharedProjectionDirty=r.isTransformDirty=!1}function clearSnapshot(r){r.clearSnapshot()}function clearMeasurements(r){r.clearMeasurements()}function clearIsLayoutDirty(r){r.isLayoutDirty=!1}function resetTransformStyle(r){const{visualElement:n}=r.options;n&&n.getProps().onBeforeLayoutMeasure&&n.notify("BeforeLayoutMeasure"),r.resetTransform()}function finishAnimation(r){r.finishAnimation(),r.targetDelta=r.relativeTarget=r.target=void 0,r.isProjectionDirty=!0}function resolveTargetDelta(r){r.resolveTargetDelta()}function calcProjection(r){r.calcProjection()}function resetSkewAndRotation(r){r.resetSkewAndRotation()}function removeLeadSnapshots(r){r.removeLeadSnapshot()}function mixAxisDelta(r,n,a){r.translate=mixNumber$1(n.translate,0,a),r.scale=mixNumber$1(n.scale,1,a),r.origin=n.origin,r.originPoint=n.originPoint}function mixAxis(r,n,a,c){r.min=mixNumber$1(n.min,a.min,c),r.max=mixNumber$1(n.max,a.max,c)}function mixBox(r,n,a,c){mixAxis(r.x,n.x,a.x,c),mixAxis(r.y,n.y,a.y,c)}function hasOpacityCrossfade(r){return r.animationValues&&r.animationValues.opacityExit!==void 0}const defaultLayoutTransition={duration:.45,ease:[.4,0,.1,1]},userAgentContains=r=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(r),roundPoint=userAgentContains("applewebkit/")&&!userAgentContains("chrome/")?Math.round:noop;function roundAxis(r){r.min=roundPoint(r.min),r.max=roundPoint(r.max)}function roundBox(r){roundAxis(r.x),roundAxis(r.y)}function shouldAnimatePositionOnly(r,n,a){return r==="position"||r==="preserve-aspect"&&!isNear(aspectRatio(n),aspectRatio(a),.2)}function checkNodeWasScrollRoot(r){return r!==r.root&&r.scroll?.wasRoot}const DocumentProjectionNode=createProjectionNode$1({attachResizeListener:(r,n)=>addDomEvent(r,"resize",n),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),rootProjectionNode={current:void 0},HTMLProjectionNode=createProjectionNode$1({measureScroll:r=>({x:r.scrollLeft,y:r.scrollTop}),defaultParent:()=>{if(!rootProjectionNode.current){const r=new DocumentProjectionNode({});r.mount(window),r.setOptions({layoutScroll:!0}),rootProjectionNode.current=r}return rootProjectionNode.current},resetTransform:(r,n)=>{r.style.transform=n!==void 0?n:"none"},checkIsScrollRoot:r=>window.getComputedStyle(r).position==="fixed"}),MotionConfigContext=reactExports.createContext({transformPagePoint:r=>r,isStatic:!1,reducedMotion:"never"});function setRef(r,n){if(typeof r=="function")return r(n);r!=null&&(r.current=n)}function composeRefs(...r){return n=>{let a=!1;const c=r.map(d=>{const R=setRef(d,n);return!a&&typeof R=="function"&&(a=!0),R});if(a)return()=>{for(let d=0;d<c.length;d++){const R=c[d];typeof R=="function"?R():setRef(r[d],null)}}}}function useComposedRefs(...r){return reactExports.useCallback(composeRefs(...r),r)}class PopChildMeasure extends reactExports.Component{getSnapshotBeforeUpdate(n){const a=this.props.childRef.current;if(a&&n.isPresent&&!this.props.isPresent){const c=a.offsetParent,d=isHTMLElement(c)&&c.offsetWidth||0,R=this.props.sizeRef.current;R.height=a.offsetHeight||0,R.width=a.offsetWidth||0,R.top=a.offsetTop,R.left=a.offsetLeft,R.right=d-R.width-R.left}return null}componentDidUpdate(){}render(){return this.props.children}}function PopChild({children:r,isPresent:n,anchorX:a,root:c}){const d=reactExports.useId(),R=reactExports.useRef(null),u=reactExports.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:v}=reactExports.useContext(MotionConfigContext),m=r.props?.ref??r?.ref,b=useComposedRefs(R,m);return reactExports.useInsertionEffect(()=>{const{width:T,height:x,top:k,left:F,right:C}=u.current;if(n||!R.current||!T||!x)return;const z=a==="left"?`left: ${F}`:`right: ${C}`;R.current.dataset.motionPopId=d;const Q=document.createElement("style");v&&(Q.nonce=v);const J=c??document.head;return J.appendChild(Q),Q.sheet&&Q.sheet.insertRule(`
          [data-motion-pop-id="${d}"] {
            position: absolute !important;
            width: ${T}px !important;
            height: ${x}px !important;
            ${z}px !important;
            top: ${k}px !important;
          }
        `),()=>{J.contains(Q)&&J.removeChild(Q)}},[n]),jsxRuntimeExports.jsx(PopChildMeasure,{isPresent:n,childRef:R,sizeRef:u,children:reactExports.cloneElement(r,{ref:b})})}const PresenceChild=({children:r,initial:n,isPresent:a,onExitComplete:c,custom:d,presenceAffectsLayout:R,mode:u,anchorX:v,root:m})=>{const b=useConstant(newChildrenMap),T=reactExports.useId();let x=!0,k=reactExports.useMemo(()=>(x=!1,{id:T,initial:n,isPresent:a,custom:d,onExitComplete:F=>{b.set(F,!0);for(const C of b.values())if(!C)return;c&&c()},register:F=>(b.set(F,!1),()=>b.delete(F))}),[a,b,c]);return R&&x&&(k={...k}),reactExports.useMemo(()=>{b.forEach((F,C)=>b.set(C,!1))},[a]),reactExports.useEffect(()=>{!a&&!b.size&&c&&c()},[a]),u==="popLayout"&&(r=jsxRuntimeExports.jsx(PopChild,{isPresent:a,anchorX:v,root:m,children:r})),jsxRuntimeExports.jsx(PresenceContext.Provider,{value:k,children:r})};function newChildrenMap(){return new Map}function usePresence(r=!0){const n=reactExports.useContext(PresenceContext);if(n===null)return[!0,null];const{isPresent:a,onExitComplete:c,register:d}=n,R=reactExports.useId();reactExports.useEffect(()=>{if(r)return d(R)},[r]);const u=reactExports.useCallback(()=>r&&c&&c(R),[R,c,r]);return!a&&c?[!1,u]:[!0]}const getChildKey=r=>r.key||"";function onlyElements(r){const n=[];return reactExports.Children.forEach(r,a=>{reactExports.isValidElement(a)&&n.push(a)}),n}const AnimatePresence=({children:r,custom:n,initial:a=!0,onExitComplete:c,presenceAffectsLayout:d=!0,mode:R="sync",propagate:u=!1,anchorX:v="left",root:m})=>{const[b,T]=usePresence(u),x=reactExports.useMemo(()=>onlyElements(r),[r]),k=u&&!b?[]:x.map(getChildKey),F=reactExports.useRef(!0),C=reactExports.useRef(x),z=useConstant(()=>new Map),Q=reactExports.useRef(new Set),[J,q]=reactExports.useState(x),[w,N]=reactExports.useState(x);useIsomorphicLayoutEffect(()=>{F.current=!1,C.current=x;for(let Y=0;Y<w.length;Y++){const O=getChildKey(w[Y]);k.includes(O)?(z.delete(O),Q.current.delete(O)):z.get(O)!==!0&&z.set(O,!1)}},[w,k.length,k.join("-")]);const V=[];if(x!==J){let Y=[...x];for(let O=0;O<w.length;O++){const ee=w[O],Ae=getChildKey(ee);k.includes(Ae)||(Y.splice(O,0,ee),V.push(ee))}return R==="wait"&&V.length&&(Y=V),N(onlyElements(Y)),q(x),null}const{forceRender:H}=reactExports.useContext(LayoutGroupContext);return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:w.map(Y=>{const O=getChildKey(Y),ee=u&&!b?!1:x===w||k.includes(O),Ae=()=>{if(Q.current.has(O))return;if(Q.current.add(O),z.has(O))z.set(O,!0);else return;let ce=!0;z.forEach(ge=>{ge||(ce=!1)}),ce&&(H?.(),N(C.current),u&&T?.(),c&&c())};return jsxRuntimeExports.jsx(PresenceChild,{isPresent:ee,initial:!F.current||a?void 0:!1,custom:n,presenceAffectsLayout:d,mode:R,root:m,onExitComplete:ee?void 0:Ae,anchorX:v,children:Y},O)})})},LazyContext=reactExports.createContext({strict:!1}),featureProps={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]};let isInitialized=!1;function initFeatureDefinitions(){if(isInitialized)return;const r={};for(const n in featureProps)r[n]={isEnabled:a=>featureProps[n].some(c=>!!a[c])};setFeatureDefinitions(r),isInitialized=!0}function getInitializedFeatureDefinitions(){return initFeatureDefinitions(),getFeatureDefinitions()}function loadFeatures(r){const n=getInitializedFeatureDefinitions();for(const a in r)n[a]={...n[a],...r[a]};setFeatureDefinitions(n)}const validMotionProps=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function isValidMotionProp(r){return r.startsWith("while")||r.startsWith("drag")&&r!=="draggable"||r.startsWith("layout")||r.startsWith("onTap")||r.startsWith("onPan")||r.startsWith("onLayout")||validMotionProps.has(r)}let shouldForward=r=>!isValidMotionProp(r);function loadExternalIsValidProp(r){typeof r=="function"&&(shouldForward=n=>n.startsWith("on")?!isValidMotionProp(n):r(n))}try{loadExternalIsValidProp(require("@emotion/is-prop-valid").default)}catch{}function filterProps(r,n,a){const c={};for(const d in r)d==="values"&&typeof r.values=="object"||(shouldForward(d)||a===!0&&isValidMotionProp(d)||!n&&!isValidMotionProp(d)||r.draggable&&d.startsWith("onDrag"))&&(c[d]=r[d]);return c}const MotionContext=reactExports.createContext({});function getCurrentTreeVariants(r,n){if(isControllingVariants(r)){const{initial:a,animate:c}=r;return{initial:a===!1||isVariantLabel(a)?a:void 0,animate:isVariantLabel(c)?c:void 0}}return r.inherit!==!1?n:{}}function useCreateMotionContext(r){const{initial:n,animate:a}=getCurrentTreeVariants(r,reactExports.useContext(MotionContext));return reactExports.useMemo(()=>({initial:n,animate:a}),[variantLabelsAsDependency(n),variantLabelsAsDependency(a)])}function variantLabelsAsDependency(r){return Array.isArray(r)?r.join(" "):r}const createHtmlRenderState=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function copyRawValuesOnly(r,n,a){for(const c in n)!isMotionValue(n[c])&&!isForcedMotionValue(c,a)&&(r[c]=n[c])}function useInitialMotionValues({transformTemplate:r},n){return reactExports.useMemo(()=>{const a=createHtmlRenderState();return buildHTMLStyles(a,n,r),Object.assign({},a.vars,a.style)},[n])}function useStyle(r,n){const a=r.style||{},c={};return copyRawValuesOnly(c,a,r),Object.assign(c,useInitialMotionValues(r,n)),c}function useHTMLProps(r,n){const a={},c=useStyle(r,n);return r.drag&&r.dragListener!==!1&&(a.draggable=!1,c.userSelect=c.WebkitUserSelect=c.WebkitTouchCallout="none",c.touchAction=r.drag===!0?"none":`pan-${r.drag==="x"?"y":"x"}`),r.tabIndex===void 0&&(r.onTap||r.onTapStart||r.whileTap)&&(a.tabIndex=0),a.style=c,a}const createSvgRenderState=()=>({...createHtmlRenderState(),attrs:{}});function useSVGProps(r,n,a,c){const d=reactExports.useMemo(()=>{const R=createSvgRenderState();return buildSVGAttrs(R,n,isSVGTag(c),r.transformTemplate,r.style),{...R.attrs,style:{...R.style}}},[n]);if(r.style){const R={};copyRawValuesOnly(R,r.style,r),d.style={...R,...d.style}}return d}const lowercaseSVGElements=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function isSVGComponent(r){return typeof r!="string"||r.includes("-")?!1:!!(lowercaseSVGElements.indexOf(r)>-1||/[A-Z]/u.test(r))}function useRender(r,n,a,{latestValues:c},d,R=!1,u){const m=(u??isSVGComponent(r)?useSVGProps:useHTMLProps)(n,c,d,r),b=filterProps(n,typeof r=="string",R),T=r!==reactExports.Fragment?{...b,...m,ref:a}:{},{children:x}=n,k=reactExports.useMemo(()=>isMotionValue(x)?x.get():x,[x]);return reactExports.createElement(r,{...T,children:k})}function makeState({scrapeMotionValuesFromProps:r,createRenderState:n},a,c,d){return{latestValues:makeLatestValues(a,c,d,r),renderState:n()}}function makeLatestValues(r,n,a,c){const d={},R=c(r,{});for(const k in R)d[k]=resolveMotionValue(R[k]);let{initial:u,animate:v}=r;const m=isControllingVariants(r),b=isVariantNode(r);n&&b&&!m&&r.inherit!==!1&&(u===void 0&&(u=n.initial),v===void 0&&(v=n.animate));let T=a?a.initial===!1:!1;T=T||u===!1;const x=T?v:u;if(x&&typeof x!="boolean"&&!isAnimationControls(x)){const k=Array.isArray(x)?x:[x];for(let F=0;F<k.length;F++){const C=resolveVariantFromProps(r,k[F]);if(C){const{transitionEnd:z,transition:Q,...J}=C;for(const q in J){let w=J[q];if(Array.isArray(w)){const N=T?w.length-1:0;w=w[N]}w!==null&&(d[q]=w)}for(const q in z)d[q]=z[q]}}}return d}const makeUseVisualState=r=>(n,a)=>{const c=reactExports.useContext(MotionContext),d=reactExports.useContext(PresenceContext),R=()=>makeState(r,n,c,d);return a?R():useConstant(R)},useHTMLVisualState=makeUseVisualState({scrapeMotionValuesFromProps:scrapeMotionValuesFromProps$1,createRenderState:createHtmlRenderState}),useSVGVisualState=makeUseVisualState({scrapeMotionValuesFromProps,createRenderState:createSvgRenderState}),motionComponentSymbol=Symbol.for("motionComponentSymbol");function useMotionRef(r,n,a){const c=reactExports.useRef(a);reactExports.useInsertionEffect(()=>{c.current=a});const d=reactExports.useRef(null);return reactExports.useCallback(R=>{R&&r.onMount?.(R),n&&(R?n.mount(R):n.unmount());const u=c.current;if(typeof u=="function")if(R){const v=u(R);typeof v=="function"&&(d.current=v)}else d.current?(d.current(),d.current=null):u(R);else u&&(u.current=R)},[n])}const SwitchLayoutGroupContext=reactExports.createContext({});function isRefObject(r){return r&&typeof r=="object"&&Object.prototype.hasOwnProperty.call(r,"current")}function useVisualElement(r,n,a,c,d,R){const{visualElement:u}=reactExports.useContext(MotionContext),v=reactExports.useContext(LazyContext),m=reactExports.useContext(PresenceContext),b=reactExports.useContext(MotionConfigContext).reducedMotion,T=reactExports.useRef(null);c=c||v.renderer,!T.current&&c&&(T.current=c(r,{visualState:n,parent:u,props:a,presenceContext:m,blockInitialAnimation:m?m.initial===!1:!1,reducedMotionConfig:b,isSVG:R}));const x=T.current,k=reactExports.useContext(SwitchLayoutGroupContext);x&&!x.projection&&d&&(x.type==="html"||x.type==="svg")&&createProjectionNode(T.current,a,d,k);const F=reactExports.useRef(!1);reactExports.useInsertionEffect(()=>{x&&F.current&&x.update(a,m)});const C=a[optimizedAppearDataAttribute],z=reactExports.useRef(!!C&&!window.MotionHandoffIsComplete?.(C)&&window.MotionHasOptimisedAnimation?.(C));return useIsomorphicLayoutEffect(()=>{x&&(F.current=!0,window.MotionIsMounted=!0,x.updateFeatures(),x.scheduleRenderMicrotask(),z.current&&x.animationState&&x.animationState.animateChanges())}),reactExports.useEffect(()=>{x&&(!z.current&&x.animationState&&x.animationState.animateChanges(),z.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(C)}),z.current=!1),x.enteringChildren=void 0)}),x}function createProjectionNode(r,n,a,c){const{layoutId:d,layout:R,drag:u,dragConstraints:v,layoutScroll:m,layoutRoot:b,layoutCrossfade:T}=n;r.projection=new a(r.latestValues,n["data-framer-portal-id"]?void 0:getClosestProjectingNode(r.parent)),r.projection.setOptions({layoutId:d,layout:R,alwaysMeasureLayout:!!u||v&&isRefObject(v),visualElement:r,animationType:typeof R=="string"?R:"both",initialPromotionConfig:c,crossfade:T,layoutScroll:m,layoutRoot:b})}function getClosestProjectingNode(r){if(r)return r.options.allowProjection!==!1?r.projection:getClosestProjectingNode(r.parent)}function createMotionComponent(r,{forwardMotionProps:n=!1,type:a}={},c,d){c&&loadFeatures(c);const R=a?a==="svg":isSVGComponent(r),u=R?useSVGVisualState:useHTMLVisualState;function v(b,T){let x;const k={...reactExports.useContext(MotionConfigContext),...b,layoutId:useLayoutId(b)},{isStatic:F}=k,C=useCreateMotionContext(b),z=u(b,F);if(!F&&isBrowser$1){useStrictMode();const Q=getProjectionFunctionality(k);x=Q.MeasureLayout,C.visualElement=useVisualElement(r,z,k,d,Q.ProjectionNode,R)}return jsxRuntimeExports.jsxs(MotionContext.Provider,{value:C,children:[x&&C.visualElement?jsxRuntimeExports.jsx(x,{visualElement:C.visualElement,...k}):null,useRender(r,b,useMotionRef(z,C.visualElement,T),z,F,n,R)]})}v.displayName=`motion.${typeof r=="string"?r:`create(${r.displayName??r.name??""})`}`;const m=reactExports.forwardRef(v);return m[motionComponentSymbol]=r,m}function useLayoutId({layoutId:r}){const n=reactExports.useContext(LayoutGroupContext).id;return n&&r!==void 0?n+"-"+r:r}function useStrictMode(r,n){reactExports.useContext(LazyContext).strict}function getProjectionFunctionality(r){const n=getInitializedFeatureDefinitions(),{drag:a,layout:c}=n;if(!a&&!c)return{};const d={...a,...c};return{MeasureLayout:a?.isEnabled(r)||c?.isEnabled(r)?d.MeasureLayout:void 0,ProjectionNode:d.ProjectionNode}}function createMotionProxy(r,n){if(typeof Proxy>"u")return createMotionComponent;const a=new Map,c=(R,u)=>createMotionComponent(R,u,r,n),d=(R,u)=>c(R,u);return new Proxy(d,{get:(R,u)=>u==="create"?c:(a.has(u)||a.set(u,createMotionComponent(u,void 0,r,n)),a.get(u))})}const createDomVisualElement=(r,n)=>n.isSVG??isSVGComponent(r)?new SVGVisualElement(n):new HTMLVisualElement(n,{allowProjection:r!==reactExports.Fragment});class AnimationFeature extends Feature{constructor(n){super(n),n.animationState||(n.animationState=createAnimationState(n))}updateAnimationControlsSubscription(){const{animate:n}=this.node.getProps();isAnimationControls(n)&&(this.unmountControls=n.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:n}=this.node.getProps(),{animate:a}=this.node.prevProps||{};n!==a&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let id=0;class ExitAnimationFeature extends Feature{constructor(){super(...arguments),this.id=id++}update(){if(!this.node.presenceContext)return;const{isPresent:n,onExitComplete:a}=this.node.presenceContext,{isPresent:c}=this.node.prevPresenceContext||{};if(!this.node.animationState||n===c)return;const d=this.node.animationState.setActive("exit",!n);a&&!n&&d.then(()=>{a(this.id)})}mount(){const{register:n,onExitComplete:a}=this.node.presenceContext||{};a&&a(this.id),n&&(this.unmount=n(this.id))}unmount(){}}const animations={animation:{Feature:AnimationFeature},exit:{Feature:ExitAnimationFeature}};function extractEventInfo(r){return{point:{x:r.pageX,y:r.pageY}}}const addPointerInfo=r=>n=>isPrimaryPointer(n)&&r(n,extractEventInfo(n));function addPointerEvent(r,n,a,c){return addDomEvent(r,n,addPointerInfo(a),c)}const getContextWindow=({current:r})=>r?r.ownerDocument.defaultView:null,distance=(r,n)=>Math.abs(r-n);function distance2D(r,n){const a=distance(r.x,n.x),c=distance(r.y,n.y);return Math.sqrt(a**2+c**2)}const overflowStyles=new Set(["auto","scroll"]);class PanSession{constructor(n,a,{transformPagePoint:c,contextWindow:d=window,dragSnapToOrigin:R=!1,distanceThreshold:u=3,element:v}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.scrollPositions=new Map,this.removeScrollListeners=null,this.onElementScroll=F=>{this.handleScroll(F.target)},this.onWindowScroll=()=>{this.handleScroll(window)},this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const F=getPanInfo(this.lastMoveEventInfo,this.history),C=this.startEvent!==null,z=distance2D(F.offset,{x:0,y:0})>=this.distanceThreshold;if(!C&&!z)return;const{point:Q}=F,{timestamp:J}=frameData;this.history.push({...Q,timestamp:J});const{onStart:q,onMove:w}=this.handlers;C||(q&&q(this.lastMoveEvent,F),this.startEvent=this.lastMoveEvent),w&&w(this.lastMoveEvent,F)},this.handlePointerMove=(F,C)=>{this.lastMoveEvent=F,this.lastMoveEventInfo=transformPoint(C,this.transformPagePoint),frame.update(this.updatePoint,!0)},this.handlePointerUp=(F,C)=>{this.end();const{onEnd:z,onSessionEnd:Q,resumeAnimation:J}=this.handlers;if((this.dragSnapToOrigin||!this.startEvent)&&J&&J(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const q=getPanInfo(F.type==="pointercancel"?this.lastMoveEventInfo:transformPoint(C,this.transformPagePoint),this.history);this.startEvent&&z&&z(F,q),Q&&Q(F,q)},!isPrimaryPointer(n))return;this.dragSnapToOrigin=R,this.handlers=a,this.transformPagePoint=c,this.distanceThreshold=u,this.contextWindow=d||window;const m=extractEventInfo(n),b=transformPoint(m,this.transformPagePoint),{point:T}=b,{timestamp:x}=frameData;this.history=[{...T,timestamp:x}];const{onSessionStart:k}=a;k&&k(n,getPanInfo(b,this.history)),this.removeListeners=pipe(addPointerEvent(this.contextWindow,"pointermove",this.handlePointerMove),addPointerEvent(this.contextWindow,"pointerup",this.handlePointerUp),addPointerEvent(this.contextWindow,"pointercancel",this.handlePointerUp)),v&&this.startScrollTracking(v)}startScrollTracking(n){let a=n.parentElement;for(;a;){const c=getComputedStyle(a);(overflowStyles.has(c.overflowX)||overflowStyles.has(c.overflowY))&&this.scrollPositions.set(a,{x:a.scrollLeft,y:a.scrollTop}),a=a.parentElement}this.scrollPositions.set(window,{x:window.scrollX,y:window.scrollY}),window.addEventListener("scroll",this.onElementScroll,{capture:!0,passive:!0}),window.addEventListener("scroll",this.onWindowScroll,{passive:!0}),this.removeScrollListeners=()=>{window.removeEventListener("scroll",this.onElementScroll,{capture:!0}),window.removeEventListener("scroll",this.onWindowScroll)}}handleScroll(n){const a=this.scrollPositions.get(n);if(!a)return;const c=n===window,d=c?{x:window.scrollX,y:window.scrollY}:{x:n.scrollLeft,y:n.scrollTop},R={x:d.x-a.x,y:d.y-a.y};R.x===0&&R.y===0||(c?this.lastMoveEventInfo&&(this.lastMoveEventInfo.point.x+=R.x,this.lastMoveEventInfo.point.y+=R.y):this.history.length>0&&(this.history[0].x-=R.x,this.history[0].y-=R.y),this.scrollPositions.set(n,d),frame.update(this.updatePoint,!0))}updateHandlers(n){this.handlers=n}end(){this.removeListeners&&this.removeListeners(),this.removeScrollListeners&&this.removeScrollListeners(),this.scrollPositions.clear(),cancelFrame(this.updatePoint)}}function transformPoint(r,n){return n?{point:n(r.point)}:r}function subtractPoint(r,n){return{x:r.x-n.x,y:r.y-n.y}}function getPanInfo({point:r},n){return{point:r,delta:subtractPoint(r,lastDevicePoint(n)),offset:subtractPoint(r,startDevicePoint(n)),velocity:getVelocity(n,.1)}}function startDevicePoint(r){return r[0]}function lastDevicePoint(r){return r[r.length-1]}function getVelocity(r,n){if(r.length<2)return{x:0,y:0};let a=r.length-1,c=null;const d=lastDevicePoint(r);for(;a>=0&&(c=r[a],!(d.timestamp-c.timestamp>secondsToMilliseconds(n)));)a--;if(!c)return{x:0,y:0};const R=millisecondsToSeconds(d.timestamp-c.timestamp);if(R===0)return{x:0,y:0};const u={x:(d.x-c.x)/R,y:(d.y-c.y)/R};return u.x===1/0&&(u.x=0),u.y===1/0&&(u.y=0),u}function applyConstraints(r,{min:n,max:a},c){return n!==void 0&&r<n?r=c?mixNumber$1(n,r,c.min):Math.max(r,n):a!==void 0&&r>a&&(r=c?mixNumber$1(a,r,c.max):Math.min(r,a)),r}function calcRelativeAxisConstraints(r,n,a){return{min:n!==void 0?r.min+n:void 0,max:a!==void 0?r.max+a-(r.max-r.min):void 0}}function calcRelativeConstraints(r,{top:n,left:a,bottom:c,right:d}){return{x:calcRelativeAxisConstraints(r.x,a,d),y:calcRelativeAxisConstraints(r.y,n,c)}}function calcViewportAxisConstraints(r,n){let a=n.min-r.min,c=n.max-r.max;return n.max-n.min<r.max-r.min&&([a,c]=[c,a]),{min:a,max:c}}function calcViewportConstraints(r,n){return{x:calcViewportAxisConstraints(r.x,n.x),y:calcViewportAxisConstraints(r.y,n.y)}}function calcOrigin(r,n){let a=.5;const c=calcLength(r),d=calcLength(n);return d>c?a=progress(n.min,n.max-c,r.min):c>d&&(a=progress(r.min,r.max-d,n.min)),clamp(0,1,a)}function rebaseAxisConstraints(r,n){const a={};return n.min!==void 0&&(a.min=n.min-r.min),n.max!==void 0&&(a.max=n.max-r.min),a}const defaultElastic=.35;function resolveDragElastic(r=defaultElastic){return r===!1?r=0:r===!0&&(r=defaultElastic),{x:resolveAxisElastic(r,"left","right"),y:resolveAxisElastic(r,"top","bottom")}}function resolveAxisElastic(r,n,a){return{min:resolvePointElastic(r,n),max:resolvePointElastic(r,a)}}function resolvePointElastic(r,n){return typeof r=="number"?r:r[n]||0}const elementDragControls=new WeakMap;class VisualElementDragControls{constructor(n){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=createBox(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=n}start(n,{snapToCursor:a=!1,distanceThreshold:c}={}){const{presenceContext:d}=this.visualElement;if(d&&d.isPresent===!1)return;const R=x=>{a?(this.stopAnimation(),this.snapToCursor(extractEventInfo(x).point)):this.pauseAnimation()},u=(x,k)=>{this.stopAnimation();const{drag:F,dragPropagation:C,onDragStart:z}=this.getProps();if(F&&!C&&(this.openDragLock&&this.openDragLock(),this.openDragLock=setDragLock(F),!this.openDragLock))return;this.latestPointerEvent=x,this.latestPanInfo=k,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),eachAxis(J=>{let q=this.getAxisMotionValue(J).get()||0;if(percent.test(q)){const{projection:w}=this.visualElement;if(w&&w.layout){const N=w.layout.layoutBox[J];N&&(q=calcLength(N)*(parseFloat(q)/100))}}this.originPoint[J]=q}),z&&frame.postRender(()=>z(x,k)),addValueToWillChange(this.visualElement,"transform");const{animationState:Q}=this.visualElement;Q&&Q.setActive("whileDrag",!0)},v=(x,k)=>{this.latestPointerEvent=x,this.latestPanInfo=k;const{dragPropagation:F,dragDirectionLock:C,onDirectionLock:z,onDrag:Q}=this.getProps();if(!F&&!this.openDragLock)return;const{offset:J}=k;if(C&&this.currentDirection===null){this.currentDirection=getCurrentDirection(J),this.currentDirection!==null&&z&&z(this.currentDirection);return}this.updateAxis("x",k.point,J),this.updateAxis("y",k.point,J),this.visualElement.render(),Q&&Q(x,k)},m=(x,k)=>{this.latestPointerEvent=x,this.latestPanInfo=k,this.stop(x,k),this.latestPointerEvent=null,this.latestPanInfo=null},b=()=>eachAxis(x=>this.getAnimationState(x)==="paused"&&this.getAxisMotionValue(x).animation?.play()),{dragSnapToOrigin:T}=this.getProps();this.panSession=new PanSession(n,{onSessionStart:R,onStart:u,onMove:v,onSessionEnd:m,resumeAnimation:b},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:T,distanceThreshold:c,contextWindow:getContextWindow(this.visualElement),element:this.visualElement.current})}stop(n,a){const c=n||this.latestPointerEvent,d=a||this.latestPanInfo,R=this.isDragging;if(this.cancel(),!R||!d||!c)return;const{velocity:u}=d;this.startAnimation(u);const{onDragEnd:v}=this.getProps();v&&frame.postRender(()=>v(c,d))}cancel(){this.isDragging=!1;const{projection:n,animationState:a}=this.visualElement;n&&(n.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:c}=this.getProps();!c&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),a&&a.setActive("whileDrag",!1)}updateAxis(n,a,c){const{drag:d}=this.getProps();if(!c||!shouldDrag(n,d,this.currentDirection))return;const R=this.getAxisMotionValue(n);let u=this.originPoint[n]+c[n];this.constraints&&this.constraints[n]&&(u=applyConstraints(u,this.constraints[n],this.elastic[n])),R.set(u)}resolveConstraints(){const{dragConstraints:n,dragElastic:a}=this.getProps(),c=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,d=this.constraints;n&&isRefObject(n)?this.constraints||(this.constraints=this.resolveRefConstraints()):n&&c?this.constraints=calcRelativeConstraints(c.layoutBox,n):this.constraints=!1,this.elastic=resolveDragElastic(a),d!==this.constraints&&c&&this.constraints&&!this.hasMutatedConstraints&&eachAxis(R=>{this.constraints!==!1&&this.getAxisMotionValue(R)&&(this.constraints[R]=rebaseAxisConstraints(c.layoutBox[R],this.constraints[R]))})}resolveRefConstraints(){const{dragConstraints:n,onMeasureDragConstraints:a}=this.getProps();if(!n||!isRefObject(n))return!1;const c=n.current,{projection:d}=this.visualElement;if(!d||!d.layout)return!1;const R=measurePageBox(c,d.root,this.visualElement.getTransformPagePoint());let u=calcViewportConstraints(d.layout.layoutBox,R);if(a){const v=a(convertBoxToBoundingBox(u));this.hasMutatedConstraints=!!v,v&&(u=convertBoundingBoxToBox(v))}return u}startAnimation(n){const{drag:a,dragMomentum:c,dragElastic:d,dragTransition:R,dragSnapToOrigin:u,onDragTransitionEnd:v}=this.getProps(),m=this.constraints||{},b=eachAxis(T=>{if(!shouldDrag(T,a,this.currentDirection))return;let x=m&&m[T]||{};u&&(x={min:0,max:0});const k=d?200:1e6,F=d?40:1e7,C={type:"inertia",velocity:c?n[T]:0,bounceStiffness:k,bounceDamping:F,timeConstant:750,restDelta:1,restSpeed:10,...R,...x};return this.startAxisValueAnimation(T,C)});return Promise.all(b).then(v)}startAxisValueAnimation(n,a){const c=this.getAxisMotionValue(n);return addValueToWillChange(this.visualElement,n),c.start(animateMotionValue(n,c,0,a,this.visualElement,!1))}stopAnimation(){eachAxis(n=>this.getAxisMotionValue(n).stop())}pauseAnimation(){eachAxis(n=>this.getAxisMotionValue(n).animation?.pause())}getAnimationState(n){return this.getAxisMotionValue(n).animation?.state}getAxisMotionValue(n){const a=`_drag${n.toUpperCase()}`,c=this.visualElement.getProps(),d=c[a];return d||this.visualElement.getValue(n,(c.initial?c.initial[n]:void 0)||0)}snapToCursor(n){eachAxis(a=>{const{drag:c}=this.getProps();if(!shouldDrag(a,c,this.currentDirection))return;const{projection:d}=this.visualElement,R=this.getAxisMotionValue(a);if(d&&d.layout){const{min:u,max:v}=d.layout.layoutBox[a],m=R.get()||0;R.set(n[a]-mixNumber$1(u,v,.5)+m)}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:n,dragConstraints:a}=this.getProps(),{projection:c}=this.visualElement;if(!isRefObject(a)||!c||!this.constraints)return;this.stopAnimation();const d={x:0,y:0};eachAxis(u=>{const v=this.getAxisMotionValue(u);if(v&&this.constraints!==!1){const m=v.get();d[u]=calcOrigin({min:m,max:m},this.constraints[u])}});const{transformTemplate:R}=this.visualElement.getProps();this.visualElement.current.style.transform=R?R({},""):"none",c.root&&c.root.updateScroll(),c.updateLayout(),this.resolveConstraints(),eachAxis(u=>{if(!shouldDrag(u,n,null))return;const v=this.getAxisMotionValue(u),{min:m,max:b}=this.constraints[u];v.set(mixNumber$1(m,b,d[u]))})}addListeners(){if(!this.visualElement.current)return;elementDragControls.set(this.visualElement,this);const n=this.visualElement.current,a=addPointerEvent(n,"pointerdown",m=>{const{drag:b,dragListener:T=!0}=this.getProps();b&&T&&!isElementKeyboardAccessible(m.target)&&this.start(m)}),c=()=>{const{dragConstraints:m}=this.getProps();isRefObject(m)&&m.current&&(this.constraints=this.resolveRefConstraints())},{projection:d}=this.visualElement,R=d.addEventListener("measure",c);d&&!d.layout&&(d.root&&d.root.updateScroll(),d.updateLayout()),frame.read(c);const u=addDomEvent(window,"resize",()=>this.scalePositionWithinConstraints()),v=d.addEventListener("didUpdate",(({delta:m,hasLayoutChanged:b})=>{this.isDragging&&b&&(eachAxis(T=>{const x=this.getAxisMotionValue(T);x&&(this.originPoint[T]+=m[T].translate,x.set(x.get()+m[T].translate))}),this.visualElement.render())}));return()=>{u(),a(),R(),v&&v()}}getProps(){const n=this.visualElement.getProps(),{drag:a=!1,dragDirectionLock:c=!1,dragPropagation:d=!1,dragConstraints:R=!1,dragElastic:u=defaultElastic,dragMomentum:v=!0}=n;return{...n,drag:a,dragDirectionLock:c,dragPropagation:d,dragConstraints:R,dragElastic:u,dragMomentum:v}}}function shouldDrag(r,n,a){return(n===!0||n===r)&&(a===null||a===r)}function getCurrentDirection(r,n=10){let a=null;return Math.abs(r.y)>n?a="y":Math.abs(r.x)>n&&(a="x"),a}class DragGesture extends Feature{constructor(n){super(n),this.removeGroupControls=noop,this.removeListeners=noop,this.controls=new VisualElementDragControls(n)}mount(){const{dragControls:n}=this.node.getProps();n&&(this.removeGroupControls=n.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||noop}update(){const{dragControls:n}=this.node.getProps(),{dragControls:a}=this.node.prevProps||{};n!==a&&(this.removeGroupControls(),n&&(this.removeGroupControls=n.subscribe(this.controls)))}unmount(){this.removeGroupControls(),this.removeListeners()}}const asyncHandler=r=>(n,a)=>{r&&frame.postRender(()=>r(n,a))};class PanGesture extends Feature{constructor(){super(...arguments),this.removePointerDownListener=noop}onPointerDown(n){this.session=new PanSession(n,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:getContextWindow(this.node)})}createPanHandlers(){const{onPanSessionStart:n,onPanStart:a,onPan:c,onPanEnd:d}=this.node.getProps();return{onSessionStart:asyncHandler(n),onStart:asyncHandler(a),onMove:c,onEnd:(R,u)=>{delete this.session,d&&frame.postRender(()=>d(R,u))}}}mount(){this.removePointerDownListener=addPointerEvent(this.node.current,"pointerdown",n=>this.onPointerDown(n))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}let hasTakenAnySnapshot=!1;class MeasureLayoutWithContext extends reactExports.Component{componentDidMount(){const{visualElement:n,layoutGroup:a,switchLayoutGroup:c,layoutId:d}=this.props,{projection:R}=n;R&&(a.group&&a.group.add(R),c&&c.register&&d&&c.register(R),hasTakenAnySnapshot&&R.root.didUpdate(),R.addEventListener("animationComplete",()=>{this.safeToRemove()}),R.setOptions({...R.options,onExitComplete:()=>this.safeToRemove()})),globalProjectionState.hasEverUpdated=!0}getSnapshotBeforeUpdate(n){const{layoutDependency:a,visualElement:c,drag:d,isPresent:R}=this.props,{projection:u}=c;return u&&(u.isPresent=R,hasTakenAnySnapshot=!0,d||n.layoutDependency!==a||a===void 0||n.isPresent!==R?u.willUpdate():this.safeToRemove(),n.isPresent!==R&&(R?u.promote():u.relegate()||frame.postRender(()=>{const v=u.getStack();(!v||!v.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:n}=this.props.visualElement;n&&(n.root.didUpdate(),microtask.postRender(()=>{!n.currentAnimation&&n.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:n,layoutGroup:a,switchLayoutGroup:c}=this.props,{projection:d}=n;hasTakenAnySnapshot=!0,d&&(d.scheduleCheckAfterUnmount(),a&&a.group&&a.group.remove(d),c&&c.deregister&&c.deregister(d))}safeToRemove(){const{safeToRemove:n}=this.props;n&&n()}render(){return null}}function MeasureLayout(r){const[n,a]=usePresence(),c=reactExports.useContext(LayoutGroupContext);return jsxRuntimeExports.jsx(MeasureLayoutWithContext,{...r,layoutGroup:c,switchLayoutGroup:reactExports.useContext(SwitchLayoutGroupContext),isPresent:n,safeToRemove:a})}const drag={pan:{Feature:PanGesture},drag:{Feature:DragGesture,ProjectionNode:HTMLProjectionNode,MeasureLayout}};function handleHoverEvent(r,n,a){const{props:c}=r;r.animationState&&c.whileHover&&r.animationState.setActive("whileHover",a==="Start");const d="onHover"+a,R=c[d];R&&frame.postRender(()=>R(n,extractEventInfo(n)))}class HoverGesture extends Feature{mount(){const{current:n}=this.node;n&&(this.unmount=hover(n,(a,c)=>(handleHoverEvent(this.node,c,"Start"),d=>handleHoverEvent(this.node,d,"End"))))}unmount(){}}class FocusGesture extends Feature{constructor(){super(...arguments),this.isActive=!1}onFocus(){let n=!1;try{n=this.node.current.matches(":focus-visible")}catch{n=!0}!n||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=pipe(addDomEvent(this.node.current,"focus",()=>this.onFocus()),addDomEvent(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function handlePressEvent(r,n,a){const{props:c}=r;if(r.current instanceof HTMLButtonElement&&r.current.disabled)return;r.animationState&&c.whileTap&&r.animationState.setActive("whileTap",a==="Start");const d="onTap"+(a==="End"?"":a),R=c[d];R&&frame.postRender(()=>R(n,extractEventInfo(n)))}class PressGesture extends Feature{mount(){const{current:n}=this.node;n&&(this.unmount=press(n,(a,c)=>(handlePressEvent(this.node,c,"Start"),(d,{success:R})=>handlePressEvent(this.node,d,R?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const observerCallbacks=new WeakMap,observers=new WeakMap,fireObserverCallback=r=>{const n=observerCallbacks.get(r.target);n&&n(r)},fireAllObserverCallbacks=r=>{r.forEach(fireObserverCallback)};function initIntersectionObserver({root:r,...n}){const a=r||document;observers.has(a)||observers.set(a,{});const c=observers.get(a),d=JSON.stringify(n);return c[d]||(c[d]=new IntersectionObserver(fireAllObserverCallbacks,{root:r,...n})),c[d]}function observeIntersection(r,n,a){const c=initIntersectionObserver(n);return observerCallbacks.set(r,a),c.observe(r),()=>{observerCallbacks.delete(r),c.unobserve(r)}}const thresholdNames={some:0,all:1};class InViewFeature extends Feature{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:n={}}=this.node.getProps(),{root:a,margin:c,amount:d="some",once:R}=n,u={root:a?a.current:void 0,rootMargin:c,threshold:typeof d=="number"?d:thresholdNames[d]},v=m=>{const{isIntersecting:b}=m;if(this.isInView===b||(this.isInView=b,R&&!b&&this.hasEnteredView))return;b&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",b);const{onViewportEnter:T,onViewportLeave:x}=this.node.getProps(),k=b?T:x;k&&k(m)};return observeIntersection(this.node.current,u,v)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:n,prevProps:a}=this.node;["amount","margin","root"].some(hasViewportOptionChanged(n,a))&&this.startObserver()}unmount(){}}function hasViewportOptionChanged({viewport:r={}},{viewport:n={}}={}){return a=>r[a]!==n[a]}const gestureAnimations={inView:{Feature:InViewFeature},tap:{Feature:PressGesture},focus:{Feature:FocusGesture},hover:{Feature:HoverGesture}},layout={layout:{ProjectionNode:HTMLProjectionNode,MeasureLayout}},featureBundle={...animations,...gestureAnimations,...drag,...layout},motion=createMotionProxy(featureBundle,createDomVisualElement);function OptimadeNoResults({queryUrl:r,currentFilter:n}){const a=`${r}/structures?filter=${encodeURIComponent(n)}`,c=`${r}/structures?filter=${decodeURIComponent(n)}`;return jsxRuntimeExports.jsxs("div",{className:`${warningContainerStyle} ${textSmall}`,children:[jsxRuntimeExports.jsx("strong",{className:"font-semibold",children:"Warning: "}),"No results returned for this query. Try to relax the filters.",jsxRuntimeExports.jsxs("p",{className:"pt-2",children:["Attempted Query:"," ",jsxRuntimeExports.jsx("a",{href:a,target:"_blank",rel:"noopener noreferrer",className:`${textHyperlink} break-all`,children:c})]})]})}var dist={},Navbar={};const mcloud_logo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGIAAABPCAYAAAAQlxDmAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH4QgeDQk2h9q0aQAADmpJREFUeNrtXXuYU9W1/61zkgzDc2ByMuM45GR4fDyGZHiM16uFXm2V6idWKWpLa6Gg9oHaa1Xwtra0Kn0/KKKoxVKxLVKq9T7Ui9ZPvNZXZQAzmaBYYJLMMDBJEMSBYSY5Z90/Mthz9jxIhuRMBrP+y87JPnvt317PvfYOUKACFahABSpQz0SDefDbAFupe9SIU5/ldkeiOhZrKwCRQwpWw5FsK50tMc1hovMATAagArAJjx4mpn0gfQcTvZXU+IWZTfGWAhBnSIGxzlqWaBmAawCM6EcXDEIdM/8mkXBsqm1pOVEAIu2ZAwVU50IQ3QbGeVns+igYj9mIfzY1HD9YAKIP8o8tm0ayvg6MOWmy0Anw8S4Vla7EfECM770Tia27DtAKQBiobhbsjphyLwh3ALD38ti7BLykE79qk7TX2k8Wx42qhgFpd+XIkiQVVUPCJwmYDeAiAEN66W8HSbTU2xitLwABoK6iwumwJ/7cNWkitRGwWSfp0ZpQ698zNvKVI8foUtH1TLgJwLQeHjlOoEXecPQvH2sgGsaWnqdL0tMAzhW+0pjwoI7E92eEjh7NitpzO68kojUAqrrZJcL9vlDsWwToHzsggu4xUzWSXwUwWvhqD4GWesPR17P9zncnOUd0nqQfAri1+2Twz73h+IqPFRDBcaPdmmZ7A0CF8NWT8gksyXVgFnA75zHRHwCMEmTjDl84/quPBRBBRRmuDcXLAGYJDv8vfeHoCqvUw9uqMkMCngegmFQi8/yaSPx/rJwTaSCA0IrxQE8g1ISjd1qpo6eHY7tYlz4F0PuGZpmIngiMdY0/q4EIVLnmgrBIkMstvnB0QHRzTVNrA0j/HIAOQ/MwlviBsxaIf0yYUMQ6PySoxD2dnfYlA+WtAIAvFP8/ZtwlNF/mdyvXnJVAnEgeWwpgnFFLEWhpPuR/fJHYWjBeMQkqYdUWQD6rgKibBTtYv0vw3R/MhYvaT69Fl3XcACBpaJ40xWONVFgGhD2mXEUg1dDULhH9CHlE1c2xvQQ8ZlosjNvOLtVEWGxmkDd6G6OtyDPSZP45zInA8+s9pZPPCiACqms+AfNMQMj8O+QhTd8ffw/gOnPATWuD1XAMWiCCHqXcr7p+wcDmbi/WZTkfgWCAQDRUEOdLtDblLb9HuWzQRdZ+1XkjgdaitxQ0owng+b5IfEe+gFA3C3ZHXHkEwJI+HnvWnnQsnnLgwOG8lwi/R1lMoPXofR8AIIwF0StvV5X+S74A4Tis/PE0IADAFQlb5zN1s3rdM8kPIOrdo0YTo6eo9CSAhNA2VNKlhzkP0vEB1TUfjGt7+OrDHtr+1R53ZdWbouwDodwFwk8MTUdZ58V7muLPVldD1tqUmwCsgSFQIuYfMOTXBgwFCcOYtTVG95qB1ySdFnubovuCHqVcY34IoKsNv2odQcM8VaHQybwDom7c6FEOzbYbxtQ289d8kfhvTGCpyloAtyB/6YRMGF8dih36iLeKiqEOW+JdEMYaY4yaSGxN3qimf0yYUFSvKrc4NNvbEPYXNMn2Qjf0mZ9HflO9EQQAqG1pOQEiMQWyut6j/Cmglk4ZUCC2AHK9qtzcnvhgH4C1ADziMzLr54htOqE8z4HobXzndNMojOsYUkO96tp0JqnzfqumYKUyQZOxEcCFp3HMX+hUYvNqd6QM9S5PSYnM9u0AJghPHgawB2ArE4CUmnSa2m0umL/qi8TXf2TMq1xzWeetp5mz40y03BeKPkwA5xwIv8e5kJjWAxiWrqgD+G8QO8D0RQCVwjBWy8Oj/1EdROeA6CG3cxaIngVQZo7t8BQDbxNjIghfQvfyzt5oa7Fd+/zEve8fyxkQ9W7nTSB6uAe19iEBaxm8G6DbANSm2eV+bzg2cSD3IwwB6Po0H08Q8w9ZojAxbuBU/ZRIO9kmXV6zrzWadRvhV13LQPRI99/RE0mdJ3vDsbt94fgfNUpcCkIgzZTC7oEGIbUipWDaIIA+743E7/GFYo95w7E5BFoAoFl4biYl9Vd2TihXsgpEwO26lMD3C1LUDsJSXzj6RWPF9YzQ0aPFNm02A7/tIYgTRXIaD9DeuWB1p6ajEHRJn+0NR582NnrD0b+QRLXixhKASXJC+9O2NFQapaeOysaBeDvAY8wRJ33GF46+0acUjS9zIaF/koDxXW/8NwCXC2JxnS8S+/NAgcCAVK8qOwiYbmhuIcIDrEMHiEH42+l4TeWqnFuEwO+jwogzB0J1/hWgS0ySIOEyX2PslX4y/SIBF/+zjcOJhGPqQG2ZBjyurzPzQ8ZhSkxzpkWiGUf7wWo4tDblP4XFxkzSBX2VjJ5WJfhV1wIBBBBwS39A6PqtbtPw1a7cU1cbqUX2zh8MBAg7xzormPmn5kHS+v6AAADVQXTKJ3BdyhU39Mj6Q32pYOl0AZvE/GPBv/4vbzi24UyYr26O7QVhjSC+3/RXOSdZDYRNovsAjDQ0HWGZvndG/MVibUzSV2B2QmY09FEV0icQU9zOy5kw0dDUYZPt/56NCWhLFt0DYL+hqYiY1luZiW1QnRcDWGpeELwiXZezL6oJtb4JYKOpb+p9/7tPIHSiJWZh4N9NbTwYzsYkXNjc3E6g5YIBmROwqJZoG2DTQauF5h17wvGsbeEypPtgrgq5oLf9716B2OUpKSHgSlPeSJYezuZkdJ1J2CoYkV8FFWV4roFwupVlAGqM606X9GXZPEFUE25tZIE/1qVFGQFhY9snYD6545/WGPVne0JkDbcaDTeASn0or8wlCEGPUs6EewUD/ej0xsNv5cA33mh+TY+HcXoHgonmCB3+by4mpbo5thfgHwmG+/agR5meKyC01MaUsRz/YLEtuTwX7yoq5udhlrLauoqKoenbCOZaM5K0PVcT06YN+YVguGWNsToXhjvgcV4kbokyeGUmCbpMaPKe+IcA3jM02e0OzZeBsaYy0yqS9YZcAXFhc3M7MYve2EUB1bkwm++pmwU7p/bTjQC/6QvHNyCXRGgQYqmyTLymUpOIdRQdzuVYvZH4MwQ8JXCwut49anS23mGPK8sBqjYm8HSWb8x10pEYMfNn3ZkJECUmkT5w4ChyTEmS7wRgTHO4AEdWDLf/3DGVBHxbaH5keuRQELknYe64JBMgjAc3UFlZ6cj1aGeEDoXAdI8g1t/MRu0T2aS1AIxu8QHHEP6OFTGLDioSnJGODIy1uZ5nCJ0cbcWgix0j1wjGTZJ16ZdnYrgDVa653TKiTN/pMqQ5JzJnrcFMx9IHQkLI5O9LPNmKQU/cu7eDddwIw54vA7MDbueN/emv0eMZwjqvE6bmpZpI9HELU1qTBI+0Mf04gk2rEhLkmVaNuqYp9jeIhptoVX8M9zE+fgdO7YV0mSJodJtVvHSVZprcVclG76UNhAS8ISBziYUrCJzUvgXAeNbaReRYlUkfuzzlHgIEO0Brfc2tAav4cLyvXCDYpsaezoX0IRHSNnOkjU8HqlxllknFgfebGXSv2Wzha37VmbZkytDXADBGsS2OIfr3rVxQpPMXBB5eyijF4Yu07gewy5h+0nW+wUomEs7orwHabZxbAtals8cdcDvngfmz5sXEd1hloIHUdRMMWigEc09lBETXwB8XOrm1pzxJrqh2BxJE+s0wFWvR+QG3s88F8XplZTGnLj8xG+hQfLOVC6mzXfqGEI8dOhyO/TVjIIba9A0Ajhiayh2OTktF2xuKvwzQJsFw/9g/vszV229GyB3fhekYMXUSNEuLnv3njqkE8d1CSPDri837E+kBkUqE8WpBTG5vcLs+YSVTNujLARh971Ipqa/rcQI8ZeczsELIMaz2hg+/Y5mjAUhklzfAvAUbldvxYB/OUd/UlRltNNkKwqadY50VVjE2NRw/yIyVArML/KpydzcvifUnYawjYjRxu3SflQun3uNaCcalQlR3V1837qQVrQbcrkuZeKsJOEIgaZM/PXPvoZgVzG0DbKUeZScYXoGFTSRhI2u6B6lz26VCOuGamnD0KctAUJWbAfHEFL/oDcfn9lWYnHbaIKAqqxi4W2jeq8t8RepIrAV6V3UtIPCTmcRTvnDsPKvUUYOq3NvDHB0kiWac7kx52qWO08KxldT9mO4ESaPtfo/zC5bYCu3ktsyceH7JinEFPUp5QFWe6QGEYwyel87B/rSBIECXhscWA3ha+GokMT1RryrP1ruds3LJsE5DMkxxSCU5BUBRhterzts1xjsQy0iBDyDhyppwfGea85sZbQHkKapyPwPLeunwVZ3wqGaTn8um/Xi9srJ4mNyxRbzBAKlc/+tInbkQtyBPSExz+1u11xv/kzxltcT6lwB8WYgTTlGzJNG8TIot+p9adruuZ+J16P3SWwbwLoAgg0NE1P8yFcYwMK4yHiTsopc7E/Zra1ta4inX1bmQmP4gSHqSga0S+B0m0s9AHEtAPAnATMEtFem5zoR98akx5RwIoOuCxKR8P4iuwgCQRnLVjNChkNmgOx8n0JcHYDgxZrrTF4n+PtNjWxnZiJ6oev+RiC8Sv1pims3AM7D2wMkxEYQUQ5LVtxq3MGiFYwiPr4lEH+8PCGcsESLtrjpHTeqJRQCuAKgWOb79qyeJqFedvwfo+hxPfitALxLrm+OR+Nbe0hYDBoTJgR83elRRQp7IRFUskZN0HtlvE0GkADyJgMtgPn3zcqecvLp2/5EPAKDerVwLwmZB0g8y8ByBw2Dq32FJiTsBOgpdaiLmxmlN0f39XfmWA5Gb1IGyBIwN3VYn85sgUgBcYOKJsJ3bpYtrWluP5ztvg+6vbQKq8iQDC9J4tE3WMCNV0pn/JA02IDoS9kXEON0VEkfA0vzBAsKglIhTeZ2AqixDKqg03oPRAcYTxLTK2xTdN5h4GtT/unUqzwOgPEncnuhwNOXrfwgVqEAFKlCBCtRf+n97Y2CaOfCNbwAAAABJRU5ErkJggg==",mcloud_logo$1=Object.freeze(Object.defineProperty({__proto__:null,default:mcloud_logo},Symbol.toStringTag,{value:"Module"})),require$$1=getAugmentedNamespace(mcloud_logo$1);var hasRequiredNavbar;function requireNavbar(){if(hasRequiredNavbar)return Navbar;hasRequiredNavbar=1,Object.defineProperty(Navbar,"__esModule",{value:!0}),Navbar.default=void 0;var r=c(require$$1),n=a(requireReact());function a(m,b){if(typeof WeakMap=="function")var T=new WeakMap,x=new WeakMap;return(a=function(k,F){if(!F&&k&&k.__esModule)return k;var C,z,Q={__proto__:null,default:k};if(k===null||typeof k!="object"&&typeof k!="function")return Q;if(C=F?x:T){if(C.has(k))return C.get(k);C.set(k,Q)}for(const J in k)J!=="default"&&{}.hasOwnProperty.call(k,J)&&((z=(C=Object.defineProperty)&&Object.getOwnPropertyDescriptor(k,J))&&(z.get||z.set)?C(Q,J,z):Q[J]=k[J]);return Q})(m,b)}function c(m){return m&&m.__esModule?m:{default:m}}const d={learn:{name:"LEARN",link:"https://www.materialscloud.org/learn"},work:{name:"WORK",link:"https://www.materialscloud.org/work"},discover:{name:"DISCOVER",link:"https://www.materialscloud.org/discover"},explore:{name:"EXPLORE",link:"https://www.materialscloud.org/explore"},archive:{name:"ARCHIVE",link:"https://www.materialscloud.org/archive"}},R={policies:{name:"Policies",link:"https://www.materialscloud.org/policies"},dmp:{name:"Data Management Plan",link:"https://www.materialscloud.org/dmp"},terms:{name:"Terms of Use",link:"https://www.materialscloud.org/termssummary"},infrastructure:{name:"Infrastructure",link:"https://www.materialscloud.org/infrastructure"},team:{name:"Team & Contact",link:"https://www.materialscloud.org/team"},partners:{name:"Partners",link:"https://www.materialscloud.org/home#partners"},restapi:{name:"Connect your REST API",link:"https://www.materialscloud.org/explore/connect"}},u=m=>{let{activeSection:b}=m;const[T,x]=(0,n.useState)(!1),k=(0,n.useRef)(null);(0,n.useEffect)(()=>{function z(Q){k.current&&!k.current.contains(Q.target)&&x(!1)}return document.addEventListener("mousedown",z),()=>document.removeEventListener("mousedown",z)},[]);const F=()=>x(z=>!z),C="dropdown-content"+(T?" dropdown-open":"");return n.default.createElement("div",{ref:k,className:"more-dropdown"},n.default.createElement("span",{className:"more-btn",onClick:F},"More ",n.default.createElement("i",{className:"fa fa-caret-down"})),n.default.createElement("div",{className:C},Object.keys(R).map((z,Q)=>{const{link:J,name:q}=R[z],w=z===b?"active":"";return n.default.createElement("a",{key:Q,className:w,href:J},q)})))},v=m=>{let{activeSection:b}=m;return n.default.createElement("div",{className:"mc-navbar"},n.default.createElement("a",{className:"mc-navbrand",href:"https://www.materialscloud.org/home"},n.default.createElement("img",{src:r.default,loading:"lazy",height:"50",alt:"MC logo"})),Object.keys(d).map((T,x)=>{let k="mc-navlink";return T===b&&(k+=" active"),n.default.createElement("a",{key:x,className:k,href:d[T].link},d[T].name)}),n.default.createElement(u,{activeSection:b}))};return Navbar.default=v,Navbar}var Breadcrumbs={},hasRequiredBreadcrumbs;function requireBreadcrumbs(){if(hasRequiredBreadcrumbs)return Breadcrumbs;hasRequiredBreadcrumbs=1,Object.defineProperty(Breadcrumbs,"__esModule",{value:!0}),Breadcrumbs.default=void 0;var r=n(requireReact());function n(c){return c&&c.__esModule?c:{default:c}}const a=c=>{let{breadcrumbsPath:d}=c;return r.default.createElement("ul",{className:"mc-breadcrumb"},d.map((R,u)=>r.default.createElement("li",{key:u},r.default.createElement("a",{href:R.link},R.name))))};return Breadcrumbs.default=a,Breadcrumbs}var hasRequiredDist;function requireDist(){if(hasRequiredDist)return dist;hasRequiredDist=1,Object.defineProperty(dist,"__esModule",{value:!0}),dist.default=void 0;var r=c(requireReact()),n=c(requireNavbar()),a=c(requireBreadcrumbs());function c(R){return R&&R.__esModule?R:{default:R}}const d=R=>{let{activeSection:u,breadcrumbsPath:v}=R;return r.default.createElement("div",null,r.default.createElement(n.default,{activeSection:u}),r.default.createElement(a.default,{breadcrumbsPath:v}))};return dist.default=d,dist}var distExports=requireDist();const MaterialsCloudHeader=getDefaultExportFromCjs(distExports);function OptimadeChildInfo({child:r}){if(!r)return;const{name:n,description:a,homepage:c,base_url:d,...R}=r;return jsxRuntimeExports.jsxs("div",{className:`${containerStyle} ${textTiny} h-35 overflow-auto`,children:[jsxRuntimeExports.jsx("h3",{className:`${textNormal} pb-1.5`,children:n}),a&&jsxRuntimeExports.jsx("p",{className:"pb-1",children:a}),c&&jsxRuntimeExports.jsxs("p",{children:["Homepage:"," ",jsxRuntimeExports.jsx("a",{href:c,target:"_blank",rel:"noopener noreferrer",className:textHyperlink,children:c})]}),d&&jsxRuntimeExports.jsxs("p",{children:["Base url:"," ",jsxRuntimeExports.jsx("a",{href:d,target:"_blank",rel:"noopener noreferrer",className:textHyperlink,children:d})]})]})}function OptimadeParentInfo({provider:r,providers:n}){if(!r||!n)return null;const a=n.find(m=>m.attributes?.base_url===r.attributes?.base_url);if(!a)return null;const{name:c,description:d,homepage:R,base_url:u,...v}=a.attributes??{};return jsxRuntimeExports.jsxs("div",{className:`${containerStyle} h-35 overflow-auto ${textTiny}`,children:[jsxRuntimeExports.jsx("h3",{className:`${textNormal} pb-1.5`,children:c}),d&&jsxRuntimeExports.jsx("p",{className:"pb-1",children:d}),R&&jsxRuntimeExports.jsxs("p",{children:["Homepage:"," ",jsxRuntimeExports.jsx("a",{href:R,target:"_blank",rel:"noopener noreferrer",className:textHyperlink,children:R})]}),u&&jsxRuntimeExports.jsxs("p",{children:["Index metadb:"," ",jsxRuntimeExports.jsx("a",{href:`${u}/links`,target:"_blank",rel:"noopener noreferrer",className:textHyperlink,children:`${u}/links`})]})]})}function OptimadeClient({hideProviderList:r=["exmpl","matcloud"]}){const[n,a]=reactExports.useState([]),[c,d]=reactExports.useState(""),[R,u]=reactExports.useState(null),[v,m]=reactExports.useState(null),[b,T]=reactExports.useState(""),[x,k]=reactExports.useState(1),[F,C]=reactExports.useState(null),[z,Q]=reactExports.useState(null),[J,q]=reactExports.useState(!1),[w,N]=reactExports.useState(1),[V,H]=reactExports.useState({data_returned:0,data_available:0});reactExports.useEffect(()=>{(async()=>{try{const ee=await getProvidersList(void 0,r);a(ee.data)}catch(ee){console.error("Error fetching providers:",ee)}})()},[]);const Y=reactExports.useCallback(async()=>{if(c){q(!0);try{const O=await getStructures({providerUrl:c,filter:b,page:x});Q(O);const ee=O?.meta??{data_returned:0,data_available:0};H(ee),N(ee.data_returned!=null&&!isNaN(ee.data_returned)?Math.max(1,Math.ceil(ee.data_returned/20)):"N/A"),C(O?.data[0]||null)}catch(O){console.error("Error fetching structures:",O),C(null)}finally{q(!1)}}},[c,b,x]);return reactExports.useEffect(()=>{Y()},[Y]),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(MaterialsCloudHeader,{className:"header",activeSection:"work",breadcrumbsPath:[{name:"Work",link:"https://www.materialscloud.org/work"},{name:"OPTIMADE-Client",link:null}]}),jsxRuntimeExports.jsx("div",{className:"min-h-screen max-w-5xl mx-auto bg-white mb-4 shadow-md rounded-xs",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center w-full px-2 md:px-4 py-2",children:[jsxRuntimeExports.jsx(OptimadeHeader,{}),jsxRuntimeExports.jsx("div",{className:"p-2 w-full",children:jsxRuntimeExports.jsx(OptimadeFAQs,{})}),jsxRuntimeExports.jsx("div",{className:"pt-4 p-2",children:jsxRuntimeExports.jsx(DatabaseSelector,{providers:n,onChildChange:u,onProviderChange:m,onQueryUrlChange:O=>{O!==c&&(d(O),k(1))}})}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col md:flex-row w-full max-w-5xl px-2 md:px-4 py-2 gap-4",children:[jsxRuntimeExports.jsx("div",{className:"md:w-1/2 w-full",children:jsxRuntimeExports.jsx(OptimadeParentInfo,{provider:v,providers:n})}),jsxRuntimeExports.jsx("div",{className:"md:w-1/2 w-full",children:jsxRuntimeExports.jsx(OptimadeChildInfo,{child:R})})]}),jsxRuntimeExports.jsx("div",{className:"p-2 w-full",children:jsxRuntimeExports.jsx("div",{style:{display:c?"block":"none"},children:jsxRuntimeExports.jsx(AnimatePresence,{children:jsxRuntimeExports.jsx(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},transition:{duration:.3,ease:"easeInOut"},className:containerStyle,children:jsxRuntimeExports.jsx(OptimadeFilters,{queryUrl:c,onSubmit:O=>{T(O),k(1)}})},"filters")})})}),jsxRuntimeExports.jsx("div",{className:"p-2 w-full",children:jsxRuntimeExports.jsx(OptimadeProviderInfo,{queryUrl:c})}),c&&jsxRuntimeExports.jsxs("div",{className:"px-2 md:px-4 w-full",children:[J&&jsxRuntimeExports.jsx("div",{className:"flex justify-center items-center h-[610px]",children:jsxRuntimeExports.jsx("div",{className:"w-16 h-16 border-4 border-gray-300 border-t-blue-500 rounded-full animate-spin"})}),jsxRuntimeExports.jsx("div",{className:"border-b border-slate-300 py-2"}),!J&&!F&&b&&jsxRuntimeExports.jsx("div",{className:"p-2",children:jsxRuntimeExports.jsx(OptimadeNoResults,{queryUrl:c,currentFilter:b})}),!J&&z&&F&&jsxRuntimeExports.jsxs("div",{className:"py-1 md:py-2 ",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col md:flex-row items-stretch md:items-end gap-4",children:[jsxRuntimeExports.jsx("div",{className:"flex-1",children:jsxRuntimeExports.jsx(ResultsDropdown,{results:z,resultsLoading:J,selectedResult:F,setSelectedResult:C})}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(PaginationHandler,{currentPage:x,totalPages:w,resultsLoading:J,metaData:V,onPageChange:k})})]}),jsxRuntimeExports.jsx("div",{className:"py-4",children:jsxRuntimeExports.jsx(ResultViewer,{selectedResult:F})})]})]})]})})]})}const badProviders=["exmpl","aiida","aflow","ccdc","ccpnc","httk","matcloud","mpds","mpod","optimake","optimade","pcod","psdi"];function App(){return jsxRuntimeExports.jsx(OptimadeClient,{hideProviderList:badProviders})}clientExports.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(reactExports.StrictMode,{children:jsxRuntimeExports.jsx(App,{})}));
